{
  "question" : {
    "question_id" : 79636496,
    "title" : "Is there a way to @Inject the SeContainer/CDI instance itself?",
    "body" : "<p>Is there a way to inject the <code>SeContainer</code> itself?</p>\n<p>I am working on a Picocli CLI application where I create the instances of the commands by using CDI. I do not want to depend on a specific CDI implementation, and I would like to achieve something like this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@ApplicationScoped\npublic class PicocliCDIFactory implements CommandLine.IFactory {\n    private final SeContainer container;\n\n    @Inject\n    public PicocliCDIFactory(SeContainer container) {\n        this.container = container;\n    }\n\n    @Override\n    public &lt;K&gt; K create(Class&lt;K&gt; cls) throws Exception {\n        return container.select(cls).get();\n    }\n\n}\n</code></pre>\n<p>An instance of CDI&lt;?&gt; would also be fine.</p>\n<p>I am currently using Weld and this fails with:</p>\n<pre class=\"lang-none prettyprint-override\"><code>Exception in thread &quot;main&quot; org.jboss.weld.exceptions.DeploymentException: WELD-001408: Unsatisfied dependencies for type SeContainer with qualifiers @Default\n  at injection point [BackedAnnotatedParameter] Parameter 1 of [BackedAnnotatedConstructor] @Inject public com.example.project.PicocliCDIFactory(SeContainer)\n  at com.example.project.PicocliCDIFactory.&lt;init&gt;(PicocliCDIFactory.java:0)\n\n    at org.jboss.weld.bootstrap.Validator.validateInjectionPointForDeploymentProblems(Validator.java:397)\n    at org.jboss.weld.bootstrap.Validator.validateInjectionPoint(Validator.java:312)\n    at org.jboss.weld.bootstrap.Validator.validateGeneralBean(Validator.java:159)\n    at org.jboss.weld.bootstrap.Validator.validateRIBean(Validator.java:181)\n    at org.jboss.weld.bootstrap.Validator.validateBean(Validator.java:552)\n    at org.jboss.weld.bootstrap.ConcurrentValidator$1.doWork(ConcurrentValidator.java:65)\n    at org.jboss.weld.bootstrap.ConcurrentValidator$1.doWork(ConcurrentValidator.java:63)\n    at org.jboss.weld.executor.IterativeWorkerTaskFactory$1.call(IterativeWorkerTaskFactory.java:62)\n    at org.jboss.weld.executor.IterativeWorkerTaskFactory$1.call(IterativeWorkerTaskFactory.java:55)\n    at org.jboss.weld.executor.CommonForkJoinPoolExecutorServices.lambda$wrap$0(CommonForkJoinPoolExecutorServices.java:70)\n    at java.base/java.util.concurrent.ForkJoinTask$AdaptedInterruptibleCallable.exec(ForkJoinTask.java:1489)\n    at java.base/java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:387)\n    at java.base/java.util.concurrent.ForkJoinPool$WorkQueue.topLevelExec(ForkJoinPool.java:1312)\n    at java.base/java.util.concurrent.ForkJoinPool.scan(ForkJoinPool.java:1843)\n    at java.base/java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1808)\n    at java.base/java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:188)\n\n</code></pre>\n<p>I also tried to inject an <code>Instance&lt;SeContainer&gt;</code>, but it is unresolvable.</p>\n<p>I am aware that with Weld I can inject the <code>WeldContainer</code>, but again, I do not want to depend on a specific implementation of CDI like Weld.</p>\n<p>The only solution I am seeing right now is using <code>CDI.current()</code> to obtain a <code>CDI</code> object and use it to create instances.</p>\n<p>However, this static method does not seem super robust to me. What if there are multiple containers, and I want to make sure that my factory gets injected with the CDI object that has also been used to create it?</p>\n",
    "tags" : [ "java", "dependency-injection", "cdi", "jboss-weld", "picocli" ],
    "owner" : {
      "account_id" : 42161038,
      "reputation" : 1,
      "user_id" : 30621466,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/1edc83dc034b1af437e0cf170d854292?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "QuantasImpossibile",
      "link" : "https://stackoverflow.com/users/30621466/quantasimpossibile"
    },
    "is_answered" : true,
    "view_count" : 75,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1748268732,
    "creation_date" : 1748069802,
    "link" : "https://stackoverflow.com/questions/79636496/is-there-a-way-to-inject-the-secontainer-cdi-instance-itself",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79639077,
    "question_id" : 79636496,
    "body" : "<p>I just found out that you can inject the <code>BeanContainer</code>.</p>\n<pre><code>&quot;Any bean may obtain an instance of BeanContainer by injecting it.&quot;\n</code></pre>\n<p>From there I can just call <code>BeanContainer.createInstance()</code> and use the <code>Instance&lt;Object&gt;</code> obtained to create my objects.</p>\n",
    "score" : 0,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 42161038,
      "reputation" : 1,
      "user_id" : 30621466,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/1edc83dc034b1af437e0cf170d854292?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "QuantasImpossibile",
      "link" : "https://stackoverflow.com/users/30621466/quantasimpossibile"
    },
    "creation_date" : 1748268732,
    "last_activity_date" : 1748268732,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140457972,
    "post_id" : 79636496,
    "body" : "No, you are missing the point, you are just citing 5.5.1 of the spec to me. I understand how CDI works. I am essentially asking what the most elegant way to get the instance of the CDI framework that creates my beans is <i>from a bean itself</i>. E.g. do CDI frameworks have a binding for CDI/SeContainer, like Weld does for the WeldContainer? At least Weld does not and the spec does not require them to, so I am looking for alternatives.",
    "score" : 0,
    "owner" : {
      "account_id" : 42161038,
      "reputation" : 1,
      "user_id" : 30621466,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/1edc83dc034b1af437e0cf170d854292?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "QuantasImpossibile",
      "link" : "https://stackoverflow.com/users/30621466/quantasimpossibile"
    },
    "creation_date" : 1748215559,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140457202,
    "post_id" : 79636496,
    "body" : "Ok, I know that thanks, but it does not answer the question. I am asking if it is possible to inject the SeContainer in the constructor, or a CDI&lt;?&gt; object. It seems the spec does not require CDI implementations to provide injections for neither SeContainer nor CDI instances, so I think I am stuck with CDI.current(), unless someone has another idea. It also seems that some CDI frameworks, e.g. ArC in Quarkus are implemented in a way (as Singletons) that only makes one Injector per JVM (or at least per classloader) feasible, so CDI.current() is probably ok, I am just not happy with it.",
    "score" : 0,
    "owner" : {
      "account_id" : 42161038,
      "reputation" : 1,
      "user_id" : 30621466,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/1edc83dc034b1af437e0cf170d854292?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "QuantasImpossibile",
      "link" : "https://stackoverflow.com/users/30621466/quantasimpossibile"
    },
    "creation_date" : 1748182326,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}