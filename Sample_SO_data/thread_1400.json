{
  "question" : {
    "question_id" : 79710945,
    "title" : "How to customise RetryTopicNamesProvider with groupId or similar properties",
    "body" : "<p>I've finally broken and thought I'd see if anyone could help, considering some similar conversations elsewhere; which don't have example answers.</p>\n<p>Due to a custom implementation of retry/error handling in our Spring Kafka projects and the need to upgrade to the latest Spring Boot/Kafka, we require the ability to either define the retry/error topic explicitly from a property, or use the groupId.</p>\n<p>The difficulty (for me!) is the current implementatinon of getTopicName(String topic) in RetryTopicNamesProvider. This only accepts a topic name, whilst all the other methods have a method signature of &quot;KafkaListenerEndpoint endpoint&quot;.</p>\n<p>If this was available I could do something like the below to specify error/retry topics explicitly from config:</p>\n<pre><code>@KafkaListener(topics = &quot;#{config.![value.getIngressTopic()]}&quot;,\n    properties = {\n      &quot;retryTopic:#{config.![value.getRetryTopic()]}&quot;,\n      &quot;errorTopic:#{config.![value.getErrorTopic()]}&quot;\n    },\n</code></pre>\n<p>and use something like this in the RetryTopicNamesProvider:</p>\n<pre><code>endpoint.getConsumerProperties()).getProperty(&quot;retryTopic&quot;)\n</code></pre>\n<p>Unforunately 'endpoint' isn't present in getTopicName which is the ultimate decider of the retry/error topic name.</p>\n<p>Gary Russell in this thread <a href=\"https://stackoverflow.com/questions/77216081/how-work-retrytopic-with-other-groupid-and-backoff-properties\">How work RetryTopic with other groupId and backOff properties</a> suggesting customising it to allow groupId - but looking at the Spring code I simply can't make heads or tails on how to go about it.\nIn addition someone asked something similar on github <a href=\"https://github.com/spring-projects/spring-kafka/discussions/3339\" rel=\"nofollow noreferrer\">https://github.com/spring-projects/spring-kafka/discussions/3339</a></p>\n<p>Any help or pointers are appreciated.</p>\n",
    "tags" : [ "java", "spring-boot", "spring-kafka" ],
    "owner" : {
      "account_id" : 2711206,
      "reputation" : 128,
      "user_id" : 2799018,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/49551f8f808661e4706660c6c2069c9b?s=256&d=identicon&r=PG",
      "display_name" : "deanpullen",
      "link" : "https://stackoverflow.com/users/2799018/deanpullen"
    },
    "is_answered" : false,
    "view_count" : 44,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1757429119,
    "creation_date" : 1753210772,
    "link" : "https://stackoverflow.com/questions/79710945/how-to-customise-retrytopicnamesprovider-with-groupid-or-similar-properties",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79759998,
    "question_id" : 79710945,
    "body" : "<p>Ultimately I fixed this by not using retry topic naming via properties but instead using a</p>\n<pre><code>CustomRetryTopicNamesProviderFactory implements RetryTopicNamesProviderFactory\n</code></pre>\n<p>Then we can simply append the group ID and .RETRY affix to the default topic names, which matched our previous style.</p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 2711206,
      "reputation" : 128,
      "user_id" : 2799018,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/49551f8f808661e4706660c6c2069c9b?s=256&d=identicon&r=PG",
      "display_name" : "deanpullen",
      "link" : "https://stackoverflow.com/users/2799018/deanpullen"
    },
    "creation_date" : 1757429119,
    "last_activity_date" : 1757429119,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : { }
}