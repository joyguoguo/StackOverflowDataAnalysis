{
  "question" : {
    "question_id" : 79713677,
    "title" : "Set log levels per class with AWS Managed Apache Flink",
    "body" : "<p>This question is specific to AWS Managed Flink (1.19).\nI know how to control logging in most Java apps,\nbut everything I know is failing in this case.</p>\n<p>I have a Java application running in Amazon Managed Service for Apache Flink (MSF).<br />\nMSF uses log4j2, and they allow you configure the global log level,<br />\nbut I don't see a way to set the log level on individual classes and packages.<br />\nI have tried providing my own <code>log4j2.xml</code> but it appears to be ignored.<br />\nThe same with setting various environment variables.<br />\nAll I really want is for 3rd party code to log at WARN<br />\nbut still have my code log at DEBUG.<br />\nI can't find any docs for this, but I hope if someone can provide<br />\nexactly the right flag or env var that I can control it.</p>\n",
    "tags" : [ "java", "amazon-web-services", "apache-flink", "log4j2" ],
    "owner" : {
      "account_id" : 926419,
      "reputation" : 421,
      "user_id" : 957136,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/531fb75e7f195cde6e6bfda81c680ec3?s=256&d=identicon&r=PG",
      "display_name" : "dlipofsky",
      "link" : "https://stackoverflow.com/users/957136/dlipofsky"
    },
    "is_answered" : true,
    "view_count" : 125,
    "answer_count" : 2,
    "score" : 2,
    "last_activity_date" : 1762176961,
    "creation_date" : 1753373848,
    "link" : "https://stackoverflow.com/questions/79713677/set-log-levels-per-class-with-aws-managed-apache-flink",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79720527,
    "question_id" : 79713677,
    "body" : "<p>I asked the same question in <a href=\"https://repost.aws/questions/QUh7ZypxHbRgKT-ITwKknPKg/set-log-levels-per-package-with-aws-managed-apache-flink\" rel=\"nofollow noreferrer\">aws re:post</a> and got an AI response which says it &quot;doesn't natively support package-level log configuration like you would in a standard Java application&quot;. It's annoying because they they specifically emphasize that excessive logging will impact performance, but then they take away one of the best tools to control it.\nI also tried</p>\n<pre class=\"lang-java prettyprint-override\"><code>import org.apache.logging.log4j.Level;\nimport org.apache.logging.log4j.core.config.Configurator;\n...\nConfigurator.setLevel(&quot;com.example&quot;, Level.DEBUG);\nConfigurator.setLevel(&quot;com.example.foo.MyClass&quot;, Level.DEBUG);\n</code></pre>\n<p>and while this works when running locally for overriding the log config file, but doesn't work in the AWS Managed Flink environment.</p>\n<p>Their <a href=\"https://docs.aws.amazon.com/managed-flink/latest/java/best-practices.html#minimize-uber-JAR\" rel=\"nofollow noreferrer\">best practices doc</a> says they provide log4j2 in the environment, and will ignore any version you include in your uber JAR. I can only infer that what they provide is a bastardized custom implementation, and not the natural log4j2 implementation.</p>\n",
    "score" : 1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 926419,
      "reputation" : 421,
      "user_id" : 957136,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/531fb75e7f195cde6e6bfda81c680ec3?s=256&d=identicon&r=PG",
      "display_name" : "dlipofsky",
      "link" : "https://stackoverflow.com/users/957136/dlipofsky"
    },
    "creation_date" : 1753908837,
    "last_activity_date" : 1753908837,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79807777,
    "question_id" : 79713677,
    "body" : "<p>You can change the LogLevel by retrieving the Logger directly from Log4j's LogManager within the <code>open</code> lifecycle of a RichFunction:</p>\n<pre><code>import org.apache.log4j.LogManager;\n\n@Override\npublic void open(Configuration parameters) {\n    // Turn off verbose INFO logging\n    Logger logger = LogManager.getLogger(&quot;org.apache.parquet.hadoop.InternalParquetRecordReader&quot;);\n    logger.level = org.apache.log4j.Level.WARN;\n}\n</code></pre>\n<hr />\n<p>Updating log4j2.xml doesn't work because AWS Managed Apache Flink will override it with it's own log4j2.xml template along with the necessary log4j dependencies:</p>\n<ul>\n<li>org.apache.logging.log4j:log4j-slf4j-impl</li>\n<li>org.apache.logging.log4j:log4j-api</li>\n<li>org.apache.logging.log4j:log4j-core</li>\n<li>org.apache.logging.log4j:log4j-1.2-api</li>\n</ul>\n<p>Source: <a href=\"https://docs.aws.amazon.com/managed-flink/latest/java/best-practices.html#minimize-uber-JAR\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/managed-flink/latest/java/best-practices.html#minimize-uber-JAR</a></p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 43158370,
      "reputation" : 1,
      "user_id" : 31108722,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/78c1737feac4cd2d5d95eaaff3d6df0b?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Tom&#225;s Cerd&#225;",
      "link" : "https://stackoverflow.com/users/31108722/tom%c3%a1s-cerd%c3%a1"
    },
    "creation_date" : 1762167317,
    "last_activity_date" : 1762176961,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : { }
}