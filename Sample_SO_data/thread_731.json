{
  "question" : {
    "question_id" : 79778287,
    "title" : "Need help calling external Java Main from my own Java application",
    "body" : "<p>Linux 9 (Centos), Java 21, medium to low Java experience</p>\n<p>I have a 3rd party command line tool that runs a Java app.</p>\n<p>Basically I run</p>\n<pre class=\"lang-none prettyprint-override\"><code>./thisscript.sh -parmaeter1 value1 -parameter2 value2 ...\n</code></pre>\n<p>It builds up a command like this:</p>\n<pre class=\"lang-none prettyprint-override\"><code>/opt/java/bin/java -DHOST=localhost -DPORT=12345 -Xmx512m //\n -classpath ...SOME_VERY_LONG_CLASSPATH //\n  com.thisco.thisapp.start//\n -parmaeter1 value1 //\n -parmaeter2 value\n</code></pre>\n<p>I have put the proper jar into a decompiler and see this main:</p>\n<pre class=\"lang-java prettyprint-override\"><code>  public static void main(String[] args) {\n</code></pre>\n<p>So I want to call this from my own Java app.  I know I can start it as an external shell (running the shell script), but I hate doing that.  I feel I should be able to call the main like this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>    String[] sdargs = new String[]{&quot;-DHOST=localhost -DPORT=12345 -Xmx512m -classpath  SOME_VERY_LONG_CLASSPATH -parmaeter1 value1 -parmaeter2 value \\n&quot;};\n        try {\n            com.thisco.thisapp.start.main(sdargs); // Invoking start's main method\n        } catch (Exception e) {\n            throw new RuntimeException(e);\n        }\n</code></pre>\n<p>But it throws a <code>java.lang.NoClassDefFoundError</code> on one of the class files in the class path.</p>\n<p>I have also tried putting these parameters in the invocation of my app as well with the same results.</p>\n<p>What am I missing?</p>\n",
    "tags" : [ "java" ],
    "owner" : {
      "account_id" : 5205475,
      "reputation" : 185,
      "user_id" : 4163568,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/8e37c3ab63b171323040a9c82721240c?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Andy Knipp",
      "link" : "https://stackoverflow.com/users/4163568/andy-knipp"
    },
    "is_answered" : true,
    "view_count" : 115,
    "answer_count" : 1,
    "score" : 2,
    "last_activity_date" : 1759227315,
    "creation_date" : 1759158817,
    "link" : "https://stackoverflow.com/questions/79778287/need-help-calling-external-java-main-from-my-own-java-application",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79778306,
    "question_id" : 79778287,
    "body" : "<p>There's a few ways to do this:</p>\n<p><strong>Call thisscript.sh via <a href=\"https://docs.oracle.com/javase/8/docs/api/java/lang/Runtime.html#exec-java.lang.String:A-\" rel=\"nofollow noreferrer\">Runtime.exec(...)</a>.</strong></p>\n<p>This will start a new Java Virtual Machine (JVM) for the app and so the apps won't share the same memory and will be separate processes as far as the operating system is concerned.</p>\n<pre class=\"lang-java prettyprint-override\"><code>String[] command = { &quot;./thisscript.sh&quot;, &quot;-parmaeter1&quot;, &quot;value1&quot;, .. };\nProcess process = Runtime.exec(command);\n</code></pre>\n<p><strong>Call com.thisco.thisapp.start.main inside another app's JVM</strong></p>\n<p>Let's assume that we want to call &quot;com.thisco.thisapp.start.main&quot; from &quot;foo.bar.MyCallingApp.main&quot;. There's a couple of options here:</p>\n<p><strong>Add the jar(s) to the classpath when calling <code>MyCallingApp.main</code></strong></p>\n<p><code>java --classpath SOME_VERY_LONG_CLASSPATH -Xmx512m foo.bar.MyCallingApp</code></p>\n<p>Note that only the values after the classname are program arguments. The values before the classname (eg -DHOST=localhost -DPORT=12345) are jvm arguments. -D is for system parameters, -Xmx512m is the JVM memory max setting. Since we're sharing JVM's everything has the same memory in this instance</p>\n<pre class=\"lang-java prettyprint-override\"><code>// these sys properties can either be set in java or specified when starting the calling app\nSystem.setProperty(&quot;HOST&quot;, &quot;localhost&quot;);\nSystem.setProperty(&quot;PORT&quot;, &quot;12345&quot;);\nString[] sdargs = new String[]{&quot;-parmaeter1&quot;, &quot;value1&quot;, &quot;-parmaeter2&quot;, &quot;value&quot; };\ncom.thisco.thisapp.start.main(sdargs);\n</code></pre>\n<p><strong>Use a custom classloader to load the class</strong></p>\n<p>In this instance we don't need the jars on the classpath of the calling app (eg --classpath). We can create a URLClassLoader on the fly to load the class</p>\n<pre class=\"lang-java prettyprint-override\"><code>URL[] jars = { new File(&quot;/lib/jar1.jar&quot;).toUri().toUrl() };\nClassloader loader = new URLClassLoader(jars);\nClass&lt;?&gt; type = loader.loadClass(&quot;com.thisco.thisapp.start&quot;);\nMethod method = type.getMethod(&quot;main&quot;, String[].class);\nmethod.invoke(null, &quot;-parmaeter1&quot;, &quot;value1&quot;, &quot;-parmaeter2&quot;, &quot;value&quot;);\n</code></pre>\n",
    "score" : 3,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 1096470,
      "reputation" : 29414,
      "user_id" : 1089967,
      "user_type" : "registered",
      "accept_rate" : 59,
      "profile_image" : "https://www.gravatar.com/avatar/1f256b904ff621d678598d8fa49f86c5?s=256&d=identicon&r=PG",
      "display_name" : "lance-java",
      "link" : "https://stackoverflow.com/users/1089967/lance-java"
    },
    "creation_date" : 1759159771,
    "last_activity_date" : 1759227315,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140766861,
    "post_id" : 79778287,
    "body" : "And some additional ideas, if you have flexibility in the calling code: <a href=\"https://www.baeldung.com/java-classpath-include-jars\" rel=\"nofollow noreferrer\">baeldung.com/java-classpath-include-jars</a>",
    "score" : 0,
    "owner" : {
      "account_id" : 2709823,
      "reputation" : 11069,
      "user_id" : 2338547,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/QT3fG.png?s=256",
      "display_name" : "markspace",
      "link" : "https://stackoverflow.com/users/2338547/markspace"
    },
    "creation_date" : 1759159830,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140766858,
    "post_id" : 79778287,
    "body" : "This can be run several ways.  To start, for the code you showed, that code needs to be run with the Jar file containing <code>com.thisco.thisapp.start</code> on the classpath.  If the calling code is itself in a Jar file, this gets a bit tricky.  Docs: <a href=\"https://docs.oracle.com/javase/tutorial/deployment/jar/downman.html\" rel=\"nofollow noreferrer\">docs.oracle.com/javase/tutorial/deployment/jar/downman.html</a>",
    "score" : 0,
    "owner" : {
      "account_id" : 2709823,
      "reputation" : 11069,
      "user_id" : 2338547,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/QT3fG.png?s=256",
      "display_name" : "markspace",
      "link" : "https://stackoverflow.com/users/2338547/markspace"
    },
    "creation_date" : 1759159768,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79778306" : [ {
      "comment_id" : 140767210,
      "post_id" : 79778306,
      "body" : "Thank you.  I knew I could do the 1st,  but really did not want to do start another JVM.  I used the 2nd example.",
      "score" : 0,
      "owner" : {
        "account_id" : 5205475,
        "reputation" : 185,
        "user_id" : 4163568,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/8e37c3ab63b171323040a9c82721240c?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "Andy Knipp",
        "link" : "https://stackoverflow.com/users/4163568/andy-knipp"
      },
      "creation_date" : 1759169305,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140767187,
      "post_id" : 79778306,
      "body" : "Runtime.exec bad.  <a href=\"https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/ProcessBuilder.html\" rel=\"nofollow noreferrer\">ProcessBuilder</a> good.  Chiefly because of its <a href=\"https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/ProcessBuilder.html#inheritIO()\" rel=\"nofollow noreferrer\">inheritIO()</a> method.",
      "score" : 6,
      "owner" : {
        "account_id" : 2053598,
        "reputation" : 44936,
        "user_id" : 1831987,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/38b1c37530189ec4471a43a618e33f67?s=256&d=identicon&r=PG",
        "display_name" : "VGR",
        "link" : "https://stackoverflow.com/users/1831987/vgr"
      },
      "creation_date" : 1759168666,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}