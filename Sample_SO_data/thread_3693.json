{
  "question" : {
    "question_id" : 79530989,
    "title" : "How to make non-retryable exceptions retryable in DLT?",
    "body" : "<p>I have a producer that sends messages in Avro format and a consumer which listens to those messages.</p>\n<p>I have also implemented non-blocking retries by using <code>@RetryableTopic</code> in my consumer for handling errors and  <code>@DltHandler</code> to handle messages in the DLT.</p>\n<p>With this configuration the message causing a non-retryable exception is forwarded to the retry-topics, but the message is not retried in the DLT.</p>\n<pre><code>@EnableScheduling\n@EnableKafka\n@Configuration\npublic class MyRetryTopicConfiguration extends RetryTopicConfigurationSupport {\n\n    @Override\n    protected void manageNonBlockingFatalExceptions(List&lt;Class&lt;? extends Throwable&gt;&gt; nonBlockingFatalExceptions) {\n        nonBlockingFatalExceptions.clear();\n    }\n</code></pre>\n<p>I have set <code>dltStrategy = DltStrategy.ALWAYS_RETRY_ON_ERROR</code> in <code>@RetryTopic</code> but this only works for retryable exceptions.</p>\n<p>How can I solve this issue?</p>\n<p><code>nonBlockingFatalExceptions.clear();</code> should have solved the issue.\nI also tried to include the fatal exceptions in <code>@RetryableTopic</code> with</p>\n<pre><code>include = {DeserializationException.class, ...}\n</code></pre>\n<p>but this didnt work as well.</p>\n<p>I also looked here: <a href=\"https://docs.spring.io/spring-kafka/reference/retrytopic/dlt-strategies.html\" rel=\"nofollow noreferrer\">DLT Strategies</a>. It seems that the doc is old/wrong regarding <code>DestinationTopicResolver</code>.</p>\n",
    "tags" : [ "java", "spring", "spring-boot", "apache-kafka", "spring-kafka" ],
    "owner" : {
      "account_id" : 13474154,
      "reputation" : 1,
      "user_id" : 30041048,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/cc8da706c9e8a64d5794ba30e2d72b0b?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Keskorian",
      "link" : "https://stackoverflow.com/users/30041048/keskorian"
    },
    "is_answered" : false,
    "view_count" : 76,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1742896648,
    "creation_date" : 1742817206,
    "link" : "https://stackoverflow.com/questions/79530989/how-to-make-non-retryable-exceptions-retryable-in-dlt",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ ],
  "answer_comments" : { }
}