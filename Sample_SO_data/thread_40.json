{
  "question" : {
    "question_id" : 79833498,
    "title" : "Is there a way to automate user input with JLine&#39;s LineReader?",
    "body" : "<p>When handling user input through <code>Scanner(System.in)</code>, you can use <code>System.setIn()</code> to automate user input.</p>\n<p>Like this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>package edu.ntnu.idi.idat;\n\nimport java.io.ByteArrayInputStream;\nimport java.io.InputStream;\nimport java.util.Scanner;\n\npublic final class TestCode {\n    private TestCode() { }\n    /**\n     * Test code.\n     * @param args\n     */\n    public static void main(\n        final String[] args\n    ) {\n        InputStream input = System.in;\n        String testInputString = &quot;test&quot; + System.lineSeparator() + &quot;test2&quot;;\n        ByteArrayInputStream testInput\n            = new ByteArrayInputStream(testInputString.getBytes());\n\n        System.setIn(testInput);\n\n        Scanner inputScanner = new Scanner(System.in);\n\n        System.out.println(inputScanner.nextLine());\n        System.out.println(inputScanner.nextLine());\n\n        inputScanner.close()\n    }\n}\n</code></pre>\n<p>But when trying the same method for JLine's LineReader, it doesn't work:</p>\n<pre><code>package edu.ntnu.idi.idat;\n\nimport java.io.ByteArrayInputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\n\nimport org.jline.reader.LineReader;\nimport org.jline.reader.LineReaderBuilder;\nimport org.jline.terminal.Terminal;\nimport org.jline.terminal.TerminalBuilder;\n\npublic final class TestCode {\n    private TestCode() { }\n    /**\n     * Test code.\n     * @param args\n     * @throws IOException\n     */\n    public static void main(\n        final String[] args\n    ) throws IOException {\n        InputStream input = System.in;\n        String testInputString = &quot;test&quot; + System.lineSeparator() + &quot;test2&quot;;\n        ByteArrayInputStream testInput\n            = new ByteArrayInputStream(testInputString.getBytes());\n\n        System.setIn(testInput);\n\n        Terminal terminal = TerminalBuilder.builder().build();\n        LineReader lineReader = LineReaderBuilder\n            .builder()\n            .terminal(terminal)\n            .build();\n\n        System.out.println(lineReader.readLine());\n        System.out.println(lineReader.readLine());\n\n        terminal.close()\n    }\n}\n\n</code></pre>\n<p>I believe this is because inputScanner uses System.in (as can be seen when constructing it), while LineReader doesn't seem to.</p>\n<p>My question is: is there a way to automate user input for LineReader as well?</p>\n",
    "tags" : [ "java", "ui-automation", "jline" ],
    "owner" : {
      "account_id" : 37604239,
      "reputation" : 95,
      "user_id" : 28332552,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/5a84dbd7a917124e895a66d1b7b38d61?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Lucy",
      "link" : "https://stackoverflow.com/users/28332552/lucy"
    },
    "is_answered" : true,
    "view_count" : 48,
    "answer_count" : 1,
    "score" : 1,
    "last_activity_date" : 1764453894,
    "creation_date" : 1764446740,
    "link" : "https://stackoverflow.com/questions/79833498/is-there-a-way-to-automate-user-input-with-jlines-linereader",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79833568,
    "question_id" : 79833498,
    "body" : "<p>you can use <code>DumbTerminal</code> seems like its designed for non-interactive use.</p>\n<pre><code>public final class TestCode {\n    private TestCode() { }\n    \n    public static void main(String[] args) throws IOException {\n        String testInputString = &quot;test&quot; + System.lineSeparator() + &quot;test2&quot;;\n        ByteArrayInputStream input = \n            new ByteArrayInputStream(testInputString.getBytes(StandardCharsets.UTF_8));\n        ByteArrayOutputStream output = new ByteArrayOutputStream();\n\n        // Use DumbTerminal for automated input\n        Terminal terminal = new DumbTerminal(input, output);\n        \n        LineReader lineReader = LineReaderBuilder.builder()\n                .terminal(terminal)\n                .build();\n\n        System.out.println(&quot;Read: &quot; + lineReader.readLine());\n        System.out.println(&quot;Read: &quot; + lineReader.readLine());\n\n        terminal.close();\n    }\n}\n</code></pre>\n<p>or Piped input &amp; output stream:</p>\n<pre><code>    public static void main(String[] args) throws IOException {\n        PipedInputStream in = new PipedInputStream();\n        PipedOutputStream out = new PipedOutputStream(in);\n        PrintWriter writer = new PrintWriter(out, true);\n\n        // Write test input to the pipe\n        writer.println(&quot;test&quot;);\n        writer.println(&quot;test2&quot;);\n\n        Terminal terminal = TerminalBuilder.builder()\n                .streams(in, System.out)\n                .build();\n\n        LineReader lineReader = LineReaderBuilder.builder()\n                .terminal(terminal)\n                .build();\n\n        System.out.println(&quot;Read: &quot; + lineReader.readLine());\n        System.out.println(&quot;Read: &quot; + lineReader.readLine());\n\n        writer.close();\n        terminal.close();\n    }\n</code></pre>\n",
    "score" : 1,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 6097406,
      "reputation" : 316,
      "user_id" : 4757784,
      "user_type" : "registered",
      "profile_image" : "https://lh6.googleusercontent.com/-5jsrL-7bG8I/AAAAAAAAAAI/AAAAAAAAABM/JMj0SpS1J1o/s256-rj/photo.jpg",
      "display_name" : "Emre Zorlu",
      "link" : "https://stackoverflow.com/users/4757784/emre-zorlu"
    },
    "creation_date" : 1764453894,
    "last_activity_date" : 1764453894,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : {
    "79833568" : [ {
      "comment_id" : 140879815,
      "post_id" : 79833568,
      "body" : "Thank you! Although the first seems to give an end of file exception:    ```  Exception in thread &quot;main&quot; org.jline.reader.EndOfFileException          at org.jline.reader.impl.LineReaderImpl.readLine(LineReaderImpl&zwnj;&#8203;.java:691)          at org.jline.reader.impl.LineReaderImpl.readLine(LineReaderImpl&zwnj;&#8203;.java:489)          at edu.ntnu.idi.idat.TestCode.main(TestCode.java:35)  ```",
      "score" : 0,
      "owner" : {
        "account_id" : 37604239,
        "reputation" : 95,
        "user_id" : 28332552,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/5a84dbd7a917124e895a66d1b7b38d61?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "Lucy",
        "link" : "https://stackoverflow.com/users/28332552/lucy"
      },
      "creation_date" : 1764488456,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}