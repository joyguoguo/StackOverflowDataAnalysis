{
  "question" : {
    "question_id" : 79786102,
    "title" : "Can a backend using Multer for file uploads recognize an image sent as a byte[] in the request?",
    "body" : "<p>In a B/S architecture system, the backend is written in Node.js and uses Multer to handle file uploads, and the frontend is an Android application written in Java. If the frontend gets photo data from the camera as a byte[] (YUV), transforms it to JPEG form's byte[], wraps it to multipart/form-data, and sends it to the backend, can Multer correctly recognize this uploaded file and save the picture successfully?</p>\n<p>The code in Android is like this:</p>\n<pre><code>public void login(String account,, byte[] photoYUVBytes, final LoginCallback callback) {\n        RequestBody accountBody = account != null ? RequestBody.create(MediaType.parse(&quot;text/plain&quot;), account) : null;\n        MultipartBody.Part photoPart = null;\n        if (photoYUVBytes != null) {\n            Camera.Size size = MainFragment.getPreviewSize();\n            byte[] photoBytes = yuvToJpeg(photoYUVBytes,size.width,size.height);\n            RequestBody photoBody = RequestBody.create(MediaType.parse(&quot;image/*&quot;), photoBytes);\n            photoPart = MultipartBody.Part.createFormData(&quot;photo&quot;, &quot;face.jpg&quot;, photoBody);\n        }\n\n        Call&lt;LoginResponse&gt; call = loginApi.login(accountBody, photoPart);\n        call.enqueue(new Callback&lt;LoginResponse&gt;() {\n            @Override\n            public void onResponse(Call&lt;LoginResponse&gt; call, Response&lt;LoginResponse&gt; response) {\n                if (response.isSuccessful() &amp;&amp; response.body() != null) {\n                    callback.onSuccess(response.body());\n                } else {\n                    callback.onError(...);\n                }\n            }\n        });\n    }\n</code></pre>\n<p>and the backend code is like this:</p>\n<pre class=\"lang-js prettyprint-override\"><code>const storage = multer.diskStorage({\n    destination: function (req, file, cb) {\n        cb(null, 'uploads/'); // store catalog\n    },\n    filename: function (req, file, cb) {\n        const ext = path.extname(file.originalname) || '.jpg'; \n        cb(null, `${Date.now()}${ext}`);\n    }\n});\nconst upload = multer({ storage: storage });\nrouter.post(&quot;/login&quot;, upload.single(&quot;photo&quot;) , async (req, res) =&gt; {...}\n</code></pre>\n",
    "tags" : [ "javascript", "java", "android", "node.js", "multer" ],
    "owner" : {
      "account_id" : 36075145,
      "reputation" : 87,
      "user_id" : 27551345,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/2LH7DwM6.jpg?s=256",
      "display_name" : "OuterTowner",
      "link" : "https://stackoverflow.com/users/27551345/outertowner"
    },
    "is_answered" : false,
    "view_count" : 71,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1759992016,
    "creation_date" : 1759992016,
    "link" : "https://stackoverflow.com/questions/79786102/can-a-backend-using-multer-for-file-uploads-recognize-an-image-sent-as-a-byte",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140794209,
    "post_id" : 79786102,
    "body" : "The only way to figure the type of any files is by looking at the file signature header. Here is the list of known files and their file signatures. This way, you figure the filetype without just the file extension. <a href=\"https://en.wikipedia.org/wiki/List_of_file_signatures\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/List_of_file_signatures</a>",
    "score" : 0,
    "owner" : {
      "account_id" : 13383247,
      "reputation" : 474,
      "user_id" : 9657881,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/s256-rj/photo.jpg",
      "display_name" : "vicki",
      "link" : "https://stackoverflow.com/users/9657881/vicki"
    },
    "creation_date" : 1760425241,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140785628,
    "post_id" : 79786102,
    "body" : "@L&#227;NgọcHải Thanks for your answer.",
    "score" : 0,
    "owner" : {
      "account_id" : 36075145,
      "reputation" : 87,
      "user_id" : 27551345,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/2LH7DwM6.jpg?s=256",
      "display_name" : "OuterTowner",
      "link" : "https://stackoverflow.com/users/27551345/outertowner"
    },
    "creation_date" : 1759993677,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140785611,
    "post_id" : 79786102,
    "body" : "If you can&#39;t run it then how could we run your code? At most we can only guess that it looks correct without any real confirmation. It does look kinda correct to me though",
    "score" : 0,
    "owner" : {
      "account_id" : 27963168,
      "reputation" : 683,
      "user_id" : 21354514,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/TplE583J.jpg?s=256",
      "display_name" : "L&#227; Ngọc Hải",
      "link" : "https://stackoverflow.com/users/21354514/l%c3%a3-ng%e1%bb%8dc-h%e1%ba%a3i"
    },
    "creation_date" : 1759993116,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140785592,
    "post_id" : 79786102,
    "body" : "@L&#227;NgọcHải It couldn&#39;t run in my own device because these code are just part, and some other code is relative to serial part and hardware which my device don&#39;t have. And my backend is on developing which make them can not deployed in server.",
    "score" : 0,
    "owner" : {
      "account_id" : 36075145,
      "reputation" : 87,
      "user_id" : 27551345,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/2LH7DwM6.jpg?s=256",
      "display_name" : "OuterTowner",
      "link" : "https://stackoverflow.com/users/27551345/outertowner"
    },
    "creation_date" : 1759992619,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140785585,
    "post_id" : 79786102,
    "body" : "Have you run this code on your own device? If it doesn&#39;t work then what&#39;s the error?",
    "score" : 0,
    "owner" : {
      "account_id" : 27963168,
      "reputation" : 683,
      "user_id" : 21354514,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/TplE583J.jpg?s=256",
      "display_name" : "L&#227; Ngọc Hải",
      "link" : "https://stackoverflow.com/users/21354514/l%c3%a3-ng%e1%bb%8dc-h%e1%ba%a3i"
    },
    "creation_date" : 1759992309,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}