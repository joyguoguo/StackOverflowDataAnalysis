{
  "question" : {
    "question_id" : 79827728,
    "title" : "Mockito ArgumentMatchers.any(Class) for varargs parameter does not match",
    "body" : "<p>I have test method using mockito 5</p>\n<pre><code>    @Test\n    public void test_increaseUserScore_Successful() throws CannotCreateCachedUserException {\n        when(cachedUserRepository\n                .existsById(anyLong())\n        ).thenReturn(true);\n\n        when(leaderboardInfoRepository\n                .findById(anyString())\n        ).thenReturn(Optional.of(testLeaderboardInfo));\n\n        when(cachedUserRepository\n                .findById(anyLong())\n        ).thenReturn(Optional.of(userCached));\n\n        when(stringRedisTemplate\n                        .execute(\n                                eq(mutableLeaderboardScript), //RedisScript\n                                anyList(), // List with Keys\n                                any(Object.class) // Object args... which does not match \n                        )\n        ).thenReturn(&quot;success&quot;);\n\n        leaderboardService.increaseUserScore(userScoreEvent);\n\n        verify(stringRedisTemplate, times(1))\n                .execute(eq(mutableLeaderboardScript), anyList(), any(Object.class));\n    }\n</code></pre>\n<p>Here is the problem stringRedisTemplate of execute has signature(RedisScript script, List keys, Object args...)  i cannot match args... to any(Object.class).</p>\n<p>I either take exception PotentialStubbingProblem:</p>\n<pre><code>org.mockito.exceptions.misusing.PotentialStubbingProblem: \nStrict stubbing argument mismatch. Please check:\n - this invocation of 'execute' method:\n    stringRedisTemplate.execute(\n    mutableLeaderboardScript,\n    [user_cached:11:dailyAttempts, user_cached:11:totalAttempts, leaderboard:lb-123:mutable, user_cached:11, global-leaderboard-stream, local-leaderboard-stream],\n    &quot;11&quot;,\n    &quot;10.0&quot;,\n    &quot;5&quot;,\n    &quot;2&quot;,\n    &quot;[ZZ]&quot;,\n    &quot;20&quot;,\n    &quot;lb-123&quot;,\n    &quot;ZZ&quot;\n);\n- has following stubbing(s) with different arguments:\n    1. stringRedisTemplate.execute(null, [], null);\n</code></pre>\n<p>or null, which depends on lenient annotation, the same result will be given if i replace any() on  ArgumentMatchers.&lt;Object'&gt;'any(), any(Object[].class) and (Object[]) any()</p>\n",
    "tags" : [ "java", "mocking", "mockito", "spring-data-redis" ],
    "owner" : {
      "account_id" : 31962108,
      "reputation" : 19,
      "user_id" : 24771318,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/218dec0058d8c0e4d6b705de42b90c52?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "JZARGO",
      "link" : "https://stackoverflow.com/users/24771318/jzargo"
    },
    "is_answered" : true,
    "view_count" : 92,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1763991223,
    "creation_date" : 1763880874,
    "link" : "https://stackoverflow.com/questions/79827728/mockito-argumentmatchers-anyclass-for-varargs-parameter-does-not-match",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ ],
  "answer_comments" : { }
}