{
  "question" : {
    "question_id" : 79533170,
    "title" : "Copy Excel file xslx encoding problems",
    "body" : "<p>I am trying to copy an xslx file from a remote system within a jenkins groovy script. This xslx file is encoded with windows-1252, so I give this Charset to the FileReader and FileWriter:</p>\n<pre><code>OutputStreamWriter osw = new OutputStreamWriter(new FileOutputStream(file), Charset.forName(&quot;windows-1252&quot;));\n\n            BufferedWriter bufferedWriter = new BufferedWriter(osw);\n\n            try (BufferedReader reader = new BufferedReader(new InputStreamReader(new SmbFileInputStream(sFile), Charset.forName(&quot;windows-1252&quot;)))) {\n                int byteRead;\n\n                while ((byteRead = reader.read()) != -1) {\n                    bufferedWriter.write(byteRead);\n                }\n\n                bufferedWriter.flush();\n            }\n</code></pre>\n<p>The result xslx is encoded in windows-1252 and has nrly the same content, but there were additional questionmarks added into it:</p>\n<p><a href=\"https://i.sstatic.net/pQENpMfg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/pQENpMfg.png\" alt=\"Compare between source (right) and copy (left)\" /></a></p>\n<p>Can anybody tell me where those come from and how I can get my correct file content?</p>\n",
    "tags" : [ "java", "groovy", "character-encoding", "charset" ],
    "owner" : {
      "account_id" : 4816375,
      "reputation" : 69,
      "user_id" : 3888367,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/13ae0fbd670bb0595000752457900b37?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Kaffetrinken",
      "link" : "https://stackoverflow.com/users/3888367/kaffetrinken"
    },
    "is_answered" : true,
    "view_count" : 74,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1742914943,
    "creation_date" : 1742893932,
    "link" : "https://stackoverflow.com/questions/79533170/copy-excel-file-xslx-encoding-problems",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79534063,
    "question_id" : 79533170,
    "body" : "<p>Copying files does NOT require interpretation of their contents.  All files are bags of bytes regardless if they are binary or text.  Bytes do not require you interpret them (ie using Charsets).</p>\n<p>This makes it easy for you to perform this using just InputStream and OutputStream.</p>\n<pre><code>file.withOutputStream { out -&gt;\n   new SmbFileInputStream(sFile).withCloseable { smb -&gt;\n      out &lt;&lt; smb\n   }\n}\n</code></pre>\n<p>This has been groovy'ed up so as to limit how much code you need to write, but it's essentially doing the exact same thing your code was doing, but only using InputStream and OutputStream.  This also flushes and closes streams for you similar to try-resource statements.</p>\n",
    "score" : 1,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 51881,
      "reputation" : 39410,
      "user_id" : 155020,
      "user_type" : "registered",
      "accept_rate" : 80,
      "profile_image" : "https://i.sstatic.net/fEqVo.png?s=256",
      "display_name" : "chubbsondubs",
      "link" : "https://stackoverflow.com/users/155020/chubbsondubs"
    },
    "creation_date" : 1742914683,
    "last_activity_date" : 1742914683,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140261474,
    "post_id" : 79533170,
    "body" : "Is there something wrong with using e.g. <code>sh &quot;cp $sFile $file&quot;</code> if all you need is a copy?",
    "score" : 0,
    "owner" : {
      "account_id" : 2335086,
      "reputation" : 7004,
      "user_id" : 2047614,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/4ab539541e2207aa691d3c4566b9b2b6?s=256&d=identicon&r=PG",
      "display_name" : "MaratC",
      "link" : "https://stackoverflow.com/users/2047614/maratc"
    },
    "creation_date" : 1742914988,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140260528,
    "post_id" : 79533170,
    "body" : "Thanks a lot, IOUtils.copy(new SmbFileInputStream(sFile),Files.newOutputStream(file.toPath(&zwnj;&#8203;))) did the job",
    "score" : 0,
    "owner" : {
      "account_id" : 4816375,
      "reputation" : 69,
      "user_id" : 3888367,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/13ae0fbd670bb0595000752457900b37?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Kaffetrinken",
      "link" : "https://stackoverflow.com/users/3888367/kaffetrinken"
    },
    "creation_date" : 1742901851,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140260253,
    "post_id" : 79533170,
    "body" : "If you just want to copy a file 1:1 you don&#39;t need to care about encoding. You can copy bytes directly from <code>SmbFileInputStream</code> to <code>FileOutputStream</code>. <a href=\"https://stackoverflow.com/questions/43157/easy-way-to-write-contents-of-a-java-inputstream-to-an-outputstream\" title=\"easy way to write contents of a java inputstream to an outputstream\">stackoverflow.com/questions/43157/&hellip;</a>",
    "score" : 1,
    "owner" : {
      "account_id" : 10259402,
      "reputation" : 28306,
      "user_id" : 7571258,
      "user_type" : "registered",
      "accept_rate" : 62,
      "profile_image" : "https://i.sstatic.net/fBP6e.png?s=256",
      "display_name" : "zett42",
      "link" : "https://stackoverflow.com/users/7571258/zett42"
    },
    "creation_date" : 1742898003,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140260042,
    "post_id" : 79533170,
    "body" : "xslx is binary file. You need to treat it like that.",
    "score" : 2,
    "owner" : {
      "account_id" : 4497436,
      "reputation" : 20786,
      "user_id" : 3656904,
      "user_type" : "registered",
      "accept_rate" : 67,
      "profile_image" : "https://www.gravatar.com/avatar/8bdbd1f89f8907e8e8b15ab88c084c65?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "talex",
      "link" : "https://stackoverflow.com/users/3656904/talex"
    },
    "creation_date" : 1742894921,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}