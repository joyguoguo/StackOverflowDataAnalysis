{
  "question" : {
    "question_id" : 79835242,
    "title" : "Android Java - UI does not load intermittently",
    "body" : "<p>Im developing a app in Android using Java.</p>\n<p>When i run the app in android studio the UI does not load completely, i can see the bottom navigation and toolbar but the fragments do not load 90% of the time when i run the app in Android Studio.</p>\n<p>This is the main layout when the app loads:</p>\n<pre><code>    package com.balu.datez;\n    import com.google.gson.Gson;\n    import com.microsoft.signalr.HubConnection;\n    import com.microsoft.signalr.HubConnectionBuilder;\n    \n    import android.content.Intent;\n    import android.content.SharedPreferences;\n    import android.os.Bundle;\n    import androidx.activity.OnBackPressedCallback;\n    import androidx.annotation.NonNull;\n    import androidx.appcompat.app.ActionBarDrawerToggle;\n    import androidx.appcompat.app.AppCompatActivity;\n    import androidx.core.view.GravityCompat;\n    import androidx.drawerlayout.widget.DrawerLayout;\n    \n    import android.os.Handler;\n    import android.os.Looper;\n    import android.view.MenuItem;\n    import android.widget.Toast;\n    import androidx.appcompat.widget.Toolbar;\n    \n    import com.google.android.material.bottomnavigation.BottomNavigationView;\n    import com.google.android.material.navigation.NavigationView;\n    import com.microsoft.signalr.HubConnectionState;\n    \n    import androidx.activity.EdgeToEdge;\n    import androidx.fragment.app.Fragment;\n    import androidx.fragment.app.FragmentManager;\n    import androidx.fragment.app.FragmentTransaction;\n    \n    import java.util.concurrent.ExecutorService;\n    import java.util.concurrent.Executors;\n    \n    \n    public class MainLayoutActivity extends AppCompatActivity {\n    \n        SignalRConnectionsMainHelper signalConnectionsMainHelper;\n        SignalRFollowsMainHelper signalRFollowsMainHelper;\n        private DrawerLayout drawerLayout;\n        private NavigationView navigationView;\n        private Toolbar toolbar;\n        Fragment homeFragment;\n        InteractionsFragment interactionFragment;\n        Fragment highlightsFragment;\n        Fragment searchFragment;\n        FragmentTransaction transaction;\n        @Override\n        protected void onCreate(Bundle savedInstanceState) {\n            super.onCreate(savedInstanceState);\n            EdgeToEdge.enable(this);\n            setContentView(R.layout.activity_main_layout);\n    \n            HttpsHelper.trustAllCertificates();\n    \n            SharedPreferences settingsLoginData = getApplicationContext().getSharedPreferences(&quot;LoginData&quot;, 0);\n            String userGuidSP = settingsLoginData.getString(&quot;userGuid&quot;, &quot;&quot;);\n    \n            drawerLayout = findViewById(R.id.drawer_layout);\n            toolbar = findViewById(R.id.toolbar);\n            navigationView = findViewById(R.id.nav_view);\n    \n            Intent intent = getIntent();\n            if(intent.getBooleanExtra(&quot;newProfileAdded&quot;, false)){\n    \n            }\n    \n            BottomNavigationView bottomNavigationView = findViewById(R.id.bottomNavigationView);\n    \n            FragmentManager fragmentManager = getSupportFragmentManager();\n            transaction = fragmentManager.beginTransaction();\n    \n            homeFragment = new HomeFragment();\n            interactionFragment = new InteractionsFragment();\n            highlightsFragment = new HighlightsFragment();\n            searchFragment = new SearchFragment();\n    \n    \n            signalConnectionsMainHelper = new SignalRConnectionsMainHelper(this, interactionFragment, userGuidSP);\n            signalRFollowsMainHelper = new SignalRFollowsMainHelper(this, interactionFragment, userGuidSP);\n    \n            new Thread(() -&gt; {\n                transaction.add(R.id.fragment_container, homeFragment);\n                transaction.add(R.id.fragment_container, interactionFragment);\n                transaction.add(R.id.fragment_container, highlightsFragment);\n                transaction.add(R.id.fragment_container, searchFragment);\n    \n                toolbar.setTitle(&quot;Home&quot;);\n    \n                transaction.show(homeFragment);\n                transaction.hide(interactionFragment);\n                transaction.hide(highlightsFragment);\n                transaction.hide(searchFragment);\n                transaction.commit();  // crashes in RUN, sometimes works in DEBUG\n            }).start();\n    \n    \n            //setCurrentFragment(homeFragment, &quot;Home&quot;);\n    \n            bottomNavigationView.setOnItemSelectedListener(item -&gt; {\n                FragmentTransaction transactionTemp = getSupportFragmentManager().beginTransaction();\n    \n                switch (item.getItemId()) {\n                    case R.id.home:\n                        toolbar.setTitle(&quot;Home&quot;);\n                        transactionTemp.show(homeFragment);\n                        transactionTemp.hide(interactionFragment);\n                        transactionTemp.hide(highlightsFragment);\n                        transactionTemp.hide(searchFragment);\n                        transactionTemp.commit();\n                        break;\n                    case R.id.interations:\n                        toolbar.setTitle(&quot;Interactions&quot;);\n                        transactionTemp.hide(homeFragment);\n                        transactionTemp.show(interactionFragment);\n                        transactionTemp.hide(highlightsFragment);\n                        transactionTemp.hide(searchFragment);\n                        transactionTemp.commit();\n                        break;\n                    case R.id.highlights:\n                        toolbar.setTitle(&quot;Highlights&quot;);\n                        transactionTemp.hide(homeFragment);\n                        transactionTemp.hide(interactionFragment);\n                        transactionTemp.show(highlightsFragment);\n                        transactionTemp.hide(searchFragment);\n                        transactionTemp.commit();\n                        break;\n                    case R.id.search:\n                        toolbar.setTitle(&quot;Search&quot;);\n                        transactionTemp.hide(homeFragment);\n                        transactionTemp.hide(interactionFragment);\n                        transactionTemp.hide(highlightsFragment);\n                        transactionTemp.show(searchFragment);\n                        transactionTemp.commit();\n                        break;\n                }\n                return true;\n            });\n    \n            ActionBarDrawerToggle toggle = new ActionBarDrawerToggle(\n                    this, drawerLayout, toolbar, R.string.nav_open, R.string.nav_close);\n            drawerLayout.addDrawerListener(toggle);\n            toggle.syncState();\n            navigationView.setNavigationItemSelectedListener(new NavigationView.OnNavigationItemSelectedListener() {\n    \n                // Called when an item in the NavigationView is selected.\n                @Override\n                public boolean onNavigationItemSelected(@NonNull MenuItem item) {\n                    // Handle the selected item based on its ID\n                    FragmentTransaction transactionTemp = getSupportFragmentManager().beginTransaction();\n                    if (item.getItemId() == R.id.nav_home) {\n                        toolbar.setTitle(&quot;Home&quot;);\n                        transactionTemp.show(homeFragment);\n                        transactionTemp.hide(interactionFragment);\n                        transactionTemp.hide(highlightsFragment);\n                        transactionTemp.hide(searchFragment);\n                        transactionTemp.commit();\n                        MenuItem itemBottomNav = bottomNavigationView.getMenu().findItem(R.id.home);\n                        itemBottomNav.setChecked(true);\n                        // Show a Toast message for the Account item\n                        //Toast.makeText(MainActivity.this,\n                            //    &quot;Account Details&quot;, Toast.LENGTH_SHORT).show();\n                    }\n    \n                    if (item.getItemId() == R.id.nav_interactions) {\n                        toolbar.setTitle(&quot;Interactions&quot;);\n                        transactionTemp.hide(homeFragment);\n                        transactionTemp.show(interactionFragment);\n                        transactionTemp.hide(highlightsFragment);\n                        transactionTemp.hide(searchFragment);\n                        transactionTemp.commit();\n                        MenuItem itemBottomNav = bottomNavigationView.getMenu().findItem(R.id.interations);\n                        itemBottomNav.setChecked(true);\n                        // Show a Toast message for the Settings item\n                        //Toast.makeText(MainActivity.this,\n                             //   &quot;Settings Opened&quot;, Toast.LENGTH_SHORT).show();\n                    }\n    \n                    if (item.getItemId() == R.id.nav_highlights) {\n                        toolbar.setTitle(&quot;Highlights&quot;);\n                        transactionTemp.hide(homeFragment);\n                        transactionTemp.hide(interactionFragment);\n                        transactionTemp.show(highlightsFragment);\n                        transactionTemp.hide(searchFragment);\n                        transactionTemp.commit();\n                        MenuItem itemBottomNav = bottomNavigationView.getMenu().findItem(R.id.highlights);\n                        itemBottomNav.setChecked(true);\n                        // Show a Toast message for the Logout item\n                        //Toast.makeText(MainActivity.this,\n                             //   &quot;You are Logged Out&quot;, Toast.LENGTH_SHORT).show();\n                    }\n    \n                    if (item.getItemId() == R.id.nav_search) {\n                        toolbar.setTitle(&quot;Search&quot;);\n                        transactionTemp.hide(homeFragment);\n                        transactionTemp.hide(interactionFragment);\n                        transactionTemp.hide(highlightsFragment);\n                        transactionTemp.show(searchFragment);\n                        transactionTemp.commit();\n                        MenuItem itemBottomNav = bottomNavigationView.getMenu().findItem(R.id.search);\n                        itemBottomNav.setChecked(true);\n                        // Show a Toast message for the Logout item\n                        //Toast.makeText(MainActivity.this,\n                        //   &quot;You are Logged Out&quot;, Toast.LENGTH_SHORT).show();\n                    }\n    \n                    // Close the drawer after selection\n                    drawerLayout.closeDrawers();\n                    // Indicate that the item selection has been handled\n                    return true;\n                }\n            });\n    \n            // Add a callback to handle the back button press\n            getOnBackPressedDispatcher().addCallback(this, new OnBackPressedCallback(true) {\n                // Called when the back button is pressed.\n                @Override\n                public void handleOnBackPressed() {\n                    // Check if the drawer is open\n                    if (drawerLayout.isDrawerOpen(GravityCompat.START)) {\n                        // Close the drawer if it's open\n                        drawerLayout.closeDrawer(GravityCompat.START);\n                    } else {\n                        // Finish the activity if the drawer is closed\n                        finish();\n                    }\n                }\n            });\n        }\n    \n        private void setCurrentFragment(Fragment fragment, String title) {\n            toolbar.setTitle(title);\n            getSupportFragmentManager()\n                    .beginTransaction()\n                    .replace(R.id.fragment_container, fragment)\n                    .commit();\n        }\n    }\n</code></pre>\n<p>Is this something to do with Android Studio or is this to do with my code?</p>\n<p>I tried:</p>\n<pre><code>new Thread(() -&gt; {\n        transaction.add(R.id.fragment_container, homeFragment);\n        transaction.add(R.id.fragment_container, interactionFragment);\n        transaction.add(R.id.fragment_container, highlightsFragment);\n        transaction.add(R.id.fragment_container, searchFragment);\n\n        toolbar.setTitle(&quot;Home&quot;);\n\n        transaction.show(homeFragment);\n        transaction.hide(interactionFragment);\n        transaction.hide(highlightsFragment);\n        transaction.hide(searchFragment);\n        transaction.commit();  // crashes in RUN, sometimes works in DEBUG\n    }).start();\n</code></pre>\n<p>But still no luck.</p>\n",
    "tags" : [ "java", "android" ],
    "owner" : {
      "account_id" : 198763,
      "reputation" : 2527,
      "user_id" : 443626,
      "user_type" : "registered",
      "accept_rate" : 70,
      "profile_image" : "https://www.gravatar.com/avatar/1ba1aed46f15b9daaf993f4b2ec1d04e?s=256&d=identicon&r=PG",
      "display_name" : "redoc01",
      "link" : "https://stackoverflow.com/users/443626/redoc01"
    },
    "is_answered" : false,
    "view_count" : 30,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1764619577,
    "creation_date" : 1764619577,
    "link" : "https://stackoverflow.com/questions/79835242/android-java-ui-does-not-load-intermittently",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140883393,
    "post_id" : 79835242,
    "body" : "from the code that you show above there is zero reason to use runOnUiThread, you should ask a new question about any errors you are getting",
    "score" : 0,
    "owner" : {
      "account_id" : 295108,
      "reputation" : 74849,
      "user_id" : 599346,
      "user_type" : "registered",
      "accept_rate" : 85,
      "profile_image" : "https://www.gravatar.com/avatar/be66588cfacdbed6f5b7581e4eec4c95?s=256&d=identicon&r=PG",
      "display_name" : "tyczj",
      "link" : "https://stackoverflow.com/users/599346/tyczj"
    },
    "creation_date" : 1764684356,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140882480,
    "post_id" : 79835242,
    "body" : "But when I remove the runonuithread the ui does not load but when I add the runonuithread the ui loads all the time @tyczj",
    "score" : 0,
    "owner" : {
      "account_id" : 198763,
      "reputation" : 2527,
      "user_id" : 443626,
      "user_type" : "registered",
      "accept_rate" : 70,
      "profile_image" : "https://www.gravatar.com/avatar/1ba1aed46f15b9daaf993f4b2ec1d04e?s=256&d=identicon&r=PG",
      "display_name" : "redoc01",
      "link" : "https://stackoverflow.com/users/443626/redoc01"
    },
    "creation_date" : 1764641837,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140882169,
    "post_id" : 79835242,
    "body" : "You never do anything related to the UI in another thread runonuithread only matters when you start working in a different thread so if you are replacing your <code>Thread</code> with <code>runOnUiThread</code> you dont need the runOnUiThread, by default you are on the ui thread",
    "score" : 0,
    "owner" : {
      "account_id" : 295108,
      "reputation" : 74849,
      "user_id" : 599346,
      "user_type" : "registered",
      "accept_rate" : 85,
      "profile_image" : "https://www.gravatar.com/avatar/be66588cfacdbed6f5b7581e4eec4c95?s=256&d=identicon&r=PG",
      "display_name" : "tyczj",
      "link" : "https://stackoverflow.com/users/599346/tyczj"
    },
    "creation_date" : 1764622938,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140882142,
    "post_id" : 79835242,
    "body" : "I have used runonuithread and works great now thanks @tyczj",
    "score" : 0,
    "owner" : {
      "account_id" : 198763,
      "reputation" : 2527,
      "user_id" : 443626,
      "user_type" : "registered",
      "accept_rate" : 70,
      "profile_image" : "https://www.gravatar.com/avatar/1ba1aed46f15b9daaf993f4b2ec1d04e?s=256&d=identicon&r=PG",
      "display_name" : "redoc01",
      "link" : "https://stackoverflow.com/users/443626/redoc01"
    },
    "creation_date" : 1764621858,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140882116,
    "post_id" : 79835242,
    "body" : "How am I supposed to do it, is that why the Ui does not load even in a new thread code",
    "score" : 0,
    "owner" : {
      "account_id" : 198763,
      "reputation" : 2527,
      "user_id" : 443626,
      "user_type" : "registered",
      "accept_rate" : 70,
      "profile_image" : "https://www.gravatar.com/avatar/1ba1aed46f15b9daaf993f4b2ec1d04e?s=256&d=identicon&r=PG",
      "display_name" : "redoc01",
      "link" : "https://stackoverflow.com/users/443626/redoc01"
    },
    "creation_date" : 1764620618,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140882098,
    "post_id" : 79835242,
    "body" : "Why are you trying to do UI actions in a non-UI thread?",
    "score" : 0,
    "owner" : {
      "account_id" : 295108,
      "reputation" : 74849,
      "user_id" : 599346,
      "user_type" : "registered",
      "accept_rate" : 85,
      "profile_image" : "https://www.gravatar.com/avatar/be66588cfacdbed6f5b7581e4eec4c95?s=256&d=identicon&r=PG",
      "display_name" : "tyczj",
      "link" : "https://stackoverflow.com/users/599346/tyczj"
    },
    "creation_date" : 1764619883,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}