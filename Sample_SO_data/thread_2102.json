{
  "question" : {
    "question_id" : 79646944,
    "title" : "Query working before updating to spring boot 3.5 and hibernate 6.5",
    "body" : "<p>With spring <code>2.7.4</code> this query was working</p>\n<pre class=\"lang-java prettyprint-override\"><code>    @Query(value=&quot;FROM chats as c where (first_user = :user or second_user = :user)&quot;)\n    Page&lt;Chat&gt; findNextUserChats(\n            @Param(&quot;user&quot;) long id,\n            @Param(&quot;lastId&quot;) long lastId,\n            @Param(&quot;lastUpdatedAt&quot;) String lastUpdatedAt,\n            Pageable pageable);`\n</code></pre>\n<p>But with Spring boot <code>3.5</code> and hibernate <code>6.5</code> it give me an error</p>\n<blockquote>\n<p>Reason: At 1:75 and token '', no viable alternative at input 'FROM chats as c LEFT JOIN users (first_user = :user or second_user = :user)*'; Bad HQL grammar [FROM chats as c LEFT JOIN users (first_user = :user or second_user = :user)]</p>\n</blockquote>\n",
    "tags" : [ "java", "spring", "spring-boot", "hibernate" ],
    "owner" : {
      "account_id" : 40981258,
      "reputation" : 31,
      "user_id" : 30059512,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/fcfc753f015480e54172cb22e1014b78?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "gr aleksandrov",
      "link" : "https://stackoverflow.com/users/30059512/gr-aleksandrov"
    },
    "is_answered" : false,
    "view_count" : 376,
    "answer_count" : 1,
    "score" : 3,
    "last_activity_date" : 1748790765,
    "creation_date" : 1748720993,
    "link" : "https://stackoverflow.com/questions/79646944/query-working-before-updating-to-spring-boot-3-5-and-hibernate-6-5",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79647409,
    "question_id" : 79646944,
    "body" : "<p>Hibernate 6 enforces stricter JPQL parsing rules. You are using 'chats' as the entity name, but in HQL, you must use the entity class name, not the table name.<br />\nTry to create Chat class</p>\n<pre><code>@Entity\npublic class Chat {\n    @Id\n    private Long id;\n\n    @ManyToOne\n    private User firstUser;\n\n    @ManyToOne\n    private User secondUser;\n\n    private Instant updatedAt;\n}\n</code></pre>\n<p>Then try to fetch via following query &amp; mapping</p>\n<pre><code>@Query(&quot;&quot;&quot;\n    FROM Chat c \n    WHERE (c.firstUser.id = :user OR c.secondUser.id = :user)\n      AND (c.updatedAt &lt; :lastUpdatedAt OR (c.updatedAt = :lastUpdatedAt AND c.id &lt; :lastId))\n    &quot;&quot;&quot;)\nPage&lt;Chat&gt; findNextUserChats(\n        @Param(&quot;user&quot;) long id,\n        @Param(&quot;lastId&quot;) long lastId,\n        @Param(&quot;lastUpdatedAt&quot;) Instant lastUpdatedAt,\n        Pageable pageable);\n</code></pre>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 6097406,
      "reputation" : 316,
      "user_id" : 4757784,
      "user_type" : "registered",
      "profile_image" : "https://lh6.googleusercontent.com/-5jsrL-7bG8I/AAAAAAAAAAI/AAAAAAAAABM/JMj0SpS1J1o/s256-rj/photo.jpg",
      "display_name" : "Emre Zorlu",
      "link" : "https://stackoverflow.com/users/4757784/emre-zorlu"
    },
    "creation_date" : 1748773615,
    "last_activity_date" : 1748773615,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140476647,
    "post_id" : 79646944,
    "body" : "from Chats or Chat?",
    "score" : 0,
    "owner" : {
      "account_id" : 3719338,
      "reputation" : 12720,
      "user_id" : 3094731,
      "user_type" : "registered",
      "accept_rate" : 56,
      "profile_image" : "https://i.sstatic.net/yHWeg.jpg?s=256",
      "display_name" : "Abdullah Mohammad Motiullah",
      "link" : "https://stackoverflow.com/users/3094731/abdullah-mohammad-motiullah"
    },
    "creation_date" : 1748773122,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140475974,
    "post_id" : 79646944,
    "body" : "Please provide enough code so others can better understand or reproduce the problem.",
    "score" : 0,
    "owner" : {
      "account_id" : -1,
      "reputation" : 1,
      "user_id" : -1,
      "user_type" : "moderator",
      "profile_image" : "https://www.gravatar.com/avatar/a007be5a61f6aa8f3e85ae2fc18dd66e?s=256&d=identicon&r=PG",
      "display_name" : "Community",
      "link" : "https://stackoverflow.com/users/-1/community"
    },
    "creation_date" : 1748734811,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}