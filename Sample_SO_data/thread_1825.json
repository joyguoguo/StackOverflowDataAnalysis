{
  "question" : {
    "question_id" : 79672105,
    "title" : "Not able to use Coil library in Android View project with mixed Java-Kotlin code",
    "body" : "<p>I am trying to use the Coil image loading library in an Android View project with mixed Java-Kotlin source code.</p>\n<p><a href=\"https://github.com/coil-kt/coil\" rel=\"nofollow noreferrer\">https://github.com/coil-kt/coil</a></p>\n<p>I am following this guide about how to use the library in Java:</p>\n<p><a href=\"https://coil-kt.github.io/coil/java_compatibility/\" rel=\"nofollow noreferrer\">https://coil-kt.github.io/coil/java_compatibility/</a></p>\n<p>I have added the library to my gradle app file:</p>\n<pre><code> implementation(&quot;io.coil-kt.coil3:coil:3.2.0&quot;)\n implementation(&quot;io.coil-kt.coil3:coil-network-okhttp:3.2.0&quot;)\n</code></pre>\n<p>However, the compiler raises an incompatible types error in the following Java code.</p>\n<pre><code>ImageRequest request = new ImageRequest.Builder(context)\n    .data(&quot;https://example.com/image.jpg&quot;)\n    .crossfade(true)\n    .target(imageView)\n    .build();\nimageLoader.enqueue(request);\n</code></pre>\n<blockquote>\n<p>error: incompatible types: ImageView cannot be converted to Target\n.target(imageView)</p>\n</blockquote>\n<p>and in the following one the compiler is not able to find any ImageLoaders at all</p>\n<pre><code>ImageRequest request = new ImageRequest.Builder(context)\n    .data(&quot;https://example.com/image.jpg&quot;)\n    .size(1080, 1920)\n    .build();\nDrawable drawable = ImageLoaders.executeBlocking(imageLoader, request).getImage().asDrawable(context.resources);\n</code></pre>\n<p>Am I missing anything?\nHow can I use this library in Java?</p>\n",
    "tags" : [ "java", "android", "kotlin", "coil" ],
    "owner" : {
      "account_id" : 3554599,
      "reputation" : 2143,
      "user_id" : 2968650,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/2lBtq.jpg?s=256",
      "display_name" : "cristallo",
      "link" : "https://stackoverflow.com/users/2968650/cristallo"
    },
    "is_answered" : true,
    "view_count" : 320,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1754050260,
    "creation_date" : 1750338526,
    "link" : "https://stackoverflow.com/questions/79672105/not-able-to-use-coil-library-in-android-view-project-with-mixed-java-kotlin-code",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79673368,
    "question_id" : 79672105,
    "body" : "<p>After reading documentation, I think Coil 3.x no longer accepts a raw <code>ImageView</code> in <code>.target()</code>. Instead, you must wrap the <code>ImageView</code> in a <code>Target</code>.</p>\n<p>Use <code>ImageViewTarget</code> (Coil's wrapper) in Java like this:</p>\n<pre><code>import coil.target.ImageViewTarget;  \n\nImageRequest request = new ImageRequest.Builder(context)\n.data(&quot;https://example.com/image.jpg&quot;)     \n.crossfade(true)     \n.target(new ImageViewTarget(imageView))   \n .build();  \nimageLoader.enqueue(request);\n</code></pre>\n<p>Thereâ€™s no <code>ImageLoaders.executeBlocking()</code> method in Coil 3.x. Coil 3 moved to suspending functions, and Java cannot directly call suspend functions like <code>execute</code>.</p>\n<p>To use <code>execute</code> in Java, you must bridge through Kotlin. Here's how you can do it:</p>\n<hr />\n<h4>Option 1: Create a Kotlin helper function and call this method from java/kotlin classes</h4>\n<pre><code>// Kotlin\nimport android.content.Context\nimport coil.ImageLoader\nimport coil.request.ImageRequest\nimport coil.request.SuccessResult\nimport kotlinx.coroutines.Dispatchers\nimport kotlinx.coroutines.runBlocking\nimport kotlinx.coroutines.withContext\nimport android.graphics.drawable.Drawable\n\nfun loadImageBlocking(context: Context, imageLoader: ImageLoader, request: ImageRequest): Drawable? {\n    return runBlocking {\n        val result = imageLoader.execute(request)\n        if (result is SuccessResult) {\n            return@runBlocking result.drawable\n        }\n        return@runBlocking null\n    }\n}\n</code></pre>\n<h3></h3>\n<h3>Option 2: Use specific Coil utility ImageLoaders_nonJsCommonKt.executeBlocking</h3>\n<pre><code>ImageRequest request = new ImageRequest.Builder(context)\n.data(&quot;https://example.com/image.jpg&quot;)\n.size(1080, 1920)\n.build();\nImageLoaders_nonJsCommonKt.executeBlocking(imageLoader, request).getImage();\n</code></pre>\n<p>UPDATE: The issue with executeBlocking in Java, which was inaccessible, has been fixed in version 3.3.0.</p>\n",
    "score" : 1,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 8839888,
      "reputation" : 4157,
      "user_id" : 6602675,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/1caef5277ac0c3a3d52414204ffbc4bd?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Sharath kumar",
      "link" : "https://stackoverflow.com/users/6602675/sharath-kumar"
    },
    "creation_date" : 1750422248,
    "last_activity_date" : 1754050260,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : {
    "79673368" : [ {
      "comment_id" : 140564246,
      "post_id" : 79673368,
      "body" : "The absence of ImageLoaders class is related to an issue that occurred during the migration to Coil 3.x and multiplatform.   <a href=\"https://github.com/coil-kt/coil/discussions/3013\" rel=\"nofollow noreferrer\">github.com/coil-kt/coil/discussions/3013</a>  The executeBlocking is available in in class ImageLoaders_nonJsCommonKt.",
      "score" : 0,
      "owner" : {
        "account_id" : 3554599,
        "reputation" : 2143,
        "user_id" : 2968650,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/2lBtq.jpg?s=256",
        "display_name" : "cristallo",
        "link" : "https://stackoverflow.com/users/2968650/cristallo"
      },
      "creation_date" : 1751615414,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140529559,
      "post_id" : 79673368,
      "body" : "Regarding the mention of ImageLoaders.executeBlocking in the Java section of the documentation, it is likely an outdated reference, as it no longer exists in the latest version of the library. I&#39;ll implement a Kotlin wrapper as you suggested. Thank you!",
      "score" : 0,
      "owner" : {
        "account_id" : 3554599,
        "reputation" : 2143,
        "user_id" : 2968650,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/2lBtq.jpg?s=256",
        "display_name" : "cristallo",
        "link" : "https://stackoverflow.com/users/2968650/cristallo"
      },
      "creation_date" : 1750424145,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140529551,
      "post_id" : 79673368,
      "body" : "You are right about the target, but the proper solution should probably be something like .target(new ImageViewTarget(imageView)). Uffff :-(  the documentation on using Coil in Java is poor.",
      "score" : 0,
      "owner" : {
        "account_id" : 3554599,
        "reputation" : 2143,
        "user_id" : 2968650,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/2lBtq.jpg?s=256",
        "display_name" : "cristallo",
        "link" : "https://stackoverflow.com/users/2968650/cristallo"
      },
      "creation_date" : 1750423997,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}