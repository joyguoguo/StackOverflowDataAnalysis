{
  "question" : {
    "question_id" : 79807392,
    "title" : "Quarkus profile-aware config property picked up by different profile",
    "body" : "<p>Using Quarkus 3.29.0 my Maven build seems to hardcode a profile-specific property which is picked up by a different profile when not explicitly overridden. The build produces a fast-jar that runs in JVM mode. My project has three application configuration files under src/main/resources:</p>\n<pre><code>application.properties\napplication-dev.properties\napplication-prod.properties\n</code></pre>\n<p>In <strong>application-prod.properties</strong>, I have defined properties regarding <a href=\"https://quarkus.io/guides/security-cors\" rel=\"nofollow noreferrer\">Cross-Origin Resource Sharing (CORS)</a>. The other configuration files don't include any CORS-related configuration:</p>\n<pre><code>quarkus.http.cors.enabled=true\nquarkus.http.cors.origins=https://example.com\n</code></pre>\n<p>When building the app <strong>without a specific profile</strong> and running it <strong>with the dev profile</strong>, I get unexpected CORS behavior:</p>\n<pre><code>mvn clean verify\njava -Dquarkus.profile=dev -jar target/quarkus-app/quarkus-run.jar\ncurl -v -X OPTIONS http://127.0.0.1:8080 -H &quot;Origin: https://example.org&quot;\n--&gt; HTTP/1.1 403 CORS Rejected - Invalid origin\n</code></pre>\n<p>Only when building explicitly <strong>with the dev profile</strong> as well do I get the expected behavior:</p>\n<pre><code>mvn clean verify -Dquarkus.profile=dev\njava -Dquarkus.profile=dev -jar target/quarkus-app/quarkus-run.jar\ncurl -v -X OPTIONS http://127.0.0.1:8080 -H &quot;Origin: https://example.org&quot;\n--&gt; HTTP/1.1 200 OK\n</code></pre>\n<p>I can fix this problem by explicitly defining the following in <strong>application-dev.properties</strong>:</p>\n<pre><code>quarkus.http.cors.enabled=false\n</code></pre>\n<p>However, I would like to understand this behavior, as it contradicts the <a href=\"https://quarkus.io/guides/config-reference#profile-in-the-property-name\" rel=\"nofollow noreferrer\">documentation</a>:</p>\n<blockquote>\n<p>If a profile does not define a value for a specific attribute, the default (no profile) value is used:</p>\n</blockquote>\n<p>My assumption is that the property quarkus.http.cors.enabled is evaluated at build time, and that the build uses the prod profile by default. However, after <a href=\"https://quarkus.io/guides/config-reference#tracking-effective-build-time-configuration-used-at-build-time\" rel=\"nofollow noreferrer\">tracking the effective build-time configuration</a> in application.properties with</p>\n<pre><code>quarkus.config-tracking.enabled=true\n</code></pre>\n<p>I could not find any CORS-related properties in <strong>./quarkus/quarkus-prod-config-dump</strong> which would confirm usage during the build process. Furthermore, I saw a warning which claimed that <strong>application-prod.properties</strong> was not used at all during the build process:</p>\n<blockquote>\n<p>[WARNING] [io.quarkus.config] Profiled configuration file /application-prod.properties is ignored; a main application.properties configuration file must exist in the same location to load application-prod.properties</p>\n</blockquote>\n",
    "tags" : [ "java", "cors", "quarkus" ],
    "owner" : {
      "account_id" : 10032399,
      "reputation" : 103,
      "user_id" : 7418384,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/eV572.jpg?s=256",
      "display_name" : "Mambo",
      "link" : "https://stackoverflow.com/users/7418384/mambo"
    },
    "is_answered" : true,
    "view_count" : 149,
    "answer_count" : 1,
    "score" : 2,
    "last_activity_date" : 1762271402,
    "creation_date" : 1762118726,
    "link" : "https://stackoverflow.com/questions/79807392/quarkus-profile-aware-config-property-picked-up-by-different-profile",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79809109,
    "question_id" : 79807392,
    "body" : "<p>Yes, by default, Quarkus uses the <code>prod</code> profile during build time:</p>\n<p><a href=\"https://quarkus.io/guides/config-reference#build-time-configuration\" rel=\"nofollow noreferrer\">https://quarkus.io/guides/config-reference#build-time-configuration</a></p>\n<p>For <code>dev</code> you can override it as you did.</p>\n",
    "score" : 2,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 1954609,
      "reputation" : 1263,
      "user_id" : 1757919,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/d9a06fda174419c0dffb982f226518c2?s=256&d=identicon&r=PG",
      "display_name" : "Roberto Cortez",
      "link" : "https://stackoverflow.com/users/1757919/roberto-cortez"
    },
    "creation_date" : 1762271402,
    "last_activity_date" : 1762271402,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : {
    "79809109" : [ {
      "comment_id" : 140836762,
      "post_id" : 79809109,
      "body" : "Thanks for your response Roberto! In the docs the property quarkus.http.cors.enabled is not marked as &quot;fixed at build time&quot;. Can you also explain why this property was taken into account during the build and at the same time not listed in the effective build-time configuration report? What does the Maven warning mean â€” is it a bug? Because application-prod.properties is clearly not ignored in this case. Also application.properties exists in my case.",
      "score" : 0,
      "owner" : {
        "account_id" : 10032399,
        "reputation" : 103,
        "user_id" : 7418384,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/eV572.jpg?s=256",
        "display_name" : "Mambo",
        "link" : "https://stackoverflow.com/users/7418384/mambo"
      },
      "creation_date" : 1762295317,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}