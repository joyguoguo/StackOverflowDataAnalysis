{
  "question" : {
    "question_id" : 79667237,
    "title" : "License plate reading in Android Java",
    "body" : "<p>I am trying to read vehicle license plates in Android using Java. The code below keeps giving the message: Plate not detected.</p>\n<p>It shows the camera in the preview box but doesn't seem to be recognizing that the picture has any text in it. Does the preview box (androidx.camera.view.PreviewView) need any particular attributes or size? Do any specific dependencies need to be added?</p>\n<p>What am I doing wrong?</p>\n<pre><code>public class MainActivity extends AppCompatActivity {\n    private PreviewView previewView;\n    private ImageCapture imageCapture;\n    private Executor executor = Executors.newSingleThreadExecutor();\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_main);\n        previewView = findViewById(R.id.previewView);\n\n        if (ContextCompat.checkSelfPermission(this, Manifest.permission.CAMERA)\n                != PackageManager.PERMISSION_GRANTED) {\n            ActivityCompat.requestPermissions(this, new String[]{Manifest.permission.CAMERA}, 101);\n        } else {\n            startCamera();\n        }\n\n        findViewById(R.id.captureButton).setOnClickListener(v -&gt; captureAndRecognizeText());\n    }\n\n    private void startCamera() {\n        ListenableFuture&lt;ProcessCameraProvider&gt; cameraProviderFuture =\n                ProcessCameraProvider.getInstance(this);\n\n        cameraProviderFuture.addListener(() -&gt; {\n            try {\n                ProcessCameraProvider cameraProvider = cameraProviderFuture.get();\n                Preview preview = new Preview.Builder().build();\n                imageCapture = new ImageCapture.Builder().build();\n\n                CameraSelector cameraSelector = CameraSelector.DEFAULT_BACK_CAMERA;\n\n                cameraProvider.unbindAll();\n                cameraProvider.bindToLifecycle(this, cameraSelector, preview, imageCapture);\n                preview.setSurfaceProvider(previewView.getSurfaceProvider());\n\n            } catch (ExecutionException | InterruptedException e) {\n                e.printStackTrace();\n            }\n        }, ContextCompat.getMainExecutor(this));\n    }\n\n    private void captureAndRecognizeText() {\n        File photoFile = new File(getCacheDir(), &quot;plate.jpg&quot;);\n\n        ImageCapture.OutputFileOptions outputFileOptions =\n                new ImageCapture.OutputFileOptions.Builder(photoFile).build();\n\n        imageCapture.takePicture(outputFileOptions, executor, new ImageCapture.OnImageSavedCallback() {\n            @Override\n            public void onImageSaved(@NonNull ImageCapture.OutputFileResults outputFileResults) {\n                runOnUiThread(() -&gt; recognizeText(photoFile));\n            }\n\n            @Override\n            public void onError(@NonNull ImageCaptureException exception) {\n                Log.e(&quot;Camera&quot;, &quot;Photo capture failed: &quot; + exception.getMessage(), exception);\n            }\n        });\n    }\n\n    private void recognizeText(File imageFile) {\n        InputImage image;\n        try {\n            image = InputImage.fromFilePath(this, Uri.fromFile(imageFile));\n        } catch (IOException e) {\n            e.printStackTrace();\n            return;\n        }\n\n        TextRecognizer recognizer = TextRecognition.getClient();\n        recognizer.process(image)\n            .addOnSuccessListener(visionText -&gt; {\n                String resultText = visionText.getText();\n                // Filter only possible license plate format (example logic)\n                for (Text.TextBlock block : visionText.getTextBlocks()) {\n                    String text = block.getText();\n                    if (text.matches(&quot;.*[A-Z]{2,3}\\\\s*\\\\d{3,4}.*&quot;)) {\n                        Toast.makeText(this, &quot;Plate: &quot; + text, Toast.LENGTH_LONG).show();\n                        return;\n                    }\n                }\n                Toast.makeText(this, &quot;Plate not detected&quot;, Toast.LENGTH_LONG).show();\n            })\n            .addOnFailureListener(\n                e -&gt; Toast.makeText(this, &quot;Failed to read text&quot;, Toast.LENGTH_SHORT).show());\n    }\n}\n</code></pre>\n<p>I have added the permissions</p>\n<pre><code>&lt;uses-permission android:name=&quot;android.permission.CAMERA&quot; /&gt;\n&lt;uses-permission android:name=&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot;/&gt;\n&lt;uses-permission android:name=&quot;android.permission.READ_EXTERNAL_STORAGE&quot;/&gt;\n\n&lt;application&gt;\n    ...\n    &lt;uses-feature android:name=&quot;android.hardware.camera.any&quot;/&gt;\n&lt;/application&gt;\n</code></pre>\n",
    "tags" : [ "java", "android" ],
    "owner" : {
      "account_id" : 9722759,
      "reputation" : 698,
      "user_id" : 7210927,
      "user_type" : "registered",
      "profile_image" : "https://lh4.googleusercontent.com/-MeJxiLCjIpg/AAAAAAAAAAI/AAAAAAAADd0/X3bd1VJWFlI/s256-rj/photo.jpg",
      "display_name" : "Hussain Akbar",
      "link" : "https://stackoverflow.com/users/7210927/hussain-akbar"
    },
    "is_answered" : false,
    "view_count" : 59,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1750060754,
    "creation_date" : 1750060754,
    "link" : "https://stackoverflow.com/questions/79667237/license-plate-reading-in-android-java",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140522826,
    "post_id" : 79667237,
    "body" : "Yep, debugging did the trick. The program works. The numbers I was scanning had dashes, so the regex was failing.",
    "score" : 0,
    "owner" : {
      "account_id" : 9722759,
      "reputation" : 698,
      "user_id" : 7210927,
      "user_type" : "registered",
      "profile_image" : "https://lh4.googleusercontent.com/-MeJxiLCjIpg/AAAAAAAAAAI/AAAAAAAADd0/X3bd1VJWFlI/s256-rj/photo.jpg",
      "display_name" : "Hussain Akbar",
      "link" : "https://stackoverflow.com/users/7210927/hussain-akbar"
    },
    "creation_date" : 1750234214,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140519848,
    "post_id" : 79667237,
    "body" : "Shall do the debugging",
    "score" : 0,
    "owner" : {
      "account_id" : 9722759,
      "reputation" : 698,
      "user_id" : 7210927,
      "user_type" : "registered",
      "profile_image" : "https://lh4.googleusercontent.com/-MeJxiLCjIpg/AAAAAAAAAAI/AAAAAAAADd0/X3bd1VJWFlI/s256-rj/photo.jpg",
      "display_name" : "Hussain Akbar",
      "link" : "https://stackoverflow.com/users/7210927/hussain-akbar"
    },
    "creation_date" : 1750153316,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140519267,
    "post_id" : 79667237,
    "body" : "You need to start debugging.  Take a look at what is in <code>resultText</code>, <code>text</code> and so on.  The fact that you are getting <code>&quot;Plate not detected&quot;</code> implies that the text recognizer has found <i>something</i> ... just not what your code is expecting.",
    "score" : 0,
    "owner" : {
      "account_id" : 47283,
      "reputation" : 723428,
      "user_id" : 139985,
      "user_type" : "registered",
      "accept_rate" : 69,
      "profile_image" : "https://www.gravatar.com/avatar/147c5a9cc1feec049c50da791ac7d144?s=256&d=identicon&r=PG",
      "display_name" : "Stephen C",
      "link" : "https://stackoverflow.com/users/139985/stephen-c"
    },
    "creation_date" : 1750141063,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140516982,
    "post_id" : 79667237,
    "body" : "I have recently <a href=\"https://github.com/TomerPacific/car-identifier/blob/main/app/src/main/java/com/tomerpacific/caridentifier/screen/VerifyPhotoDialog.kt\" rel=\"nofollow noreferrer\">created a project</a> with this same functionality, might help you to take a look at it. I did it with Kotlin, but I think that shouldn&#39;t make too much of a difference.",
    "score" : 0,
    "owner" : {
      "account_id" : 14722107,
      "reputation" : 6861,
      "user_id" : 10632369,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/541566093e9d34a3858f5446d06a7a6e?s=256&d=identicon&r=PG",
      "display_name" : "tomerpacific",
      "link" : "https://stackoverflow.com/users/10632369/tomerpacific"
    },
    "creation_date" : 1750072739,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}