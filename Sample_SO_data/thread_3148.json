{
  "question" : {
    "question_id" : 79568758,
    "title" : "Changing write and read Instant after update from hibernate 5 to 6",
    "body" : "<p>I am migrating a project to Spring Boot 3 and Hibernate 6.5.3.Final and encountered a problem when my application use Instant in a legacy project</p>\n<p>I have entity:</p>\n<pre><code>@Data\n@Entity\n@SuperBuilder(toBuilder = true)\n@AllArgsConstructor\n@NoArgsConstructor\npublic class TestEnity {\n    @NonNull\n    private UUID id;\n    @NonNull\n    private Instant createDate;\n}\n</code></pre>\n<p>Add record by EntityManager (in my timezone now 12 am) with property spring.jpa.properties.hibernate.type.preferred_instant_jdbc_type=TIMESTAMP:</p>\n<pre><code>id                                      |   create_date\n----------------------------------------------------------------------\n3ceca36e-710f-4ea3-223b-1118b0796c7f    |   2025-04-10 12:20:30.510548\n3ceca36e-710f-4ea3-223b-2228b0796c7f    |   2025-04-09 12:20:30.510548\n3ceca36e-710f-4ea3-223b-3338b0796c7f    |   2025-04-08 12:20:30.510548\n</code></pre>\n<p>And I use querydsl for get records:</p>\n<pre><code>SQLQueryFactory sqlQueryFactory = new SQLQueryFactory(GenaratorQsqlUtils.createConfiguration(), dataSource);\n\nBooleanBuilder booleanBuilder = new BooleanBuilder();\nbooleanBuilder.and(getDateFrom(instantFrom));\nbooleanBuilder.and(getDateTo(instantTo));\n    \nlong count = sqlQueryFactory.select()\n                .from(testE)\n                .where(booleanBuilder) //createDate &gt;= 2025-04-09T12:19:58Z &amp;&amp; createDate &lt;= 2025-04-10T12:29:58Z\n                .fetchCount();\n</code></pre>\n<p>And I wait I get 2 record <strong>1118b0796c7f</strong> and <strong>2228b0796c7f</strong>, but hibernate find only <strong>1118b0796c7f</strong> and in debug I see:</p>\n<pre><code>id                                      |   create_date\n----------------------------------------------------------------------\n3ceca36e-710f-4ea3-223b-1118b0796c7f    |   2025-04-10 10:20:30.510548\n</code></pre>\n<p>If I update record <strong>2228b0796c7f</strong> column create_date for <em>2025-04-09 14:20:30.510548</em> (that is, in the current offset recorded in the database, I added another one +02) than I get 2 records</p>\n<p>In hibernate 5 all was OK and I not use <em>spring.jpa.properties.hibernate.type.preferred_instant_jdbc_type=TIMESTAMP</em>, but now without <em>spring.jpa.properties.hibernate.type.preferred_instant_jdbc_type</em> I see in database <strong>UTC</strong> time and when I write rows</p>\n<p>How I can configure Hibernate 6 work for backward compatibility? Why when record write time convert in <strong>UTC</strong>?</p>\n",
    "tags" : [ "java", "spring", "hibernate" ],
    "owner" : {
      "account_id" : 32467947,
      "reputation" : 43,
      "user_id" : 25224125,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/331556bd2946bc085b33d2240d0c63b8?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Mike Sonarov",
      "link" : "https://stackoverflow.com/users/25224125/mike-sonarov"
    },
    "is_answered" : false,
    "view_count" : 96,
    "answer_count" : 0,
    "score" : 1,
    "last_activity_date" : 1744375495,
    "creation_date" : 1744371616,
    "link" : "https://stackoverflow.com/questions/79568758/changing-write-and-read-instant-after-update-from-hibernate-5-to-6",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ ],
  "answer_comments" : { }
}