{
  "question" : {
    "question_id" : 79737029,
    "title" : "Deploying Spring Java REST API app to Azure Container Apps",
    "body" : "<p>I have a REST API app developed with Java Spring Boot.\nI am trying to deploy it to Azure Container Apps (ACA) with the following standard web app architecture:</p>\n<pre>\nweb browser -443-> Apache2 container -8080-> REST API container -3306-> MariaDB container\n</pre>\n<p>The Apache2 container is deployed to ACA with name pct-datallama, ingress set to external and public URL <pre>https://pct-datallama.purplestone-32662f92.australiaeast.azurecontainerapps.io/</pre></p>\n<p>It has a proxy configuration as follows:</p>\n<pre>\nTraceEnable off\nLogLevel trace5\n\n    Order deny,allow\n    Allow from all\n\n    \nProxyPreserveHost On\nRequestHeader set X-Forwarded-Proto \"http\"\nRequestHeader set X-Forwarded-Port \"8080\"\n    \nProxyPass \"/api\" \"http://datallama-api.internal.purplestone-32662f92.australiaeast.azurecontainerapps.io\"\nProxyPassReverse \"/api\" \"http://datallama-api.internal.purplestone-32662f92.australiaeast.azurecontainerapps.io\"\n</pre>\n<p>The REST API container is deployed to ACA with name datallama-api. Ingress is set to internal and the internal domain name is datallama-api.internal.purplestone-32662f92.australiaeast.azurecontainerapps.io</p>\n<p>Here are the key aspects of the REST API container config:</p>\n<ul>\n<li>explicitly listening on port 8080</li>\n<li>CORS disabled</li>\n<li>spring-boot-starter-actuator included in pom.xml</li>\n<li>management.endpoints.web.exposure.include=health included in application.properties</li>\n<li>management.endpoint.health.show-details=always included in application.properties</li>\n</ul>\n<p>All containers are running successfully on ACA and there are NO HEALTH PROBE ERRORS for any.</p>\n<p>However, the proxy URL fails. I have never succeeded in getting the proxy URL to work despite repeated configuration variations. The Browser cannot communicate with the REST API via the Apache2 proxy.</p>\n<p>When I test from Postman I get the following error:</p>\n<pre>\nError 404 - This Container App is stopped or does not exist.\nThe Container App you have attempted to reach is currently stopped or does not exist.\nIf you are the Container App administrator, please visit https://portal.azure.com/.\n</pre>\n<p>The REST API container is 100% running and healthy.</p>\n<p>Has anyone successfully deployed this architecture to ACA?\nIf so, can you suggest a fix?</p>\n",
    "tags" : [ "java", "spring-boot", "apache2", "azure-container-apps", "mod-proxy-html" ],
    "owner" : {
      "account_id" : 320482,
      "reputation" : 1,
      "user_id" : 638782,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/krhqm.png?s=256",
      "display_name" : "Richard Scrivener",
      "link" : "https://stackoverflow.com/users/638782/richard-scrivener"
    },
    "is_answered" : false,
    "view_count" : 60,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1755371288,
    "creation_date" : 1755331437,
    "link" : "https://stackoverflow.com/questions/79737029/deploying-spring-java-rest-api-app-to-azure-container-apps",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ ],
  "answer_comments" : { }
}