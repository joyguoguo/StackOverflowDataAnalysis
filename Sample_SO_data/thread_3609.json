{
  "question" : {
    "question_id" : 79536927,
    "title" : "Spring Security doesnt inject the csrf parameters on thymeleaf",
    "body" : "<pre><code>I have the following form:\n</code></pre>\n<pre><code>&lt;form th:action=&quot;@{/login}&quot; method=&quot;post&quot; th:object=&quot;${usuario}&quot;&gt;\n            &lt;!-- This is the hidden which give troubles --&gt;\n            &lt;input type=&quot;hidden&quot; th:name=&quot;${_csrf.parameterName}&quot; th:value=&quot;${_csrf.token}&quot; /&gt;\n        \n            &lt;label for=&quot;username&quot;&gt;Usuario&lt;/label&gt;\n            &lt;input type=&quot;text&quot; th:field=&quot;*{username}&quot;/&gt;\n            &lt;label for=&quot;password&quot;&gt;Contrasenia&lt;/label&gt;\n            &lt;input type=&quot;password&quot; th:field=&quot;*{password}&quot;/&gt;\n            &lt;input type=&quot;submit&quot; value=&quot;Login&quot;/&gt;\n&lt;/form&gt;\n</code></pre>\n<p>I have configured the security with the next configuration:</p>\n<pre><code>          @Bean\n            public SecurityWebFilterChain securityWebFilterChain(ServerHttpSecurity http) {\n                http\n                    .authorizeExchange()\n                        .pathMatchers(&quot;/login&quot;).permitAll() \n                        .pathMatchers(&quot;/api/alumnos/getAlumnos&quot;,&quot;/listar&quot;,&quot;/&quot;,&quot;/index&quot;).hasRole(&quot;USER&quot;)\n                        .pathMatchers(&quot;/api/alumnos/saveAlumno&quot;,&quot;/saveAlumno&quot;).hasRole(&quot;FUNCIONAL&quot;)\n                        .anyExchange().authenticated()\n                    .and().csrf(csrf -&gt; csrf.csrfTokenRepository(CookieServerCsrfTokenRepository.withHttpOnlyFalse()))\n                    .httpBasic()  // Usamos autenticación básica HTTP (puedes configurarlo con JWT si lo prefieres)\n                    .and()\n                    .formLogin()\n                    .loginPage(&quot;/login&quot;);  // Si usas autenticación OAuth2 también puedes configurarlo aquí\n        \n                return http.build();\n            }\n    \n</code></pre>\n<p>But when I run it. It gives me the next message:\nEL1007E: Property or field 'parameterName' cannot be found on null</p>\n<p>So the problem is that SpringBoot isnt injecting the _csrm to thymeleaf.\nI can delete that line and it will work but sending the form will give me an error saying that csrf cant be found and it will leave.</p>\n<p>I have this on the controller. I dont think its relevant.</p>\n<pre><code>@PreAuthorize(&quot;hasRole('USER')&quot;)\n@GetMapping({&quot;/listar&quot;,&quot;/&quot;,&quot;/index&quot;})\npublic Mono&lt;String&gt; getAlumnosActivos(Model model) {\n            Flux&lt;Alumno&gt; alumnos=alumnoService.getActiveAlumnos();\n            alumnos.subscribe(al-&gt;log.info(String.format(&quot;Alumno: %s&quot;, al.getNombre())));\n            model.addAttribute(&quot;alumnos&quot;, alumnos);\n            model.addAttribute(&quot;titulo&quot;,&quot;Listado de Alumnos&quot;);\n            \n            return Mono.just(&quot;index&quot;);\n}\n</code></pre>\n<p>And other data which may be relevant is that Im using Spring Web Flux.\nThank you for your help.</p>\n",
    "tags" : [ "java", "spring-boot", "spring-security", "thymeleaf", "spring-webflux" ],
    "owner" : {
      "account_id" : 13518651,
      "reputation" : 21,
      "user_id" : 9752551,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/1965f13ba747f2eba223e93ff66e6e4c?s=256&d=identicon&r=PG",
      "display_name" : "jclaros",
      "link" : "https://stackoverflow.com/users/9752551/jclaros"
    },
    "is_answered" : false,
    "view_count" : 43,
    "answer_count" : 0,
    "score" : 2,
    "last_activity_date" : 1743012796,
    "creation_date" : 1743012796,
    "link" : "https://stackoverflow.com/questions/79536927/spring-security-doesnt-inject-the-csrf-parameters-on-thymeleaf",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ ],
  "answer_comments" : { }
}