{
  "question" : {
    "question_id" : 79573162,
    "title" : "Error validating XBRL using catalog.xml to ensure only local XSD files are used",
    "body" : "<p>I put this code on Github:</p>\n<ol>\n<li><a href=\"https://github.com/robertmarkbram/XbrlValidationWithXsdUsesXercesApplication\" rel=\"nofollow noreferrer\">https://github.com/robertmarkbram/XbrlValidationWithXsdUsesXercesApplication</a> - uses Xerces.</li>\n<li><a href=\"https://github.com/robertmarkbram/XbrlValidationWithXsdNoXercesApplication\" rel=\"nofollow noreferrer\">https://github.com/robertmarkbram/XbrlValidationWithXsdNoXercesApplication</a> - no Xerces, just what is in the JDK.</li>\n</ol>\n<p>This is my code to validate an XBRL file using an XSD and a <code>catalog.xml</code> listing the local paths to all the XSD files:</p>\n<pre class=\"lang-java prettyprint-override\"><code>package validate;\n\nimport java.io.IOException;\nimport java.nio.file.Path;\nimport javax.xml.XMLConstants;\nimport javax.xml.transform.Source;\nimport javax.xml.transform.stream.StreamSource;\nimport javax.xml.validation.Schema;\nimport javax.xml.validation.SchemaFactory;\nimport lombok.extern.slf4j.Slf4j;\nimport org.apache.xerces.util.XMLCatalogResolver;\nimport org.xml.sax.SAXException;\nimport org.xml.sax.SAXParseException;\n\n@Slf4j\npublic class XsdValidatorTest {\n\n    public static void main(String[] args) throws SAXException, IOException {\n        // Compute path to the XBRL payload to be validated.\n        final Path xbrlPath = Path.of(\n            &quot;/path/to/xbrl.xml&quot;\n        );\n        final Source xmlStreamSource = new StreamSource(xbrlPath.toFile());\n\n        // Create objects to do the validation.\n        final SchemaFactory schemaFactory = SchemaFactory.newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI);\n        final Path xsdPath = Path.of(\n            &quot;/path/to/sprcnt.0001.conttrans.request.02.02.report.xsd&quot;\n        );\n        final Schema schema = schemaFactory.newSchema(xsdPath.toFile());\n        // Set up a CatalogResolver so that use the local XSD files and not look them up from the internet.\n        final String[] catalogs = { &quot;xsd/catalog.xml&quot; };\n        final XMLCatalogResolver resolver = new XMLCatalogResolver(catalogs);\n        schemaFactory.setResourceResolver(resolver);\n        // Create the validator.\n        javax.xml.validation.Validator validator = schema.newValidator();\n        // Capture the XSD errors so that we can report them back.\n        final XsdValidator.XsdErrorHandler errorHandler = new XsdValidator.XsdErrorHandler(xbrlPath);\n        validator.setErrorHandler(errorHandler);\n\n        // Validate and extract errors.\n        validator.validate(xmlStreamSource);\n        if (errorHandler.getErrors().isEmpty()) {\n            log.info(&quot;'{}' is valid against '{}'.&quot;, xbrlPath, xsdPath);\n        }\n        for (SAXParseException error : errorHandler.getErrors()) {\n            log.debug(&quot;Error: {}&quot;, error.toString());\n        }\n    }\n}\n</code></pre>\n<p>The XBRL I am trying to validate is here: <a href=\"https://gist.github.com/robertmarkbram/d8c2b3ad7c0e23753e45ca996f561816\" rel=\"nofollow noreferrer\">https://gist.github.com/robertmarkbram/d8c2b3ad7c0e23753e45ca996f561816</a> (removed because it's not important for my actual problem and the post is too long already).</p>\n<p>The XSD file used is the same file from <code>link:schemaRef</code> in the XBRL, just saved locally: <a href=\"http://sbr.gov.au/taxonomy/sbr_au_reports/sprstrm/sprcnt/sprcnt_0001/sprcnt.0001.conttrans.request.02.02.report.xsd\" rel=\"nofollow noreferrer\">http://sbr.gov.au/taxonomy/sbr_au_reports/sprstrm/sprcnt/sprcnt_0001/sprcnt.0001.conttrans.request.02.02.report.xsd</a></p>\n<p>Finally, the catalog.xml file contains references to all the XSD files I found locally when validating my XBRL file using <a href=\"https://arelle.org/arelle/\" rel=\"nofollow noreferrer\">Arelle</a>.</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;catalog xmlns=&quot;urn:oasis:names:tc:entity:xmlns:xml:catalog&quot;&gt;\n   ... Removed lines because the post was too long ...\n   &lt;system systemId=&quot;http://sbr.gov.au/icls/py/pyin/pyin.02.17.data&quot; uri=&quot;xsd/sbr.gov.au/taxonomy/sbr_au_taxonomy/icls/py/pyin/pyin.02.17.data.xsd&quot; /&gt;\n   &lt;system systemId=&quot;http://sbr.gov.au/rprt/sprstrm/sprcnt/sprcnt.0001.private.02.01.module&quot; uri=&quot;xsd/sbr.gov.au/taxonomy/sbr_au_reports/sprstrm/sprcnt/sprcnt_0001/sprcnt.0001.private.02.01.module.xsd&quot; /&gt;\n   &lt;system systemId=&quot;http://sbr.gov.au/rprt/sprstrm/sprcnt/sprcnt.0001.private.02.02.module&quot; uri=&quot;xsd/sbr.gov.au/taxonomy/sbr_au_reports/sprstrm/sprcnt/sprcnt_0001/sprcnt.0001.private.02.02.module.xsd&quot; /&gt;\n   &lt;system systemId=&quot;http://www.w3.org/1999/xlink&quot; uri=&quot;xsd/www.xbrl.org/2003/xlink-2003-12-31.xsd&quot; /&gt;\n   &lt;system systemId=&quot;http://www.xbrl.org/2003/instance&quot; uri=&quot;xsd/www.xbrl.org/2003/xbrl-instance-2003-12-31.xsd&quot; /&gt;\n   &lt;system systemId=&quot;http://www.xbrl.org/2003/linkbase&quot; uri=&quot;xsd/www.xbrl.org/2003/xbrl-linkbase-2003-12-31.xsd&quot; /&gt;\n   &lt;system systemId=&quot;http://xbrl.org/2005/xbrldt&quot; uri=&quot;xsd/www.xbrl.org/2005/xbrldt-2005.xsd&quot; /&gt;\n   &lt;system systemId=&quot;http://www.xbrl.org/2003/linkbase&quot; uri=&quot;xsd/www.xbrl.org/2003/xbrl-linkbase-2003-12-31.xsd&quot; /&gt;\n   &lt;system systemId=&quot;http://www.xbrl.org/2003/XLink&quot; uri=&quot;xsd/www.xbrl.org/2003/xl-2003-12-31.xsd&quot; /&gt;\n   &lt;system systemId=&quot;http://www.w3.org/1999/xlink&quot; uri=&quot;xsd/www.xbrl.org/2003/xlink-2003-12-31.xsd&quot; /&gt;\n&lt;/catalog&gt;\n</code></pre>\n<p>This works fine when connected to the internet:</p>\n<pre><code>2025-04-14 22:00:53,043 [main] INFO validate.XsdValidatorTest [XsdValidatorTest.java:44] - main - '/path/to/xbrl.xml' is valid against '/path/to/sprcnt.0001.conttrans.request.02.02.report.xsd'.\n</code></pre>\n<p>Now turn the internet off and it fails, not knowing what <code>xbrli:item</code> is.</p>\n<pre><code>Exception in thread &quot;main&quot; org.xml.sax.SAXParseException; systemId: file:/path/to/sprcnt.0001.conttrans.request.02.02.report.xsd; lineNumber: 82; columnNumber: 171; src-resolve: Cannot resolve the name 'xbrli:item' to a(n) 'element declaration' component.\n    at org.apache.xerces.util.ErrorHandlerWrapper.createSAXParseException(Unknown Source)\n   ... snip\n    at java.xml/javax.xml.validation.SchemaFactory.newSchema(SchemaFactory.java:628)\n    at validate.XsdValidatorTest.main(XsdValidatorTest.java:30)\n\nFAILURE: Build failed with an exception.\n</code></pre>\n<hr />\n<p>Wednesday 16 April 2025, 12:40:23 pm</p>\n<p>In response to @Ghislain Fourny's answer.</p>\n<p>I updated <code>catalog.xml</code> to:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;catalog xmlns=&quot;urn:oasis:names:tc:entity:xmlns:xml:catalog&quot;&gt;\n   &lt;rewriteURI rewritePrefix=&quot;file:/Users/rob.bram/home/dev/superstream/sscore/src/main/resources/xsd/sbr.gov.au/&quot; uriStartString=&quot;http://sbr.gov.au/&quot;/&gt;\n&lt;/catalog&gt;\n</code></pre>\n<p>I verified that path is correct, but I am still getting exactly the same result.</p>\n<ul>\n<li>Validation works fine when Internet is connected.</li>\n<li>When Internet is off, I get <code>Exception in thread &quot;main&quot; org.xml.sax.SAXParseException; systemId: file:/Users/rob.bram/home/dev/superstream/sscore/src/main/resources/xsd/sbr.gov.au/taxonomy/sbr_au_reports/sprstrm/sprcnt/sprcnt_0001/sprcnt.0001.conttrans.request.02.02.report.xsd; lineNumber: 82; columnNumber: 171; src-resolve: Cannot resolve the name 'xbrli:item' to a(n) 'element declaration' component.</code></li>\n</ul>\n<p>How do I verify that the catalog is even being used? When I change <code>rewritePrefix</code> to have a completely wrong path, the result is still the same. I added <code>&lt;logger name=&quot;javax.xml.catalog&quot; level=&quot;DEBUG&quot; /&gt;</code> to <code>src/main/resources/logback-spring.xml</code> and see no logging at all from it.</p>\n<hr />\n<p>Thursday 17 April 2025, 02:43:11 pm</p>\n<p>I modified code to log each XSD we try to resolve:</p>\n<pre class=\"lang-java prettyprint-override\"><code>final XMLCatalogResolver resolver = new XMLCatalogResolver(catalogs) {\n   @Override\n   public LSInput resolveResource(\n         final String type,\n         final String namespaceURI,\n         final String publicId,\n         final String systemId,\n         final String baseURI\n   ) {\n         final LSInput lsInput = super.resolveResource(type, namespaceURI, publicId, systemId, baseURI);\n         final String resolvedSystemId = (lsInput != null) ? lsInput.getSystemId() : &quot;null&quot;;\n         log.info(&quot;Attempted to resolve '{}', resolved to: {}&quot;, systemId, resolvedSystemId);\n         return lsInput;\n   }\n};\n</code></pre>\n<p>And modified <code>catalog.xml</code> in response to @Ghislain Fourny's most recent suggestion.</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;catalog xmlns=&quot;urn:oasis:names:tc:entity:xmlns:xml:catalog&quot;&gt;\n   ...\n   &lt;uri name=&quot;http://www.xbrl.org/2003/instance&quot; uri=&quot;xsd/www.xbrl.org/2003/xbrl-instance-2003-12-31.xsd&quot; /&gt;\n&lt;/catalog&gt;\n</code></pre>\n<p>I am still getting the same result (works when internet is on, same error when internet is off). I am also not seeing any output from <code>XMLCatalogResolver</code>, leaving me very unclear about whether the resolver is being used.</p>\n<hr />\n<p>Sunday 18 May 2025, 11:30:46 pm</p>\n<p>I have marked @Ghislain Fourny's answer as correct, because that solved part of the problem. I needed to use catalog entries of the form: <code>&lt;uri name=&quot;...&quot; uri=&quot;...&quot;/&gt;</code>. Thank you very much!</p>\n<p>Thanks to a <a href=\"https://coderanch.com/t/789281/java/Error-validating-XBRL-catalog-xml#3591638\" rel=\"nofollow noreferrer\">reply on another forum</a>, I needed to change the order in which I created the objects to ensure that the catalog and resource resolver is added to the schema factory <em>before</em> I create a the schema object.</p>\n<pre><code>// Create the schema factory.\nfinal SchemaFactory schemaFactory = SchemaFactory.newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI);\n\n// Tell the schema factory to use a catalog and resource resolver to use local XSD files.\nfinal String[] catalogs = {&quot;src/main/resources/xsd/catalog.xml&quot;};\nfinal XMLCatalogResolver resolver = new XMLCatalogResolver(catalogs) {\n    @Override\n    public LSInput resolveResource(\n            final String type,\n            final String namespaceURI,\n            final String publicId,\n            final String systemId,\n            final String baseURI\n    ) {\n        final LSInput lsInput = super.resolveResource(type, namespaceURI, publicId, systemId, baseURI);\n        final String resolvedSystemId = (lsInput != null) ? lsInput.getSystemId() : &quot;null&quot;;\n        System.out.println(&quot;Attempted to resolve '&quot; + systemId + &quot;', resolved to: &quot; + resolvedSystemId);\n        return lsInput;\n    }\n};\nschemaFactory.setResourceResolver(resolver);\n\n// Create the validator using the XSD.\nfinal String entryPointXsd = &quot;src/main/resources/xsd/sbr.gov.au/taxonomy/sbr_au_reports/sprstrm/sprcnt/sprcnt_0001/sprcnt.0001.conttrans.request.02.02.report.xsd&quot;;\nfinal Schema schema = schemaFactory.newSchema(new File(entryPointXsd));\njavax.xml.validation.Validator validator = schema.newValidator();\n\n// Add an error handler.\nfinal XsdErrorHandler errorHandler = new XsdErrorHandler(xbrlPath);\nvalidator.setErrorHandler(errorHandler);\n\n// Validate and output errors.\nfinal Source xmlStreamSource = new StreamSource(xbrlPath.toFile());\nvalidator.validate(xmlStreamSource);\nif (errorHandler.getErrors().isEmpty()) {\n    System.out.println(&quot;'&quot; + xbrlPath\n            + &quot;' is valid against '&quot; + entryPointXsd\n            + &quot;'.&quot;);\n}\nfor (SAXParseException error : errorHandler.getErrors()) {\n    System.err.println(&quot;Error: &quot; + error.toString());\n}\n</code></pre>\n<p>However, this left me with a new set of problems - the <a href=\"https://gist.github.com/robertmarkbram/00c73758d0ce6b1b7b0ed1aec7a9d869\" rel=\"nofollow noreferrer\">catalog.xml</a> entries were not sufficient and needed adjusting. I still have issues with the entry for <code>xbrl-linkbase-2003-12-31.xsd</code>, but I will make a new question for it because this one already has too detail in it.</p>\n",
    "tags" : [ "java", "xml", "xbrl", "xmlcatalog" ],
    "owner" : {
      "account_id" : 94158,
      "reputation" : 10059,
      "user_id" : 257233,
      "user_type" : "registered",
      "accept_rate" : 88,
      "profile_image" : "https://www.gravatar.com/avatar/eee4f99bf88fb3d8f577e40f236caf12?s=256&d=identicon&r=PG",
      "display_name" : "Robert Mark Bram",
      "link" : "https://stackoverflow.com/users/257233/robert-mark-bram"
    },
    "is_answered" : true,
    "view_count" : 207,
    "answer_count" : 3,
    "score" : 0,
    "last_activity_date" : 1747601340,
    "creation_date" : 1744634234,
    "link" : "https://stackoverflow.com/questions/79573162/error-validating-xbrl-using-catalog-xml-to-ensure-only-local-xsd-files-are-used",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79575326,
    "question_id" : 79573162,
    "body" : "<p>The catalog spec supports the element <code>rewriteURI</code>, which allows mapping the official URIs to local files, like so:</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;!DOCTYPE catalog PUBLIC &quot;-//OASIS//DTD Entity Resolution XML Catalog V1.0//EN&quot; &quot;http://www.oasis-open.org/committees/entity/release/1.0/catalog.dtd&quot;&gt;\n&lt;catalog xmlns=&quot;urn:oasis:names:tc:entity:xmlns:xml:catalog&quot;&gt;\n  &lt;rewriteURI rewritePrefix=&quot;file:///path/to/xsd/sbr.gov.au/&quot; uriStartString=&quot;http://sbr.gov.au/&quot;/&gt;\n  ...\n&lt;/catalog&gt;\n</code></pre>\n<p>These rewrites are the <a href=\"https://www.xbrl.org/Specification/taxonomy-package/REC-2016-04-19/taxonomy-package-REC-2016-04-19.html#applying-remappings\" rel=\"nofollow noreferrer\">official mechanism</a> used by XBRL Taxonomy/Report Packages.</p>\n<p>In this way, the official URIs (absolute or relative) can be used everywhere (such as in the  <code>link:schemaRef</code> element), and the URI-rewrites redirect the processor to read from local copies instead of downloading them. Note that the URIs redirected with this mechanism are the URLs to the schemas and linkbases (such as the URL present in the  <code>link:schemaRef</code> element), not the namespaces themselves.</p>\n<p>For example, when Arelle or any other XBRL processor finds this in the instance:</p>\n<pre><code>&lt;link:schemaRef xlink:href=&quot;http://sbr.gov.au/taxonomy/sbr_au_reports/sprstrm/sprcnt/sprcnt_0001/sprcnt.0001.conttrans.request.02.02.report.xsd&quot;\n                   xlink:type=&quot;simple&quot;/&gt;\n</code></pre>\n<p>it will attempt to read the schema located at <code>http://sbr.gov.au/taxonomy/sbr_au_reports/sprstrm/sprcnt/sprcnt_0001/sprcnt.0001.conttrans.request.02.02.report.xsd</code>. If however there is a rewrite in place that maps <code>http://sbr.gov.au/</code> to <code>file:///path/to/xsd/sbr.gov.au/</code> then it will try to read the schema from <code>file:///path/to/xsd/sbr.gov.au/taxonomy/sbr_au_reports/sprstrm/sprcnt/sprcnt_0001/sprcnt.0001.conttrans.request.02.02.report.xsd</code> instead. I imagine this is the redirection that is missing to your current setup right now and that the <code>rewriteURI</code> element should take care of.</p>\n<p>XBRL has its own schema resolution mechanism (called DTS) that works through the <code>link:schemaRef</code> element and looks for all files in the transitive closure of such links. Thus, if <code>sprcnt.0001.conttrans.request.02.02.report.xsd</code> contains further links to other schemas and linkbases that are in the <code>http://sbr.gov.au/</code> domain, they will also all be read locally. It is highly likely that all schemas corresponding to the many namespaces used in the report are indeed in the transitive closure of <code>sprcnt.0001.conttrans.request.02.02.report.xsd</code>. It is thus not necessary to supply the correspondence between these namespaces and schema file URLs explicitly: the XBRL processor figures it all out via the DTS mechanism.</p>\n<p>Finally, rewrites for the core xbrl.org or w3.org domains are usually superfluous because XBRL processors know these servers alreadyÂ and have local copies of the core schemas in their own caches. But if the DTS has files in other domains than these core domains and <code>http://sbr.gov.au/</code>, then rewrites must be added.</p>\n<p>Edit:</p>\n<p>I now understand that you are attempting to validate the XML file directly with Xerces, without using an XBRL processor. In this case, the DTS discovery mechanism (which would have used <code>&lt;rewriteURI&gt;</code>) will be completely ignored because <code>link:schemaRef</code> is specific to XBRL: Arelle will know about it, but not Xerces.</p>\n<p>It is thus important to supply Xerces with the list of schemas, as you suggest in your post. Taking the list from Arelle is sensible. However, I think that this list should be done with <code>&lt;uri&gt;</code> and not with <code>&lt;system&gt;</code> as the latter is for DTD system IDs, not for XML Schema. So perhaps something like this helps:</p>\n<pre><code>&lt;catalog xmlns=&quot;urn:oasis:names:tc:entity:xmlns:xml:catalog&quot;&gt;\n   &lt;uri name=&quot;http://sbr.gov.au/icls/py/pyin/pyin.02.17.data&quot; uri=&quot;xsd/sbr.gov.au/taxonomy/sbr_au_taxonomy/icls/py/pyin/pyin.02.17.data.xsd&quot; /&gt;\n   &lt;uri name=&quot;http://sbr.gov.au/rprt/sprstrm/sprcnt/sprcnt.0001.private.02.01.module&quot; uri=&quot;xsd/sbr.gov.au/taxonomy/sbr_au_reports/sprstrm/sprcnt/sprcnt_0001/sprcnt.0001.private.02.01.module.xsd&quot; /&gt;\n   &lt;uri name=&quot;http://sbr.gov.au/rprt/sprstrm/sprcnt/sprcnt.0001.private.02.02.module&quot; uri=&quot;xsd/sbr.gov.au/taxonomy/sbr_au_reports/sprstrm/sprcnt/sprcnt_0001/sprcnt.0001.private.02.02.module.xsd&quot; /&gt;\n   &lt;uri name=&quot;http://www.w3.org/1999/xlink&quot; uri=&quot;xsd/www.xbrl.org/2003/xlink-2003-12-31.xsd&quot; /&gt;\n   &lt;uri name=&quot;http://www.xbrl.org/2003/instance&quot; uri=&quot;xsd/www.xbrl.org/2003/xbrl-instance-2003-12-31.xsd&quot; /&gt;\n   &lt;uri name=&quot;http://www.xbrl.org/2003/linkbase&quot; uri=&quot;xsd/www.xbrl.org/2003/xbrl-linkbase-2003-12-31.xsd&quot; /&gt;\n   &lt;uri name=&quot;http://xbrl.org/2005/xbrldt&quot; uri=&quot;xsd/www.xbrl.org/2005/xbrldt-2005.xsd&quot; /&gt;\n   &lt;uri name=&quot;http://www.xbrl.org/2003/linkbase&quot; uri=&quot;xsd/www.xbrl.org/2003/xbrl-linkbase-2003-12-31.xsd&quot; /&gt;\n   &lt;uri name=&quot;http://www.xbrl.org/2003/XLink&quot; uri=&quot;xsd/www.xbrl.org/2003/xl-2003-12-31.xsd&quot; /&gt;\n   &lt;uri name=&quot;http://www.w3.org/1999/xlink&quot; uri=&quot;xsd/www.xbrl.org/2003/xlink-2003-12-31.xsd&quot; /&gt;\n...\n&lt;/catalog&gt;\n</code></pre>\n<p>A small warning: validating an XBRL instance file against the relevant schemas guarantees that it is valid in the sense of XML Schema, but does not guarantee that it is valid in the sense of XBRL. XBRL specifications contain additional constraints that cannot be expressed in the schemas. XBRL validity guarantees XML-Schema-validity, but not the other way around. Only an XBRL processor can guarantee that an instance is valid in the sense of XBRL.</p>\n<p>Edit:</p>\n<p>Here is a standard alternative to provide the schemas recognized by most XML Schema validation processors. I am not sure if it would be suitable in a production environment as it requires modifying the file, but it would be a good intermediate sanity check that Xerces sees these files. Also, modifying the file in this way might break if processed by an XBRL processor, as this XML-Schema discovery mechanism might interfere with the XBRL-specific DTS discovery mechanism.</p>\n<p>I formatted it with a (namespace, path) pair per line, but whether newlines or spaces separate them does not play any role as these all count as whitespaces (<code>xsi:schemaLocation</code> is formally typed as a list of strings/URIs).</p>\n<pre><code>&lt;xbrli:xbrl\n    xmlns:xbrli=&quot;http://www.xbrl.org/2003/instance&quot;\n    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n    ...\n    xsi:schemaLocation=&quot;\n        http://sbr.gov.au/icls/py/pyin/pyin.02.17.data xsd/sbr.gov.au/taxonomy/sbr_au_taxonomy/icls/py/pyin/pyin.02.17.data.xsd\n        http://sbr.gov.au/rprt/sprstrm/sprcnt/sprcnt.0001.private.02.01.module xsd/sbr.gov.au/taxonomy/sbr_au_reports/sprstrm/sprcnt/sprcnt_0001/sprcnt.0001.private.02.01.module.xsd\n        http://sbr.gov.au/rprt/sprstrm/sprcnt/sprcnt.0001.private.02.02.module xsd/sbr.gov.au/taxonomy/sbr_au_reports/sprstrm/sprcnt/sprcnt_0001/sprcnt.0001.private.02.02.module.xsd\n        http://www.w3.org/1999/xlink xsd/www.xbrl.org/2003/xlink-2003-12-31.xsd\n        http://www.xbrl.org/2003/instance xsd/www.xbrl.org/2003/xbrl-instance-2003-12-31.xsd\n        http://www.xbrl.org/2003/linkbase xsd/www.xbrl.org/2003/xbrl-linkbase-2003-12-31.xsd\n        http://xbrl.org/2005/xbrldt xsd/www.xbrl.org/2005/xbrldt-2005.xsd\n        http://www.xbrl.org/2003/linkbase xsd/www.xbrl.org/2003/xbrl-linkbase-2003-12-31.xsd\n        http://www.xbrl.org/2003/XLink xsd/www.xbrl.org/2003/xl-2003-12-31.xsd\n        http://www.w3.org/1999/xlink xsd/www.xbrl.org/2003/xlink-2003-12-31.xsd\n        ...&quot;\n&gt;\n...\n&lt;/xbrli:xbrl&gt;\n</code></pre>\n",
    "score" : 1,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 106772,
      "reputation" : 7429,
      "user_id" : 284285,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/8lZ5E.jpg?s=256",
      "display_name" : "Ghislain Fourny",
      "link" : "https://stackoverflow.com/users/284285/ghislain-fourny"
    },
    "creation_date" : 1744724961,
    "last_activity_date" : 1744880033,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79576320,
    "question_id" : 79573162,
    "body" : "<p>Here is version of the code in my main question that doesn't use Xerces and just relies on what is in the JDK. It is, however, still giving me exactly the same result.</p>\n<pre><code>package au.com.ozedi.sscore.validate;\n\nimport java.io.IOException;\nimport java.net.URISyntaxException;\nimport java.nio.file.Path;\nimport java.util.Objects;\nimport javax.xml.XMLConstants;\nimport javax.xml.transform.Source;\nimport javax.xml.transform.stream.StreamSource;\nimport javax.xml.validation.Schema;\nimport javax.xml.validation.SchemaFactory;\nimport lombok.extern.slf4j.Slf4j;\nimport org.xml.sax.SAXException;\nimport org.xml.sax.SAXParseException;\n\n@Slf4j\npublic class XsdValidatorTest {\n\n    /**\n     * Test XSD validation here too.\n     *\n     * @param args the input arguments\n     *\n     * @throws SAXException the sax exception\n     * @throws IOException  the io exception\n     */\n    public static void main(String[] args) throws SAXException, IOException, URISyntaxException {\n        // Compute path to the XBRL payload to be validated.\n        final Path xbrlPath = Path.of(\n            &quot;/Users/rob.bram/home/dev/superstream/sscore/src/test/resources/xbrl/xbrl_001_APRA-valid.xml&quot;\n        );\n        final Source xmlStreamSource = new StreamSource(xbrlPath.toFile());\n\n        // Create objects to do the validation.\n        final SchemaFactory schemaFactory = SchemaFactory.newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI);\n        final Path xsdPath = Path.of(\n            &quot;/Users/rob.bram/home/dev/superstream/sscore/src/main/resources/xsd/sbr.gov.au/taxonomy/sbr_au_reports/sprstrm/sprcnt/sprcnt_0001/sprcnt.0001.conttrans.request.02.02.report.xsd&quot;\n        );\n        final Schema schema = schemaFactory.newSchema(xsdPath.toFile());\n        // Create the validator.\n        javax.xml.validation.Validator validator = schema.newValidator();\n\n        // Set up a CatalogResolver so that use the local XSD files and not look them up from the internet.\n        final String catalogPath = Objects\n            .requireNonNull(XsdValidator.class.getClassLoader().getResource(&quot;xsd/catalog.xml&quot;))\n            .toURI()\n            .toString();\n        log.info(&quot;Catalog path: {}&quot;, catalogPath);\n        validator.setProperty(&quot;javax.xml.catalog.files&quot;, catalogPath);\n\n        // Capture the XSD errors so that we can report them back.\n        final XsdValidator.XsdErrorHandler errorHandler = new XsdValidator.XsdErrorHandler(xbrlPath);\n        validator.setErrorHandler(errorHandler);\n\n        // Validate and extract errors.\n        validator.validate(xmlStreamSource);\n        if (errorHandler.getErrors().isEmpty()) {\n            log.info(&quot;'{}' is valid against '{}'.&quot;, xbrlPath, xsdPath);\n        }\n        for (SAXParseException error : errorHandler.getErrors()) {\n            log.debug(&quot;Error: {}&quot;, error.toString());\n        }\n    }\n}\n</code></pre>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 94158,
      "reputation" : 10059,
      "user_id" : 257233,
      "user_type" : "registered",
      "accept_rate" : 88,
      "profile_image" : "https://www.gravatar.com/avatar/eee4f99bf88fb3d8f577e40f236caf12?s=256&d=identicon&r=PG",
      "display_name" : "Robert Mark Bram",
      "link" : "https://stackoverflow.com/users/257233/robert-mark-bram"
    },
    "creation_date" : 1744771963,
    "last_activity_date" : 1744771963,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79578578,
    "question_id" : 79573162,
    "body" : "<p>Another idea I tried was to change <code>xlink:href</code> in my XBRL to point to my local copy of the root XSD.</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;link:schemaRef xlink:href=&quot;file:///path/to/sprcnt.0001.conttrans.request.02.02.report.xsd&quot; xlink:type=&quot;simple&quot;/&gt;\n</code></pre>\n<p>With internet on:</p>\n<pre><code>2025-04-17 15:47:22,678 [main] INFO validate.XsdValidator [XsdValidator.java:114] - main - '/path/to/xbrl/xbrl_001_APRA-valid.xml' is valid against '/path/to/sprcnt.0001.conttrans.request.02.02.report.xsd'.\n</code></pre>\n<p>With internet off:</p>\n<pre><code>Exception in thread &quot;main&quot; org.xml.sax.SAXParseException; systemId: file:/path/to/sprcnt.0001.conttrans.request.02.02.report.xsd; lineNumber: 82; columnNumber: 171; src-resolve: Cannot resolve the name 'xbrli:item' to a(n) 'element declaration' component.\n</code></pre>\n<p>SO that doesn't work either.</p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 94158,
      "reputation" : 10059,
      "user_id" : 257233,
      "user_type" : "registered",
      "accept_rate" : 88,
      "profile_image" : "https://www.gravatar.com/avatar/eee4f99bf88fb3d8f577e40f236caf12?s=256&d=identicon&r=PG",
      "display_name" : "Robert Mark Bram",
      "link" : "https://stackoverflow.com/users/257233/robert-mark-bram"
    },
    "creation_date" : 1744869909,
    "last_activity_date" : 1744869909,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140335413,
    "post_id" : 79573162,
    "body" : "Also tried changing how I expressed the URIs in <code>catalog.xml</code>. Tried them all as <code>&lt;system systemId=&quot; ... &quot; uri=&quot;&#47;absolute&#47;path&#47;to&#47;xsd&quot; &#47;&gt;</code> and <code>&lt;system systemId=&quot; ... &quot; uri=&quot;file:&#47;&#47;&#47;absolute&#47;path&#47;to&#47;xsd&quot; &#47;&gt;</code> - same error for both strategies.",
    "score" : 0,
    "owner" : {
      "account_id" : 94158,
      "reputation" : 10059,
      "user_id" : 257233,
      "user_type" : "registered",
      "accept_rate" : 88,
      "profile_image" : "https://www.gravatar.com/avatar/eee4f99bf88fb3d8f577e40f236caf12?s=256&d=identicon&r=PG",
      "display_name" : "Robert Mark Bram",
      "link" : "https://stackoverflow.com/users/257233/robert-mark-bram"
    },
    "creation_date" : 1744695961,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140335388,
    "post_id" : 79573162,
    "body" : "@LMC, moving catalog.xml to the same directory as <code>XsdValidatorTest</code> did not help - I get the same error when I turn off the inernet.",
    "score" : 0,
    "owner" : {
      "account_id" : 94158,
      "reputation" : 10059,
      "user_id" : 257233,
      "user_type" : "registered",
      "accept_rate" : 88,
      "profile_image" : "https://www.gravatar.com/avatar/eee4f99bf88fb3d8f577e40f236caf12?s=256&d=identicon&r=PG",
      "display_name" : "Robert Mark Bram",
      "link" : "https://stackoverflow.com/users/257233/robert-mark-bram"
    },
    "creation_date" : 1744695407,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140335043,
    "post_id" : 79573162,
    "body" : "try moving catalog.xml to the same directory as XsdValidatorTest. Also, xerces seems to use <a href=\"https://xerces.apache.org/xerces2-j/faq-xcatalogs.html\" rel=\"nofollow noreferrer\">absolute paths too</a>",
    "score" : 1,
    "owner" : {
      "account_id" : 3377022,
      "reputation" : 14393,
      "user_id" : 2834978,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/ff9af10001f37bc0de566ca2caf2f558?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "LMC",
      "link" : "https://stackoverflow.com/users/2834978/lmc"
    },
    "creation_date" : 1744679785,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140335032,
    "post_id" : 79573162,
    "body" : "@LMC, I got the same result with <code>file:&#47;&#47;&#47;absolute&#47;path</code> and the relative path from the resources directory: <code>xsd&#47;catalog.xml</code> to initialise <code>final String[] catalogs = { &quot;xsd&#47;catalog.xml&quot; };</code>. I am not convinced the catalog is even being used.",
    "score" : 0,
    "owner" : {
      "account_id" : 94158,
      "reputation" : 10059,
      "user_id" : 257233,
      "user_type" : "registered",
      "accept_rate" : 88,
      "profile_image" : "https://www.gravatar.com/avatar/eee4f99bf88fb3d8f577e40f236caf12?s=256&d=identicon&r=PG",
      "display_name" : "Robert Mark Bram",
      "link" : "https://stackoverflow.com/users/257233/robert-mark-bram"
    },
    "creation_date" : 1744679322,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140333925,
    "post_id" : 79573162,
    "body" : "URIs are relative but should probably start with <code>file:&#47;&#47;&#47;</code>. Arelle uses lxml which uses libxml2 in turn. Here&#39;s <a href=\"https://gitlab.gnome.org/GNOME/libxml2/-/wikis/Catalog-support\" rel=\"nofollow noreferrer\">libxml2 catalog info</a>",
    "score" : 1,
    "owner" : {
      "account_id" : 3377022,
      "reputation" : 14393,
      "user_id" : 2834978,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/ff9af10001f37bc0de566ca2caf2f558?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "LMC",
      "link" : "https://stackoverflow.com/users/2834978/lmc"
    },
    "creation_date" : 1744651666,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79575326" : [ {
      "comment_id" : 140356321,
      "post_id" : 79575326,
      "body" : "Thank you @Ghislan Fourny. I tried modifying the XBRL document as you suggested and still got the same output. It works with the internet connected. Without internet I get: <code>Cannot resolve the name &#39;xbrli:item&#39; to a(n) &#39;element declaration&#39; component.</code>. To help see my code, I have uploaded to two Github repos: <a href=\"https://github.com/robertmarkbram/XbrlValidationWithXsdNoXercesApplication\" rel=\"nofollow noreferrer\">github.com/robertmarkbram/&hellip;</a> (doesn&#39;t use Xerces) and <a href=\"https://github.com/robertmarkbram/XbrlValidationWithXsdUsesXercesApplication\" rel=\"nofollow noreferrer\">github.com/robertmarkbram/&hellip;</a> (which uses Xerces).",
      "score" : 0,
      "owner" : {
        "account_id" : 94158,
        "reputation" : 10059,
        "user_id" : 257233,
        "user_type" : "registered",
        "accept_rate" : 88,
        "profile_image" : "https://www.gravatar.com/avatar/eee4f99bf88fb3d8f577e40f236caf12?s=256&d=identicon&r=PG",
        "display_name" : "Robert Mark Bram",
        "link" : "https://stackoverflow.com/users/257233/robert-mark-bram"
      },
      "creation_date" : 1745289475,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140343764,
      "post_id" : 79575326,
      "body" : "I added the <code>xsi:schemaLocation</code> pattern to my post.",
      "score" : 1,
      "owner" : {
        "account_id" : 106772,
        "reputation" : 7429,
        "user_id" : 284285,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/8lZ5E.jpg?s=256",
        "display_name" : "Ghislain Fourny",
        "link" : "https://stackoverflow.com/users/284285/ghislain-fourny"
      },
      "creation_date" : 1744879893,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140343726,
      "post_id" : 79575326,
      "body" : "I am sorry to hear it does not solve the issue. I tried to execute your code locally but was not able to find the XsdValidator class as it is not imported; is it your own code in the same package?  Since it seems you can modify the instance file, what you could try as an intermediate sanity check is to add an <code>xsi:schemaLocation</code> attribute in the root <code>xbrli:xbrl</code> element with a space-separated list of (alternating) namespaces and local paths for all schemas. Most XML Schema validators act on it. I have already tried this out in the past out of curiosity (with oXygen) and it worked.",
      "score" : 1,
      "owner" : {
        "account_id" : 106772,
        "reputation" : 7429,
        "user_id" : 284285,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/8lZ5E.jpg?s=256",
        "display_name" : "Ghislain Fourny",
        "link" : "https://stackoverflow.com/users/284285/ghislain-fourny"
      },
      "creation_date" : 1744879307,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140343146,
      "post_id" : 79575326,
      "body" : "Thank you again @Ghislan Fourny. I updated <code>catalog.xml</code> as you suggested and still see the same result. I added code to log activity from the resolver and do not see any logging from it. Regarding your small warning: we do use Schematron to validate business rules already. The issue I am trying to solve is that we get many incoming XBRLs with basic data errors, so thus we are trying to validate them against XSD first.",
      "score" : 0,
      "owner" : {
        "account_id" : 94158,
        "reputation" : 10059,
        "user_id" : 257233,
        "user_type" : "registered",
        "accept_rate" : 88,
        "profile_image" : "https://www.gravatar.com/avatar/eee4f99bf88fb3d8f577e40f236caf12?s=256&d=identicon&r=PG",
        "display_name" : "Robert Mark Bram",
        "link" : "https://stackoverflow.com/users/257233/robert-mark-bram"
      },
      "creation_date" : 1744865180,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140340401,
      "post_id" : 79575326,
      "body" : "Thanks, @RobertMarkBram. I have amended the post as well. I hope it helps.",
      "score" : 1,
      "owner" : {
        "account_id" : 106772,
        "reputation" : 7429,
        "user_id" : 284285,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/8lZ5E.jpg?s=256",
        "display_name" : "Ghislain Fourny",
        "link" : "https://stackoverflow.com/users/284285/ghislain-fourny"
      },
      "creation_date" : 1744801270,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140339204,
      "post_id" : 79575326,
      "body" : "I updated my question to reflect what I tried in response to your suggestion.",
      "score" : 0,
      "owner" : {
        "account_id" : 94158,
        "reputation" : 10059,
        "user_id" : 257233,
        "user_type" : "registered",
        "accept_rate" : 88,
        "profile_image" : "https://www.gravatar.com/avatar/eee4f99bf88fb3d8f577e40f236caf12?s=256&d=identicon&r=PG",
        "display_name" : "Robert Mark Bram",
        "link" : "https://stackoverflow.com/users/257233/robert-mark-bram"
      },
      "creation_date" : 1744773630,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140339158,
      "post_id" : 79575326,
      "body" : "Thank you for this @Ghislan Fourny for pointing out a link I am missing. I have tried this, but still get the same results. How can I verify that my <code>catalog.xml</code> is even being used?",
      "score" : 0,
      "owner" : {
        "account_id" : 94158,
        "reputation" : 10059,
        "user_id" : 257233,
        "user_type" : "registered",
        "accept_rate" : 88,
        "profile_image" : "https://www.gravatar.com/avatar/eee4f99bf88fb3d8f577e40f236caf12?s=256&d=identicon&r=PG",
        "display_name" : "Robert Mark Bram",
        "link" : "https://stackoverflow.com/users/257233/robert-mark-bram"
      },
      "creation_date" : 1744771709,
      "content_license" : "CC BY-SA 4.0"
    } ],
    "79578578" : [ {
      "comment_id" : 140343796,
      "post_id" : 79578578,
      "body" : "This would work with XBRL processors (DTS discovery mechanism), but XML Schema validation engines unaware of XBRL will not follow this link.",
      "score" : 1,
      "owner" : {
        "account_id" : 106772,
        "reputation" : 7429,
        "user_id" : 284285,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/8lZ5E.jpg?s=256",
        "display_name" : "Ghislain Fourny",
        "link" : "https://stackoverflow.com/users/284285/ghislain-fourny"
      },
      "creation_date" : 1744880406,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}