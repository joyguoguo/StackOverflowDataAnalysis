{
  "question" : {
    "question_id" : 79790883,
    "title" : "How can I make Java request focus when a window is closed from the taskbar?",
    "body" : "<p>I detect when a window is closed by the user so I can prompt to save, by adding a window listener and <code>windowClosing()</code>. If there is unsaved work I request focus for that window, then use <code>JOptionPane</code>.</p>\n<p>This works if that window is focused. But if the user closes the window by hovering over the taskbar and clicking the close button there, then <em>sometimes</em> the window gains focus but sometimes just flashes on the task bar (and does not get focused). I need this to behave consistently. If this is platform-specific there might not be a solution (I am using Windows 11).</p>\n<pre><code>window.setDefaultCloseOperation(WindowConstants.DO_NOTHING_ON_CLOSE);\nwindow.addWindowListener(new WindowAdapter() {\n    public void windowClosing(final WindowEvent e) {\n        window.requestFocus();\n        window.toFront();\n        JOptionPane.showMessageDialog(window, &quot;Not saved&quot;, &quot;Not saved&quot;, JOptionPane.ERROR_MESSAGE);\n    }\n});\n</code></pre>\n<p>Using <code>SwingUtilities.invokeLater</code> separately on the focus request and the <code>JOptionPane</code> makes no difference.</p>\n<p><img src=\"https://i.sstatic.net/A2sGVmM8.gif\" alt=\"An example of what is currently happening if the window is not already focused when it is closed by the user\" /></p>\n",
    "tags" : [ "java", "swing", "windows-11" ],
    "owner" : {
      "account_id" : 44318536,
      "reputation" : 21,
      "user_id" : 31691368,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/4f5fca254fc616f7c2e90c3540d2df77?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Claire",
      "link" : "https://stackoverflow.com/users/31691368/claire"
    },
    "is_answered" : false,
    "view_count" : 120,
    "answer_count" : 0,
    "score" : 2,
    "last_activity_date" : 1761940043,
    "creation_date" : 1760512521,
    "link" : "https://stackoverflow.com/questions/79790883/how-can-i-make-java-request-focus-when-a-window-is-closed-from-the-taskbar",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140796509,
    "post_id" : 79790883,
    "body" : "@gthantop Thank you for the suggestion - setExtendedState works nicely when all windows are iconified, but doesn&#39;t always work when I&#39;m in another window, e.g. like now when I&#39;m in Chrome. So problem is partially solved but not completely!",
    "score" : 0,
    "owner" : {
      "account_id" : 44318536,
      "reputation" : 21,
      "user_id" : 31691368,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/4f5fca254fc616f7c2e90c3540d2df77?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Claire",
      "link" : "https://stackoverflow.com/users/31691368/claire"
    },
    "creation_date" : 1760515518,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140796492,
    "post_id" : 79790883,
    "body" : "@Abra If I use WindowConstants.EXIT_ON_CLOSE then other windows within the program will end up being closed without warning.",
    "score" : 0,
    "owner" : {
      "account_id" : 44318536,
      "reputation" : 21,
      "user_id" : 31691368,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/4f5fca254fc616f7c2e90c3540d2df77?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Claire",
      "link" : "https://stackoverflow.com/users/31691368/claire"
    },
    "creation_date" : 1760515151,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140796474,
    "post_id" : 79790883,
    "body" : "I can&#39;t reproduce the exact same behavior. For me, when the <code>window</code> is iconified and I try to close it from taskbar like the way you described, then the <code>JOptionPane</code> appears, but the window is not deiconified. But I am using Windows 10 so this may be the reason for the different behavior. Eitherway, assuming <code>window</code> is a <code>Frame</code>, then putting a <code>window.setExtendedState(Frame.NORMAL);</code>  call <i>before</i> <code>window.toFront();</code> fixed the issue (the window now pops up every time). <code>window.requestFocus();</code> was not needed. I am not posting this as an answer though since I can&#39;t test on Windows 11 now.",
    "score" : 1,
    "owner" : {
      "account_id" : 9059972,
      "reputation" : 3471,
      "user_id" : 6746785,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/3zi2O.png?s=256",
      "display_name" : "gthanop",
      "link" : "https://stackoverflow.com/users/6746785/gthanop"
    },
    "creation_date" : 1760514427,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140796470,
    "post_id" : 79790883,
    "body" : "I suggest that you change <code>window.setDefaultCloseOperation(WindowConstants.DO_NOTHING_O&zwnj;&#8203;N_CLOSE);</code> to <code>window.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOS&zwnj;&#8203;E);</code>. Method <code>windowClosing</code> will still be invoked.",
    "score" : 0,
    "owner" : {
      "account_id" : 2485939,
      "reputation" : 20969,
      "user_id" : 2164365,
      "user_type" : "registered",
      "accept_rate" : 40,
      "profile_image" : "https://i.sstatic.net/RKSgV.png?s=256",
      "display_name" : "Abra",
      "link" : "https://stackoverflow.com/users/2164365/abra"
    },
    "creation_date" : 1760514389,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}