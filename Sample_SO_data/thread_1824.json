{
  "question" : {
    "question_id" : 79672113,
    "title" : "Server certificates not printed when enabling System property javax.net.debug",
    "body" : "<p>I need to debug a TLS handshake error</p>\n<pre><code>sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target\n</code></pre>\n<p>for which I enabled the System Property javax.net.debug=all as explained on the Java <a href=\"https://docs.oracle.com/javase/8/docs/technotes/guides/security/jsse/ReadDebug.html\" rel=\"nofollow noreferrer\">https://docs.oracle.com/javase/8/docs/technotes/guides/security/jsse/ReadDebug.html</a> but it only prints the trust store contents, but not the server certificate presented during handshake or the chain.</p>\n<pre><code>FINE: Selecting OPENSSL\njavax.net.ssl|DEBUG|D3|grpc-default-worker-ELG-3-17|2025-06-19 12:03:55.710 UTC|TrustStoreManager.java:162|Inaccessible trust store: /usr/lib/jvm/java-17-openjdk-amd64/lib/security/jssecacerts\njavax.net.ssl|DEBUG|D3|grpc-default-worker-ELG-3-17|2025-06-19 12:03:55.710 UTC|TrustStoreManager.java:113|trustStore is: /usr/lib/jvm/java-17-openjdk-amd64/lib/security/cacerts\ntrustStore type is: pkcs12\ntrustStore provider is:\nthe last modified time is: Wed Jun 18 20:18:53 UTC 2025\njavax.net.ssl|DEBUG|D3|grpc-default-worker-ELG-3-17|2025-06-19 12:03:55.733 UTC|X509TrustManagerImpl.java:82|adding as trusted certificates (\n  &quot;certificate&quot; : {\n    &quot;version&quot;            : &quot;v3&quot;,\n    &quot;serial number&quot;      : &quot;0d:6a:5f:08:3f:28:5c:3e:51:95:df:5d&quot;,\n    &quot;signature algorithm&quot;: &quot;SHA256withECDSA&quot;,\n    &quot;issuer&quot;             : &quot;CN=Trustwave Global ECC P256 Certification Authority, O=&quot;Trustwave Holdings, Inc.&quot;, L=Chicago, ST=Illinois, C=US&quot;,\n  . . . \n</code></pre>\n<p>I understand the help page says the format is non-standard but there is no occurrence of the word &quot;chain&quot; in the SSL debug output at all. Any help on how I can get the server certificate to be printed?</p>\n",
    "tags" : [ "java", "ssl", "sslhandshakeexception" ],
    "owner" : {
      "account_id" : 218143,
      "reputation" : 225,
      "user_id" : 474323,
      "user_type" : "registered",
      "accept_rate" : 39,
      "profile_image" : "https://www.gravatar.com/avatar/851b7fa17e397da1ccbd23071404e749?s=256&d=identicon&r=PG",
      "display_name" : "Kannan J",
      "link" : "https://stackoverflow.com/users/474323/kannan-j"
    },
    "is_answered" : false,
    "view_count" : 72,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1750347566,
    "creation_date" : 1750338935,
    "link" : "https://stackoverflow.com/questions/79672113/server-certificates-not-printed-when-enabling-system-property-javax-net-debug",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140558086,
    "post_id" : 79672113,
    "body" : "I debugged into Netty code and found that the certificate chain has a special valued certificate with the content &quot;No SNI provided; please fix your client.&quot;.",
    "score" : 0,
    "owner" : {
      "account_id" : 218143,
      "reputation" : 225,
      "user_id" : 474323,
      "user_type" : "registered",
      "accept_rate" : 39,
      "profile_image" : "https://www.gravatar.com/avatar/851b7fa17e397da1ccbd23071404e749?s=256&d=identicon&r=PG",
      "display_name" : "Kannan J",
      "link" : "https://stackoverflow.com/users/474323/kannan-j"
    },
    "creation_date" : 1751450234,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140557378,
    "post_id" : 79672113,
    "body" : "In fact when server cert verification fails, SSLSession.getPeerCertificates() throws SSLPeerUnverifiedException, so it seems like accessing failed peer certs is by design not implemented.",
    "score" : 0,
    "owner" : {
      "account_id" : 218143,
      "reputation" : 225,
      "user_id" : 474323,
      "user_type" : "registered",
      "accept_rate" : 39,
      "profile_image" : "https://www.gravatar.com/avatar/851b7fa17e397da1ccbd23071404e749?s=256&d=identicon&r=PG",
      "display_name" : "Kannan J",
      "link" : "https://stackoverflow.com/users/474323/kannan-j"
    },
    "creation_date" : 1751434555,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140555675,
    "post_id" : 79672113,
    "body" : "@JannikS. Yes, if I use Oracle Java instead of OpenJDK Java then it doesn&#39;t print the server certificates. But it does so only for a successful handshake scenario. When handshake fails which is when we would need to see the certificates the most, it doesn&#39;t print them at all.",
    "score" : 0,
    "owner" : {
      "account_id" : 218143,
      "reputation" : 225,
      "user_id" : 474323,
      "user_type" : "registered",
      "accept_rate" : 39,
      "profile_image" : "https://www.gravatar.com/avatar/851b7fa17e397da1ccbd23071404e749?s=256&d=identicon&r=PG",
      "display_name" : "Kannan J",
      "link" : "https://stackoverflow.com/users/474323/kannan-j"
    },
    "creation_date" : 1751373049,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140532522,
    "post_id" : 79672113,
    "body" : "As somebody is selecting OpenSSL, you won&#39;t be getting any <code>javax.net.debug</code> messages about the handshake. You need OpenSSL debugging.",
    "score" : 0,
    "owner" : {
      "account_id" : 71739,
      "reputation" : 311869,
      "user_id" : 207421,
      "user_type" : "registered",
      "accept_rate" : 82,
      "profile_image" : "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=256&d=identicon&r=PG",
      "display_name" : "user207421",
      "link" : "https://stackoverflow.com/users/207421/user207421"
    },
    "creation_date" : 1750572972,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140527094,
    "post_id" : 79672113,
    "body" : "What options did you use when enabling the SSL log?",
    "score" : 0,
    "owner" : {
      "account_id" : 372682,
      "reputation" : 26512,
      "user_id" : 721855,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/vZiox.png?s=256",
      "display_name" : "aled",
      "link" : "https://stackoverflow.com/users/721855/aled"
    },
    "creation_date" : 1750345255,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140526860,
    "post_id" : 79672113,
    "body" : "For what its worth, JDK 17 appears to be using a slightly different format documented <a href=\"https://docs.oracle.com/en/java/javase/17/security/java-secure-socket-extension-jsse-reference-guide.html#GUID-4D421910-C36D-40A2-8BA2-7D42CCBED3C6__GUID-3FE3E95C-CD56-4170-ABA4-502151FF69D3\" rel=\"nofollow noreferrer\">here</a>. The interesting stuff is in a log entry starting with <code>Consuming server Certificate handshake message (</code>",
    "score" : 1,
    "owner" : {
      "account_id" : 30223964,
      "reputation" : 252,
      "user_id" : 23162960,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/2451acfac254a6fc75757ecf89d75f9a?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Jannik S.",
      "link" : "https://stackoverflow.com/users/23162960/jannik-s"
    },
    "creation_date" : 1750340416,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}