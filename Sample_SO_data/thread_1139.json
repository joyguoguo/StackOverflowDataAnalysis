{
  "question" : {
    "question_id" : 79739181,
    "title" : "Buttons in GridPane stacking on top of each other",
    "body" : "<p>I am having an issue with displaying a grid of buttons properly. I essentially need the following:</p>\n<ul>\n<li>The buttons need to be in a grid like in the second picture</li>\n<li>The buttons need to be square</li>\n<li>The buttons need to resize to fit into the window</li>\n</ul>\n<p>Currently, when the page loads, the buttons stack over each over (see the first screenshot) until one of them is clicked (see the second screenshot). Note that a clicked button will only &quot;fix&quot; the buttons in its box.</p>\n<p>For context, I am trying to recreate the game <a href=\"https://murdle.com/?mode=tutorial\" rel=\"nofollow noreferrer\">Murdle</a> as a desktop application, and I need to make sure it works on screens other than my own.</p>\n<p>My code for rendering a block of buttons. StateButton is essentially just a wrapper to combine a Button with some game data. I can add that if needed</p>\n<p><a href=\"https://i.sstatic.net/7Jg2hAeK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/7Jg2hAeK.png\" alt=\"Screenshot 1 stacked buttons\" /></a></p>\n<p><a href=\"https://i.sstatic.net/BOw3qpCz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/BOw3qpCz.png\" alt=\"Screenshot 2 proper buttons\" /></a></p>\n<p>I've tried binding the pref width of the buttons to their height. I was also trying to change the grid pane's row widths. All of this ends up with unexpected behavior where the buttons aren't staying as a grid while resizing. My code follows.</p>\n<pre class=\"lang-java prettyprint-override\"><code>private GridPane drawBlock(Block block) {\n    GridPane gridPane = new GridPane();\n    gridPane.getStyleClass().add(&quot;board-block&quot;);\n\n    DoubleProperty doubleProperty = new SimpleDoubleProperty();\n\n    for (int i = 0; i &lt; block.getRowsList().size(); i++) {\n        for (int j = 0; j &lt; block.getRowsList().get(i).getBoxes().size(); j++) {\n            StateButton stateButton = new StateButton();\n            stateButton.setBox(block.getRowsList().get(i).getBoxes().get(j));\n            stateButton.setOnAction(e -&gt; stateButton.updateState());\n            stateButton.textProperty().bind(stateButton.getBox().stateIconProperty());\n\n//            stateButton.maxHeightProperty().bind(stateButton.widthProperty());\n            stateButton.prefHeightProperty().bind(stateButton.widthProperty());\n//            stateButton.minHeightProperty().bind(stateButton.widthProperty());\n            stateButton.getBox().setState(Box.BoxState.UNSURE);\n            stateButton.getBox().update();\n            if (i+j==0) doubleProperty.bind(stateButton.widthProperty());\n        }\n    }\n\n    RowConstraints rowConstraints = new RowConstraints();\n    rowConstraints.prefHeightProperty().bind(doubleProperty);\n\n    gridPane.getRowConstraints().add(rowConstraints);\n\n    return gridPane;\n}\n</code></pre>\n<p>StateButton code</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Setter\n@Getter\npublic class StateButton extends Button {\n\n    private Box box;\n\n    public void updateState() {\n        box.update();\n    }\n\n    public StateButton() {\n        super();\n        getStyleClass().add(&quot;state-button&quot;);\n    }\n\n}\n</code></pre>\n<p>Box class code</p>\n<pre class=\"lang-java prettyprint-override\"><code>@AllArgsConstructor\npublic class Box {\n\n    @Getter\n    private BoxState state;\n\n    private StringProperty stateIcon;\n\n    private List&lt;EliminationListener&gt; eliminationListeners = new ArrayList&lt;&gt;();\n\n    public Box() {\n        state = BoxState.UNMARKED;\n        stateIcon = new SimpleStringProperty(state.getIcon());\n    }\n\n    public Box(BoxState newState) {\n        this.state = newState;\n        this.stateIcon = new SimpleStringProperty(newState.getIcon());\n    }\n\n    public void setState(BoxState state){\n        this.state = state;\n        stateIcon.setValue(state.getIcon());\n    }\n\n    public void addEliminationListener(EliminationListener listener) {\n        eliminationListeners.add(listener);\n    }\n\n    public StringProperty stateIconProperty() { return stateIcon; }\n    public final String getSateIcon() { return stateIcon.getValue(); }\n    public final void setStateIcon(String icon) {\n        stateIcon.setValue(icon);\n    }\n\n    public void populateFromBox(Box box) {\n        this.setState(box.getState());\n    }\n\n    public Box clone() {\n        return new Box(state);\n    }\n\n    public void update() {\n        state = state.update(eliminationListeners);\n\n        switch (state) {\n            case TRUE -&gt; eliminationListeners.forEach(EliminationListener::eliminate);\n            case UNSURE -&gt; eliminationListeners.forEach(EliminationListener::uneliminate);\n        }\n\n        setStateIcon(state.getIcon());\n    }\n\n    public void eliminate() {\n        state = state.onEliminated();\n        stateIcon.setValue(state.getIcon());\n\n    }\n\n    public void uneliminate() {\n        state = state.onUneliminated(eliminationListeners);\n        stateIcon.setValue(state.getIcon());\n    }\n\n    public enum BoxState {\n        UNMARKED{\n\n            @Override\n            public BoxState update(List&lt;EliminationListener&gt; eliminationListeners) {\n                return BoxState.FALSE;\n            }\n\n            @Override\n            public BoxState onEliminated() {\n                return BoxState.FALSE_BY_ELIMINATION;\n            }\n\n            @Override\n            public String getIcon() { return &quot;&quot;; }\n        },\n        FALSE {\n            @Override\n            public BoxState update(List&lt;EliminationListener&gt; eliminationListeners) {\n                return checkEliminable(eliminationListeners) ? BoxState.FALSE : BoxState.TRUE;\n            }\n\n            @Override\n            public String getIcon() { return &quot;❌&quot;;}\n        },\n        TRUE {\n\n            @Override\n            public BoxState update(List&lt;EliminationListener&gt; eliminationListeners) {\n                return BoxState.UNSURE;\n            }\n\n            @Override\n            public String getIcon() { return &quot;✅&quot;; }\n        },\n        UNSURE {\n\n            @Override\n            public BoxState update(List&lt;EliminationListener&gt; eliminationListeners) {\n                return checkEliminable(eliminationListeners) ? BoxState.FALSE_BY_ELIMINATION : BoxState.UNMARKED; //good\n            }\n\n            @Override\n            public String getIcon() { return &quot;❓&quot;; }\n        },\n        FALSE_BY_ELIMINATION {\n\n            @Override\n            public BoxState onUneliminated(List&lt;EliminationListener&gt; eliminationListeners) {\n                return !checkEliminable(eliminationListeners) ? BoxState.UNMARKED : BoxState.FALSE_BY_ELIMINATION;\n            }\n\n            @Override\n            public String getIcon() { return &quot;ⅹ&quot;; }\n        };\n\n        public BoxState update(List&lt;EliminationListener&gt; eliminationListeners) {\n            return this;\n        }\n        public BoxState onEliminated() {\n            return this;\n        }\n        public BoxState onUneliminated(List&lt;EliminationListener&gt; eliminationListeners) {\n            return this;\n        }\n        public abstract String getIcon();\n\n        private static boolean checkEliminable(List&lt;EliminationListener&gt; eliminationListeners) {\n            return eliminationListeners.stream().anyMatch(EliminationListener::checkEliminable);\n        }\n    }\n\n}\n</code></pre>\n<p>Block class</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Data\n@AllArgsConstructor\npublic class Block {\n    private List&lt;RowColumn&gt; rowsList;\n    private List&lt;RowColumn&gt; columnsList;\n    private SuspectType rowType;\n    private SuspectType columnType;\n\n    public Block(List&lt;? extends Suspect&gt; rowSuspects, List&lt;? extends Suspect&gt; columnSuspects)  {\n        if (rowSuspects.isEmpty() || columnSuspects.isEmpty()){\n            throw new IllegalArgumentException(&quot;rowSuspects and columnSuspects must not be empty&quot;);\n        } else if (rowSuspects.size() != columnSuspects.size()) {\n            throw new IllegalArgumentException(&quot;Must have the same number of rowSuspects and columnSuspects! rowSuspects.size()=&quot; + rowSuspects.size() + &quot;, columnSuspects.size()=&quot; + columnSuspects.size());\n        }\n\n        rowType = determineType(rowSuspects.get(0));\n        columnType = determineType(columnSuspects.get(0));\n\n        rowsList = new ArrayList&lt;&gt;();\n        columnsList = new ArrayList&lt;&gt;();\n\n        for (int i = 0; i &lt; rowSuspects.size(); i++) {\n            RowColumn row = new RowColumn();\n            for (int j = 0; j &lt; columnSuspects.size(); j++){\n                row.add(new Box());\n            }\n            rowsList.add(row);\n        }\n\n        for (int i = 0; i &lt; columnSuspects.size(); i++) {\n            RowColumn column = new RowColumn();\n            for (RowColumn row : rowsList) {\n                column.add(row.getBoxes().get(i));\n            }\n            columnsList.add(column);\n        }\n    }\n\n    private SuspectType determineType(Suspect suspect) {\n        if (suspect instanceof Person) {\n            return SuspectType.PERSON;\n        } else if (suspect instanceof Location) {\n            return SuspectType.LOCATION;\n        } else if (suspect instanceof Weapon) {\n            return SuspectType.WEAPON;\n        } else if (suspect instanceof Motive) {\n            return SuspectType.MOTIVE;\n        } else {\n            throw new IllegalArgumentException(&quot;Unknown suspect type: &quot; + suspect.getClass().getName());\n        }\n\n    }\n\n    public void populateFromBlock(Block fromBlock) {\n        for (int i = 0; i &lt; rowsList.size(); i++) {\n            for (int j = 0; j &lt; rowsList.get(i).getBoxes().size(); j++) {\n                rowsList.get(i).getBoxes().get(j).populateFromBox(fromBlock.getRowsList().get(i).getBoxes().get(j));\n            }\n        }\n    }\n\n    public Block clone() {\n        List&lt;RowColumn&gt; newRowList = new ArrayList&lt;&gt;();\n        for (RowColumn row : rowsList) {\n            newRowList.add(row.clone());\n        }\n\n        List&lt;RowColumn&gt; newColumnList = new ArrayList&lt;&gt;();\n        for (int i = 0; i &lt; columnsList.size(); i++) {\n            RowColumn newColumn = new RowColumn();\n            for (RowColumn row : rowsList) {\n                newColumn.add(row.boxes.get(i));\n            }\n            newColumnList.add(newColumn);\n        }\n\n        return new Block(newRowList, newColumnList, this.rowType, this.columnType);\n    }\n}\n</code></pre>\n<p>FXML for the view</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n\n&lt;?import javafx.scene.control.*?&gt;\n&lt;?import javafx.scene.layout.*?&gt;\n\n&lt;HBox alignment=&quot;CENTER&quot; spacing=&quot;30.0&quot; xmlns=&quot;http://javafx.com/javafx/17.0.12&quot; xmlns:fx=&quot;http://javafx.com/fxml/1&quot; fx:controller=&quot;org.zday.murdle.controller.CaseController&quot;&gt;\n    &lt;VBox&gt;\n        &lt;Button text=&quot;Back&quot; styleClass=&quot;back-button&quot; onAction=&quot;#returnToLevelSelect&quot;/&gt;\n    &lt;/VBox&gt;\n    &lt;ScrollPane fx:id=&quot;clueScrollPane&quot; styleClass=&quot;clue-scroll-pane&quot;&gt;\n        &lt;VBox fx:id=&quot;cluePane&quot; styleClass=&quot;clue-pane&quot;&gt;\n            &lt;Label fx:id=&quot;titleLabel&quot; styleClass=&quot;case-title&quot;/&gt;\n\n            &lt;Label fx:id=&quot;caseDescriptionLabel&quot;/&gt;\n\n            &lt;HBox fx:id=&quot;suspectCardsPane&quot; styleClass=&quot;suspect-cards-pane&quot;/&gt;\n            &lt;HBox fx:id=&quot;suspectTypeSelectionPane&quot; styleClass=&quot;suspect-type-selection-pane&quot; /&gt;\n\n\n            &lt;VBox fx:id=&quot;clueListPane&quot; styleClass=&quot;clue-list-pane&quot;&gt;\n                &lt;Label text=&quot;Clues and Evidence&quot; fx:id=&quot;clueListPaneTitleLabel&quot; styleClass=&quot;clue-list-title&quot;/&gt;\n            &lt;/VBox&gt;\n\n            &lt;VBox fx:id=&quot;suspectStatementsPane&quot; styleClass=&quot;clue-list-pane&quot;&gt;\n                &lt;Label text=&quot;Suspect Statements&quot; styleClass=&quot;clue-list-title&quot;/&gt;\n                &lt;Label text=&quot;(Remember: The murderer is lying. The others are telling the truth.)&quot; styleClass=&quot;suspect-statement-hint&quot;/&gt;\n            &lt;/VBox&gt;\n\n            &lt;Button onAction=&quot;#showHint&quot; text=&quot;Hint&quot; /&gt;\n\n            &lt;VBox fx:id=&quot;solutionInputPane&quot; styleClass=&quot;solution-input-pane&quot;/&gt;\n\n            &lt;Label fx:id=&quot;resolutionLabel&quot; wrapText=&quot;true&quot;/&gt;\n        &lt;/VBox&gt;\n    &lt;/ScrollPane&gt;\n    &lt;VBox fx:id=&quot;notebookPane&quot; alignment=&quot;CENTER&quot;/&gt;\n&lt;/HBox&gt;\n</code></pre>\n",
    "tags" : [ "java", "javafx", "lombok" ],
    "owner" : {
      "account_id" : 16741746,
      "reputation" : 61,
      "user_id" : 12101195,
      "user_type" : "registered",
      "profile_image" : "https://graph.facebook.com/2324065167853691/picture?type=large",
      "display_name" : "splatman73",
      "link" : "https://stackoverflow.com/users/12101195/splatman73"
    },
    "is_answered" : false,
    "view_count" : 107,
    "answer_count" : 0,
    "score" : 2,
    "last_activity_date" : 1755662732,
    "creation_date" : 1755546427,
    "link" : "https://stackoverflow.com/questions/79739181/buttons-in-gridpane-stacking-on-top-of-each-other",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140680003,
    "post_id" : 79739181,
    "body" : "This looks to be a static view. Just create it using FXML and load the state data when needed.",
    "score" : 0,
    "owner" : {
      "account_id" : 2819940,
      "reputation" : 14002,
      "user_id" : 2423906,
      "user_type" : "registered",
      "accept_rate" : 100,
      "profile_image" : "https://i.sstatic.net/rkpYv.jpg?s=256",
      "display_name" : "SedJ601",
      "link" : "https://stackoverflow.com/users/2423906/sedj601"
    },
    "creation_date" : 1755712269,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140679077,
    "post_id" : 79739181,
    "body" : "If you implement bindings on the <code>min&#47;pref&#47;max</code> width and height properties, you create additional dependencies which work outside of the framework of the layout mechanism (described briefly in my previous comment). As a consequence, it&#39;s easy to create circular dependencies and generate unexpected results. I can&#39;t tell if that&#39;s exactly what&#39;s happening here, but it&#39;s a reasonable guess. Probably what you need here is a custom layout; subclass <code>Region</code>, override the resizable range methods, and override <code>layoutChildren(...)</code>. The latter method just needs to resize and position the buttons.",
    "score" : 0,
    "owner" : {
      "account_id" : 2518243,
      "reputation" : 210906,
      "user_id" : 2189127,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/e8e6e627b4b90ec816c5c7aa04cbcc26?s=256&d=identicon&r=PG",
      "display_name" : "James_D",
      "link" : "https://stackoverflow.com/users/2189127/james-d"
    },
    "creation_date" : 1755693823,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140679070,
    "post_id" : 79739181,
    "body" : "Binding the min/pref/max size of nodes can be a little unreliable. There are already dependencies defined here by the library code; e.g. the preferred size of a parent is computed in terms of the preferred size of the child nodes, and for some nodes the preferred width/height already depends on the preferred height/width (depending on the orientation bias). None of these are implemented via bindings, but by overriding the <code>layoutChildren()</code> method (to perform actual sizing) and the <code>min&#47;pref&#47;maxWidth&#47;Height(double)</code> methods (to calculate size ranges).",
    "score" : 0,
    "owner" : {
      "account_id" : 2518243,
      "reputation" : 210906,
      "user_id" : 2189127,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/e8e6e627b4b90ec816c5c7aa04cbcc26?s=256&d=identicon&r=PG",
      "display_name" : "James_D",
      "link" : "https://stackoverflow.com/users/2189127/james-d"
    },
    "creation_date" : 1755693607,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140678061,
    "post_id" : 79739181,
    "body" : "Basically you want help debugging your code. Speaking only for myself, the best way for me to do that is to first <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">reproduce</a> your problem. Forgive me, but I don&#39;t see how I can do that with the code in your question.",
    "score" : 1,
    "owner" : {
      "account_id" : 2485939,
      "reputation" : 20969,
      "user_id" : 2164365,
      "user_type" : "registered",
      "accept_rate" : 40,
      "profile_image" : "https://i.sstatic.net/RKSgV.png?s=256",
      "display_name" : "Abra",
      "link" : "https://stackoverflow.com/users/2164365/abra"
    },
    "creation_date" : 1755663043,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140674599,
    "post_id" : 79739181,
    "body" : "Please provide a the code for <code>StateButton</code> or provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> using a standard <code>Button</code>.  Try to make it easy for potential answerers to help you by provided code which replicates the issue with copy and paste and no change or addition.",
    "score" : 7,
    "owner" : {
      "account_id" : 1180113,
      "reputation" : 160457,
      "user_id" : 1155209,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/5192e7cbcf2f72a847d6fb0d1552f049?s=256&d=identicon&r=PG",
      "display_name" : "jewelsea",
      "link" : "https://stackoverflow.com/users/1155209/jewelsea"
    },
    "creation_date" : 1755546596,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}