{
  "question" : {
    "question_id" : 79692165,
    "title" : "Setting up the validator gives errors Jersey",
    "body" : "<p>I am trying to set up the bean validation in my jersey server. I would like to assure that everytime I get an email in this bean it is not null. But with this current setup, everytime jersey tries to validate it gives a nullpointerException:</p>\n<pre><code>java.lang.NullPointerException: Cannot invoke &quot;jakarta.ws.rs.container.ResourceContext.getResource(java.lang.Class)&quot; because &quot;this.resourceContext&quot; is null\n        at org.glassfish.jersey.server.validation.internal.InjectingConstraintValidatorFactory.getInstance(InjectingConstraintValidatorFactory.java:37)\n        at org.hibernate.validator.internal.engine.constraintvalidation.ClassBasedValidatorDescriptor.newInstance(ClassBasedValidatorDescriptor.java:84)\n        at org.hibernate.validator.internal.engine.constraintvalidation.AbstractConstraintValidatorManagerImpl.createAndInitializeValidator(AbstractConstraintValidatorManagerImpl.java:89)\n        at org.hibernate.validator.internal.engine.constraintvalidation.ConstraintValidatorManagerImpl.getInitializedValidator(ConstraintValidatorManagerImpl.java:117)\n        at org.hibernate.validator.internal.engine.constraintvalidation.ConstraintTree.getInitializedConstraintValidator(ConstraintTree.java:152)\n        at org.hibernate.validator.internal.engine.constraintvalidation.SimpleConstraintTree.validateConstraints(SimpleConstraintTree.java:58)\n        at org.hibernate.validator.internal.engine.constraintvalidation.ConstraintTree.validateConstraints(ConstraintTree.java:75)\n        at org.hibernate.validator.internal.metadata.core.MetaConstraint.doValidateConstraint(MetaConstraint.java:130)\n        at org.hibernate.validator.internal.metadata.core.MetaConstraint.validateConstraint(MetaConstraint.java:123)\n        at org.hibernate.validator.internal.engine.ValidatorImpl.validateMetaConstraint(ValidatorImpl.java:555)\n        at org.hibernate.validator.internal.engine.ValidatorImpl.validateConstraintsForSingleDefaultGroupElement(ValidatorImpl.java:518)\n        at org.hibernate.validator.internal.engine.ValidatorImpl.validateConstraintsForDefaultGroup(ValidatorImpl.java:488)\n        at org.hibernate.validator.internal.engine.ValidatorImpl.validateConstraintsForCurrentGroup(ValidatorImpl.java:450)\n        at org.hibernate.validator.internal.engine.ValidatorImpl.validateInContext(ValidatorImpl.java:400)\n        at org.hibernate.validator.internal.engine.ValidatorImpl.validateCascadedAnnotatedObjectForCurrentGroup(ValidatorImpl.java:629)\n        at org.hibernate.validator.internal.engine.ValidatorImpl.validateCascadedConstraints(ValidatorImpl.java:590)\n        at org.hibernate.validator.internal.engine.ValidatorImpl.validateParametersInContext(ValidatorImpl.java:880)\n        at org.hibernate.validator.internal.engine.ValidatorImpl.validateParameters(ValidatorImpl.java:283)\n        at org.hibernate.validator.internal.engine.ValidatorImpl.validateParameters(ValidatorImpl.java:235)\n        at org.glassfish.jersey.server.validation.internal.DefaultConfiguredValidator.onValidate(DefaultConfiguredValidator.java:154)\n        at org.glassfish.jersey.server.validation.internal.ValidationInterceptorExecutor.proceed(ValidationInterceptorExecutor.java:95)\n        at org.glassfish.jersey.server.validation.internal.DefaultConfiguredValidator.validateResourceAndInputParams(DefaultConfiguredValidator.java:122)\n        at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:136)\n        at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159)\n        at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:93)\n        at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:478)\n        at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:400)\n        at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81)\n        at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:263)\n        at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248)\n        at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244)\n        at org.glassfish.jersey.internal.Errors.process(Errors.java:292)\n        at org.glassfish.jersey.internal.Errors.process(Errors.java:274)\n        at org.glassfish.jersey.internal.Errors.process(Errors.java:244)\n        at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:266)\n        at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:242)\n        at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:704)\n        at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:420)\n        at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:372)\n        at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:358)\n        at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:312)\n        at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205)\n</code></pre>\n<p>My classes look like this:</p>\n<p>HelloAplication.java</p>\n<pre><code>@ApplicationPath(&quot;/api&quot;)\npublic class HelloApplication extends Application {\n\n    public HelloApplication() {\n    }\n\n    public Map&lt;String, Object&gt; getProperties() {\n        Map&lt;String, Object&gt; ret = new HashMap&lt;&gt;();\n        ret.put(ServerProperties.BV_SEND_ERROR_IN_RESPONSE, true);\n        return ret;\n    }\n}\n</code></pre>\n<p>AccountResource.java</p>\n<pre><code>@Path(&quot;/account&quot;)\npublic class AccountResource {\n\n    @POST\n    @Consumes(MediaType.APPLICATION_JSON)\n    public void postAccount(@Valid CreateAccountBean newAccount) {\n        System.out.println(newAccount);\n    }\n}\n</code></pre>\n<p>CreateAccountBean.java</p>\n<pre><code>import jakarta.validation.constraints.NotNull;\n\npublic record CreateAccountBean(@NotNull String email, String name, String password) {\n}\n</code></pre>\n<p>Dependencies from pom.xml</p>\n<pre><code>&lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;jakarta.servlet&lt;/groupId&gt;\n            &lt;artifactId&gt;jakarta.servlet-api&lt;/artifactId&gt;\n            &lt;version&gt;6.1.0&lt;/version&gt;\n            &lt;scope&gt;provided&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.glassfish.jersey.containers&lt;/groupId&gt;\n            &lt;artifactId&gt;jersey-container-servlet&lt;/artifactId&gt;\n            &lt;version&gt;4.0.0-M1&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.glassfish.jersey.media&lt;/groupId&gt;\n            &lt;artifactId&gt;jersey-media-json-jackson&lt;/artifactId&gt;\n            &lt;version&gt;4.0.0-M1&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.glassfish.jersey.inject&lt;/groupId&gt;\n            &lt;artifactId&gt;jersey-cdi2-se&lt;/artifactId&gt;\n            &lt;version&gt;4.0.0-M1&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.jboss.weld.se&lt;/groupId&gt;\n            &lt;artifactId&gt;weld-se-core&lt;/artifactId&gt;\n            &lt;version&gt;6.0.0.Beta4&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.glassfish.jersey.ext&lt;/groupId&gt;\n            &lt;artifactId&gt;jersey-bean-validation&lt;/artifactId&gt;\n            &lt;version&gt;4.0.0-M1&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.glassfish.jaxb&lt;/groupId&gt;\n            &lt;artifactId&gt;jaxb-runtime&lt;/artifactId&gt;\n            &lt;version&gt;4.0.5&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;\n            &lt;artifactId&gt;junit-jupiter-api&lt;/artifactId&gt;\n            &lt;version&gt;${junit.version}&lt;/version&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;\n            &lt;artifactId&gt;junit-jupiter-engine&lt;/artifactId&gt;\n            &lt;version&gt;${junit.version}&lt;/version&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n</code></pre>\n<p>ValidationConfigurationContextResolver.java</p>\n<pre><code>@Provider\npublic class ValidationConfigurationContextResolver implements ContextResolver&lt;ValidationConfig&gt; {\n    @Context\n    public ResourceContext resourceContext;\n\n    @Override\n    public ValidationConfig getContext(Class&lt;?&gt; type) {\n        ValidationConfig config = new ValidationConfig();\n        config.constraintValidatorFactory(\n                resourceContext.getResource(InjectingConstraintValidatorFactory.class));\n        return config;\n    }\n}\n</code></pre>\n<p>I am using apache tomcat 10.1.40. Does someone know how to fix this error? I could not find anything online about this and I tried following the code from the documentation (<a href=\"https://eclipse-ee4j.github.io/jersey.github.io/documentation/latest31x/bean-validation.html#bv.injecting\" rel=\"nofollow noreferrer\">https://eclipse-ee4j.github.io/jersey.github.io/documentation/latest31x/bean-validation.html#bv.injecting</a>) but that also didn't work.\nThanks in advance.</p>\n",
    "tags" : [ "java", "validation", "server", "jersey", "jax-rs" ],
    "owner" : {
      "account_id" : 16638460,
      "reputation" : 31,
      "user_id" : 12024613,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a-/AAuE7mC6xjrBcj6goLOeTft6w2vZkBcluwkCQQIBV8BG=k-s256",
      "display_name" : "Rik Smits",
      "link" : "https://stackoverflow.com/users/12024613/rik-smits"
    },
    "is_answered" : false,
    "view_count" : 50,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1751844020,
    "creation_date" : 1751844020,
    "link" : "https://stackoverflow.com/questions/79692165/setting-up-the-validator-gives-errors-jersey",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140570665,
    "post_id" : 79692165,
    "body" : "I changed InjectingConstraintValidatorFactory.class with ConstraintValidatorFactoryImpl.class in ValidationConfigurationContextResolver. This seems to fix the problem but I am not certain yet why so I will leave the question open for now so someone can explain this further.",
    "score" : 0,
    "owner" : {
      "account_id" : 16638460,
      "reputation" : 31,
      "user_id" : 12024613,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a-/AAuE7mC6xjrBcj6goLOeTft6w2vZkBcluwkCQQIBV8BG=k-s256",
      "display_name" : "Rik Smits",
      "link" : "https://stackoverflow.com/users/12024613/rik-smits"
    },
    "creation_date" : 1751892950,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140569312,
    "post_id" : 79692165,
    "body" : "Looking at <a href=\"https://github.com/eclipse-ee4j/jersey/blob/c06969c58500039af7d7586b3bf7fc62a7de2eb2/ext/bean-validation/src/main/java/org/glassfish/jersey/server/validation/internal/InjectingConstraintValidatorFactory.java#L33\" rel=\"nofollow noreferrer\">the source code</a>, it seems like this is failing because the environment is not properly configured to inject a <code>ResourceContext</code>. Admittedly I don&#39;t know much about Jersey, but that seems similar to <a href=\"https://github.com/eclipse-ee4j/jersey/issues/5100\" rel=\"nofollow noreferrer\">this issue</a> on the GitHub page.",
    "score" : 0,
    "owner" : {
      "account_id" : 14914414,
      "reputation" : 1185,
      "user_id" : 10808904,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/Ts8fIsJj.png?s=256",
      "display_name" : "Xavier Pedraza",
      "link" : "https://stackoverflow.com/users/10808904/xavier-pedraza"
    },
    "creation_date" : 1751844963,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}