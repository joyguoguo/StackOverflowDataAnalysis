{
  "question" : {
    "question_id" : 79730539,
    "title" : "Maven dependency from source",
    "body" : "<p>Is it's possible to use source repo as dependency instead of jar? I got few legacy projects in my selfhosted gitlab:</p>\n<ul>\n<li>core(child)</li>\n<li>api(parent)</li>\n<li>web(parent)</li>\n</ul>\n<p>The &quot;core&quot; project is dependency for &quot;api&quot; and &quot;web&quot;. I have a problem with local build. If I use a regular way It's require hardcoded token in code or additional staff training to use their own system environment. And staff should be careful every time to avoid push their token to repo.</p>\n<p>The best way is ssh key in my view. But gitlab package registry work over http(s) only but not over ssh. If I can't download artifact over ssh then maybe I could download and build source from remote repo like it work with composer or npm. Is it possible for maven?</p>\n",
    "tags" : [ "java", "maven", "gitlab" ],
    "owner" : {
      "account_id" : 12952227,
      "reputation" : 37,
      "user_id" : 9364139,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/s256-rj/photo.jpg",
      "display_name" : "SubGunDH",
      "link" : "https://stackoverflow.com/users/9364139/subgundh"
    },
    "is_answered" : true,
    "view_count" : 100,
    "closed_date" : 1754761031,
    "answer_count" : 2,
    "score" : -3,
    "last_activity_date" : 1754740722,
    "creation_date" : 1754733220,
    "link" : "https://stackoverflow.com/questions/79730539/maven-dependency-from-source",
    "closed_reason" : "Needs details or clarity"
  },
  "answers" : [ {
    "answer_id" : 79730557,
    "question_id" : 79730539,
    "body" : "<p>You can resolve this issue with local builds:</p>\n<ol>\n<li><p>Clone <strong>core</strong> via SSH (no token)</p>\n</li>\n<li><p>Run:</p>\n<p><code>mvn clean install </code></p>\n</li>\n<li><p>This installs <strong>core</strong> into your <strong>local Maven repository</strong> (<code>~/.m2/repository</code>)</p>\n</li>\n<li><p>Now <strong>api</strong> and <strong>web</strong> can reference it in <code>pom.xml</code> without touching GitLab or HTTP tokens.</p>\n</li>\n</ol>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 6233026,
      "reputation" : 93,
      "user_id" : 4849128,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/eN0WJ.jpg?s=256",
      "display_name" : "Mohammad Taghi Ahadi",
      "link" : "https://stackoverflow.com/users/4849128/mohammad-taghi-ahadi"
    },
    "creation_date" : 1754735587,
    "last_activity_date" : 1754735587,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79730600,
    "question_id" : 79730539,
    "body" : "<p>Using a source repository directly as a dependency in Maven, similar to how Composer or npm handle it, is not a standard or officially supported feature. Maven is fundamentally designed to work with compiled artifacts (JARs, WARs, etc.) that are stored in a repository, such as a local Maven cache, a remote corporate repository like Nexus or Artifactory, or a public one like Maven Central.</p>\n<p>The core of Maven's dependency resolution mechanism relies on the <code>pom.xml</code> to specify an artifact's GAV coordinates (GroupId, ArtifactId, Version), which Maven then uses to find and download the pre-built <code>.jar</code> file. It does not have a built-in mechanism to clone a Git repository, build the project from source, and then include it as a dependency.</p>\n<h3>Alternatives and Recommended Solutions</h3>\n<p>Given your constraints and the goal of avoiding hardcoded tokens, here are the most common and robust solutions:</p>\n<hr />\n<h4>1. Maven Profile with SSH</h4>\n<p>You can configure a Maven profile to pull dependencies over SSH. This is a common solution for private repositories.</p>\n<ul>\n<li><p><strong>Configure SSH:</strong> First, ensure your GitLab server allows SSH for package registry access. Many self-hosted GitLab instances can be configured to do this, though it's not the default.</p>\n</li>\n<li><p><strong>Settings.xml:</strong> Configure your <code>~/.m2/settings.xml</code> to use the SSH protocol. You would define a server and then a repository within your <code>pom.xml</code> that uses the <code>ssh://</code> protocol.</p>\n</li>\n</ul>\n<p>XML</p>\n<pre><code>&lt;settings&gt;\n  &lt;servers&gt;\n    &lt;server&gt;\n      &lt;id&gt;gitlab-maven&lt;/id&gt;\n      &lt;username&gt;git&lt;/username&gt;\n      &lt;privateKey&gt;${user.home}/.ssh/id_rsa&lt;/privateKey&gt;\n    &lt;/server&gt;\n  &lt;/servers&gt;\n&lt;/settings&gt;\n</code></pre>\n<p>XML</p>\n<pre><code>&lt;project&gt;\n  ...\n  &lt;repositories&gt;\n    &lt;repository&gt;\n      &lt;id&gt;gitlab-maven&lt;/id&gt;\n      &lt;url&gt;ssh://git@gitlab.yourdomain.com:22/group/core.git&lt;/url&gt;\n    &lt;/repository&gt;\n  &lt;/repositories&gt;\n  ...\n&lt;/project&gt;\n</code></pre>\n<p><strong>This approach requires you to configure the <code>pom.xml</code> and <code>settings.xml</code> correctly, but it's a solid way to use SSH keys for authentication, eliminating the need for hardcoded tokens.</strong></p>\n<hr />\n<h4>2. Local File System Dependency</h4>\n<p>For local development, you can use the <code>file://</code> protocol to reference the project on your local file system. This isn't scalable for a team but can be a temporary fix for your local build issues.</p>\n<p>XML</p>\n<pre><code>&lt;project&gt;\n  ...\n  &lt;repositories&gt;\n    &lt;repository&gt;\n      &lt;id&gt;local-core-repo&lt;/id&gt;\n      &lt;url&gt;file://${project.basedir}/../core/target&lt;/url&gt;\n    &lt;/repository&gt;\n  &lt;/repositories&gt;\n  ...\n&lt;/project&gt;\n</code></pre>\n<p><strong>This method is fragile and not recommended for production or multi-developer environments, as it creates a direct dependency on the local file path.</strong></p>\n<hr />\n<h4>3. Maven Multi-Module Project (Recommended for your use case)</h4>\n<p>This is the most common and robust solution for your specific problem. If <code>core</code> is a child of a common project, you can structure your projects in a way that Maven automatically builds <code>core</code> before <code>api</code> and <code>web</code>.</p>\n<ul>\n<li><p><strong>Create a Parent POM:</strong> Create a parent <code>pom.xml</code> that lives in a root directory. This parent POM defines the <code>core</code>, <code>api</code>, and <code>web</code> projects as modules.</p>\n</li>\n<li><p><strong>Define Modules:</strong> The parent <code>pom.xml</code> will look something like this:</p>\n</li>\n</ul>\n<p>XML</p>\n<pre><code>&lt;project&gt;\n  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n  &lt;groupId&gt;com.yourcompany&lt;/groupId&gt;\n  &lt;artifactId&gt;parent-project&lt;/artifactId&gt;\n  &lt;version&gt;1.0.0&lt;/version&gt;\n  &lt;packaging&gt;pom&lt;/packaging&gt;\n\n  &lt;modules&gt;\n    &lt;module&gt;core&lt;/module&gt;\n    &lt;module&gt;api&lt;/module&gt;\n    &lt;module&gt;web&lt;/module&gt;\n  &lt;/modules&gt;\n&lt;/project&gt;\n</code></pre>\n<ul>\n<li><strong>Update Dependencies:</strong> In the <code>api</code> and <code>web</code> projects, you can simply declare a dependency on <code>core</code>. Maven will automatically resolve this dependency from the local modules.</li>\n</ul>\n<p>XML</p>\n<pre><code>&lt;project&gt;\n  ...\n  &lt;dependencies&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;com.yourcompany&lt;/groupId&gt;\n      &lt;artifactId&gt;core&lt;/artifactId&gt;\n      &lt;version&gt;1.0.0&lt;/version&gt;\n    &lt;/dependency&gt;\n  &lt;/dependencies&gt;\n&lt;/project&gt;\n</code></pre>\n<p><strong>This approach handles the build order automatically. When you run <code>mvn install</code> from the parent directory, Maven will first build and install the <code>core</code> module to your local repository, then proceed to build <code>api</code> and <code>web</code>, resolving the <code>core</code> dependency from the local repository. This is the idiomatic Maven way to handle a shared library within a multi-project setup.</strong></p>\n<p>Given your description, the <strong>Maven Multi-Module Project</strong> is the most suitable and idiomatic solution for a shared internal library. It centralizes the build process and solves the dependency problem without relying on external repositories or custom configurations.</p>\n",
    "score" : 0,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 43434747,
      "reputation" : 26,
      "user_id" : 31243664,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/e9f679530f5f8b77ae0e95d5355b55e5?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Paolo Terceros",
      "link" : "https://stackoverflow.com/users/31243664/paolo-terceros"
    },
    "creation_date" : 1754740722,
    "last_activity_date" : 1754740722,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140654248,
    "post_id" : 79730539,
    "body" : "That sounds like those projects are not contained in a single git repository because they should based on the layout and what you are describing... And no the usualy way in the Java World is to use already compiled parts via JAR files (via central repository) and do NOT recompile everything from sources as other languages like Go, Rust or TS/JS requires...Why isn&#39;t there a corporate repository manager that would make things much easier... git lab regististry is also wrong..",
    "score" : 0,
    "owner" : {
      "account_id" : 112317,
      "reputation" : 98425,
      "user_id" : 296328,
      "user_type" : "registered",
      "accept_rate" : 60,
      "profile_image" : "https://i.sstatic.net/DSpH6.jpg?s=256",
      "display_name" : "khmarbaise",
      "link" : "https://stackoverflow.com/users/296328/khmarbaise"
    },
    "creation_date" : 1754759104,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140654213,
    "post_id" : 79730539,
    "body" : "Using a source code Maven project instead of a compiled artifact is one of the features of the Maven Eclipse plugin (included in all Eclipse Java development versions). It is really great, if one of the open projects matches the referenced artifact then this project is added as dependency instead of the compiled artifact.",
    "score" : 0,
    "owner" : {
      "account_id" : 50585,
      "reputation" : 43459,
      "user_id" : 150978,
      "user_type" : "registered",
      "accept_rate" : 78,
      "profile_image" : "https://www.gravatar.com/avatar/feadc214792e2581c3c750140e3eb2c7?s=256&d=identicon&r=PG",
      "display_name" : "Robert",
      "link" : "https://stackoverflow.com/users/150978/robert"
    },
    "creation_date" : 1754757753,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140653712,
    "post_id" : 79730539,
    "body" : "Why don&#39;t you build the JARs in GitLab and then use them locally?",
    "score" : 0,
    "owner" : {
      "account_id" : 888714,
      "reputation" : 36707,
      "user_id" : 927493,
      "user_type" : "registered",
      "accept_rate" : 61,
      "profile_image" : "https://i.sstatic.net/sxsnm.png?s=256",
      "display_name" : "JF Meier",
      "link" : "https://stackoverflow.com/users/927493/jf-meier"
    },
    "creation_date" : 1754736917,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79730600" : [ {
      "comment_id" : 140653837,
      "post_id" : 79730600,
      "body" : "Please, be aware that <a href=\"https://meta.stackoverflow.com/questions/421831/policy-generative-ai-e-g-chatgpt-is-banned\">generative AI is banned</a>.",
      "score" : 3,
      "owner" : {
        "account_id" : 26384258,
        "reputation" : 15165,
        "user_id" : 20037042,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/jmXd0.png?s=256",
        "display_name" : "chrslg",
        "link" : "https://stackoverflow.com/users/20037042/chrslg"
      },
      "creation_date" : 1754742056,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}