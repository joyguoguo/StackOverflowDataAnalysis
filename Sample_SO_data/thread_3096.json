{
  "question" : {
    "question_id" : 79572393,
    "title" : "In a Java 17 app, is it possible to send an endpoint string from the frontend to the backend with a | character in a @RequestParam value?",
    "body" : "<p>I have an Angular front-end app that needs to send the following endpoint string to a Java 17 back-end.</p>\n<p>Note the | character towards the end.</p>\n<pre><code>http://localhost:8080/revision/2609?filter=ruleNumber|4\n</code></pre>\n<p>And here's the endpoint in the backend:</p>\n<pre><code>@GetMapping(value = &quot;/revision/{revisionId:[0-9][0-9]*}&quot;, produces = \nMediaType.APPLICATION_JSON_VALUE)\npublic ResponseEntity getHazardBlock(@PathVariable(&quot;revisionId&quot;) Long revisionId,\n        @RequestParam(value = &quot;filter&quot;, required = false) String filter) throws ServiceException {\n</code></pre>\n<p>This worked fine when the back-end was running off of Java 8.  The @RequestParam &quot;filter&quot; came through as 'ruleNumber|4'.</p>\n<p>Now that I've upgraded to Java 17, however, it can't even find the back-end endpoint.</p>\n<p>It's definitely dying on the | character.  As long as I don't include the | character it hits the endpoint fine.</p>\n<p>And yes, I have to do the upgrade to Java 17 and there has to be a | character in the value.</p>\n<p>Any suggestions?</p>\n",
    "tags" : [ "java", "java-17" ],
    "owner" : {
      "account_id" : 19033204,
      "reputation" : 867,
      "user_id" : 13894850,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/56b085ca89bdbc97e22bbb768cc752bf?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Tim",
      "link" : "https://stackoverflow.com/users/13894850/tim"
    },
    "is_answered" : true,
    "view_count" : 116,
    "answer_count" : 1,
    "score" : 1,
    "last_activity_date" : 1744617587,
    "creation_date" : 1744608651,
    "link" : "https://stackoverflow.com/questions/79572393/in-a-java-17-app-is-it-possible-to-send-an-endpoint-string-from-the-frontend-to",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79572631,
    "question_id" : 79572393,
    "body" : "<p>I attempted to test how the String is bound to the request parameter. This was the output I saw on my screen:</p>\n<pre class=\"lang-none prettyprint-override\"><code>2025-04-14 15:52:19.310  INFO 384861 [nio-8080-exec-1] o.a.j.l.DirectJDKLog                     : Error parsing HTTP request header\n Note: further occurrences of HTTP request parsing errors will be logged at DEBUG level.\n\njava.lang.IllegalArgumentException: Invalid character found in the request target [/revision?filter=rule|4 ]. The valid characters are defined in RFC 7230 and RFC 3986\n    at org.apache.coyote.http11.Http11InputBuffer.parseRequestLine(Http11InputBuffer.java:482)\n    at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:257)\n    at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)\n    at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:904)\n    at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)\n    at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)\n    at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)\n    at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)\n    at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)\n    at java.base/java.lang.Thread.run(Thread.java:840)\n</code></pre>\n<p>So, yes, while it is not a reserved character, it does not seem to be a valid character either. The valid characters are defined in RFC 7230 and RFC 3986. There are some solutions to this such as having relaxed query chars <a href=\"https://stackoverflow.com/a/77664676/16034206\">https://stackoverflow.com/a/77664676/16034206</a> besides URL encoding the character <code>|</code></p>\n",
    "score" : 1,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 21724606,
      "reputation" : 1431,
      "user_id" : 16034206,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/MRBdT.jpg?s=256",
      "display_name" : "pebble unit",
      "link" : "https://stackoverflow.com/users/16034206/pebble-unit"
    },
    "creation_date" : 1744617447,
    "last_activity_date" : 1744617587,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140331711,
    "post_id" : 79572393,
    "body" : "I would be surprised if this had to do with upgrading from Java 8 to Java 17; I&#39;d guess it has to do with <i>what else</i> you upgraded when moving to Java 17.",
    "score" : 1,
    "owner" : {
      "account_id" : 213468,
      "reputation" : 110282,
      "user_id" : 466862,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=256&d=identicon&r=PG",
      "display_name" : "Mark Rotteveel",
      "link" : "https://stackoverflow.com/users/466862/mark-rotteveel"
    },
    "creation_date" : 1744615947,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140331560,
    "post_id" : 79572393,
    "body" : "Just taking a shot in the dark here, but is the <code>|</code> being treated as a special character? You might need to URL encode it i.e. <code>%7C</code>",
    "score" : 2,
    "owner" : {
      "account_id" : 21724606,
      "reputation" : 1431,
      "user_id" : 16034206,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/MRBdT.jpg?s=256",
      "display_name" : "pebble unit",
      "link" : "https://stackoverflow.com/users/16034206/pebble-unit"
    },
    "creation_date" : 1744612730,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79572631" : [ {
      "comment_id" : 140334808,
      "post_id" : 79572631,
      "body" : "I added this to the application.yml and it solved the issue!  server:   tomcat:     relaxed-query-chars: &#39;|&#39;",
      "score" : 0,
      "owner" : {
        "account_id" : 19033204,
        "reputation" : 867,
        "user_id" : 13894850,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/56b085ca89bdbc97e22bbb768cc752bf?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "Tim",
        "link" : "https://stackoverflow.com/users/13894850/tim"
      },
      "creation_date" : 1744670407,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}