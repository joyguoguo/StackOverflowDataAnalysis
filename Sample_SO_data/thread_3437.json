{
  "question" : {
    "question_id" : 79549341,
    "title" : "Failed to parse multipart servlet request - the request was rejected because no multipart boundary was found",
    "body" : "<p>Does anyone have any idea why I am getting this boundary error when submitting this multipart file?</p>\n<p>Error:</p>\n<pre><code>    {errCode: 4000, errMsg: &quot;Failed to parse multipart servlet request&quot;, timestamp: &quot;01-04-2025 07:26:30&quot;}\n\n    Caused by: org.apache.tomcat.util.http.fileupload.FileUploadException: the request was rejected because no multipart boundary was found\n</code></pre>\n<p>Angular 17</p>\n<pre><code>importProducts(productId,file:File, tag): Observable&lt;any[]&gt; {\n\nvar url = &quot;http://localhost:9100/importProduct/“+productId+&quot;?tag=&quot;+tag;\nvar headers: HttpHeaders = new HttpHeaders(); \nheaders = headers.set('content-type', 'multipart/form-data');\nthis.http.combineHeaders(headers);\nreturn this.http.post(url, file, 'ImportProducts');\n\n}\n</code></pre>\n<p>Java17</p>\n<pre><code>@PostMapping(value = &quot;/importProduct/{product_id}&quot;, consumes = MediaType.MULTIPART_FORM_DATA_VALUE)\npublic ResponseEntity&lt;Object&gt; importProductList(@PathVariable(value = &quot;product_id&quot;) String productId,\n        @RequestParam(value = &quot;tag&quot;) boolean tag, @RequestParam(&quot;uploadFile&quot;) MultipartFile uploadFile)\n        throws IOException {\n    \n    \n    if ((uploadFile.getName() == null) || &quot;&quot;.equals(uploadFile.getName())) {\n    //Error file\n    } else if (uploadFile.getSize() == 0) {\n    //Error stream null\n    } else {\n        String newFile = uploadFile.getOriginalFilename();\n        if (tag) {\n            //Import products process\n            return new ResponseEntity&lt;&gt;(true, HttpStatus.OK);\n        } \n    }\n}\n</code></pre>\n<p>Thanks a lot if you can help me and thanks for your time.</p>\n",
    "tags" : [ "java", "angular", "multipartform-data" ],
    "owner" : {
      "account_id" : 22105609,
      "reputation" : 21,
      "user_id" : 29095398,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/eabc4601bb500d5d4c2da59956e6542c?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Tania",
      "link" : "https://stackoverflow.com/users/29095398/tania"
    },
    "is_answered" : true,
    "view_count" : 365,
    "answer_count" : 1,
    "score" : 2,
    "last_activity_date" : 1743548748,
    "creation_date" : 1743547778,
    "link" : "https://stackoverflow.com/questions/79549341/failed-to-parse-multipart-servlet-request-the-request-was-rejected-because-no",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79549353,
    "question_id" : 79549341,
    "body" : "<p>Try to not set the Content-Type Header manually. Angular (or the browser) should automatically generate the boundary.</p>\n<p>Try to fix your Angular code like this:</p>\n<pre><code>importProducts(productId: string, file: File, tag: boolean): Observable&lt;any[]&gt; {\n  const url = `http://localhost:9100/importProduct/${productId}?tag=${tag}`;\n  \n  const formData: FormData = new FormData();\n  formData.append('uploadFile', file); // The key uploadFile must match the @RequestParam in your controller\n\n  return this.http.post&lt;any[]&gt;(url, formData); // Don't manually set headers!\n}\n</code></pre>\n<p>When <code>FormData</code> is used Angular automatically generates the boundary.<br />\nIf you manually set <code>Content-Type: multipart/form-data</code> Angular won't add the <code>boundary</code> and the server will reject your request.</p>\n",
    "score" : 1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 18999437,
      "reputation" : 800,
      "user_id" : 13867124,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/3f75c892f3b54042e7400ee33cd8af96?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "AztecCodes",
      "link" : "https://stackoverflow.com/users/13867124/azteccodes"
    },
    "creation_date" : 1743548748,
    "last_activity_date" : 1743548748,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : {
    "79549353" : [ {
      "comment_id" : 140289375,
      "post_id" : 79549353,
      "body" : "@Tania The boundary lines are actually required for <code>multipart&#47;form-data</code> to work correctly. They’re not something you should try to remove. These boundaries are what the server (in this case, your Spring Boot backend) uses to separate parts of the multipart request, like the uploaded file.",
      "score" : 0,
      "owner" : {
        "account_id" : 18999437,
        "reputation" : 800,
        "user_id" : 13867124,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/3f75c892f3b54042e7400ee33cd8af96?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "AztecCodes",
        "link" : "https://stackoverflow.com/users/13867124/azteccodes"
      },
      "creation_date" : 1743582202,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140288715,
      "post_id" : 79549353,
      "body" : "Thank you @AztecCodes, your answer is correct and it works when using Form data, but my code isn&#39;t working properly because it sets the header and footer boundary. Is there a way how to remove  this boundary lines in Angular? Or in Java?",
      "score" : 0,
      "owner" : {
        "account_id" : 22105609,
        "reputation" : 21,
        "user_id" : 29095398,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/eabc4601bb500d5d4c2da59956e6542c?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "Tania",
        "link" : "https://stackoverflow.com/users/29095398/tania"
      },
      "creation_date" : 1743569501,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}