{
  "question" : {
    "question_id" : 79597781,
    "title" : "Table sort performance",
    "body" : "<p>I have a Codename One application that display form(s) with table(s) and sorts using table.sort(). The performance is poor if the table is large. In my case, if the table contains 1000+ rows it may take ten seconds to display / re-sort the table. I've altered my code to sort my data prior to creating the table and to not sort using table.sort(), but the problem remains when the user re-sorts the table, by selecting a column header - this occurs via table.sort().</p>\n<p>I asked an AI agent for a summary of the table.sort() code and it replied:</p>\n<blockquote>\n<p>Every sort rebuilds the entire model: You're replacing the model each\ntime with a new SortableTableModel. setModel probably triggers a full\nredraw of the UI and creates a new internal structure (copying all\nrows, sorting them, etc.). âž” Very expensive when your table is large.</p>\n</blockquote>\n<p>Is there an alternative? If not, can table.sort() code be improved?</p>\n<p>My code:</p>\n<pre><code>table.setSortSupported(true);\nif (0 &lt;= sortColumn) {\n    table.sort(sortColumn, sortAscending);\n}\n</code></pre>\n",
    "tags" : [ "java", "codenameone" ],
    "owner" : {
      "account_id" : 16601979,
      "reputation" : 139,
      "user_id" : 12697141,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/c1efc636c02fe558151e26c1d2999184?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "stylsy",
      "link" : "https://stackoverflow.com/users/12697141/stylsy"
    },
    "is_answered" : true,
    "view_count" : 102,
    "closed_date" : 1745924756,
    "answer_count" : 1,
    "score" : 2,
    "last_activity_date" : 1745914590,
    "creation_date" : 1745910087,
    "link" : "https://stackoverflow.com/questions/79597781/table-sort-performance",
    "closed_reason" : "Not suitable for this site"
  },
  "answers" : [ {
    "answer_id" : 79597896,
    "question_id" : 79597781,
    "body" : "<p>In terms of <strong>performance</strong> for codename tables, manual sorting while avoiding <code>table.sort()</code> is the best option.</p>\n<blockquote>\n<p><em><code>table.sort()</code> is slow because it wraps the model in a <code>SortableTableModel</code>, deep-copies data, rebuilds the entire UI with new components, triggers full layout/revalidation, and fails to reuse cells efficiently.</em></p>\n</blockquote>\n<p>With manual sorting,  you sort only the raw data (not the UI), avoid deep copies, rebuild the table just once, and replace it bypassing the expensive model wrapping and UI reconstruction that <code>table.sort()</code> does.</p>\n<p>Default sorting snippet:</p>\n<pre><code>Collections.sort(data, (row1, row2) -&gt; {\n    Object o1 = row1[column];\n    Object o2 = row2[column];\n\n    if (o1 instanceof Comparable &amp;&amp; o2 instanceof Comparable) {\n        return ascending ?\n                ((Comparable)o1).compareTo(o2) :\n                ((Comparable)o2).compareTo(o1);\n    }\n    return 0;\n});\n</code></pre>\n<p>That is a &quot;default&quot; custom logic that will work with your items( you may override the <code>compareTo</code> method if needed) . Again, in terms of perfomarnce, this is much faster.</p>\n<hr />\n<p>After you manually sorted, create a new table:</p>\n<pre><code>Table newTable = createTable(data, columnNames);\nnewTable.setSortSupported(false); //do not sort\n</code></pre>\n<p>Finally, change the old table for the new one:</p>\n<pre><code>Container parent = table.getParent();\nint index = parent.getComponentIndex(table);\n\nparent.replaceAndWait(table, newTable, CommonTransitions.createFade(300));\ntable = newTable;\n</code></pre>\n<ul>\n<li><p><code>parent.replaceAndWait()</code> will change the table in the UI.</p>\n</li>\n<li><p><code>table = newTable</code> will change the reference of your table in order for you to invoke the new one.</p>\n</li>\n</ul>\n<hr />\n<p>This is the best option I can guess to improve performance. You could benchmark it and check if it's faster than <code>table.sort()</code>, which absolutely will be.</p>\n",
    "score" : 1,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 2465829,
      "reputation" : 13577,
      "user_id" : 2148953,
      "user_type" : "registered",
      "accept_rate" : 96,
      "profile_image" : "https://i.sstatic.net/DVHoP84E.jpg?s=256",
      "display_name" : "aran",
      "link" : "https://stackoverflow.com/users/2148953/aran"
    },
    "creation_date" : 1745914047,
    "last_activity_date" : 1745914590,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140385740,
    "post_id" : 79597781,
    "body" : "Thanks @ShaiAlmog. I&#39;ll sort my data prior to creating the table. The re-sorting by selecting the column header can just remain (but will be slow).",
    "score" : 0,
    "owner" : {
      "account_id" : 16601979,
      "reputation" : 139,
      "user_id" : 12697141,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/c1efc636c02fe558151e26c1d2999184?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "stylsy",
      "link" : "https://stackoverflow.com/users/12697141/stylsy"
    },
    "creation_date" : 1746050749,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140382249,
    "post_id" : 79597781,
    "body" : "Unlike <code>JTable</code> our<code>Table</code> wasn&#39;t designed for large amounts of information. My focus was on an intuitive/simple API rather than support of large data volumes.",
    "score" : 0,
    "owner" : {
      "account_id" : 394396,
      "reputation" : 53012,
      "user_id" : 756809,
      "user_type" : "registered",
      "accept_rate" : 89,
      "profile_image" : "https://i.sstatic.net/jFZnE.jpg?s=256",
      "display_name" : "Shai Almog",
      "link" : "https://stackoverflow.com/users/756809/shai-almog"
    },
    "creation_date" : 1745975185,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140379110,
    "post_id" : 79597781,
    "body" : "@Hahzeeboo Questions must be self-contained, which means the <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> <b>must</b> be included in the question, not only linked off-site.",
    "score" : 0,
    "owner" : {
      "account_id" : 213468,
      "reputation" : 110282,
      "user_id" : 466862,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=256&d=identicon&r=PG",
      "display_name" : "Mark Rotteveel",
      "link" : "https://stackoverflow.com/users/466862/mark-rotteveel"
    },
    "creation_date" : 1745912752,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140379044,
    "post_id" : 79597781,
    "body" : "This needs a lot more information. What type is table? What does sort() do? At least provide a link to the <a href=\"https://github.com/codenameone/CodenameOne\" rel=\"nofollow noreferrer\">codenameone github repo</a>",
    "score" : 0,
    "owner" : {
      "account_id" : 28568877,
      "reputation" : 68,
      "user_id" : 21871376,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/176a8b578938d6f0d75d59c5e4951d66?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Hahzeeboo",
      "link" : "https://stackoverflow.com/users/21871376/hahzeeboo"
    },
    "creation_date" : 1745911701,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79597896" : [ {
      "comment_id" : 140382886,
      "post_id" : 79597896,
      "body" : "@stylsy voted to reopen as I believe is an enough clear question.",
      "score" : 0,
      "owner" : {
        "account_id" : 2465829,
        "reputation" : 13577,
        "user_id" : 2148953,
        "user_type" : "registered",
        "accept_rate" : 96,
        "profile_image" : "https://i.sstatic.net/DVHoP84E.jpg?s=256",
        "display_name" : "aran",
        "link" : "https://stackoverflow.com/users/2148953/aran"
      },
      "creation_date" : 1745996372,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140382181,
      "post_id" : 79597896,
      "body" : "thank you for your detailed reply. I like to accept your answer as the accepted answer, but I&#39;m unable to do so, as the question has been marked as closed.",
      "score" : 1,
      "owner" : {
        "account_id" : 16601979,
        "reputation" : 139,
        "user_id" : 12697141,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/c1efc636c02fe558151e26c1d2999184?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "stylsy",
        "link" : "https://stackoverflow.com/users/12697141/stylsy"
      },
      "creation_date" : 1745972771,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}