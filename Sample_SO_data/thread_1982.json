{
  "question" : {
    "question_id" : 79658660,
    "title" : "Unable to convert ODT to PDF with xdocreport",
    "body" : "<p>I'm trying to use the xdocreport package to convert an ODT file into a PDF. I've tried 2 different variations. Here is the code and error for both variations:</p>\n<pre class=\"lang-java prettyprint-override\"><code>Options options = Options.getFrom(DocumentKind.ODT).to(ConverterTypeTo.PDF);\n\nInputStream raw = this.getResources().openRawResource(R.raw.timesheet_template);\nIXDocReport xdocGenerator = XDocReportRegistry.getRegistry().loadReport(raw, TemplateEngineKind.Freemarker);\n\nIContext context = xdocGenerator.createContext();\nIConverter converter = ConverterRegistry.getRegistry().getConverter(options);\n\nOutputStream out = new FileOutputStream(HOME_PATH+&quot;/test.pdf&quot;);\n\nxdocGenerator.convert(context, options, out);\n\nraw.close();\nout.close();\n</code></pre>\n<p>ERROR:</p>\n<pre><code>fr.opensagres.xdocreport.core.XDocReportException: Null template engine. Set template engine with IXDocReport#setTemplateEngine.\n</code></pre>\n<p>Other method:</p>\n<pre class=\"lang-java prettyprint-override\"><code>Options options = Options.getFrom(DocumentKind.ODT).to(ConverterTypeTo.PDF);\n\nIConverter converter = ConverterRegistry.getRegistry().getConverter(options);\n\nInputStream raw = this.getResources().openRawResource(R.raw.timesheet_template);\nOutputStream out = new FileOutputStream(HOME_PATH+&quot;/test.pdf&quot;);\n\nconverter.convert(raw, out, options);\n\nraw.close();\nout.close();\n</code></pre>\n<p>ERROR:</p>\n<pre><code>java.lang.NullPointerException: Attempt to invoke interface method 'void fr.opensagres.xdocreport.converter.IConverter.convert(java.io.InputStream, java.io.OutputStream, fr.opensagres.xdocreport.converter.Options)' on a null object reference\n</code></pre>\n<p>From reading online and the errors themselves I believe there is an underlying dependency that is not available by default in android. I don't know what it is or how to include it though.</p>\n<p>An important thing to note is I was able to accomplish this without issue using Aspose library. They have a water mark though which is why I want to use xdocreport.</p>\n<p>I'm importing the following in gradle:</p>\n<pre><code>implementation 'fr.opensagres.xdocreport:fr.opensagres.xdocreport.document.odt:2.1.0'\n</code></pre>\n<p>Any help would be appreciated.</p>\n<hr />\n<p>ANSWER:\nBased on the accepted answer, here's how I made it work.\nFirst the gradle dependencies are as fallows:</p>\n<pre><code>implementation 'fr.opensagres.xdocreport:fr.opensagres.xdocreport.document.odt:2.1.0'\nimplementation 'fr.opensagres.xdocreport:fr.opensagres.xdocreport.template.freemarker:2.1.0'\nimplementation 'fr.opensagres.xdocreport:fr.opensagres.xdocreport.converter.odt.odfdom:2.1.0'\nimplementation 'ro.andob.androidawt:androidawt:1.0.4'\n</code></pre>\n<p>You will also need the following in <code>android</code> section:</p>\n<pre><code>configurations {\n    all { // You should exclude one of them not both of them\n        exclude group: &quot;com.sun.activation&quot;, module: &quot;jakarta.activation&quot;\n    }\n}\n</code></pre>\n<p>In <code>settings.gradle</code> under <code>repositories</code> for both <code>pluginManagement</code> and <code>dependencyResolutionManagement</code> add the following:</p>\n<pre><code>maven { url &quot;https://andob.io/repository/open_source&quot; }\n</code></pre>\n<p>I'm not sure if this is required, but I added the following in <code>proguard-rules.pro</code>:</p>\n<pre><code>-dontwarn org.bouncycastle.**\n-dontwarn java.lang.invoke.**\n</code></pre>\n<p>The code is the same as in the question. This setup will resolve the duplicate class issue, add the converter for XDocReport to use and add the java.awt dependencies.</p>\n",
    "tags" : [ "java", "android", "odt", "xdocreport" ],
    "owner" : {
      "account_id" : 21607936,
      "reputation" : 269,
      "user_id" : 15935039,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/C9wwH.png?s=256",
      "display_name" : "Asis",
      "link" : "https://stackoverflow.com/users/15935039/asis"
    },
    "is_answered" : true,
    "view_count" : 208,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1750324789,
    "creation_date" : 1749462363,
    "link" : "https://stackoverflow.com/questions/79658660/unable-to-convert-odt-to-pdf-with-xdocreport",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79669740,
    "question_id" : 79658660,
    "body" : "<p>Your errors happen because required dependencies are missing. To fix it add these to your <code>build.gradle</code></p>\n<pre><code>implementation 'fr.opensagres.xdocreport:fr.opensagres.xdocreport.template.freemarker:2.1.0'\nimplementation 'fr.opensagres.xdocreport:fr.opensagres.xdocreport.converter.odt.odfdom:2.1.0'\n</code></pre>\n<p>These provide the Freemarker engine and ODT→PDF converter.  Once added, your code should work unless it hits AWT-related classes not supported on Android, in which case <code>XDocReport</code> may not be usable on-device.</p>\n",
    "score" : 1,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 42539961,
      "reputation" : 161,
      "user_id" : 30802656,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/ce9e65db2371d4d3a844b1102cc9c914?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Gevorg Ayvazyan",
      "link" : "https://stackoverflow.com/users/30802656/gevorg-ayvazyan"
    },
    "creation_date" : 1750193874,
    "last_activity_date" : 1750193874,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140511609,
    "post_id" : 79658660,
    "body" : "XDocReport is not ideal for Android. Use a desktop-side solution if possible. If you must run it on Android then Try using docx instead of odt, as it&#39;s better supported. Look into JODConverter or LibreOffice headless on a server. If you’re fine paying, Aspose (which worked for you) is your best bet, unless the watermark is a blocker. Alternatively, generate PDF directly with iText or PDFBox without converting from ODT.",
    "score" : 0,
    "owner" : {
      "account_id" : 6962218,
      "reputation" : 442,
      "user_id" : 5341306,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/8rhmy.jpg?s=256",
      "display_name" : "Imran.Khan",
      "link" : "https://stackoverflow.com/users/5341306/imran-khan"
    },
    "creation_date" : 1749824739,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140507093,
    "post_id" : 79658660,
    "body" : "Based on <a href=\"https://github.com/opensagres/xdocreport/issues/435\" rel=\"nofollow noreferrer\">this</a> and <a href=\"https://github.com/opensagres/xdocreport/issues/385\" rel=\"nofollow noreferrer\">this</a>, it would appear that this library does not support Android. I see signs of it using <code>javax</code> classes, such as ones in <code>javax.imageio</code>, that do not exist in Android. If you are certain that this library supports Android, you would be well-served to post full stack traces for your exceptions, not just the error message.",
    "score" : 0,
    "owner" : {
      "account_id" : 39846,
      "reputation" : 1011205,
      "user_id" : 115145,
      "user_type" : "registered",
      "accept_rate" : 84,
      "profile_image" : "https://i.sstatic.net/wDnd8.png?s=256",
      "display_name" : "CommonsWare",
      "link" : "https://stackoverflow.com/users/115145/commonsware"
    },
    "creation_date" : 1749682400,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79669740" : [ {
      "comment_id" : 140526120,
      "post_id" : 79669740,
      "body" : "@Asis I Managed to solve this, however it does hit a AWT class. From my research it seems like that&#39;s not worth pursuing.",
      "score" : 0,
      "owner" : {
        "account_id" : 21607936,
        "reputation" : 269,
        "user_id" : 15935039,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/C9wwH.png?s=256",
        "display_name" : "Asis",
        "link" : "https://stackoverflow.com/users/15935039/asis"
      },
      "creation_date" : 1750324031,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140526086,
      "post_id" : 79669740,
      "body" : "Unfortunately when I build the project with those dependencies I get a duplicate class issue. Related to <code>com.sun.activation:jakarta.activation:2.0.1</code>",
      "score" : 0,
      "owner" : {
        "account_id" : 21607936,
        "reputation" : 269,
        "user_id" : 15935039,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/C9wwH.png?s=256",
        "display_name" : "Asis",
        "link" : "https://stackoverflow.com/users/15935039/asis"
      },
      "creation_date" : 1750323257,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}