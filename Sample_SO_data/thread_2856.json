{
  "question" : {
    "question_id" : 79589824,
    "title" : "Cannot view file with another activity via intent",
    "body" : "<p>Without using a filechooser, I am trying to open a file in the Documents external public directory for an app such as Acrobat to view. I have a FileProvider set up for both internal and external sources, and this has worked in other code of mine.</p>\n<p>What I am really trying to accomplish is package a set of info files with my app and when the user clicks on certain buttons, just delegate to Android to view those files for the user.  Most likely I would store them in Assets and then copy them out to internal/external storage and bring them up via Intent.ACTION_VIEW.</p>\n<p>The message I am getting now in the Emulator is &quot;Cannot display PDF (no file received)&quot; from Google Drive app.  Similar type of message when run on actual phone with Acrobat installed.</p>\n<p>This is the current code I have:</p>\n<pre><code>    File f = new File(getExternalFilesDir(&quot;documents&quot;), &quot;jhug.pdf&quot;);\n    Uri fileUri = FileProvider.getUriForFile(Recorder.this, &quot;com.noware.oakesn.jibonbondhu.provider&quot;, f);\n\n    Intent intent = new Intent(Intent.ACTION_VIEW);\n    intent.setData(fileUri);\n    intent.setType(&quot;application/pdf&quot;);\n    intent.setFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION);\n\n    try\n    {\n        getContentResolver().openInputStream(fileUri);\n    }\n    catch (FileNotFoundException e)\n    {\n        throw new RuntimeException(e);\n    }\n\n    // Grant permission to all possible handling apps for this type\n    // Overkill\n    List&lt;ResolveInfo&gt; resInfoList = getPackageManager().queryIntentActivities(intent, PackageManager.MATCH_DEFAULT_ONLY);\n    for (ResolveInfo resolveInfo : resInfoList) {\n        String packageName = resolveInfo.activityInfo.packageName;\n        grantUriPermission(packageName, fileUri, Intent.FLAG_GRANT_READ_URI_PERMISSION);\n    }\n\n    startActivity(intent);\n\n</code></pre>\n<p>From AndroidManifest.xml:</p>\n<pre><code>    &lt;provider\n        android:name=&quot;androidx.core.content.FileProvider&quot;\n        android:authorities=&quot;com.noware.oakesn.jibonbondhu.provider&quot;\n        android:exported=&quot;false&quot;\n        android:grantUriPermissions=&quot;true&quot;\n        android:readPermission=&quot;android.permission.permRead&quot;&gt;\n\n        &lt;!-- ressource file to create --&gt;\n        &lt;meta-data\n            android:name=&quot;android.support.FILE_PROVIDER_PATHS&quot;\n            android:resource=&quot;@xml/file_paths&quot; /&gt;\n    &lt;/provider&gt;\n\n</code></pre>\n<p>From file_paths.xml:</p>\n<pre><code>    &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\n    &lt;paths&gt;\n       &lt;files-path    name=&quot;internal_files&quot; path=&quot;.&quot; /&gt;\n       &lt;external-path name=&quot;external_files&quot; path=&quot;.&quot; /&gt;\n    &lt;/paths&gt;\n\n</code></pre>\n<p>f   has a value of /storage/emulated/0/Android/data/com.noware.oakesn.jibonbondhu/files/documents/jhug.pdf\nuri has a value of content://com.noware.oakesn.jibonbondhu.provider/external_files/Android/data/com.noware.oakesn.jibonbondhu/files/documents/jhug.pdf</p>\n<p>File does exist there and openInputStream() is successful.</p>\n<p>I notice that if I use getExternalStoragePublicDirectory(Environment.DIRECTORY_DOCUMENTS) it does not get permission even though a copy of the file is there too.  I put the files there with Device Explorer.</p>\n<p>Nothing in logcat.  Targeting Android 14.</p>\n<p>Perhaps Android's security system has changed yet again on me.  Seems like you need a note from God these days to read files on the phone !</p>\n",
    "tags" : [ "java", "android", "android-intent" ],
    "owner" : {
      "account_id" : 29241745,
      "reputation" : 1,
      "user_id" : 22403096,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a/AAcHTtf_VgskyilkhHoKXK88goV_7-nBMHimF3TqbG7O1eje=k-s256",
      "display_name" : "Norman Oakes",
      "link" : "https://stackoverflow.com/users/22403096/norman-oakes"
    },
    "is_answered" : false,
    "view_count" : 23,
    "closed_date" : 1745492993,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1745477178,
    "creation_date" : 1745469285,
    "link" : "https://stackoverflow.com/questions/79589824/cannot-view-file-with-another-activity-via-intent",
    "closed_reason" : "Duplicate"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140365007,
    "post_id" : 79589824,
    "body" : "Use <code>setDataAndType()</code>, not sequential calls to <code>setData()</code> and <code>setType()</code>.",
    "score" : 0,
    "owner" : {
      "account_id" : 39846,
      "reputation" : 1011205,
      "user_id" : 115145,
      "user_type" : "registered",
      "accept_rate" : 84,
      "profile_image" : "https://i.sstatic.net/wDnd8.png?s=256",
      "display_name" : "CommonsWare",
      "link" : "https://stackoverflow.com/users/115145/commonsware"
    },
    "creation_date" : 1745493043,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}