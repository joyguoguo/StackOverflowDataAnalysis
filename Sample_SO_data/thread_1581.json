{
  "question" : {
    "question_id" : 79693814,
    "title" : "Problem with formatting a cell to text in Excel",
    "body" : "<pre class=\"lang-java prettyprint-override\"><code>CellStyle textStyle = workbook.createCellStyle();\ntextStyle.setDataFormat(format.getFormat(&quot;@&quot;));\n\nSet&lt;Integer&gt; forceTextIndexes = new HashSet&lt;&gt;();\nif (&quot;LE_27&quot;.equalsIgnoreCase(excelName)) {\n    forceTextIndexes.add(3);\n    forceTextIndexes.add(6);\n} else if (&quot;LE_28&quot;.equalsIgnoreCase(excelName)\n    || &quot;LE_29&quot;.equalsIgnoreCase(excelName)) {\n    forceTextIndexes.add(3);\n    forceTextIndexes.add(4);\n}\n\nfor (int i = COPY_VALUES_START_INDEX; i &lt; columnValues.length; i++) {\n    int cellIndex = WRITE_START_COLUMN + (i - COPY_VALUES_START_INDEX);\n    Cell cell = row.createCell(cellIndex);\n    Object value = columnValues[i];\n\n    boolean forceAsText = forceTextIndexes.contains(i);\n\n    if (value == null) {\n        cell.setCellType(CellType.BLANK);\n    } else if (forceAsText) {\n        cell.setCellStyle(textStyle);\n        cell.setCellValue(&quot;'&quot; + value);\n    }\n}\n</code></pre>\n<p>I use Apache POI, and I am trying to change the formatting of some cells to text in Excel. Every time I fetch an <code>nvarchar</code> from my SQL database that looks like a number, it keeps on writing it in Excel as a number and not as text. Help!</p>\n",
    "tags" : [ "java", "excel", "format", "apache-poi", "cell" ],
    "owner" : {
      "account_id" : 38498039,
      "reputation" : 1,
      "user_id" : 28803304,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/be2cbf27abcd447c8dccaf684a3474b0?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "user28803304",
      "link" : "https://stackoverflow.com/users/28803304/user28803304"
    },
    "is_answered" : false,
    "view_count" : 74,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1751994114,
    "creation_date" : 1751959035,
    "link" : "https://stackoverflow.com/questions/79693814/problem-with-formatting-a-cell-to-text-in-excel",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79694231,
    "question_id" : 79693814,
    "body" : "<p><code>cell.setCellValue(&quot;'&quot; + value);</code></p>\n<p>This is just putting a literal apostrophe in the cell - it's a workaround when typing manually but in this case, it writes it as actual data</p>\n<p>Try changing it to:</p>\n<p><code>cell.setCellValue(String.valueOf(value));</code></p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 37822762,
      "reputation" : 17,
      "user_id" : 28446867,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/LcaEwodr.jpg?s=256",
      "display_name" : "OUTATIME121GW",
      "link" : "https://stackoverflow.com/users/28446867/outatime121gw"
    },
    "creation_date" : 1751977582,
    "last_activity_date" : 1751977582,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : {
    "79694231" : [ {
      "comment_id" : 140737831,
      "post_id" : 79694231,
      "body" : "That shouldn&#39;t help because <code>&quot;&#39;&quot; + value</code> is also a string type",
      "score" : 0,
      "owner" : {
        "account_id" : 17972905,
        "reputation" : 10131,
        "user_id" : 13061224,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/GyOMS.jpg?s=256",
        "display_name" : "siggemannen",
        "link" : "https://stackoverflow.com/users/13061224/siggemannen"
      },
      "creation_date" : 1757962446,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}