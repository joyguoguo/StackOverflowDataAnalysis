{
  "question" : {
    "question_id" : 79706589,
    "title" : "gradle wrapper command is failing with errors about major versions 61 and 65 - I am using Java 17 and need 21",
    "body" : "<p>I have been using the same machine for months.  I'm not sure what happened overnight, but gradle doesn't work any more.</p>\n<p>I am using java 17 which is major version 61.  I am using gradle 7.6 - for many months.</p>\n<p>I get errors</p>\n<pre><code>Caused by: java.io.IOException: Failed to process the entry 'META-INF/versions/21/com/fasterxml/jackson/core/io/doubleparser/FastDoubleSwar.class' from '/root/.gradle/caches/modules-2/files-2.1/com.fasterxml.jackson.core/jackson-core/2.15.4/aebe84b45360debad94f692a4074c6aceb535fa0/jackson-core-2.15.4.jar'\n\nCaused by: java.lang.IllegalArgumentException: Unsupported class file major version 65\n</code></pre>\n<p>I don't know how gradle is coming up with the idea it needs Java 21 major version 65 of jackson-core-2.15.4.jar</p>\n<p>I have exhaustively searched for the fix, but so far nothing has worked.\ncompletely remove all .gradle dirs and do gradle wrapper - still get the error</p>\n<pre><code>--------------------------------\nPartial Stacktrace below (too big for stackoverflow to show all)\n(root - etm_ms-java17&gt; gradle wrapper --stacktrace\n\n\n\nFAILURE: Build failed with an exception.\n\n\n\n* What went wrong:\n\nA problem occurred configuring root project 'etm_ms-java17'.\n\n&gt; java.util.concurrent.ExecutionException: org.gradle.api.GradleException: Failed to create Jar file /root/.gradle/caches/jars-9/9dd8095f1ddef54c5be9a4c56027fb13/jackson-core-2.15.4.jar.\n\n\n\n* Try:\n\n&gt; Run with --info or --debug option to get more log output.\n\n&gt; Run with --scan to get full insights.\n\n\n\n* Exception is:\n\n    org.gradle.api.ProjectConfigurationException: A problem occurred configuring root project 'etm_ms-java17'.\n    \n            at org.gradle.configuration.project.LifecycleProjectEvaluator.wrapException(LifecycleProjectEvaluator.java:84)\n    \n            at org.gradle.configuration.project.LifecycleProjectEvaluator.addConfigurationFailure(LifecycleProjectEvaluator.java:77)\n    \n            at org.gradle.internal.classpath.ClasspathWalker.visitJarContents(ClasspathWalker.java:91)\n    \n            at org.gradle.internal.classpath.ClasspathWalker.visit(ClasspathWalker.java:55)\n    \n            at org.gradle.internal.classpath.InstrumentingClasspathFileTransformer.visitEntries(InstrumentingClasspathFileTransformer.java:148)\n    \n            at org.gradle.internal.classpath.InstrumentingClasspathFileTransformer.lambda$instrument$0(InstrumentingClasspathFileTransformer.java:139)\n    \n            at org.gradle.internal.classpath.ClasspathBuilder.buildJar(ClasspathBuilder.java:68)\n    \n            at org.gradle.internal.classpath.ClasspathBuilder.jar(ClasspathBuilder.java:55)\n    \n            ... 9 more\n    \n    Caused by: java.lang.IllegalArgumentException: Unsupported class file major version 65\n    \n            at org.objectweb.asm.ClassReader.&lt;init&gt;(ClassReader.java:199)\n    \n            at org.objectweb.asm.ClassReader.&lt;init&gt;(ClassReader.java:180)\n    \n            at org.objectweb.asm.ClassReader.&lt;init&gt;(ClassReader.java:166)\n    \n            at org.gradle.internal.classpath.InstrumentingClasspathFileTransformer.lambda$visitEntries$1(InstrumentingClasspathFileTransformer.java:151)\n    \n            ... 15 more\n</code></pre>\n",
    "tags" : [ "java", "gradle" ],
    "owner" : {
      "account_id" : 9124114,
      "reputation" : 349,
      "user_id" : 6788557,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/kUOJT.png?s=256",
      "display_name" : "SRJ",
      "link" : "https://stackoverflow.com/users/6788557/srj"
    },
    "is_answered" : true,
    "view_count" : 299,
    "answer_count" : 1,
    "score" : 3,
    "last_activity_date" : 1753034182,
    "creation_date" : 1752862766,
    "link" : "https://stackoverflow.com/questions/79706589/gradle-wrapper-command-is-failing-with-errors-about-major-versions-61-and-65-i",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79708250,
    "question_id" : 79706589,
    "body" : "<h2>Bug</h2>\n<p>As <a href=\"https://stackoverflow.com/questions/79706589/gradle-wrapper-command-is-failing-with-errors-about-major-versions-61-and-65-i#comment140602480_79706589\">Commented</a>, youâ€™ve been bit by a bug: <a href=\"https://github.com/gradle/gradle/issues/24390\" rel=\"nofollow noreferrer\"><em>Gradle 7.4 fails on multi release jar's with JDK 19 code</em></a>.</p>\n<p>Version 2.15.0-rc1 of <em>jackson-core</em> introduced a multi-release JAR. Gradle did not like <a href=\"https://openjdk.org/jeps/238\" rel=\"nofollow noreferrer\">multi-release JARs</a>.</p>\n<h2>Fixed</h2>\n<p>Fixed in Gradle version 7.6.1.</p>\n<h2>Tip</h2>\n<p>Keep up with those <a href=\"https://semver.org/\" rel=\"nofollow noreferrer\">PATCH version number</a> releases.</p>\n",
    "score" : 1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 322981,
      "reputation" : 346951,
      "user_id" : 642706,
      "user_type" : "registered",
      "accept_rate" : 58,
      "profile_image" : "https://i.sstatic.net/ZWEI3.jpg?s=256",
      "display_name" : "Basil Bourque",
      "link" : "https://stackoverflow.com/users/642706/basil-bourque"
    },
    "creation_date" : 1753033593,
    "last_activity_date" : 1753034182,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140602480,
    "post_id" : 79706589,
    "body" : "This is a Gradle bug, you need to use a more recent version of Gradle: <a href=\"https://github.com/gradle/gradle/issues/24390\" rel=\"nofollow noreferrer\">github.com/gradle/gradle/issues/24390</a> The bug may be fixed in Gradle 7.6.1, check it out.",
    "score" : 3,
    "owner" : {
      "account_id" : 50585,
      "reputation" : 43459,
      "user_id" : 150978,
      "user_type" : "registered",
      "accept_rate" : 78,
      "profile_image" : "https://www.gravatar.com/avatar/feadc214792e2581c3c750140e3eb2c7?s=256&d=identicon&r=PG",
      "display_name" : "Robert",
      "link" : "https://stackoverflow.com/users/150978/robert"
    },
    "creation_date" : 1752941954,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140601009,
    "post_id" : 79706589,
    "body" : "The problem is that your Gradle version does something stupid by reading and processing files in <code>META-INF&#47;versions&#47;21&#47;</code> which are built using Java 21, while your Gradle version does not understand Java 21, and so should not read files in that location of a multi-release JAR. It should restrict itself to classes in the root of the JAR and the multi-release locations (<code>META-INF&#47;versions&#47;...</code>) of versions it does understand. Possibly upgrading to a newer Gradle version will resolve this.",
    "score" : 4,
    "owner" : {
      "account_id" : 213468,
      "reputation" : 110282,
      "user_id" : 466862,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=256&d=identicon&r=PG",
      "display_name" : "Mark Rotteveel",
      "link" : "https://stackoverflow.com/users/466862/mark-rotteveel"
    },
    "creation_date" : 1752867408,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140600982,
    "post_id" : 79706589,
    "body" : "Please use <a href=\"https://stackoverflow.com/editing-help#code\">code format</a> for the output of the command.",
    "score" : 0,
    "owner" : {
      "account_id" : 372682,
      "reputation" : 26512,
      "user_id" : 721855,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/vZiox.png?s=256",
      "display_name" : "aled",
      "link" : "https://stackoverflow.com/users/721855/aled"
    },
    "creation_date" : 1752866567,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140600857,
    "post_id" : 79706589,
    "body" : "Something on the classpath was compiled with Java 21, therefore the gradle daemon needs to spin with a Java 21+ VM.",
    "score" : 0,
    "owner" : {
      "account_id" : 14914414,
      "reputation" : 1185,
      "user_id" : 10808904,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/Ts8fIsJj.png?s=256",
      "display_name" : "Xavier Pedraza",
      "link" : "https://stackoverflow.com/users/10808904/xavier-pedraza"
    },
    "creation_date" : 1752863106,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140600856,
    "post_id" : 79706589,
    "body" : "Can you show your <code>build.gradle</code> (or <code>build.gradle.kts</code>). Also, to confirm, what does <code>java -version</code> show?",
    "score" : 0,
    "owner" : {
      "account_id" : 11104856,
      "reputation" : 1774,
      "user_id" : 8152324,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/b7d2805fe6651d48b5d3d9b9d551bd69?s=256&d=identicon&r=PG",
      "display_name" : "ndc85430",
      "link" : "https://stackoverflow.com/users/8152324/ndc85430"
    },
    "creation_date" : 1752863101,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79708250" : [ {
      "comment_id" : 140630343,
      "post_id" : 79708250,
      "body" : "I added the following to the build.gradle file and it solved my problem          // Block this out since it was built with Java 21      // If needed add implementation &#39;com.fasterxml.jackson.core:jackson-core:2.14.3&#39;        configurations.all {          exclude group: &#39;com.fasterxml.jackson.core&#39;, module: &#39;jackson-core&#39;      }",
      "score" : 0,
      "owner" : {
        "account_id" : 9124114,
        "reputation" : 349,
        "user_id" : 6788557,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/kUOJT.png?s=256",
        "display_name" : "SRJ",
        "link" : "https://stackoverflow.com/users/6788557/srj"
      },
      "creation_date" : 1753888708,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}