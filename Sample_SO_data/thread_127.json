{
  "question" : {
    "question_id" : 79833634,
    "title" : "Twilio Signature validation for ConversationRelay WebSocket with Java SDK",
    "body" : "<p>In <a href=\"https://github.com/enola-dev/enola/pull/1927\" rel=\"nofollow noreferrer\">https://github.com/enola-dev/enola/pull/1927</a> I attempted to add signature validation   for WebSocket authentication security to my <a href=\"https://github.com/enola-dev/twilio-conversation-relay-java\" rel=\"nofollow noreferrer\">https://github.com/enola-dev/twilio-conversation-relay-java</a> Java Client Library SDK for Twilio's ConversationRelay, with a WebSocket server.</p>\n<p>This isn't quite working yet, and the initial reason is likely that I didn't pass a valid full URL, as the AI code review feedback on the aforementioned PR claims. In <a href=\"https://github.com/enola-dev/enola/pull/1928/files\" rel=\"nofollow noreferrer\">https://github.com/enola-dev/enola/pull/1928/files</a> I've attempted to fix this, but it still does not work, and running <code>bazelisk run //java/dev/enola/audio/voice/twilio/relay/websocket:echo</code> in my project fails with: <em>&quot;Invalid Twilio signature: U3NY5SLOn+V8iDNzzVeLD8J4t+k= for wss://4ea9be067e20.ngrok-free.app/&quot;</em> My code ultimately basically just does:</p>\n<pre class=\"lang-java prettyprint-override\"><code>new RequestValidator(&quot;c...c&quot;)\n  .validate(&quot;https://4ea9be067e20.ngrok-free.app/&quot;,\n            Map.of(),\n            &quot;U3NY5SLOn+V8iDNzzVeLD8J4t+k=&quot;);\n</code></pre>\n<p>What am I missing and doing wrong? It's not very clear to me if, in the case of validating the signature in the <code>onOpen()</code> method of a <code>WebSocketServer</code>, where (IMHO, AFAIK) there are no &quot;parameters&quot; or &quot;body&quot;, one shold use the <code>RequestValidator</code>'s <code>boolean validate(String url, Map&lt;String, String&gt; params, String expectedSignature)</code> or <code>boolean validate(String url, String body, String expectedSignature)</code> method - but I've tried both, with either an empty <code>Map.of()</code> or an empty <code>&quot;&quot;</code> String, and neither worked.</p>\n<p>PS: Also <a href=\"https://help.twilio.com/tickets/24297613\" rel=\"nofollow noreferrer\">https://help.twilio.com/tickets/24297613</a>.</p>\n",
    "tags" : [ "java", "websocket", "twilio", "twilio-twiml" ],
    "owner" : {
      "account_id" : 185100,
      "reputation" : 4078,
      "user_id" : 421602,
      "user_type" : "registered",
      "accept_rate" : 40,
      "profile_image" : "https://www.gravatar.com/avatar/3eced70cd3418b88f0fe9c101048e4ea?s=256&d=identicon&r=PG",
      "display_name" : "vorburger",
      "link" : "https://stackoverflow.com/users/421602/vorburger"
    },
    "is_answered" : false,
    "view_count" : 45,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1764501760,
    "creation_date" : 1764468418,
    "link" : "https://stackoverflow.com/questions/79833634/twilio-signature-validation-for-conversationrelay-websocket-with-java-sdk",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ ],
  "answer_comments" : { }
}