{
  "question" : {
    "question_id" : 79552904,
    "title" : "Lettuce: AWS Elasticache: JSON MGET behaviour",
    "body" : "<p>We are using <a href=\"https://github.com/redis/lettuce\" rel=\"nofollow noreferrer\">Lettuce</a> java client to connect to AWS Elasticache (Valkey engine, Serverless, version 8.0) from Java springboot application (JDK 17 &amp; springboot version 3.2.5)</p>\n<p>Below is the method where I am trying to read multiple keys from elasticache using jsonMGet().</p>\n<pre><code>public List&lt;JsonValue&gt; readMultipleKeys(List&lt;String&gt; keys) {\n\n        RedisAsyncCommands&lt;String, String&gt; async = null;\n        try {\n            async = redisCacheClient.connect().async();\n            return async.jsonMGet(JsonPath.ROOT_PATH, keys.toArray(new String[0])).get();\n        } catch (Exception e) {\n            log.error(&quot;Exception while reading multiple keys from Cache: &quot; + e.getMessage());\n            return null;\n        }\n    }\n</code></pre>\n<p>Everything works perfectly fine as long as all the keys from the input list are present in Cache. But if any key (lets say 1 out of 100 input keys) doesn't exist in cache, it is throwing below error and not returning any other values.</p>\n<pre><code>Exception while reading from Cache: java.lang.NullPointerException: Cannot invoke &quot;java.nio.ByteBuffer.remaining()&quot; because &quot;bytes&quot; is null\n</code></pre>\n<p>I want the method to return all the keys that are PRESENT in cache and ignore the keys that doesn't exist.</p>\n",
    "tags" : [ "java", "json", "spring-boot", "amazon-elasticache", "lettuce" ],
    "owner" : {
      "account_id" : 505659,
      "reputation" : 179,
      "user_id" : 1648558,
      "user_type" : "registered",
      "accept_rate" : 0,
      "profile_image" : "https://www.gravatar.com/avatar/581b2ccccbdcec340c4d80039ac64383?s=256&d=identicon&r=PG",
      "display_name" : "alex",
      "link" : "https://stackoverflow.com/users/1648558/alex"
    },
    "is_answered" : true,
    "view_count" : 164,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1743749986,
    "creation_date" : 1743682820,
    "link" : "https://stackoverflow.com/questions/79552904/lettuce-aws-elasticache-json-mget-behaviour",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79553188,
    "question_id" : 79552904,
    "body" : "<p><strong>EDIT:</strong> <em>This seems to be addressed in Lettuce 6.5.5 and later</em></p>\n<p>A NullPointerException is almost certainly a bug.</p>\n<p>I've taken the liberty to create one in the GitHub tracker for you:\n<a href=\"https://github.com/redis/lettuce/issues/3241\" rel=\"nofollow noreferrer\">https://github.com/redis/lettuce/issues/3241</a></p>\n<p>I suggest we continue the conversation there.</p>\n",
    "score" : 1,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 435843,
      "reputation" : 334,
      "user_id" : 822655,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/705cba900acbeffb3799d2c42ae6659c?s=256&d=identicon&r=PG",
      "display_name" : "Tihomir Mateev",
      "link" : "https://stackoverflow.com/users/822655/tihomir-mateev"
    },
    "creation_date" : 1743689528,
    "last_activity_date" : 1743749986,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140298001,
    "post_id" : 79552904,
    "body" : "Which version of the Lettuce driver are you using? A similar issue was addressed with this issue in the 6.5.5 release, see <a href=\"https://github.com/redis/lettuce/issues/3196\" rel=\"nofollow noreferrer\">github.com/redis/lettuce/issues/3196</a>",
    "score" : 0,
    "owner" : {
      "account_id" : 435843,
      "reputation" : 334,
      "user_id" : 822655,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/705cba900acbeffb3799d2c42ae6659c?s=256&d=identicon&r=PG",
      "display_name" : "Tihomir Mateev",
      "link" : "https://stackoverflow.com/users/822655/tihomir-mateev"
    },
    "creation_date" : 1743749851,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79553188" : [ {
      "comment_id" : 140306155,
      "post_id" : 79553188,
      "body" : "Thank you. Have upgraded to 6.5.5 and issue got resolved!",
      "score" : 1,
      "owner" : {
        "account_id" : 505659,
        "reputation" : 179,
        "user_id" : 1648558,
        "user_type" : "registered",
        "accept_rate" : 0,
        "profile_image" : "https://www.gravatar.com/avatar/581b2ccccbdcec340c4d80039ac64383?s=256&d=identicon&r=PG",
        "display_name" : "alex",
        "link" : "https://stackoverflow.com/users/1648558/alex"
      },
      "creation_date" : 1743993944,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}