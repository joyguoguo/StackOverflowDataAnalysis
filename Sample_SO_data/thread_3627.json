{
  "question" : {
    "question_id" : 79535906,
    "title" : "UnmarshalException unexpected element (uri:&quot;&quot;, local:&quot;&quot;). Expected elements are (none) on websphere second call",
    "body" : "<p>I have generated a Soap webservice client using <strong>wsimport</strong>\nand trying to consume the webservice on <strong>Websphere 9.0.5.13</strong></p>\n<ul>\n<li>The application classloader is set to parent last</li>\n<li>I added the following JVM argument in websphere: -<code>Djavax.xml.bind.JAXBContext=com.sun.xml.internal.bind.v2.ContextFactory</code></li>\n</ul>\n<p>When trying to call the webservice, <strong>it succeeds in the first call, and all the following calls fail</strong> with the exception:</p>\n<pre><code>[javax.xml.bind.UnmarshalException: unexpected element (uri:&quot;http://www.mycompany.com&quot;, local:&quot;MyOCRFileRequestRs&quot;). Expected elements are (none)]\n</code></pre>\n<p>My code is as follows:</p>\n<pre><code>private MyOCRFileRequestRsType callMyOCRService(MyOCRFileRequestRqType MyOCRRequest) throws Exception {\n        String headerValue = &quot;Bearer &quot;+MyTokenClient.getToken();\n        MyOCRFileRequest port= esbOcrSerice.getMyOCRFileRequestSOAP11();\n        Map&lt;String, Object&gt; requestContext = ((BindingProvider) port).getRequestContext();\n\n        requestContext.put(BindingProvider.ENDPOINT_ADDRESS_PROPERTY,ConfigManager.getMyOCRRequestUrl().split(&quot;[?]&quot;)[0]);\n        requestContext.put(&quot;javax.xml.ws.http.request.headers&quot;, \n            Collections.singletonMap(&quot;Authorization&quot;, Collections.singletonList(headerValue)));\n        \n        try {\n            return port.MyOCRFileRequest(MyOCRRequest);\n        } catch (Exception e) {\n                throw e;\n        }\n}\n</code></pre>\n<p>The first call works fine with no issues, but all the subsequent calls fails with the following error:</p>\n<pre><code>[javax.xml.bind.UnmarshalException: unexpected element (uri:&quot;http://www.mycompany.com&quot;, local:&quot;MyOCRFileRequestRs&quot;). Expected elements are (none)]\n</code></pre>\n<p>MyOCRFileRequest interface:</p>\n<pre><code>@WebService(name = &quot;MyOCRFileRequest&quot;, targetNamespace = &quot;http://www.mycompany.com&quot;)\n@SOAPBinding(parameterStyle = SOAPBinding.ParameterStyle.BARE)\n@XmlSeeAlso({\n    ObjectFactory.class\n})\npublic interface MyOCRFileRequest {\n\n\n    /**\n     * \n     * @param MyOCRFileRequestRq\n     * @return\n     *     returns com.mycompany.idrak.MyOCRFileRequestRsType\n     */\n    @WebMethod(operationName = &quot;MyOCRFileRequest&quot;, action = &quot;MyOCRFileRequest&quot;)\n    @WebResult(name = &quot;MyOCRFileRequestRs&quot;, targetNamespace = &quot;http://www.mycompany.com&quot;, partName = &quot;MyOCRFileRequestRs&quot;)\n    public MyOCRFileRequestRsType MyOCRFileRequest(\n        @WebParam(name = &quot;MyOCRFileRequestRq&quot;, targetNamespace = &quot;http://www.mycompany.com&quot;, partName = &quot;MyOCRFileRequestRq&quot;)\n        MyOCRFileRequestRqType MyOCRFileRequestRq);\n\n}\n</code></pre>\n<p>MyOCRFileRequestRsType:</p>\n<pre><code>@XmlAccessorType(XmlAccessType.FIELD)\n@XmlType(name = &quot;MyOCRFileRequestRs_Type&quot;, propOrder = {\n    &quot;msgRsHdr&quot;,\n    &quot;body&quot;\n})\npublic class MyOCRFileRequestRsType {\n\n    @XmlElement(name = &quot;MsgRsHdr&quot;, required = true)\n    protected MsgRsHdrType msgRsHdr;\n    @XmlElement(name = &quot;Body&quot;)\n    protected MyOCRFileRequestRsBodyType body;\n\n    public MsgRsHdrType getMsgRsHdr() {\n        return msgRsHdr;\n    }\n\n    public void setMsgRsHdr(MsgRsHdrType value) {\n        this.msgRsHdr = value;\n    }\n\n    public MyOCRFileRequestRsBodyType getBody() {\n        return body;\n    }\n\n\n    public void setBody(MyOCRFileRequestRsBodyType value) {\n        this.body = value;\n    }\n}\n</code></pre>\n<p><strong>UPDATES</strong>:</p>\n<p>I tried using the JVM custom property, and issue still exist</p>\n<pre><code>com.ibm.xml.xlxp.jaxb.opti.level=0\n</code></pre>\n<p>Is there's any configuration I need to change in Websphere in order to fix that ?</p>\n",
    "tags" : [ "java", "jaxb", "websphere", "unmarshalling" ],
    "owner" : {
      "account_id" : 189816,
      "reputation" : 33241,
      "user_id" : 429377,
      "user_type" : "registered",
      "accept_rate" : 91,
      "profile_image" : "https://i.sstatic.net/n8DwZ.jpg?s=256",
      "display_name" : "Mahmoud Saleh",
      "link" : "https://stackoverflow.com/users/429377/mahmoud-saleh"
    },
    "is_answered" : false,
    "view_count" : 257,
    "answer_count" : 1,
    "score" : 2,
    "last_activity_date" : 1743851917,
    "creation_date" : 1742980561,
    "link" : "https://stackoverflow.com/questions/79535906/unmarshalexception-unexpected-element-uri-local-expected-elements-are",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79550023,
    "question_id" : 79535906,
    "body" : "<p>I have researched a lot for your issue (Starting from setting up IBM WebSphere Application Server 9.0 locally to deploying the JAX-WS war). I'm suggesting some changes that might help.</p>\n<p><strong>Note:</strong> I took the help of IBM official documentation for deploying the SOAP JAX-WS service created via <strong>wsimport</strong> to <strong>WebSphere Application Server 9.0.5</strong> on Windows 10.</p>\n<p>Also, Websphere already has its jaxb and jax-ws libraries. So, you don't need to add any extra changes or add explicit VM parameters.</p>\n<p>I was able to deploy the JAX-WS Samples from IBM and running it on WAS without adding any VM parameters.</p>\n<p>------------------</p>\n<p>I will be showing on how IBM did but I have modifed their code and adjusted by your way for demonstration.</p>\n<p>First create a package called <code>ocr</code> in your project. Let assume the package is <code>com.example</code> .</p>\n<ul>\n<li>Update your <code>MyOCRFileRequestRqType</code> and move the class in that package.</li>\n</ul>\n<pre><code>package com.example;\n\nimport java.xml.bind.annotatation.XmlAccessType;\nimport java.xml.bind.annotatation.XmlAccessorType;\nimport java.xml.bind.annotatation.XmlElement;\nimport java.xml.bind.annotatation.XmlRootElement;\nimport java.xml.bind.annotatation.XmlType;\n\n@XmlAccessorType(XmlAccessType.FIELD)\n@XmlType(name = &quot;&quot;, propOrder = {....})\n@XmlRootElement(name = &quot;myOCRFileRequestRqType&quot;)\npublic class MyOCRFileRequestRqType {\n\n    @XmlElement(name = &quot;...&quot;)\n    // fields annotated with @XmlElement with attributes set.\n    \n    // getters and setters\n \n}\n</code></pre>\n<ul>\n<li>Update your <code>MyOCRFileRequestRsType</code> and move the class in that package.</li>\n</ul>\n<pre><code>package com.example;\n\nimport java.xml.bind.annotatation.XmlAccessType;\nimport java.xml.bind.annotatation.XmlAccessorType;\nimport java.xml.bind.annotatation.XmlElement;\nimport java.xml.bind.annotatation.XmlRootElement;\nimport java.xml.bind.annotatation.XmlType;\n\n@XmlAccessorType(XmlAccessType.FIELD)\n@XmlType(name = &quot;&quot;, propOrder = {&quot;msgRsHdr&quot;, &quot;body&quot;})\n@XmlRootElement(name = &quot;myOCRFileRequestRsType&quot;)\npublic class MyOCRFileRequestRsType {\n\n    @XmlElement(name = &quot;MsgRsHdr&quot;, required = true)\n    protected MsgRsHdrType msgRsHdr;\n    @XmlElement(name = &quot;Body&quot;)\n    protected MyOCRFileRequestRsBodyType body;\n\n    public MsgRsHdrType getMsgRsHdr() {\n        return msgRsHdr;\n    }\n\n    public void setMsgRsHdr(MsgRsHdrType value) {\n        this.msgRsHdr = value;\n    }\n\n    public MyOCRFileRequestRsBodyType getBody() {\n        return body;\n    }\n\n\n    public void setBody(MyOCRFileRequestRsBodyType value) {\n        this.body = value;\n    }\n}\n</code></pre>\n<p>Create the <code>ObjectFactory</code> class in that package.</p>\n<pre><code>package com.example;\n\nimport javax.xml.bind.annotation.XmlRegistry;\n\n@XmlRegistry\npublic class ObjectFactory {\n\n    public ObjectFactory() {\n\n    }\n   \n    public MyOCRFileRequestRsType createMyOCRFileRequestRsType() {\n       return new MyOCRFileRequestRsType();\n    }\n\n    public MyOCRFileRequestRqType createMyOCRFileRequestRqType() {\n       return new MyOCRFileRequestRqType();\n    } \n\n}\n</code></pre>\n<ul>\n<li><p>Keep your <code>.wsdl</code> file in the <code>WebContent/WEB-INF/wsdl</code> directory.</p>\n</li>\n<li><p>Create the Web Service interface class <code>MyOCRServicePortType</code> and keep in the same package.</p>\n</li>\n</ul>\n<pre><code>package com.example;\n\nimport javax.jms.WebMethod;\nimport javax.jms.WebParam;\nimport javax.jms.WebResult;\nimport javax.jms.WebService;\nimport javax.jms.soap.SOAPBinding;\nimport javax.jms.soap.SOAPBinding.ParameterStyle;\n\n@WebService(name = &quot;MyOCRServicePortType&quot;, targetNamespace = &quot;http://www.mycompany.com&quot;)\n@SOAPBinding(parameterStyle = ParameterStyle.BARE)\npublic interface MyOCRServicePortType {\n\n\n    /**\n     * \n     * @param request\n     * @return\n     *     returns com.example.MyOCRFileRequestRsType\n     */\n    @WebMethod(action = &quot;ocrOperation&quot;)\n    @WebResult(name = &quot;myOCRFileRequestRsType&quot;, targetNamespace = &quot;http://www.mycompany.com&quot;, partName = &quot;parameter&quot;)\n    public MyOCRFileRequestRsType ocrOperation(\n        @WebParam(name = &quot;myOCRFileRequestRqType&quot;, targetNamespace = &quot;http://www.mycompany.com&quot;, partName = &quot;parameter&quot;)\n        MyOCRFileRequestRqType parameter);\n\n}\n</code></pre>\n<ul>\n<li>Create the Web Service Implementation class <code>MyOCRServicePortImpl</code> and keep it in the same package.</li>\n</ul>\n<pre><code>package com.example;\n\nimport javax.jms.WebMethod;\nimport javax.jms.WebParam;\nimport javax.jms.WebResult;\nimport javax.jms.WebService;\nimport javax.jms.soap.SOAPBinding;\nimport javax.jms.soap.SOAPBinding.ParameterStyle;\n\n@WebService(endpointInterface = &quot;com.example.MyOCRServicePortType&quot;, targetNamespace = &quot;http://www.mycompany.com&quot;, serviceName = &quot;MyOCRService&quot;, portName = &quot;MyOCRServicePort&quot;, wsdlLocation = &quot;WEB-INF/wsdl/Ocr.wsdl&quot;)\npublic class MyOCRServicePortImpl {\n\n    // declaration member variables....\n\n    public MyOCRFileRequestRsType ocrOperation(MyOCRFileRequestRqType parameter) {\n         MyOCRFileRequestRsType response = new ObjectFactory().createMyOCRFileRequestRsType();\n         response.setMsgRsHdr(....);\n         response.setBody(.....)\n         return response;\n    }\n\n}\n</code></pre>\n<ul>\n<li>Update the code which is doing the business logic for OCR:</li>\n</ul>\n<pre><code>private MyOCRFileRequestRsType callMyOCRService(MyOCRFileRequestRqType parameter) throws Exception {\n        String headerValue = &quot;Bearer &quot;+MyTokenClient.getToken();\n        MyOCRServicePortType port= esbOcrSerice.getMyOCRFileRequestSOAP11();\n        Map&lt;String, Object&gt; requestContext = ((BindingProvider) port).getRequestContext();\n\n        requestContext.put(BindingProvider.ENDPOINT_ADDRESS_PROPERTY,ConfigManager.getMyOCRRequestUrl().split(&quot;[?]&quot;)[0]);\n        requestContext.put(&quot;javax.xml.ws.http.request.headers&quot;, \n            Collections.singletonMap(&quot;Authorization&quot;, Collections.singletonList(headerValue)));\n        \n        try {\n            return port.ocrOperation(parameter);\n        } catch (Exception e) {\n                throw e;\n        }\n}\n</code></pre>\n<p>I don't have any much idea apart from this. Please refer to the JAX-WS samples. Just try to replicate what they have done. You will know where is the issue.</p>\n<p>---------------</p>\n<p><strong>References:</strong></p>\n<ul>\n<li><p><a href=\"https://www.ibm.com/docs/en/was/9.0.5?topic=SSEQTP_9.0.5/com.ibm.websphere.base.doc/ae/sample_jax_ws.html\" rel=\"nofollow noreferrer\"><code>JAX-WS Samples</code></a></p>\n</li>\n<li><p><a href=\"https://www.ibm.com/docs/en/was/9.0.5?topic=ieafc-example-installing-jax-ws-web-services-samples-console\" rel=\"nofollow noreferrer\"><code>Installing the JAX-WS Web Services samples on WAS 9.0.5</code></a></p>\n</li>\n</ul>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 11377012,
      "reputation" : 17258,
      "user_id" : 8340997,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/fQmuF6ta.png?s=256",
      "display_name" : "Anish B.",
      "link" : "https://stackoverflow.com/users/8340997/anish-b"
    },
    "creation_date" : 1743580647,
    "last_activity_date" : 1743851917,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140297795,
    "post_id" : 79535906,
    "body" : "<code>logging:   level:     root: TRACE</code>",
    "score" : 0,
    "owner" : {
      "account_id" : 7666017,
      "reputation" : 8130,
      "user_id" : 5809720,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/zNAXD.jpg?s=256",
      "display_name" : "Sagar Gangwal",
      "link" : "https://stackoverflow.com/users/5809720/sagar-gangwal"
    },
    "creation_date" : 1743744581,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140297788,
    "post_id" : 79535906,
    "body" : "Hello @mahmoud, if you can enable TRACE log and provide trace logs around this error. That will give us more idea towards why second time it&#39;s failing. Also provide same TRACE log towards those lines, when your flow is working (First time) so we may compare which value or line causing this issue.",
    "score" : 0,
    "owner" : {
      "account_id" : 7666017,
      "reputation" : 8130,
      "user_id" : 5809720,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/zNAXD.jpg?s=256",
      "display_name" : "Sagar Gangwal",
      "link" : "https://stackoverflow.com/users/5809720/sagar-gangwal"
    },
    "creation_date" : 1743744474,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140285913,
    "post_id" : 79535906,
    "body" : "@RaghavendraN he tried but it&#39;s not working for him. I have earlier answered.",
    "score" : 0,
    "owner" : {
      "account_id" : 11377012,
      "reputation" : 17258,
      "user_id" : 8340997,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/fQmuF6ta.png?s=256",
      "display_name" : "Anish B.",
      "link" : "https://stackoverflow.com/users/8340997/anish-b"
    },
    "creation_date" : 1743496622,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140285502,
    "post_id" : 79535906,
    "body" : "Did you try the solutions mentioned <a href=\"https://stackoverflow.com/questions/5203312/javax-xml-bind-unmarshalexception-unexpected-element-uri-localgroup\">here</a>? Specifically try adding the <code>@XmlRootElement</code> annotation.",
    "score" : 0,
    "owner" : {
      "account_id" : 4923865,
      "reputation" : 9713,
      "user_id" : 3965675,
      "user_type" : "registered",
      "accept_rate" : 24,
      "profile_image" : "https://www.gravatar.com/avatar/a6ed801dcf8eab4b34b7d973081c0913?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Raghavendra N",
      "link" : "https://stackoverflow.com/users/3965675/raghavendra-n"
    },
    "creation_date" : 1743489399,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140281344,
    "post_id" : 79535906,
    "body" : "WebSphere has its own jaxb and jaxws libraries (that usually slightly different from the open source ones). If I were you, I would remove that JVM argument that tells what jaxb factory JDK should use and put every jaxb- and jaxws related dependencies to provided scope (I am expecting you are using maven). Please try to follow the official <a href=\"https://www.ibm.com/docs/en/was/9.0.5?topic=dws-developing-jax-ws-web-services-wsdl-files-top-down\" rel=\"nofollow noreferrer\">documentation</a>",
    "score" : 2,
    "owner" : {
      "account_id" : 7428434,
      "reputation" : 1563,
      "user_id" : 5650224,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/tY2JZ.png?s=256",
      "display_name" : "m4gic",
      "link" : "https://stackoverflow.com/users/5650224/m4gic"
    },
    "creation_date" : 1743407631,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140278453,
    "post_id" : 79535906,
    "body" : "Also please provide the xml data",
    "score" : 0,
    "owner" : {
      "account_id" : 11377012,
      "reputation" : 17258,
      "user_id" : 8340997,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/fQmuF6ta.png?s=256",
      "display_name" : "Anish B.",
      "link" : "https://stackoverflow.com/users/8340997/anish-b"
    },
    "creation_date" : 1743309354,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140278427,
    "post_id" : 79535906,
    "body" : "please provide the complete logs",
    "score" : 0,
    "owner" : {
      "account_id" : 11377012,
      "reputation" : 17258,
      "user_id" : 8340997,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/fQmuF6ta.png?s=256",
      "display_name" : "Anish B.",
      "link" : "https://stackoverflow.com/users/8340997/anish-b"
    },
    "creation_date" : 1743307971,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140277245,
    "post_id" : 79535906,
    "body" : "Is there a sample codebase to reproduce this?",
    "score" : 0,
    "owner" : {
      "account_id" : 11377012,
      "reputation" : 17258,
      "user_id" : 8340997,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/fQmuF6ta.png?s=256",
      "display_name" : "Anish B.",
      "link" : "https://stackoverflow.com/users/8340997/anish-b"
    },
    "creation_date" : 1743262702,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}