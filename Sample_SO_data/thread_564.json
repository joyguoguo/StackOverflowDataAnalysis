{
  "question" : {
    "question_id" : 79793194,
    "title" : "Apache LDAP authentication has isUserInRole method?",
    "body" : "<p>On different servers, I have applications in PHP and Java (other languages too). I am developing all new applications to use LDAP authentication so I don't have to do any user management, but more importantly, my users would have the same login credentials on all apps on all servers. There is an OpenLDAP server where users are defined.</p>\n<p>For Java apps running in Tomcat, JBoss or WebSphere servers, I configured LDAP authentication and use the j_security_check action to authenticate. Users are restricted to different URL's based upon their role membership.</p>\n<p>In Java, LDAP groups are mapped to roles. The HttpServletRequest class exposes an isUserInRole() method which I use within servlets to restrict which page sections and actions. As an example, the URL security won't let a user not in &quot;finance&quot; role from accessing those pages, and when displaying the menu, I suppress the items from being shown by checking the membership with <code>HttpServletRequest.isUserInRole(&quot;finance&quot;)</code> so a non-finance member doesn't see them.</p>\n<p>In httpd/Apache 4.4 running on Oracle Linux 9.6, I've configured ldap and authnz modules to show a login form. It successfully authenticates with my LDAP server. I can configure the  directives in httpd conf files so that people in selected ldap-group may access selected directories.</p>\n<p>My question is, is there a isUserInRole method available in PHP to check group membership which is made available by mod_ldap so that I can show/hide items within my pages? Or do I need to connect to LDAP using PHP methods as given in <a href=\"https://www.php.net/manual/en/book.ldap.php\" rel=\"nofollow noreferrer\">https://www.php.net/manual/en/book.ldap.php</a> ? In Java, the servlets do not need any separate code for LDAP connecting, searching or fetching.</p>\n",
    "tags" : [ "java", "php", "apache", "ldap" ],
    "owner" : {
      "account_id" : 9722759,
      "reputation" : 698,
      "user_id" : 7210927,
      "user_type" : "registered",
      "profile_image" : "https://lh4.googleusercontent.com/-MeJxiLCjIpg/AAAAAAAAAAI/AAAAAAAADd0/X3bd1VJWFlI/s256-rj/photo.jpg",
      "display_name" : "Hussain Akbar",
      "link" : "https://stackoverflow.com/users/7210927/hussain-akbar"
    },
    "is_answered" : true,
    "view_count" : 65,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1760717821,
    "creation_date" : 1760713651,
    "link" : "https://stackoverflow.com/questions/79793194/apache-ldap-authentication-has-isuserinrole-method",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79793253,
    "question_id" : 79793194,
    "body" : "<p>There is no such native PHP function, but there is a decent chance that the Apache authentication injects the successfully authenticated group name into the environment where PHP can see it. Add a <code>var_dump($_SERVER);</code> to an existing page that has your authentication and check the output, you might see a variable like <code>AUTHENTICATE_group</code>, in which case you can just refer to <code>$_SERVER['AUTHENTICATE_group']</code> in your PHP scripts to get the group that the current user matched against.</p>\n<p>Otherwise, you'll have to perform a second hit to the LDAP server from PHP, then search and scan the results yourself. There's a decent chance someone has already written a library to do this sort of group search for you. You might check out the docs for <a href=\"https://symfony.com/doc/current/components/ldap.html\" rel=\"nofollow noreferrer\">symfony/ldap</a>, <a href=\"https://github.com/DirectoryTree/LdapRecord-Laravel\" rel=\"nofollow noreferrer\">directorytree/ldaprecord</a>, or <a href=\"https://docs.laminas.dev/laminas-ldap/\" rel=\"nofollow noreferrer\">laminas/laminas-ldap</a>. If not, it shouldn't be too difficult, something like this:</p>\n<pre><code>function isUserInRole(string $user, string $role): bool\n{\n    $ldap = ldap_connect(...);\n    $search = ldap_search($ldap, ...); // filter for just $user\n    $result = lget_get_entries($ldap, $search);\n    return array_search($role, $result[0]['memberof']); // or wherever your groups are\n}\n</code></pre>\n",
    "score" : 1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 204657,
      "reputation" : 54023,
      "user_id" : 453002,
      "user_type" : "registered",
      "accept_rate" : 100,
      "profile_image" : "https://www.gravatar.com/avatar/66e564e1221dfd0bfd24e7c47e2079ea?s=256&d=identicon&r=PG",
      "display_name" : "Alex Howansky",
      "link" : "https://stackoverflow.com/users/453002/alex-howansky"
    },
    "creation_date" : 1760717821,
    "last_activity_date" : 1760717821,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140807842,
    "post_id" : 79793194,
    "body" : "Feel free to add all clarification <b>to your question</b> by editing it",
    "score" : 0,
    "owner" : {
      "account_id" : 1129881,
      "reputation" : 12118,
      "user_id" : 1116230,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/55a894894150db28d6641f0c57e48bac?s=256&d=identicon&r=PG",
      "display_name" : "Nico Haase",
      "link" : "https://stackoverflow.com/users/1116230/nico-haase"
    },
    "creation_date" : 1761028383,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140807768,
    "post_id" : 79793194,
    "body" : "I had asked that in Java a facility exists when using LDAP authentication and if something similar was available in PHP running under Apache and using LDAP auth module. The version number was a typo.",
    "score" : 0,
    "owner" : {
      "account_id" : 9722759,
      "reputation" : 698,
      "user_id" : 7210927,
      "user_type" : "registered",
      "profile_image" : "https://lh4.googleusercontent.com/-MeJxiLCjIpg/AAAAAAAAAAI/AAAAAAAADd0/X3bd1VJWFlI/s256-rj/photo.jpg",
      "display_name" : "Hussain Akbar",
      "link" : "https://stackoverflow.com/users/7210927/hussain-akbar"
    },
    "creation_date" : 1761025214,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140805820,
    "post_id" : 79793194,
    "body" : "Is this a PHP problem or a Java problem? &quot;httpd/Apache 4.4&quot; - how is that related, and which version are you really using? The most recent Apache version is 2.4.something",
    "score" : 0,
    "owner" : {
      "account_id" : 1129881,
      "reputation" : 12118,
      "user_id" : 1116230,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/55a894894150db28d6641f0c57e48bac?s=256&d=identicon&r=PG",
      "display_name" : "Nico Haase",
      "link" : "https://stackoverflow.com/users/1116230/nico-haase"
    },
    "creation_date" : 1760946155,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79793253" : [ {
      "comment_id" : 140802576,
      "post_id" : 79793253,
      "body" : "<a href=\"https://httpd.apache.org/docs/current/en/mod/mod_authnz_ldap.html#exposed\" rel=\"nofollow noreferrer\">Exposing Login Information</a>",
      "score" : 0,
      "owner" : {
        "account_id" : 17592368,
        "reputation" : 19777,
        "user_id" : 12763954,
        "user_type" : "registered",
        "profile_image" : "https://lh6.googleusercontent.com/-uYTsiw1bQ_o/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rev-nenZRronqGEJxeFQWww3ShBnQ/s256-rj/photo.jpg",
        "display_name" : "Olivier",
        "link" : "https://stackoverflow.com/users/12763954/olivier"
      },
      "creation_date" : 1760726501,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140802572,
      "post_id" : 79793253,
      "body" : "I think the authenticate_group populate only if the ldap-group is set in URL&#39;s protection as I don&#39;t see it. Yes, I;ve used the PHP LDAP functions previously, so shall go with them.",
      "score" : 0,
      "owner" : {
        "account_id" : 9722759,
        "reputation" : 698,
        "user_id" : 7210927,
        "user_type" : "registered",
        "profile_image" : "https://lh4.googleusercontent.com/-MeJxiLCjIpg/AAAAAAAAAAI/AAAAAAAADd0/X3bd1VJWFlI/s256-rj/photo.jpg",
        "display_name" : "Hussain Akbar",
        "link" : "https://stackoverflow.com/users/7210927/hussain-akbar"
      },
      "creation_date" : 1760726384,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}