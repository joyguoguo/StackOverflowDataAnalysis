{
  "question" : {
    "question_id" : 79608664,
    "title" : "run docker-compose up database unitialized error",
    "body" : "<p>I am really new with the topics docker file and docker-compose..\nI read a lot of tutorial but I could not get my problem solved..\nmy dockerfile</p>\n<pre><code># Use an OpenJDK Runtime as a parent image\nFROM openjdk:21-jdk\n# Set the working directory to /app\nWORKDIR /app\n# Copy maven executable to the image\nCOPY mvnw .\nCOPY .mvn .mvn\n\n# Copy the pom.xml file\nCOPY pom.xml .\n\n# Copy the project source\nCOPY ./src ./src\nCOPY ./pom.xml ./pom.xml\n\nRUN chmod 755 /app/mvnw\n\nRUN ./mvnw dependency:go-offline -B\n\nRUN ./mvnw package\n#RUN ls -al\nENTRYPOINT [&quot;java&quot;,&quot;-jar&quot;,&quot;target/demo_app-0.0.1-SNAPSHOT.jar&quot;]\n</code></pre>\n<p>my docker-compose</p>\n<pre><code>services:\n  app:\n    image: 'postgres:latest'\n    build:\n      context: .\n    container_name: app-demo\n    depends_on:\n      - postgres\n\n    environment:\n      - POSTGRES_PASSWORD:secret\n    ports:\n      - '8090:8080'\n    restart: always\n\n  postgres:\n    image: 'postgres:latest'\n    container_name: test-postgres\n    environment:\n      - POSTGRES_DB:mydatabase\n      - POSTGRES_PASSWORD:secret\n      - POSTGRES_USER:testuser\n    ports:\n      - '5432:5432'\n</code></pre>\n<p>my application properties</p>\n",
    "tags" : [ "java", "spring-boot", "docker", "maven" ],
    "owner" : {
      "account_id" : 37345432,
      "reputation" : 1,
      "user_id" : 28198671,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/ac3bc9cf3a8088f49c4275204592acbb?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "user28198671",
      "link" : "https://stackoverflow.com/users/28198671/user28198671"
    },
    "is_answered" : true,
    "view_count" : 58,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1747052233,
    "creation_date" : 1746532951,
    "link" : "https://stackoverflow.com/questions/79608664/run-docker-compose-up-database-unitialized-error",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79615980,
    "question_id" : 79608664,
    "body" : "<h2>Assumed Issue</h2>\n<hr />\n<p>Running <code>docker compose up</code> for the provided <code>compose</code> file (completely unrelated to the provided <code>Dockerfile</code>), the <em>uninitialized error</em> mentioned in the title appeared in logs of both created containers.</p>\n<h2>Solution</h2>\n<hr />\n<p>The log clearly states</p>\n<pre class=\"lang-none prettyprint-override\"><code>You must specify POSTGRES_PASSWORD to a non-empty value for the superuser.\n</code></pre>\n<p>which implies that the <code>- POSTGRES_PASSWORD:secret</code> did not set <code>POSTGRES_PASSWORD</code> to value <code>secret</code>. The correct way to set the environment variables in <code>compose</code> file is:</p>\n<pre class=\"lang-yaml prettyprint-override\"><code>environment:\n  - POSTGRES_DB=mydatabase\n  - POSTGRES_PASSWORD=secret\n  - POSTGRES_USER=testuser\n</code></pre>\n<p>(note the <code>=</code> instead of <code>:</code> between env variable name and it's value).</p>\n<p>This leads to the...</p>\n<h2>Rule of Thumb</h2>\n<hr />\n<p><strong>Always check the logs!</strong></p>\n<p>Besides erroring that the <code>POSTGRES_PASSWORD</code> was not set, <code>docker logs test-postgres</code> (getting logs of the failed image) also provides an example of <em>how to set it</em>:</p>\n<pre class=\"lang-none prettyprint-override\"><code>For example, &quot;-e POSTGRES_PASSWORD=password&quot; on &quot;docker run&quot;.\n</code></pre>\n<h2>P. S.</h2>\n<hr />\n<p>Unsure why the <code>Dockerfile</code> was provided, however I'm unable to ignore it. So...</p>\n<p>... your <code>Dockerfile</code> is bloated with a lot of unnecessary (during runtime) stuff, including, but not limited to, the source code and <code>mvn</code> executable. The most obvious problem this causes is the image size - it get's unreasonably big.</p>\n<p>Consider</p>\n<ul>\n<li><p>either building the <code>jar</code> somewhere else and copying it into the final docker image,</p>\n</li>\n<li><p>or using the <a href=\"https://docs.docker.com/build/building/multi-stage/\" rel=\"nofollow noreferrer\">multistage builds</a> (preferred).</p>\n</li>\n</ul>\n",
    "score" : 1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 12332874,
      "reputation" : 11,
      "user_id" : 8998198,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/65ErroVB.png?s=256",
      "display_name" : "efixty",
      "link" : "https://stackoverflow.com/users/8998198/efixty"
    },
    "creation_date" : 1746915301,
    "last_activity_date" : 1747052233,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140400456,
    "post_id" : 79608664,
    "body" : "You have incorrect syntax in all of your <code>environment:</code> settings, which is potentially a cause of trouble.  Try <code>- POSTGRES_DB=mydatabase</code> with an equal sign instead of the colon, or <code>POSTGRES_DB: mydatabase</code> with no hyphen but with a space for YAML mapping syntax.",
    "score" : 1,
    "owner" : {
      "account_id" : 13863020,
      "reputation" : 164891,
      "user_id" : 10008173,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/bc86d913c15f3b126673faa654e9668c?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "David Maze",
      "link" : "https://stackoverflow.com/users/10008173/david-maze"
    },
    "creation_date" : 1746536154,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140400407,
    "post_id" : 79608664,
    "body" : "Please clarify your specific problem or provide additional details to highlight exactly what you need. As it&#39;s currently written, it&#39;s hard to tell exactly what you&#39;re asking.",
    "score" : 0,
    "owner" : {
      "account_id" : -1,
      "reputation" : 1,
      "user_id" : -1,
      "user_type" : "moderator",
      "profile_image" : "https://www.gravatar.com/avatar/a007be5a61f6aa8f3e85ae2fc18dd66e?s=256&d=identicon&r=PG",
      "display_name" : "Community",
      "link" : "https://stackoverflow.com/users/-1/community"
    },
    "creation_date" : 1746535438,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140400334,
    "post_id" : 79608664,
    "body" : "What is the error?",
    "score" : 0,
    "owner" : {
      "account_id" : 4912982,
      "reputation" : 16914,
      "user_id" : 3957754,
      "user_type" : "registered",
      "accept_rate" : 50,
      "profile_image" : "https://i.sstatic.net/zwIRL.png?s=256",
      "display_name" : "JRichardsz",
      "link" : "https://stackoverflow.com/users/3957754/jrichardsz"
    },
    "creation_date" : 1746534523,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140400245,
    "post_id" : 79608664,
    "body" : "first of all, you forgot to ask a question second; you probably want to read up on how to set environment variables <a href=\"https://docs.docker.com/compose/how-tos/environment-variables/set-environment-variables/\" rel=\"nofollow noreferrer\">docs.docker.com/compose/how-tos/environment-variables/&hellip;</a>",
    "score" : 0,
    "owner" : {
      "account_id" : 15772183,
      "reputation" : 723,
      "user_id" : 11380911,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/-wQ8TQ0A-FEM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re-vlj8B984pmGHkM41Rhzm1auZ0Q/mo/s256-rj/photo.jpg",
      "display_name" : "Kenzo Staelens",
      "link" : "https://stackoverflow.com/users/11380911/kenzo-staelens"
    },
    "creation_date" : 1746533359,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140400228,
    "post_id" : 79608664,
    "body" : "You forgot to ask a question",
    "score" : 2,
    "owner" : {
      "account_id" : 1888781,
      "reputation" : 2498,
      "user_id" : 1707427,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/4d1a2608ee35e2df7d2400a02e62bb20?s=256&d=identicon&r=PG",
      "display_name" : "S&#246;ren",
      "link" : "https://stackoverflow.com/users/1707427/s%c3%b6ren"
    },
    "creation_date" : 1746533149,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}