{
  "question" : {
    "question_id" : 79550450,
    "title" : "MalformedURLException: unknown protocol: nested for spark-submit",
    "body" : "<p>I built a Spring Boot 3.4 fat JAR and when I try to run it using Spark Submit, I get the following error:</p>\n<pre><code>Exception in thread &quot;main&quot; java.lang.ExceptionInInitializerError\n    at org.springframework.boot.loader.net.protocol.jar.Handler.openConnection(Handler.java:46)\n    at java.base/java.net.URL.openConnection(URL.java:1094)\n    at org.springframework.boot.loader.net.protocol.jar.JarUrlClassLoader.getJarFile(JarUrlClassLoader.java:183)\n    at org.springframework.boot.loader.net.protocol.jar.JarUrlClassLoader.definePackage(JarUrlClassLoader.java:146)\n    at org.springframework.boot.loader.net.protocol.jar.JarUrlClassLoader.definePackageIfNecessary(JarUrlClassLoader.java:129)\n    at org.springframework.boot.loader.net.protocol.jar.JarUrlClassLoader.loadClass(JarUrlClassLoader.java:102)\n    at org.springframework.boot.loader.launch.LaunchedClassLoader.loadClass(LaunchedClassLoader.java:91)\n    at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:525)\n    at java.base/java.lang.Class.forName0(Native Method)\n    at java.base/java.lang.Class.forName(Class.java:467)\n    at org.springframework.boot.loader.launch.Launcher.launch(Launcher.java:99)\n    at org.springframework.boot.loader.launch.Launcher.launch(Launcher.java:64)\n    at org.springframework.boot.loader.launch.JarLauncher.main(JarLauncher.java:40)\n    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\n    at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.base/java.lang.reflect.Method.invoke(Method.java:569)\n    at org.apache.spark.deploy.JavaMainApplication.start(SparkApplication.scala:52)\n    at org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:1034)\n    at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:199)\n    at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:222)\n    at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:91)\n    at org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:1125)\n    at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1134)\n    at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)\nCaused by: java.lang.IllegalStateException: java.net.MalformedURLException: unknown protocol: nested\n    at org.springframework.boot.loader.net.protocol.jar.JarUrlConnection.&lt;clinit&gt;(JarUrlConnection.java:67)\n    ... 25 more\nCaused by: java.net.MalformedURLException: unknown protocol: nested\n    at java.base/java.net.URL.&lt;init&gt;(URL.java:681)\n    at java.base/java.net.URL.&lt;init&gt;(URL.java:569)\n    at java.base/java.net.URL.&lt;init&gt;(URL.java:516)\n    at java.base/java.net.JarURLConnection.parseSpecs(JarURLConnection.java:175)\n    at java.base/java.net.JarURLConnection.&lt;init&gt;(JarURLConnection.java:158)\n    at org.springframework.boot.loader.net.protocol.jar.JarUrlConnection.&lt;init&gt;(JarUrlConnection.java:92)\n    at org.springframework.boot.loader.net.protocol.jar.JarUrlConnection.&lt;clinit&gt;(JarUrlConnection.java:64)\n\n</code></pre>\n<p>I think it happens when spring loads application-properties. I tried creating a shadow jar, still it was not helping.</p>\n<pre><code>spark-submit --class org.springframework.boot.loader.launch.JarLauncher  app.jar --arg1 --arg2 --arg3\n</code></pre>\n",
    "tags" : [ "java", "spring-boot", "apache-spark", "spark-submit", "uberjar" ],
    "owner" : {
      "account_id" : 14746357,
      "reputation" : 100,
      "user_id" : 10649578,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/KwIdN.jpg?s=256",
      "display_name" : "Siva Pratheep",
      "link" : "https://stackoverflow.com/users/10649578/siva-pratheep"
    },
    "is_answered" : false,
    "view_count" : 168,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1743596418,
    "creation_date" : 1743592391,
    "link" : "https://stackoverflow.com/questions/79550450/malformedurlexception-unknown-protocol-nested-for-spark-submit",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140292115,
    "post_id" : 79550450,
    "body" : "Please trim your code to make it easier to find your problem. Follow these guidelines to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.",
    "score" : 0,
    "owner" : {
      "account_id" : -1,
      "reputation" : 1,
      "user_id" : -1,
      "user_type" : "moderator",
      "profile_image" : "https://www.gravatar.com/avatar/a007be5a61f6aa8f3e85ae2fc18dd66e?s=256&d=identicon&r=PG",
      "display_name" : "Community",
      "link" : "https://stackoverflow.com/users/-1/community"
    },
    "creation_date" : 1743625487,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140290269,
    "post_id" : 79550450,
    "body" : "This typically happens when running a Spring Boot application packaged as a fat JAR (with nested dependencies) in an environment that doesn&#39;t properly support Spring Boot&#39;s custom class loading mechanism. Looks Like the Spring Boot fat JAR is being executed in a non-standard way.",
    "score" : 0,
    "owner" : {
      "account_id" : 10927511,
      "reputation" : 3218,
      "user_id" : 8031784,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/ikcJL.png?s=256",
      "display_name" : "Aniruddh Parihar",
      "link" : "https://stackoverflow.com/users/8031784/aniruddh-parihar"
    },
    "creation_date" : 1743594710,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140290189,
    "post_id" : 79550450,
    "body" : "Please add spark-submit command you used",
    "score" : 0,
    "owner" : {
      "account_id" : 1383279,
      "reputation" : 1511,
      "user_id" : 1315833,
      "user_type" : "registered",
      "accept_rate" : 80,
      "profile_image" : "https://www.gravatar.com/avatar/00485e9b12c3818ec67071c2bb197a10?s=256&d=identicon&r=PG",
      "display_name" : "Vindhya G",
      "link" : "https://stackoverflow.com/users/1315833/vindhya-g"
    },
    "creation_date" : 1743593386,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}