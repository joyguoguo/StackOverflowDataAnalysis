{
  "question" : {
    "question_id" : 79534905,
    "title" : "HMTL image isn&#39;t shown in browser after sending it with the httpExchange responseBody",
    "body" : "<p>I'm working on a small com.sun.net.httpserver project where i want to show images a user has uploaded.\nI already managed to get the image and safe it onto the file system.\nNow i want to send the image back to the client. When i open the html directly with my browser evertyhing works perfectly fine. But when i send the html file via the responseBody back to the client, only the alt text is shown but no images.</p>\n<p>I create a dynamic HTML file in a static method:</p>\n<pre><code>File htmlSeite =  HTTPHandlerUtils.createHtmlListInhaltFile(ergsListe);\n</code></pre>\n<p>The html File looks like this:</p>\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n    &lt;head&gt;\n        &lt;meta charset=&quot;UTF-8&quot;&gt;\n        &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;\n        &lt;title&gt;Inhalt&lt;/title&gt;\n        &lt;style&gt;\n            body{background-color: black;}\n            h2{color: white;}\n            table {\n                border-collapse: collapse;\n                width: 100%;\n                color: white;\n                }\n\n            td, th {\n                border: 1px solid;\n                text-align: left;\n                padding: 8px;\n                }\n        &lt;/style&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        &lt;h2&gt;Object Inhalt&lt;/h2&gt;\n        &lt;table&gt;\n            &lt;tr&gt;\n                &lt;th style=&quot;width:10%&quot;&gt;Erstellzeitpunkt&lt;/th&gt;\n                &lt;th style=&quot;width:10%&quot;&gt;Name&lt;/th&gt;\n                &lt;th style=&quot;width:5%&quot;&gt;Anzahl&lt;/th&gt;\n                &lt;th style=&quot;width:75%&quot;&gt;Foto&lt;/th&gt;\n            &lt;/tr&gt;\n            &lt;tr&gt;\n                &lt;td&gt;24.03.2025 20:19:47&lt;/td&gt;\n                &lt;td&gt;neuer Inhalt&lt;/td&gt;\n                &lt;td&gt;15&lt;/td&gt;\n                &lt;td&gt;&lt;img src=&quot;../photos/Object/neuer_Inhalt.jpg&quot; alt=&quot;Foto des neuer Inhalt&quot; width=&quot;400&quot; height=&quot;400&quot;&gt;&lt;/td&gt;\n            &lt;/tr&gt;\n        &lt;/table&gt; &lt;br&gt;&lt;br&gt;\n        &lt;button onclick=&quot;window.history.back()&quot;&gt;Zur√ºck&lt;/button&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n<p>And then i send the file back to the client:</p>\n<pre><code>OutputStream outputStream = httpExchange.getResponseBody();\n    byte[] htmlSeiteData = new byte[(int) htmlSeite.length()];\n    try (FileInputStream fis = new FileInputStream(htmlSeite)) {\n        fis.read(htmlSeiteData);\n    } catch (IOException e) {\n        logger.log(new Meldung(&quot;Die listInhalt/meldungInhalt-HTML-Seite konnte nicht gelsen werden.&quot;, true));\n        logger.log(e);\n    }\n    \n    // this line is a must\n    httpExchange.sendResponseHeaders(200, htmlSeiteData.length);\n    outputStream.write(htmlSeiteData);\n    outputStream.flush();\n    outputStream.close();\n</code></pre>\n<p>Like i mentioned before opening the HTML file directly with my browser works perfectly fine.</p>\n<p>Thanks in Advance.</p>\n",
    "tags" : [ "java", "html", "image", "outputstream", "httpserver" ],
    "owner" : {
      "account_id" : 40984796,
      "reputation" : 1,
      "user_id" : 30061143,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/60225bf84d5c483a6a0b4e7757922d21?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Bessarionis Zockiflocki",
      "link" : "https://stackoverflow.com/users/30061143/bessarionis-zockiflocki"
    },
    "is_answered" : false,
    "view_count" : 55,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1742937456,
    "creation_date" : 1742937456,
    "link" : "https://stackoverflow.com/questions/79534905/hmtl-image-isnt-shown-in-browser-after-sending-it-with-the-httpexchange-respons",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140266560,
    "post_id" : 79534905,
    "body" : "I don&#39;t understand why not both of it should work at the same time. I solved my problem now even tho i&#39;m not sooo happy with the solution. I noticed that the &lt;img src=&quot;URL&quot;&gt; works perfectly fine. So i write my own server url with the filepath of the wanted img attached into the img tag. I also added a handle getRequestPhotos method to my http server which only responses the whole photo. I don&#39;t know ho good this will work when i have like 200 pictures to show but i think it will suite for my needs at the moment. Still thanks for your help and your time bro i appreciate it :&gt;.",
    "score" : 0,
    "owner" : {
      "account_id" : 40984796,
      "reputation" : 1,
      "user_id" : 30061143,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/60225bf84d5c483a6a0b4e7757922d21?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Bessarionis Zockiflocki",
      "link" : "https://stackoverflow.com/users/30061143/bessarionis-zockiflocki"
    },
    "creation_date" : 1743016783,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140266370,
    "post_id" : 79534905,
    "body" : "I haven&#39;t looked in detail, but it seems you are mixing paradigms. You seem to want to write content dynamically (let&#39;s call that &#39;Web 2&#39;) yet you&#39;re expecting a link to an image to work as well (&#39;Web 1&#39;) <i>at the same time</i>. What <i>might</i> work is if you were to insert the image content inline as a Base64-encoded value.",
    "score" : 0,
    "owner" : {
      "account_id" : 22124137,
      "reputation" : 4243,
      "user_id" : 16376827,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/1ImPw.png?s=256",
      "display_name" : "g00se",
      "link" : "https://stackoverflow.com/users/16376827/g00se"
    },
    "creation_date" : 1743013218,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140266143,
    "post_id" : 79534905,
    "body" : "@g00se Yeah you are right. I tryed it earlier today without setting the content length of the header. When i only send the image via ImageIO.write(photo, &quot;jpg&quot;, outputStream) the img is sent without any problems and shown in the browser. When i send my created html file without a content length set in the header i get the same result as before (jut the alt texts without the imgs). So i understand that the img tag doesn&#39;t work in my use case and i need to send the pictures byte by byte. The Question now is just how can i insert the bytes of the images at their specific place inside the HTML.",
    "score" : 0,
    "owner" : {
      "account_id" : 40984796,
      "reputation" : 1,
      "user_id" : 30061143,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/60225bf84d5c483a6a0b4e7757922d21?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Bessarionis Zockiflocki",
      "link" : "https://stackoverflow.com/users/30061143/bessarionis-zockiflocki"
    },
    "creation_date" : 1743009808,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140266117,
    "post_id" : 79534905,
    "body" : "@sanurah No i did not try to set the Content type. But that could be a good hint. I already had to change the content type of the form the server recieves to &quot;multipart/form-data&quot; in order to be able to save the img. But it&#39;s ton of work to create such a response in java and i don&#39;t know how table data is represented in this content type.",
    "score" : 0,
    "owner" : {
      "account_id" : 40984796,
      "reputation" : 1,
      "user_id" : 30061143,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/60225bf84d5c483a6a0b4e7757922d21?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Bessarionis Zockiflocki",
      "link" : "https://stackoverflow.com/users/30061143/bessarionis-zockiflocki"
    },
    "creation_date" : 1743009485,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140264684,
    "post_id" : 79534905,
    "body" : "What happens when you  <i>don&#39;t</i> set the Content-Length header?",
    "score" : 0,
    "owner" : {
      "account_id" : 22124137,
      "reputation" : 4243,
      "user_id" : 16376827,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/1ImPw.png?s=256",
      "display_name" : "g00se",
      "link" : "https://stackoverflow.com/users/16376827/g00se"
    },
    "creation_date" : 1742983269,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140264064,
    "post_id" : 79534905,
    "body" : "What I alread tried was to stream the image Bytes directly into the outputstream (with ImageIO.write). But then i get an Error saying the outputstream is too small respectively the image has to many bytes. The problem with that ist that i want to show the image as data inside a table and with that way I would only show the Image.",
    "score" : 0,
    "owner" : {
      "account_id" : 40984796,
      "reputation" : 1,
      "user_id" : 30061143,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/60225bf84d5c483a6a0b4e7757922d21?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Bessarionis Zockiflocki",
      "link" : "https://stackoverflow.com/users/30061143/bessarionis-zockiflocki"
    },
    "creation_date" : 1742973427,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140264052,
    "post_id" : 79534905,
    "body" : "@g00se No, it only includes the size of the html File I&#39;m sending. I thought the image tag inside the html file automaticlly do all the magic to show the image on the Browser :D",
    "score" : 0,
    "owner" : {
      "account_id" : 40984796,
      "reputation" : 1,
      "user_id" : 30061143,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/60225bf84d5c483a6a0b4e7757922d21?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Bessarionis Zockiflocki",
      "link" : "https://stackoverflow.com/users/30061143/bessarionis-zockiflocki"
    },
    "creation_date" : 1742973281,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140263166,
    "post_id" : 79534905,
    "body" : "have you tried to set the content type? httpExchange.getResponseHeaders().set(&quot;Content-Type&quot;, &quot;text/html; charset=UTF-8&quot;);",
    "score" : 0,
    "owner" : {
      "account_id" : 5083689,
      "reputation" : 1141,
      "user_id" : 4079056,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/LfAQ3.jpg?s=256",
      "display_name" : "sanurah",
      "link" : "https://stackoverflow.com/users/4079056/sanurah"
    },
    "creation_date" : 1742943231,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140262940,
    "post_id" : 79534905,
    "body" : "<i>byte[] htmlSeiteData = new byte[(int) htmlSeite.length()];</i> Is that including the image size as well?",
    "score" : 0,
    "owner" : {
      "account_id" : 22124137,
      "reputation" : 4243,
      "user_id" : 16376827,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/1ImPw.png?s=256",
      "display_name" : "g00se",
      "link" : "https://stackoverflow.com/users/16376827/g00se"
    },
    "creation_date" : 1742938194,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}