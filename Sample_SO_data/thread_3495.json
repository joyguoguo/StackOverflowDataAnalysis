{
  "question" : {
    "question_id" : 79545965,
    "title" : "Authentication for CrateDB SU crate failed using CrateDB 5.10.3 with JDBC Driver",
    "body" : "<p>I'm trying to connect my CrateDB (running locally) with Java using JDBC.</p>\n<pre><code>public class Main {\n\n    private static String connectionURL = &quot;jdbc:postgresql://localhost:5432/&quot;;\n\n    public static void main(String[] args) throws SQLException {\n\n        Properties props = new Properties();\n        props.setProperty(&quot;user&quot;, &quot;crate&quot;);\n\n        Connection sqlConnection = DriverManager.getConnection(connectionURL, props);\n\n        if(!sqlConnection.isClosed()) {\n            System.out.println(&quot;Connection is open!&quot;);\n        } else {\n            System.out.println(&quot;Connection is closed!&quot;);\n        }\n    }\n}\n</code></pre>\n<p>Dependencies I'm using for this project:</p>\n<pre><code>    &lt;dependencies&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.postgresql&lt;/groupId&gt;\n            &lt;artifactId&gt;postgresql&lt;/artifactId&gt;\n            &lt;version&gt;LATEST&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.beust&lt;/groupId&gt;\n            &lt;artifactId&gt;jcommander&lt;/artifactId&gt;\n            &lt;version&gt;1.82&lt;/version&gt;\n        &lt;/dependency&gt;\n\n    &lt;/dependencies&gt;\n</code></pre>\n<p>This is my current Main Class and its simple enough. The CrateDB SU does not have a Password (as said in the documentation) and shouldn't require one according to my auth settings in the crate.yml:d</p>\n<pre><code>auth:\n  host_based:\n    enabled: true\n    config:\n      0:\n        user: crate\n        address: _local_\n        method: trust\n      99:\n        method: password\n</code></pre>\n<p>Yet when i try to run my Main Method i get the following error:</p>\n<pre><code>Exception in thread &quot;main&quot; org.postgresql.util.PSQLException: The server requested SCRAM-based authentication, but no password was provided.\n    at org.postgresql.core.v3.ConnectionFactoryImpl.lambda$doAuthentication$5(ConnectionFactoryImpl.java:848)\n    at org.postgresql.core.v3.AuthenticationPluginManager.withPassword(AuthenticationPluginManager.java:82)\n    at org.postgresql.core.v3.ConnectionFactoryImpl.doAuthentication(ConnectionFactoryImpl.java:845)\n    at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:213)\n    at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:268)\n    at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:54)\n    at org.postgresql.jdbc.PgConnection.&lt;init&gt;(PgConnection.java:273)\n    at org.postgresql.Driver.makeConnection(Driver.java:446)\n    at org.postgresql.Driver.connect(Driver.java:298)\n    at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:683)\n    at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:191)\n    at src.main.java.com.XXXX.Main.main(Main.java:17)\n</code></pre>\n<p>If I add a Password Property, i also get the error that the SU password is empty and that authentification has failed. (And it is not possible to set a password for the CrateDB Superuser)</p>\n<p>I tried adding a new User (Admin) and giving it a password as well as giving it all Priviliges but this fails also.</p>\n<p>I have also tried using a different driver:</p>\n<pre><code>    &lt;dependencies&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;io.crate&lt;/groupId&gt;\n            &lt;artifactId&gt;crate-jdbc&lt;/artifactId&gt;\n            &lt;version&gt;2.7.0&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.beust&lt;/groupId&gt;\n            &lt;artifactId&gt;jcommander&lt;/artifactId&gt;\n            &lt;version&gt;1.82&lt;/version&gt;\n        &lt;/dependency&gt;\n\n    &lt;/dependencies&gt;\n</code></pre>\n<p>But i get a error which is even weirder:</p>\n<pre><code>public class Main {\n\n    private static String connectionURL = &quot;jdbc:crate://localhost:5432/&quot;;\n\n    public static void main(String[] args) throws SQLException {\n\n        Properties props = new Properties();\n        props.setProperty(&quot;user&quot;, &quot;crate&quot;);\n\n        Connection sqlConnection = DriverManager.getConnection(connectionURL, props);\n\n        if(!sqlConnection.isClosed()) {\n            System.out.println(&quot;Connection is open!&quot;);\n        } else {\n            System.out.println(&quot;Connection is closed!&quot;);\n        }\n    }\n}\n</code></pre>\n<p>The Error i get:</p>\n<pre><code>Exception in thread &quot;main&quot; io.crate.shade.org.postgresql.util.PSQLException: Etwas Ungewöhnliches ist passiert, das den Treiber fehlschlagen ließ. Bitte teilen Sie diesen Fehler mit.\n    at io.crate.shade.org.postgresql.Driver.connect(Driver.java:265)\n    at io.crate.client.jdbc.CrateDriver.connect(CrateDriver.java:65)\n    at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:683)\n    at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:191)\n    at src.main.java.com.XXXX.Main.main(Main.java:17)\nCaused by: java.lang.IllegalArgumentException: Null value for 'password'\n    at com.ongres.scram.common.util.Preconditions.checkNotNull(Preconditions.java:41)\n    at com.ongres.scram.common.util.Preconditions.checkNotEmpty(Preconditions.java:55)\n    at com.ongres.scram.client.ScramSession$ServerFirstProcessor.clientFinalProcessor(ScramSession.java:130)\n    at io.crate.shade.org.postgresql.jre8.sasl.ScramAuthenticator.processServerFirstMessage(ScramAuthenticator.java:131)\n    at io.crate.shade.org.postgresql.core.v3.ConnectionFactoryImpl.doAuthentication(ConnectionFactoryImpl.java:663)\n    at io.crate.shade.org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:141)\n    at io.crate.shade.org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:192)\n    at io.crate.shade.org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:49)\n    at io.crate.shade.org.postgresql.jdbc.PgConnection.&lt;init&gt;(PgConnection.java:206)\n    at io.crate.shade.org.postgresql.Driver.makeConnection(Driver.java:442)\n    at io.crate.shade.org.postgresql.Driver.connect(Driver.java:244)\n    ... 4 more\n</code></pre>\n<p>So i would like to stick to the PostgreSQL driver instead of the crate.io Driver provided.</p>\n<p>I have tried to google but i simply cannot find anything (or im blind) so any help would be appreciated.</p>\n<p>I tried to get a JDBC Connection running with my Java-Project and expected a simple &quot;Connection is open!&quot; from my program so i know my Java-Code connects with Crates JDBC driver.</p>\n",
    "tags" : [ "java", "postgresql", "jdbc", "cratedb", "crate" ],
    "owner" : {
      "account_id" : 27568644,
      "reputation" : 11,
      "user_id" : 21040293,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/0ed62e02b7fa86aa48e2e7de5dbdf93a?s=256&d=identicon&r=PG",
      "display_name" : "Luca",
      "link" : "https://stackoverflow.com/users/21040293/luca"
    },
    "is_answered" : true,
    "view_count" : 44,
    "answer_count" : 1,
    "score" : 1,
    "last_activity_date" : 1743469468,
    "creation_date" : 1743415211,
    "link" : "https://stackoverflow.com/questions/79545965/authentication-for-cratedb-su-crate-failed-using-cratedb-5-10-3-with-jdbc-driver",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79547530,
    "question_id" : 79545965,
    "body" : "<p>After looking through the Internet for what felt like a whole lifetime i stumbled onto a <a href=\"https://github.com/crate/crate/issues/9132\" rel=\"nofollow noreferrer\">Github Issue for CrateDB</a> and changed the port used by CrateDB to 5433 because PostgreSQL is installed and is using Port 5432.</p>\n",
    "score" : 0,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 27568644,
      "reputation" : 11,
      "user_id" : 21040293,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/0ed62e02b7fa86aa48e2e7de5dbdf93a?s=256&d=identicon&r=PG",
      "display_name" : "Luca",
      "link" : "https://stackoverflow.com/users/21040293/luca"
    },
    "creation_date" : 1743469468,
    "last_activity_date" : 1743469468,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140284850,
    "post_id" : 79545965,
    "body" : "Because when i use the Crate.io jdbc driver does not work and i cannot find anything to help me fix this error (see the bottom of my post)  I either get a weird error, saying that &quot;Something uncommon happened&quot; or that the Role for the Superuser crate doesn&#39;t exist.   I have already switched back to the crateDB driver (        &lt;dependency&gt;             &lt;groupId&gt;io.crate&lt;/groupId&gt;             &lt;artifactId&gt;crate-jdbc&lt;/artifactId&gt;             &lt;version&gt;2.6.0&lt;/version&gt;         &lt;/dependency&gt; )  But it still doesn&#39;t work.",
    "score" : 0,
    "owner" : {
      "account_id" : 27568644,
      "reputation" : 11,
      "user_id" : 21040293,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/0ed62e02b7fa86aa48e2e7de5dbdf93a?s=256&d=identicon&r=PG",
      "display_name" : "Luca",
      "link" : "https://stackoverflow.com/users/21040293/luca"
    },
    "creation_date" : 1743469111,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140282706,
    "post_id" : 79545965,
    "body" : "Why are trying with a postesql jdbc driver instead of the specific driver in the first place?",
    "score" : 0,
    "owner" : {
      "account_id" : 372682,
      "reputation" : 26512,
      "user_id" : 721855,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/vZiox.png?s=256",
      "display_name" : "aled",
      "link" : "https://stackoverflow.com/users/721855/aled"
    },
    "creation_date" : 1743428864,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140281882,
    "post_id" : 79545965,
    "body" : "Still I would try the second case trying <i>with</i> a password. Use <code>getConnection(String url, String user, String password)</code> with password <code>&quot;&quot;</code>.",
    "score" : 0,
    "owner" : {
      "account_id" : 960307,
      "reputation" : 110397,
      "user_id" : 984823,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/Z2KYN.jpg?s=256",
      "display_name" : "Joop Eggen",
      "link" : "https://stackoverflow.com/users/984823/joop-eggen"
    },
    "creation_date" : 1743416556,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}