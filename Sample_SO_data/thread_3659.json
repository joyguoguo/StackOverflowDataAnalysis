{
  "question" : {
    "question_id" : 79533594,
    "title" : "File using Office XML Schema no longer reliably opened by Excel",
    "body" : "<p>For many years I have been exporting HTML tables from my web app and downloading them as XSLX so that they will be opened by Excel.</p>\n<pre><code>&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.1//EN&quot; &quot;http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd&quot;&gt;\n&lt;html xmlns:x=&quot;urn:schemas-microsoft-com:office:excel&quot; xmlns:xalan=&quot;http://xml.apache.org/xslt&quot;&gt;\n&lt;head&gt;&lt;/head&gt;\n&lt;body&gt;\n    &lt;table&gt;\n       ...\n    &lt;/table&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n<p>Up until recently this has worked well (ignoring a warning message that the format does not match the file extension).</p>\n<p>I am now getting complaints from users who have &quot;upgraded to Windows 11&quot;. Excel (2016) starts but does not get beyond the splash screen. If I kill the Excel process and try to open the file it may or may not open. It seems very hit or miss and I'm finding it difficult to get a handle on the problem.</p>\n<p>I realise that what I've been doing is not the very best solution but, for me, it was very convenient. I could simply append an Excel icon to the table, handle the click and send the table html to a servlet where it gets wrapped (see above) before downloading.</p>\n<p>What might be causing Excel now to have a problem? What alternatives are there to package an HTML table and to be able to open it in Excel?</p>\n",
    "tags" : [ "java", "excel", "windows", "ms-office" ],
    "owner" : {
      "account_id" : 6642,
      "reputation" : 13582,
      "user_id" : 11249,
      "user_type" : "registered",
      "accept_rate" : 51,
      "profile_image" : "https://i.sstatic.net/B11BF.jpg?s=256",
      "display_name" : "paul",
      "link" : "https://stackoverflow.com/users/11249/paul"
    },
    "is_answered" : true,
    "view_count" : 72,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1742906310,
    "creation_date" : 1742903674,
    "link" : "https://stackoverflow.com/questions/79533594/file-using-office-xml-schema-no-longer-reliably-opened-by-excel",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79533697,
    "question_id" : 79533594,
    "body" : "<p>The only <em>reliable</em> solution is to finally do the HTML to XLSX conversion.</p>\n<p>There is open source code.</p>\n<p>But one can do-it-yourself as .xlsx is a zip format with undermore XML files.</p>\n<p>Edit a template.xslx, rename it to .zip and extract it.</p>\n<ul>\n<li>xl/\n<ul>\n<li>worksheets/\n<ul>\n<li>sheet1.xml</li>\n</ul>\n</li>\n<li>sharedStrings.xml</li>\n</ul>\n</li>\n</ul>\n<p>Unique (!) cell values are stored in <code>sharedStrings.xml</code> and a reference to it is used in <code>sheet1.xml</code>.</p>\n<p>You must program <em>zipping</em> the filled in XMLs again.</p>\n<p>In the past one could also use the SYLK format, and possible one could use an onld XLS/XLSX format that actually is XML but the solution above seems to guarantee more continuity.</p>\n<p>See it as technical debt, sell it as progress.</p>\n",
    "score" : 1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 960307,
      "reputation" : 110397,
      "user_id" : 984823,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/Z2KYN.jpg?s=256",
      "display_name" : "Joop Eggen",
      "link" : "https://stackoverflow.com/users/984823/joop-eggen"
    },
    "creation_date" : 1742906310,
    "last_activity_date" : 1742906310,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : { }
}