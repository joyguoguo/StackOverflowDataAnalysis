{
  "question" : {
    "question_id" : 79571292,
    "title" : "JPA inheritance how to delete parent class when child class is deleted?",
    "body" : "<p>Assume I have two entities</p>\n<pre class=\"lang-kotlin prettyprint-override\"><code>package com.srilakshmikanthanp.assets.notification\n\nimport com.srilakshmikanthanp.assets.notification.assetsurvey.AssetSurveyNotification\nimport com.srilakshmikanthanp.assets.user.User\nimport jakarta.persistence.*\nimport org.hibernate.annotations.*\nimport java.time.Instant\n\n@EntityListeners(NotificationEntityListener::class)\n@Inheritance(strategy = InheritanceType.JOINED)\n@Entity\nclass Notification(\n  @Column(nullable = false)\n  @Id\n  @GeneratedValue(strategy = GenerationType.UUID)\n  var id: String? = null,\n\n  @Column(nullable = false)\n  var title: String,\n\n  @Column(nullable = false)\n  var description: String,\n\n  @Column(nullable = false)\n  var read: Boolean = false,\n\n  @ManyToOne\n  @JoinColumn(name = &quot;recipient_id&quot;, nullable = false)\n  var recipient: User,\n\n  @ManyToOne\n  @JoinColumn(name = &quot;sender_id&quot;, nullable = false)\n  var sender: User,\n\n  @TenantId\n  var organizationId: String? = null,\n\n  @Column(nullable = false, updatable = false)\n  @CreationTimestamp\n  var createdAt: Instant? = null,\n\n  @Column(nullable = false)\n  @UpdateTimestamp\n  var updatedAt: Instant? = null,\n)\n</code></pre>\n<pre class=\"lang-kotlin prettyprint-override\"><code>package com.srilakshmikanthanp.assets.notification.assetsurvey\n\nimport com.srilakshmikanthanp.assets.asset.survey.AssetSurvey\nimport com.srilakshmikanthanp.assets.notification.Notification\nimport com.srilakshmikanthanp.assets.user.User\nimport jakarta.persistence.Entity\nimport jakarta.persistence.JoinColumn\nimport jakarta.persistence.ManyToOne\nimport jakarta.persistence.OneToOne\nimport jakarta.persistence.PreRemove\nimport jakarta.persistence.PrimaryKeyJoinColumn\nimport jakarta.persistence.Table\nimport jakarta.persistence.UniqueConstraint\nimport org.hibernate.annotations.OnDelete\nimport org.hibernate.annotations.OnDeleteAction\nimport java.time.Instant\n\n@Entity\n@PrimaryKeyJoinColumn(name = &quot;notification_id&quot;)\n@Table(uniqueConstraints = [UniqueConstraint(columnNames = [&quot;notification_id&quot;])])\n@OnDelete(action = OnDeleteAction.CASCADE)\nclass AssetSurveyNotification(\n  @ManyToOne\n  @OnDelete(action = OnDeleteAction.CASCADE)\n  @JoinColumn(name = &quot;asset_survey_id&quot;, nullable = false)\n  var survey: AssetSurvey,\n\n  id: String? = null,\n  title: String,\n  description: String,\n  recipient: User,\n  sender: User,\n  read: Boolean = false,\n  createdAt: Instant? = null,\n  updatedAt: Instant? = null,\n) : Notification(\n  id = id,\n  title = title,\n  description = description,\n  recipient = recipient,\n  sender = sender,\n  read = read,\n  createdAt = createdAt,\n  updatedAt = updatedAt\n)\n</code></pre>\n<p>Now when the assetSurvey is deleted it cascades to <code>AssetSurveyNotification</code> but it does not cascades to <code>Notification</code> is there any way to do it? I only put <code>Notification</code> table as a parent due to many type of notification present also for some common API I can simply use base class <code>Notification</code> itself so if I make seperate table for all notification types i may need to duplicate API's based on type. And is the inheritance i am using is okay for my purpose or i need to change this?</p>\n",
    "tags" : [ "java", "spring-boot", "kotlin", "hibernate", "jpa" ],
    "owner" : {
      "account_id" : 16778997,
      "reputation" : 2461,
      "user_id" : 12473258,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/7omnCWpe.png?s=256",
      "display_name" : "srilakshmikanthanp",
      "link" : "https://stackoverflow.com/users/12473258/srilakshmikanthanp"
    },
    "is_answered" : false,
    "view_count" : 74,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1744571889,
    "creation_date" : 1744528609,
    "link" : "https://stackoverflow.com/questions/79571292/jpa-inheritance-how-to-delete-parent-class-when-child-class-is-deleted",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79571664,
    "question_id" : 79571292,
    "body" : "<p>Remove  top level parent instead (where you would like deletion to start) and allow CASCADE to remove child down the graph as well.</p>\n<p>Alternatively make a bidirectional relation mapping and let it cascade the other way around.</p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 1658807,
      "reputation" : 32688,
      "user_id" : 1527544,
      "user_type" : "registered",
      "accept_rate" : 54,
      "profile_image" : "https://www.gravatar.com/avatar/6665878d41d42307eb53e9fae311a471?s=256&d=identicon&r=PG",
      "display_name" : "Antoniossss",
      "link" : "https://stackoverflow.com/users/1527544/antoniossss"
    },
    "creation_date" : 1744554963,
    "last_activity_date" : 1744571889,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140329971,
    "post_id" : 79571292,
    "body" : "Or else is creating assetSurvey with default uuid like 00000000-0000-0000-0000-000000000000 and upon delete set to this uuid and handle this survey specially instead of deleting notification? is that okay?",
    "score" : 0,
    "owner" : {
      "account_id" : 16778997,
      "reputation" : 2461,
      "user_id" : 12473258,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/7omnCWpe.png?s=256",
      "display_name" : "srilakshmikanthanp",
      "link" : "https://stackoverflow.com/users/12473258/srilakshmikanthanp"
    },
    "creation_date" : 1744550361,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79571664" : [ {
      "comment_id" : 140330707,
      "post_id" : 79571664,
      "body" : "Read again my answer.",
      "score" : 0,
      "owner" : {
        "account_id" : 1658807,
        "reputation" : 32688,
        "user_id" : 1527544,
        "user_type" : "registered",
        "accept_rate" : 54,
        "profile_image" : "https://www.gravatar.com/avatar/6665878d41d42307eb53e9fae311a471?s=256&d=identicon&r=PG",
        "display_name" : "Antoniossss",
        "link" : "https://stackoverflow.com/users/1527544/antoniossss"
      },
      "creation_date" : 1744571873,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140330281,
      "post_id" : 79571664,
      "body" : "Since asset survey is present in child table when assetSurvey deleted then the delete startes from child table only",
      "score" : 0,
      "owner" : {
        "account_id" : 16778997,
        "reputation" : 2461,
        "user_id" : 12473258,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/7omnCWpe.png?s=256",
        "display_name" : "srilakshmikanthanp",
        "link" : "https://stackoverflow.com/users/12473258/srilakshmikanthanp"
      },
      "creation_date" : 1744559578,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}