{
  "question" : {
    "question_id" : 79694867,
    "title" : "How to get the value and stop the JS-execution?",
    "body" : "<p>I want to get a value that is generated by JavaScript-code and is available in the HTTP-header of a request. Then I want to continue with that <code>webClient</code> as it has cookies and resources loaded.</p>\n<p>I don't know what the best practice is to stop the whole execution of JavaScript and have it ready afterwards. If I don't stop it, the JavaScript of the page keeps going, even though I have no use for it.</p>\n<p>I know of <code>webClient.waitForBackgroundJavaScript()</code>, but that would keep going until the timeout is over. However, I only want the value and from what I can tell the order of the Ajax-calls are rather random and have no timing for it. So I really have to wait for the value to appear.</p>\n<p>This is my code so far:</p>\n<pre><code>public String getValueFromWeb throws Exception {\n  BlockingQueue&lt;String&gt; valueCatcher = new ArrayBlockingQueue&lt;&gt;(1);\n  WebClient webClient = new WebClient();\n  WebConnection webConnection = webClient.getWebConnection();\n  webClient.setWebConnection(new WebConnection() {\n\n    @Override\n    public WebResponse getResponse(WebRequest request) throws IOException {\n      if (...) {                                                     // (2)\n        valueCatcher.add(&quot;&lt;grabbed value&gt;&quot;);\n        webClient.getJavaScriptEngine().shutdown();\n      }\n\n      return webConnection.getResponse(request);\n    }\n\n    @Override\n    public void close() throws IOException {\n      webConnection.close();\n    }\n\n  });\n\n  Page page = webClient.getPage(...);\n\n  String result = valueCatcher.take();                               // (1)\n  webClient.setJavaScriptEngine(new JavaScriptEngine(webClient));\n\n  // do another webClient.getPage(...)\n  ...\n}\n</code></pre>\n<p>So the execution of Java &quot;pauses&quot; at (1). At (2) I check if I'm at the right request and send the value back to (1). The JS-engine should be restarted and ready to continue.</p>\n<p>Does anyone have a better approach? Or maybe I'm missing something?</p>\n",
    "tags" : [ "javascript", "java", "htmlunit" ],
    "owner" : {
      "account_id" : 223715,
      "reputation" : 12995,
      "user_id" : 483113,
      "user_type" : "registered",
      "accept_rate" : 89,
      "profile_image" : "https://www.gravatar.com/avatar/5e6ce1def86e084cf06ac3a5a7e2d74f?s=256&d=identicon&r=PG",
      "display_name" : "sjngm",
      "link" : "https://stackoverflow.com/users/483113/sjngm"
    },
    "is_answered" : false,
    "view_count" : 97,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1752092600,
    "creation_date" : 1752011644,
    "link" : "https://stackoverflow.com/questions/79694867/how-to-get-the-value-and-stop-the-js-execution",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140580171,
    "post_id" : 79694867,
    "body" : "@browsermator Oh, thanks. I must have overlooked that.",
    "score" : 0,
    "owner" : {
      "account_id" : 223715,
      "reputation" : 12995,
      "user_id" : 483113,
      "user_type" : "registered",
      "accept_rate" : 89,
      "profile_image" : "https://www.gravatar.com/avatar/5e6ce1def86e084cf06ac3a5a7e2d74f?s=256&d=identicon&r=PG",
      "display_name" : "sjngm",
      "link" : "https://stackoverflow.com/users/483113/sjngm"
    },
    "creation_date" : 1752159154,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140577900,
    "post_id" : 79694867,
    "body" : "this is Java code, no?  (You should probably add that tag...) If the content you need is loaded after a standard page load via javascript, you need to wait for it.  Remember that HTMLUnit is basically a browser without a gui.  So create a polling loop that exits when you find the thing you need.  A for loop with a &quot;break&quot; statement... and a sleep... i.e. page.wait(milliseconds)...  there&#39;s an example here: <a href=\"https://htmlunit.sourceforge.io/faq.html\" rel=\"nofollow noreferrer\">htmlunit.sourceforge.io/faq.html</a>  You never want to &quot;stop the javascript engine&quot;.  It&#39;s not necessary, though you could easily navigate to another page to do that.",
    "score" : 0,
    "owner" : {
      "account_id" : 6077817,
      "reputation" : 1362,
      "user_id" : 4744568,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/125cdb7d43927756913b920de016f420?s=256&d=identicon&r=PG",
      "display_name" : "browsermator",
      "link" : "https://stackoverflow.com/users/4744568/browsermator"
    },
    "creation_date" : 1752088833,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140577586,
    "post_id" : 79694867,
    "body" : "@DarkBee Thanks for the link. I downvoted the answer claiming that missing tags make sense and upvoted the comment under the question and the answer that shows that tags in titles do make a lot of sense.",
    "score" : 0,
    "owner" : {
      "account_id" : 223715,
      "reputation" : 12995,
      "user_id" : 483113,
      "user_type" : "registered",
      "accept_rate" : 89,
      "profile_image" : "https://www.gravatar.com/avatar/5e6ce1def86e084cf06ac3a5a7e2d74f?s=256&d=identicon&r=PG",
      "display_name" : "sjngm",
      "link" : "https://stackoverflow.com/users/483113/sjngm"
    },
    "creation_date" : 1752080312,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140576286,
    "post_id" : 79694867,
    "body" : "<a href=\"https://meta.stackexchange.com/questions/19190/should-questions-include-tags-in-their-titles\">Should questions include &quot;tags&quot; in their titles?</a>",
    "score" : 0,
    "owner" : {
      "account_id" : 200632,
      "reputation" : 14424,
      "user_id" : 446594,
      "user_type" : "registered",
      "accept_rate" : 83,
      "profile_image" : "https://www.gravatar.com/avatar/265aa3b3b575f011c853fc00f41eccfb?s=256&d=identicon&r=PG",
      "display_name" : "DarkBee",
      "link" : "https://stackoverflow.com/users/446594/darkbee"
    },
    "creation_date" : 1752054475,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}