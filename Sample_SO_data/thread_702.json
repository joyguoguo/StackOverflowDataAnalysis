{
  "question" : {
    "question_id" : 79780075,
    "title" : "How to log information indicating that the camel JpaComponent started",
    "body" : "<p>I am using a camel route defined in xml. The route starts from this step:</p>\n<pre><code>&lt;camel:route id=&quot;jpaRoute&quot; routePolicyRef=&quot;startPolicy&quot;&gt;\n    &lt;camel:from uri=&quot;jpa://?persistenceUnit=po&amp;amp;initialDelay={{query.initialDelay}}&amp;amp;delay={{query.delay}}&amp;amp;nativeQuery=select v.* from APP v&amp;amp;resultClass=App&quot;/&gt;\n    &lt;!--  Map --&gt;\n    &lt;camel:bean ref=&quot;mapper&quot; method=&quot;map&quot;/&gt;\n    &lt;camel:to uri=&quot;direct:routestep2-entry&quot;/&gt;\n    &lt;!-- aggregate only to log information when poll finished --&gt;\n    &lt;camel:aggregate strategyRef=&quot;groupedBodyAggregationStrategy&quot; completionTimeout=&quot;2000000&quot;&gt;\n        &lt;camel:correlationExpression&gt;\n            &lt;camel:constant&gt;true&lt;/camel:constant&gt;\n        &lt;/camel:correlationExpression&gt;\n        &lt;camel:log message=&quot;✅  Finished processing &quot; loggingLevel=&quot;INFO&quot; logName=&quot;route&quot;/&gt;\n    &lt;/camel:aggregate&gt;\n&lt;/camel:route&gt;\n</code></pre>\n<p>What this step does is</p>\n<ol>\n<li>fetch all entities from table APP</li>\n<li>map them one by one</li>\n<li>emitt them one by one to the next step of the route :&quot;routestep2-entry&quot;</li>\n<li>after all entities will be processed log a message: &quot;✅  Finished processing&quot;</li>\n<li>process waits <code>{{query.delay}}</code> and then repeats again</li>\n</ol>\n<p>I would lso like to add a  message :</p>\n<pre><code>&lt;camel:log message=&quot;▶️ Started processing &quot; loggingLevel=&quot;INFO&quot; logName=&quot;route&quot;/&gt;\n</code></pre>\n<p>which will be logged on the start of the route, either before the SELECT is being done, or just after the SELECT.\nSo the whole output will be like:</p>\n<pre><code>▶️ Started processing \nmap app 1\nmap app 2\nmap app n\n✅  Finished processing \n</code></pre>\n<p>I cannot add <code>&lt;camel:log</code> before the <code>&lt;camel:from</code>. And if I add the <code>&lt;camel:log</code> just after <code>&lt;camel:from</code> then this log will be outputed n times instead of only once.</p>\n<p>How can I log a message indicating that the <code>jpaRoute</code> has started?</p>\n",
    "tags" : [ "java", "spring", "jpa", "logging", "apache-camel" ],
    "owner" : {
      "account_id" : 306540,
      "reputation" : 3196,
      "user_id" : 2695990,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/EVYyd.jpg?s=256",
      "display_name" : "fascynacja",
      "link" : "https://stackoverflow.com/users/2695990/fascynacja"
    },
    "is_answered" : false,
    "view_count" : 52,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1765191523,
    "creation_date" : 1759323233,
    "link" : "https://stackoverflow.com/questions/79780075/how-to-log-information-indicating-that-the-camel-jpacomponent-started",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79840831,
    "question_id" : 79780075,
    "body" : "<p>You should refactor your route to trigger the polling using a timer.</p>\n<p>For example</p>\n<pre><code>from(timer(&quot;jpaPoller&quot;).period(3000))\n  .log(&quot;&gt;&gt; pollingStart&quot;)\n  .enrich(jpa(&quot;OpcConfig&quot;).namedQuery(&quot;fetchAll&quot;))\n  .log(&quot;&gt;&gt; Polled data ${body}&quot;);\n</code></pre>\n<p>In this way every time the poller starts, you log, execute JPA named query and then log the results.</p>\n<p>If instead you only want to log when the poller is started, custom log is not possible but Camel already log when a route is ready to produce Exchanges</p>\n<p><a href=\"https://i.sstatic.net/jtEvXpMF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/jtEvXpMF.png\" alt=\"enter image description here\" /></a></p>\n<p>In xml the equivalent components are <strong>timer</strong></p>\n<pre><code>&lt;route&gt;\n  &lt;from uri=&quot;timer://foo?fixedRate=true&amp;amp;period=60000&quot;/&gt;\n  &lt;to uri=&quot;bean:myBean?method=someMethodName&quot;/&gt;\n&lt;/route&gt;\n</code></pre>\n<p>and <strong>content enricher</strong></p>\n<pre><code>&lt;route&gt;\n    &lt;from uri=&quot;direct:start&quot;/&gt;\n    &lt;enrich&gt;\n        &lt;constant&gt;http:remoteserver/foo&lt;/constant&gt;\n    &lt;/enrich&gt;\n    &lt;to uri=&quot;mock:result&quot;/&gt;\n&lt;/route&gt;\n</code></pre>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 2169561,
      "reputation" : 160,
      "user_id" : 1921923,
      "user_type" : "registered",
      "accept_rate" : 75,
      "profile_image" : "https://www.gravatar.com/avatar/65463ba36540580415c83125a605954e?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "betelgeuse",
      "link" : "https://stackoverflow.com/users/1921923/betelgeuse"
    },
    "creation_date" : 1765189675,
    "last_activity_date" : 1765191523,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : {
    "79840831" : [ {
      "comment_id" : 140892356,
      "post_id" : 79840831,
      "body" : "could you please apply this solution to the xml code which I have posted?",
      "score" : 0,
      "owner" : {
        "account_id" : 306540,
        "reputation" : 3196,
        "user_id" : 2695990,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/EVYyd.jpg?s=256",
        "display_name" : "fascynacja",
        "link" : "https://stackoverflow.com/users/2695990/fascynacja"
      },
      "creation_date" : 1765190502,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}