{
  "question" : {
    "question_id" : 79622426,
    "title" : "Can Duration.isZero() return false and yet Duration.toMillis() returns zero?",
    "body" : "<p>In order to calculate a wait() duration, we do some math on Durations:</p>\n<pre><code>   Instant start = Instant.now();\n   while(!exiting) {\n       synchronized(waitObject)\n       {\n           Duration toWait = TOTAL_WAIT_TIME.minus(Duration.between(start, Instant.now()));\n           if (!toWait.isNegative() &amp;&amp; !toWait.isZero() {\n               waitObject.wait(toWait.toMillis());\n           }\n       }\n   }\n</code></pre>\n<p>Obviously there's more in this code, but that distills it to its basics for this question.</p>\n<p>What we are seeing in our testing is that the argument being passed into wait() can be zero.</p>\n",
    "tags" : [ "java" ],
    "owner" : {
      "account_id" : 7836,
      "reputation" : 17079,
      "user_id" : 13757,
      "user_type" : "registered",
      "accept_rate" : 74,
      "profile_image" : "https://www.gravatar.com/avatar/41085512e87315f1338030adb6535f78?s=256&d=identicon&r=PG",
      "display_name" : "nsayer",
      "link" : "https://stackoverflow.com/users/13757/nsayer"
    },
    "is_answered" : true,
    "view_count" : 95,
    "answer_count" : 1,
    "score" : 2,
    "last_activity_date" : 1747295944,
    "creation_date" : 1747266266,
    "link" : "https://stackoverflow.com/questions/79622426/can-duration-iszero-return-false-and-yet-duration-tomillis-returns-zero",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79622453,
    "question_id" : 79622426,
    "body" : "<p>This demonstrates your observation:</p>\n<pre><code>public class Main\n{\n    public static void main(String[] args) {\n\n        Duration d = Duration.ofNanos(1);\n        System.out.println(&quot;isZero=&quot; + d.isZero());\n        System.out.println(&quot;toMillis=&quot; + d.toMillis());\n    }\n}\n</code></pre>\n<p>Output:</p>\n<pre><code>isZero=false\ntoMillis=0\n</code></pre>\n<p>Relevant docs from <code>toMillis</code>:</p>\n<blockquote>\n<p>If this duration has greater than millisecond precision, then the conversion\nwill drop any excess precision information as though the amount in nanoseconds\nwas subject to integer division by one million.</p>\n</blockquote>\n",
    "score" : 8,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 3212023,
      "reputation" : 1614,
      "user_id" : 17856705,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/OoOsD.png?s=256",
      "display_name" : "Computable",
      "link" : "https://stackoverflow.com/users/17856705/computable"
    },
    "creation_date" : 1747268727,
    "last_activity_date" : 1747268727,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140432152,
    "post_id" : 79622426,
    "body" : "@VGR If I understand the issue here, merely being positive is not enough to insure toMillis() returns &gt; 0.",
    "score" : 0,
    "owner" : {
      "account_id" : 7836,
      "reputation" : 17079,
      "user_id" : 13757,
      "user_type" : "registered",
      "accept_rate" : 74,
      "profile_image" : "https://www.gravatar.com/avatar/41085512e87315f1338030adb6535f78?s=256&d=identicon&r=PG",
      "display_name" : "nsayer",
      "link" : "https://stackoverflow.com/users/13757/nsayer"
    },
    "creation_date" : 1747397534,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140428252,
    "post_id" : 79622426,
    "body" : "Duration now has an <a href=\"https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/time/Duration.html#isPositive()\" rel=\"nofollow noreferrer\">isPositive()</a> method, by the way.",
    "score" : 0,
    "owner" : {
      "account_id" : 2053598,
      "reputation" : 44936,
      "user_id" : 1831987,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/38b1c37530189ec4471a43a618e33f67?s=256&d=identicon&r=PG",
      "display_name" : "VGR",
      "link" : "https://stackoverflow.com/users/1831987/vgr"
    },
    "creation_date" : 1747304856,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140427061,
    "post_id" : 79622426,
    "body" : "Yes, if the duration is less than a millisecond but greater than zero.",
    "score" : 3,
    "owner" : {
      "account_id" : 71739,
      "reputation" : 311869,
      "user_id" : 207421,
      "user_type" : "registered",
      "accept_rate" : 82,
      "profile_image" : "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=256&d=identicon&r=PG",
      "display_name" : "user207421",
      "link" : "https://stackoverflow.com/users/207421/user207421"
    },
    "creation_date" : 1747270807,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140426985,
    "post_id" : 79622426,
    "body" : "A duration can have &gt; millisecond precision, iirc, so itâ€™d depend on what toMillis does with wee durations, I guess.",
    "score" : 3,
    "owner" : {
      "account_id" : 195854,
      "reputation" : 160525,
      "user_id" : 438992,
      "user_type" : "registered",
      "accept_rate" : 90,
      "profile_image" : "https://i.sstatic.net/QouOz.jpg?s=256",
      "display_name" : "Dave Newton",
      "link" : "https://stackoverflow.com/users/438992/dave-newton"
    },
    "creation_date" : 1747267832,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}