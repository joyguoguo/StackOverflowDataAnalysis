{
  "question" : {
    "question_id" : 79723280,
    "title" : "WebLogic 12c Foreign Server fails to authenticate with WildFly 26 JMS: JMSSecurityException (Username: null)",
    "body" : "<p>I have a Java application running on <strong>WebLogic 12c</strong> that sends JMS messages. We're trying to configure it to send messages to a <strong>remote JMS queue on a WildFly 26</strong> server.</p>\n<p>When we attempt to send a message, we receive the following error in both <strong>WebLogic</strong> and <strong>WildFly</strong> logs:</p>\n<p><code>javax.jms.JMSSecurityException: AMQ229031: Unable to validate user from /host:port. Username: null; SSL certificate subject DN: unavailable</code></p>\n<p>It seems the problem is related to <strong>authentication on the connection factory</strong> used by WebLogic. I can't figure out how or where to correctly set the <strong>username and password</strong> so that WebLogic passes them to WildFly.</p>\n<hr />\n<h3>WildFly Configuration</h3>\n<p>Below is the relevant part of my <code>standalone-full.xml</code> configuration (ActiveMQ subsystem):</p>\n<pre class=\"lang-xml prettyprint-override\"><code>        &lt;subsystem xmlns=&quot;urn:jboss:domain:messaging-activemq:13.1&quot;&gt;\n            &lt;server name=&quot;default&quot;&gt;\n                &lt;security elytron-domain=&quot;ApplicationDomain&quot;/&gt;\n                &lt;statistics enabled=&quot;${wildfly.messaging-activemq.statistics-enabled:${wildfly.statistics-enabled:false}}&quot;/&gt;\n                &lt;security-setting name=&quot;#&quot;&gt;\n                    &lt;role name=&quot;userApplication&quot; send=&quot;true&quot; consume=&quot;true&quot; create-non-durable-queue=&quot;true&quot; delete-non-durable-queue=&quot;true&quot;/&gt;\n                &lt;/security-setting&gt;\n                &lt;address-setting name=&quot;#&quot; dead-letter-address=&quot;jms.queue.DLQ&quot; expiry-address=&quot;jms.queue.ExpiryQueue&quot; max-size-bytes=&quot;10485760&quot; page-size-bytes=&quot;2097152&quot; message-counter-history-day-limit=&quot;10&quot;/&gt;\n                &lt;http-connector name=&quot;http-connector&quot; socket-binding=&quot;http&quot; endpoint=&quot;http-acceptor&quot;/&gt;\n                &lt;http-connector name=&quot;http-connector-throughput&quot; socket-binding=&quot;http&quot; endpoint=&quot;http-acceptor-throughput&quot;&gt;\n                    &lt;param name=&quot;batch-delay&quot; value=&quot;50&quot;/&gt;\n                &lt;/http-connector&gt;\n                &lt;in-vm-connector name=&quot;in-vm&quot; server-id=&quot;0&quot;&gt;\n                    &lt;param name=&quot;buffer-pooling&quot; value=&quot;false&quot;/&gt;\n                &lt;/in-vm-connector&gt;\n                &lt;remote-connector name=&quot;netty-connector&quot; socket-binding=&quot;messaging&quot;/&gt;\n                &lt;acceptor name=&quot;netty-acceptor&quot; factory-class=&quot;org.apache.activemq.artemis.core.remoting.impl.netty.NettyAcceptorFactory&quot; socket-binding=&quot;messaging&quot;/&gt;\n                &lt;http-acceptor name=&quot;http-acceptor&quot; http-listener=&quot;default&quot;/&gt;\n                &lt;http-acceptor name=&quot;http-acceptor-throughput&quot; http-listener=&quot;default&quot;&gt;\n                    &lt;param name=&quot;batch-delay&quot; value=&quot;50&quot;/&gt;\n                    &lt;param name=&quot;direct-deliver&quot; value=&quot;false&quot;/&gt;\n                &lt;/http-acceptor&gt;\n                &lt;in-vm-acceptor name=&quot;in-vm&quot; server-id=&quot;0&quot;&gt;\n                    &lt;param name=&quot;buffer-pooling&quot; value=&quot;false&quot;/&gt;\n                &lt;/in-vm-acceptor&gt;               \n                &lt;jms-queue name=&quot;ExpiryQueue&quot; entries=&quot;java:/jms/queue/ExpiryQueue&quot;/&gt;\n                &lt;jms-queue name=&quot;DLQ&quot; entries=&quot;java:/jms/queue/DLQ&quot;/&gt;\n                &lt;jms-queue name=&quot;testQueueWildflyToWls&quot; entries=&quot;java:jboss/exported/jms/queue/testQueue_wildfy_to_wls&quot;/&gt;\n                &lt;jms-queue name=&quot;testQueueWlsToWildfly&quot; entries=&quot;java:jboss/exported/jms/queue/testQueue_wls_to_wildfly&quot;/&gt;\n                &lt;connection-factory name=&quot;InVmConnectionFactory&quot; entries=&quot;java:/ConnectionFactory&quot; connectors=&quot;in-vm&quot;/&gt;\n                &lt;connection-factory name=&quot;RemoteConnectionFactory&quot; entries=&quot;java:jboss/exported/jms/RemoteConnectionFactory&quot; connectors=&quot;http-connector&quot;/&gt;\n                &lt;connection-factory name=&quot;RemoteTcpConnectionFactory&quot; entries=&quot;java:jboss/exported/jms/RemoteTcpConnectionFactory&quot; connectors=&quot;netty-connector&quot;/&gt;\n                &lt;pooled-connection-factory name=&quot;activemq-ra&quot; entries=&quot;java:/JmsXA java:jboss/DefaultJMSConnectionFactory&quot; connectors=&quot;in-vm&quot; transaction=&quot;xa&quot;/&gt;\n            &lt;/server&gt;\n        &lt;/subsystem&gt;\n\n\n&lt;!-- Other configurations --&gt;\n\n    &lt;socket-binding-group name=&quot;standard-sockets&quot; default-interface=&quot;public&quot; port-offset=&quot;${jboss.socket.binding.port-offset:0}&quot;&gt;\n        &lt;socket-binding name=&quot;ajp&quot; port=&quot;${jboss.ajp.port:8009}&quot;/&gt;\n        &lt;socket-binding name=&quot;messaging&quot; port=&quot;61616&quot;/&gt;\n        &lt;socket-binding name=&quot;http&quot; port=&quot;${jboss.http.port:8088}&quot;/&gt;\n        &lt;socket-binding name=&quot;https&quot; port=&quot;${jboss.https.port:8443}&quot;/&gt;\n        &lt;socket-binding name=&quot;iiop&quot; interface=&quot;unsecure&quot; port=&quot;3528&quot;/&gt;\n        &lt;socket-binding name=&quot;iiop-ssl&quot; interface=&quot;unsecure&quot; port=&quot;3529&quot;/&gt;\n        &lt;socket-binding name=&quot;management-http&quot; interface=&quot;management&quot; port=&quot;${jboss.management.http.port:9990}&quot;/&gt;\n        &lt;socket-binding name=&quot;management-https&quot; interface=&quot;management&quot; port=&quot;${jboss.management.https.port:9993}&quot;/&gt;\n        &lt;socket-binding name=&quot;txn-recovery-environment&quot; port=&quot;4712&quot;/&gt;\n        &lt;socket-binding name=&quot;txn-status-manager&quot; port=&quot;4713&quot;/&gt;\n        &lt;outbound-socket-binding name=&quot;mail-smtp&quot;&gt;\n            &lt;remote-destination host=&quot;${jboss.mail.server.host:localhost}&quot; port=&quot;${jboss.mail.server.port:25}&quot;/&gt;\n        &lt;/outbound-socket-binding&gt;\n    &lt;/socket-binding-group&gt;\n\n</code></pre>\n<hr />\n<h3>WebLogic Configuration</h3>\n<p>Foreign Server configuration:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>    &lt;foreign-server name=&quot;ForeignServer&quot;&gt;\n    &lt;default-targeting-enabled&gt;true&lt;/default-targeting-enabled&gt;\n    &lt;foreign-destination name=&quot;remoteQueueWlsToWildfly&quot;&gt;\n        &lt;local-jndi-name&gt;jms/app/remoteQueueWlsToWildfly&lt;/local-jndi-name&gt;\n        &lt;remote-jndi-name&gt;jms/queue/testQueue_wls_to_wildfly&lt;/remote-jndi-name&gt;\n    &lt;/foreign-destination&gt;\n    &lt;foreign-destination name=&quot;remoteQueueWildflyToWls&quot;&gt;\n        &lt;local-jndi-name&gt;jms/app/remoteQueueWildflyToWls&lt;/local-jndi-name&gt;\n        &lt;remote-jndi-name&gt;jms/queue/testQueue_wildfy_to_wls&lt;/remote-jndi-name&gt;\n    &lt;/foreign-destination&gt;\n    &lt;foreign-connection-factory name=&quot;WildflyConnectionFactory&quot;&gt;\n        &lt;local-jndi-name&gt;jms/app/remoteFactory&lt;/local-jndi-name&gt;\n        &lt;remote-jndi-name&gt;jms/RemoteConnectionFactory&lt;/remote-jndi-name&gt;\n        &lt;username&gt;userApplication&lt;/username&gt;\n        &lt;password-encrypted&gt;{AES}******************&lt;/password-encrypted&gt;\n        &lt;connection-health-checking&gt;enabled&lt;/connection-health-checking&gt;\n    &lt;/foreign-connection-factory&gt;\n    &lt;initial-context-factory&gt;org.wildfly.naming.client.WildFlyInitialContextFactory&lt;/initial-context-factory&gt;\n    &lt;connection-url&gt;http-remoting://localhost:8088&lt;/connection-url&gt;\n    &lt;jndi-properties-credential-encrypted&gt;{AES}*********************&lt;/jndi-properties-credential-encrypted&gt;\n    &lt;jndi-property&gt;\n        &lt;key&gt;jboss.naming.client.ejb.context&lt;/key&gt;\n        &lt;value&gt;true&lt;/value&gt;\n    &lt;/jndi-property&gt;\n    &lt;jndi-property&gt;\n        &lt;key&gt;java.naming.security.principal&lt;/key&gt;\n        &lt;value&gt;userApplication&lt;/value&gt;\n    &lt;/jndi-property&gt;\n&lt;/foreign-server&gt;\n\n</code></pre>\n<p>How can I configure WebLogic 12c to send the username and password when connecting to a remote JMS queue on WildFly 26? Ideally, I want to do this through Foreign Server configuration or another method that does not require changes to application code.</p>\n<hr />\n<h3>What I've Tried:</h3>\n<ul>\n<li>Created a <strong>TCP port</strong> for messaging on WildFly and changed WebLogic’s connection URL from <code>http-remoting</code> to <code>tcp</code>, but the same error occurred.</li>\n<li>Configured a <strong>WebLogic JMS Bridge</strong> instead of a Foreign Server, but the error persisted.</li>\n<li>✅ Tested with a <strong>simple standalone Java application (on Tomcat)</strong> where I passed the username and password manually using a constructor — and it <strong>worked</strong>, proving WildFly’s authentication is correctly configured.</li>\n<li>✅ <strong>Disabled Elytron authentication</strong> on WildFly using <code>&lt;security elytron-domain=&quot;ApplicationDomain&quot; enabled=&quot;false&quot;/&gt;</code> — and the connection worked, confirming the connection factory and JNDI setup are correct.</li>\n</ul>\n",
    "tags" : [ "java", "authentication", "jms", "weblogic12c", "wildfly-26" ],
    "owner" : {
      "account_id" : 32177011,
      "reputation" : 11,
      "user_id" : 24974316,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/1bcbf02b646c01a480c00a596d91b5da?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "vz1654056",
      "link" : "https://stackoverflow.com/users/24974316/vz1654056"
    },
    "is_answered" : true,
    "view_count" : 117,
    "answer_count" : 1,
    "score" : 1,
    "last_activity_date" : 1755652690,
    "creation_date" : 1754130204,
    "link" : "https://stackoverflow.com/questions/79723280/weblogic-12c-foreign-server-fails-to-authenticate-with-wildfly-26-jms-jmssecuri",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79740544,
    "question_id" : 79723280,
    "body" : "<h3>TL;DR</h3>\n<p>Don’t create the <code>ConnectionFactory</code> manually in code.<br />\nInstead, inject it with <code>@Resource</code> so WebLogic uses the credentials from the Foreign Server configuration.</p>\n<hr />\n<p>I was able to find the root cause for this a few weeks ago, and now I’m taking the time to close this topic.</p>\n<p>The issue was actually in the <strong>application source code</strong>, which I was initially trying to avoid changing.</p>\n<p>The application was creating the <code>ConnectionFactory</code> like this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public static void sendMessage(final Object msg, final String queueName) throws Exception {\n    String connectionFactoryName = &quot;ConnectionFactoryName&quot;;\n    ServiceLocator sl = ServiceLocatorFactory.getServiceLocator(queues);\n    \n    try {\n        QueueConnectionFactory connectionFactory = sl.getQueueConnectionFactory(connectionFactoryName);\n        QueueConnection connection = connectionFactory.createQueueConnection();\n\n        [...]\n    }\n}\n</code></pre>\n<p>When I changed the line to explicitly provide <strong>username</strong> and <strong>password</strong>:</p>\n<pre class=\"lang-java prettyprint-override\"><code>QueueConnection connection = connectionFactory.createQueueConnection(&quot;user&quot;, &quot;password&quot;);\n</code></pre>\n<p>the connection was authenticated successfully.</p>\n<hr />\n<p>So, when you create a ConnectionFactory directly in code without passing user and password as arguments, the application will still retrieve all configuration from the Foreign Server (such as Remote JNDI and Remote ConnectionFactory), except the user/password values defined there.</p>\n<hr />\n<p><strong>Final Fix</strong></p>\n<p>The real fix was to avoid creating the ConnectionFactory in code at all.\nInstead, I injected it directly into the MDB EJB using @Resource. This way, the application receives the complete ConnectionFactory with the authentication provided inside the Foreign Server:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Resource(lookup = &quot;jms/app/remoteFactory&quot;)\nprivate QueueConnectionFactory connectionFactory;\n</code></pre>\n",
    "score" : 0,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 32177011,
      "reputation" : 11,
      "user_id" : 24974316,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/1bcbf02b646c01a480c00a596d91b5da?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "vz1654056",
      "link" : "https://stackoverflow.com/users/24974316/vz1654056"
    },
    "creation_date" : 1755652690,
    "last_activity_date" : 1755652690,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140637963,
    "post_id" : 79723280,
    "body" : "Hi @ElliottFrisch, thank you for your help!  I tried adding those system properties directly to the WebLogic server startup arguments, but unfortunately, I still received the same error: AMQ229031.  I also tested these properties with a simple JMS client application (which works when I hardcode the username and password), but when I removed the credentials from the code and relied solely on the system properties, I got the same error.  It seems like WebLogic doesn’t pass the username/password from system properties at all, unless they&#39;re explicitly set in the source code.",
    "score" : 0,
    "owner" : {
      "account_id" : 32177011,
      "reputation" : 11,
      "user_id" : 24974316,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/1bcbf02b646c01a480c00a596d91b5da?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "vz1654056",
      "link" : "https://stackoverflow.com/users/24974316/vz1654056"
    },
    "creation_date" : 1754170402,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140637439,
    "post_id" : 79723280,
    "body" : "Can you try running with <code>-Dremote.connection.default.username</code> and <code>-Dremote.connection.default.password</code>?",
    "score" : 0,
    "owner" : {
      "account_id" : 3557625,
      "reputation" : 201916,
      "user_id" : 2970947,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/HLTev.png?s=256",
      "display_name" : "Elliott Frisch",
      "link" : "https://stackoverflow.com/users/2970947/elliott-frisch"
    },
    "creation_date" : 1754142761,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}