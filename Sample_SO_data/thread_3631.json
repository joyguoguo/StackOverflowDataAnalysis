{
  "question" : {
    "question_id" : 79535787,
    "title" : "Logback not compressing sparse logs when app restarts often",
    "body" : "<p>My app logging with logback does not compress my log into the configured .gz file.</p>\n<p>This is a fairly sparse audit log, which during quiet periods is only written once or twice per hour. I suspect, because we deploy many times a day, it can happen that the application is redeployed before an event triggering log rollover arrives and I end up with files not being compressed.</p>\n<p>The appender is configured to roll every hour:</p>\n<pre><code>&lt;appender name=&quot;AUDIT-FILE&quot; class=&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;&gt;\n    &lt;filter class=&quot;ch.qos.logback.classic.filter.ThresholdFilter&quot;&gt;\n        &lt;level&gt;INFO&lt;/level&gt;\n    &lt;/filter&gt;\n    &lt;rollingPolicy class=&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;&gt;\n        &lt;fileNamePattern&gt;${LOG_ROOT}/audit/%d{yyyy-MM, UTC, aux}/%d{yyyy-MM-dd_HH, UTC}-service-audit.log.gz&lt;/fileNamePattern&gt;\n    &lt;/rollingPolicy&gt;\n    &lt;encoder class=&quot;ch.qos.logback.classic.encoder.PatternLayoutEncoder&quot;&gt;\n        &lt;pattern&gt;%d{yyyy-MM-dd HH:mm:ss.SSS} %msg%n&lt;/pattern&gt;\n    &lt;/encoder&gt;\n&lt;/appender&gt;\n</code></pre>\n<p>The configuration is picked up correctly:</p>\n<pre><code>INFO in ch.qos.logback.core.model.processor.AppenderModelHandler - Processing appender named [AUDIT-FILE]\nINFO in ch.qos.logback.core.model.processor.AppenderModelHandler - About to instantiate appender of type [ch.qos.logback.core.rolling.RollingFileAppender]\nINFO in ch.qos.logback.core.model.processor.ModelInterpretationContext@4b741d6d - value &quot;/opt/sf/logs/audit/%d{yyyy-MM, UTC, aux}/%d{yyyy-MM-dd_HH, UTC}-service-audit.log.gz&quot; substituted for &quot;${LOG_ROOT}/audit/%d{yyyy-MM, UTC, aux}/%d{yyyy-MM-dd_HH, UTC}-service-audit.log.gz&quot;\nINFO in c.q.l.core.rolling.TimeBasedRollingPolicy@1856158867 - Will use gz compression\nINFO in c.q.l.core.rolling.TimeBasedRollingPolicy@1856158867 - Will use the pattern /opt/sf/logs/audit/%d{yyyy-MM, UTC, aux}/%d{yyyy-MM-dd_HH, UTC}-service-audit.log for the active file\nINFO in c.q.l.core.rolling.DefaultTimeBasedFileNamingAndTriggeringPolicy - The date pattern is 'yyyy-MM-dd_HH' from file name pattern '/opt/sf/logs/audit/%d{yyyy-MM, UTC, aux}/%d{yyyy-MM-dd_HH, UTC}-service-audit.log.gz'.\nINFO in c.q.l.core.rolling.DefaultTimeBasedFileNamingAndTriggeringPolicy - Roll-over at the top of every hour.\nINFO in c.q.l.core.rolling.DefaultTimeBasedFileNamingAndTriggeringPolicy - Setting initial period to 2025-03-25T17:28:48.413Z\nINFO in ch.qos.logback.core.rolling.RollingFileAppender[AUDIT-FILE] - Active log file name: /opt/sf/logs/audit/2025-03/2025-03-25_17-service-audit.log\nNFO in ch.qos.logback.core.rolling.RollingFileAppender[AUDIT-FILE] - File property is set to [null]\n</code></pre>\n<p>Is this expected behaviour? Is there a way around it to force logback to compress files which missed their rollover?</p>\n",
    "tags" : [ "java", "logback" ],
    "owner" : {
      "account_id" : 1085171,
      "reputation" : 3157,
      "user_id" : 1081036,
      "user_type" : "registered",
      "accept_rate" : 59,
      "profile_image" : "https://www.gravatar.com/avatar/628ac742acd95679504dd5c5345a02c0?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Kousalik",
      "link" : "https://stackoverflow.com/users/1081036/kousalik"
    },
    "is_answered" : false,
    "view_count" : 21,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1742977376,
    "creation_date" : 1742977376,
    "link" : "https://stackoverflow.com/questions/79535787/logback-not-compressing-sparse-logs-when-app-restarts-often",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ ],
  "answer_comments" : { }
}