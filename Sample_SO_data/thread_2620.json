{
  "question" : {
    "question_id" : 79608464,
    "title" : "Azure SDK for Java - IllegalStateException for missing HttpClient provider when initializing BlobContainerClient",
    "body" : "<p>I'm working on integrating Azure Blob Storage into a Java application using the Azure SDK. When initializing the BlobContainerClient, I encounter the following error only on the server (not on my local machine):</p>\n<pre><code>Caused by: **java.lang.IllegalStateException**: A request was made to load the default HttpClient provider but one could not be found on the classpath. If you are using a dependency manager, consider including a dependency on azure-core-http-netty or azure-core-http-okhttp. Depending on your existing dependencies, you have the choice of Netty or OkHttp implementations. Additionally, refer to https://aka.ms/azsdk/java/docs/custom-httpclient to learn about writing your own implementation.\n\n    at com.azure.core.implementation.http.HttpClientProviders.createInstance(HttpClientProviders.java:37)\n    at com.azure.core.http.HttpClient.createDefault(HttpClient.java:27)\n    at com.azure.core.http.HttpPipelineBuilder.build(HttpPipelineBuilder.java:60)\n    at com.azure.storage.blob.implementation.util.BuilderHelper.buildPipeline(BuilderHelper.java:110)\n    at com.azure.storage.blob.BlobServiceClientBuilder.buildAsyncClient(BlobServiceClientBuilder.java:107)\n    at com.azure.storage.blob.BlobServiceClientBuilder.buildClient(BlobServiceClientBuilder.java:84)\n    at com.azure.service.impl.AzureBlobAuthService.authenticate(AzureBlobAuthService.java:46)\n</code></pre>\n<p>Here is the relevant part of my code:</p>\n<pre><code> BlobContainerClient containerClient = new BlobContainerClientBuilder()\n        .endpoint(config.getSasUrl())\n        .containerName(config.getContainerName())\n        .buildClient();\n</code></pre>\n<p>Additional Info:\nI'm using Maven with the following dependency:</p>\n<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;com.azure&lt;/groupId&gt;\n    &lt;artifactId&gt;azure-storage-blob&lt;/artifactId&gt;\n    &lt;version&gt;12.9.0&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n",
    "tags" : [ "java", "spring-boot", "azure", "azure-blob-storage", "azure-resource-manager" ],
    "owner" : {
      "account_id" : 38088297,
      "reputation" : 21,
      "user_id" : 28589274,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/921b5dc9adfd252fbadb8002916be7e0?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "devmanish",
      "link" : "https://stackoverflow.com/users/28589274/devmanish"
    },
    "is_answered" : false,
    "view_count" : 134,
    "answer_count" : 1,
    "score" : 2,
    "last_activity_date" : 1746782079,
    "creation_date" : 1746526126,
    "link" : "https://stackoverflow.com/questions/79608464/azure-sdk-for-java-illegalstateexception-for-missing-httpclient-provider-when",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79610611,
    "question_id" : 79608464,
    "body" : "<p>The Azure SDK for Java uses a pluggable HTTP client architecture. It doesn't bundle a specific HTTP client implementation by default. Instead, it relies on you to provide one (either <code>Netty</code> or <code>OkHttp</code>) as a dependency in your project. When the SDK tries to create a default HTTP client and can't find either Netty or OkHttp on the classpath, it throws the <code>IllegalStateException</code>.</p>\n<p><strong>Solutions Using Netty dependency:</strong></p>\n<p>You need to explicitly add  <code>azure-core-http-netty</code>  as a dependency to your project. Choose one based on your project's existing dependencies and preferences.</p>\n<p><strong>Maven dependency:</strong></p>\n<pre><code>\n\n&lt;dependency&gt;\n    &lt;groupId&gt;com.azure&lt;/groupId&gt;\n    &lt;artifactId&gt;azure-core-http-netty&lt;/artifactId&gt;\n    &lt;version&gt;1.13.8&lt;/version&gt; &lt;!-- Use the latest version --&gt;\n&lt;/dependency&gt;\n</code></pre>\n",
    "score" : -1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 10927511,
      "reputation" : 3218,
      "user_id" : 8031784,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/ikcJL.png?s=256",
      "display_name" : "Aniruddh Parihar",
      "link" : "https://stackoverflow.com/users/8031784/aniruddh-parihar"
    },
    "creation_date" : 1746623198,
    "last_activity_date" : 1746782079,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140399820,
    "post_id" : 79608464,
    "body" : "Our app is running in a container, managed by Amazon EKS.",
    "score" : 0,
    "owner" : {
      "account_id" : 38088297,
      "reputation" : 21,
      "user_id" : 28589274,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/921b5dc9adfd252fbadb8002916be7e0?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "devmanish",
      "link" : "https://stackoverflow.com/users/28589274/devmanish"
    },
    "creation_date" : 1746527380,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140399797,
    "post_id" : 79608464,
    "body" : "could you please clarify what you mean by server, is the app running on an Azure Web App, VM, container or something else?",
    "score" : 0,
    "owner" : {
      "account_id" : 39650455,
      "reputation" : 342,
      "user_id" : 29381970,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/35c4c827ce0c00fdfc539b69b3e97099?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Harshitha Bathini",
      "link" : "https://stackoverflow.com/users/29381970/harshitha-bathini"
    },
    "creation_date" : 1746526928,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}