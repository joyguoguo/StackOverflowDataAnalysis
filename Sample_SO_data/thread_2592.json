{
  "question" : {
    "question_id" : 79609999,
    "title" : "Thymeleaf form does not bind content field to model object (content cannot be null)",
    "body" : "<p>I'm working on a form to add a new post in a Spring MVC application using Thymeleaf. Even though I'm using th:field=&quot;*{content}&quot;, the content field is always null after submission, resulting in the following error when trying to insert into the database:</p>\n<pre class=\"lang-none prettyprint-override\"><code>    HTTP Status 500 – Internal Server Error\n\nMessage: Request processing failed: org.hibernate.exception.ConstraintViolationException: could not execute statement [Column 'content' cannot be null]\n</code></pre>\n<p>Here's my Thymeleaf form:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;!DOCTYPE html&gt;\n&lt;html xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;\n    &lt;head&gt;\n        &lt;title&gt;CREATE NEW POST&lt;/title&gt;\n    &lt;th:block th:replace=&quot;base :: styles&quot;&gt;&lt;/th:block&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;div th:replace=&quot;base :: header&quot;&gt;&lt;/div&gt;\n\n    &lt;main class=&quot;container py-4&quot;&gt;\n        &lt;h2 class=&quot;mb-4&quot;&gt;CREATE NEW POST&lt;/h2&gt;\n\n        &lt;form th:action=&quot;@{/posts/add/}&quot; th:object=&quot;${posts}&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot; class=&quot;bg-light p-4 rounded shadow-sm&quot;&gt;\n            &lt;div class=&quot;mb-3&quot;&gt;\n                &lt;label for=&quot;image&quot; class=&quot;form-label&quot;&gt;Image&lt;/label&gt;\n                &lt;input type=&quot;file&quot; class=&quot;form-control&quot; id=&quot;image&quot; name=&quot;imageFile&quot;&gt;\n                &lt;input type=&quot;file&quot; class=&quot;form-control&quot; th:field=&quot;*{image}&quot; /&gt;\n                &lt;img th:src=&quot;${posts.image != null &amp;&amp; posts.image != '' ? '/images/' + posts.image : 'https://res.cloudinary.com/dnc5sycvb/image/upload/v1738987976/l6quazdx4ds2pg4xuv4o.jpg'}&quot; width=&quot;200&quot; th:if=&quot;${posts.id != null}&quot; /&gt;\n            &lt;/div&gt;\n\n            &lt;div class=&quot;mb-3&quot;&gt;\n                &lt;label for=&quot;content&quot; class=&quot;form-label&quot;&gt;Content&lt;/label&gt;\n                &lt;textarea class=&quot;form-control&quot; id=&quot;content&quot; name=&quot;content&quot; rows=&quot;4&quot; th:field=&quot;*{content}&quot; placeholder=&quot;content...&quot;&gt;&lt;/textarea&gt;\n            &lt;/div&gt;\n            &lt;/div&gt;\n\n            &lt;div class=&quot;row&quot;&gt;\n                &lt;div class=&quot;col-md-6 mb-3&quot;&gt;\n                    &lt;label class=&quot;form-label&quot;&gt;Status Comment&lt;/label&gt;\n                    &lt;select class=&quot;form-select&quot; th:field=&quot;*{isCommentLocked}&quot;&gt;\n                        &lt;option th:value=&quot;false&quot;&gt;Open&lt;/option&gt;\n                        &lt;option th:value=&quot;true&quot;&gt;Blocked&lt;/option&gt;\n                    &lt;/select&gt;\n                &lt;/div&gt;\n\n                &lt;div class=&quot;col-md-6 mb-3&quot;&gt;\n                    &lt;label class=&quot;form-label&quot;&gt;Chế độ hiển thị&lt;/label&gt;\n                    &lt;select class=&quot;form-select&quot; th:field=&quot;*{visibility}&quot;&gt;\n                        &lt;option th:each=&quot;visibility : ${visibilityValues}&quot; \n                                th:value=&quot;${visibility}&quot; \n                                th:text=&quot;${visibility}&quot;&gt;&lt;/option&gt;\n                    &lt;/select&gt;\n                &lt;/div&gt;\n            &lt;/div&gt;\n\n            &lt;div class=&quot;mb-3&quot;&gt;\n                &lt;label for=&quot;user&quot; class=&quot;form-label&quot;&gt;User&lt;/label&gt;\n                &lt;select class=&quot;form-select&quot; th:field=&quot;*{user}&quot;&gt;\n                    &lt;option th:each=&quot;user : ${users}&quot; \n                            th:value=&quot;${user}&quot; \n                            th:text=&quot;${user.username}&quot;&gt;&lt;/option&gt;\n                &lt;/select&gt;\n            &lt;/div&gt;\n\n            &lt;div class=&quot;text-end&quot;&gt;\n                &lt;input type=&quot;hidden&quot; th:field=&quot;*{id}&quot; /&gt;\n                &lt;input type=&quot;hidden&quot; th:field=&quot;*{image}&quot; /&gt;\n                &lt;a th:href=&quot;@{/posts/}&quot; class=&quot;btn btn-secondary me-2&quot;&gt;Comeback&lt;/a&gt;\n                &lt;button class=&quot;btn btn-info&quot;&gt;\n                    &lt;span th:if=&quot;${posts.id == null}&quot;&gt;Add&lt;/span&gt;\n                    &lt;span th:unless=&quot;${posts.id == null}&quot;&gt;Create&lt;/span&gt;\n                &lt;/button&gt;\n            &lt;/div&gt;\n        &lt;/form&gt;\n    &lt;/main&gt;\n\n    &lt;div th:replace=&quot;base :: footer&quot;&gt;&lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n<p>In controller:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Controller\n@ControllerAdvice\npublic class PostsController {\n\n    @Autowired\n    private PostsService postService;\n\n    @Autowired\n    private UserService userService;\n\n    @RequestMapping(&quot;/posts/&quot;)\n    public String PostsView(Model model, @RequestParam Map&lt;String, String&gt; params) {\n        model.addAttribute(&quot;posts&quot;, this.postService.getPosts(params));\n        return &quot;posts/posts&quot;;\n    }\n\n    @GetMapping(&quot;/posts/create/&quot;)\n    public String CreateView(Model model) {\n        Posts post = new Posts();\n        model.addAttribute(&quot;visibilityValues&quot;, Posts.Visibility.values());\n        model.addAttribute(&quot;users&quot;, this.userService.getUser());\n        model.addAttribute(&quot;posts&quot;, post);\n        return &quot;posts/create&quot;;\n    }\n\n    @PostMapping(&quot;/posts/add/&quot;)\n    public String create(@ModelAttribute(value = &quot;posts&quot;) Posts p) {\n        this.postService.addOrUpdate(p);\n        return &quot;redirect:/posts/&quot;;\n    }\n}\n</code></pre>\n<p>in posts.java</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Entity\n@Table(name = &quot;post&quot;)\npublic class Posts implements Serializable {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Integer id;\n\n    @ManyToOne\n    @JoinColumn(name = &quot;user_id&quot;)\n    private User user;\n\n    @Column(columnDefinition = &quot;TEXT&quot;)\n    private String content;\n\n    @Column(name = &quot;created_at&quot;)\n    @CreationTimestamp\n    private LocalDateTime createdAt;\n\n    @Column(name = &quot;updated_at&quot;)\n    @UpdateTimestamp\n    private LocalDateTime updatedAt;\n\n    @Column(name = &quot;is_comment_locked&quot;)\n    private Boolean isCommentLocked = false;\n\n    private String image;\n\n    @Enumerated(EnumType.STRING)\n    private Visibility visibility = Visibility.PUBLIC;\n\n    //Xóa/Chỉnh sửa post thì comment thuộc post đó cũng chỉnh sửa theo\n    @OneToMany(cascade = CascadeType.ALL, mappedBy = &quot;postId&quot;)\n    private Set&lt;Comment&gt; comment;\n\n    @OneToMany(cascade = CascadeType.ALL, mappedBy = &quot;postId&quot;)\n    private Set&lt;Reaction&gt; reaction;\n\n    // Chế độ cho bài viết\n    public enum Visibility {\n        PRIVATE,\n        PUBLIC\n    }\n    public Posts() {\n        // Hibernate cần constructor mặc định\n    }\n\n    public Posts(User user, String content, Boolean isCommentLocked, String image,\n                 Visibility visibility, Set&lt;Comment&gt; comment, Set&lt;Reaction&gt; reaction) {\n        this.user = user;\n        this.content = content;\n        this.isCommentLocked = isCommentLocked;\n        this.image = image;\n        this.visibility = visibility;\n        this.comment = comment != null ? comment : new HashSet&lt;&gt;(); // đảm bảo comment không bị null\n        this.reaction = reaction != null ? reaction : new HashSet&lt;&gt;();\n    }\n\n    /**\n     * @return the id\n     */\n    public Integer getId() {\n        return id;\n    }\n\n    /**\n     * @param id the id to set\n     */\n    public void setId(Integer id) {\n        this.id = id;\n    }\n\n    /**\n     * @return the user\n     */\n    public User getUser() {\n        return user;\n    }\n\n    /**\n     * @param user the user to set\n     */\n    public void setUser(User user) {\n        this.user = user;\n    }\n\n    /**\n     * @return the content\n     */\n    public String getContent() {\n        return content;\n    }\n\n    /**\n     * @param content the content to set\n     */\n    public void setContent(String content) {\n        this.content = content;\n    }\n\n    /**\n     * @return the createdAt\n     */\n    public LocalDateTime getCreatedAt() {\n        return createdAt;\n    }\n\n    /**\n     * @param createdAt the createdAt to set\n     */\n    public void setCreatedAt(LocalDateTime createdAt) {\n        this.createdAt = createdAt;\n    }\n\n    /**\n     * @return the updatedAt\n     */\n    public LocalDateTime getUpdatedAt() {\n        return updatedAt;\n    }\n\n    /**\n     * @param updatedAt the updatedAt to set\n     */\n    public void setUpdatedAt(LocalDateTime updatedAt) {\n        this.updatedAt = updatedAt;\n    }\n\n    /**\n     * @return the isCommentLocked\n     */\n    public Boolean getIsCommentLocked() {\n        return isCommentLocked;\n    }\n\n    /**\n     * @param isCommentLocked the isCommentLocked to set\n     */\n    public void setIsCommentLocked(Boolean isCommentLocked) {\n        this.isCommentLocked = isCommentLocked;\n    }\n\n    /**\n     * @return the image\n     */\n    public String getImage() {\n        return image;\n    }\n\n    /**\n     * @param image the image to set\n     */\n    public void setImage(String image) {\n        this.image = image;\n    }\n\n    /**\n     * @return the visibility\n     */\n    public Visibility getVisibility() {\n        return visibility;\n    }\n\n    /**\n     * @param visibility the visibility to set\n     */\n    public void setVisibility(Visibility visibility) {\n        this.visibility = visibility;\n    }\n\n    /**\n     * @return the comment\n     */\n    public Set&lt;Comment&gt; getComment() {\n        return comment;\n    }\n\n    /**\n     * @param comment the comment to set\n     */\n    public void setComment(Set&lt;Comment&gt; comment) {\n        this.comment = comment;\n    }\n\n    /**\n     * @return the reaction\n     */\n    public Set&lt;Reaction&gt; getReaction() {\n        return reaction;\n    }\n\n    /**\n     * @param reaction the reaction to set\n     */\n    public void setReaction(Set&lt;Reaction&gt; reaction) {\n        this.reaction = reaction;\n    }\n    /**\n     *\n     * @param o\n     * @return\n     */\n    @Override\n    public boolean equals(Object o) {\n        if (this == o) {\n            return true;\n        }\n        if (!(o instanceof User)) {\n            return false;\n        }\n        Posts other = (Posts) o;\n        return id == other.id;\n    }\n\n    @Override\n    public int hashCode() {\n        return Integer.hashCode(id);\n    }\n\n}\n</code></pre>\n<p>I’ve checked the generated HTML and the name=&quot;content&quot; field and other fields looks correct. I don’t understand why the field isn’t being populated in the Post object after form submission.</p>\n",
    "tags" : [ "java", "spring", "spring-mvc", "thymeleaf" ],
    "owner" : {
      "account_id" : 37655223,
      "reputation" : 99,
      "user_id" : 28357623,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/WQDqKHwX.jpg?s=256",
      "display_name" : "Phuong Nguyen",
      "link" : "https://stackoverflow.com/users/28357623/phuong-nguyen"
    },
    "is_answered" : true,
    "view_count" : 68,
    "answer_count" : 1,
    "score" : -1,
    "last_activity_date" : 1746613899,
    "creation_date" : 1746602865,
    "link" : "https://stackoverflow.com/questions/79609999/thymeleaf-form-does-not-bind-content-field-to-model-object-content-cannot-be-nu",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79610331,
    "question_id" : 79609999,
    "body" : "<p>In your form, you're using both <code>name=&quot;content&quot;</code> <strong>and</strong> <code>th:field=&quot;*{content}&quot;</code>.</p>\n<p>Thymeleaf <strong>automatically sets</strong> the <code>name</code> attribute based on the <code>th:field</code>.  So using both can lead to unexpected behavior.</p>\n<p><strong>You can try removing the  <code>name</code> attribute:</strong></p>\n<pre class=\"lang-html prettyprint-override\"><code>&lt;textarea class=&quot;form-control&quot; id=&quot;content&quot; th:field=&quot;*{content}&quot; rows=&quot;4&quot; placeholder=&quot;content...&quot;&gt;&lt;/textarea&gt;\n</code></pre>\n",
    "score" : 1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 18239208,
      "reputation" : 647,
      "user_id" : 13276541,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a-/AOh14GgPsMth9rUGvp9lxK_Nky2OaBid5MNfuotaqiF9Bg=k-s256",
      "display_name" : "Ahmed Mera",
      "link" : "https://stackoverflow.com/users/13276541/ahmed-mera"
    },
    "creation_date" : 1746613899,
    "last_activity_date" : 1746613899,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140403012,
    "post_id" : 79609999,
    "body" : "Thank you for pointing out the issue! I’ve checked again and removed the extra &lt;/div&gt;, but the problem is still not resolved. The content field is still not being bound correctly.",
    "score" : 0,
    "owner" : {
      "account_id" : 37655223,
      "reputation" : 99,
      "user_id" : 28357623,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/WQDqKHwX.jpg?s=256",
      "display_name" : "Phuong Nguyen",
      "link" : "https://stackoverflow.com/users/28357623/phuong-nguyen"
    },
    "creation_date" : 1746604423,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140402976,
    "post_id" : 79609999,
    "body" : "There&#39;s an extra <code>&lt;&#47;div&gt;</code> after content&#39;s container, which may affect html structure interpreted by the browser",
    "score" : 0,
    "owner" : {
      "account_id" : 2714938,
      "reputation" : 6448,
      "user_id" : 2342529,
      "user_type" : "registered",
      "accept_rate" : 98,
      "profile_image" : "https://i.sstatic.net/SSkK4.jpg?s=256",
      "display_name" : "Alexandru Severin",
      "link" : "https://stackoverflow.com/users/2342529/alexandru-severin"
    },
    "creation_date" : 1746603838,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}