{
  "question" : {
    "question_id" : 79734565,
    "title" : "How can you set proxyName and proxyPort values in Spring Boot Application YAML for embedded tomcat instance?",
    "body" : "<p>In the past, I have had to set the proxyName and proxyPort (along with scheme and secure) so that when Okta Saml SSO assertions are made/validated the correct domain values are used (since my app is running behind F5 Load balancer).</p>\n<p>I would setup my Tomcat Connector in the Server.xml as:</p>\n<pre><code>\n&lt;!-- proxy info is required for saml validation to work --&gt;\n    &lt;Connector port=&quot;8080&quot; protocol=&quot;HTTP/1.1&quot;\n                proxyName=&quot;mysite.mydomain.com&quot;\n                proxyPort=&quot;443&quot;\n                scheme=&quot;https&quot;\n                secure=&quot;true&quot; \n                connectionTimeout=&quot;60000&quot;\n                enableLookups=&quot;false&quot;\n                disableUploadTimeout=&quot;false&quot;\n                redirectPort=&quot;8443&quot;\n                maxThreads=&quot;300&quot;\n                minSpareThreads=&quot;10&quot;\n                maxPostSize=&quot;15000000&quot;\n                compression=&quot;on&quot; compressionMinSize=&quot;2048&quot; \n                noCompressionUserAgents=&quot;gozilla, traviata&quot; compressableMimeType=&quot;text/html,text/xml,application/json,text/javascript&quot; /&gt;\n</code></pre>\n<p>My latest app will be doing the same type of okta / saml login, but I was planning on using the embedded tomcat, and I am setting that up minimally using yaml config.</p>\n<p>I have tried the following:</p>\n<pre><code>server:\n  tomcat:\n    connectors:\n      - port: 8080\n        proxyName: mysite.mydomain.com\n        proxyPort: 443\n        scheme: https\n        secure: true\n</code></pre>\n<p>as well as:</p>\n<pre><code>server:\n  port: 8080\n  proxy:\n    name: mysite.mydomain.com\n    port: 443\n  scheme: https\n  secure: true\n</code></pre>\n<p>But when I debug and look at my Tomcat request, the values are not set:\n<a href=\"https://i.sstatic.net/AJAunyk8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/AJAunyk8.png\" alt=\"Debugger Screenshot\" /></a></p>\n<p>I can't seem to find any good YAML documentation for these settings. Has anyone done anything like this and could let me know how the YAML should be setup for these values?</p>\n",
    "tags" : [ "java", "spring", "spring-boot", "tomcat", "yaml" ],
    "owner" : {
      "account_id" : 202497,
      "reputation" : 293,
      "user_id" : 4603276,
      "user_type" : "registered",
      "profile_image" : "https://lh4.googleusercontent.com/-KXUOaTvYXD8/AAAAAAAAAAI/AAAAAAAABXM/X8jK2ZwfdlU/s256-rj/photo.jpg",
      "display_name" : "B-Wieg",
      "link" : "https://stackoverflow.com/users/4603276/b-wieg"
    },
    "is_answered" : true,
    "view_count" : 143,
    "answer_count" : 1,
    "score" : 4,
    "last_activity_date" : 1755172184,
    "creation_date" : 1755104908,
    "link" : "https://stackoverflow.com/questions/79734565/how-can-you-set-proxyname-and-proxyport-values-in-spring-boot-application-yaml-f",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79735357,
    "question_id" : 79734565,
    "body" : "<p>I don't believe there is direct support for changing/setting the proxyName / proxyPort / etc. via YAML directly. I was able to accomplish this using WebServerFactoryCustomizer (org.springframework.boot.web.server) in a Configuration Bean. I haven't wired up Okta fully yet, but I can step through the setup and see that the Connector properties are being set.</p>\n<p>YAML:</p>\n<pre><code>application:\n  server:\n    tomcat:\n      proxy:\n        name: mysite.mydomain.com\n        port: 443\n        scheme: https\n        secure: true\n</code></pre>\n<p>Configuration Properties Object</p>\n<pre class=\"lang-java prettyprint-override\"><code>@ConfigurationPropertiesScan\n@ConfigurationProperties(prefix = &quot;application.server.tomcat.proxy&quot;)\npublic class TomcatProxyConfiguration {\n\n\n    private String name;\n    private int port;\n    private String scheme;\n    private boolean secure;\n\n    public String getName() {\n        return name;\n    }\n    public void setName(String name) {\n        this.name = name;\n    }\n    public int getPort() {\n        return port;\n    }\n    public void setPort(int port) {\n        this.port = port;\n    }\n    public String getScheme() {\n        return scheme;\n    }\n    public void setScheme(String scheme) {\n        this.scheme = scheme;\n    }\n    public boolean isSecure() {\n        return secure;\n    }\n    public void setSecure(boolean secure) {\n        this.secure = secure;\n    }\n}\n</code></pre>\n<p>Configuration Bean:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Configuration\npublic class TomcatConfiguration {\n\n    private TomcatProxyConfiguration tomcatProxyConfiguration;\n\n    //pass in the Configuration Properties object via constructor injection\n    public TomcatConfiguration(TomcatProxyConfiguration tomcatProxyConfiguration){\n        this.tomcatProxyConfiguration = tomcatProxyConfiguration;\n    }\n\n    @Bean\n    public WebServerFactoryCustomizer&lt;TomcatServletWebServerFactory&gt; tomcatCustomizer() {\n        return factory -&gt; factory.addConnectorCustomizers((Connector connector) -&gt; {\n            connector.setProxyName(tomcatProxyConfiguration.getName());\n            connector.setProxyPort(tomcatProxyConfiguration.getPort());\n            connector.setScheme(tomcatProxyConfiguration.getScheme());\n            connector.setSecure(tomcatProxyConfiguration.isSecure());\n        });\n    }\n}\n</code></pre>\n<p>Debugging:</p>\n<p><a href=\"https://i.sstatic.net/TMC8EXdJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/TMC8EXdJ.png\" alt=\"Screenshot of the debugging showing the values set\" title=\"Debugging output\" /></a></p>\n",
    "score" : 1,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 202497,
      "reputation" : 293,
      "user_id" : 4603276,
      "user_type" : "registered",
      "profile_image" : "https://lh4.googleusercontent.com/-KXUOaTvYXD8/AAAAAAAAAAI/AAAAAAAABXM/X8jK2ZwfdlU/s256-rj/photo.jpg",
      "display_name" : "B-Wieg",
      "link" : "https://stackoverflow.com/users/4603276/b-wieg"
    },
    "creation_date" : 1755172184,
    "last_activity_date" : 1755172184,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140664339,
    "post_id" : 79734565,
    "body" : "@JorgeCampos ‚Äê Yeah, I actually had to go that route.  I was able to put together a Connector customizer bean that was able to pull in configuration properties I set in my YAML and set the proxy Name, proxy port, scheme, and secure fields. The request connector now reflects those values and the Okta SAML assertions should work when I get that all put together.  I&#39;ll post my solution tomorrow hopefully so others can see the approach. Thanks for your help!",
    "score" : 2,
    "owner" : {
      "account_id" : 202497,
      "reputation" : 293,
      "user_id" : 4603276,
      "user_type" : "registered",
      "profile_image" : "https://lh4.googleusercontent.com/-KXUOaTvYXD8/AAAAAAAAAAI/AAAAAAAABXM/X8jK2ZwfdlU/s256-rj/photo.jpg",
      "display_name" : "B-Wieg",
      "link" : "https://stackoverflow.com/users/4603276/b-wieg"
    },
    "creation_date" : 1755145231,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140664095,
    "post_id" : 79734565,
    "body" : "True, likely the tomcat configs were removed in the new version. But apparently the proxy one was never exposed. You might need to use a class configuration instead. <a href=\"https://docs.spring.io/spring-boot/3.4/api/java/org/springframework/boot/web/embedded/tomcat/TomcatServletWebServerFactory.html\" rel=\"nofollow noreferrer\">Check this class out</a> and try to find examples of usage",
    "score" : 1,
    "owner" : {
      "account_id" : 209503,
      "reputation" : 23867,
      "user_id" : 460557,
      "user_type" : "registered",
      "accept_rate" : 100,
      "profile_image" : "https://www.gravatar.com/avatar/b4565f97815833390c9c880e9e8522e4?s=256&d=identicon&r=PG",
      "display_name" : "Jorge Campos",
      "link" : "https://stackoverflow.com/users/460557/jorge-campos"
    },
    "creation_date" : 1755127957,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140663934,
    "post_id" : 79734565,
    "body" : "Thanks for the link. I didn&#39;t see any reference to the proxy name / proxy port / etc. in the Server Properties section. That page will come in handy for other things I would imagine!",
    "score" : 0,
    "owner" : {
      "account_id" : 202497,
      "reputation" : 293,
      "user_id" : 4603276,
      "user_type" : "registered",
      "profile_image" : "https://lh4.googleusercontent.com/-KXUOaTvYXD8/AAAAAAAAAAI/AAAAAAAABXM/X8jK2ZwfdlU/s256-rj/photo.jpg",
      "display_name" : "B-Wieg",
      "link" : "https://stackoverflow.com/users/4603276/b-wieg"
    },
    "creation_date" : 1755120049,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140663895,
    "post_id" : 79734565,
    "body" : "This is a must have link for whoever work with spring: <a href=\"https://docs.spring.io/spring-boot/appendix/application-properties/index.html\" rel=\"nofollow noreferrer\">docs.spring.io/spring-boot/appendix/application-properties/&hellip;</a>",
    "score" : 0,
    "owner" : {
      "account_id" : 209503,
      "reputation" : 23867,
      "user_id" : 460557,
      "user_type" : "registered",
      "accept_rate" : 100,
      "profile_image" : "https://www.gravatar.com/avatar/b4565f97815833390c9c880e9e8522e4?s=256&d=identicon&r=PG",
      "display_name" : "Jorge Campos",
      "link" : "https://stackoverflow.com/users/460557/jorge-campos"
    },
    "creation_date" : 1755118651,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79735357" : [ {
      "comment_id" : 140665857,
      "post_id" : 79735357,
      "body" : "Nice! Thanks for posting an answer.",
      "score" : 0,
      "owner" : {
        "account_id" : 209503,
        "reputation" : 23867,
        "user_id" : 460557,
        "user_type" : "registered",
        "accept_rate" : 100,
        "profile_image" : "https://www.gravatar.com/avatar/b4565f97815833390c9c880e9e8522e4?s=256&d=identicon&r=PG",
        "display_name" : "Jorge Campos",
        "link" : "https://stackoverflow.com/users/460557/jorge-campos"
      },
      "creation_date" : 1755185403,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}