{
  "question" : {
    "question_id" : 79722503,
    "title" : "POJO class retains old values during multiple test execution",
    "body" : "<p>I am having pojo class with Lombok @data annotation. pojo classes are static in calling classes. So When I execute multiple selenium tests say test 1 and test 2, during test 2 execution, pojo fields are retaining values from test1. How to avoid this. How to make the pojo class fields synchronized since there are no getter and setter methods in pojo. Getters and setter are automatically generated by lombok @data</p>\n<p>The class is used this way.</p>\n<pre><code>static POJOClass class1=POJOClass.getInstance();\n</code></pre>\n<p>While retrieving the fields, it's used as <code>class1.getField1()</code>. This gives stale values sometimes.</p>\n<p>POJO Class - TestPojo.java</p>\n<pre><code> @Data    \n    public final class TestPOJO{\n        \n        private TestPOJO(){\n        }\n        private static final TestPOJO testPojo = new TestPOJO();\n        private String field1;\n\n        public static TestPOJO getInstance(){\n          return testPojo;\n    }\n}\n</code></pre>\n<p>CallingClass.java</p>\n<pre><code>public class CallingClass{\n static TestPOJO testPojo = TestPOJO.getInstance();\ntestPojo.getField1(); -- returns old values during multiple test execution\n\n}\n</code></pre>\n",
    "tags" : [ "java", "multithreading", "selenium-webdriver", "static", "synchronized" ],
    "owner" : {
      "account_id" : 1709010,
      "reputation" : 5,
      "user_id" : 1567436,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/1ddb260f217ee3c5689131a9fc68e5d7?s=256&d=identicon&r=PG",
      "display_name" : "SeriousCoder",
      "link" : "https://stackoverflow.com/users/1567436/seriouscoder"
    },
    "is_answered" : false,
    "view_count" : 111,
    "answer_count" : 1,
    "score" : -3,
    "last_activity_date" : 1754646277,
    "creation_date" : 1754050668,
    "link" : "https://stackoverflow.com/questions/79722503/pojo-class-retains-old-values-during-multiple-test-execution",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79729586,
    "question_id" : 79722503,
    "body" : "<p>TL;DR: Stop using the singleton pattern!!!</p>\n<p>The singleton pattern is terrible for testing, especially if your singletons contain mutable state. Static fields live for the life of the classloader that loaded the class, which is often the life of the JVM itself. In junit a single JVM / classloader load all tests so mutations to static variables will &quot;bleed&quot; from one test to another.</p>\n<p>Have you considererd using <a href=\"https://en.wikipedia.org/wiki/Dependency_injection\" rel=\"nofollow noreferrer\">dependency injection</a> instead of using <a href=\"https://en.wikipedia.org/wiki/Singleton_pattern\" rel=\"nofollow noreferrer\">singleton pattern</a>?</p>\n<p>If you must use singleton pattern (not recommended) you might consider adding a <code>reset()</code> method to the shared pojos. You could then <code>reset()</code> the pojo in your <code>@BeforeEach</code> and <code>@AfterEach</code> methods</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class MyTest {\n   @BeforeEach {\n   public void beforeEach() {\n      // this only required to cleanup after tests run before this test\n      TestPOJO.getInstance().reset();\n   }\n\n   @AfterEach {\n   public void afterEach() {\n      // reset TestPOJO so mutations in this test don't bleed into other tests\n      TestPOJO.getInstance().reset();\n   }\n\n   @Test\n   public void test1() { \n      TestPOJO.getInstance().setField1(&quot;value1&quot;);\n      ...\n   }\n\n   @Test\n   public void test2() { \n      TestPOJO.getInstance().setField1(&quot;value2&quot;);\n      ...\n   }\n}\n</code></pre>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 1096470,
      "reputation" : 29414,
      "user_id" : 1089967,
      "user_type" : "registered",
      "accept_rate" : 59,
      "profile_image" : "https://www.gravatar.com/avatar/1f256b904ff621d678598d8fa49f86c5?s=256&d=identicon&r=PG",
      "display_name" : "lance-java",
      "link" : "https://stackoverflow.com/users/1089967/lance-java"
    },
    "creation_date" : 1754645280,
    "last_activity_date" : 1754646277,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140637514,
    "post_id" : 79722503,
    "body" : "The <code>getInstance()</code> method should be static if you need ot have such a method. The folks here are suggesting that the <code>testPojo</code> variable not be static.",
    "score" : 0,
    "owner" : {
      "account_id" : 7612423,
      "reputation" : 87400,
      "user_id" : 5772882,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/8283c64511fa80afed5259d10850168f?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Anonymous",
      "link" : "https://stackoverflow.com/users/5772882/anonymous"
    },
    "creation_date" : 1754146496,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140636495,
    "post_id" : 79722503,
    "body" : "Shouldn&#39;t POJO classes getInstance() be static",
    "score" : 0,
    "owner" : {
      "account_id" : 1709010,
      "reputation" : 5,
      "user_id" : 1567436,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/1ddb260f217ee3c5689131a9fc68e5d7?s=256&d=identicon&r=PG",
      "display_name" : "SeriousCoder",
      "link" : "https://stackoverflow.com/users/1567436/seriouscoder"
    },
    "creation_date" : 1754080667,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140636193,
    "post_id" : 79722503,
    "body" : "Hello SeriousCoder, as @JeffC indicates, the attribute <b>TestPOJO testPojo</b> declared as static causes the method <b>getInstance()</b> to always return the same object, so the values will be preserved between different executions.",
    "score" : 2,
    "owner" : {
      "account_id" : 10843443,
      "reputation" : 916,
      "user_id" : 20882864,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/CCQCy.jpg?s=256",
      "display_name" : "Marce Puente",
      "link" : "https://stackoverflow.com/users/20882864/marce-puente"
    },
    "creation_date" : 1754070921,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140635672,
    "post_id" : 79722503,
    "body" : "You still haven&#39;t shared enough code for us to help. You need to add an example of a &gt;simple&lt; class... simple, not 300 lines of code. If I were to guess, you have fields in your class that hold certain values that are marked as <code>static</code>. Because of that, those values persist between test executions so when test1 runs, it sets X static field on the class then when test2 runs, it sets X as well... then it&#39;s a race condition as to whether test1 or test2 accesses X first and sometimes test1 gets test2&#39;s X value. The way to fix this is to get rid of the static fields in classes.",
    "score" : 0,
    "owner" : {
      "account_id" : 2772450,
      "reputation" : 26443,
      "user_id" : 2386774,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/dea7da142cb7e85d5d5a8576e2625431?s=256&d=identicon&r=PG",
      "display_name" : "JeffC",
      "link" : "https://stackoverflow.com/users/2386774/jeffc"
    },
    "creation_date" : 1754058566,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140635441,
    "post_id" : 79722503,
    "body" : "Thanks for reacting promptly to comments. Additional information is very welcome. Please always add it in the question itself so we have everything in one place.",
    "score" : 0,
    "owner" : {
      "account_id" : 7612423,
      "reputation" : 87400,
      "user_id" : 5772882,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/8283c64511fa80afed5259d10850168f?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Anonymous",
      "link" : "https://stackoverflow.com/users/5772882/anonymous"
    },
    "creation_date" : 1754054197,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140635422,
    "post_id" : 79722503,
    "body" : "While retrieving the fields, it&#39;s used as class1.getField1. this gives stale values sometimes",
    "score" : 0,
    "owner" : {
      "account_id" : 1709010,
      "reputation" : 5,
      "user_id" : 1567436,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/1ddb260f217ee3c5689131a9fc68e5d7?s=256&d=identicon&r=PG",
      "display_name" : "SeriousCoder",
      "link" : "https://stackoverflow.com/users/1567436/seriouscoder"
    },
    "creation_date" : 1754053492,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140635398,
    "post_id" : 79722503,
    "body" : "The class is used this way. static POJOClass class1=POJOClass.getInstance();",
    "score" : 0,
    "owner" : {
      "account_id" : 1709010,
      "reputation" : 5,
      "user_id" : 1567436,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/1ddb260f217ee3c5689131a9fc68e5d7?s=256&d=identicon&r=PG",
      "display_name" : "SeriousCoder",
      "link" : "https://stackoverflow.com/users/1567436/seriouscoder"
    },
    "creation_date" : 1754052947,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140635392,
    "post_id" : 79722503,
    "body" : "You should clarify what you mean by <code>pojo classes are static in calling classes</code>. But, if it means, what I think it means, you should use instance variables, not class variables(static).",
    "score" : 0,
    "owner" : {
      "account_id" : 23783500,
      "reputation" : 7109,
      "user_id" : 17795888,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/Xay1V.jpg?s=256",
      "display_name" : "Chaosfire",
      "link" : "https://stackoverflow.com/users/17795888/chaosfire"
    },
    "creation_date" : 1754052787,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140635383,
    "post_id" : 79722503,
    "body" : "What does  <i>pojo classes are static in calling classes</i> mean?  Please update the question with some code.",
    "score" : 3,
    "owner" : {
      "account_id" : 8909811,
      "reputation" : 2861,
      "user_id" : 6650475,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/fe85994d05ad7aaaa1c47d638b37bc45?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Andrew S",
      "link" : "https://stackoverflow.com/users/6650475/andrew-s"
    },
    "creation_date" : 1754052416,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}