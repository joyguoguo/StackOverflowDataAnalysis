{
  "question" : {
    "question_id" : 79537443,
    "title" : "net.ucanaccess.jdbc.UcanaccessSQLException: UCAExc:::5.0.1 incompatible data types in conversion",
    "body" : "<p>I'm trying to connect my Java SE project to an Access 2016 database on my computer. On the line 15 that makes the connection (before running any queries), I get the error:</p>\n<pre><code>net.ucanaccess.jdbc.UcanaccessSQLException: UCAExc:::5.0.1 incompatible data types in conversion\n    at net.ucanaccess.jdbc.UcanaccessDriver.connect(UcanaccessDriver.java:231)\n    at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:677)\n    at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:251)\n    at lib.ConectarAccess.main(ConectarAccess.java:15)\nCaused by: java.sql.SQLSyntaxErrorException: incompatible data types in conversion\n    at org.hsqldb.jdbc.JDBCUtil.sqlException(Unknown Source)\n    at org.hsqldb.jdbc.JDBCUtil.throwError(Unknown Source)\n    at org.hsqldb.jdbc.JDBCPreparedStatement.setParameter(Unknown Source)\n    at org.hsqldb.jdbc.JDBCPreparedStatement.setObject(Unknown Source)\n    at net.ucanaccess.converters.LoadJet.execInsert(LoadJet.java:1527)\n    at net.ucanaccess.converters.LoadJet.access$900(LoadJet.java:74)\n    at net.ucanaccess.converters.LoadJet$TablesLoader.loadTableData(LoadJet.java:861)\n    at net.ucanaccess.converters.LoadJet$TablesLoader.loadTableData(LoadJet.java:837)\n    at net.ucanaccess.converters.LoadJet$TablesLoader.loadTablesData(LoadJet.java:1029)\n    at net.ucanaccess.converters.LoadJet$TablesLoader.loadTables(LoadJet.java:1077)\n    at net.ucanaccess.converters.LoadJet$TablesLoader.access$3200(LoadJet.java:264)\n    at net.ucanaccess.converters.LoadJet.loadDB(LoadJet.java:1579)\n    at net.ucanaccess.jdbc.UcanaccessDriver.connect(UcanaccessDriver.java:218)\n    ... 3 more\nCaused by: org.hsqldb.HsqlException: incompatible data types in conversion\n    at org.hsqldb.error.Error.error(Unknown Source)\n    at org.hsqldb.error.Error.error(Unknown Source)\n    at org.hsqldb.types.DateTimeType.convertJavaToSQL(Unknown Source)\n    ... 14 more\n</code></pre>\n<p>I tried to &quot;compact and repair&quot; my database too.\nMy code is:</p>\n<pre><code>public class ConectarAccess {\n    public static void main(String[] args) {\n        \n        String rutaDb= &quot;C:\\\\Users\\\\Carl\\\\Documents\\\\Clientes.accdb&quot;;\n        String url = &quot;jdbc:ucanaccess://&quot;+ rutaDb; \n        try {\n            Class.forName(&quot;net.ucanaccess.jdbc.UcanaccessDriver&quot;); \n            Connection conexion = DriverManager.getConnection(url);\n            //Statement st = conexion.createStatement();\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n}\n</code></pre>\n<p>My data table is:\n<a href=\"https://i.sstatic.net/WvSmTgwX.png\" rel=\"nofollow noreferrer\">Access Data table</a></p>\n",
    "tags" : [ "java", "ms-access-2016" ],
    "owner" : {
      "account_id" : 16386246,
      "reputation" : 9,
      "user_id" : 25775680,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/b342ddfbccafb843093b4aa6b008ad35?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Carlos",
      "link" : "https://stackoverflow.com/users/25775680/carlos"
    },
    "is_answered" : false,
    "view_count" : 128,
    "answer_count" : 3,
    "score" : 0,
    "last_activity_date" : 1743274124,
    "creation_date" : 1743029430,
    "link" : "https://stackoverflow.com/questions/79537443/net-ucanaccess-jdbc-ucanaccesssqlexception-ucaexc5-0-1-incompatible-data-typ",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79537469,
    "question_id" : 79537443,
    "body" : "<p>The error <strong>&quot;incompatible data types in conversion&quot;</strong> usually means that there's a mismatch between the data type expected by the Access database and the type being sent from your Java code.. Make sure your connection string , JDBC driver.</p>\n<pre><code>\npublic class ConectarAccess {\n    public static void main(String[] args) {\n\n        String rutaDb = &quot;C:\\\\Users\\\\Carl\\\\Documents\\\\Clientes.accdb&quot;;\n        String url = &quot;jdbc:ucanaccess://&quot; + rutaDb;\n        try {\n            Class.forName(&quot;net.ucanaccess.jdbc.UcanaccessDriver&quot;);\n            Connection conexion = DriverManager.getConnection(url);\n            // Statement st = conexion.createStatement();\n            if (connection != null) {\n                statement = connection.createStatement();\n                System.out.println(&quot;Database connected successfully!&quot;);\n            } else {\n                System.out.println(&quot;Failed to establish connection!&quot;);\n            }\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n}\n</code></pre>\n<p>check to find bug</p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 30252685,
      "reputation" : 41,
      "user_id" : 27038210,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a/ACg8ocLtIhxdmd6D6mNIFP3Su8Po-LvJkwFQSV1uENb5dTd9rw=k-s256",
      "display_name" : "Fahad Hasan",
      "link" : "https://stackoverflow.com/users/27038210/fahad-hasan"
    },
    "creation_date" : 1743030669,
    "last_activity_date" : 1743030948,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79537990,
    "question_id" : 79537443,
    "body" : "<p>Some points to pay attention:<br />\n- Check your DB data types particularly Date/Time fields<br />\n- If possible, you can use latest version of Driver<br />\n- Try modifying code and check if below code works:</p>\n<p><code>String url = &quot;jdbc:ucanaccess://&quot; + rutaDb + &quot;;memory=false;immediatelyReleaseResources=true&quot;;</code></p>\n<p>memory=false: Ensures the DB is not loaded into memory<br />\nimmediatelyReleaseResources=true: It helps avoid resource locking issues.</p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 24948833,
      "reputation" : 38,
      "user_id" : 18813886,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a-/AOh14GjxwjRYh-IwnRo5O2_ORyqIoeV8x7joTw0qo0XW=k-s256",
      "display_name" : "Amit J.",
      "link" : "https://stackoverflow.com/users/18813886/amit-j"
    },
    "creation_date" : 1743056315,
    "last_activity_date" : 1743056315,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79540239,
    "question_id" : 79537443,
    "body" : "<p>Finally I solved it adding <strong>System.setProperty(&quot;hsqldb.method_class_names&quot;, &quot;net.ucanaccess.converters.*&quot;)</strong>; before Connection (more info <a href=\"http://hsqldb.org/doc/2.0/guide/sqlroutines-chapt.html#src_jrt_access_control\" rel=\"nofollow noreferrer\">http://hsqldb.org/doc/2.0/guide/sqlroutines-chapt.html#src_jrt_access_control</a>). I got the same error when I did an Insert (my Access database date is 'dd/MM/yyyy') and I used a String '<strong>yyyy-MM-dd'</strong> to solve the insert error. And using hsqldb-2.5.2 instead hsqldb-2.7.4  the conversion error in the insert is avoided.</p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 16386246,
      "reputation" : 9,
      "user_id" : 25775680,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/b342ddfbccafb843093b4aa6b008ad35?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Carlos",
      "link" : "https://stackoverflow.com/users/25775680/carlos"
    },
    "creation_date" : 1743118951,
    "last_activity_date" : 1743274124,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : {
    "79537469" : [ {
      "comment_id" : 140271464,
      "post_id" : 79537469,
      "body" : "Yes I get the same error",
      "score" : 0,
      "owner" : {
        "account_id" : 16386246,
        "reputation" : 9,
        "user_id" : 25775680,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/b342ddfbccafb843093b4aa6b008ad35?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "Carlos",
        "link" : "https://stackoverflow.com/users/25775680/carlos"
      },
      "creation_date" : 1743107827,
      "content_license" : "CC BY-SA 4.0"
    } ],
    "79537990" : [ {
      "comment_id" : 140271493,
      "post_id" : 79537990,
      "body" : "Thanks! I&#39;m using the latest version of jackaccess (4.0.8), ucanaccess (5.0.1), commons-lang3 (3.17.0), etc. The values of my date/time fields are &#39;30/01/2000&#39; and &#39;01/01/2000&#39;. I tried adding &quot;;memory=false;immediatelyReleaseResources=true&quot;; but I get the same exception",
      "score" : 0,
      "owner" : {
        "account_id" : 16386246,
        "reputation" : 9,
        "user_id" : 25775680,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/b342ddfbccafb843093b4aa6b008ad35?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "Carlos",
        "link" : "https://stackoverflow.com/users/25775680/carlos"
      },
      "creation_date" : 1743108379,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}