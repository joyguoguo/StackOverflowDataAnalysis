{
  "question" : {
    "question_id" : 79547117,
    "title" : "How to encode integer in a character string that can be used as a URL parameter value",
    "body" : "<p>I have a web application that can be used by multiple unrelated companies. Internally each company is identified by an integer. I would like to supply each company with a URL for the login page that uniquely identifies them so that their own branding can be used from the get-go. Obviously the simplest method would be to add a parameter to the URL that identifies their company ID, such as <code>?COMPANYID=5</code>. However, that would make it too easy for someone to poke around and find out all the companies that use the application. Instead, what I would like is some way to hash their company ID to a string that isn't too long or too short and that consists only of characters that can be used in a URL, which I can then convert to their real company ID when I receive the HTTP request, such as <code>?OCI=SD2PAX7</code>. My application is written in Java/JSF, in case that might have tools that could be used for this.</p>\n<p>EDIT:  This question (<a href=\"https://stackoverflow.com/questions/9543715/generating-human-readable-usable-short-but-unique-ids\">Generating human-readable/usable, short but unique IDs</a>) has been suggested for a possible solution, but that question is different as it's not looking for values that can be reversed back to some starting value, even though some of its answers might be used in that fashion. It seems to aim to obfuscate a volume of activity rather than entity identifiers.</p>\n",
    "tags" : [ "java" ],
    "owner" : {
      "account_id" : 993644,
      "reputation" : 1623,
      "user_id" : 1010173,
      "user_type" : "registered",
      "accept_rate" : 64,
      "profile_image" : "https://www.gravatar.com/avatar/384e546b224f9a917459eea478d91b6f?s=256&d=identicon&r=PG",
      "display_name" : "Kevin Rahe",
      "link" : "https://stackoverflow.com/users/1010173/kevin-rahe"
    },
    "is_answered" : false,
    "view_count" : 111,
    "answer_count" : 1,
    "score" : -3,
    "last_activity_date" : 1744196672,
    "creation_date" : 1743449789,
    "link" : "https://stackoverflow.com/questions/79547117/how-to-encode-integer-in-a-character-string-that-can-be-used-as-a-url-parameter",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79564183,
    "question_id" : 79547117,
    "body" : "<p>The security aspects are already treated in the comments.</p>\n<p>So simply a technical code snippet.</p>\n<ul>\n<li>You still should at least convert a sequential numerical company ID to something.\nI do the minimal for clarity.</li>\n<li>Base64 is a nice compact encoding using <code>A-Za-z0-9_-</code>.\nExplicitly the URL safe variant (no <code>/+</code>, and without padding with <code>=</code>.</li>\n<li>I used ByteBuffer to convert between <code>int</code> and <code>byte[]</code> (the starting point for Base64).\nByte order LITTLE_ENDIAN to for variable length byte arrays representing numbers.</li>\n<li>Of course software quality requires checking the encryption; here numerical overflow is possible. For server code, logging is better. I use here the System Logger, which is a façade which any logging library can use. Making this code independent of the logging library the application uses.</li>\n<li>It should be mentioned that <code>A</code> is the zero, and here one might receive <code>...AAA</code> for values, because of the little endian order, least significant bytes first.</li>\n</ul>\n<p>Worth giving as answer is merely the Java details involved, ByteBuffer and Base64.</p>\n<pre><code>private static final int FACTOR = 3571;\nprivate static final int OFFSET = 234;\n\nprivate String companyIdToKey(int companyId) {\n    int seed = FACTOR * companyId + OFFSET;\n    ByteBuffer buffer = ByteBuffer.allocate(Integer.BYTES).order(ByteOrder.LITTLE_ENDIAN);\n    buffer.putInt(0, seed);\n    String key = Base64.getUrlEncoder().withoutPadding().encodeToString(buffer.array());\n    //if ((seed - OFFSET) / FACTOR != companyId) {\n    if (companyKeyToId(key) != companyId) {\n        System.getLogger(getClass().getName()).log(System.Logger.Level.ERROR, &quot;Overflow for company ID &quot; + companyId);\n        throw new IllegalStateException(&quot;Overflow for company ID &quot; + companyId);\n    }\n    return key;\n}\n\nprivate int companyKeyToId(String key) {\n    byte[] bytes = Base64.getUrlDecoder().decode(key);\n    ByteBuffer buffer = ByteBuffer.wrap(bytes).order(ByteOrder.LITTLE_ENDIAN);\n    buffer.put(Base64.getUrlDecoder().decode(key));\n    int seed = buffer.getInt(0);\n    int companyId = (seed - OFFSET) / FACTOR;\n    return companyId;\n}\n\n13 -&gt; QbYAAA\n</code></pre>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 960307,
      "reputation" : 110397,
      "user_id" : 984823,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/Z2KYN.jpg?s=256",
      "display_name" : "Joop Eggen",
      "link" : "https://stackoverflow.com/users/984823/joop-eggen"
    },
    "creation_date" : 1744196672,
    "last_activity_date" : 1744196672,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140320409,
    "post_id" : 79547117,
    "body" : "My first thought was that I need to have a method of determining a company ID directly from a string supplied by the user, because I didn&#39;t want them using something that could be &quot;lost,&quot; like a randomly-generated ID as posed in the first answer of the question suggested as the one this question should be closed in deference to. However, since this is a closed system, even in that case I could easily generate new (alternate/secret) IDs and issue updated URLs to the users and get everyone back on track. So that is what in fact I plan to do.",
    "score" : 0,
    "owner" : {
      "account_id" : 993644,
      "reputation" : 1623,
      "user_id" : 1010173,
      "user_type" : "registered",
      "accept_rate" : 64,
      "profile_image" : "https://www.gravatar.com/avatar/384e546b224f9a917459eea478d91b6f?s=256&d=identicon&r=PG",
      "display_name" : "Kevin Rahe",
      "link" : "https://stackoverflow.com/users/1010173/kevin-rahe"
    },
    "creation_date" : 1744289450,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140315377,
    "post_id" : 79547117,
    "body" : "What about creating a table in your private DB with all keys for companies, in which you only have access? Wouldn&#39;t it be easier?",
    "score" : 0,
    "owner" : {
      "account_id" : 2465829,
      "reputation" : 13577,
      "user_id" : 2148953,
      "user_type" : "registered",
      "accept_rate" : 96,
      "profile_image" : "https://i.sstatic.net/DVHoP84E.jpg?s=256",
      "display_name" : "aran",
      "link" : "https://stackoverflow.com/users/2148953/aran"
    },
    "creation_date" : 1744191906,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140315367,
    "post_id" : 79547117,
    "body" : "I guess the keywords you&#39;re looking for is &quot;obfuscation&quot; and &quot;deobfuscation&quot;. You could e.g. compose &quot;companyName+companyId&quot; and then base64-encode/decode it.",
    "score" : 0,
    "owner" : {
      "account_id" : 52822,
      "reputation" : 1114510,
      "user_id" : 157882,
      "user_type" : "registered",
      "accept_rate" : 93,
      "profile_image" : "https://www.gravatar.com/avatar/89927e2f4bde24991649b353a37678b9?s=256&d=identicon&r=PG",
      "display_name" : "BalusC",
      "link" : "https://stackoverflow.com/users/157882/balusc"
    },
    "creation_date" : 1744191738,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140311851,
    "post_id" : 79547117,
    "body" : "Reopened after your edit. I still don’t get your exact purpose, though. It’s OK that it’s semi-easy to find all client companies as long is it’s not <i>too</i> easy?",
    "score" : 0,
    "owner" : {
      "account_id" : 7612423,
      "reputation" : 87400,
      "user_id" : 5772882,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/8283c64511fa80afed5259d10850168f?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Anonymous",
      "link" : "https://stackoverflow.com/users/5772882/anonymous"
    },
    "creation_date" : 1744117829,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140287393,
    "post_id" : 79547117,
    "body" : "Also, this is in no way &quot;security.&quot; They&#39;re still going to have to provide a username and password in order to get into the application.",
    "score" : 0,
    "owner" : {
      "account_id" : 993644,
      "reputation" : 1623,
      "user_id" : 1010173,
      "user_type" : "registered",
      "accept_rate" : 64,
      "profile_image" : "https://www.gravatar.com/avatar/384e546b224f9a917459eea478d91b6f?s=256&d=identicon&r=PG",
      "display_name" : "Kevin Rahe",
      "link" : "https://stackoverflow.com/users/1010173/kevin-rahe"
    },
    "creation_date" : 1743533916,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140287349,
    "post_id" : 79547117,
    "body" : "For those who are skeptical of what I&#39;m trying to do, why would this be any different than Webex giving me a custom subdomain (my company name) that, along with a name that I give the room (which defaults to something anyone who encounters me on social media could easily guess), gets them to my personal room, where my branding is visible? (e.g. &lt;subdomain&gt;.my.webex.com/meet/&lt;roomname&gt;)",
    "score" : 0,
    "owner" : {
      "account_id" : 993644,
      "reputation" : 1623,
      "user_id" : 1010173,
      "user_type" : "registered",
      "accept_rate" : 64,
      "profile_image" : "https://www.gravatar.com/avatar/384e546b224f9a917459eea478d91b6f?s=256&d=identicon&r=PG",
      "display_name" : "Kevin Rahe",
      "link" : "https://stackoverflow.com/users/1010173/kevin-rahe"
    },
    "creation_date" : 1743533359,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140285270,
    "post_id" : 79547117,
    "body" : "If you want a requirement that mandates &quot;hashed identifiers&quot; it&#39;s because you don&#39;t want to expose the number of companies in your system, which is something regular incrementing integers would do (e.g. id 357 tells the user that there&#39;s at least 357 companies in the system). But controlling access is never the reason for hashed ids.",
    "score" : 2,
    "owner" : {
      "account_id" : 1041463,
      "reputation" : 3917,
      "user_id" : 1047418,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/3deab5aa1be96fe145d3103251263523?s=256&d=identicon&r=PG",
      "display_name" : "Torben",
      "link" : "https://stackoverflow.com/users/1047418/torben"
    },
    "creation_date" : 1743483095,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140285264,
    "post_id" : 79547117,
    "body" : "Stop. What you are trying to do is &quot;security through obscurity&quot; and it will never work. You need to implement proper access control so that people can only access information they are allowed to even if they guess the ID (or see it in leaked log files). If you continue with your original chosen path you will only be adding to the sad statistics of <a href=\"https://owasp.org/www-project-top-ten/\" rel=\"nofollow noreferrer\">owasp.org/www-project-top-ten</a> .",
    "score" : 1,
    "owner" : {
      "account_id" : 1041463,
      "reputation" : 3917,
      "user_id" : 1047418,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/3deab5aa1be96fe145d3103251263523?s=256&d=identicon&r=PG",
      "display_name" : "Torben",
      "link" : "https://stackoverflow.com/users/1047418/torben"
    },
    "creation_date" : 1743482861,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140284476,
    "post_id" : 79547117,
    "body" : "If you&#39;re just trying to hamper the casual user, could you just XOR the number with some secret value?",
    "score" : 1,
    "owner" : {
      "account_id" : 1085259,
      "reputation" : 80183,
      "user_id" : 1081110,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/Fp4Pm.jpg?s=256",
      "display_name" : "Dawood ibn Kareem",
      "link" : "https://stackoverflow.com/users/1081110/dawood-ibn-kareem"
    },
    "creation_date" : 1743456868,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140284471,
    "post_id" : 79547117,
    "body" : "why not add an extra field to the table that holds the IDs (hashedId), run a script to hash the id for all rows, use this field instead.",
    "score" : 0,
    "owner" : {
      "account_id" : 209503,
      "reputation" : 23867,
      "user_id" : 460557,
      "user_type" : "registered",
      "accept_rate" : 100,
      "profile_image" : "https://www.gravatar.com/avatar/b4565f97815833390c9c880e9e8522e4?s=256&d=identicon&r=PG",
      "display_name" : "Jorge Campos",
      "link" : "https://stackoverflow.com/users/460557/jorge-campos"
    },
    "creation_date" : 1743456729,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140284365,
    "post_id" : 79547117,
    "body" : "Actually, this would accomplish what I&#39;m looking to do if I can come up with my own set of numbers rather than using the ones published in the article: <a href=\"https://ericlippert.com/2013/11/14/a-practical-use-of-multiplicative-inverses/\" rel=\"nofollow noreferrer\">ericlippert.com/2013/11/14/&hellip;</a>",
    "score" : 0,
    "owner" : {
      "account_id" : 993644,
      "reputation" : 1623,
      "user_id" : 1010173,
      "user_type" : "registered",
      "accept_rate" : 64,
      "profile_image" : "https://www.gravatar.com/avatar/384e546b224f9a917459eea478d91b6f?s=256&d=identicon&r=PG",
      "display_name" : "Kevin Rahe",
      "link" : "https://stackoverflow.com/users/1010173/kevin-rahe"
    },
    "creation_date" : 1743454652,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140284301,
    "post_id" : 79547117,
    "body" : "If someone wants to go to all that trouble, more power to &#39;em. The information they&#39;ll be gaining isn&#39;t THAT valuable. I&#39;m just looking to prevent casual users from being able to easily poke around and get information they don&#39;t need to have.",
    "score" : 0,
    "owner" : {
      "account_id" : 993644,
      "reputation" : 1623,
      "user_id" : 1010173,
      "user_type" : "registered",
      "accept_rate" : 64,
      "profile_image" : "https://www.gravatar.com/avatar/384e546b224f9a917459eea478d91b6f?s=256&d=identicon&r=PG",
      "display_name" : "Kevin Rahe",
      "link" : "https://stackoverflow.com/users/1010173/kevin-rahe"
    },
    "creation_date" : 1743453052,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140284243,
    "post_id" : 79547117,
    "body" : "I can’t see you can have any security with such a scheme. If anyone really wants, they will break your hash and then still poke around and find all the companies. Even if they don’t break your hash or you assign each company a “secret” key, it doesn’t cost a lot to set up a script that tries all possible “secret” keys in turn,",
    "score" : 2,
    "owner" : {
      "account_id" : 7612423,
      "reputation" : 87400,
      "user_id" : 5772882,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/8283c64511fa80afed5259d10850168f?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Anonymous",
      "link" : "https://stackoverflow.com/users/5772882/anonymous"
    },
    "creation_date" : 1743451961,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}