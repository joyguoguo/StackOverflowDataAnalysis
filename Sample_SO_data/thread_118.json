{
  "question" : {
    "question_id" : 79834647,
    "title" : "Why does RestTemplate, starting from Java 21, run on a different thread even without virtual threads and without @Async, and why does MDC get lost?",
    "body" : "<p>i recently migrated from java17 to 21. I use logback MDC to log http request and response. each http request may lead to execute several resttemplate sync call. i use mdc to generate UUID as traceId in jakarta servlet filter and get MDC befre and after resttemplate call to log traceId and resttemolate request and response. after migrate to java 21 the resttemolate executes in different thread and mdc values missed. even if virtual thread is not enabled.</p>\n",
    "tags" : [ "java", "spring", "jvm", "resttemplate", "mdc" ],
    "owner" : {
      "account_id" : 8944604,
      "reputation" : 160,
      "user_id" : 6672520,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/-7-72q4R60E8/AAAAAAAAAAI/AAAAAAAAAEI/kZt7aHz43vM/s256-rj/photo.jpg",
      "display_name" : "Bashir Zamani",
      "link" : "https://stackoverflow.com/users/6672520/bashir-zamani"
    },
    "is_answered" : false,
    "view_count" : 62,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1764584031,
    "creation_date" : 1764584031,
    "link" : "https://stackoverflow.com/questions/79834647/why-does-resttemplate-starting-from-java-21-run-on-a-different-thread-even-wit",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ ],
  "answer_comments" : { }
}