{
  "question" : {
    "question_id" : 79618794,
    "title" : "Hibernate Fails to Handle Multiple REF_CURSOR Outputs with getResultList()",
    "body" : "<p>When calling a stored procedure with 1+ out REF_CURSOR's, it fails to retrieve the rows when using getResultList().</p>\n<p>Per the documentation, it mentions:</p>\n<blockquote>\n<p>&quot;When using REF_CURSOR parameters for result sets, the update counts should be exhausted before calling getResultList to retrieve the result set. Alternatively, the REF_CURSOR result set can be retrieved through getOutputParameterValue. Result set mappings will be applied to results corresponding to REF_CURSOR parameters in the order the REF_CURSOR parameters were registered with the query.&quot;</p>\n</blockquote>\n<p>The last sentence makes it seem as if repeat calls to .getResultList() will move the cursor to the next REF_CURSOR. However, that does not appear to be the cause.</p>\n<p>The title mentions how Hibernate &quot;fails&quot; to, however - this might be totally intended.</p>\n<p>I have:</p>\n<pre><code>StoredProcedureQuery storedProcedureQuery = entityManager\n    .createStoredProcedureQuery(&quot;SOME_STORED_PROC&quot;)\n    .registerStoredProcedureParameter(1, Integer.class, ParameterMode.IN)               \n    .registerStoredProcedureParameter(2, Object.class, ParameterMode.REF_CURSOR)\n    .registerStoredProcedureParameter(3, Object.class, ParameterMode.REF_CURSOR)  \n    .setParameter(1, 123);\n    \nstoredProcedureQuery.execute();\n\nList&lt;Object&gt; firstCursorResultList = storedProcedureQuery.getResultList(); // expected index 2 REF_CURSOR\nList&lt;Object&gt; secondCursorResultList = storedProcedureQuery.getResultList(); // expected index 3 REF_CURSOR\n</code></pre>\n<p>This code would result in an error saying the resultList is already closed.</p>\n<p><strong>Note:\nAn easy way to fix this is to just use getOutputParameterValue(2) and getOutputParameterValue(3).</strong></p>\n",
    "tags" : [ "java", "hibernate", "orm" ],
    "owner" : {
      "account_id" : 19700027,
      "reputation" : 1,
      "user_id" : 30520077,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/30617c586a4ae27d78f8b6114dd2703f?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Mike",
      "link" : "https://stackoverflow.com/users/30520077/mike"
    },
    "is_answered" : false,
    "view_count" : 24,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1747096722,
    "creation_date" : 1747096589,
    "link" : "https://stackoverflow.com/questions/79618794/hibernate-fails-to-handle-multiple-ref-cursor-outputs-with-getresultlist",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ ],
  "answer_comments" : { }
}