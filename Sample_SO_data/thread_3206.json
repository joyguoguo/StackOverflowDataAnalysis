{
  "question" : {
    "question_id" : 79565471,
    "title" : "Does Instant.MAX need to be manually formatted?",
    "body" : "<p><code>DateTimeFormatter</code> fails on valid <code>Instant</code>s. How it is meant to format those below and above <code>LocalDateTime.MIN</code> and <code>LocalDateTime.MAX</code>? Manually?</p>\n<pre><code>DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd HH:mm:ss&quot;).withZone(ZoneOffset.UTC).format(Instant.MAX)\n</code></pre>\n<p><strong>EDIT: For all future readers</strong></p>\n<p>The answer to this question is YES. It has to be done manually for the year of difference between <code>LocalDateTime.MAX</code> and <code>Instant.MAX</code>, and the same for the <code>MIN</code> range. Hence, <code>Instant</code>s has to be manually kept inside <code>LocalDateTime</code> valid range if <code>ofPattern()</code> is involved.</p>\n<p><strong>EDIT: Exception Thrown</strong></p>\n<p>The expression throws a <code>DateTimeException</code> with the message <em>Invalid value for EpochDay (valid values -365243219162 - 365241780471): 365241780837</em> and a stack trace like the following.</p>\n<pre class=\"lang-none prettyprint-override\"><code>Exception in thread &quot;main&quot; java.time.DateTimeException: Invalid value for EpochDay (valid values -365243219162 - 365241780471): 365241780837\n    at java.base/java.time.temporal.ValueRange.checkValidValue(ValueRange.java:319)\n    at java.base/java.time.temporal.ChronoField.checkValidValue(ChronoField.java:721)\n    at java.base/java.time.LocalDate.ofEpochDay(LocalDate.java:345)\n    at java.base/java.time.LocalDateTime.ofEpochSecond(LocalDateTime.java:424)\n    at java.base/java.time.ZonedDateTime.create(ZonedDateTime.java:458)\n    at java.base/java.time.ZonedDateTime.ofInstant(ZonedDateTime.java:411)\n    at java.base/java.time.chrono.IsoChronology.zonedDateTime(IsoChronology.java:401)\n    at java.base/java.time.chrono.IsoChronology.zonedDateTime(IsoChronology.java:127)\n    at java.base/java.time.format.DateTimePrintContext.adjust(DateTimePrintContext.java:150)\n    at java.base/java.time.format.DateTimePrintContext.&lt;init&gt;(DateTimePrintContext.java:119)\n    at java.base/java.time.format.DateTimeFormatter.formatTo(DateTimeFormatter.java:1903)\n    at java.base/java.time.format.DateTimeFormatter.format(DateTimeFormatter.java:1879)\n    at Main.main(Main.java:17)\n</code></pre>\n",
    "tags" : [ "java", "date", "time", "datetimeformatter", "java.time.instant" ],
    "owner" : {
      "account_id" : 1848634,
      "reputation" : 1647,
      "user_id" : 1675724,
      "user_type" : "registered",
      "accept_rate" : 61,
      "profile_image" : "https://i.sstatic.net/pDYqk.jpg?s=256",
      "display_name" : "Brethlosze",
      "link" : "https://stackoverflow.com/users/1675724/brethlosze"
    },
    "is_answered" : true,
    "view_count" : 189,
    "closed_date" : 1744280901,
    "answer_count" : 2,
    "score" : -3,
    "last_activity_date" : 1744311921,
    "creation_date" : 1744240383,
    "link" : "https://stackoverflow.com/questions/79565471/does-instant-max-need-to-be-manually-formatted",
    "closed_reason" : "Needs details or clarity"
  },
  "answers" : [ {
    "answer_id" : 79566304,
    "question_id" : 79565471,
    "body" : "<h2>DateTimeFormatterBuilder.appendInstant(int fractionalDigits)</h2>\n<p>As a supplement to the answer by Basil Bourque, if you prefer, you can create a formatter that leaves out the fractional seconds of an <code>Instant</code>. You will still have to delete <code>T</code> and <code>Z</code> yourself if you don’t want them. So you may consider that it is not worth it.</p>\n<p>The formatter would be:</p>\n<pre><code>public static final DateTimeFormatter instantFormatterNoFraction\n        = new DateTimeFormatterBuilder()\n                .appendInstant(0)\n                .toFormatter(Locale.ROOT);\n</code></pre>\n<p>The 0 passed to <code>appendInstant()</code> specifies that we want no fractional digits.</p>\n<p>Demonstration:</p>\n<pre><code>    String noFractionalSeconds = instantFormatterNoFraction.format(Instant.MAX);\n    String noTAndZ = noFractionalSeconds.replace('T', ' ').replace(&quot;Z&quot;, &quot;&quot;);\n    System.out.println(noTAndZ);\n</code></pre>\n<p>Output:</p>\n<blockquote>\n<p>+1000000000-12-31 23:59:59</p>\n</blockquote>\n<h2>Why did your code fail?</h2>\n<p>It seems to be a design decision that the formatters obtained from <code>DateTimeFormatter.ofPattern()</code> do not support the year 1 000 000 000 even when <code>Instant</code> does support dates in this year in UTC. It may have to do with not wanting to risk that parsing with such a formatter would lead to values that are out of range for other date-time types such as <code>LocalDateTime</code>; but this is speculation. Due to the complicated nature of date and time, no consistent min and max values can exist across all date-time types, so some compromises like this one are necessary.</p>\n<p>Basil Bourque in his answer correctly mentions that year 1 000 000 000 does not fit with your specification of a 4 digit year. This has nothing to do with your code failing, though. Your formatter does support years outside the four digit range. It will print them with the necessary number of digits (up to 9, I believe, since it does not support dates in year 1 000 000 000) and with a <code>+</code> sign.</p>\n<h2>Documentation link</h2>\n<p><a href=\"https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/time/format/DateTimeFormatterBuilder.html#appendInstant(int)\" rel=\"nofollow noreferrer\">DateTimeFormatterBuilder.appendInstant(int)</a></p>\n",
    "score" : 4,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 41316755,
      "reputation" : 43,
      "user_id" : 30232118,
      "user_type" : "unregistered",
      "profile_image" : "https://www.gravatar.com/avatar/8bf18e9c9dad9065494db4ecb480e245?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Manea Schmit",
      "link" : "https://stackoverflow.com/users/30232118/manea-schmit"
    },
    "creation_date" : 1744278486,
    "last_activity_date" : 1744286162,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79565618,
    "question_id" : 79565471,
    "body" : "<h2>tl;dr</h2>\n<pre><code>String result = Instant.MAX.truncatedTo( ChronoUnit.SECONDS ).toString().replace( &quot;T&quot; , &quot; &quot; ) ;\n</code></pre>\n<h2>Just an <code>Instant</code>, but with a large year number</h2>\n<p><a href=\"https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/time/Instant.html#MAX\" rel=\"nofollow noreferrer\"><code>Instant.MAX</code></a> is just an <code>Instant</code> object, like any other <code>Instant</code> object.</p>\n<h3>ISO 8601</h3>\n<p>You can generate text to represent its value merely by calling <a href=\"https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/time/Instant.html#toString()\" rel=\"nofollow noreferrer\"><code>toString</code></a>. The result is in standard <a href=\"https://en.m.wikipedia.org/wiki/ISO_8601\" rel=\"nofollow noreferrer\">ISO 8601</a> format. That would be: <code>1000000000-12-31T23:59:59.999999999Z</code>. The <code>Z</code> is short for <code>+00:00</code>, meaning an offset from the temporal meridian of UTC of zero hours-minutes-seconds.</p>\n<p>Notice the year is 1,000,000,000. Your custom formatting pattern does not fit, having specified four digits rather than ten.</p>\n<h3><code>String#replace</code></h3>\n<p>If you want text without the <code>T</code> in the middle, the simplest solution is string manipulation.</p>\n<pre><code>Instant.MAX.toString().replace( &quot;T&quot; , &quot; &quot; )\n</code></pre>\n<h3>Truncate</h3>\n<p>If you don’t want the fractional second, <a href=\"https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/time/Instant.html#truncatedTo(java.time.temporal.TemporalUnit)\" rel=\"nofollow noreferrer\">truncate</a>.</p>\n<pre><code>Instant\n    .MAX\n    .truncatedTo( ChronoUnit.SECONDS )\n    .toString()\n    .replace( &quot;T&quot; , &quot; &quot; )\n</code></pre>\n",
    "score" : 3,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 322981,
      "reputation" : 346951,
      "user_id" : 642706,
      "user_type" : "registered",
      "accept_rate" : 58,
      "profile_image" : "https://i.sstatic.net/ZWEI3.jpg?s=256",
      "display_name" : "Basil Bourque",
      "link" : "https://stackoverflow.com/users/642706/basil-bourque"
    },
    "creation_date" : 1744251216,
    "last_activity_date" : 1744276435,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140323218,
    "post_id" : 79565471,
    "body" : "In particular when going outside the 4 digit year range you should prefer <code>uuuu</code> over <code>yyyy</code> for year. The difference is that <code>u</code> is a <i>signed</i> year, so years before the common era are number 0, -1, -2, etc. whereas <code>y</code> numbers them 1, 2, 3. leaving the reader in the dark about the years belonging to a different era. In particular when years near the minimum (or just before 9999 BCE) are also printed with a plus sign, <code>+</code>, this will be confusing. <code>u</code> gives you a minus sign <code>-</code>, far more helpful.",
    "score" : 0,
    "owner" : {
      "account_id" : 7612423,
      "reputation" : 87400,
      "user_id" : 5772882,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/8283c64511fa80afed5259d10850168f?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Anonymous",
      "link" : "https://stackoverflow.com/users/5772882/anonymous"
    },
    "creation_date" : 1744351605,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140321921,
    "post_id" : 79565471,
    "body" : "The question was if those Instants had to be formatted manually or not. The answer is yes, and the range is the one originally mentioned as <code>LocalDateTime.MIN</code> and <code>LocalDateTime.MAX</code> which is the one which must be kept if any <code>ofPattern</code> call is involved, disregarding the manual <code>.replace</code> tricks. +1 for realizing he was trolling, as well as I gave him a congratulation for his comment. This lack of precision is why globally curing Q&amp;A through AI is better.",
    "score" : 0,
    "owner" : {
      "account_id" : 1848634,
      "reputation" : 1647,
      "user_id" : 1675724,
      "user_type" : "registered",
      "accept_rate" : 61,
      "profile_image" : "https://i.sstatic.net/pDYqk.jpg?s=256",
      "display_name" : "Brethlosze",
      "link" : "https://stackoverflow.com/users/1675724/brethlosze"
    },
    "creation_date" : 1744312568,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140319745,
    "post_id" : 79565471,
    "body" : "@Brethlosze Sweeper was not trolling but actually trying to help, as he often does with other questions. He correctly pointed out that if you use <code>DateTimeFormatter.ISO_INSTANT</code> it will work, and pointed out that it&#39;s a very rare use case that anyone would want to format <code>Instant.MAX</code> as text. It&#39;s just that it doesn&#39;t work with <code>withZone</code> for some reason (as Anonymous pointed out).",
    "score" : 2,
    "owner" : {
      "account_id" : 19118721,
      "reputation" : 12469,
      "user_id" : 13963086,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/9df2c3c4c87d8050b8fd6a59c88c7133?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "k314159",
      "link" : "https://stackoverflow.com/users/13963086/k314159"
    },
    "creation_date" : 1744278389,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140319408,
    "post_id" : 79565471,
    "body" : "@Sweeper <code>DateTimeFormatter.ISO_INSTANT.format(Instant.MAX)</code> works and gives <code>+1000000000-12-31T23:59:59.999999999Z</code>, the same as <code>Instant.MAX.toString()</code>. <code>DateTimeFormatter.ISO_INSTANT.withZone(ZoneOffset.UTC).forma&zwnj;&#8203;t(Instant.MAX)</code> fails too.",
    "score" : 0,
    "owner" : {
      "account_id" : 7612423,
      "reputation" : 87400,
      "user_id" : 5772882,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/8283c64511fa80afed5259d10850168f?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Anonymous",
      "link" : "https://stackoverflow.com/users/5772882/anonymous"
    },
    "creation_date" : 1744272531,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140318397,
    "post_id" : 79565471,
    "body" : "Use <code>DateTimeFormatter.ISO_INSTANT</code>? Why would you want to format a <code>Instant.MAX</code> in the first place?",
    "score" : 3,
    "owner" : {
      "account_id" : 6651855,
      "reputation" : 292025,
      "user_id" : 5133585,
      "user_type" : "registered",
      "accept_rate" : 96,
      "profile_image" : "https://i.sstatic.net/dfqcw.png?s=256",
      "display_name" : "Sweeper",
      "link" : "https://stackoverflow.com/users/5133585/sweeper"
    },
    "creation_date" : 1744241871,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79566304" : [ {
      "comment_id" : 140319796,
      "post_id" : 79566304,
      "body" : "@k314159 Thanks for the precision, I have edited to include this information.",
      "score" : 0,
      "owner" : {
        "account_id" : 41316755,
        "reputation" : 43,
        "user_id" : 30232118,
        "user_type" : "unregistered",
        "profile_image" : "https://www.gravatar.com/avatar/8bf18e9c9dad9065494db4ecb480e245?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "Manea Schmit",
        "link" : "https://stackoverflow.com/users/30232118/manea-schmit"
      },
      "creation_date" : 1744279348,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140319767,
      "post_id" : 79566304,
      "body" : "It actually works except for the last 366 days (so the last year). It works up to <code>999999999-12-31T23:59:59.999999999Z</code> but not a nanosecond after.",
      "score" : 0,
      "owner" : {
        "account_id" : 19118721,
        "reputation" : 12469,
        "user_id" : 13963086,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/9df2c3c4c87d8050b8fd6a59c88c7133?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "k314159",
        "link" : "https://stackoverflow.com/users/13963086/k314159"
      },
      "creation_date" : 1744278762,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}