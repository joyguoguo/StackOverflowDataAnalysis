{
  "question" : {
    "question_id" : 79583519,
    "title" : "Hibernate envers force child entity revision when parent entity changes",
    "body" : "<p>I have current manual auditing process using JPA and Hibernate. I am using same tables for storing all versions of entities. Current version will have active flag as <code>'Y'</code>.</p>\n<p>e.g. <code>employeees</code> -&gt; <code>adresses</code>. This is my entity structure:</p>\n<ol>\n<li>When employee is saved, I will insert new row in <code>employees</code> (with new guid PK).</li>\n<li>Insert corresponding rows in adresses table with foreign key as new generated PK.</li>\n<li>Update previous active record in employeees as inactive.</li>\n<li>Update newly inserted record as active.</li>\n</ol>\n<p>With this approach, it's easier to find all the parent-child data on each version of parent.</p>\n<p>Now I want to maintain versions in separate tables instead of the same one. e.g. <code>employeees_aud</code>, <code>adresses_aud</code>.</p>\n<p>I checked Hibernate envers to audit the changes. But it only inserts a new revision in audit when anything changes. I cannot force child entities to get audited.</p>\n<p>One way is to add extra field in all child tables and touch the field when parent entity is being saved. But I don't want to add these new fields.</p>\n<p>Is there better way of doing this in Hibernate envers?</p>\n",
    "tags" : [ "java", "hibernate", "jpa", "audit", "hibernate-envers" ],
    "owner" : {
      "account_id" : 2448724,
      "reputation" : 39,
      "user_id" : 2135483,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/7e37c3da985184aa80f43ef51ff0fd49?s=256&d=identicon&r=PG",
      "display_name" : "pingo_bingo",
      "link" : "https://stackoverflow.com/users/2135483/pingo-bingo"
    },
    "is_answered" : false,
    "view_count" : 98,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1745287708,
    "creation_date" : 1745165363,
    "link" : "https://stackoverflow.com/questions/79583519/hibernate-envers-force-child-entity-revision-when-parent-entity-changes",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140352946,
    "post_id" : 79583519,
    "body" : "Employee has numeric employee_id which is not PK and guid id which is PK. When anything changes, new PK for empoyee is created and new child table rows associated with this PK is inserted. This way I can easily find what happened on this particular employee version.",
    "score" : 0,
    "owner" : {
      "account_id" : 2448724,
      "reputation" : 39,
      "user_id" : 2135483,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/7e37c3da985184aa80f43ef51ff0fd49?s=256&d=identicon&r=PG",
      "display_name" : "pingo_bingo",
      "link" : "https://stackoverflow.com/users/2135483/pingo-bingo"
    },
    "creation_date" : 1745179226,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140352743,
    "post_id" : 79583519,
    "body" : "Why do Employee&#39;s get a new PK when changed - doesn&#39;t it defeat the purpose of entities maintaining identity? Sounds like your Addresses maybe aren&#39;t entities and should be embeddable entries so that their lifecycles are tied to the parent Employee entity instead. Otherwise, if the address hasn&#39;t changed, why would you create new historical versions of them?",
    "score" : 0,
    "owner" : {
      "account_id" : 231721,
      "reputation" : 21335,
      "user_id" : 496099,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/efa7510cf47d7bd79e80486246e7e39e?s=256&d=identicon&r=PG",
      "display_name" : "Chris",
      "link" : "https://stackoverflow.com/users/496099/chris"
    },
    "creation_date" : 1745171875,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}