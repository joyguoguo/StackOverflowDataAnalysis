{
  "question" : {
    "question_id" : 79537079,
    "title" : "Inserting data with UCanAccess from big text files is very slow - Processing Nulls",
    "body" : "<p>Since am not allowed to comment on the original discussion (<a href=\"https://stackoverflow.com/questions/37420474/inserting-data-with-ucanaccess-from-big-text-files-is-very-slow\">Inserting data with UCanAccess from big text files is very slow</a>) because I don't have enough points, am having to start a new one.</p>\n<p>I have implemented the code discussed above (thank you Gord Thompson), but it is not handing nulls. When I either use the word 'null' (without quotes) or simply leave no value in my CSV field, it will not import into a predefined table (in this case a nullable double field). This even includes when I implement my own com.healthmarketscience.jackcess.util.ImportFilter.</p>\n<p>Looking at the Jackcess code, I see the problem in com.healthmarketscience.jackcess.impl.ColumnImpl (in Jackcess 4.0.0 JAR). The relevant method is the  ColumnImpl::toNumber method, where, in the event of encountering a null, returns a BigDecimal.ZERO, which is obviously not null</p>\n<p>Having said all that, my code is failing in ColumnImpl::toNumber on the return statement at the end...</p>\n<p>return Double.valueOf(value.toString());</p>\n<p>...meaning I have not successfully passed in a null at this point, just an empty string. I can override this within the ImportFilter implementation, but as indicated above, it would still return the non-null BigDecimal.ZERO value.</p>\n<p>Not sure how to get around this other than return special values that I can convert to null with successive update queries. Also, predefined table / field level macros in MS Access do not seem to get triggered when importing data (at least not that I've seen so far). Either solution is not ideal though, it would be nice if nulls were handled properly.</p>\n<p>Any ideas?</p>\n<p>Thanks,</p>\n<p>Matthew</p>\n<p>P. S. trying to do a call out to Gord Thompson, but the '@' thing is not working for me (not enough points, perhaps?).</p>\n",
    "tags" : [ "java", "ms-access", "null", "ucanaccess", "jackcess" ],
    "owner" : {
      "account_id" : 17690418,
      "reputation" : 41,
      "user_id" : 12842318,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/4a0b10eebebd9c1703a50b2246a7a1b5?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "lastfreedom",
      "link" : "https://stackoverflow.com/users/12842318/lastfreedom"
    },
    "is_answered" : true,
    "view_count" : 64,
    "answer_count" : 1,
    "score" : 1,
    "last_activity_date" : 1743026441,
    "creation_date" : 1743016808,
    "link" : "https://stackoverflow.com/questions/79537079/inserting-data-with-ucanaccess-from-big-text-files-is-very-slow-processing-nul",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79537360,
    "question_id" : 79537079,
    "body" : "<p>The following logic for ImportFilter::filterRow works (at least for my scenario in which I don't use empty strings)...</p>\n<pre><code>    public Object[] filterRow(Object[] row) throws SQLException, IOException {\n\n    Object[] lclReturn = new Object[row.length];\n\n    for (int i = 0; i &lt; row.length; i++) {\n\n        Object lclObject = row[i];\n\n        if (lclObject != null) {\n\n        if (!&quot;&quot;.equals(lclObject.toString().trim())) {\n            lclReturn[i] = lclObject;\n        } else {\n            lclReturn[i] = null;\n        }\n\n        } else {\n        lclReturn[i] = null;\n        }\n\n    }\n\n    return lclReturn;\n    }\n</code></pre>\n",
    "score" : 1,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 17690418,
      "reputation" : 41,
      "user_id" : 12842318,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/4a0b10eebebd9c1703a50b2246a7a1b5?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "lastfreedom",
      "link" : "https://stackoverflow.com/users/12842318/lastfreedom"
    },
    "creation_date" : 1743026441,
    "last_activity_date" : 1743026441,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140267032,
    "post_id" : 79537079,
    "body" : "Hello, thanks for the reply. It looks like there may have been a bug in my implementation of the ImportFilter::filterRow logic. I was returning the original object array passed in, instead of the one that I had created. The logic I&#39;ve posted below works",
    "score" : 1,
    "owner" : {
      "account_id" : 17690418,
      "reputation" : 41,
      "user_id" : 12842318,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/4a0b10eebebd9c1703a50b2246a7a1b5?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "lastfreedom",
      "link" : "https://stackoverflow.com/users/12842318/lastfreedom"
    },
    "creation_date" : 1743026305,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140266693,
    "post_id" : 79537079,
    "body" : "can you provide the stack trace of the failure are seeing?  a null value should not ever make it into the <code>toNumber()</code> logic.  if you implemented your filter to pass in a proper <code>null</code> value for blank values, then that should work.",
    "score" : 1,
    "owner" : {
      "account_id" : 265649,
      "reputation" : 53782,
      "user_id" : 552759,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/f8c60eb5f46783d753e86238a9c18cd9?s=256&d=identicon&r=PG",
      "display_name" : "jtahlborn",
      "link" : "https://stackoverflow.com/users/552759/jtahlborn"
    },
    "creation_date" : 1743019191,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79537360" : [ {
      "comment_id" : 140267042,
      "post_id" : 79537360,
      "body" : "(apologies for the odd formatting)",
      "score" : 0,
      "owner" : {
        "account_id" : 17690418,
        "reputation" : 41,
        "user_id" : 12842318,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/4a0b10eebebd9c1703a50b2246a7a1b5?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "lastfreedom",
        "link" : "https://stackoverflow.com/users/12842318/lastfreedom"
      },
      "creation_date" : 1743026477,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}