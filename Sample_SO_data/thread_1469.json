{
  "question" : {
    "question_id" : 79702910,
    "title" : "Why does Spring Boot insist on serializing my ZonedDateTime type data as a floating-point timestamp in seconds?",
    "body" : "<p>The Spring Boot insist on serializing my <code>ZonedDateTime</code> type data as a floating-point timestamp in seconds. I have tried all the methods online, but none of them could make it give up.\nTo be precise, the rest controller always serializes <code>ZonedDateTime</code> type fields as floating-point timestamps in seconds.</p>\n<p>I have tried most of the solutions available online, which do allow me to manually inject <code>ObjectMapper</code> and manually serialize to get my custom result, but none of this works for the rest controller. My custom serialization code is not even executed.</p>\n<p>I have tried <code>@JsonComponent</code>, custom <code>ObjectMapper</code>, and <code>Jackson2ObjectMapperBuilderCustomizer</code>, but Spring Boot always insists on its own way. It’s really a framework that’s hard to control.</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Configuration\npublic class JacksonConfig {\n  // The code was indeed executed, but it didn't work; at least the rest controller ignored me\n  @Bean\n  @Primary\n  public ObjectMapper objectMapper(Jackson2ObjectMapperBuilder builder) {\n    var objectMapper = builder.build();\n    SimpleModule module = new SimpleModule(&quot;CustomZonedDateTimeModule&quot;);\n    module.addSerializer(ZonedDateTime.class, new ZonedDateTimeTimestampSerializer());\n    objectMapper.registerModule(module);\n    return objectMapper;\n  }\n}\n</code></pre>\n<pre class=\"lang-java prettyprint-override\"><code>@JsonComponent // I have tried @JsonComponent, not work.\npublic class ZonedDateTimeTimestampSerializer extends JsonSerializer&lt;ZonedDateTime&gt; {\n    \n    @Override\n    public void serialize(ZonedDateTime value, JsonGenerator gen, SerializerProvider serializers) \n            throws IOException {\n        if (value != null) {\n            gen.writeNumber(value.toInstant().toEpochMilli());\n        }\n    }\n}\n</code></pre>\n<pre class=\"lang-java prettyprint-override\"><code>@Configuration\npublic class JacksonConfig implements Jackson2ObjectMapperBuilderCustomizer {\n  // The code was indeed executed, but it didn't work; at least the rest controller ignored me\n\n  public void customize(Jackson2ObjectMapperBuilder builder) {\n    SimpleModule module = new SimpleModule(&quot;CustomZonedDateTimeModule&quot;);\n    module.addSerializer(ZonedDateTime.class, new ZonedDateTimeTimestampSerializer());\n    builder.modules(module);\n  }\n}\n</code></pre>\n<pre class=\"lang-java prettyprint-override\"><code>@Configuration\npublic class JacksonConfig {\n  // The code was indeed executed, but it didn't work; at least the rest controller ignored me\n  @Bean\n  @Primary\n  public JavaTimeModule javaTimeModule() {\n    var module = new JavaTimeModule();\n    module.addSerializer(ZonedDateTime.class, new ZonedDateTimeTimestampSerializer());\n    return module;\n  }\n}\n</code></pre>\n<p>Also, just to mention, I am using WebFlux, not sure if that makes a difference. It's hard to believe that such a seemingly simple issue has stumped me; Spring's black box nature is too severe, and the configuration is overly opaque.</p>\n",
    "tags" : [ "java", "spring-boot", "jackson", "spring-webflux" ],
    "owner" : {
      "account_id" : 3710550,
      "reputation" : 1109,
      "user_id" : 3087999,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/22b7d15478863b6ed0d4ad28634b961a?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "vipcxj",
      "link" : "https://stackoverflow.com/users/3087999/vipcxj"
    },
    "is_answered" : true,
    "view_count" : 102,
    "answer_count" : 1,
    "score" : 2,
    "last_activity_date" : 1752641562,
    "creation_date" : 1752640279,
    "link" : "https://stackoverflow.com/questions/79702910/why-does-spring-boot-insist-on-serializing-my-zoneddatetime-type-data-as-a-float",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79702920,
    "question_id" : 79702910,
    "body" : "<p>It might really be related to WebFlux, because I am currently not using the traditional REST controller, so I’m not sure if the traditional REST controller has this issue as well. But I guess it probably doesn’t, otherwise there would have been widespread complaints online by now.</p>\n<pre class=\"lang-java prettyprint-override\"><code>\n@Configuration\n@EnableWebFlux\n@RequiredArgsConstructor\npublic class WebConfigure implements WebFluxConfigurer {\n    private final ObjectMapper objectMapper;\n\n    // This is the key point: WebFlux does not use the ObjectMapper managed by Spring, but instead creates its own, which causes all my Jackson configurations to hardly take effect.\n    @Override\n    public void configureHttpMessageCodecs(@NonNull ServerCodecConfigurer configurer) {\n        configurer.defaultCodecs().jackson2JsonEncoder(new Jackson2JsonEncoder(objectMapper));\n        configurer.defaultCodecs().jackson2JsonDecoder(new Jackson2JsonDecoder(objectMapper));\n    }\n}\n</code></pre>\n",
    "score" : 0,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 3710550,
      "reputation" : 1109,
      "user_id" : 3087999,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/22b7d15478863b6ed0d4ad28634b961a?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "vipcxj",
      "link" : "https://stackoverflow.com/users/3087999/vipcxj"
    },
    "creation_date" : 1752641562,
    "last_activity_date" : 1752641562,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140593643,
    "post_id" : 79702910,
    "body" : "Add an example input, actual output and expected output to the question.",
    "score" : 0,
    "owner" : {
      "account_id" : 372682,
      "reputation" : 26512,
      "user_id" : 721855,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/vZiox.png?s=256",
      "display_name" : "aled",
      "link" : "https://stackoverflow.com/users/721855/aled"
    },
    "creation_date" : 1752662911,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140593593,
    "post_id" : 79702910,
    "body" : "What does your RestController look like?",
    "score" : 0,
    "owner" : {
      "account_id" : 13252051,
      "reputation" : 1788,
      "user_id" : 9569292,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/s256-rj/photo.jpg",
      "display_name" : "Thomas Timbul",
      "link" : "https://stackoverflow.com/users/9569292/thomas-timbul"
    },
    "creation_date" : 1752661873,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79702920" : [ {
      "comment_id" : 140599371,
      "post_id" : 79702920,
      "body" : "@ThomasTimbul Yes, but Stack Overflow does not allow you to accept your own answer immediately; you have to wait for a period of time",
      "score" : 0,
      "owner" : {
        "account_id" : 3710550,
        "reputation" : 1109,
        "user_id" : 3087999,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/22b7d15478863b6ed0d4ad28634b961a?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "vipcxj",
        "link" : "https://stackoverflow.com/users/3087999/vipcxj"
      },
      "creation_date" : 1752828874,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140593600,
      "post_id" : 79702920,
      "body" : "And did this bit of configuration solve your problem? If so, you can accept your own answer.",
      "score" : 0,
      "owner" : {
        "account_id" : 13252051,
        "reputation" : 1788,
        "user_id" : 9569292,
        "user_type" : "registered",
        "profile_image" : "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/s256-rj/photo.jpg",
        "display_name" : "Thomas Timbul",
        "link" : "https://stackoverflow.com/users/9569292/thomas-timbul"
      },
      "creation_date" : 1752662019,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}