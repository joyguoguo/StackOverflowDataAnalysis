{
  "question" : {
    "question_id" : 79604591,
    "title" : "How to mock a final class with mockito-core &gt; 5.2.0 and without mockito-inline?",
    "body" : "<p>I have been searching the internet for this one for quite sometimes, and I can't find a definite answer. <a href=\"https://mvnrepository.com/artifact/org.mockito/mockito-inline\" rel=\"nofollow noreferrer\">Mockito-inline</a> is now deprecated, so I am trying to run my tests with only <a href=\"https://mvnrepository.com/artifact/org.mockito/mockito-core\" rel=\"nofollow noreferrer\">mockito-core</a> &gt; 5.2.0. But, I am plagued with this error message.</p>\n<blockquote>\n<p>Cannot mock/spy class org.springframework.security.config.annotation.web.builders.HttpSecurity\nMockito cannot mock/spy because :</p>\n<ul>\n<li>final class</li>\n</ul>\n</blockquote>\n<p>The only solution, I see, is to keep the deprecated library, but it means to keep a deprecated library.</p>\n<p>These two code blocks will trigger the error</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Mock\nprivate FinalClassFromALibrary finalClassFromALibrary;\n</code></pre>\n<pre class=\"lang-java prettyprint-override\"><code>FinalClassFromALibrary finalClassFromALibrary = mock(FinalClassFromALibrary.class);\n</code></pre>\n",
    "tags" : [ "java", "mockito" ],
    "owner" : {
      "account_id" : 29044930,
      "reputation" : 364,
      "user_id" : 22248986,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/cda122285ea37952e1eb4de6dec0a5bf?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Clarence the Bard",
      "link" : "https://stackoverflow.com/users/22248986/clarence-the-bard"
    },
    "is_answered" : false,
    "view_count" : 197,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1746268887,
    "creation_date" : 1746267970,
    "link" : "https://stackoverflow.com/questions/79604591/how-to-mock-a-final-class-with-mockito-core-5-2-0-and-without-mockito-inline",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140571803,
    "post_id" : 79604591,
    "body" : "Firstly, mockito-inline is now deprecated because it is now the default - mockito-core now uses the inline mock maker. See <a href=\"https://github.com/mockito/mockito/releases/tag/v5.0.0\" rel=\"nofollow noreferrer\">github.com/mockito/mockito/releases/tag/v5.0.0</a> Secondly, make sure you are not pulling in some unexpected mockito version (print tree of dependencies using your build tool - Spring has its own version overrides). Your problem does not reproduce on a project with minimal dependencies.",
    "score" : 0,
    "owner" : {
      "account_id" : 1713236,
      "reputation" : 26569,
      "user_id" : 1570854,
      "user_type" : "registered",
      "accept_rate" : 71,
      "profile_image" : "https://i.sstatic.net/ef6Ng.jpg?s=256",
      "display_name" : "Lesiak",
      "link" : "https://stackoverflow.com/users/1570854/lesiak"
    },
    "creation_date" : 1751920988,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140393712,
    "post_id" : 79604591,
    "body" : "What @forty-two means is: if possible, you should at looking improving your production code so that becomes easy to test, instead of using a big hammer to test hard-to-test code.",
    "score" : 2,
    "owner" : {
      "account_id" : 1663234,
      "reputation" : 140808,
      "user_id" : 1531124,
      "user_type" : "registered",
      "accept_rate" : 96,
      "profile_image" : "https://i.sstatic.net/zw18i.png?s=256",
      "display_name" : "GhostCat",
      "link" : "https://stackoverflow.com/users/1531124/ghostcat"
    },
    "creation_date" : 1746327966,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140393495,
    "post_id" : 79604591,
    "body" : "Mocking concrete classes, final or not, is always a code smell. But that might not help you much.",
    "score" : 2,
    "owner" : {
      "account_id" : 116746,
      "reputation" : 12898,
      "user_id" : 306030,
      "user_type" : "registered",
      "accept_rate" : 70,
      "profile_image" : "https://i.sstatic.net/y053l.jpg?s=256",
      "display_name" : "forty-two",
      "link" : "https://stackoverflow.com/users/306030/forty-two"
    },
    "creation_date" : 1746310081,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140392467,
    "post_id" : 79604591,
    "body" : "include the mockito-agent as a test-time runtime dependency in your project",
    "score" : 0,
    "owner" : {
      "account_id" : 2465829,
      "reputation" : 13577,
      "user_id" : 2148953,
      "user_type" : "registered",
      "accept_rate" : 96,
      "profile_image" : "https://i.sstatic.net/DVHoP84E.jpg?s=256",
      "display_name" : "aran",
      "link" : "https://stackoverflow.com/users/2148953/aran"
    },
    "creation_date" : 1746269106,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}