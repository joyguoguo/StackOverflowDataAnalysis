{
  "question" : {
    "question_id" : 79573442,
    "title" : "Why Sampler node returning null? JMeter API",
    "body" : "<p>I'm trying to add a regex extractor to each sample whose content type is equal to text/html, but my sample always returns null. Seems that the response body is okay and returns the correct response. I've researched before and it seems that some JMeter update broke the code. Any tips on how I can get this code working again?</p>\n<p>By the way I got this code from <a href=\"https://github.com/zkoss/zkjmeterplugin/tree/master\" rel=\"nofollow noreferrer\">https://github.com/zkoss/zkjmeterplugin/tree/master</a></p>\n<p><img src=\"https://i.sstatic.net/rOMlHNkZ.png\" alt=\"Jmeter 5.6.3 Log\" /></p>\n<pre class=\"lang-java prettyprint-override\"><code>package org.zkoss.testing.jmeter;\n\nimport org.apache.jmeter.config.Argument;\nimport org.apache.jmeter.config.Arguments;\nimport org.apache.jmeter.exceptions.IllegalUserActionException;\nimport org.apache.jmeter.extractor.RegexExtractor;\nimport org.apache.jmeter.extractor.gui.RegexExtractorGui;\nimport org.apache.jmeter.gui.GuiPackage;\nimport org.apache.jmeter.gui.tree.JMeterTreeModel;\nimport org.apache.jmeter.gui.tree.JMeterTreeNode;\nimport org.apache.jmeter.protocol.http.proxy.ProxyControl;\nimport org.apache.jmeter.protocol.http.sampler.HTTPSamplerBase;\nimport org.apache.jmeter.samplers.SampleResult;\nimport org.apache.jmeter.testelement.TestElement;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\npublic class ZkProxyControl extends ProxyControl {\n    private static final long serialVersionUID = 2851218983765186150L;\n\n    private static String AU_PATH = &quot;ZkProxyControlGui.auPath&quot;;\n\n    private static final int DEFAULT_PORT = 9999;\n    private static final String DEFAULT_AU_PATH = &quot;/zkau&quot;;\n    private static final String DEFAULT_EXCLUDED_PATTERN = &quot;.*/zkau/web/.*&quot;;\n    private static final Logger LOG = LoggerFactory.getLogger(ZkProxyControl.class);\n\n    public ZkProxyControl() {\n        super();\n        this.setPort(DEFAULT_PORT);\n        this.setAuPath(DEFAULT_AU_PATH);\n        this.addExcludedPattern(DEFAULT_EXCLUDED_PATTERN);\n    }\n\n    public synchronized void deliverSampler(HTTPSamplerBase sampler,\n                                            TestElement[] subConfigs, SampleResult result) {\n\n        super.deliverSampler(sampler, subConfigs, result);\n\n        final String auPath = getAuPath();\n\n        if (result.getContentType().startsWith(&quot;text/html&quot;)) {// zul page\n\n            JMeterTreeModel treeModel = GuiPackage.getInstance().getTreeModel();\n            JMeterTreeNode newNode = treeModel.getNodeOf(sampler);\n            LOG.warn(&quot;Sampler node: &quot; + newNode);\n            try {\n                //add a RegexExtractor for retrieve the ZK dtid\n                RegexExtractor extr = new RegexExtractor();\n                extr.setProperty(TestElement.GUI_CLASS, RegexExtractorGui.class.getName());\n                extr.setName(&quot;Regular Expression Extractor&quot;);\n                extr.setRefName(&quot;dtid&quot;);\n                extr.setRegex(&quot;dt:\\\\'(.+?)\\\\',cu&quot;);\n                extr.setTemplate(&quot;$1$&quot;);\n                extr.setDefaultValue(&quot;not found&quot;);\n                treeModel.addComponent(extr, newNode);\n            } catch (IllegalUserActionException e) {\n                e.printStackTrace();\n            }\n        } else if (!auPath.isEmpty()) { // zkau request\n\n\n            String path = sampler.getPath();\n            int i = path.indexOf(&quot;jsessionid&quot;);\n            if (i &gt; -1)\n                path = path.substring(0, i - 1);\n\n            if (path.endsWith(auPath)) {\n                Arguments args = sampler.getArguments();\n                Argument arg = args.getArgument(0);\n                if (&quot;dtid&quot;.equals(arg.getName())) {//replace dtid value to a EL variable.\n                    arg.setValue(&quot;${dtid}&quot;);\n                }\n            }\n        }\n    }\n\n    public String getAuPath() {\n        return this.getPropertyAsString(AU_PATH);\n    }\n\n    public void setAuPath(String auPath) {\n        this.setProperty(AU_PATH, auPath, &quot;&quot;);\n    }\n}\n</code></pre>\n",
    "tags" : [ "java", "regex", "maven", "jmeter" ],
    "owner" : {
      "account_id" : 29195008,
      "reputation" : 1,
      "user_id" : 22366323,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/0a5d54075acee7809f4fbf75d68a8b38?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "BernardoDB",
      "link" : "https://stackoverflow.com/users/22366323/bernardodb"
    },
    "is_answered" : false,
    "view_count" : 50,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1744728555,
    "creation_date" : 1744642672,
    "link" : "https://stackoverflow.com/questions/79573442/why-sampler-node-returning-null-jmeter-api",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79575463,
    "question_id" : 79573442,
    "body" : "<p>I don't think you can look up for any test element using this function, I would suggest considering using <a href=\"https://jmeter.apache.org/api/org/apache/jorphan/collections/SearchByClass.html\" rel=\"nofollow noreferrer\">SearchByClass</a> instead as all occurrences of calling this function I can find assume <a href=\"https://jmeter.apache.org/usermanual/component_reference.html#HTTP(S)_Test_Script_Recorder\" rel=\"nofollow noreferrer\">HTTP(S) Test Script Recorder</a> which is not a <a href=\"https://jmeter.apache.org/api/org/apache/jmeter/testelement/TestElement.html\" rel=\"nofollow noreferrer\">TestElement</a></p>\n<p>You can try running your JMeter with JVM debug enabled, connect to it using your IDE and user normal step into / step over for throubleshooting, see <a href=\"https://www.blazemeter.com/blog/debug-jmeter\" rel=\"nofollow noreferrer\">How to Debug JMeter Test Scripts</a> for more details.</p>\n<p>Also it would be very useful if you could describe your use case in more details, i.e. do you want to do this in GUI mode or non-GUI, etc.</p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 11739174,
      "reputation" : 3177,
      "user_id" : 8592047,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/2bfdde9a103b250fa70de4fa068bd6f1?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Ivan G",
      "link" : "https://stackoverflow.com/users/8592047/ivan-g"
    },
    "creation_date" : 1744728555,
    "last_activity_date" : 1744728555,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : { }
}