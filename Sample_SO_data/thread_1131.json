{
  "question" : {
    "question_id" : 79740143,
    "title" : "CodeQL Assignment do not report all assignments in code",
    "body" : "<p>I am using following Java code</p>\n<pre><code>package com.example;\n\npublic class TestClass {\n    public String s = &quot;test&quot;;\n    public void directCall() {\n        s = &quot;test2&quot;;\n        ValidationUtils.validateRequest(&quot;test&quot;);\n    }\n\n    private void viaLambda() {\n        Runnable r = () -&gt; {\n            System.out.println(&quot;Validating request...&quot;);\n            ValidationUtils.validateRequest(&quot;test&quot;);\n        };\n        r.run();\n\n    }\n}\n</code></pre>\n<p>And CodeQL is as</p>\n<pre><code>import java\n\nfrom AssignExpr a\n\nselect a\n</code></pre>\n<p>This is only reporting me</p>\n<p><code>public String s = &quot;test&quot;;</code> and <code>s = &quot;test2&quot;;</code></p>\n<p>But it does not report <code>Runnable r = () -&gt; {</code></p>\n<p>What is the right way to do it?</p>\n",
    "tags" : [ "java", "codeql" ],
    "owner" : {
      "account_id" : 1816942,
      "reputation" : 796,
      "user_id" : 1651859,
      "user_type" : "registered",
      "accept_rate" : 40,
      "profile_image" : "https://www.gravatar.com/avatar/ebe4a0622e91e002e3960dc5b53841f8?s=256&d=identicon&r=PG",
      "display_name" : "Gaurav",
      "link" : "https://stackoverflow.com/users/1651859/gaurav"
    },
    "is_answered" : false,
    "view_count" : 52,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1756081147,
    "creation_date" : 1755618421,
    "link" : "https://stackoverflow.com/questions/79740143/codeql-assignment-do-not-report-all-assignments-in-code",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79745245,
    "question_id" : 79740143,
    "body" : "<p>As pointed out by Jon Skeet in the comments, the <code>AssignExpr</code> CodeQL class does not cover local variable declarations.</p>\n<p>Even its supertype <code>Assignment</code> does not cover this, see <a href=\"https://codeql.github.com/codeql-standard-libraries/java/semmle/code/java/Expr.qll/type.Expr$Assignment.html\" rel=\"nofollow noreferrer\">its documentation</a> (and <a href=\"https://github.com/github/codeql/issues/3266\" rel=\"nofollow noreferrer\">this GitHub issue</a>):</p>\n<blockquote>\n<p>A common super-class that represents many varieties of assignments.</p>\n<p>This does not cover unary assignments such as <code>i++</code>, and initialization of local variables at their declaration such as <code>int i = 0;</code>.</p>\n<p>To cover more cases of variable updates, see the classes <code>VariableAssign</code>, <code>VariableUpdate</code> and <code>VarWrite</code>. But consider that they donâ€™t cover array element assignments since there the assignment destination is not directly the array variable but instead an <code>ArrayAccess</code>.</p>\n</blockquote>\n<p>On the other hand, <code>VariableAssign</code> currently matches local variables without initializer (see <a href=\"https://github.com/github/codeql/issues/5462\" rel=\"nofollow noreferrer\">GitHub issue</a>).</p>\n<p>It depends on your use case which of these CodeQL classes fits best.\nHowever, maybe <a href=\"https://codeql.github.com/docs/codeql-language-guides/analyzing-data-flow-in-java/\" rel=\"nofollow noreferrer\">tracking (local) data flow</a> would be more useful for your use case?</p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 5384013,
      "reputation" : 7199,
      "user_id" : 4288506,
      "user_type" : "registered",
      "accept_rate" : 77,
      "profile_image" : "https://www.gravatar.com/avatar/e4dd357b6d026a2f4a9fa090ff2a414c?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Marcono1234",
      "link" : "https://stackoverflow.com/users/4288506/marcono1234"
    },
    "creation_date" : 1756081147,
    "last_activity_date" : 1756081147,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140676851,
    "post_id" : 79740143,
    "body" : "I strongly suspect that counts as a LocalVariableDeclExpr instead.",
    "score" : 2,
    "owner" : {
      "account_id" : 11683,
      "reputation" : 1520862,
      "user_id" : 22656,
      "user_type" : "registered",
      "accept_rate" : 86,
      "profile_image" : "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=256&d=identicon&r=PG",
      "display_name" : "Jon Skeet",
      "link" : "https://stackoverflow.com/users/22656/jon-skeet"
    },
    "creation_date" : 1755618737,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}