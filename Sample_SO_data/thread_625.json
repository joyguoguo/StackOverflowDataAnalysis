{
  "question" : {
    "question_id" : 79788136,
    "title" : "App built with Eclipse 4.37 Components, Run From Jar, gets &quot;Libraries for platform win32 cannot be loaded because of incompatible environment&quot; error",
    "body" : "<p>I am updating an app that uses the Eclipse components (SWT, JFace, etc) to use the Eclipse version 4.37 components.</p>\n<p>The old version didn't use Maven, the new version does.</p>\n<p>My problem is, while I can run and debug the app, I can't run it from the .jar that I'm building, which is how users will run the app.</p>\n<p>I run it from the jar file as follows:</p>\n<p>java --enable-native-access=ALL-UNNAMED -verbose:jni -jar {jar file path}</p>\n<p>This command gets this error message:</p>\n<blockquote>\n<p>&quot;Libraries for platform win32 cannot be loaded because of incompatible\nenvironment&quot;</p>\n</blockquote>\n<p>I am running on 64-bit Windows.</p>\n<p>When I debug the jar, it stops on breakpoints in my main method. But it terminates the moment I access the Display class. The app terminates. If I put the Display access in a try/catch, the catch is never executed.</p>\n<p>My pom.xml:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    &lt;groupId&gt;com.ericbt&lt;/groupId&gt;\n    &lt;artifactId&gt;vault3&lt;/artifactId&gt;\n    &lt;version&gt;1&lt;/version&gt;\n\n    &lt;properties&gt;\n        &lt;eclipse-platform&gt;org.eclipse.platform&lt;/eclipse-platform&gt;\n        &lt;osgi.platform&gt;win32.win32.x86_64&lt;/osgi.platform&gt;\n        &lt;maven.compiler.release&gt;24&lt;/maven.compiler.release&gt;\n    &lt;/properties&gt;\n\n    &lt;build&gt;\n        &lt;resources&gt;\n            &lt;resource&gt;\n                &lt;directory&gt;${project.basedir}/src/mainPackage/resources&lt;/directory&gt;\n                &lt;targetPath&gt;resources&lt;/targetPath&gt; &lt;!-- Optional: Specify the path inside the JAR --&gt;\n                &lt;includes&gt;\n                    &lt;include&gt;**/*&lt;/include&gt; &lt;!-- Include all files and subfolders --&gt;\n                &lt;/includes&gt;\n                &lt;excludes&gt;\n                    &lt;exclude&gt;artwork&lt;/exclude&gt;\n                &lt;/excludes&gt;\n            &lt;/resource&gt;\n        &lt;/resources&gt;\n        &lt;sourceDirectory&gt;${project.basedir}/src&lt;/sourceDirectory&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\n                &lt;version&gt;3.14.1&lt;/version&gt; &lt;!-- Use a recent version --&gt;\n                &lt;configuration&gt;\n                    &lt;source&gt;${maven.compiler.release}&lt;/source&gt;\n                    &lt;target&gt;24&lt;/target&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                &lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt;\n                &lt;version&gt;3.6.1&lt;/version&gt; &lt;!-- Use a recent version --&gt;\n                &lt;executions&gt;\n                    &lt;execution&gt;\n                        &lt;phase&gt;package&lt;/phase&gt;\n                        &lt;goals&gt;\n                            &lt;goal&gt;shade&lt;/goal&gt;\n                        &lt;/goals&gt;\n                        &lt;configuration&gt;\n                            &lt;filters&gt;\n                                &lt;filter&gt;\n                                    &lt;artifact&gt;*:*&lt;/artifact&gt;\n                                    &lt;excludes&gt;\n                                        &lt;exclude&gt;META-INF/*.SF&lt;/exclude&gt;\n                                        &lt;exclude&gt;META-INF/*.DSA&lt;/exclude&gt;\n                                        &lt;exclude&gt;META-INF/*.RSA&lt;/exclude&gt;\n                                    &lt;/excludes&gt;\n                                &lt;/filter&gt;\n                            &lt;/filters&gt;\n                            &lt;transformers&gt;\n                                &lt;transformer implementation=&quot;org.apache.maven.plugins.shade.resource.ManifestResourceTransformer&quot;&gt;\n                                    &lt;mainClass&gt;mainPackage.MainApplicationWindow&lt;/mainClass&gt; &lt;!-- Replace with your main class --&gt;\n                                &lt;/transformer&gt;\n                            &lt;/transformers&gt;\n                        &lt;/configuration&gt;\n                    &lt;/execution&gt;\n                &lt;/executions&gt;\n            &lt;/plugin&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                &lt;artifactId&gt;maven-resources-plugin&lt;/artifactId&gt;\n                &lt;version&gt;3.3.1&lt;/version&gt; &lt;!-- Use a recent version --&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n\n    &lt;!-- Eclipse 4.37 components, released 2025-09-05 --&gt;\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;${eclipse-platform}&lt;/groupId&gt;\n            &lt;artifactId&gt;org.eclipse.swt.${osgi.platform}&lt;/artifactId&gt;\n            &lt;version&gt;3.131.0&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;${eclipse-platform}&lt;/groupId&gt;\n            &lt;artifactId&gt;org.eclipse.swt.svg&lt;/artifactId&gt;\n            &lt;version&gt;3.130.100&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;${eclipse-platform}&lt;/groupId&gt;\n            &lt;artifactId&gt;org.eclipse.e4.core.commands&lt;/artifactId&gt;\n            &lt;version&gt;1.1.600&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;${eclipse-platform}&lt;/groupId&gt;\n            &lt;artifactId&gt;org.eclipse.core.runtime&lt;/artifactId&gt;\n            &lt;version&gt;3.34.0&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;${eclipse-platform}&lt;/groupId&gt;\n            &lt;artifactId&gt;org.eclipse.equinox.common&lt;/artifactId&gt;\n            &lt;version&gt;3.20.200&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;${eclipse-platform}&lt;/groupId&gt;\n            &lt;artifactId&gt;org.eclipse.jface.text&lt;/artifactId&gt;\n            &lt;version&gt;3.28.100&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;${eclipse-platform}&lt;/groupId&gt;\n            &lt;artifactId&gt;org.eclipse.jface&lt;/artifactId&gt;\n            &lt;version&gt;3.38.0&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;${eclipse-platform}&lt;/groupId&gt;\n            &lt;artifactId&gt;org.eclipse.osgi&lt;/artifactId&gt;\n            &lt;version&gt;3.23.200&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;${eclipse-platform}&lt;/groupId&gt;\n            &lt;artifactId&gt;org.eclipse.text&lt;/artifactId&gt;\n            &lt;version&gt;3.14.400&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;!--\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.github.weisj&lt;/groupId&gt;\n            &lt;artifactId&gt;jsvg&lt;/artifactId&gt;\n            &lt;version&gt;1.7.2&lt;/version&gt;\n        &lt;/dependency&gt;\n        --&gt;\n\n        &lt;!-- local .jar files --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.example&lt;/groupId&gt;\n            &lt;artifactId&gt;imgscalr-lib&lt;/artifactId&gt;\n            &lt;version&gt;1.0.0&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.example&lt;/groupId&gt;\n            &lt;artifactId&gt;sqlite-jdbc&lt;/artifactId&gt;\n            &lt;version&gt;1.0.0&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;junit&lt;/groupId&gt;\n            &lt;artifactId&gt;junit&lt;/artifactId&gt;\n            &lt;version&gt;4.13.2&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.example&lt;/groupId&gt;\n            &lt;artifactId&gt;common-code&lt;/artifactId&gt;\n            &lt;version&gt;1.0.0&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.example&lt;/groupId&gt;\n            &lt;artifactId&gt;perf4j&lt;/artifactId&gt;\n            &lt;version&gt;1.0.0&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.example&lt;/groupId&gt;\n            &lt;artifactId&gt;itextpdf&lt;/artifactId&gt;\n            &lt;version&gt;1.0.0&lt;/version&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n&lt;/project&gt;\n</code></pre>\n<p>Note: The com.github.weisj is commented out, but I still see it in the jar. Maven must be picking it up as a transitive dependency.</p>\n<p>Do you have any suggestions for how I can troubleshoot?</p>\n",
    "tags" : [ "java", "eclipse", "swt" ],
    "owner" : {
      "account_id" : 319201,
      "reputation" : 166,
      "user_id" : 636840,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/dWADh.png?s=256",
      "display_name" : "Eric Bergman-Terrell",
      "link" : "https://stackoverflow.com/users/636840/eric-bergman-terrell"
    },
    "is_answered" : false,
    "view_count" : 141,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1765050150,
    "creation_date" : 1760202194,
    "link" : "https://stackoverflow.com/questions/79788136/app-built-with-eclipse-4-37-components-run-from-jar-gets-libraries-for-platfo",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79839903,
    "question_id" : 79788136,
    "body" : "<p>I got a similar problem and eventually found that it was idiot user.</p>\n<p>Using maven surefire for standalone testing, A code change to the startup conditionalization so that a Display was created leading to a variety of UI in non-UI conflicts.</p>\n<p>Confusingly, debugging on Jenkins (Linux) maven surefire uses the win32 swt not the linux swt leading to investigation of the wrong swt. It would be less confusing if the redundant UI support on Jenkins used linux swt and so reported an error such as:</p>\n<pre><code>Libraries for platform linux cannot be loaded because of incompatible environment\n</code></pre>\n<p>Moral: do not activate UI code in a non-UI application.</p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 10337742,
      "reputation" : 1498,
      "user_id" : 7625261,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/f688b287052314e7bac7c29f1bbfecd4?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Ed Willink",
      "link" : "https://stackoverflow.com/users/7625261/ed-willink"
    },
    "creation_date" : 1765050150,
    "last_activity_date" : 1765050150,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140803299,
    "post_id" : 79788136,
    "body" : "Looking at <a href=\"https://github.com/eclipse-platform/eclipse.platform.swt/blob/d2de8e31f846d655949e81fa006ad2ebcc542b2f/bundles/org.eclipse.swt/Eclipse%20SWT%20PI/common/org/eclipse/swt/internal/Library.java#L194\" rel=\"nofollow noreferrer\"><code>Library.isLoadable()</code></a>, can you check whether <code>org&#47;eclipse&#47;swt&#47;internal&#47;Library.class</code> exists in your JAR and show the content of your META-INF/MANIFEST.MF?",
    "score" : 0,
    "owner" : {
      "account_id" : 15064163,
      "reputation" : 17100,
      "user_id" : 10871900,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/720202b6e19abc330dcd92e6a1254562?s=256&d=identicon&r=PG",
      "display_name" : "dan1st",
      "link" : "https://stackoverflow.com/users/10871900/dan1st"
    },
    "creation_date" : 1760774522,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140795991,
    "post_id" : 79788136,
    "body" : "Yes, Maven was picking up that artifact as a transitive dependency.",
    "score" : 0,
    "owner" : {
      "account_id" : 319201,
      "reputation" : 166,
      "user_id" : 636840,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/dWADh.png?s=256",
      "display_name" : "Eric Bergman-Terrell",
      "link" : "https://stackoverflow.com/users/636840/eric-bergman-terrell"
    },
    "creation_date" : 1760483788,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140790650,
    "post_id" : 79788136,
    "body" : "&quot;The com.github.weisj is commented out, but I still see it in the jar. Maven must be picking it up as a transitive dependency.&quot; - this is probably because <a href=\"https://github.com/eclipse-platform/eclipse.platform.swt/pull/1638\" rel=\"nofollow noreferrer\">SVG support was recently added to SWT</a>. Also, you can use <code>mvn dependency:tree</code> to see where your dependencies are coming from.",
    "score" : 1,
    "owner" : {
      "account_id" : 15064163,
      "reputation" : 17100,
      "user_id" : 10871900,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/720202b6e19abc330dcd92e6a1254562?s=256&d=identicon&r=PG",
      "display_name" : "dan1st",
      "link" : "https://stackoverflow.com/users/10871900/dan1st"
    },
    "creation_date" : 1760223923,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140790588,
    "post_id" : 79788136,
    "body" : "Yes, I just use SWT and other Eclipse dependencies. It is not an RCP app.",
    "score" : 0,
    "owner" : {
      "account_id" : 319201,
      "reputation" : 166,
      "user_id" : 636840,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/dWADh.png?s=256",
      "display_name" : "Eric Bergman-Terrell",
      "link" : "https://stackoverflow.com/users/636840/eric-bergman-terrell"
    },
    "creation_date" : 1760218102,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140790584,
    "post_id" : 79788136,
    "body" : "Jface is documented not to require the full platform. I guess I misconfgured something.",
    "score" : 0,
    "owner" : {
      "account_id" : 43022,
      "reputation" : 24626,
      "user_id" : 125562,
      "user_type" : "registered",
      "accept_rate" : 64,
      "profile_image" : "https://i.sstatic.net/SdIqA.png?s=256",
      "display_name" : "Basilevs",
      "link" : "https://stackoverflow.com/users/125562/basilevs"
    },
    "creation_date" : 1760217527,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140790554,
    "post_id" : 79788136,
    "body" : "@greg-449 Last time I tried, Jface failed in runtime without framework. I could be doing something wrong though.",
    "score" : 0,
    "owner" : {
      "account_id" : 43022,
      "reputation" : 24626,
      "user_id" : 125562,
      "user_type" : "registered",
      "accept_rate" : 64,
      "profile_image" : "https://i.sstatic.net/SdIqA.png?s=256",
      "display_name" : "Basilevs",
      "link" : "https://stackoverflow.com/users/125562/basilevs"
    },
    "creation_date" : 1760216028,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140790549,
    "post_id" : 79788136,
    "body" : "@Basilevs This looks like just SWT, not a full OSGi RCP",
    "score" : 0,
    "owner" : {
      "account_id" : 3159259,
      "reputation" : 111552,
      "user_id" : 2670892,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/4iPV5.png?s=256",
      "display_name" : "greg-449",
      "link" : "https://stackoverflow.com/users/2670892/greg-449"
    },
    "creation_date" : 1760215897,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140790539,
    "post_id" : 79788136,
    "body" : "If you mean open source, then yes.  <a href=\"https://github.com/EricTerrell/Vault3.Desktop\" rel=\"nofollow noreferrer\">github.com/EricTerrell/Vault3.Desktop</a>  The older version is not Maven. I&#39;ll push the Maven updates today or tomorrow.",
    "score" : 0,
    "owner" : {
      "account_id" : 319201,
      "reputation" : 166,
      "user_id" : 636840,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/dWADh.png?s=256",
      "display_name" : "Eric Bergman-Terrell",
      "link" : "https://stackoverflow.com/users/636840/eric-bergman-terrell"
    },
    "creation_date" : 1760215415,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140790533,
    "post_id" : 79788136,
    "body" : "Wow, I did not know OSGI can start from super JAR. Is your project OSS?",
    "score" : 0,
    "owner" : {
      "account_id" : 43022,
      "reputation" : 24626,
      "user_id" : 125562,
      "user_type" : "registered",
      "accept_rate" : 64,
      "profile_image" : "https://i.sstatic.net/SdIqA.png?s=256",
      "display_name" : "Basilevs",
      "link" : "https://stackoverflow.com/users/125562/basilevs"
    },
    "creation_date" : 1760214965,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140790476,
    "post_id" : 79788136,
    "body" : "Oops. I figured this message came from java.exe, not the SWT library. Thanks to your suggestion I was able to see that it was expecting my code to have SWT-OS and SWT-Arch in the manifest.  So the fix was to have the maven-shade-plugin configuration specify SWT-OS (win32) and SWT-Arch (x86_64).  Thanks a bunch, @greg-449!",
    "score" : 1,
    "owner" : {
      "account_id" : 319201,
      "reputation" : 166,
      "user_id" : 636840,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/dWADh.png?s=256",
      "display_name" : "Eric Bergman-Terrell",
      "link" : "https://stackoverflow.com/users/636840/eric-bergman-terrell"
    },
    "creation_date" : 1760211583,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140790390,
    "post_id" : 79788136,
    "body" : "The message comes from <code>org.eclipse.swt.internal.Platform</code> <code>exitIfNotLoadable</code>. The test is in <code>Library.isLoadable</code>",
    "score" : 1,
    "owner" : {
      "account_id" : 3159259,
      "reputation" : 111552,
      "user_id" : 2670892,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/4iPV5.png?s=256",
      "display_name" : "greg-449",
      "link" : "https://stackoverflow.com/users/2670892/greg-449"
    },
    "creation_date" : 1760208683,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140790360,
    "post_id" : 79788136,
    "body" : "Maybe an issue setting up the native code libraries. Try breakpoints in <code>org.eclipse.swt.internal.LoadLibrary</code>",
    "score" : 1,
    "owner" : {
      "account_id" : 3159259,
      "reputation" : 111552,
      "user_id" : 2670892,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/4iPV5.png?s=256",
      "display_name" : "greg-449",
      "link" : "https://stackoverflow.com/users/2670892/greg-449"
    },
    "creation_date" : 1760207283,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}