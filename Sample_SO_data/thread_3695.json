{
  "question" : {
    "question_id" : 79530769,
    "title" : "Custom keyloack api return HTTP 405 Method Not Allowed",
    "body" : "<p>I want to add my endpoint to the keylock, I completed everything according to the documentation, but I get the error</p>\n<blockquote>\n<p>{ &quot;error&quot;: &quot;HTTP 405 Method Not Allowed&quot; }</p>\n</blockquote>\n<p>here are my classes</p>\n<p>MultibankEndpointFactory</p>\n<pre><code>package org.example;\n\nimport org.keycloak.Config;\nimport org.keycloak.models.KeycloakSession;\nimport org.keycloak.models.KeycloakSessionFactory;\nimport org.keycloak.services.resource.RealmResourceProvider;\nimport org.keycloak.services.resource.RealmResourceProviderFactory;\nimport javax.ws.rs.ext.Provider;\nimport java.util.logging.Logger;\n\n@Provider\npublic class MultibankEndpointFactory implements RealmResourceProviderFactory {\n    private static final Logger logger = Logger.getLogger(MultibankEndpointFactory.class.getName());\n    public static final String ID = &quot;multibank-endpoint&quot;;\n\n    @Override\n    public RealmResourceProvider create(KeycloakSession session) {\n        logger.info(&quot;⚡ Creating MultibankEndpointProvider...&quot;);\n        return new MultibankEndpointProvider(session);\n    }\n\n    @Override\n    public void init(Config.Scope config) {\n        logger.info(&quot;✅ MultibankEndpointFactory initialized!&quot;);\n    }\n\n    @Override\n    public void postInit(KeycloakSessionFactory factory) {\n        logger.info(&quot;\uD83D\uDE80 MultibankEndpointFactory postInit done!&quot;);\n    }\n\n    @Override\n    public void close() {}\n\n    @Override\n    public String getId() {\n        return ID;\n    }\n}\n</code></pre>\n<p>MultibankEndpointProvider</p>\n<pre><code>package org.example;\n\nimport org.keycloak.models.KeycloakSession;\nimport org.keycloak.services.resource.RealmResourceProvider;\n\nimport java.util.logging.Logger;\n\npublic class MultibankEndpointProvider implements RealmResourceProvider {\n    private final KeycloakSession session;\n    private static final Logger logger = Logger.getLogger(MultibankEndpointProvider.class.getName());\n\n    public MultibankEndpointProvider(KeycloakSession session) {\n        this.session = session;\n    }\n\n    @Override\n    public Object getResource() {\n        logger.info(&quot;--------------- getResource() called in MultibankEndpointProvider -------------------------&quot;);\n        return new MultibankResource(session);\n    }\n\n    @Override\n    public void close() {}\n}\n</code></pre>\n<p>MultibankResource</p>\n<pre><code>package org.example;\n\nimport org.keycloak.models.KeycloakSession;\n\nimport javax.ws.rs.*;\nimport javax.ws.rs.core.MediaType;\nimport javax.ws.rs.core.Response;\nimport java.util.logging.Logger;\n\n@Path(&quot;/&quot;)\npublic class MultibankResource {\n    private final KeycloakSession session;\n    private static final Logger logger = Logger.getLogger(MultibankResource.class.getName());\n\n    public MultibankResource(KeycloakSession session) {\n        logger.info(&quot;--------------- getResource() called in MultibankResource -----------------------&quot;);\n        this.session = session;\n    }\n\n    @GET\n    @Path(&quot;/validate&quot;)\n    @Produces({MediaType.APPLICATION_JSON})\n    @Encoded\n    public Response validate() {\n        return Response.status(200)\n                .header(&quot;Access-Control-Allow-Origin&quot;, &quot;*&quot;)\n                .entity(&quot;{\\&quot;message\\&quot;: \\&quot;Hello from custom endpoint!\\&quot;}&quot;)\n                .build();\n    }\n\n    @OPTIONS\n    @Path(&quot;{any:.*}&quot;)\n    public Response preflight() {\n        return Response.ok()\n                .header(&quot;Access-Control-Allow-Origin&quot;, &quot;*&quot;)\n                .header(&quot;Access-Control-Allow-Methods&quot;, &quot;GET, POST, PUT, DELETE, OPTIONS&quot;)\n                .header(&quot;Access-Control-Allow-Headers&quot;, &quot;Content-Type, Authorization&quot;)\n                .build();\n    }\n}\n</code></pre>\n<p>META-INF.services/org.keycloak.services.resource.RealmResourceProviderFactory</p>\n<blockquote>\n<p>org.example.MultibankEndpointFactory</p>\n</blockquote>\n<p>Everything is registered in keyloack</p>\n<p>Terminal logs</p>\n<pre><code>&gt; &gt; D:\\keycloak-26.1.3\\bin&gt;kc.bat start-dev --verbose --debug Listening\n&gt;     &gt; for transport dt_socket at address: 52579 Updating the configuration\n&gt;     &gt; and installing your custom providers, if any. Please wait. 2025-03-24\n&gt;     &gt; 14:46:43,501 WARN  [io.qua.config] (build-46) Unrecognized\n&gt;     &gt; configuration key &quot;quarkus.smallrye-health.extensions.enabled&quot; was\n&gt;     &gt; provided; it will be ignored; verify that the dependency extension for\n&gt;     &gt; this configuration is set or that you did not make a typo 2025-03-24\n&gt;     &gt; 14:46:44,110 WARN  [org.key.services] (build-46) KC-SERVICES0047:\n&gt;     &gt; multibank-endpoint (org.example.MultibankEndpointFactory) is\n&gt;     &gt; implementing the internal SPI realm-restapi-extension. This SPI is\n&gt;     &gt; internal and may change without notice 2025-03-24 14:46:44,950 INFO \n&gt;     &gt; [io.qua.hib.orm.dep.HibernateOrmProcessor] (build-19) Persistence unit\n&gt;     &gt; 'keycloak-default': Enforcing Quarkus defaults for dialect\n&gt;     &gt; 'org.hibernate.dialect.H2Dialect' by automatically setting\n&gt;     &gt; 'jakarta.persistence.database-product-version=2.3.230'. 2025-03-24\n&gt;     &gt; 14:46:44,959 INFO  [io.qua.hib.orm.dep.HibernateOrmProcessor]\n&gt;     &gt; (build-19) A legacy persistence.xml file is present in the classpath.\n&gt;     &gt; This file will be used to configure JPA/Hibernate ORM persistence\n&gt;     &gt; units, and any configuration of the Hibernate ORM extension will be\n&gt;     &gt; ignored. To ignore persistence.xml files instead, set the\n&gt;     &gt; configuration property 'quarkus.hibernate-orm.persistence-xml.ignore'\n&gt;     &gt; to 'true'. 2025-03-24 14:46:48,882 INFO  [io.qua.dep.QuarkusAugmentor]\n&gt;     &gt; (main) Quarkus augmentation completed in 6633ms Listening for\n&gt;     &gt; transport dt_socket at address: 52586 Running the server in\n&gt;     &gt; development mode. DO NOT use this configuration in production.\n&gt;     &gt; 2025-03-24 14:46:50,599 INFO  [org.example.MultibankEndpointFactory]\n&gt;     &gt; (main) ? MultibankEndpointFactory initialized! 2025-03-24 14:46:51,879\n&gt;     &gt; INFO \n&gt;     &gt; [org.keycloak.quarkus.runtime.storage.infinispan.CacheManagerFactory]\n&gt;     &gt; (ForkJoinPool.commonPool-worker-1) Starting Infinispan embedded cache\n&gt;     &gt; manager 2025-03-24 14:46:52,266 INFO  [org.infinispan.CONTAINER]\n&gt;     &gt; (ForkJoinPool.commonPool-worker-1) ISPN000556: Starting user\n&gt;     &gt; marshaller\n&gt;     &gt; 'org.infinispan.commons.marshall.ImmutableProtoStreamMarshaller'\n&gt;     &gt; 2025-03-24 14:46:52,913 INFO \n&gt;     &gt; [org.keycloak.connections.infinispan.DefaultInfinispanConnectionProviderFactory]\n&gt;     &gt; (main) Node name: node_119703, Site name: null 2025-03-24 14:46:52,916\n&gt;     &gt; INFO  [org.example.MultibankEndpointFactory] (main) ?\n&gt;     &gt; MultibankEndpointFactory postInit done! 2025-03-24 14:46:52,917 INFO \n&gt;     &gt; [org.keycloak.broker.provider.AbstractIdentityProviderMapper] (main)\n&gt;     &gt; Registering class\n&gt;     &gt; org.keycloak.broker.provider.mappersync.ConfigSyncEventListener\n&gt;     &gt; 2025-03-24 14:46:53,572 WARN  [io.agroal.pool] (main) Datasource\n&gt;     &gt; '&lt;default&gt;': JDBC resources leaked: 1 ResultSet(s) and 0 Statement(s)\n&gt;     &gt; 2025-03-24 14:46:53,695 INFO  [io.quarkus] (main) Keycloak 26.1.3 on\n&gt;     &gt; JVM (powered by Quarkus 3.15.3.1) started in 4.209s. Listening on:\n&gt;     &gt; http://0.0.0.0:8080 2025-03-24 14:46:53,695 INFO  [io.quarkus] (main)\n&gt;     &gt; Profile dev activated. 2025-03-24 14:46:53,695 INFO  [io.quarkus]\n&gt;     &gt; (main) Installed features: [agroal, cdi, hibernate-orm, jdbc-h2,\n&gt;     &gt; keycloak, narayana-jta, opentelemetry, reactive-routes, rest,\n&gt;     &gt; rest-jackson, smallrye-context-propagation, vertx] 2025-03-24\n&gt;     &gt; 14:46:55,713 INFO  [org.example.MultibankEndpointFactory]\n&gt;     &gt; (executor-thread-1) ? Creating MultibankEndpointProvider... 2025-03-24\n&gt;     &gt; 14:46:55,713 INFO  [org.example.MultibankEndpointProvider]\n&gt;     &gt; (executor-thread-1) --------------- getResource() called in\n&gt;     &gt; MultibankEndpointProvider ------------------------- 2025-03-24\n&gt;     &gt; 14:46:55,713 INFO  [org.example.MultibankResource] (executor-thread-1)\n&gt;     &gt; --------------- getResource() called in MultibankResource ----------------------- 2025-03-24 14:46:59,611 INFO  [org.example.MultibankEndpointFactory] (executor-thread-1) ? Creating\n&gt;     &gt; MultibankEndpointProvider... 2025-03-24 14:46:59,611 INFO \n&gt;     &gt; [org.example.MultibankEndpointProvider] (executor-thread-1)\n&gt;     &gt; --------------- getResource() called in MultibankEndpointProvider ------------------------- 2025-03-24\n&gt; 14:46:59,611 INFO  [org.example.MultibankResource] (executor-thread-1)\n&gt; ---------------\n&gt;     &gt; getResource() called in MultibankResource -----------------------\n</code></pre>\n<p><a href=\"https://i.sstatic.net/V081E5At.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/V081E5At.png\" alt=\"enter image description here\" /></a></p>\n<p><strong>I'm running Windows 10 on a local computer, using keyloack version 26.1.3</strong></p>\n",
    "tags" : [ "java", "maven", "keycloak" ],
    "owner" : {
      "account_id" : 29102866,
      "reputation" : 13,
      "user_id" : 22294317,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/0152ba88662325777f7ec780367c7ac8?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Tolkin",
      "link" : "https://stackoverflow.com/users/22294317/tolkin"
    },
    "is_answered" : false,
    "view_count" : 229,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1742810904,
    "creation_date" : 1742810904,
    "link" : "https://stackoverflow.com/questions/79530769/custom-keyloack-api-return-http-405-method-not-allowed",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ ],
  "answer_comments" : { }
}