{
  "question" : {
    "question_id" : 79658878,
    "title" : "jayway.jsonpath:json-path is failing to filter objects with !=",
    "body" : "<p>I am trying to exclude a field and keeps rest of the fields intact using Goessner JSONPath of <code>com.jayway.jsonpath:json-path:2.9.0</code> but apparently it is not working.</p>\n<p>For the following JSON,</p>\n<pre><code>{\n  &quot;firstName&quot;: &quot;John&quot;,\n  &quot;lastName&quot; : &quot;doe&quot;,\n  &quot;age&quot;      : 26,\n  &quot;address&quot;  : {\n    &quot;streetAddress&quot;: &quot;naist street&quot;,\n    &quot;city&quot;         : &quot;Nara&quot;,\n    &quot;postalCode&quot;   : &quot;630-0192&quot;\n  },\n  &quot;phoneNumbers&quot;: [\n    {\n      &quot;type&quot;  : &quot;iPhone&quot;,\n      &quot;number&quot;: &quot;0123-4567-8888&quot;\n    },\n    {\n      &quot;type&quot;  : &quot;home&quot;,\n      &quot;number&quot;: &quot;0123-4567-8910&quot;\n    }\n  ]\n}\n</code></pre>\n<p>I am trying to extract the value of the fields excluding the city, i.e., I expect the output to be as,</p>\n<pre><code>[naist street, 630-0192]\n</code></pre>\n<p>I am using <code>com.jayway.jsonpath:json-path:2.9.0</code> as the library, and the expression I wrote is,</p>\n<pre><code>$.address[?(@!=$.address.city)]\n</code></pre>\n<p>But it fails to give the desired output. While trying on an online <a href=\"https://www.jsonquerytool.com/sample/jsonpathselectmultiplefields\" rel=\"nofollow noreferrer\">Goessner JSONPath tool</a> I acheived desired output.</p>\n<p>Following is the minimal, reproducible example for the issue,</p>\n<pre><code>package org.example;\n\nimport com.jayway.jsonpath.JsonPath;\n\npublic class JavaJsonPath {\n    public static void main(String[] args) {\n        String json = &quot;&quot;&quot;\n        \n                {\n          &quot;firstName&quot;: &quot;John&quot;,\n          &quot;lastName&quot; : &quot;doe&quot;,\n          &quot;age&quot;      : 26,\n          &quot;address&quot;  : {\n            &quot;streetAddress&quot;: &quot;naist street&quot;,\n            &quot;city&quot;         : &quot;Nara&quot;,\n            &quot;postalCode&quot;   : &quot;630-0192&quot;\n          },\n          &quot;phoneNumbers&quot;: [\n            {\n              &quot;type&quot;  : &quot;iPhone&quot;,\n              &quot;number&quot;: &quot;0123-4567-8888&quot;\n            },\n            {\n              &quot;type&quot;  : &quot;home&quot;,\n              &quot;number&quot;: &quot;0123-4567-8910&quot;\n            }\n          ]\n        }\n        &quot;&quot;&quot;;\n\n        Object filtered = JsonPath.read(json, &quot;$.address[?(@ != $.address.city)]&quot;);\n        System.out.println(&quot;Without 'city': &quot; + filtered);\n    }\n}\n</code></pre>\n<p>Is this an issue with the library or do I need to do any workaround?</p>\n",
    "tags" : [ "java", "json", "jsonpath", "json-path-expression", "jayway" ],
    "owner" : {
      "account_id" : 16655382,
      "reputation" : 163,
      "user_id" : 12036945,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a-/AAuE7mAKawswmaMggsTGzOHtracsZ6VbwFndxdN-O_wSOA=k-s256",
      "display_name" : "Kiran Deep",
      "link" : "https://stackoverflow.com/users/12036945/kiran-deep"
    },
    "is_answered" : true,
    "view_count" : 120,
    "answer_count" : 2,
    "score" : 0,
    "last_activity_date" : 1749982210,
    "creation_date" : 1749472197,
    "link" : "https://stackoverflow.com/questions/79658878/jayway-jsonpathjson-path-is-failing-to-filter-objects-with",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79665266,
    "question_id" : 79658878,
    "body" : "<p>If <em>JsonPath</em> can't produce the required result directly, you may try other JSON libraries. One of them is <em>Josson</em>.</p>\n<p><a href=\"https://github.com/octomix/josson\" rel=\"nofollow noreferrer\">https://github.com/octomix/josson</a></p>\n<pre class=\"lang-java prettyprint-override\"><code>Josson josson = Josson.fromJsonString(&quot;&quot;&quot;\n        {\n          &quot;firstName&quot;: &quot;John&quot;,\n          &quot;lastName&quot; : &quot;doe&quot;,\n          &quot;age&quot;      : 26,\n          &quot;address&quot;  : {\n            &quot;streetAddress&quot;: &quot;naist street&quot;,\n            &quot;city&quot;         : &quot;Nara&quot;,\n            &quot;postalCode&quot;   : &quot;630-0192&quot;\n          },\n          &quot;phoneNumbers&quot;: [\n            {\n              &quot;type&quot;  : &quot;iPhone&quot;,\n              &quot;number&quot;: &quot;0123-4567-8888&quot;\n            },\n            {\n              &quot;type&quot;  : &quot;home&quot;,\n              &quot;number&quot;: &quot;0123-4567-8910&quot;\n            }\n          ]\n        }\n        &quot;&quot;&quot;);\nJsonNode node = josson.getNode(&quot;address.*[key!='city']*&quot;);\nSystem.out.println(node.toString());\n</code></pre>\n<p><strong>Output</strong></p>\n<p><code>[&quot;naist street&quot;,&quot;630-0192&quot;]</code></p>\n<p><strong>Query Expression</strong></p>\n<p><code>address.*[key!='city']*</code></p>\n<p>The <code>*</code> before the square brackets means object properties search.  The searching expression can use implicit variables <code>key</code> and <code>value</code> that store each property name and value.  The <code>*</code> after the square brackets means to collect all matched values.</p>\n",
    "score" : 1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 13009011,
      "reputation" : 1281,
      "user_id" : 9402689,
      "user_type" : "registered",
      "profile_image" : "https://graph.facebook.com/10155248276785868/picture?type=large",
      "display_name" : "Raymond Choi",
      "link" : "https://stackoverflow.com/users/9402689/raymond-choi"
    },
    "creation_date" : 1749840391,
    "last_activity_date" : 1749840391,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79665152,
    "question_id" : 79658878,
    "body" : "<h1>Select needed fields manually in JsonPath</h1>\n<p>This is hard to maintain.</p>\n<pre class=\"lang-java prettyprint-override\"><code>  @Test\n  void shouldContainOnlyNeededWithManualSelect() {\n    var path = &quot;$.address['streetAddress', 'postalCode']&quot;;\n    var compiledPath = JsonPath.compile(path);\n\n    LinkedHashMap&lt;String, String&gt; map = JsonPath.parse(JSON).read(compiledPath);\n    var values = map.values();\n\n    assertThat(values).containsExactly(&quot;naist street&quot;, &quot;630-0192&quot;);\n  }\n</code></pre>\n<h1>Select all, then filter</h1>\n<p>No further maintenance is required.</p>\n<pre class=\"lang-java prettyprint-override\"><code>  @Test\n  void shouldContainOnlyNeededWithFilter() {\n    var path = &quot;$.address&quot;;\n    var compiledPath = JsonPath.compile(path);\n\n    LinkedHashMap&lt;String, String&gt; map = JsonPath.parse(JSON).read(compiledPath);\n    var list = map.entrySet().stream()\n        .filter(entry -&gt; !entry.getKey().equals(&quot;city&quot;))\n        .map(Map.Entry::getValue)\n        .toList();\n\n    assertThat(list).containsExactly(&quot;naist street&quot;, &quot;630-0192&quot;);\n  }\n</code></pre>\n<p>Tested on <code>com.jayway.jsonpath:json-path:2.9.0</code>.</p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 40864244,
      "reputation" : 632,
      "user_id" : 30001713,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/f59ea01a76709335047f0cee269d788e?s=256&d=identicon&r=PG",
      "display_name" : "biggujo",
      "link" : "https://stackoverflow.com/users/30001713/biggujo"
    },
    "creation_date" : 1749832805,
    "last_activity_date" : 1749982210,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140499508,
    "post_id" : 79658878,
    "body" : "Updated with the MRE in the description of the question",
    "score" : 0,
    "owner" : {
      "account_id" : 16655382,
      "reputation" : 163,
      "user_id" : 12036945,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a-/AAuE7mAKawswmaMggsTGzOHtracsZ6VbwFndxdN-O_wSOA=k-s256",
      "display_name" : "Kiran Deep",
      "link" : "https://stackoverflow.com/users/12036945/kiran-deep"
    },
    "creation_date" : 1749481440,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140499293,
    "post_id" : 79658878,
    "body" : "Please add a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to the question.",
    "score" : 0,
    "owner" : {
      "account_id" : 372682,
      "reputation" : 26512,
      "user_id" : 721855,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/vZiox.png?s=256",
      "display_name" : "aled",
      "link" : "https://stackoverflow.com/users/721855/aled"
    },
    "creation_date" : 1749476538,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79665152" : [ {
      "comment_id" : 140514529,
      "post_id" : 79665152,
      "body" : "Please edit your answer to remove quote formatting from your own content. If you are quoting some other resource, then next to the quoted text you should provide attribution to the original source.",
      "score" : 0,
      "owner" : {
        "account_id" : 5353945,
        "reputation" : 28728,
        "user_id" : 4267244,
        "user_type" : "moderator",
        "accept_rate" : 85,
        "profile_image" : "https://i.sstatic.net/njcHD.jpg?s=256",
        "display_name" : "Dalija Prasnikar",
        "link" : "https://stackoverflow.com/users/4267244/dalija-prasnikar"
      },
      "creation_date" : 1749972833,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}