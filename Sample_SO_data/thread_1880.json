{
  "question" : {
    "question_id" : 79668050,
    "title" : "Quarkus PKCS12 credential provider for database",
    "body" : "<p>Was using <a href=\"https://github.com/quarkiverse/quarkus-file-vault\" rel=\"nofollow noreferrer\">quarkus-file-vault</a> extension to handle passwords for databases.</p>\n<p>This extension is being retired in favor of <a href=\"https://github.com/smallrye/smallrye-config\" rel=\"nofollow noreferrer\">SmallRye Config</a>. So I tried to do the same that was possible to do with quarkus-file-vault extension using only <a href=\"https://smallrye.io/smallrye-config/Main/config-sources/keystore/\" rel=\"nofollow noreferrer\">Config Source Keystore</a>  and <a href=\"https://smallrye.io/smallrye-config/Main/config/secret-keys/\" rel=\"nofollow noreferrer\">Secret Keys</a>.</p>\n<p>So, created keystore handling:</p>\n<pre class=\"lang-none prettyprint-override\"><code>smallrye.config.source.keystore.db.path = db.p12\nsmallrye.config.source.keystore.db.password = ${DB_VAULT_SECRET}\n</code></pre>\n<p>This works, and I can get passwords programmatically with:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Inject\nConfig config;\n... \nconfig.getValue(&quot;aliasinvault&quot;, String.class);\n</code></pre>\n<p>But I can't find how to inject password (from keystore) in database configuration (application.properties):</p>\n<pre class=\"lang-none prettyprint-override\"><code>quarkus.datasource.db.username = ${DB_USERNAME}\nquarkus.datasource.db.password = ???\nquarkus.datasource.db.credentials-provider = ???\n</code></pre>\n<p>Normally it should be done with <a href=\"https://quarkus.io/guides/credentials-provider\" rel=\"nofollow noreferrer\">CredentialsProvider</a>, but I didn't find any reference for this interface on SmallRye Config source code, so, alternatively, managed to do this creating a custom CredentialsProvider based on same logic done in quarkus-file-vault extension.</p>\n<p>Finally, my question is: How can I do it without a custom CredentialsProvider?</p>\n<p>Thanks!</p>\n",
    "tags" : [ "java", "quarkus", "smallrye-config" ],
    "owner" : {
      "account_id" : 11222708,
      "reputation" : 679,
      "user_id" : 8233361,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/-mIaHjKZp10c/AAAAAAAAAAI/AAAAAAAADOA/SG9eU0yiRC8/s256-rj/photo.jpg",
      "display_name" : "Claudio Weiler",
      "link" : "https://stackoverflow.com/users/8233361/claudio-weiler"
    },
    "is_answered" : true,
    "view_count" : 83,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1750879513,
    "creation_date" : 1750097732,
    "link" : "https://stackoverflow.com/questions/79668050/quarkus-pkcs12-credential-provider-for-database",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79679568,
    "question_id" : 79668050,
    "body" : "<p>First, configure your Config Source Keystore:</p>\n<pre><code>smallrye.config.source.keystore.secrets.path = /path/to/keystore\nsmallrye.config.source.keystore.secrets.password = keystore_password\n</code></pre>\n<p>This will load all entries in keystore and add them as Config Source entries. Each entry alias will become config key.</p>\n<p>So, considering you have a keystore entry with alias `db_user`, do this in your datasource configs:</p>\n<pre><code>quarkus.datasource.db1.password = ${db_user}\n</code></pre>\n<hr />\n<p>Putting it all together using environment variables:</p>\n<pre><code>smallrye.config.source.keystore.secrets.path = ${VAULT_PATH}\nsmallrye.config.source.keystore.secrets.password = ${VAULT_SECRET}\n\nquarkus.datasource.db1.password = ${${VAULT_DB1_ALIAS}}\n</code></pre>\n",
    "score" : 0,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 11222708,
      "reputation" : 679,
      "user_id" : 8233361,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/-mIaHjKZp10c/AAAAAAAAAAI/AAAAAAAADOA/SG9eU0yiRC8/s256-rj/photo.jpg",
      "display_name" : "Claudio Weiler",
      "link" : "https://stackoverflow.com/users/8233361/claudio-weiler"
    },
    "creation_date" : 1750879513,
    "last_activity_date" : 1750879513,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : { }
}