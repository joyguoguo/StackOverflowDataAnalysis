{
  "question" : {
    "question_id" : 79614195,
    "title" : "AWS Java SDK v2.0: How to handle providing indexNames at runtime rather than using annotation",
    "body" : "<p>I have a project using DynamoDB which I'm upgrading to Java SDK v2.0</p>\n<p>Using the new enhanced client and type mapping.</p>\n<p>I have an index name which I need to pass to @DynamoDbSecondaryPartitionKey,\nhowever this name is stored in our application configuration (application.properties)</p>\n<p>Usually I grab this using a config lookup class, which needs to happen at runtime using an injected dependency.</p>\n<p>However the annotation param indexNames is passed statically.</p>\n<p>Is there an alternative to the annotation @DynamoDbSecondaryPartitionKey which I can invoke at runtime, fetch the name from config, and set the index name?</p>\n",
    "tags" : [ "java", "amazon-web-services", "amazon-dynamodb", "aws-java-sdk-2.x" ],
    "owner" : {
      "account_id" : 1095398,
      "reputation" : 184,
      "user_id" : 1089092,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/b6e88bc708ee5656e8543d6ccbef93db?s=256&d=identicon&r=PG",
      "display_name" : "HellaWiggly",
      "link" : "https://stackoverflow.com/users/1089092/hellawiggly"
    },
    "is_answered" : true,
    "view_count" : 75,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1746825264,
    "creation_date" : 1746796337,
    "link" : "https://stackoverflow.com/questions/79614195/aws-java-sdk-v2-0-how-to-handle-providing-indexnames-at-runtime-rather-than-usi",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79614755,
    "question_id" : 79614195,
    "body" : "<p>You can write your own query completely ignoring any annotation, where the parameter are provided from the code.</p>\n<p>This is an example from my own project, where there's a key <em>userId</em> and secondaryI index <em>createdTimestamp</em></p>\n<pre><code>QueryRequest query = this.createListItemQueryRequest(userId, lastItem, size);\nQueryResponse queryResponse = this.getDynamoDbclient().query(query);  \n...\n\n\n\n  private QueryRequest createListItemQueryRequest(String userId, String lastItem, int size) {\n\n        Map&lt;String, AttributeValue&gt; expressionValueMap = new HashMap&lt;&gt;();\n        expressionValueMap.put(&quot;:userId&quot;, AttributeValue.fromS(userId));\n        expressionValueMap.put(&quot;:lastItem&quot;, AttributeValue.fromN(\n                lastItem != null ? lastItem : this.longFormatter.format(System.currentTimeMillis())));\n\n        QueryRequest query =  QueryRequest.builder()\n                .tableName(this.tableName)\n                .projectionExpression(ATT_TO_GET_LIST)\n                .keyConditionExpression(&quot;userId = :userId and createdTimestamp &lt; :lastItem&quot;)\n                .expressionAttributeValues(expressionValueMap)\n                .indexName(this.userIndexName)\n                .scanIndexForward(false)\n                .limit(size)\n                .build();\n\n        return query;\n    }\n</code></pre>\n",
    "score" : 1,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 1809323,
      "reputation" : 12239,
      "user_id" : 1645712,
      "user_type" : "registered",
      "accept_rate" : 73,
      "profile_image" : "https://www.gravatar.com/avatar/48781792c1fb7d61086b4fb612938c13?s=256&d=identicon&r=PG",
      "display_name" : "gusto2",
      "link" : "https://stackoverflow.com/users/1645712/gusto2"
    },
    "creation_date" : 1746818599,
    "last_activity_date" : 1746825264,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : {
    "79614755" : [ {
      "comment_id" : 140415432,
      "post_id" : 79614755,
      "body" : "Wondering if I drop the annotation entirely what effect would that have.",
      "score" : 0,
      "owner" : {
        "account_id" : 1095398,
        "reputation" : 184,
        "user_id" : 1089092,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/b6e88bc708ee5656e8543d6ccbef93db?s=256&d=identicon&r=PG",
        "display_name" : "HellaWiggly",
        "link" : "https://stackoverflow.com/users/1089092/hellawiggly"
      },
      "creation_date" : 1746972754,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140415429,
      "post_id" : 79614755,
      "body" : "In that case, when would I want to set @DynamoDbSecondaryPartitionKey on the model? Is there a different interface for querying where this would be used? Or it is used if not specified in the query statement?",
      "score" : 0,
      "owner" : {
        "account_id" : 1095398,
        "reputation" : 184,
        "user_id" : 1089092,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/b6e88bc708ee5656e8543d6ccbef93db?s=256&d=identicon&r=PG",
        "display_name" : "HellaWiggly",
        "link" : "https://stackoverflow.com/users/1089092/hellawiggly"
      },
      "creation_date" : 1746972685,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140415417,
      "post_id" : 79614755,
      "body" : "Muchos gracias!",
      "score" : 0,
      "owner" : {
        "account_id" : 1095398,
        "reputation" : 184,
        "user_id" : 1089092,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/b6e88bc708ee5656e8543d6ccbef93db?s=256&d=identicon&r=PG",
        "display_name" : "HellaWiggly",
        "link" : "https://stackoverflow.com/users/1089092/hellawiggly"
      },
      "creation_date" : 1746972369,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}