{
  "question" : {
    "question_id" : 79552018,
    "title" : "Hibernate generate wrong SQL query",
    "body" : "<p>I try to use criteria of Hibernate to get data from user search input but it didn't success. I got this error:</p>\n<blockquote>\n<p>SEVERE: Invalid column name 'y1_'.</p>\n</blockquote>\n<p>This is query that Hibernate create in log:</p>\n<blockquote>\n<p>Hibernate: select top 15 this_.CUSTOMER_ID as y0_, this_.CUSTOMER_NAME as y1_, this_.SEX as y2_, this_.BIRTHDAY as y3_, this_.ADDRESS as y4_, this_.EMAIL as y5_ from MSTCUSTOMER this_ where this_.DELETE_YMD is null and y1_ like ? order by y0_ asc</p>\n</blockquote>\n<p>I tried to run that query in SQL Server and indeed it's throwing the exact same error. I don't know why Hibernate create a wrong query, please help me fix it. Thank you very much!</p>\n<p>This is my code (I used Hibernate 3.2.7, sqljdbc4-3.0 and SQL Server 2022)</p>\n<pre><code>// Add criteria\ncriteria.add(Restrictions.isNull(&quot;deleteYMD&quot;));\nString customerName = t002Form.getCurrentInput().getCustomerName();\n\nif (!Utils.checkEmpty(customerName)) {\n    criteria.add(Restrictions.like(&quot;customerName&quot;, customerName, MatchMode.ANYWHERE));\n}\nString sex = t002Form.getCurrentInput().getSex();\nif (!Utils.checkEmpty(sex)) {\n    criteria.add(Restrictions.eq(&quot;sex&quot;, sex));\n}\nString fromBirthday = t002Form.getCurrentInput().getFromBirthday();\nif (!Utils.checkEmpty(fromBirthday)) {\n    criteria.add(Restrictions.ge(&quot;birthday&quot;, fromBirthday));\n}\nString toBirthday = t002Form.getCurrentInput().getToBirthday();\nif (!Utils.checkEmpty(toBirthday)) {\n    criteria.add(Restrictions.le(&quot;birthday&quot;, toBirthday));\n}\n            \n// Add paging\nint firstResultIndex = t002Form.getCurrentPage() * Constants.PAGE_SIZE;\ncriteria.setFirstResult(firstResultIndex);\ncriteria.setMaxResults(Constants.PAGE_SIZE);\ncriteria.addOrder(Order.asc(&quot;customerID&quot;));\n            \n// Add projection\ncriteria.setProjection(Projections.projectionList()\n                            .add(Projections.property(&quot;customerID&quot;), &quot;customerID&quot;)\n                            .add(Projections.property(&quot;customerName&quot;), &quot;customerName&quot;)\n                            .add(Projections.property(&quot;sex&quot;), &quot;sex&quot;)\n                            .add(Projections.property(&quot;birthday&quot;), &quot;birthday&quot;)\n                            .add(Projections.property(&quot;address&quot;), &quot;address&quot;)\n                            .add(Projections.property(&quot;email&quot;), &quot;email&quot;));\n                        \n// Map to T002Dto\ncriteria.setResultTransformer(Transformers.aliasToBean(T002Dto.class));\nList&lt;T002Dto&gt; listCustomer = Utils.castList(T002Dto.class, criteria.list());\n</code></pre>\n<p>Hibernate configuration:</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;!DOCTYPE hibernate-configuration PUBLIC\n        &quot;-//Hibernate/Hibernate Configuration DTD 3.0//EN&quot;\n        &quot;http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd&quot;&gt;\n&lt;hibernate-configuration&gt;       \n  &lt;session-factory&gt;\n    &lt;property name=&quot;dialect&quot;&gt;org.hibernate.dialect.SQLServerDialect&lt;/property&gt;\n    &lt;property name=&quot;show_sql&quot;&gt;true&lt;/property&gt; \n    &lt;property name=&quot;hibernate.jdbc.batch_size&quot;&gt;50&lt;/property&gt;\n    &lt;property name=&quot;hibernate.order_updates&quot;&gt;true&lt;/property&gt;\n    &lt;mapping resource=&quot;java/resources/hbm/User.hbm.xml&quot;/&gt;\n    &lt;mapping resource=&quot;java/resources/hbm/Customer.hbm.xml&quot;/&gt;\n  &lt;/session-factory&gt;\n&lt;/hibernate-configuration&gt;\n</code></pre>\n<p>Hibernate mapping</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;!DOCTYPE hibernate-mapping PUBLIC\n        &quot;-//Hibernate/Hibernate Mapping DTD 3.0//EN&quot;\n        &quot;http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd&quot;&gt;\n        \n&lt;hibernate-mapping package=&quot;fjs.cs.model&quot;&gt;\n    &lt;class name=&quot;Customer&quot; table=&quot;MSTCUSTOMER&quot;&gt;\n        &lt;id name=&quot;customerID&quot; column=&quot;CUSTOMER_ID&quot;&gt;\n            &lt;generator class=&quot;native&quot;/&gt;\n        &lt;/id&gt;\n        &lt;property name=&quot;customerName&quot; column=&quot;CUSTOMER_NAME&quot;/&gt;\n        &lt;property name=&quot;sex&quot; column=&quot;SEX&quot;/&gt;\n        &lt;property name=&quot;birthday&quot; column=&quot;BIRTHDAY&quot;/&gt;\n        &lt;property name=&quot;email&quot; column=&quot;EMAIL&quot;/&gt;\n        &lt;property name=&quot;address&quot; column=&quot;ADDRESS&quot;/&gt;\n        &lt;property name=&quot;deleteYMD&quot; column=&quot;DELETE_YMD&quot;/&gt;\n        &lt;property name=&quot;insertYMD&quot; column=&quot;INSERT_YMD&quot;/&gt;\n        &lt;property name=&quot;insertPsnCD&quot; column=&quot;INSERT_PSN_CD&quot;/&gt;\n        &lt;property name=&quot;updateYMD&quot; column=&quot;UPDATE_YMD&quot;/&gt;\n        &lt;property name=&quot;updatePsnCD&quot; column=&quot;UPDATE_PSN_CD&quot;/&gt;\n    &lt;/class&gt; \n&lt;/hibernate-mapping&gt;\n</code></pre>\n<p>Pojo class</p>\n<pre><code>public class Customer {\n\n    private int customerID;\n    private String customerName;\n    private String sex;\n    private String birthday;\n    private String email;\n    private String address;\n    private Timestamp deleteYMD;\n    private Timestamp insertYMD;\n    private int insertPsnCD;\n    private Timestamp updateYMD;\n    private int updatePsnCD;\n\n    // Getters, Setters and Constructor\n}\n</code></pre>\n",
    "tags" : [ "java", "sql-server", "hibernate" ],
    "owner" : {
      "account_id" : 30904565,
      "reputation" : 1,
      "user_id" : 23722490,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/ffcd1f17e424a32fe9ca6b0636bafdf5?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Nguyễn Ph&#250; Khang",
      "link" : "https://stackoverflow.com/users/23722490/nguy%e1%bb%85n-ph%c3%ba-khang"
    },
    "is_answered" : false,
    "view_count" : 70,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1743664163,
    "creation_date" : 1743655963,
    "link" : "https://stackoverflow.com/questions/79552018/hibernate-generate-wrong-sql-query",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79552234,
    "question_id" : 79552018,
    "body" : "<p>End up I have to remove Projection part and map from Customer to T002Dto manually in order to Hibernate doesn't use alias in WHERE clause</p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 30904565,
      "reputation" : 1,
      "user_id" : 23722490,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/ffcd1f17e424a32fe9ca6b0636bafdf5?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Nguyễn Ph&#250; Khang",
      "link" : "https://stackoverflow.com/users/23722490/nguy%e1%bb%85n-ph%c3%ba-khang"
    },
    "creation_date" : 1743664163,
    "last_activity_date" : 1743664163,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140293222,
    "post_id" : 79552018,
    "body" : "you should add also entities mapping and full code not only a part to let us help you",
    "score" : 0,
    "owner" : {
      "account_id" : 3052937,
      "reputation" : 18534,
      "user_id" : 2587166,
      "user_type" : "registered",
      "accept_rate" : 83,
      "profile_image" : "https://i.sstatic.net/pgHgd.jpg?s=256",
      "display_name" : "Luca Basso Ricci",
      "link" : "https://stackoverflow.com/users/2587166/luca-basso-ricci"
    },
    "creation_date" : 1743658438,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140293221,
    "post_id" : 79552018,
    "body" : "If you can&#39;t change it how do you expect to work around it? Clearly you need to change it, so upgrade it to modern and supported versions while you&#39;re at it.",
    "score" : 0,
    "owner" : {
      "account_id" : 166167,
      "reputation" : 8952,
      "user_id" : 390122,
      "user_type" : "registered",
      "accept_rate" : 75,
      "profile_image" : "https://www.gravatar.com/avatar/e6f9494c096977b56cd5c808f2a52bcf?s=256&d=identicon&r=PG",
      "display_name" : "AlwaysLearning",
      "link" : "https://stackoverflow.com/users/390122/alwayslearning"
    },
    "creation_date" : 1743658414,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140293166,
    "post_id" : 79552018,
    "body" : "This is from the old project and i can&#39;t change it, you have any idea to workaround?",
    "score" : 0,
    "owner" : {
      "account_id" : 30904565,
      "reputation" : 1,
      "user_id" : 23722490,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/ffcd1f17e424a32fe9ca6b0636bafdf5?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Nguyễn Ph&#250; Khang",
      "link" : "https://stackoverflow.com/users/23722490/nguy%e1%bb%85n-ph%c3%ba-khang"
    },
    "creation_date" : 1743656444,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140293158,
    "post_id" : 79552018,
    "body" : "Why are you using the oldest lib versions in the universe? It sounds like it&#39;s not picking correct dialect and using a construct which isn&#39;t allowed in SQL server.",
    "score" : 0,
    "owner" : {
      "account_id" : 17972905,
      "reputation" : 10131,
      "user_id" : 13061224,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/GyOMS.jpg?s=256",
      "display_name" : "siggemannen",
      "link" : "https://stackoverflow.com/users/13061224/siggemannen"
    },
    "creation_date" : 1743656199,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}