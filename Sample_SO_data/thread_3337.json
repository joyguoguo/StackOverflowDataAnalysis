{
  "question" : {
    "question_id" : 79555117,
    "title" : "How to implement both direct user login and OAuth2 provider support in a Spring Boot application?",
    "body" : "<p>I’m building an authentication and authorization system using Spring Boot and OAuth2 and would like to support two main use cases, similar to how Gmail handles authentication:</p>\n<p><strong>Use Case 1: Direct Login (Custom Login Page using React)</strong></p>\n<p>I want to allow users to log in directly via a custom login page hosted on my react application.</p>\n<ul>\n<li><p>This flow is intended for users registered within my application\n(ex. like how you go to gmail.com/sign-in and enter your credentials\ndirectly).</p>\n</li>\n<li><p>It should authenticate using a username/password form, verify\ncredentials, create a session or issue a token, and redirect the user\nto the dashboard.</p>\n</li>\n<li><p>This is not the OAuth2 flow — just simple login for my own user base.</p>\n</li>\n</ul>\n<p><strong>Use Case 2: OAuth2 Provider for Third-Party Clients</strong></p>\n<p>I also want to expose an OAuth2 Authorization Server, so that:</p>\n<ul>\n<li><p>Third-party applications can register via my developer portal and receive a client_id and client_secret.</p>\n</li>\n<li><p>These applications can then initiate the Authorization Code Flow (with or without PKCE) to let users sign in to those third-party apps using their credentials from my system. (Similar to how gmail allows signing into other apps using a gmail account)</p>\n</li>\n</ul>\n<p><strong>Challenge</strong></p>\n<p>Spring Security provides built-in support for the OAuth2 Authorization Code Flow (for implementing an Authorization Server) and OAuth2 Client functionalities. But it does not clearly support a simple direct login mechanism using custom Login page on React or Frontend APP.</p>\n<p>From what I understand, enabling formLogin by default provides a /login page. However, I don't want to use the default login page — I want to use my own custom login screen on the frontend or mobile app.</p>\n<p>With the default login page, everything works fine — including dynamic client registration, PKCE flow, and refresh token handling. There's no issue with that setup.</p>\n<p>My main challenge is figuring out how to call the login API from my custom frontend and generate the token. Since Spring Security OAuth2 provides a built-in token generation mechanism as part of the OAuth2 flow, I'm not sure how to manually trigger that when using a custom login flow.</p>\n<p><strong>What I’m Looking For</strong></p>\n<ul>\n<li>How can I implement a custom login page for direct user login with react or mobile app?</li>\n<li>Do I need to create custom login API? If yes, then how oauth2 flow will work in this case? because generating access token and refresh token internally is not a good practise right?</li>\n<li>What will be the flow in that case?</li>\n<li>Is it necessary to create client id and secret for own app login?</li>\n</ul>\n<p><strong>Tech Stack</strong></p>\n<ul>\n<li><p>Spring Boot 3.x</p>\n</li>\n<li><p>Spring Security</p>\n</li>\n<li><p>Spring Authorization Server (latest version)</p>\n</li>\n<li><p>Java 21</p>\n</li>\n</ul>\n<p>Any guidance would be greatly appreciated!</p>\n",
    "tags" : [ "java", "spring-boot", "authentication", "oauth-2.0", "jwt" ],
    "owner" : {
      "account_id" : 13265714,
      "reputation" : 339,
      "user_id" : 9578616,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/eba50e2a8536837507daf5326bd34211?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Rohit Kavthekar",
      "link" : "https://stackoverflow.com/users/9578616/rohit-kavthekar"
    },
    "is_answered" : true,
    "view_count" : 436,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1743823893,
    "creation_date" : 1743764122,
    "link" : "https://stackoverflow.com/questions/79555117/how-to-implement-both-direct-user-login-and-oauth2-provider-support-in-a-spring",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79556480,
    "question_id" : 79555117,
    "body" : "<blockquote>\n<p>similar to how Gmail handles authentication</p>\n</blockquote>\n<p>Google works only with OAuth2, and does not use the password flow which was deprecated long ago for security reasons.</p>\n<p>You never login to Gmail directly. You are redirected to <a href=\"https://accounts.google.com\" rel=\"nofollow noreferrer\">https://accounts.google.com</a> wich is the SSO for Google (aka <em>&quot;authorization server&quot;</em> in OAuth2 wording and <em>&quot;OpenID provider&quot;</em> in OpenID one). It is used by the Gmail app, but also Calandar, Contact, Drive, Youtube, etc.</p>\n<p>Taking an example from Google, and actually about any serious company, <strong>you should never create login forms in your apps</strong> and rely on the authorization server's one. If the matter is look &amp; feel, they all provide some means to customize their appearance.</p>\n<p>What you need is an OpenID Provider which can federate users from &quot;social&quot; OpenID Providers. Keycloak is a very common sample, but you may consider cloud offers like Auth0, Cognito, and many others (if you have a cloud provider, it may have one, and it is a good thing that it is collocated in the same datacenter as the rest of your backend).</p>\n<p>You may use Spring Authorization Server to create your own OpenID provider, but this will require much more work and require probably more OAuth2 &amp; web security background than you have. Implementing a complete user account management and login UI is much more work than you imagine, especially when you want advanced login flows like Multi-Factor Auth, magic links, etc. Not to talk about security caveats. You should take in consideration that it took years to whole team of experts to build the solutions listed above.</p>\n<p>You may refer to these articles I wrote for Baeldung:</p>\n<ul>\n<li><a href=\"https://www.baeldung.com/spring-boot-keycloak\" rel=\"nofollow noreferrer\">getting stated with Keycloak &amp; Spring</a></li>\n<li>implement the <a href=\"https://www.baeldung.com/spring-cloud-gateway-bff-oauth2\" rel=\"nofollow noreferrer\">OAuth2 BFF pattern for single page applications</a> (with a sample React app)</li>\n</ul>\n",
    "score" : 2,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 308139,
      "reputation" : 13879,
      "user_id" : 619830,
      "user_type" : "registered",
      "accept_rate" : 75,
      "profile_image" : "https://www.gravatar.com/avatar/f4d00b0a82e9307b1d68b29867fee4e5?s=256&d=identicon&r=PG",
      "display_name" : "ch4mp",
      "link" : "https://stackoverflow.com/users/619830/ch4mp"
    },
    "creation_date" : 1743819225,
    "last_activity_date" : 1743823893,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : {
    "79556480" : [ {
      "comment_id" : 140307779,
      "post_id" : 79556480,
      "body" : "When using devices with decent input capabilities, users are authenticated using the authorization code flow. As stated in my answer, in OAuth2, only the authorization server handles authentication. All users, including admins, are redirected to the authorization server for login, and then back to the OAuth2 client that initiated the authorization code flow (which might in turn redirect to a front end when this client is a BFF for a single-page or mobile app).",
      "score" : 1,
      "owner" : {
        "account_id" : 308139,
        "reputation" : 13879,
        "user_id" : 619830,
        "user_type" : "registered",
        "accept_rate" : 75,
        "profile_image" : "https://www.gravatar.com/avatar/f4d00b0a82e9307b1d68b29867fee4e5?s=256&d=identicon&r=PG",
        "display_name" : "ch4mp",
        "link" : "https://stackoverflow.com/users/619830/ch4mp"
      },
      "creation_date" : 1744029467,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140307712,
      "post_id" : 79556480,
      "body" : "Thanks! That’s exactly what I needed — I was confused about the lack of a simple login, but your explanation makes sense. Just a couple of quick follow-up questions: 1.Suppose there’s an admin portal where admins can log in by visiting a /login page and entering their credentials. If the authorization server is a separate application, how would this flow work? Since OAuth2 requires starting the /authorize flow, how is that handled in this case? Also, we can’t use the password grant type anymore, since it&#39;s deprecated — so what’s the alternative? 2.is the login page handled by the backend only?",
      "score" : 0,
      "owner" : {
        "account_id" : 13265714,
        "reputation" : 339,
        "user_id" : 9578616,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/eba50e2a8536837507daf5326bd34211?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "Rohit Kavthekar",
        "link" : "https://stackoverflow.com/users/9578616/rohit-kavthekar"
      },
      "creation_date" : 1744028355,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140303088,
      "post_id" : 79556480,
      "body" : "I also support the Auth0 recommendation. It provides your login page as well as the other functionality you want for third party clients.",
      "score" : 0,
      "owner" : {
        "account_id" : 464646,
        "reputation" : 541,
        "user_id" : 868297,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/svgZ0.jpg?s=256",
        "display_name" : "Jaybird",
        "link" : "https://stackoverflow.com/users/868297/jaybird"
      },
      "creation_date" : 1743877289,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}