{
  "question" : {
    "question_id" : 79691800,
    "title" : "Spring Boot java Error 415 with json body on rest controller",
    "body" : "<p>I want to send a POST REQUEST to my REST CONTROLLER to create an Object but i always get the error 415.\nThis is my Pom.xml</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n    xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    &lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;3.5.3&lt;/version&gt;\n        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;\n    &lt;/parent&gt;\n    &lt;groupId&gt;com.supermercato&lt;/groupId&gt;\n    &lt;artifactId&gt;cassa-automatica&lt;/artifactId&gt;\n    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n    &lt;name&gt;cassaAutomatica&lt;/name&gt;\n    &lt;description&gt;Gestione casse automatiche supermercato&lt;/description&gt;\n    &lt;url/&gt;\n    &lt;licenses&gt;\n        &lt;license/&gt;\n    &lt;/licenses&gt;\n    &lt;developers&gt;\n        &lt;developer/&gt;\n    &lt;/developers&gt;\n    &lt;scm&gt;\n        &lt;connection/&gt;\n        &lt;developerConnection/&gt;\n        &lt;tag/&gt;\n        &lt;url/&gt;\n    &lt;/scm&gt;\n    &lt;properties&gt;\n        &lt;java.version&gt;21&lt;/java.version&gt;\n    &lt;/properties&gt;\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.h2database&lt;/groupId&gt;\n            &lt;artifactId&gt;h2&lt;/artifactId&gt;\n            &lt;scope&gt;runtime&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.mysql&lt;/groupId&gt;\n            &lt;artifactId&gt;mysql-connector-j&lt;/artifactId&gt;\n            &lt;scope&gt;runtime&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n\n    &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n\n&lt;/project&gt;\n</code></pre>\n<p>ControllerScontrini:</p>\n<pre><code>@RestController\n@RequestMapping(&quot;/scontrini&quot;)\npublic class ControllerScontrini {\n\n    private final ScontrinoService scontrinoService;\n\n    @Autowired\n    public ControllerScontrini(ScontrinoService scontrinoService){\n        this.scontrinoService=scontrinoService;\n    }\n\n   \n\n \n\n\n    @RequestMapping(value=&quot;/crea&quot;,method= RequestMethod.POST)\n    public Scontrino crea(@RequestBody Scontrino scontrino) {\n        return scontrinoService.crea(scontrino);\n    }\n\n}\n</code></pre>\n<p>Scontrino:</p>\n<pre><code>@Entity\npublic class Scontrino {\n    @Id\n    @GeneratedValue(strategy= GenerationType.IDENTITY)\n    private Long id;\n\n    private LocalDateTime data;\n\n    public LocalDateTime getData() {\n        return data;\n    }\n\n    public Scontrino(){}\n\n    public void setData(LocalDateTime data) {\n        this.data = data;\n    }\n\n    @ManyToMany\n    @JoinTable(\n            name=&quot;scontrino_articolo&quot;,\n            joinColumns = @JoinColumn(name= &quot;id_scontrino&quot;),\n            inverseJoinColumns = @JoinColumn(name= &quot;id_articolo&quot;)\n    )\n    private Set&lt;Articolo&gt; articoli=new HashSet&lt;&gt;();\n\n    //attributo dell’associazione tra articolo e scontrino\n    @ElementCollection\n    @JoinTable(name=&quot;Quantita_scontrino_articolo&quot;, joinColumns=@JoinColumn(name=&quot;id_scontrino&quot;))\n    @Column(name=&quot;Quantita&quot;)\n    @MapKeyJoinColumn(name=&quot;id_articolo&quot;)\n    private Map&lt;Articolo,Integer&gt; quantita = new HashMap&lt;Articolo,Integer&gt;();\n\n\n    public Set&lt;Articolo&gt; getArticoli() {\n        return articoli;\n    }\n\n    public Map&lt;Articolo, Integer&gt; getQuantita() {\n        return quantita;\n    }\n\n    public void addArticolo(Articolo articolo) {\n        this.articoli.add(articolo);\n        articolo.getScontrini().add(this);\n    }\n\n    public void removeArticolo(Articolo articolo) {\n        this.articoli.remove(articolo);\n        articolo.getScontrini().remove(this);\n    }\n\n    @Override\n    public boolean equals(Object o) {\n        if (this == o) return true;\n        if (!(o instanceof Scontrino)) return false;\n        Scontrino other = (Scontrino) o;\n        return id != null &amp;&amp; id.equals(other.id);\n    }\n\n    @Override\n    public int hashCode() {\n        return id != null ? id.hashCode() : 0;\n    }\n\n}\n</code></pre>\n<p>I send a request to : http://localhost:8080/scontrini/crea\nbut i always get this error:Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content-Type 'application/json;charset=UTF-8' is not supported]</p>\n<p>It's a problem from my pom xml? or i wrote something wrong in my controller or model class?\nthe service method just calls the save method of a repository for the model class and with other requests without a request body it works fine.</p>\n<p>This is the json request body:</p>\n<pre><code> {\n  &quot;data&quot;: &quot;2025-01-05T10:30:00&quot;\n}\n</code></pre>\n",
    "tags" : [ "java", "spring", "spring-boot", "maven" ],
    "owner" : {
      "account_id" : 32534409,
      "reputation" : 5,
      "user_id" : 25278108,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/d365a62a065bd315c2b4d923af90cca3?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Kishido",
      "link" : "https://stackoverflow.com/users/25278108/kishido"
    },
    "is_answered" : true,
    "view_count" : 122,
    "answer_count" : 3,
    "score" : -1,
    "last_activity_date" : 1752209248,
    "creation_date" : 1751809839,
    "link" : "https://stackoverflow.com/questions/79691800/spring-boot-java-error-415-with-json-body-on-rest-controller",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79697695,
    "question_id" : 79691800,
    "body" : "<p>I resolved this problem adding to my main package a ArticoloKeyDeserializer:</p>\n<pre><code>public class ArticoloKeyDeserializer extends KeyDeserializer {\n    @Override\n    public Object deserializeKey(String key, DeserializationContext ctxt) throws IOException {\n        // Crea un articolo e imposta l'id da key (che è la stringa JSON)\n        Articolo articolo = new Articolo();\n        articolo.setId(Long.valueOf(key));\n        return articolo;\n    }\n}\n</code></pre>\n<p>The problem was that Jackson couldn't serialize my &quot;Scontrino&quot; RequestBody because it has a Map&lt;Articolo,Integer&gt;, and &quot;Articolo&quot; is a custom class made by me, so i needed to use this deserializer to let Jackson know how to do it without errors.</p>\n",
    "score" : 0,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 32534409,
      "reputation" : 5,
      "user_id" : 25278108,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/d365a62a065bd315c2b4d923af90cca3?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Kishido",
      "link" : "https://stackoverflow.com/users/25278108/kishido"
    },
    "creation_date" : 1752191948,
    "last_activity_date" : 1752191948,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79697840,
    "question_id" : 79691800,
    "body" : "<p>Your Scontrino Class Contain LocalDateTime and Map&lt;Aritcolo,Integer&gt; with jackson the josan serializer used by springboot can not deserielised properly out of the box without help espically Map&lt;Articolo,Integer&gt; using entity as key</p>\n<p>Using Long and String as a key</p>\n<p>and refoctor your qulita to DTO's like</p>\n<p>class AritcoloQualita{</p>\n<p>private long aritcoloId;</p>\n<p>private int qualita;</p>\n<p>}</p>\n<p>add jaskon datatype</p>\n<p>&lt;dependency&gt;</p>\n<p>&lt;groupId &gt;com.fasterxml.json.datatype&lt;/grouId&gt;</p>\n<p>&lt;artifactId&gt;json-datatype-jsr-310&lt;/artifacrId&gt;</p>\n<p>&lt;/groupId&gt;</p>\n<p>public Jackson20ObjectMapperBuilderCustomer jsonCustomer(){</p>\n<p>return builder-&gt; builder.modules(new JavaTimeModules)}</p>\n<p>class scontrioRequestDTO{private LocalDateTime data ,</p>\n<p>private Map&lt;Long ,Integer&gt; quantita}</p>\n<p>public Scontrino cre(@RequestBody  ScontrinoRequestDto dto){return Sentrio Service.cre(dto)}</p>\n",
    "score" : -1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 24413448,
      "reputation" : 1,
      "user_id" : 18340617,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/d7f55b1d78701a7ae4b7f5d2d7b9313a?s=256&d=identicon&r=PG",
      "display_name" : "tanya",
      "link" : "https://stackoverflow.com/users/18340617/tanya"
    },
    "creation_date" : 1752209248,
    "last_activity_date" : 1752209248,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79691851,
    "question_id" : 79691800,
    "body" : "<pre class=\"lang-xml prettyprint-override\"><code>&lt;dependency&gt;\n    &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;\n    &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;com.fasterxml.jackson.datatype&lt;/groupId&gt;\n    &lt;artifactId&gt;jackson-datatype-jsr310&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>Perhaps you can try adding this Maven.</p>\n",
    "score" : -3,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 29997303,
      "reputation" : 1,
      "user_id" : 22988307,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a/ACg8ocJIPAIPmGFCwwltqUMCQ4xXFIY_LXKtJYjbgflzQoVT=k-s256",
      "display_name" : "HuangBig",
      "link" : "https://stackoverflow.com/users/22988307/huangbig"
    },
    "creation_date" : 1751813658,
    "last_activity_date" : 1751813658,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140569546,
    "post_id" : 79691800,
    "body" : "How are you invoking this request? through postman like client? Open up a terminal and run the following and get back to me with the outcome. <code>curl -X POST http:&#47;&#47;localhost:8080&#47;scontrini&#47;crea \\   -H &quot;Content-Type: application&#47;json&quot; \\   -d &#39;{&quot;data&quot;:&quot;2025-01-05T10:30:00&quot;}&#39; </code>",
    "score" : 0,
    "owner" : {
      "account_id" : 3594096,
      "reputation" : 888,
      "user_id" : 2999358,
      "user_type" : "registered",
      "accept_rate" : 67,
      "profile_image" : "https://www.gravatar.com/avatar/79f5379320e990fd351a2fc23ff3463c?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "k9yosh",
      "link" : "https://stackoverflow.com/users/2999358/k9yosh"
    },
    "creation_date" : 1751857982,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79697840" : [ {
      "comment_id" : 140581442,
      "post_id" : 79697840,
      "body" : "As it’s currently written, your answer is unclear. Please <a href=\"https://stackoverflow.com/posts/79697840/edit\">edit</a> to add additional details that will help others understand how this addresses the question asked. You can find more information on how to write good answers <a href=\"/help/how-to-answer\">in the help center</a>.",
      "score" : 0,
      "owner" : {
        "account_id" : -1,
        "reputation" : 1,
        "user_id" : -1,
        "user_type" : "moderator",
        "profile_image" : "https://www.gravatar.com/avatar/a007be5a61f6aa8f3e85ae2fc18dd66e?s=256&d=identicon&r=PG",
        "display_name" : "Community",
        "link" : "https://stackoverflow.com/users/-1/community"
      },
      "creation_date" : 1752209736,
      "content_license" : "CC BY-SA 4.0"
    } ],
    "79691851" : [ {
      "comment_id" : 140569902,
      "post_id" : 79691851,
      "body" : "Jackson is automatically pulled in by <code>spring-boot-starter-web</code> and doesn&#39;t need to be added manually nor configuration for the JSR310 as that will be setup automatically.",
      "score" : 0,
      "owner" : {
        "account_id" : 3192259,
        "reputation" : 126800,
        "user_id" : 2696260,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/qHEzx.png?s=256",
        "display_name" : "M. Deinum",
        "link" : "https://stackoverflow.com/users/2696260/m-deinum"
      },
      "creation_date" : 1751873871,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140568647,
      "post_id" : 79691851,
      "body" : "i dont think that&#39;s the real issue tho, my problem happens even with other entity classes",
      "score" : 0,
      "owner" : {
        "account_id" : 32534409,
        "reputation" : 5,
        "user_id" : 25278108,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/d365a62a065bd315c2b4d923af90cca3?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "Kishido",
        "link" : "https://stackoverflow.com/users/25278108/kishido"
      },
      "creation_date" : 1751816820,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140568592,
      "post_id" : 79691851,
      "body" : "Jackson should not support LocalDateTime and needs to manually import jsr310.",
      "score" : 0,
      "owner" : {
        "account_id" : 29997303,
        "reputation" : 1,
        "user_id" : 22988307,
        "user_type" : "registered",
        "profile_image" : "https://lh3.googleusercontent.com/a/ACg8ocJIPAIPmGFCwwltqUMCQ4xXFIY_LXKtJYjbgflzQoVT=k-s256",
        "display_name" : "HuangBig",
        "link" : "https://stackoverflow.com/users/22988307/huangbig"
      },
      "creation_date" : 1751815278,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140568542,
      "post_id" : 79691851,
      "body" : "What would this achieve? How does it address the issue the OP is seeing?  In particular considering this <a href=\"https://stackoverflow.com/a/77329409/438154\">stackoverflow.com/a/77329409/438154</a>",
      "score" : 0,
      "owner" : {
        "account_id" : 195331,
        "reputation" : 281037,
        "user_id" : 438154,
        "user_type" : "registered",
        "accept_rate" : 98,
        "profile_image" : "https://www.gravatar.com/avatar/4ec21df1e55febf8deb2e3b24b9cb39b?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "Sotirios Delimanolis",
        "link" : "https://stackoverflow.com/users/438154/sotirios-delimanolis"
      },
      "creation_date" : 1751813771,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140568541,
      "post_id" : 79691851,
      "body" : "Your answer could be improved with additional supporting information. Please <a href=\"https://stackoverflow.com/posts/79691851/edit\">edit</a> to add further details, such as citations or documentation, so that others can confirm that your answer is correct. You can find more information on how to write good answers <a href=\"/help/how-to-answer\">in the help center</a>.",
      "score" : 0,
      "owner" : {
        "account_id" : -1,
        "reputation" : 1,
        "user_id" : -1,
        "user_type" : "moderator",
        "profile_image" : "https://www.gravatar.com/avatar/a007be5a61f6aa8f3e85ae2fc18dd66e?s=256&d=identicon&r=PG",
        "display_name" : "Community",
        "link" : "https://stackoverflow.com/users/-1/community"
      },
      "creation_date" : 1751813758,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}