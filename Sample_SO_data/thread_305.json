{
  "question" : {
    "question_id" : 79819094,
    "title" : "Converting from Java model to JPA",
    "body" : "<p>I have implemented a class <code>User</code> that represents a User (so far either a Student or a Teacher). What they have in common is that they both have <code>ID</code>s, and some information about the user (this is stored in a composite class <code>UserInformation</code>). This is what the <code>User</code> class looked before:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public abstract class User {\n    private UUID id;\n    private UserInformation info;\n\n    public User(String surname, String name, String email) {\n        this.info = new UserInformation(surname, name, email);\n        this.id = UUID.randomUUID();\n    }\n\n    public UUID getId() {\n        return this.id;   \n    }\n\n    public UserInformation getInfo() {\n        return this.info;\n    }\n}\n</code></pre>\n<p>I then wanted to delve into H2 in-memory databases in Spring Boot and found out that I can use annotation <code>@Id</code> to represent the primary key of <code>User</code>. I also found that I can use the annotation <code>@GeneratedValue</code>, which would generate id for me.</p>\n<p>I therefore changed my code accordingly:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@MappedSuperclass \npublic abstract class User {\n    @Id \n    @GeneratedValue(strategy = GenerationType.UUID) \n    private UUID id; \n    @Embedded private UserInformation info;\n    \n    public User(String surname, String name, String email) {\n        this.info = new UserInformation(surname, name, email); \n    }\n\n    protected User() {\n    \n    }\n    \n    public UUID getId() {\n        return this.id; \n    }\n    \n    public UserInformation getInfo() {\n        return this.info;\n    }\n}\n</code></pre>\n<p>However, after this change, I can no longer access <code>Id</code> by the simple <code>getId</code> call. I have already built a lot around this <code>getId</code> functionality. Even in some of my custom exceptions, I refer to specific objects based on their Id like for example in this <code>GradeOutOfBoundsException</code>:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class GradeOutOfBoundsException extends Exception {\n\n    GradeOutOfBoundsException(int valueOfGrade, UUID studentId, String assignmentName) { \n        super( &quot;Value:&quot; + valueOfGrade + &quot; out of 0-100 bounds assigned for student with id: &quot; + studentId + &quot; in module &quot; + assignmentName); } \n}\n</code></pre>\n<p>I now have a couple of ideas on how this could be fixed</p>\n<ol>\n<li><p>Keep the explicit initialisation of id by using the UUID.randomUUID(). This would probably work, but I would prefer to use the annotation @GeneratedValue instead.</p>\n</li>\n<li><p>Stop using the id's in the code and use some other identifiers of the objects like the surname of a User.</p>\n</li>\n</ol>\n<p>What is the best practice to fix this issue?</p>\n",
    "tags" : [ "java", "spring-boot", "jpa", "spring-data-jpa", "model" ],
    "owner" : {
      "account_id" : 23956201,
      "reputation" : 7,
      "user_id" : 30033597,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a/AATXAJzX5GqA2dZMR1W4_FwxT0GldTfxWhTYtuAQL5QtEA=k-s256",
      "display_name" : "Alex",
      "link" : "https://stackoverflow.com/users/30033597/alex"
    },
    "is_answered" : true,
    "view_count" : 88,
    "answer_count" : 1,
    "score" : -3,
    "last_activity_date" : 1763054034,
    "creation_date" : 1763048684,
    "link" : "https://stackoverflow.com/questions/79819094/converting-from-java-model-to-jpa",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79819215,
    "question_id" : 79819094,
    "body" : "<p>I tried <em>re-following</em> your steps sort to say.<br />\nI created your an User:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@MappedSuperclass\n@Data\n@NoArgsConstructor\n@AllArgsConstructor\npublic abstract class User {\n    @Id\n    @GeneratedValue(strategy = GenerationType.UUID)\n    private UUID id;\n    private String info;\n\n\n}\n</code></pre>\n<p>I created Student:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Data\n@AllArgsConstructor\n@NoArgsConstructor\n@Entity\npublic class Student extends User{\n    private String course;\n    public Student(UUID id, String info, String course)\n    {\n        super(id, info);\n        this.course = course;\n    }\n}\n</code></pre>\n<p>Jpa repository ( I assumed from the title) :</p>\n<pre class=\"lang-java prettyprint-override\"><code>public interface StudentJpaRepository extends JpaRepository&lt;Student, UUID&gt; {\n}\n</code></pre>\n<p>And I was able to get the id through student.</p>\n<pre><code>private final StudentJpaRepository studentJpaRepository;\n\nStudent student1 = new Student(UUID.randomUUID(), &quot;Some info&quot;, &quot;Computer Science&quot;\n);\n\npublic UserController(StudentJpaRepository studentJpaRepository) {\n    this.studentJpaRepository = studentJpaRepository;\n}\n\n@GetMapping(&quot;/{id}&quot;)\npublic UUID getStudentId(@PathVariable UUID id) {\n    Student student = studentJpaRepository.findById(id)\n            .orElseThrow(() -&gt; new ResponseStatusException(HttpStatus.NOT_FOUND, &quot;Student not found&quot;));\n    return student.getId();\n}\n@GetMapping(&quot;/getId&quot;)\npublic UUID getStudent1Id() {\n    return student1.getId();\n}\n</code></pre>\n<p>Now I am not exactly sure what your issue is considering the amount of information. But I hope you can use this as a guildeline :D .</p>\n<p>p.s. @Data, @NoArgsConstructor and @AllArgsConstructor are just one liners that replace code.</p>\n",
    "score" : 2,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 44502765,
      "reputation" : 21,
      "user_id" : 31786568,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/d29109bf4401a87dc4da4f783d760edd?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Miconijefico",
      "link" : "https://stackoverflow.com/users/31786568/miconijefico"
    },
    "creation_date" : 1763054034,
    "last_activity_date" : 1763054034,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140860500,
    "post_id" : 79819094,
    "body" : "If there is some validation error, referencing a non-existing ID (since it isn&#39;t going to be committed to the DB) won&#39;t help the user or someone debugging since it wasn&#39;t created and there is nothing further to reference. In some cases, it might confuse initial debugging efforts, as it never existed. You absolutely should send back more meaningful data to users (email is usually unique), and include the IDs for committed/existing data references to allow you to debug issues and match up records to the data being sent in.",
    "score" : 0,
    "owner" : {
      "account_id" : 231721,
      "reputation" : 21335,
      "user_id" : 496099,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/efa7510cf47d7bd79e80486246e7e39e?s=256&d=identicon&r=PG",
      "display_name" : "Chris",
      "link" : "https://stackoverflow.com/users/496099/chris"
    },
    "creation_date" : 1763477438,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140858060,
    "post_id" : 79819094,
    "body" : "<i>I can no longer access <code>Id</code></i> here probably means that <code>getId()</code> returns <code>null</code> for new objects. This is expected because JPA takes care of <code>@GeneratedValue</code> fields when it actually saves the object to the database. This may be as late as when committing the transaction. If you need to access the <code>UUID id</code> of new objects, just stick to your original implementation. It is absolutely reasonable and I would say that this is an advantage of UUIDs over DB sequences - you don&#39;t have to wait for the DB or JPA to generate your id for you, while at the same time you are fairly sure the id is unique.",
    "score" : 1,
    "owner" : {
      "account_id" : 3284439,
      "reputation" : 40394,
      "user_id" : 2764255,
      "user_type" : "registered",
      "accept_rate" : 50,
      "profile_image" : "https://www.gravatar.com/avatar/2c14e217d79c08ca104e6e11d8e1710f?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Nikos Paraskevopoulos",
      "link" : "https://stackoverflow.com/users/2764255/nikos-paraskevopoulos"
    },
    "creation_date" : 1763380516,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140854418,
    "post_id" : 79819094,
    "body" : "When the method <code>getId</code> is called on a <code>User</code> object created using the <code>new</code> keyword, <code>id</code> is <code>null</code>, meaning that the method <code>getId</code> returns <code>null</code>.",
    "score" : 0,
    "owner" : {
      "account_id" : 23956201,
      "reputation" : 7,
      "user_id" : 30033597,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a/AATXAJzX5GqA2dZMR1W4_FwxT0GldTfxWhTYtuAQL5QtEA=k-s256",
      "display_name" : "Alex",
      "link" : "https://stackoverflow.com/users/30033597/alex"
    },
    "creation_date" : 1763133024,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140854316,
    "post_id" : 79819094,
    "body" : "What do you mean with &quot;I can no longer access <code>Id</code> by the simple <code>getId</code> call&quot;? Your new class <code>User</code> still has an <code>id</code> property and a <code>getId</code> method, so what do you mean by &quot;I cannot access ...&quot;?",
    "score" : 0,
    "owner" : {
      "account_id" : 45934,
      "reputation" : 207636,
      "user_id" : 135589,
      "user_type" : "registered",
      "accept_rate" : 100,
      "profile_image" : "https://www.gravatar.com/avatar/354d279a4def71b4541964105311709c?s=256&d=identicon&r=PG",
      "display_name" : "Jesper",
      "link" : "https://stackoverflow.com/users/135589/jesper"
    },
    "creation_date" : 1763130297,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79819215" : [ {
      "comment_id" : 140855006,
      "post_id" : 79819215,
      "body" : "@Alex new Student(UUID.randomUUID() &lt;- this line of code was just me creating some random Student object to show you how it works in that case. Let&#39;s imagine that instead of UUID.randomUUID() I just wrote some random UUID from my head. Point being no matter what type you have for your id. You just need to have it as a return type (if you want it ofc) and get the student and write &quot;student.getId().&quot; Hope this helps I am open to helping more.",
      "score" : 0,
      "owner" : {
        "account_id" : 44502765,
        "reputation" : 21,
        "user_id" : 31786568,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/d29109bf4401a87dc4da4f783d760edd?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "Miconijefico",
        "link" : "https://stackoverflow.com/users/31786568/miconijefico"
      },
      "creation_date" : 1763154862,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140854422,
      "post_id" : 79819215,
      "body" : "Say that the <code>id</code> wasn&#39;t a <code>UUID</code> but a <code>Long</code> that is incremented by the <code>GenerationType.IDENTITY</code> strategy. In such case, it is not possible to do this &#39;workaround&#39; using the<code>UUID.getRandomUUID()</code>. How would that be done in such a case?",
      "score" : 0,
      "owner" : {
        "account_id" : 23956201,
        "reputation" : 7,
        "user_id" : 30033597,
        "user_type" : "registered",
        "profile_image" : "https://lh3.googleusercontent.com/a/AATXAJzX5GqA2dZMR1W4_FwxT0GldTfxWhTYtuAQL5QtEA=k-s256",
        "display_name" : "Alex",
        "link" : "https://stackoverflow.com/users/30033597/alex"
      },
      "creation_date" : 1763133150,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}