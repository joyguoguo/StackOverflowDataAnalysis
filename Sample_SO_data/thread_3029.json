{
  "question" : {
    "question_id" : 79576958,
    "title" : "Cannot accessing parameter on Spring Batch custom ItemReader class",
    "body" : "<p>I'm trying to accessing parameter &quot;filePath&quot; from JobParameter to my custom ItemReader class using SpEL method.</p>\n<p>But got failed starting the project.</p>\n<p>My project is triggering Job from Rest API.</p>\n<blockquote>\n<p>This is error I have got &quot;EL1008E: Property or field 'jobParameters' cannot be found on object of type 'org.springframework.beans.factory.config.BeanExpressionContext' - maybe not public or not valid?&quot; :</p>\n</blockquote>\n<pre><code>Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.\n2025-04-16 16:12:17.568 SMI-NEW LOS ERROR  --- [main]   master-service o.s.boot.SpringApplication.reportFailure  :  Application run failed\norg.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'scopedTarget.debtorReader' defined in file [C:\\Users\\Indra\\IST\\SMI\\master-service\\target\\classes\\id\\co\\ist\\los\\master\\service\\migration\\reader\\DebtorReader.class]: Unsatisfied dependency expressed through constructor parameter 0: Expression parsing failed\n    at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:801)\n    at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:240)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1352)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1189)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:560)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:520)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)\n    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:973)\n    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:950)\n    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:616)\n    at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)\n    at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:738)\n    at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:440)\n    at org.springframework.boot.SpringApplication.run(SpringApplication.java:316)\n    at org.springframework.boot.SpringApplication.run(SpringApplication.java:1306)\n    at org.springframework.boot.SpringApplication.run(SpringApplication.java:1295)\n    at id.co.ist.los.MasterServiceApplication.main(MasterServiceApplication.java:17)\nCaused by: org.springframework.beans.factory.BeanExpressionException: Expression parsing failed\n    at org.springframework.context.expression.StandardBeanExpressionResolver.evaluate(StandardBeanExpressionResolver.java:170)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.evaluateBeanDefinitionString(AbstractBeanFactory.java:1591)\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1361)\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1337)\n    at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:910)\n    at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:788)\n    ... 19 common frames omitted\nCaused by: org.springframework.expression.spel.SpelEvaluationException: EL1008E: Property or field 'jobParameters' cannot be found on object of type 'org.springframework.beans.factory.config.BeanExpressionContext' - maybe not public or not valid?\n    at org.springframework.expression.spel.ast.PropertyOrFieldReference.readProperty(PropertyOrFieldReference.java:228)\n    at org.springframework.expression.spel.ast.PropertyOrFieldReference.getValueInternal(PropertyOrFieldReference.java:111)\n    at org.springframework.expression.spel.ast.PropertyOrFieldReference.getValueInternal(PropertyOrFieldReference.java:99)\n    at org.springframework.expression.spel.ast.CompoundExpression.getValueRef(CompoundExpression.java:61)\n    at org.springframework.expression.spel.ast.CompoundExpression.getValueInternal(CompoundExpression.java:97)\n    at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:114)\n    at org.springframework.expression.spel.standard.SpelExpression.getValue(SpelExpression.java:273)\n    at org.springframework.context.expression.StandardBeanExpressionResolver.evaluate(StandardBeanExpressionResolver.java:167)\n    ... 24 common frames omitted\n</code></pre>\n<blockquote>\n<p>Post API</p>\n</blockquote>\n<pre><code>@PostMapping(value = &quot;/upload-and-trigger&quot;, consumes = MediaType.MULTIPART_FORM_DATA_VALUE)\n    public ResponseEntity&lt;String&gt; uploadAndTriggerJob(\n            @RequestParam(&quot;file&quot;) MultipartFile file) {\n        try {\n            // Process the file (e.g., save to disk or parse content)\n            String filePath = saveFileToLocal(file);\n//            String encodedContent = java.util.Base64.getEncoder().encodeToString(file.getBytes());\n\n            // Add file path to Job Parameters\n            JobParametersBuilder jobParameters = new JobParametersBuilder();\n            jobParameters.addString(&quot;filePath&quot;, filePath);\n            jobParameters.addLong(&quot;time&quot;, System.currentTimeMillis());\n\n            // Launch the job\n            JobExecution jobExecution = jobLauncher.run(job, jobParameters.toJobParameters());\n            return ResponseEntity.ok(&quot;Job triggered successfully with status: &quot; + jobExecution.getStatus());\n        } catch (Exception e) {\n            return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR)\n                    .body(&quot;Failed to trigger job: &quot; + e.getMessage());\n        }\n    }\n</code></pre>\n<blockquote>\n<p>Batch Configuration</p>\n</blockquote>\n<pre><code>@Configuration\n@EnableBatchProcessing\npublic class MasterDebiturBatchConfig {\n\n    @Value(&quot;${edc.etl.transaction-sales.chunksize:1000}&quot;)\n    private Integer defaultChunkSize;\n//    @Value(&quot;${upload.path}&quot;)\n//    private String filePath;\n\n    @Autowired\n    private JobRepository jobRepository;\n    @Autowired\n    private PlatformTransactionManager transactionManager;\n\n\n    private static final String WILL_BE_INJECTED = null;\n    private String JOB_NAME = &quot;etl-migration-job&quot;;\n    private String EXECUTION_STEP_0 = &quot;execution-debitur-write&quot;;\n\n    @Bean\n    public Job myJob(Step myStep) {\n        return new JobBuilder(JOB_NAME, jobRepository)\n                .incrementer(new RunIdIncrementer())\n                .start(myStep)\n                .build();\n    }\n\n    @Bean\n    public Step myStep(DebtorReader debtorReader,\n                       LoggingDebtorProcessor loggingDebtorProcessor,\n                       DatabaseDebtorWriter myItemWriter) {\n        return new StepBuilder(EXECUTION_STEP_0, jobRepository)\n                .&lt;ReadDebtorDto, MDebtor&gt;chunk(defaultChunkSize, transactionManager)\n                .reader(debtorReader)\n                .processor(loggingDebtorProcessor)\n                .writer(myItemWriter)\n                .build();\n    }\n}\n</code></pre>\n<blockquote>\n<p>This is my Custom ItemReader Class. I'm using @Value(&quot;#{jobParameters['filePath']}&quot;) to access parameter from JobParameter at my Rest API.</p>\n</blockquote>\n<pre><code>@Component\n@StepScope\n@Scope(proxyMode = ScopedProxyMode.TARGET_CLASS)\n@Slf4j\npublic class DebtorReader implements ItemReader&lt;ReadDebtorDto&gt; {\n\n    private static final String WILL_BE_INJECTED = null;\n    private final String filePath;\n\n    public DebtorReader(@Value(&quot;#{jobParameters['filePath']}&quot;) String filePath) {\n        this.filePath = filePath;\n    }\n\n    @Override\n    public ReadDebtorDto read() throws Exception {\n        PoiItemReader&lt;ReadDebtorDto&gt; reader = new PoiItemReader&lt;&gt;();\n        reader.setResource(new ClassPathResource(filePath));\n        reader.setRowMapper(new DebtorRowMapper());\n        reader.setStrict(false);\n\n        var readDebtorDto = new ReadDebtorDto();\n        readDebtorDto.setName(reader.read().getName());\n        readDebtorDto.setNpwp(reader.read().getNpwp());\n        readDebtorDto.setDebtorType(reader.read().getDebtorType());\n        readDebtorDto.setDebtorRating(reader.read().getDebtorRating());\n        readDebtorDto.setCustomerId(reader.read().getCustomerId());\n\n        return readDebtorDto;\n    }\n}\n</code></pre>\n",
    "tags" : [ "java", "spring-boot", "spring-batch" ],
    "owner" : {
      "account_id" : 25312128,
      "reputation" : 1,
      "user_id" : 19134737,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a/AATXAJxbZrQQrv-jo6idOnXnlJG08AV3fIfWHoIFcQjR4g=k-s256",
      "display_name" : "iyp.prog",
      "link" : "https://stackoverflow.com/users/19134737/iyp-prog"
    },
    "is_answered" : false,
    "view_count" : 53,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1744862596,
    "creation_date" : 1744799408,
    "link" : "https://stackoverflow.com/questions/79576958/cannot-accessing-parameter-on-spring-batch-custom-itemreader-class",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79578448,
    "question_id" : 79576958,
    "body" : "<p>Already solved,  my program can run by add this injection at class MasterDebiturBatchConfig</p>\n<pre><code>@Bean\n@StepScope\npublic DebtorReader debtorReader(@Value(&quot;#{jobParameters['filePath']}&quot;) String filePath) {\n    return new DebtorReader(filePath);\n}\n</code></pre>\n<p>and remove this annotation and constructor at DebtorReader</p>\n<pre><code>@Component\n@StepScope\n@Scope(proxyMode = ScopedProxyMode.TARGET_CLASS)\n</code></pre>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 25312128,
      "reputation" : 1,
      "user_id" : 19134737,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a/AATXAJxbZrQQrv-jo6idOnXnlJG08AV3fIfWHoIFcQjR4g=k-s256",
      "display_name" : "iyp.prog",
      "link" : "https://stackoverflow.com/users/19134737/iyp-prog"
    },
    "creation_date" : 1744862570,
    "last_activity_date" : 1744862596,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140343071,
    "post_id" : 79576958,
    "body" : "@vijay thanks to you my program can run successfully",
    "score" : 0,
    "owner" : {
      "account_id" : 25312128,
      "reputation" : 1,
      "user_id" : 19134737,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a/AATXAJxbZrQQrv-jo6idOnXnlJG08AV3fIfWHoIFcQjR4g=k-s256",
      "display_name" : "iyp.prog",
      "link" : "https://stackoverflow.com/users/19134737/iyp-prog"
    },
    "creation_date" : 1744862185,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140343004,
    "post_id" : 79576958,
    "body" : "First, I&#39;m trying to run my program @Torge Rosendahl",
    "score" : 0,
    "owner" : {
      "account_id" : 25312128,
      "reputation" : 1,
      "user_id" : 19134737,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a/AATXAJxbZrQQrv-jo6idOnXnlJG08AV3fIfWHoIFcQjR4g=k-s256",
      "display_name" : "iyp.prog",
      "link" : "https://stackoverflow.com/users/19134737/iyp-prog"
    },
    "creation_date" : 1744858833,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140341568,
    "post_id" : 79576958,
    "body" : "To access JobParameters in a Spring Batch ItemReader, use <code>@StepScope</code> with field injection, not constructor injection. Spring can&#39;t resolve SpEL like <code>#{jobParameters[&#39;filePath&#39;]} </code> at startup time in constructors, as the parameters arenâ€™t yet in scope.",
    "score" : 0,
    "owner" : {
      "account_id" : 7645025,
      "reputation" : 440,
      "user_id" : 5795975,
      "user_type" : "registered",
      "profile_image" : "https://lh6.googleusercontent.com/-6KwPUS4RnyA/AAAAAAAAAAI/AAAAAAAAC8w/auZqreI45x0/s256-rj/photo.jpg",
      "display_name" : "Vijay",
      "link" : "https://stackoverflow.com/users/5795975/vijay"
    },
    "creation_date" : 1744820575,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140340657,
    "post_id" : 79576958,
    "body" : "For clarification: Are you trying to fix a bug or are try to get your program to run in the first place? Please add some clarification and a specific question.",
    "score" : 0,
    "owner" : {
      "account_id" : 11410767,
      "reputation" : 571,
      "user_id" : 10875738,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/OpPCu.jpg?s=256",
      "display_name" : "Torge Rosendahl",
      "link" : "https://stackoverflow.com/users/10875738/torge-rosendahl"
    },
    "creation_date" : 1744805603,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}