{
  "question" : {
    "question_id" : 79715629,
    "title" : "How to bundle an additional JAR file (updater) into a Compose for Desktop installer?",
    "body" : "<p>Problem Description:</p>\n<p>I'm developing a Kotlin Multiplatform application with Compose for Desktop and want to implement an auto-updater. My architecture consists of two parts:</p>\n<ol>\n<li>The main application (composeApp): Checks for new versions on GitHub at startup.</li>\n<li>A separate updater program (updater.jar): A small Kotlin/JVM program that is launched by the main application to download and install the new version.</li>\n</ol>\n<p>For this to work, the <code>updater.jar</code> file needs to be in the same directory as my main application's <code>.exe</code> after installation (e.g., in <code>C:\\Program Files\\project\\</code>).</p>\n<p>I've placed the updater.jar in the resources directory of my desktop module:\n<code>composeApp/src/desktopMain/resources/updater.jar</code></p>\n<p>However, when I build the installer using the Gradle task <code>./gradlew :composeApp:packageMsi</code> and install the application, the <code>updater.jar</code> is not in the installation directory. Only the <code>.exe</code> file and the <code>runtime</code> and <code>app</code> folders are present.</p>\n<p>Consequently, the attempt to launch the updater fails with a <code>FileNotFoundException</code> because the code can't find the file:</p>\n<pre><code>// This code fails because updater.jar does not exist\nval updaterJar = File(System.getProperty(&quot;user.dir&quot;), &quot;updater.jar&quot;)\nif (!updaterJar.exists()) {\n    // ... error handling\n}\n</code></pre>\n<p>What I've tried:\nBased on various guides, I've tried to bundle the file explicitly in my <code>build.gradle.kts</code>. My first attempt was to add the configuration inside the <code>nativeDistributions</code> block:</p>\n<pre><code>// In composeApp/build.gradle.kts\ncompose.desktop {\n    application {\n        mainClass = &quot;de.dev.project.MainKt&quot;\n        nativeDistributions {\n            packageName = &quot;project&quot;\n            // ... other settings ...\n\n            // FAILED ATTEMPT: This results in an 'Unresolved reference 'files'' error\n            files.from(&quot;src/desktopMain/resources/updater.jar&quot;) {\n                renameTo(&quot;updater.jar&quot;)\n            }\n        }\n    }\n}\n</code></pre>\n<p>However, this leads to an Unresolved reference 'files' error, as the files block seems to be invalid here.</p>\n<p>My Question:\nWhat is the correct and idiomatic way in Gradle for a Compose for Desktop project to ensure an arbitrary file (in this case, <code>updater.jar</code>) from my project sources is copied to the root of the final installation (next to the <code>.exe</code>)?</p>\n",
    "tags" : [ "java", "kotlin", "gradle", "kmp" ],
    "owner" : {
      "account_id" : 26292251,
      "reputation" : 428,
      "user_id" : 19959092,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/e9f62e2fc4dd4469aebc6e609301acfd?s=256&d=identicon&r=PG",
      "display_name" : "Pantastix",
      "link" : "https://stackoverflow.com/users/19959092/pantastix"
    },
    "is_answered" : true,
    "view_count" : 117,
    "answer_count" : 1,
    "score" : 3,
    "last_activity_date" : 1754271391,
    "creation_date" : 1753529288,
    "link" : "https://stackoverflow.com/questions/79715629/how-to-bundle-an-additional-jar-file-updater-into-a-compose-for-desktop-instal",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79724404,
    "question_id" : 79715629,
    "body" : "<p>A better way would be to use the <code>Resource</code> API.</p>\n<p>Use the <code>Class.getResourceAsStream(String path)</code> method to extract the jar at a place you'd prefer.</p>\n<pre class=\"lang-kotlin prettyprint-override\"><code>fun setupUpdater() {\n    val jarStream = javaClass.getResourceAsStream(&quot;/updater.jar&quot;)\n    with(jarStream) {\n        // Extract at installation site\n    }\n}\n</code></pre>\n<p>Include the updater.jar in your <code>resources</code> source set</p>\n",
    "score" : 0,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 21530600,
      "reputation" : 3028,
      "user_id" : 15870118,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a-/AOh14GjP8aOoG3z1x93cts9882DSeyp_3hgQ0_3fLaWI=k-s256",
      "display_name" : "JustinW",
      "link" : "https://stackoverflow.com/users/15870118/justinw"
    },
    "creation_date" : 1754271391,
    "last_activity_date" : 1754271391,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140620969,
    "post_id" : 79715629,
    "body" : "Is this what you&#39;re looking for? <a href=\"https://www.jetbrains.com/help/kotlin-multiplatform-dev/compose-native-distribution.html#adding-files-to-packaged-application\" rel=\"nofollow noreferrer\">jetbrains.com/help/kotlin-multiplatform-dev/&hellip;</a>",
    "score" : 0,
    "owner" : {
      "account_id" : 8532578,
      "reputation" : 49884,
      "user_id" : 6395627,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/af0f9bfe593f36642a032cd7ea611e7d?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Slaw",
      "link" : "https://stackoverflow.com/users/6395627/slaw"
    },
    "creation_date" : 1753572639,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}