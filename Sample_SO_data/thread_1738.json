{
  "question" : {
    "question_id" : 79679190,
    "title" : "Primefaces table load wrong value",
    "body" : "<p>I’m using PrimeFaces with a p:dataTable configured for lazy loading with pagination. Here's the relevant part of my DataTable:</p>\n<pre><code>&lt;p:dataTable id=&quot;formInstanceListTable&quot; selection=&quot;#{bulkOpBean.listReturnSelected}&quot;\n                     styleClass=&quot;borderless headerClass tableFixClass&quot;\n                     style=&quot;width:99%;margin-left: 10px;margin-top: 2px;&quot;\n                     rowStyleClass=&quot;evenoddRowClass return-row&quot; var=&quot;formInstance&quot; rowSelectMode=&quot;checkbox&quot;\n                     value=&quot;#{formInstanceListBean.formInstances}&quot; rowIndexVar=&quot;rowIndex&quot;\n                     paginator=&quot;true&quot; rows=&quot;#{formInstanceListBean.pageSize}&quot;\n                     first=&quot;#{formInstanceListBean.currentPageIndex}&quot;\n                     lazy=&quot;true&quot; paginatorPosition=&quot;bottom&quot; pageLinks=&quot;3&quot; sortMode=&quot;multiple&quot;\n                     paginatorAlwaysVisible=&quot;true&quot; tableStyleClass=&quot;formInstanceListTable&quot;\n                     rowsPerPageTemplate=&quot;10,15,50,100,{ShowAll|'All'}&quot; selectionPageOnly=&quot;true&quot;\n                     rowKey=&quot;#{formInstance.id}&quot; widgetVar=&quot;formInstanceListVar&quot; rowExpandMode=&quot;multiple&quot;\n                     paginatorTemplate=&quot;{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}&quot;&gt;\n\n</code></pre>\n<p>I’ve noticed an issue when applying the &quot;All&quot; filter on a page with a small number of rows. When I then change the filter —specifically the date filter— to a date range with more rows, the displayed rows become incorrect. Instead of showing the correct rows for the new date range, the page keeps repeating the first two rows until (if the previous page had 2 rows) the total number of rows matches the new date range.</p>\n<pre><code>    @Override\n    public List&lt;FormInstanceDto&gt; load(\n            final int first, final int pageSize,\n            final Map&lt;String, SortMeta&gt; multiSortMeta, final Map&lt;String, FilterMeta&gt; filters) {\n        updateReturnSources = false;\n        if (criteria.getProduct() == null || CollectionUtils.isEmpty(criteria.getValidFormId())) {\n            setRowCount(0);\n            criteria.setReload(false);\n            return new ArrayList&lt;&gt;();\n        }\n        if (criteria.isReload()) {\n            criteria.setStartRowIndex(0);\n        }\n        criteria.setStartRowIndex(first);\n        criteria.setPageSize(pageSize);\n\n        if (multiSortMeta != null &amp;&amp; multiSortMeta.size() &gt; 0) {\n            List&lt;com.lombardrisk.ocelot.core.jdbc.SortMeta&gt; sortMetas = new ArrayList&lt;&gt;();\n            for (SortMeta tempSort : multiSortMeta.values()) {\n                com.lombardrisk.ocelot.core.jdbc.SortMeta sortMeta =\n                        new com.lombardrisk.ocelot.core.jdbc.SortMeta();\n                sortMeta.setSortField(tempSort.getField());\n\n                if (SortOrder.ASCENDING.equals(tempSort.getOrder())) {\n                    sortMeta.setSortOrder(com.lombardrisk.ocelot.core.jdbc.SortOrder.ASC);\n                } else if (SortOrder.DESCENDING.equals(tempSort.getOrder())) {\n                    sortMeta.setSortOrder(com.lombardrisk.ocelot.core.jdbc.SortOrder.DESC);\n                }\n                sortMetas.add(sortMeta);\n            }\n            criteria.setMultiSortMeta(sortMetas);\n        }\n        saveCriteriaFrom();\n        PageResult&lt;FormInstanceDto&gt; pageResult = null;\n        try {\n            pageResult = formInstanceService.getFormInstanceDtosByCriteria(criteria);\n            if (pageResult.getResultList().size() == 0 &amp;&amp; criteria.getStartRowIndex() != 0) {\n                criteria.setStartRowIndex(0);\n                saveCriteriaFrom();\n                pageResult = formInstanceService.getFormInstanceDtosByCriteria(criteria);\n            }\n        } catch (EJBException e) {\n            if (e.getCausedByException() instanceof UserEntityLinkMissingException) {\n                MessagesUtil.addMessage(\n                        FacesMessage.SEVERITY_ERROR,\n                        &quot;reporter.createformInstance.user.entity.link.missing&quot;);\n            } else {\n                logger.error(&quot;Error when getting return list&quot;, e);\n                throw e;\n            }\n            setRowCount(0);\n            criteria.setReload(false);\n            return new ArrayList&lt;&gt;();\n        }\n\n        setRowCount(pageResult.getRowCount().intValue());\n        criteria.setReload(false);\n        PrimeFaces.current().executeScript(&quot;updateReturnSources()&quot;);\n        //Work Arround for PF Bug\n        PrimeFaces.current().executeScript(&quot;refreshGlobalTooltips()&quot;);\n        return pageResult.getResultList();\n    }\n</code></pre>\n<p>I made some changes to the backend part and now the result return correctly in the backend but the display in the dashboard is still wrong</p>\n<p>I tried using a primefaces refresh code to refresh the table but didn't work. The problem happen only when using the all filter</p>\n",
    "tags" : [ "java", "primefaces" ],
    "owner" : {
      "account_id" : 30415656,
      "reputation" : 1,
      "user_id" : 23308505,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a/ACg8ocLLbqD7REIonsHKYxLOpmMKxHIJVqo_n309iA_phZzA=k-s256",
      "display_name" : "juvia",
      "link" : "https://stackoverflow.com/users/23308505/juvia"
    },
    "is_answered" : false,
    "view_count" : 48,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1750860464,
    "creation_date" : 1750860359,
    "link" : "https://stackoverflow.com/questions/79679190/primefaces-table-load-wrong-value",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ ],
  "answer_comments" : { }
}