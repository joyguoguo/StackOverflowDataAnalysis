{
  "question" : {
    "question_id" : 79606751,
    "title" : "Apache POI `4.1.2` PowerPoint file corrupt on open, worked with Apache POI `3.17`",
    "body" : "<p>I'm generating a PowerPoint file using Apache POI version <code>4.1.2</code>. The file is created without any errors during execution, but when I try to open it in PowerPoint, I get the following error message:</p>\n<pre><code>&quot;PowerPoint found a problem with content in file.ppt&quot;\n</code></pre>\n<p>This same code worked without issues when using Apache POI <code>3.17</code>.</p>\n<p>Notably, I'm using the <code>addTitle()</code> method, which still appears in the POI <code>4.1.2</code> documentation. However, I suspect there may have been changes in how it should be used or how slides are initialized in this version.</p>\n<p>Here's the code I'm using</p>\n<pre><code>public class PPTTitleTest {\n    public static void main(String[] args) {\n        try {\n            HSLFSlideShow ppt = new HSLFSlideShow();\n            HSLFSlide slide = ppt.createSlide();\n            HSLFTextBox title = slide.addTitle();\n            title.setText(&quot;My Presentation Title&quot;);\n            FileOutputStream out = new FileOutputStream(&quot;file.ppt&quot;);\n            ppt.write(out);\n            out.close();\n        } catch (IOException e) {\n            e.printStackTrace();\n        }\n    }\n}\n</code></pre>\n",
    "tags" : [ "java", "apache-poi", "powerpoint" ],
    "owner" : {
      "account_id" : 41791098,
      "reputation" : 1,
      "user_id" : 30450786,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/08cf6ba6eb1397ecc912b3ca53ccaad5?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "psk187",
      "link" : "https://stackoverflow.com/users/30450786/psk187"
    },
    "is_answered" : false,
    "view_count" : 123,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1746553361,
    "creation_date" : 1746440943,
    "link" : "https://stackoverflow.com/questions/79606751/apache-poi-4-1-2-powerpoint-file-corrupt-on-open-worked-with-apache-poi-3-17",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140399896,
    "post_id" : 79606751,
    "body" : "@psk187: I am afraid, you have to wait until the bug report gets processed. Definitely it&#39;s a bug and only the Apache POI developers can solve it. But <code>HSLF</code> is on scratchpad level and not widely used as <code>XSLF</code> - the new Office Open XML version of Powerpoint. So be patient.",
    "score" : 0,
    "owner" : {
      "account_id" : 4853829,
      "reputation" : 62529,
      "user_id" : 3915431,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/27fffe0285cffa43de087072abd25c95?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Axel Richter",
      "link" : "https://stackoverflow.com/users/3915431/axel-richter"
    },
    "creation_date" : 1746528595,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140399576,
    "post_id" : 79606751,
    "body" : "I logged that bug yesterday. But there are no updates to it.",
    "score" : 0,
    "owner" : {
      "account_id" : 41791098,
      "reputation" : 1,
      "user_id" : 30450786,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/08cf6ba6eb1397ecc912b3ca53ccaad5?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "psk187",
      "link" : "https://stackoverflow.com/users/30450786/psk187"
    },
    "creation_date" : 1746522779,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140399063,
    "post_id" : 79606751,
    "body" : "See bug: <a href=\"https://bz.apache.org/bugzilla/show_bug.cgi?id=69669\" rel=\"nofollow noreferrer\">bz.apache.org/bugzilla/show_bug.cgi?id=69669</a>",
    "score" : 1,
    "owner" : {
      "account_id" : 4853829,
      "reputation" : 62529,
      "user_id" : 3915431,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/27fffe0285cffa43de087072abd25c95?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Axel Richter",
      "link" : "https://stackoverflow.com/users/3915431/axel-richter"
    },
    "creation_date" : 1746512795,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140398823,
    "post_id" : 79606751,
    "body" : "Yes. The powerpoint is opening correctly without addTitle()",
    "score" : 0,
    "owner" : {
      "account_id" : 41791098,
      "reputation" : 1,
      "user_id" : 30450786,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/08cf6ba6eb1397ecc912b3ca53ccaad5?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "psk187",
      "link" : "https://stackoverflow.com/users/30450786/psk187"
    },
    "creation_date" : 1746505000,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140397966,
    "post_id" : 79606751,
    "body" : "Did you try without using <code>addTitle()</code> to confirm?",
    "score" : 0,
    "owner" : {
      "account_id" : 372682,
      "reputation" : 26512,
      "user_id" : 721855,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/vZiox.png?s=256",
      "display_name" : "aled",
      "link" : "https://stackoverflow.com/users/721855/aled"
    },
    "creation_date" : 1746471357,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}