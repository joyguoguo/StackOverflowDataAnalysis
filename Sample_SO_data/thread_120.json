{
  "question" : {
    "question_id" : 79834516,
    "title" : "Spring WebClient takes too long to process the first request — subsequent calls fast",
    "body" : "<p>I'm using Spring WebClient in my Java application to authenticate with Keycloak.\nThe issue I'm facing is:</p>\n<p>The first WebClient request takes a long time (5-9 seconds), but all subsequent requests are extremely fast.</p>\n<p>This slowdown happens consistently everyday when I try to access the application for the first time.</p>\n<p>Here’s my WebClient configuration:</p>\n<pre><code>@Configuration\npublic class WebClientConfig {\n    @Bean\n    public WebClient webClient() {\n        return WebClient.builder()\n                .codecs(configurer -&gt;\n                        configurer.defaultCodecs().maxInMemorySize(5 * 1024 * 1024) // 5MB limit\n                    )\n                .build();\n        }\n    }\n}\n</code></pre>\n<p>And here is the login method making the Keycloak token call:</p>\n<pre><code>@Override\npublic LoginResponseDto login(LoginRequestDto loginRequestDto) {\n    LinkedMultiValueMap&lt;String, String&gt; formData = getLoginFormDataRequest(loginRequestDto);\n    String uri = UriComponentsBuilder.fromUriString(keycloakProperties.serverUrl())\n                .pathSegment(&quot;realms&quot;, keycloakProperties.realm(), &quot;protocol&quot;, &quot;openid-connect&quot;, &quot;token&quot;)\n                .toUriString();\n\n    try {\n        String response = webClient.post()\n                .uri(uri)\n                .contentType(MediaType.APPLICATION_FORM_URLENCODED)\n                .bodyValue(formData)\n                .retrieve()\n                .bodyToMono(String.class)\n                .block();\n\n        JsonNode jsonNode = objectMapper.readTree(response);\n        return new LoginResponseDto(\n                jsonNode.get(&quot;token_type&quot;).asText(),\n                jsonNode.get(&quot;access_token&quot;).asText(),\n                jsonNode.get(&quot;refresh_token&quot;).asText(),\n                jsonNode.get(&quot;expires_in&quot;).asText(),\n                jsonNode.get(&quot;refresh_expires_in&quot;).asText()\n        );\n    } catch (WebClientResponseException e) {\n        log.error(&quot;Error in Keycloak login: {}&quot;, e.getMessage(), e);\n        if (e.getStatusCode() == HttpStatus.UNAUTHORIZED) {\n            throw new InvalidCredentialsException(&quot;Invalid username or password&quot;, projectUtil.getCurrentUtcTimestamp());\n        }\n        throw new KeycloakServiceException(&quot;Invalid password&quot;, projectUtil.getCurrentUtcTimestamp());\n        } catch (JsonProcessingException e) {\n            log.error(&quot;JsonProcessing error in Keycloak login: {}&quot;, e.getMessage(), e);\n            throw new KeycloakServiceException(&quot;JSON processing error: login&quot;, projectUtil.getCurrentUtcTimestamp());\n        }\n    }\n}\n</code></pre>\n<p>What I’ve observed:</p>\n<ul>\n<li><p>It only happens for the very first request after startup.</p>\n</li>\n<li><p>Could be related to connection pool initialization, DNS lookup, SSL handshake, or WebClient configuration.</p>\n</li>\n<li><p>Using block() — but I need blocking here since this method must return synchronously.</p>\n</li>\n</ul>\n<p>Why does the first WebClient request take significantly longer than subsequent ones, and how can I prevent or reduce this startup delay?</p>\n<p>Any insights, profiling tips, or config improvements would be very helpful.</p>\n",
    "tags" : [ "java", "spring", "spring-boot", "webclient" ],
    "owner" : {
      "account_id" : 30536733,
      "reputation" : 25,
      "user_id" : 23403710,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a/ACg8ocKQiMcxKUYDNnFfFmxLFDhws22tUgILF-CgoBIXSwVvqA=k-s256",
      "display_name" : "Anish",
      "link" : "https://stackoverflow.com/users/23403710/anish"
    },
    "is_answered" : false,
    "view_count" : 81,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1764621499,
    "creation_date" : 1764578605,
    "link" : "https://stackoverflow.com/questions/79834516/spring-webclient-takes-too-long-to-process-the-first-request-subsequent-calls",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ ],
  "answer_comments" : { }
}