{
  "question" : {
    "question_id" : 79778831,
    "title" : "Make assumption based on verify in Mockito",
    "body" : "<p>Can you make <a href=\"https://docs.junit.org/5.0.0/api/org/junit/jupiter/api/Assumptions.html\" rel=\"nofollow noreferrer\">assumptions</a> with Mockito?</p>\n<p>If the method's not invoked, this would throw <code>AssertionError</code> and make the test fail.</p>\n<pre class=\"lang-java prettyprint-override\"><code>then(mock).should().doSomething();\n</code></pre>\n<p>Instead, I want the test to be skipped, similar to <a href=\"https://docs.junit.org/5.0.0/api/org/junit/jupiter/api/Assumptions.html#assumeTrue-boolean-\" rel=\"nofollow noreferrer\"><code>assumeTrue()</code></a> (JUnit) or <a href=\"https://joel-costigliola.github.io/assertj/core-8/api/org/assertj/core/api/Assumptions.html\" rel=\"nofollow noreferrer\"><code>assumeThat()</code></a> (AssertJ).</p>\n<p>Mockito 4.11.0.</p>\n",
    "tags" : [ "java", "testing", "mockito" ],
    "owner" : {
      "account_id" : 10187542,
      "reputation" : 2683,
      "user_id" : 20692967,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/NZSXm.jpg?s=256",
      "display_name" : "Sergey Zolotarev",
      "link" : "https://stackoverflow.com/users/20692967/sergey-zolotarev"
    },
    "is_answered" : true,
    "view_count" : 127,
    "answer_count" : 1,
    "score" : -3,
    "last_activity_date" : 1759258855,
    "creation_date" : 1759217606,
    "link" : "https://stackoverflow.com/questions/79778831/make-assumption-based-on-verify-in-mockito",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79778883,
    "question_id" : 79778831,
    "body" : "<p>You <em>could</em> catch the exception from <code>verify</code> and rethrow it as <code>TestAbortedException</code>:</p>\n<pre><code>try {\n  verify(mockObject).doSomething();\n} catch (final MockitoAssertionError ex) {\n  throw new TestAbortedException(&quot;Method doSomething not called&quot;, ex);\n}\n</code></pre>\n<p>(Although I don't know why you'd want to not fail the test in this case. If the method call is not required, don't verify/assert it at all?)</p>\n<p>Extract a utility method to make this logic reusable:</p>\n<pre><code>class VerificationAssumptions {\n  private VerificationAssumptions() {}\n\n  static void assumeVerify(final String message, final Runnable verification) {\n    try {\n      verification.run();\n    } catch (final MockitoAssertionError ex) {\n      throw new TestAbortedException(message, ex);\n    }\n  }\n}\n</code></pre>\n<p>and then use:</p>\n<pre><code>VerificationAssumptions.assumeVerify(\n  &quot;Method doSomething not called&quot;,\n  () -&gt; verify(mockObject).doSomething());\n</code></pre>\n<p>(you might be able to implement a nicer API, such as <code>assumeVerify(mockObject).doSomething()</code>, but I'll leave this to the reader ;))</p>\n",
    "score" : 1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 39208,
      "reputation" : 269387,
      "user_id" : 112968,
      "user_type" : "registered",
      "accept_rate" : 68,
      "profile_image" : "https://i.sstatic.net/zHTaT.png?s=256",
      "display_name" : "knittl",
      "link" : "https://stackoverflow.com/users/112968/knittl"
    },
    "creation_date" : 1759221525,
    "last_activity_date" : 1759258855,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140768282,
    "post_id" : 79778831,
    "body" : "Why is it closed exactly?",
    "score" : 0,
    "owner" : {
      "account_id" : 10187542,
      "reputation" : 2683,
      "user_id" : 20692967,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/NZSXm.jpg?s=256",
      "display_name" : "Sergey Zolotarev",
      "link" : "https://stackoverflow.com/users/20692967/sergey-zolotarev"
    },
    "creation_date" : 1759221888,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140768269,
    "post_id" : 79778831,
    "body" : "Yes, but you cannot <i>assume</i> beforehand that a method will not be invoked. The test has already run. If you want the test to be marked as skipped, then perhaps you can use <code>try { verify(mock, atLeastOnce()).should(); } catch (AssertionError _) { assumeTrue(false, &quot;should() hasn&#39;t been invoked&quot;); }</code>. I&#39;m guessing the error to catch, you may need to change it.",
    "score" : 1,
    "owner" : {
      "account_id" : 1211967,
      "reputation" : 9964,
      "user_id" : 1180351,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/pKB8y.png?s=256",
      "display_name" : "Rob Spoor",
      "link" : "https://stackoverflow.com/users/1180351/rob-spoor"
    },
    "creation_date" : 1759221486,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140768187,
    "post_id" : 79778831,
    "body" : "@RobSpoor those methods <i>assert</i>, not <i>assume</i>",
    "score" : 0,
    "owner" : {
      "account_id" : 10187542,
      "reputation" : 2683,
      "user_id" : 20692967,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/NZSXm.jpg?s=256",
      "display_name" : "Sergey Zolotarev",
      "link" : "https://stackoverflow.com/users/20692967/sergey-zolotarev"
    },
    "creation_date" : 1759219134,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140768163,
    "post_id" : 79778831,
    "body" : "You won&#39;t know that the method is not invoked until the end of the test. And that&#39;s what you can use <code>verify(mock, never()).should()</code> for, or perhaps even <code>verifyNoInteractions(mock)</code> or <code>verifyNoMoreInteractions(mock)</code>.",
    "score" : 0,
    "owner" : {
      "account_id" : 1211967,
      "reputation" : 9964,
      "user_id" : 1180351,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/pKB8y.png?s=256",
      "display_name" : "Rob Spoor",
      "link" : "https://stackoverflow.com/users/1180351/rob-spoor"
    },
    "creation_date" : 1759218453,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140768146,
    "post_id" : 79778831,
    "body" : "@Progman I believe it&#39;s totally clear: <i>&quot;I want the test to be skipped, similar to assumeTrue() (JUnit) or assumeThat() (AssertJ)&quot;</i>",
    "score" : 0,
    "owner" : {
      "account_id" : 10187542,
      "reputation" : 2683,
      "user_id" : 20692967,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/NZSXm.jpg?s=256",
      "display_name" : "Sergey Zolotarev",
      "link" : "https://stackoverflow.com/users/20692967/sergey-zolotarev"
    },
    "creation_date" : 1759218069,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140768139,
    "post_id" : 79778831,
    "body" : "It is unclear what you are asking or what the problem is. Please <a href=\"https://stackoverflow.com/posts/79778831/edit\">edit</a> your question to include a more detailed description of the problem you have.",
    "score" : 0,
    "owner" : {
      "account_id" : 108033,
      "reputation" : 20099,
      "user_id" : 286934,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/f16a184d26b72795ff243464d715cffe?s=256&d=identicon&r=PG",
      "display_name" : "Progman",
      "link" : "https://stackoverflow.com/users/286934/progman"
    },
    "creation_date" : 1759217920,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79778883" : [ {
      "comment_id" : 140769628,
      "post_id" : 79778883,
      "body" : "@SergeyZolotarev Is this then not a better option? <a href=\"https://junit-pioneer.org/docs/disable-if-test-fails/\" rel=\"nofollow noreferrer\">junit-pioneer.org/docs/disable-if-test-fails</a>",
      "score" : 0,
      "owner" : {
        "account_id" : 1211967,
        "reputation" : 9964,
        "user_id" : 1180351,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/pKB8y.png?s=256",
        "display_name" : "Rob Spoor",
        "link" : "https://stackoverflow.com/users/1180351/rob-spoor"
      },
      "creation_date" : 1759258934,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140768280,
      "post_id" : 79778883,
      "body" : "Well, I need to make sure X happened before proceeding with the test of Y (the test of Y should not fail if X does)",
      "score" : 0,
      "owner" : {
        "account_id" : 10187542,
        "reputation" : 2683,
        "user_id" : 20692967,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/NZSXm.jpg?s=256",
        "display_name" : "Sergey Zolotarev",
        "link" : "https://stackoverflow.com/users/20692967/sergey-zolotarev"
      },
      "creation_date" : 1759221850,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}