{
  "question" : {
    "question_id" : 79589023,
    "title" : "Why is Java application not listening on the expected ports?",
    "body" : "<p>I used nmap to scan ports of a host, finding only port 22 is available.</p>\n<p>I'm running a Java program that listens to some ports. Also there is nginx running.</p>\n<p>I haven't added any network rules. I think the ports should be available. I want to know what is the cause.</p>\n<p>Here are the listening ports:</p>\n<pre><code># netstat -tuplen\nActive Internet connections (only servers)\nProto Recv-Q Send-Q Local Address           Foreign Address         State       User       Inode      PID/Program name\ntcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      0          36293      3340/sshd: /usr/sbi\ntcp        0      0 0.0.0.0:443             0.0.0.0:*               LISTEN      0          76361      14869/nginx: master\ntcp        0      0 0.0.0.0:19111           0.0.0.0:*               LISTEN      0          76362      14869/nginx: master\ntcp        0      0 0.0.0.0:3306            0.0.0.0:*               LISTEN      3306       73851      11954/mysqld\ntcp        0      0 0.0.0.0:10443           0.0.0.0:*               LISTEN      0          76363      14869/nginx: master\ntcp        0      0 0.0.0.0:111             0.0.0.0:*               LISTEN      0          37005      1595/rpcbind\ntcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      0          86118      14869/nginx: master\ntcp6       0      0 :::22                   :::*                    LISTEN      0          36295      3340/sshd: /usr/sbi\ntcp6       0      0 :::33060                :::*                    LISTEN      3306       25261      11954/mysqld\ntcp6       0      0 :::111                  :::*                    LISTEN      0          37008      1595/rpcbind\nudp        0      0 0.0.0.0:61782           0.0.0.0:*                           0          37004      1595/rpcbind\nudp        0      0 0.0.0.0:68              0.0.0.0:*                           0          25924      2247/dhclient\nudp        0      0 0.0.0.0:111             0.0.0.0:*                           0          39082      1595/rpcbind\nudp        0      0 127.0.0.1:323           0.0.0.0:*                           0          39104      1689/chronyd\nudp6       0      0 :::111                  :::*                                0          37006      1595/rpcbind\nudp6       0      0 ::1:323                 :::*                                0          39105      1689/chronyd\nudp6       0      0 :::53922                :::*                                0          37007      1595/rpcbind\n\n</code></pre>\n<p>Here are the iptables rules:</p>\n<pre><code># iptables -L\nChain INPUT (policy ACCEPT)\ntarget     prot opt source               destination\n\nChain FORWARD (policy DROP)\ntarget     prot opt source               destination\nDOCKER-USER  all  --  anywhere             anywhere\nDOCKER-ISOLATION-STAGE-1  all  --  anywhere             anywhere\nACCEPT     all  --  anywhere             anywhere             ctstate RELATED,ESTABLISHED\nDOCKER     all  --  anywhere             anywhere\nACCEPT     all  --  anywhere             anywhere\nACCEPT     all  --  anywhere             anywhere\n\nChain OUTPUT (policy ACCEPT)\ntarget     prot opt source               destination\n\nChain DOCKER (1 references)\ntarget     prot opt source               destination\n\nChain DOCKER-ISOLATION-STAGE-1 (1 references)\ntarget     prot opt source               destination\nDOCKER-ISOLATION-STAGE-2  all  --  anywhere             anywhere\nRETURN     all  --  anywhere             anywhere\n\nChain DOCKER-ISOLATION-STAGE-2 (1 references)\ntarget     prot opt source               destination\nDROP       all  --  anywhere             anywhere\nRETURN     all  --  anywhere             anywhere\n\nChain DOCKER-USER (1 references)\ntarget     prot opt source               destination\nRETURN     all  --  anywhere             anywhere\n</code></pre>\n<p>All the rules are set by docker. I can only see 'FORWARD' rules. So I think this is not the problem.</p>\n<p>I don't know what else to check. Any thoughts?</p>\n",
    "tags" : [ "docker", "java" ],
    "owner" : {
      "account_id" : 9287961,
      "reputation" : 193,
      "user_id" : 6897210,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/5b4d6ce4868c2288919a9c52d7fca29f?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Calvin_Z",
      "link" : "https://stackoverflow.com/users/6897210/calvin-z"
    },
    "is_answered" : true,
    "view_count" : 96,
    "answer_count" : 3,
    "score" : 1,
    "last_activity_date" : 1745423900,
    "creation_date" : 1745371206,
    "link" : "https://stackoverflow.com/questions/79589023/why-is-java-application-not-listening-on-the-expected-ports"
  },
  "answers" : [ {
    "answer_id" : 79589024,
    "question_id" : 79589023,
    "body" : "<p>Services can listen on all interfaces (<code>0.0.0.0</code> and <code>[::]</code>) or on a specific interface, like loopback (e.g. <code>127.0.0.1</code> and <code>[::1]</code>).</p>\n<p>Check with the following command, and make sure that your service is listening on all interfaces or on an IP that is set on the external facing interface. You can see the IP addresses assigned to the interfaces with <code>ip address show</code>.</p>\n<pre><code>sudo ss -tlnp|less\nsudo netstat -tlnp|less    # older systems\n</code></pre>\n<p>For docker containers, make sure that you map the ports when you create the container, or edit the container config to add the mapping to fix network access.</p>\n",
    "score" : 3,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 109493,
      "reputation" : 2644,
      "user_id" : 290087,
      "user_type" : "registered",
      "accept_rate" : 80,
      "profile_image" : "https://www.gravatar.com/avatar/5a085ec390128f3a5a9496692a705bcc?s=256&d=identicon&r=PG",
      "display_name" : "Mircea Vutcovici",
      "link" : "https://stackoverflow.com/users/290087/mircea-vutcovici"
    },
    "creation_date" : 1745372190,
    "last_activity_date" : 1745372190,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79589025,
    "question_id" : 79589023,
    "body" : "<p>By default <code>nmap</code> only checks the 1000 most common ports so your problem might not be a problem at all, but just the result of an incomplete test.</p>\n<p>————————</p>\n<p>To connect to a (remote) TCP/IP port there needs to be something listening on that port.</p>\n<p>That listener can be bound to any interface or to a specific interface / IP-address.\nYou can’t connect when it’s bound to the wrong interface.</p>\n<p>You check how the listener is bound on the server offering that service with <code>netstat</code> or <code>ss</code> and test and confirm by attempting to connect to that port with a suitable client (<code>telnet</code> , <code>curl</code> , <code>openssl s_client</code> and others)</p>\n<p>In some cases, like for example a listener in a container, the listener isn’t directly associated with a particular network interface, but must be <a href=\"https://docs.docker.com/get-started/docker-concepts/running-containers/publishing-ports/\" rel=\"nofollow noreferrer\">published / exposed </a> which creates a mapping via netfilter/iptables rules of a port on the host to the listener.\nYou can check for that mapping with your container management tools ( like <code>docker</code> or <code>podman</code>) or low level firewall management tools (<code>iptables-save</code> , <code>nftables</code>)</p>\n<p><strong>Firewalls</strong> can prevent remote clients from accessing the listener. A firewall can be <strong>host-based</strong> which you can investigate with low level firewall management tools (<code>iptables-save</code> , <code>nftables</code>) or <strong>external firewalls</strong> implemented somewhere else in your network (think of  appliances, ACL’s on routers , security groups in cloud platforms and more).  Investigations on remote firewalls requires a better understanding of your network layout and even then can be a pita.</p>\n<p>———-</p>\n<p>A more complete debugging tutorial is available in this old answer of mine <a href=\"https://serverfault.com/a/1109720/37681\">https://serverfault.com/a/1109720/37681</a></p>\n",
    "score" : 2,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 487474,
      "reputation" : 171,
      "user_id" : 2952385,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/GCvNn.jpg?s=256",
      "display_name" : "HBruijn",
      "link" : "https://stackoverflow.com/users/2952385/hbruijn"
    },
    "creation_date" : 1745396183,
    "last_activity_date" : 1745398091,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79589026,
    "question_id" : 79589023,
    "body" : "<blockquote>\n<p>But I'm running a java program listening to some ports</p>\n</blockquote>\n<p>Then it would show in the output netstat(1). Your java program is not listening on any socket. You can also confirm this using <code>lsof</code>.</p>\n<ol>\n<li>assuming that netstat and the java app are running in the same network namespace</li>\n</ol>\n",
    "score" : 2,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 78802,
      "reputation" : 48397,
      "user_id" : 223992,
      "user_type" : "registered",
      "accept_rate" : 86,
      "profile_image" : "https://www.gravatar.com/avatar/2c69074600f4d1cdb9c6d78370ab3335?s=256&d=identicon&r=PG",
      "display_name" : "symcbean",
      "link" : "https://stackoverflow.com/users/223992/symcbean"
    },
    "creation_date" : 1745417129,
    "last_activity_date" : 1745421264,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140433648,
    "post_id" : 79589023,
    "body" : "We need a whole slew more info here. The Dockerfile at least, and the command with which you started the container. The <code>docker-compose.yaml</code>, if used. And an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, showing how you bind to the ports.",
    "score" : 0,
    "owner" : {
      "account_id" : 1358954,
      "reputation" : 20992,
      "user_id" : 1296707,
      "user_type" : "registered",
      "accept_rate" : 50,
      "profile_image" : "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=256&d=identicon&r=PG",
      "display_name" : "Markus W Mahlberg",
      "link" : "https://stackoverflow.com/users/1296707/markus-w-mahlberg"
    },
    "creation_date" : 1747423175,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140362223,
    "post_id" : 79589023,
    "body" : "<code>I&#39;m running a java program listening to some ports</code> what does the logs if the application show?",
    "score" : 0,
    "owner" : {
      "account_id" : 58796,
      "reputation" : 133,
      "user_id" : 175990,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/e70d3453d63c0b4609327275d237f368?s=256&d=identicon&r=PG",
      "display_name" : "Greg Askew",
      "link" : "https://stackoverflow.com/users/175990/greg-askew"
    },
    "creation_date" : 1745419879,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}