{
  "question" : {
    "question_id" : 79789219,
    "title" : "What is the use-case for non-sealed children of sealed classes and interfaces?",
    "body" : "<p>I just learned about sealed classes in Java, and it seems nice to have something between final and ordinary non-final classes.</p>\n<p>But the <code>sealed</code> and <code>permits</code> modifiers only affect immediate children of a class; this doesn't quite seem right to me. In particular, you can get arbitrary subclasses of a sealed class by using a <code>non-sealed</code> &quot;shim&quot;/backdoor class:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public sealed class Shape permits Ellipse, Polygon { /* ... */ }\n\npublic non-sealed class Ellipse extends Shape { /* ... */ }\n\npublic class RealEllipse1 extends Ellipse { /* ... */ }\npublic class RealEllipse2 extends Ellipse { /* ... */ }\npublic class RealEllipse3 extends Ellipse { /* ... */ }\n// and so on\n</code></pre>\n<p>And since the <code>is-a</code> relation is transitive, any instance of those <code>RealEllipseN</code> classes are <code>Shape</code> objects.</p>\n<p>This seems to defeat the intent of marking a class sealed. If the permitted subclasses can allow themselves to be arbitrarily subclassed, you effectively have arbitrary subclasses (if not direct subclasses) of the sealed class -- and the relevant operators and typechecking are transitive -- that is, things like this work, right?</p>\n<pre class=\"lang-java prettyprint-override\"><code>Shape aShape = new RealEllipse2();\nRealEllipse1 anotherShape = new RealEllipse1();\n\nif (anotherShape instanceof Shape) {\n   // this executes; instanceof says anotherShape is an instance of Shape\n}\n</code></pre>\n<p>The above inheritance-related semantics seem at odds with having subclasses of a sealed class that are non-final. What's the motivation or use-case for <code>non-sealed</code> and such?</p>\n<p>(This is related to <a href=\"https://stackoverflow.com/questions/74337681/is-the-permits-relationship-of-java-sealed-classes-interfaces-transitive\">this question</a>.)</p>\n",
    "tags" : [ "java", "sealed", "sealed-class" ],
    "owner" : {
      "account_id" : 513690,
      "reputation" : 131,
      "user_id" : 12440795,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/18dd70922721650ed0cd0cce37ccd6ad?s=256&d=identicon&r=PG",
      "display_name" : "Dan Drake",
      "link" : "https://stackoverflow.com/users/12440795/dan-drake"
    },
    "is_answered" : false,
    "view_count" : 94,
    "closed_date" : 1760361982,
    "answer_count" : 0,
    "score" : -1,
    "last_activity_date" : 1760356129,
    "creation_date" : 1760355204,
    "link" : "https://stackoverflow.com/questions/79789219/what-is-the-use-case-for-non-sealed-children-of-sealed-classes-and-interfaces",
    "closed_reason" : "Duplicate"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140796980,
    "post_id" : 79789219,
    "body" : "Such a type hierarchy may model the (technical) reality. See for example the <a href=\"https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/constant/ConstantDesc.html\" rel=\"nofollow noreferrer\"><code>ConstantDesc</code></a> interface. Its subclasses represent the eight types of constants the JVM can handle by itself (and have dedicated bytecode format) plus <a href=\"https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/constant/DynamicConstantDesc.html\" rel=\"nofollow noreferrer\">the type for dynamic constants</a> which is the only way to add custom constants to a class file. So custom constant types must be subclasses of <code>DynamicConstantDesc</code>.",
    "score" : 1,
    "owner" : {
      "account_id" : 3211603,
      "reputation" : 300981,
      "user_id" : 2711488,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/t2hoD.jpg?s=256",
      "display_name" : "Holger",
      "link" : "https://stackoverflow.com/users/2711488/holger"
    },
    "creation_date" : 1760528962,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140793781,
    "post_id" : 79789219,
    "body" : "@MarkRotteveel, that&#39;s very helpful -- the idea with this &quot;escape hatch&quot; / non-sealed subclass is, as I understand, is to <i>allow</i> more classes that are descendants of the original sealed class -- and because such classes are descendants of the non-sealed class, you can both (1) consider those classes to be an instance of the original sealed class, but also (2) detect that they came to be via the escape hatch. Further flexibility in the inheritance mechanisms...",
    "score" : 1,
    "owner" : {
      "account_id" : 513690,
      "reputation" : 131,
      "user_id" : 12440795,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/18dd70922721650ed0cd0cce37ccd6ad?s=256&d=identicon&r=PG",
      "display_name" : "Dan Drake",
      "link" : "https://stackoverflow.com/users/12440795/dan-drake"
    },
    "creation_date" : 1760390609,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140792716,
    "post_id" : 79789219,
    "body" : "Did you read <a href=\"https://openjdk.org/jeps/409\" rel=\"nofollow noreferrer\">JEP 409: Sealed Classes</a>: <i>&quot;A permitted subclass may be declared <code>non-sealed</code> so that its part of the hierarchy reverts to being open for extension by unknown subclasses.&quot;</i> and <i>&quot;Even though the <code>WeirdShape</code> is open to extension by unknown classes, all instances of those subclasses are also instances of <code>WeirdShape</code>. Therefore code written to test whether an instance of <code>Shape</code> is either a <code>Circle</code>, a <code>Rectangle</code>, a <code>Square</code>, or a <code>WeirdShape</code> remains exhaustive.&quot;</i>",
    "score" : 7,
    "owner" : {
      "account_id" : 213468,
      "reputation" : 110282,
      "user_id" : 466862,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=256&d=identicon&r=PG",
      "display_name" : "Mark Rotteveel",
      "link" : "https://stackoverflow.com/users/466862/mark-rotteveel"
    },
    "creation_date" : 1760356193,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140792712,
    "post_id" : 79789219,
    "body" : "Maybe better explained from your example: That <code>Shape</code> is sealed means that if I cover <code>Ellipse</code> and <code>Polygon</code>, then I have covered all possibilities. No matter how elaborate an inheritance hierarchy you make under <code>Ellipse</code>, this will still hold true. Because you cannot make anything there that isn’t an <code>Ellipse</code>. So what would anyone want to seal the children for?",
    "score" : 4,
    "owner" : {
      "account_id" : 7612423,
      "reputation" : 87400,
      "user_id" : 5772882,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/8283c64511fa80afed5259d10850168f?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Anonymous",
      "link" : "https://stackoverflow.com/users/5772882/anonymous"
    },
    "creation_date" : 1760356147,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140792709,
    "post_id" : 79789219,
    "body" : "It’s to prevent direct subclassing, which is pretty communicative. It’s to let you play architectural games you can’t with <code>final</code>. Better pattern matching, closed sets of extension points.",
    "score" : 3,
    "owner" : {
      "account_id" : 195854,
      "reputation" : 160525,
      "user_id" : 438992,
      "user_type" : "registered",
      "accept_rate" : 90,
      "profile_image" : "https://i.sstatic.net/QouOz.jpg?s=256",
      "display_name" : "Dave Newton",
      "link" : "https://stackoverflow.com/users/438992/dave-newton"
    },
    "creation_date" : 1760356027,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140792697,
    "post_id" : 79789219,
    "body" : "I assume that a non.sealed child of a sealed class or interface means “I don’t know which children this will have, it’s for someone else to decide”. Whoever uses the fact that the top-level class or interface is sealed, just needs to know the direct descendants and doesn’t care about further descendants, so there’s no need to seal them.",
    "score" : 2,
    "owner" : {
      "account_id" : 7612423,
      "reputation" : 87400,
      "user_id" : 5772882,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/8283c64511fa80afed5259d10850168f?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Anonymous",
      "link" : "https://stackoverflow.com/users/5772882/anonymous"
    },
    "creation_date" : 1760355763,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}