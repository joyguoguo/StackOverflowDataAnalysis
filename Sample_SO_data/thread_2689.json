{
  "question" : {
    "question_id" : 79602663,
    "title" : "In Spring.AI 1.0.0-SnapShot Why am I getting Unknown parameter: &#39;response_format.schema",
    "body" : "<p><a href=\"https://docs.spring.io/spring-ai/reference/api/chat/openai-chat.html\" rel=\"nofollow noreferrer\">https://docs.spring.io/spring-ai/reference/api/chat/openai-chat.html</a>\n<a href=\"https://spring.io/blog/2024/08/09/spring-ai-embraces-openais-structured-outputs-enhancing-json-response\" rel=\"nofollow noreferrer\">https://spring.io/blog/2024/08/09/spring-ai-embraces-openais-structured-outputs-enhancing-json-response</a></p>\n<p>Above is the documentation for the spring.ai for structured outputs with open ai. However Whenever I try to make a request I keep getting</p>\n<blockquote>\n<p>Unknown parameter: 'response_format.schema,</p>\n</blockquote>\n<p>even though I am copying and pasting the code provided in the documentation and I am the using the same version as outlined in the documentation. I will attach my pom.xml files and my application.properties and my Endpoint.\nIve attached the postman request error at the bottom</p>\n<p><a href=\"https://i.sstatic.net/MKHlHVpB.png\" rel=\"nofollow noreferrer\">Documentation on Configuring via Application Properties</a></p>\n<p><a href=\"https://i.sstatic.net/M60oD59p.png\" rel=\"nofollow noreferrer\">Documentation on OpenAi Chat Properties</a></p>\n<p><strong>endpoint being called</strong></p>\n<pre><code>@RestController\nclass AiController {\n    private final ChatClient chatClient;\n\n    public AiController(ChatClient.Builder chatClientBuilder) {\n        this.chatClient = chatClientBuilder.build();\n    }\n\n    @PostMapping(&quot;/ai&quot;)\n    String generation(@RequestParam String request) {\n        return this.chatClient.prompt()\n            .user(request)\n            .call()\n            .content();\n    }\n}\n</code></pre>\n<p><strong>application.properties</strong></p>\n<pre><code>spring.application.name=p4p\n\nspring.ai.openai.api-key=API-KEY\nspring.ai.openai.chat.options.model=gpt-4o-mini\n\nspring.ai.openai.chat.options.responseFormat.type=JSON_SCHEMA\nspring.ai.openai.chat.options.responseFormat.name=MySchemaName\nspring.ai.openai.chat.options.responseFormat.schema={&quot;type&quot;:&quot;object&quot;,&quot;properties&quot;:{&quot;steps&quot;:{&quot;type&quot;:&quot;array&quot;,&quot;items&quot;:{&quot;type&quot;:&quot;object&quot;,&quot;properties&quot;:{&quot;explanation&quot;:{&quot;type&quot;:&quot;string&quot;},&quot;output&quot;:{&quot;type&quot;:&quot;string&quot;}},&quot;required&quot;:[&quot;explanation&quot;,&quot;output&quot;],&quot;additionalProperties&quot;:false}},&quot;final_answer&quot;:{&quot;type&quot;:&quot;string&quot;}},&quot;required&quot;:[&quot;steps&quot;,&quot;final_answer&quot;],&quot;additionalProperties&quot;:false}\nspring.ai.openai.chat.options.responseFormat.strict=true\n</code></pre>\n<p><strong>pom.xml</strong></p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n    xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    &lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;3.4.5&lt;/version&gt;\n        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;\n    &lt;/parent&gt;\n    &lt;groupId&gt;akl.p4p&lt;/groupId&gt;\n    &lt;artifactId&gt;uoa&lt;/artifactId&gt;\n    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n    &lt;name&gt;uoa&lt;/name&gt;\n    &lt;description&gt;Part Four Project&lt;/description&gt;\n    &lt;url/&gt;\n    &lt;licenses&gt;\n        &lt;license/&gt;\n    &lt;/licenses&gt;\n    &lt;developers&gt;\n        &lt;developer/&gt;\n    &lt;/developers&gt;\n    &lt;scm&gt;\n        &lt;connection/&gt;\n        &lt;developerConnection/&gt;\n        &lt;tag/&gt;\n        &lt;url/&gt;\n    &lt;/scm&gt;\n    &lt;repositories&gt;\n        &lt;repository&gt;\n            &lt;id&gt;spring-snapshots&lt;/id&gt;\n            &lt;name&gt;Spring Snapshots&lt;/name&gt;\n            &lt;url&gt;https://repo.spring.io/snapshot&lt;/url&gt;\n            &lt;releases&gt;\n            &lt;enabled&gt;false&lt;/enabled&gt;\n            &lt;/releases&gt;\n        &lt;/repository&gt;\n        &lt;repository&gt;\n            &lt;name&gt;Central Portal Snapshots&lt;/name&gt;\n            &lt;id&gt;central-portal-snapshots&lt;/id&gt;\n            &lt;url&gt;https://central.sonatype.com/repository/maven-snapshots/&lt;/url&gt;\n            &lt;releases&gt;\n            &lt;enabled&gt;false&lt;/enabled&gt;\n            &lt;/releases&gt;\n            &lt;snapshots&gt;\n            &lt;enabled&gt;true&lt;/enabled&gt;\n            &lt;/snapshots&gt;\n        &lt;/repository&gt;\n    &lt;/repositories&gt;\n\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-data-mongodb&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.ai&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-ai-starter-model-openai&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;\n            &lt;scope&gt;runtime&lt;/scope&gt;\n            &lt;optional&gt;true&lt;/optional&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;\n            &lt;artifactId&gt;lombok&lt;/artifactId&gt;\n            &lt;optional&gt;true&lt;/optional&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n    &lt;dependencyManagement&gt;\n        &lt;dependencies&gt;\n            &lt;dependency&gt;\n                &lt;groupId&gt;org.springframework.ai&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-ai-bom&lt;/artifactId&gt;\n                &lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt;\n                &lt;type&gt;pom&lt;/type&gt;\n                &lt;scope&gt;import&lt;/scope&gt;\n            &lt;/dependency&gt;\n        &lt;/dependencies&gt;\n    &lt;/dependencyManagement&gt;\n\n    &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\n                &lt;configuration&gt;\n                    &lt;annotationProcessorPaths&gt;\n                        &lt;path&gt;\n                            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;\n                            &lt;artifactId&gt;lombok&lt;/artifactId&gt;\n                        &lt;/path&gt;\n                    &lt;/annotationProcessorPaths&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n                &lt;configuration&gt;\n                    &lt;excludes&gt;\n                        &lt;exclude&gt;\n                            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;\n                            &lt;artifactId&gt;lombok&lt;/artifactId&gt;\n                        &lt;/exclude&gt;\n                    &lt;/excludes&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n\n&lt;/project&gt;\n</code></pre>\n<p><strong>Postman Request Error</strong></p>\n<pre><code>{\n    &quot;timestamp&quot;: &quot;2025-05-01T23:31:10.721+00:00&quot;,\n    &quot;status&quot;: 500,\n    &quot;error&quot;: &quot;Internal Server Error&quot;,\n    &quot;trace&quot;: &quot;org.springframework.ai.retry.NonTransientAiException: 400 - {\\n  \\&quot;error\\&quot;: {\\n    \\&quot;message\\&quot;: \\&quot;Unknown parameter: 'response_format.schema'.\\&quot;,\\n    \\&quot;type\\&quot;: \\&quot;invalid_request_error\\&quot;,\\n    \\&quot;param\\&quot;: \\&quot;response_format.schema\\&quot;,\\n    \\&quot;code\\&quot;: \\&quot;unknown_parameter\\&quot;\\n  }\\n}\\r\\n\\tat org.springframework.ai.retry.autoconfigure.SpringAiRetryAutoConfiguration$2.handleError(SpringAiRetryAutoConfiguration.java:100)\\r\\n\\tat org.springframework.web.client.ResponseErrorHandler.handleError(ResponseErrorHandler.java:58)\\r\\n\\tat org.springframework.web.client.StatusHandler.lambda$fromErrorHandler$1(StatusHandler.java:71)\\r\\n\\tat org.springframework.web.client.StatusHandler.handle(StatusHandler.java:146)\\r\\n\\tat org.springframework.web.client.DefaultRestClient$DefaultResponseSpec.applyStatusHandlers(DefaultRestClient.java:831)\\r\\n\\tat org.springframework.web.client.DefaultRestClient$DefaultResponseSpec.lambda$readBody$4(DefaultRestClient.java:820)\\r\\n\\tat org.springframework.web.client.DefaultRestClient.readWithMessageConverters(DefaultRestClient.java:216)\\r\\n\\tat org.springframework.web.client.DefaultRestClient$DefaultResponseSpec.readBody(DefaultRestClient.java:819)\\r\\n\\tat org.springframework.web.client.DefaultRestClient$DefaultResponseSpec.lambda$toEntityInternal$2(DefaultRestClient.java:775)\\r\\n\\tat org.springframework.web.client.DefaultRestClient$DefaultRequestBodyUriSpec.exchangeInternal(DefaultRestClient.java:579)\\r\\n\\tat org.springframework.web.client.DefaultRestClient$DefaultRequestBodyUriSpec.exchange(DefaultRestClient.java:533)\\r\\n\\tat org.springframework.web.client.RestClient$RequestHeadersSpec.exchange(RestClient.java:680)\\r\\n\\tat org.springframework.web.client.DefaultRestClient$DefaultResponseSpec.executeAndExtract(DefaultRestClient.java:814)\\r\\n\\tat org.springframework.web.client.DefaultRestClient$DefaultResponseSpec.toEntityInternal(DefaultRestClient.java:774)\\r\\n\\tat org.springframework.web.client.DefaultRestClient$DefaultResponseSpec.toEntity(DefaultRestClient.java:763)\\r\\n\\tat org.springframework.ai.openai.api.OpenAiApi.chatCompletionEntity(OpenAiApi.java:166)\\r\\n\\tat org.springframework.ai.openai.OpenAiChatModel.lambda$internalCall$1(OpenAiChatModel.java:197)\\r\\n\\tat org.springframework.retry.support.RetryTemplate.doExecute(RetryTemplate.java:357)\\r\\n\\tat org.springframework.retry.support.RetryTemplate.execute(RetryTemplate.java:230)\\r\\n\\tat org.springframework.ai.openai.OpenAiChatModel.lambda$internalCall$3(OpenAiChatModel.java:197)\\r\\n\\tat io.micrometer.observation.Observation.observe(Observation.java:564)\\r\\n\\tat org.springframework.ai.openai.OpenAiChatModel.internalCall(OpenAiChatModel.java:194)\\r\\n\\tat org.springframework.ai.openai.OpenAiChatModel.call(OpenAiChatModel.java:179)\\r\\n\\tat org.springframework.ai.chat.client.advisor.ChatModelCallAdvisor.adviseCall(ChatModelCallAdvisor.java:54)\\r\\n\\tat org.springframework.ai.chat.client.advisor.DefaultAroundAdvisorChain.lambda$nextCall$1(DefaultAroundAdvisorChain.java:122)\\r\\n\\tat io.micrometer.observation.Observation.observe(Observation.java:564)\\r\\n\\tat org.springframework.ai.chat.client.advisor.DefaultAroundAdvisorChain.nextCall(DefaultAroundAdvisorChain.java:119)\\r\\n\\tat org.springframework.ai.chat.client.DefaultChatClient$DefaultCallResponseSpec.lambda$doGetObservableChatClientResponse$1(DefaultChatClient.java:515)\\r\\n\\tat io.micrometer.observation.Observation.observe(Observation.java:564)\\r\\n\\tat org.springframework.ai.chat.client.DefaultChatClient$DefaultCallResponseSpec.doGetObservableChatClientResponse(DefaultChatClient.java:513)\\r\\n\\tat org.springframework.ai.chat.client.DefaultChatClient$DefaultCallResponseSpec.doGetObservableChatClientResponse(DefaultChatClient.java:494)\\r\\n\\tat org.springframework.ai.chat.client.DefaultChatClient$DefaultCallResponseSpec.content(DefaultChatClient.java:489)\\r\\n\\tat akl.p4p.uoa.controllers.AiController.generation(AiController.java:24)\\r\\n\\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\r\\n\\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\\r\\n\\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\r\\n\\tat java.base/java.lang.reflect.Method.invoke(Method.java:568)\\r\\n\\tat org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)\\r\\n\\tat org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)\\r\\n\\tat org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)\\r\\n\\tat org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986)\\r\\n\\tat org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891)\\r\\n\\tat org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)\\r\\n\\tat org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)\\r\\n\\tat org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)\\r\\n\\tat org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)\\r\\n\\tat org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)\\r\\n\\tat jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)\\r\\n\\tat org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)\\r\\n\\tat jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)\\r\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)\\r\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)\\r\\n\\tat org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)\\r\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)\\r\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)\\r\\n\\tat org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)\\r\\n\\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)\\r\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)\\r\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)\\r\\n\\tat org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)\\r\\n\\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)\\r\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)\\r\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)\\r\\n\\tat org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)\\r\\n\\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)\\r\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)\\r\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)\\r\\n\\tat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)\\r\\n\\tat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)\\r\\n\\tat org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)\\r\\n\\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)\\r\\n\\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)\\r\\n\\tat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)\\r\\n\\tat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)\\r\\n\\tat org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)\\r\\n\\tat org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)\\r\\n\\tat org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)\\r\\n\\tat org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)\\r\\n\\tat org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)\\r\\n\\tat org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)\\r\\n\\tat org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)\\r\\n\\tat org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)\\r\\n\\tat java.base/java.lang.Thread.run(Thread.java:833)\\r\\n&quot;,\n    &quot;message&quot;: &quot;400 - {\\n  \\&quot;error\\&quot;: {\\n    \\&quot;message\\&quot;: \\&quot;Unknown parameter: 'response_format.schema'.\\&quot;,\\n    \\&quot;type\\&quot;: \\&quot;invalid_request_error\\&quot;,\\n    \\&quot;param\\&quot;: \\&quot;response_format.schema\\&quot;,\\n    \\&quot;code\\&quot;: \\&quot;unknown_parameter\\&quot;\\n  }\\n}&quot;,\n    &quot;path&quot;: &quot;/ai&quot;\n}\n</code></pre>\n",
    "tags" : [ "java", "spring", "openai-api", "spring-ai" ],
    "owner" : {
      "account_id" : 28584981,
      "reputation" : 11,
      "user_id" : 21885399,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a/AGNmyxYZd2WD5dYR7eQM6_Yyv6VwW5e4IjxakYU1p7DeYQ=k-s256",
      "display_name" : "SirBillyBobJoe",
      "link" : "https://stackoverflow.com/users/21885399/sirbillybobjoe"
    },
    "is_answered" : false,
    "view_count" : 332,
    "answer_count" : 1,
    "score" : 1,
    "last_activity_date" : 1748425017,
    "creation_date" : 1746142931,
    "link" : "https://stackoverflow.com/questions/79602663/in-spring-ai-1-0-0-snapshot-why-am-i-getting-unknown-parameter-response-format",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79603284,
    "question_id" : 79602663,
    "body" : "<p>This looks like a bug in Spring AI itself to me. It's happening because the <a href=\"https://github.com/spring-projects/spring-ai/blob/7bb553ecce0a436406a9ed9b091c5d9ae545b9ea/models/spring-ai-openai/src/main/java/org/springframework/ai/openai/api/ResponseFormat.java#L103-L105\" rel=\"nofollow noreferrer\"><code>ResponseFormat</code></a> class is used both to deserialize the <code>spring.ai.openai.chat.options.response-format.*</code> properties <strong>and</strong> to pass as part of the request body to the OpenAI API for using a <a href=\"https://platform.openai.com/docs/guides/structured-outputs?api-mode=responses#how-to-use\" rel=\"nofollow noreferrer\">structured response</a>.</p>\n<p>To make this work, Spring AI <a href=\"https://github.com/spring-projects/spring-ai/blob/7bb553ecce0a436406a9ed9b091c5d9ae545b9ea/models/spring-ai-openai/src/main/java/org/springframework/ai/openai/api/ResponseFormat.java#L91-L96\" rel=\"nofollow noreferrer\">converts</a> the <code>ResponseFormat.schema</code> property (which is a string containing JSON) to an actual object/map in <code>ResponseFormat.jsonSchema</code>. The problem is that the original <code>ResponseFormat.schema</code> property is still (unnecessarily) passed to the OpenAI API. Apparantly OpenAI doesn't like that and throws a 400 Bad Request telling you that <code>response_format.schema</code> is not known. Perhaps earlier versions of OpenAI didn't fail on unknown parameters.</p>\n<p>A workaround is to not rely on the application properties, but to construct the <code>OpenAiChatOptions</code> by yourself. For example, in your controller you could use:</p>\n<pre class=\"lang-java prettyprint-override\"><code>this.chatClient = chatClientBuilder\n    .defaultOptions(OpenAiChatOptions.builder()\n        .responseFormat(ResponseFormat.builder()\n            .type(ResponseFormat.Type.JSON_SCHEMA)\n            .jsonSchema(ResponseFormat.JsonSchema.builder()\n                .schema(&quot;{\\&quot;type\\&quot;:\\&quot;object\\&quot;,\\&quot;properties\\&quot;:{\\&quot;steps\\&quot;:{\\&quot;type\\&quot;:\\&quot;array\\&quot;,\\&quot;items\\&quot;:{\\&quot;type\\&quot;:\\&quot;object\\&quot;,\\&quot;properties\\&quot;:{\\&quot;explanation\\&quot;:{\\&quot;type\\&quot;:\\&quot;string\\&quot;},\\&quot;output\\&quot;:{\\&quot;type\\&quot;:\\&quot;string\\&quot;}},\\&quot;required\\&quot;:[\\&quot;explanation\\&quot;,\\&quot;output\\&quot;],\\&quot;additionalProperties\\&quot;:false}},\\&quot;final_answer\\&quot;:{\\&quot;type\\&quot;:\\&quot;string\\&quot;}},\\&quot;required\\&quot;:[\\&quot;steps\\&quot;,\\&quot;final_answer\\&quot;],\\&quot;additionalProperties\\&quot;:false}&quot;)\n                .strict(true)\n            .build())\n        .build())\n    .build();\n</code></pre>\n<p>Be aware, doing this means that you need to configure all properties under <code>spring.ai.openai.chat.options.*</code> programmatically.</p>\n<p>I also logged <a href=\"https://github.com/spring-projects/spring-ai/issues/2969\" rel=\"nofollow noreferrer\">a bug on GitHub</a>.</p>\n<p><strong>EDIT</strong>: It has been fixed since 1.0.0-RC1.</p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 2161358,
      "reputation" : 45211,
      "user_id" : 1915448,
      "user_type" : "registered",
      "accept_rate" : 96,
      "profile_image" : "https://www.gravatar.com/avatar/51afb9344f8a44e60916753d37186513?s=256&d=identicon&r=PG",
      "display_name" : "Dimitri Mestdagh",
      "link" : "https://stackoverflow.com/users/1915448/dimitri-mestdagh"
    },
    "creation_date" : 1746184959,
    "last_activity_date" : 1748425017,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140389035,
    "post_id" : 79602663,
    "body" : "Hello, as a general advice on SO, avoid multiple line ok links, prefer quoting the most relevant extracts from the links you provide along the links themselves.",
    "score" : 0,
    "owner" : {
      "account_id" : 4431388,
      "reputation" : 1044,
      "user_id" : 3608483,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/63a1919652813f28b2a60a7e1fbf7b80?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "XouDo",
      "link" : "https://stackoverflow.com/users/3608483/xoudo"
    },
    "creation_date" : 1746166742,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}