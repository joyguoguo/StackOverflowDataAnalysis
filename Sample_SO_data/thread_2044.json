{
  "question" : {
    "question_id" : 79653263,
    "title" : "Android TextView Marquee: How to Control Scroll Speed? ObjectAnimator Alternative Text Cutting",
    "body" : "<p>I'm building a text display app that needs horizontal scrolling text with controllable speed. I've spent time trying different approaches but had issues with both.</p>\n<p>I third to achieve:</p>\n<ul>\n<li>Horizontal scrolling text - marquee effect</li>\n<li>User adjustable scroll speed</li>\n<li>Seamless looping</li>\n</ul>\n<p>Approach 1: Native Marquee</p>\n<p>This works perfectly except I cannot control the speed:</p>\n<pre><code>private void setupScrollingText(TextView textView) {\n    textView.setSingleLine(true);\n    textView.setEllipsize(TextUtils.TruncateAt.MARQUEE);\n    textView.setMarqueeRepeatLimit(-1);\n    textView.setSelected(true);\n    textView.setHorizontallyScrolling(true);\n\n    textView.post(() -&gt; {\n        int availableHeight = textView.getHeight() - \n                textView.getPaddingTop() - textView.getPaddingBottom();\n        float optimalSize = availableHeight * 0.8f;\n        textView.setTextSize(TypedValue.COMPLEX_UNIT_PX, optimalSize);\n    });\n}\n</code></pre>\n<p>I tried:</p>\n<ul>\n<li>To modify mMarquee.mPixelsPerSecond / mScrollUnit</li>\n<li>Modifying animation duration</li>\n</ul>\n<p>Approach 2: ObjectAnimator</p>\n<p>Speed is controllable, but ObjectAnimator cuts off text that is being scrolled with the last letter in the cut off text often being only partially displayed:</p>\n<pre><code>private void setupScrollingText(TextView textView) {\n    textView.setSingleLine(true);\n    \n    textView.post(() -&gt; {\n        textView.measure(View.MeasureSpec.UNSPECIFIED, View.MeasureSpec.UNSPECIFIED);\n        float textWidth = textView.getMeasuredWidth();\n        int containerWidth = root.getWidth() - root.getPaddingLeft() - root.getPaddingRight();\n        \n        if (textWidth &gt; containerWidth) {\n            long duration = calculateDurationFromSpeed(textWidth, scrollSpeed);\n            ObjectAnimator animator = ObjectAnimator.ofFloat(textView, &quot;translationX&quot;, \n                containerWidth, -textWidth);\n            animator.setDuration(duration);\n            animator.setRepeatCount(ObjectAnimator.INFINITE);\n            animator.setInterpolator(new LinearInterpolator());\n            animator.start();\n        }\n    });\n}\n</code></pre>\n<p>Text cut off happens regardless of layout params match_parent, wrap_content.</p>\n<p>XML:</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\n&lt;FrameLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\n    android:id=&quot;@+id/displayRoot&quot;\n    android:layout_width=&quot;match_parent&quot;\n    android:layout_height=&quot;match_parent&quot;\n    android:orientation=&quot;vertical&quot;\n    android:gravity=&quot;center&quot;&gt;\n\n    &lt;!-- Display --&gt;\n    &lt;TextView\n        android:id=&quot;@+id/displayText&quot;\n        android:layout_width=&quot;match_parent&quot;\n        android:layout_height=&quot;match_parent&quot;\n        android:text=&quot;&quot;\n        android:textSize=&quot;48sp&quot;\n        android:textColor=&quot;#FFFFFF&quot;\n        android:gravity=&quot;center&quot;\n        android:padding=&quot;16dp&quot;\n        android:layout_gravity=&quot;center&quot; /&gt;\n&lt;/FrameLayout&gt;\n</code></pre>\n<ul>\n<li>How can I control native marquee speed? Is there a working method for Android API 21+ that actually changes the scroll rate?</li>\n<li>Why does ObjectAnimator cause text cutting? What's the issue that causes cut off letters in scroll?</li>\n<li>Alternative approaches? If the two I was trying to implement are not possible to</li>\n</ul>\n<p>The native marquee approach works for display but lacks speed control. The ObjectAnimator approach gives speed control but breaks text, does not display the full text.</p>\n",
    "tags" : [ "java", "android", "animation", "textview", "marquee" ],
    "owner" : {
      "account_id" : 25536221,
      "reputation" : 13,
      "user_id" : 24045668,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/716b98636ab313d88599a26878f0dba8?s=256&d=identicon&r=PG",
      "display_name" : "Dor1ma",
      "link" : "https://stackoverflow.com/users/24045668/dor1ma"
    },
    "is_answered" : false,
    "view_count" : 65,
    "answer_count" : 0,
    "score" : 1,
    "last_activity_date" : 1749060311,
    "creation_date" : 1749058925,
    "link" : "https://stackoverflow.com/questions/79653263/android-textview-marquee-how-to-control-scroll-speed-objectanimator-alternativ",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140491416,
    "post_id" : 79653263,
    "body" : "@MikeM. After checking an implementation with layout(), the text now scrolls without being cut. I will stick with this, since it is really troublesome to implement the scroll with marquee. Thank you!",
    "score" : 1,
    "owner" : {
      "account_id" : 25536221,
      "reputation" : 13,
      "user_id" : 24045668,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/716b98636ab313d88599a26878f0dba8?s=256&d=identicon&r=PG",
      "display_name" : "Dor1ma",
      "link" : "https://stackoverflow.com/users/24045668/dor1ma"
    },
    "creation_date" : 1749152119,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140489035,
    "post_id" : 79653263,
    "body" : "Apparently reflection is still the only way to change the native marquee speed, so it&#39;s not really possible on recent Android versions. As for your <code>ObjectAnimator</code> approach, it looks like the issue is that you never call <code>layout()</code> after <code>measure()</code>, so the <code>TextView</code> never resizes itself for the longer text, which gets cut off at the <code>TextView</code>&#39;s edge. Try adding <code>textView.layout(0, 0, textView.getMeasuredWidth(), textView.getMeasuredHeight());</code> after the <code>measure()</code> call.",
    "score" : 0,
    "owner" : {
      "account_id" : 3397419,
      "reputation" : 39331,
      "user_id" : 2850651,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/ooWVw.jpg?s=256",
      "display_name" : "Mike M.",
      "link" : "https://stackoverflow.com/users/2850651/mike-m"
    },
    "creation_date" : 1749101542,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}