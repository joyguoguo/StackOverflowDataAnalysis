{
  "question" : {
    "question_id" : 79615860,
    "title" : "How can I generalize a unit conversion method for different Enums in Java?",
    "body" : "<p>I’m currently building a unit converter app in Java (as a beginner), and I want to avoid duplicating logic for each type of unit.</p>\n<p>Right now, I have different enums like Length, Weight, Time, etc., and each enum constant has a conversion factor to a base unit (e.g. meters, kilograms, etc.). These enums all implement a common Units interface:</p>\n<pre><code>public interface Units {}\n\npublic enum Length implements Units {\n    METRE(1.0), KILOMETRE(1000), CENTIMETRE(0.01), ...;\n\n    private final double toMetreFactor;\n\n    Length(double factor) {\n        this.toMetreFactor = factor;\n    }\n\n    public double getToMetreFactor() {\n        return toMetreFactor;\n    }\n}\n</code></pre>\n<p>In my ConverterModel class, I currently have methods like this:</p>\n<pre><code>public double convertLength(double value, Length input, Length output) {\n    double base = value * input.getToMetreFactor();\n    return base / output.getToMetreFactor();\n}\n</code></pre>\n<p>But this means I need to write similar methods for every category (convertWeight, convertTime, etc.).</p>\n<p>I’d like to generalize this logic so I can write one reusable method like:</p>\n<p><code>public double convert(double value, Units from, Units to);</code></p>\n<p>I already have my GUI set up with JComboBox, so I’m passing the selected units as Units. However, I can’t access the conversion factor unless I cast to the specific enum (e.g., Length), which feels clunky and not extensible.</p>\n<p>Is it possible to design the Units interface (or the enums) so that I can call something like from.getToBaseFactor() without casting? Or can I somehow make the convert(...) method universal?</p>\n",
    "tags" : [ "java", "oop", "design-patterns", "enums", "unit-conversion" ],
    "owner" : {
      "account_id" : 41279613,
      "reputation" : 137,
      "user_id" : 30213076,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/761725e3b95e908ff1b7383c96fedb5c?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "jamesdiaz",
      "link" : "https://stackoverflow.com/users/30213076/jamesdiaz"
    },
    "is_answered" : true,
    "view_count" : 155,
    "answer_count" : 2,
    "score" : 6,
    "last_activity_date" : 1748450483,
    "creation_date" : 1746906454,
    "link" : "https://stackoverflow.com/questions/79615860/how-can-i-generalize-a-unit-conversion-method-for-different-enums-in-java",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79615892,
    "question_id" : 79615860,
    "body" : "<p>Move the common method (<code>getToBaseFactor</code>) to the interface.</p>\n<pre><code>public interface Units {\n    double getToBaseFactor();\n}\n</code></pre>\n<p>and rename the getter in <code>Length</code> to <code>getToBaseFactor</code>:</p>\n<pre><code>public enum Length implements Units {\n    // ...\n\n    public double getToBaseFactor() {\n        return toMetreFactor;\n    }\n}\n</code></pre>\n<p>Then you can write a general <code>convert</code> method like this:</p>\n<pre><code>public double convert(double value, Units from, Units to) {\n    double base = value * from.getToBaseFactor();\n    return base / to.getToBaseFactor();\n}\n</code></pre>\n<p>Note that this design allows you to do nonsensical conversions, e.g. from meters to kilograms. You can prevent yourself from accidentally doing that by making <code>Units</code> generic.</p>\n<pre><code>public interface Units&lt;TSelf extends Units&lt;TSelf&gt;&gt; { ... }\npublic enum Length implements Units&lt;Length&gt; { ... }\n\npublic &lt;T extends Units&lt;T&gt;&gt; double convert(double value, T from, T to) { ... }\n</code></pre>\n",
    "score" : 9,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 6651855,
      "reputation" : 292025,
      "user_id" : 5133585,
      "user_type" : "registered",
      "accept_rate" : 96,
      "profile_image" : "https://i.sstatic.net/dfqcw.png?s=256",
      "display_name" : "Sweeper",
      "link" : "https://stackoverflow.com/users/5133585/sweeper"
    },
    "creation_date" : 1746908850,
    "last_activity_date" : 1748450464,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79616304,
    "question_id" : 79615860,
    "body" : "<p>A very minor change to <a href=\"https://stackoverflow.com/a/79615892/\">the answer by Sweeper</a> would put <code>convert</code> methods inside <code>Unit</code>:</p>\n<pre><code>public interface Units&lt;TSelf extends Units&lt;TSelf&gt;&gt; {\n    double getToBaseFactor();\n\n    default double convert(double value, TSelf to) {\n        double base = value * getToBaseFactor();\n        return base / to.getToBaseFactor();\n    }\n    static &lt;T extends Units&lt;T&gt;&gt; double convert(double value, T from, T to) {\n        return from.convert(value, to);\n    }\n}\n</code></pre>\n<p>Then you could override <code>convert</code> per enum if needed, and call in two ways:</p>\n<pre><code>System.out.println(Length.METRE.convert(2.0, Length.CENTIMETRE));\nSystem.out.println(Length.METRE.convert(1500.0, Length.KILOMETRE));\nSystem.out.println(Units.convert(1500.0, Length.METRE, Length.KILOMETRE));\n</code></pre>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 5998820,
      "reputation" : 16283,
      "user_id" : 4712734,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/f6e922a2cb7e2da59286f27b162aaca5?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "DuncG",
      "link" : "https://stackoverflow.com/users/4712734/duncg"
    },
    "creation_date" : 1746953221,
    "last_activity_date" : 1748450483,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140414281,
    "post_id" : 79615860,
    "body" : "As a rough guess just putting the unit into an enum and keeping the numbers separate is unfortunate for conversion. How about a class that encapsulates the number plus the unit and thus can be converted easily?",
    "score" : 0,
    "owner" : {
      "account_id" : 5289146,
      "reputation" : 9940,
      "user_id" : 4222206,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/416696430ab23f397a5dbeda73e72896?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "queeg",
      "link" : "https://stackoverflow.com/users/4222206/queeg"
    },
    "creation_date" : 1746909480,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79615892" : [ {
      "comment_id" : 140415000,
      "post_id" : 79615892,
      "body" : "@DuncG <code>unit1.convert(100, unit2)</code> doesn&#39;t feel as readable to me. If I were going for a more readable approach, I would write a <code>Measurement&lt;TUnit&gt;</code> that wraps a <code>double</code> and a <code>TUnit</code>, then put a <code>convertTo(TUnit)</code> method in <i>that</i>, returning a <code>Measurement&lt;TUnit&gt;</code> or mutating <code>this</code>.",
      "score" : 0,
      "owner" : {
        "account_id" : 6651855,
        "reputation" : 292025,
        "user_id" : 5133585,
        "user_type" : "registered",
        "accept_rate" : 96,
        "profile_image" : "https://i.sstatic.net/dfqcw.png?s=256",
        "display_name" : "Sweeper",
        "link" : "https://stackoverflow.com/users/5133585/sweeper"
      },
      "creation_date" : 1746952541,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140414984,
      "post_id" : 79615892,
      "body" : "I think your generic approach is nice, and could be built into Units as  <code>default double convert(double value, TSelf to)</code>",
      "score" : 0,
      "owner" : {
        "account_id" : 5998820,
        "reputation" : 16283,
        "user_id" : 4712734,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/f6e922a2cb7e2da59286f27b162aaca5?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "DuncG",
        "link" : "https://stackoverflow.com/users/4712734/duncg"
      },
      "creation_date" : 1746952166,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}