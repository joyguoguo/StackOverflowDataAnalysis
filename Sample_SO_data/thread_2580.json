{
  "question" : {
    "question_id" : 79610824,
    "title" : "The supplied phased action failed with an exception - Flutter Gradle Issue",
    "body" : "<p>I am having issues in my Flutter project, and any help would be appreciated.</p>\n<p>I have been building this app for some time, and during the ending stages, I am seeing this error in android/build.gradle.kts file:</p>\n<pre><code>The supplied phased action failed with an exception.\nCould not create task ':vibration:compileDebugJavaWithJavac'.\nFailed to calculate the value of task ':vibration:compileDebugJavaWithJavac' property 'javaCompiler'.\nToolchain installation '/usr/lib/jvm/java-21-openjdk-amd64' does not provide the required capabilities: [JAVA_COMPILER]\n</code></pre>\n<p>First of all, I don't know what this error means. I just know that Gradle needs <code>javaCompiler</code> from JDK 17, which is apparently not available in JDK 21.</p>\n<p>Now the main issue is that Gradle is not picking JDK 17, which I have installed on my system. Just to make sure, I have these outputs in the terminal to check the current JDK version:</p>\n<pre><code>$ echo $JAVA_HOME\n/usr/lib/jvm/java-17-openjdk-amd64\n</code></pre>\n<pre><code>$ java -version\nopenjdk version &quot;17.0.15&quot; 2025-04-15\nOpenJDK Runtime Environment (build 17.0.15+6-Ubuntu-0ubuntu124.04)\nOpenJDK 64-Bit Server VM (build 17.0.15+6-Ubuntu-0ubuntu124.04, mixed mode, sharing)\n</code></pre>\n<p>I previously had JDK 21 installed but shifted to JDK 17 without deleting JDK 21.</p>\n<p>The app builds perfectly fine, and runs smoothly. But according to ChatGPT, I have to resolve this issue before releasing to Google Play Store as it might cause build issue for future releases.</p>\n<p>This is my <code>android/build.gradle,kts</code> file:</p>\n<pre><code>buildscript {\n    repositories {\n        google()\n        mavenCentral()\n    }\n    dependencies {\n        classpath(&quot;com.google.gms:google-services:4.4.2&quot;) // or latest stable\n    }\n}\n\nallprojects {\n    repositories {\n        google()\n        mavenCentral()\n    }\n}\n\nval newBuildDir: Directory = rootProject.layout.buildDirectory.dir(&quot;../../build&quot;).get()\nrootProject.layout.buildDirectory.value(newBuildDir)\n\nsubprojects {\n    val newSubprojectBuildDir: Directory = newBuildDir.dir(project.name)\n    project.layout.buildDirectory.value(newSubprojectBuildDir)\n}\nsubprojects {\n    project.evaluationDependsOn(&quot;:app&quot;)\n}\n\ntasks.register&lt;Delete&gt;(&quot;clean&quot;) {\n    delete(rootProject.layout.buildDirectory)\n}\n</code></pre>\n<p>And my <code>android/app/build.gradle.kts</code> looks like this:</p>\n<pre><code>import java.util.Properties\n\nplugins {\n    id(&quot;com.android.application&quot;)\n    id(&quot;com.google.gms.google-services&quot;)\n    id(&quot;kotlin-android&quot;)\n    id(&quot;dev.flutter.flutter-gradle-plugin&quot;)\n}\n\nval keystoreProperties = Properties().apply {\n    val keystorePropertiesFile = rootProject.file(&quot;key.properties&quot;)\n    if (keystorePropertiesFile.exists()) {\n        keystorePropertiesFile.inputStream().use { load(it) }\n    } else {\n        throw GradleException(&quot;Missing key.properties file in android/ directory&quot;)\n    }\n}\n\nandroid {\n    namespace = &quot;com.example.progresspal&quot;\n    compileSdk = flutter.compileSdkVersion\n    ndkVersion = &quot;27.0.12077973&quot;\n\n    signingConfigs {\n        create(&quot;release&quot;) {\n            storeFile = file(keystoreProperties[&quot;storeFile&quot;] as String)\n            storePassword = keystoreProperties[&quot;storePassword&quot;] as String\n            keyAlias = keystoreProperties[&quot;keyAlias&quot;] as String\n            keyPassword = keystoreProperties[&quot;keyPassword&quot;] as String\n        }\n    }\n\n    defaultConfig {\n        applicationId = &quot;com.example.progresspal&quot;\n        minSdk = flutter.minSdkVersion\n        targetSdk = flutter.targetSdkVersion\n        versionCode = flutter.versionCode\n        versionName = flutter.versionName\n    }\n\n    buildTypes {\n        getByName(&quot;release&quot;) {\n            signingConfig = signingConfigs.getByName(&quot;release&quot;)\n            isMinifyEnabled = true\n            isShrinkResources = true\n            proguardFiles(\n                getDefaultProguardFile(&quot;proguard-android-optimize.txt&quot;),\n                &quot;proguard-rules.pro&quot;\n            )\n        }\n    }\n\n    compileOptions {\n        isCoreLibraryDesugaringEnabled = true\n        sourceCompatibility = JavaVersion.VERSION_11\n        targetCompatibility = JavaVersion.VERSION_11\n    }\n\n    kotlinOptions {\n        jvmTarget = JavaVersion.VERSION_11.toString()\n    }\n\n    java {\n        toolchain {\n            languageVersion.set(JavaLanguageVersion.of(17))\n        }\n    }\n\n}\n\nflutter {\n    source = &quot;../..&quot;\n}\n\ndependencies {\n    coreLibraryDesugaring(&quot;com.android.tools:desugar_jdk_libs:2.0.4&quot;)\n}import java.util.Properties\n\nplugins {\n    id(&quot;com.android.application&quot;)\n    id(&quot;com.google.gms.google-services&quot;)\n    id(&quot;kotlin-android&quot;)\n    id(&quot;dev.flutter.flutter-gradle-plugin&quot;)\n}\n\nval keystoreProperties = Properties().apply {\n    val keystorePropertiesFile = rootProject.file(&quot;key.properties&quot;)\n    if (keystorePropertiesFile.exists()) {\n        keystorePropertiesFile.inputStream().use { load(it) }\n    } else {\n        throw GradleException(&quot;Missing key.properties file in android/ directory&quot;)\n    }\n}\n\nandroid {\n    namespace = &quot;com.example.progresspal&quot;\n    compileSdk = flutter.compileSdkVersion\n    ndkVersion = &quot;27.0.12077973&quot;\n\n    signingConfigs {\n        create(&quot;release&quot;) {\n            storeFile = file(keystoreProperties[&quot;storeFile&quot;] as String)\n            storePassword = keystoreProperties[&quot;storePassword&quot;] as String\n            keyAlias = keystoreProperties[&quot;keyAlias&quot;] as String\n            keyPassword = keystoreProperties[&quot;keyPassword&quot;] as String\n        }\n    }\n\n    defaultConfig {\n        applicationId = &quot;com.example.progresspal&quot;\n        minSdk = flutter.minSdkVersion\n        targetSdk = flutter.targetSdkVersion\n        versionCode = flutter.versionCode\n        versionName = flutter.versionName\n    }\n\n    buildTypes {\n        getByName(&quot;release&quot;) {\n            signingConfig = signingConfigs.getByName(&quot;release&quot;)\n            isMinifyEnabled = true\n            isShrinkResources = true\n            proguardFiles(\n                getDefaultProguardFile(&quot;proguard-android-optimize.txt&quot;),\n                &quot;proguard-rules.pro&quot;\n            )\n        }\n    }\n\n    compileOptions {\n        isCoreLibraryDesugaringEnabled = true\n        sourceCompatibility = JavaVersion.VERSION_11\n        targetCompatibility = JavaVersion.VERSION_11\n    }\n\n    kotlinOptions {\n        jvmTarget = JavaVersion.VERSION_11.toString()\n    }\n\n    java {\n        toolchain {\n            languageVersion.set(JavaLanguageVersion.of(17))\n        }\n    }\n\n}\n\nflutter {\n    source = &quot;../..&quot;\n}\n\ndependencies {\n    coreLibraryDesugaring(&quot;com.android.tools:desugar_jdk_libs:2.0.4&quot;)\n}\n</code></pre>\n<p>I tried asking ChatGPT for a solution, changed a bunch of stuff, installed JDK 17 and set it as default. But Gradle is not picking up JDK 17 due to some reason.</p>\n",
    "tags" : [ "java", "android", "flutter", "kotlin", "gradle" ],
    "owner" : {
      "account_id" : 28652758,
      "reputation" : 23,
      "user_id" : 21939421,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a/AGNmyxblAKQJUhuBhRwFGuvxTo8w5MsZkeB8HQH1R2ES=k-s256",
      "display_name" : "Ali Ahmed",
      "link" : "https://stackoverflow.com/users/21939421/ali-ahmed"
    },
    "is_answered" : true,
    "view_count" : 205,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1746793265,
    "creation_date" : 1746629198,
    "link" : "https://stackoverflow.com/questions/79610824/the-supplied-phased-action-failed-with-an-exception-flutter-gradle-issue",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79614102,
    "question_id" : 79610824,
    "body" : "<p>Please verify your Flutter configuration by running <code>flutter config --list</code> in the terminal. This will display the current settings and SDK configuration.</p>\n<p>Additionally, run <code>flutter doctor -v</code> to check which SDK is currently being used. I encountered the same issue, and this step helped me identify the problem.</p>\n",
    "score" : 0,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 26698759,
      "reputation" : 26,
      "user_id" : 20306164,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a/ALm5wu1ndM9HYOarnD3JaM4MrOYy152QXB3trhW2FcBd=k-s256",
      "display_name" : "Kapil Sharma",
      "link" : "https://stackoverflow.com/users/20306164/kapil-sharma"
    },
    "creation_date" : 1746793265,
    "last_activity_date" : 1746793265,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140405939,
    "post_id" : 79610824,
    "body" : "try <code>flutter doctor -v</code> you will find out the flutter jdk version, if you find wrong one, you can update the path  <code>flutter config --jdk-dir yourJDKPath</code>(you can checkout if cmd has typo)",
    "score" : 0,
    "owner" : {
      "account_id" : 14061061,
      "reputation" : 64855,
      "user_id" : 10157127,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/A2S0aL18.jpg?s=256",
      "display_name" : "Md. Yeasin Sheikh",
      "link" : "https://stackoverflow.com/users/10157127/md-yeasin-sheikh"
    },
    "creation_date" : 1746660440,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79614102" : [ {
      "comment_id" : 140415066,
      "post_id" : 79614102,
      "body" : "For me, the issue was that I had JDK 21 downloaded, and something in Flutter wanted JDK 17. I installed it while keeping 21 which didn&#39;t work. Finally, I removed JDK 21 completely which resolve the issue.",
      "score" : 0,
      "owner" : {
        "account_id" : 28652758,
        "reputation" : 23,
        "user_id" : 21939421,
        "user_type" : "registered",
        "profile_image" : "https://lh3.googleusercontent.com/a/AGNmyxblAKQJUhuBhRwFGuvxTo8w5MsZkeB8HQH1R2ES=k-s256",
        "display_name" : "Ali Ahmed",
        "link" : "https://stackoverflow.com/users/21939421/ali-ahmed"
      },
      "creation_date" : 1746955661,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}