{
  "question" : {
    "question_id" : 79619766,
    "title" : "Maven Yguard obfuscation configuration results in &#39;could not be mapped !&#39; for some classes",
    "body" : "<p>Maven Yguard obfuscation configuration results in 'could not be mapped !' for some classes.\nThe xml pom configuration is as follows :</p>\n<pre><code>&lt;plugin&gt;\n    &lt;artifactId&gt;maven-antrun-plugin&lt;/artifactId&gt;\n    &lt;version&gt;1.8&lt;/version&gt;\n    &lt;executions&gt;\n        &lt;execution&gt;\n            &lt;phase&gt;package&lt;/phase&gt;\n            &lt;goals&gt;\n                &lt;goal&gt;run&lt;/goal&gt;\n            &lt;/goals&gt;\n            &lt;id&gt;obfuscate&lt;/id&gt;\n            &lt;configuration&gt;\n                &lt;tasks&gt;\n                    &lt;property name=&quot;runtime_classpath&quot; refid=&quot;maven.runtime.classpath&quot;/&gt;\n                    &lt;taskdef name=&quot;yguard&quot; classname=&quot;com.yworks.yguard.YGuardTask&quot; classpath=&quot;${runtime_classpath}&quot;/&gt;\n                    &lt;yguard&gt;\n                        &lt;rename mainclass=&quot;my.classpath&quot; logfile=&quot;${project.build.directory}/yguard.log.xml&quot;&gt;\n                            &lt;keep&gt;\n                                &lt;class&gt;\n                                    &lt;patternset&gt;\n                                        &lt;include name=&quot;javax.**&quot;/&gt;\n                                        &lt;include name=&quot;de.erichseifert.vectorgraphics2d.**&quot;/&gt;                                                    \n                                        &lt;include name=&quot;com.google.gson.**&quot;/&gt;                                                    \n                                        &lt;include name=&quot;com.yworks.**&quot;/&gt;\n                                        &lt;include name=&quot;com.fasterxml.**&quot;/&gt;                                                    \n                                        &lt;include name=&quot;com.ximpleware.**&quot;/&gt;                                                    \n                                        &lt;include name=&quot;org.apache.**&quot;/&gt;\n                                        &lt;include name=&quot;org.w3c.**&quot;/&gt;\n                                        &lt;include name=&quot;org.slf4j.**&quot;/&gt;\n                                        &lt;include name=&quot;org.jfree.**&quot;/&gt;                                                    \n                                        &lt;include name=&quot;org.cef.**&quot;/&gt;                                                    \n                                        &lt;include name=&quot;org.mozilla.**&quot;/&gt;\n                                        \n                                        &lt;include name=&quot;mozilla.**&quot;/&gt;\n                                        &lt;include name=&quot;me.friwi.**&quot;/&gt;\n\n                                        &lt;include name=&quot;io.jsonwebtoken.**&quot;/&gt;\n                                        &lt;include name=&quot;oshi.**&quot;/&gt;\n\n                                        &lt;include name=&quot;java_cup.**&quot;/&gt;\n                                        &lt;include name=&quot;java_cup.runtime.**&quot;/&gt;\n                                        &lt;include name=&quot;com.jogamp.**&quot;/&gt;\n                                        &lt;include name=&quot;jogamp.**&quot;/&gt;\n                                        &lt;include name=&quot;natives.**&quot;/&gt;\n\n                                        &lt;include name=&quot;com.keypoint.**&quot;/&gt;\n                                        &lt;include name=&quot;com.sun.**&quot;/&gt;\n                                        &lt;include name=&quot;sun.**&quot;/&gt;\n                                        &lt;include name=&quot;jogl.**&quot;/&gt;\n                                        &lt;include name=&quot;newt.**&quot;/&gt;\n\n                                        &lt;include name=&quot;javax.xml.parsers.DocumentBuilderFactory&quot;/&gt;\n                                        &lt;include name=&quot;javax.xml.transform.TransformerFactory&quot;/&gt;\n                                    &lt;/patternset&gt;                                                \n                                &lt;/class&gt;\n                            &lt;/keep&gt;\n                        &lt;/rename&gt;\n                        &lt;inoutpair in=&quot;myin.jar&quot; out=&quot;myout.jar&quot; /&gt;\n                    &lt;/yguard&gt;\n                &lt;/tasks&gt;\n            &lt;/configuration&gt;\n        &lt;/execution&gt;\n    &lt;/executions&gt;\n&lt;/plugin&gt;\n</code></pre>\n<p>The build message returns these dependency resolution failures I summarized :</p>\n<pre><code>[rename] ERROR: Method javax.xml.parsers.DocumentBuilderFactory.setFeature could not be mapped !\n[rename] ERROR: Method javax.xml.transform.TransformerFactory.setFeature could not be mapped !\n[rename] ERROR: Method org.w3c.dom.Document.setXmlStandalone could not be mapped !\n[rename] ERROR: Method org.w3c.dom.ls.DOMImplementationLS.createLSSerializer could not be mapped !\n[rename] ERROR: Method org.apache.batik.bridge.UnitProcessor.createContext could not be mapped !\n[rename] ERROR: Method org.apache.batik.bridge.UnitProcessor.svgHorizontalLengthToUserSpace could not be mapped !\n[rename] ERROR: Method org.apache.batik.bridge.UnitProcessor.svgVerticalLengthToUserSpace could not be mapped !\n[rename] ERROR: Method org.apache.batik.bridge.UnitProcessor.createContext could not be mapped !\n[rename] ERROR: Method org.apache.batik.bridge.UnitProcessor.svgHorizontalLengthToUserSpace could not be mapped !\n[rename] ERROR: Method org.apache.batik.bridge.UnitProcessor.svgVerticalLengthToUserSpace could not be mapped !\n[rename] ERROR: Method org.apache.batik.util.SoftReferenceCache.access$000 could not be mapped !\n[rename] ERROR: Method org.apache.batik.util.SoftReferenceCache.access$100 could not be mapped !\n[rename] ERROR: Method org.apache.batik.ext.awt.image.rendered.TileMap.access$100 could not be mapped !\n[rename] ERROR: Method org.apache.batik.ext.awt.image.rendered.TileMap.access$000 could not be mapped !\n[rename] ERROR: Method org.apache.batik.ext.awt.image.rendered.TileMap.access$200 could not be mapped !\n[rename] ERROR: Method org.apache.batik.dom.svg.AbstractSVGAnimatedLength$BaseSVGLength.access$000 could not be mapped !\n[rename] ERROR: Method org.apache.batik.dom.svg.SVGDOMImplementation.createCSSEngine could not be mapped !\n[rename] ERROR: Method org.apache.batik.script.rhino.EventTargetWrapper.access$100 could not be mapped !\n[rename] ERROR: Method org.apache.batik.script.rhino.EventTargetWrapper.access$102 could not be mapped !\n[rename] ERROR: Field org/apache/batik/gvt/text/GVTAttributedCharacterIterator$TextAttribute.STROKE could not be mapped !\n[rename] ERROR: Field org/apache/batik/script/rhino/EventTargetWrapper.class$org$mozilla$javascript$Function could not be mapped !\n[rename] ERROR: Field org/apache/batik/script/rhino/EventTargetWrapper.class$org$mozilla$javascript$Scriptable could not be mapped !\n[rename] WARNING: Not all dependencies could be resolved. Please see the logfile for details.\n</code></pre>\n<p>I do not know how to resolve these obfuscation failures.\nWhat I however have seen is a possible alternative that does not obfuscate external classes in jars, or am I misunderstanding it namely :</p>\n<pre><code>&lt;plugin&gt;\n    &lt;artifactId&gt;maven-antrun-plugin&lt;/artifactId&gt;\n    &lt;version&gt;1.8&lt;/version&gt;\n    &lt;executions&gt;\n        &lt;execution&gt;\n            &lt;phase&gt;package&lt;/phase&gt;\n            &lt;goals&gt;\n                &lt;goal&gt;run&lt;/goal&gt;\n            &lt;/goals&gt;\n            &lt;id&gt;obfuscate&lt;/id&gt;\n            &lt;configuration&gt;\n                &lt;tasks&gt;\n            &lt;plugin&gt;\n    &lt;artifactId&gt;maven-antrun-plugin&lt;/artifactId&gt;\n    &lt;version&gt;1.8&lt;/version&gt;\n    &lt;executions&gt;\n        &lt;execution&gt;\n            &lt;phase&gt;package&lt;/phase&gt;\n            &lt;goals&gt;\n                &lt;goal&gt;run&lt;/goal&gt;\n            &lt;/goals&gt;\n            &lt;id&gt;obfuscate&lt;/id&gt;\n            &lt;configuration&gt;\n                &lt;tasks&gt;\n                    &lt;property name=&quot;runtime_classpath&quot; refid=&quot;maven.runtime.classpath&quot;/&gt;\n                    &lt;taskdef name=&quot;yguard&quot; classname=&quot;com.yworks.yguard.YGuardTask&quot; classpath=&quot;${runtime_classpath}&quot;/&gt;\n                    &lt;yguard&gt;\n                        &lt;externalclasses&gt;\n                            &lt;pathelement location=&quot;${maven.dependency.com.google.code.gson.gson.jar.path}&quot;/&gt;\n                        &lt;/externalclasses&gt;                  \n                        &lt;rename mainclass=&quot;my.classpath&quot; logfile=&quot;${project.build.directory}/yguard.log.xml&quot;&gt;\n                            &lt;keep&gt;\n                                &lt;class&gt;\n                                    &lt;patternset&gt;\n                                    &lt;/patternset&gt;                                                \n                                &lt;/class&gt;\n                            &lt;/keep&gt;\n                        &lt;/rename&gt;\n                        &lt;inoutpair in=&quot;myin.jar&quot; out=&quot;myout.jar&quot; /&gt;\n                    &lt;/yguard&gt;\n                &lt;/tasks&gt;\n            &lt;/configuration&gt;\n        &lt;/execution&gt;\n    &lt;/executions&gt;\n&lt;/plugin&gt;\n</code></pre>\n<p>If I'm understanding this correctly how do a specify the &quot;externalclasses pathelement location&quot;\nfor the jars indicated in netbeans dependencies list namely :</p>\n<pre><code>VectorGraphics2D-0.13.jar \nannotation-3.0.0.jar \nbatik-swing-1.6-1.jar \nbatik-transcoder-1.6-1.jar \ncommons-lang3-3.12.0.jar \ngson-2.10.1.jar \nhttpclient-4.5.14.jar \njackson-core-2.9.7.jar \njackson-databind-2.9.8.jar \njcefmaven-110.0.25.jar \njfreechart-1.0.13.jar \njjwt-api-0.10.5.jar \njjwt-impl-0.10.5.jar \njjwt-jackson-0.10.5.jar \noshi-core-3.4.0.jar \nvtd-xml-2.11.jar \nyguard-4.1.1.jar \navalon-framework-4.0.jar \nbatik-1.5-fop-0.20-5.jar \nbatik-awt-util-1.6-1.jar \nbatik-bridge-1.6-1.jar \nbatik-css-1.6-1.jar \nbatik-dom-1.6-1.jar \nbatik-ext-1.6-1.jar \nbatik-gui-util-1.6-1.jar \nbatik-gvt-1.6-1.jar \nbatik-parser-1.6-1.jar \nbatik-script-1.6-1.jar \nbatik-svg-dom-1.6-1.jar \nbatik-util-1.6-1.jar \nbatik-xml-1.6-1.jar \ncommons-codec-1.11.jar \ncommons-compress-1.21.jar \ncommons-logging-1.2.jar \nfop-0.20.5.jar \ngluegen-rt-v2.4.0-rc-20210111.jar \nhttpcore-4.4.16.jar \njackson-annotations-2.9.0.jar \njcef-api-jcef-87476e9+cef-110.0.25+g75b1c96+chromium-110.0.5481.78.jar \njcommon-1.0.16.jar \njna-4.2.2.jar \njna-platform-4.2.2.jar \njogl-all-v2.4.0-rc-20210111.jar \njs-1.5R4.1.jar \nslf4j-api-1.7.22.jar \ntools.jar \nxalan-2.4.1.jar \nxercesImpl-2.2.1.jar \nxml-apis-1.0.b2.jar \nxmlParserAPIs-2.0.2.jar\n</code></pre>\n<p>I would greatly appreciate help with this as I have looked up in the documentation and forums but cannot get anything that works.</p>\n",
    "tags" : [ "java", "maven", "yguard" ],
    "owner" : {
      "account_id" : 32006332,
      "reputation" : 11,
      "user_id" : 29514573,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/993398429646767b4d87d685f08da442?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "temujin",
      "link" : "https://stackoverflow.com/users/29514573/temujin"
    },
    "is_answered" : true,
    "view_count" : 90,
    "answer_count" : 1,
    "score" : 1,
    "last_activity_date" : 1747748585,
    "creation_date" : 1747143258,
    "link" : "https://stackoverflow.com/questions/79619766/maven-yguard-obfuscation-configuration-results-in-could-not-be-mapped-for-so",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79630571,
    "question_id" : 79619766,
    "body" : "<p>Try the following configuration:</p>\n<pre><code>&lt;yguard&gt;\n  &lt;externalclasses&gt;\n    &lt;path refid=&quot;maven.compile.classpath&quot;/&gt;\n  &lt;/externalclasses&gt;\n  &lt;inoutpair\n   in=&quot;${project.build.directory}/${project.build.finalName}.jar&quot;\n   out=&quot;${project.build.directory}/${project.build.finalName}_obfuscated.jar&quot;/&gt;\n\n  &lt;rename\n   mainclass=&quot;${artifact.main.class}&quot;\n   logfile=&quot;${project.build.directory}/${project.build.finalName}_obfuscation_log.xml&quot;/&gt;\n&lt;/yguard&gt;\n</code></pre>\n<p>This will completely obfuscate all classes in your application except for the class name of the main class and the <code>main</code> method name in said main class. Moreover, referencing Maven's compile classpath in yGuard's <code>externalclasses</code> element ensures that your application's dependencies can be resolved during obfuscation (preventing all those error messages in the obfuscation log).</p>\n<p>There is one probably minor downside, though: Maven's compile classpath includes <code>project.build.outputDirectory</code> - i.e. the directory that contains the compiled classes of your application. Usually, this is not a problem, because yGuard works on the jar specified in its <code>inoutpair</code> element on not on the files in the output directory. However, if it does create problems, a simple solution would be renaming the directory right before obfuscation (and if necessary restoring the directory name after obfuscation).</p>\n<p>The above configuration requires one addition property declaration in your <code>pom.xml</code> for your application's main class:</p>\n<pre><code>&lt;properties&gt;\n  ...\n  &lt;artifact.main.class&gt;com.company.app.MainClassName&lt;/artifact.main.class&gt;\n&lt;/properties&gt;\n</code></pre>\n",
    "score" : 1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 13203350,
      "reputation" : 916,
      "user_id" : 9535950,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/sc4Pk.png?s=256",
      "display_name" : "Thomas Behr",
      "link" : "https://stackoverflow.com/users/9535950/thomas-behr"
    },
    "creation_date" : 1747748585,
    "last_activity_date" : 1747748585,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : {
    "79630571" : [ {
      "comment_id" : 140446752,
      "post_id" : 79630571,
      "body" : "@temujin Can you provide an actual example? Otherwise it is really difficult to provide specific advice - especially regarding those &quot;other errors&quot;.",
      "score" : 0,
      "owner" : {
        "account_id" : 13203350,
        "reputation" : 916,
        "user_id" : 9535950,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/sc4Pk.png?s=256",
        "display_name" : "Thomas Behr",
        "link" : "https://stackoverflow.com/users/9535950/thomas-behr"
      },
      "creation_date" : 1747846958,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140444816,
      "post_id" : 79630571,
      "body" : "I now get many other errors to. Its a pity it did not work. But thanks for the suggestion.",
      "score" : 0,
      "owner" : {
        "account_id" : 32006332,
        "reputation" : 11,
        "user_id" : 29514573,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/993398429646767b4d87d685f08da442?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "temujin",
        "link" : "https://stackoverflow.com/users/29514573/temujin"
      },
      "creation_date" : 1747813815,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140442929,
      "post_id" : 79630571,
      "body" : "So happy someone responded, THNKS. As i am using gson in my project connecting to a json rest service I also need to make that my domain (value objects) package containing the domain classes are not obfuscate else the json decoding wont work. Do you have any suggestions regarding this. I&#39;m going to apply what you said right now. MANY THANKS.",
      "score" : 0,
      "owner" : {
        "account_id" : 32006332,
        "reputation" : 11,
        "user_id" : 29514573,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/993398429646767b4d87d685f08da442?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "temujin",
        "link" : "https://stackoverflow.com/users/29514573/temujin"
      },
      "creation_date" : 1747750974,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}