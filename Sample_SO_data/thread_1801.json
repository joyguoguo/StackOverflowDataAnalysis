{
  "question" : {
    "question_id" : 79673257,
    "title" : "Apache HttpComponents 5: POST multipal forms data defined by FormBodyPart with HttpAsyncClient",
    "body" : "<p>I'm looking for a solution for sending multiple forms data defined by FormBodyPart. Since  httpclient5 require SimpleHttpRequest when asynchronously sending requests, but with AsyncEntityProducer I cannot find any way to set my FormBodyPart. Cannot find a producer with correct apis to set those forms.</p>\n<pre><code>public static void main(String[] args) throws Exception {\n    FormBodyPart textPart = FormBodyPartBuilder.create(&quot;metadata&quot;)\n            .setBody(new StringBody(\n                &quot;{\\&quot;author\\&quot;:\\&quot;John Doe\\&quot;}&quot;, \n                ContentType.APPLICATION_JSON\n            ))\n            .build();\n\n    FormBodyPart filePart = FormBodyPartBuilder.create(&quot;document&quot;)\n            .setBody(new FileBody(\n                new File(&quot;report.pdf&quot;), \n                ContentType.APPLICATION_PDF,\n                &quot;Q3_Report.pdf&quot;))\n            .addField(&quot;X-File-Description&quot;, &quot;Quarterly Report&quot;)\n            .build();\n\n    HttpEntity multipartEntity = MultipartEntityBuilder.create()\n            .setBoundary(&quot;----MyBoundary123&quot;)\n            .addPart(textPart)\n            .addPart(filePart)\n            .build();\n\n    AsyncEntityProducer entityProducer = //no API to load FormBodyPart\n\n    SimpleResponseConsumer responseConsumer = new SimpleResponseConsumer();\n\n    try (CloseableHttpAsyncClient client = HttpAsyncClients.custom()\n            .setIOReactorConfig(IOReactorConfig.custom()\n                .setSoTimeout(Timeout.ofSeconds(30))\n            .build()) {\n        \n        client.start();\n        \n        Future&lt;SimpleHttpResponse&gt; future = client.execute(\n            entityProducer,\n            responseConsumer,\n            new FutureCallback&lt;SimpleHttpResponse&gt;() {\n                @Override\n                public void completed(SimpleHttpResponse response) {\n                    System.out.println(&quot;code: &quot; + response.getCode());\n                    System.out.println(&quot;response: &quot; + response.getBodyText());\n                }\n\n                @Override\n                public void failed(Exception ex) {\n                    System.err.println(&quot;failed: &quot; + ex.getMessage());\n                }\n\n                @Override\n                public void cancelled() {\n                    System.out.println(&quot;cancel&quot;);\n                }\n            }\n        );\n\n        future.get();\n    }\n}\n</code></pre>\n",
    "tags" : [ "java", "apache-httpclient-5.x", "apache-httpasyncclient" ],
    "owner" : {
      "account_id" : 31448290,
      "reputation" : 1,
      "user_id" : 24270827,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/359b32bf7b59d3c3547cd55ab111de0f?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "阿尔法francis",
      "link" : "https://stackoverflow.com/users/24270827/%e9%98%bf%e5%b0%94%e6%b3%95francis"
    },
    "is_answered" : false,
    "view_count" : 39,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1750416771,
    "creation_date" : 1750416598,
    "link" : "https://stackoverflow.com/questions/79673257/apache-httpcomponents-5-post-multipal-forms-data-defined-by-formbodypart-with-h",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ ],
  "answer_comments" : { }
}