{
  "question" : {
    "question_id" : 79701425,
    "title" : "How to include the SPI &quot;uses&quot; and/or &quot;provides&quot; section for a module with Javadoc?",
    "body" : "<p>If you look at a module's documentation from the standard library, such as <a href=\"https://docs.oracle.com/en/java/javase/24/docs/api/java.base/module-summary.html\" rel=\"nofollow noreferrer\"><code>java.base</code></a>, you'll see it has <a href=\"https://docs.oracle.com/en/java/javase/24/docs/api/java.base/module-summary.html#services-summary\" rel=\"nofollow noreferrer\">a section</a> that lists which services it uses and which services it provides.</p>\n<p><a href=\"https://i.sstatic.net/IYbrkCaW.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/IYbrkCaWm.jpg\" alt=\"Screenshot of services section for java.base module.\" /></a></p>\n<p>Based on the Standard Doclet's documentation, the <a href=\"https://docs.oracle.com/en/java/javase/24/docs/specs/javadoc/doc-comment-spec.html#uses\" rel=\"nofollow noreferrer\"><code>@uses</code></a> and <a href=\"https://docs.oracle.com/en/java/javase/24/docs/specs/javadoc/doc-comment-spec.html#provides\" rel=\"nofollow noreferrer\"><code>@provides</code></a> tags are how to generate the &quot;services&quot; section.</p>\n<blockquote>\n<h3>provides</h3>\n<ul>\n<li><code>@provides service-type description</code></li>\n</ul>\n<p>This tag may only appear in the documentation comment for a module declaration, and serves to document an implementation of a service provided by the module. The description may be used to specify how to obtain an instance of this service provider, and any important characteristics of the provider.</p>\n<p>Introduced in JDK 9.</p>\n<p><em>[...]</em></p>\n<h3>uses</h3>\n<ul>\n<li><code>@uses service-type description</code></li>\n</ul>\n<p>This tag may only appear in the documentation comment for a module declaration, and serves to document that a service may be used by the module. The description may be used to specify the characteristics of the service that may be required, and what the module will do if no provider for the service is available.</p>\n<p>Introduced in JDK 9.</p>\n</blockquote>\n<p>And you can see these tags in, for example, the <a href=\"https://github.com/openjdk/jdk/blob/f36147b3263662229e9a0ec712b9748711d2d85d/src/java.base/share/classes/module-info.java#L44\" rel=\"nofollow noreferrer\">source code</a> of the <code>java.base</code> module. Note that it does not seem necessary for the provider implementation to be in an exported package.</p>\n<p>However, when I try to do the same the &quot;services&quot; section is not generated. If I pass <code>--show-module-contents all</code> then the &quot;services&quot; section appears, but too much information is now leaked in the documentation. For instance, now the implementation class is exposed even though the class's package is not exported. The module summaries for the standard library don't do this.</p>\n<p>What am I doing wrong? Which option do I need to pass to get this to work? Or is this a bug?</p>\n<hr />\n<h1>Reproducible Example</h1>\n<p>This example provides a dummy implementation of <code>System.LoggerFinder</code>. I chose that SPI because it's small and simple. But I've tried other SPIs with the same results, including:</p>\n<ul>\n<li><p><code>java.nio.file.spi.FileSystemProvider</code></p>\n</li>\n<li><p><code>java.util.spi.ToolProvider</code></p>\n</li>\n<li><p><code>javax.annotation.processing.Processor</code> (from the <code>java.compiler</code> module)</p>\n</li>\n</ul>\n<h2>System Info</h2>\n<ul>\n<li><p>Java 24.0.1 (Temurin-24.0.1+9)</p>\n</li>\n<li><p>Windows 10/11</p>\n</li>\n</ul>\n<h2>Project Structure</h2>\n<pre class=\"lang-none prettyprint-override\"><code>&lt;project-directory&gt;\n│   javac-args.txt\n│   javadoc-args.txt\n│\n└───src\n    │   module-info.java\n    │\n    └───com\n        └───example\n                DummyLoggerFinder.java\n</code></pre>\n<h2>Source Code</h2>\n<p><strong>module-info.java</strong></p>\n<pre class=\"lang-java prettyprint-override\"><code>/**\n * Demo module for documentation.\n * \n * @provides java.lang.System.LoggerFinder\n */\nmodule demo {\n\n  provides java.lang.System.LoggerFinder with\n      com.example.DummyLoggerFinder;\n}\n</code></pre>\n<p><strong>DummyLoggerFinder.java</strong></p>\n<pre class=\"lang-java prettyprint-override\"><code>package com.example;\n\n/**\n * Simple SPI implementation.\n */\npublic class DummyLoggerFinder extends System.LoggerFinder {\n\n  @Override\n  public System.Logger getLogger(String name, Module module) {\n    throw new UnsupportedOperationException(&quot;implementation not needed for demo&quot;);\n  }\n}\n</code></pre>\n<h2>Argument Files</h2>\n<p><strong>javac-args.txt</strong></p>\n<pre class=\"lang-none prettyprint-override\"><code>--module-source-path demo=src\n--module demo\n-Xlint:all\n-Xdoclint:all\n-d out/modules\n</code></pre>\n<p><strong>javadoc-args.txt</strong></p>\n<pre class=\"lang-none prettyprint-override\"><code>--module-source-path demo=src\n--module demo\n-Xdoclint:all\n-d out/docs\n</code></pre>\n<h2>Build Steps</h2>\n<ol>\n<li><p>Compile the module (just to make sure it's valid code).</p>\n<pre class=\"lang-none prettyprint-override\"><code>java @javac-args.txt\n</code></pre>\n</li>\n<li><p>Generate Javadoc.</p>\n<pre class=\"lang-none prettyprint-override\"><code>javadoc @javadoc-args.txt\n</code></pre>\n</li>\n</ol>\n<h2>Output</h2>\n<p>No output from <code>javac</code>.</p>\n<p>I see the following output from <code>javadoc</code>:</p>\n<pre class=\"lang-none prettyprint-override\"><code>Constructing Javadoc information...\nCreating destination directory: &quot;out/docs\\&quot;\nBuilding index for all the packages and classes...\nStandard Doclet version 24.0.1+9\nBuilding tree for all the packages and classes...\nGenerating out\\docs\\demo\\module-summary.html...\nGenerating out\\docs\\overview-tree.html...\nGenerating out\\docs\\allclasses-index.html...\nBuilding index for all classes...\nGenerating out\\docs\\index-all.html...\nGenerating out\\docs\\search.html...\nGenerating out\\docs\\index.html...\nGenerating out\\docs\\help-doc.html...\n</code></pre>\n<p>And if I open <code>out/docs/index.html</code> in a browser, I do not see any &quot;services&quot; section in the module summary.</p>\n<p><a href=\"https://i.sstatic.net/rUMOyR8k.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/rUMOyR8km.jpg\" alt=\"Screenshot of module summary documentation.\" /></a></p>\n<hr />\n<h1>More Information</h1>\n<p>Looking into it more, the problem seems to only occur if the service type is not contained in one of the modules being documented. In other words, if the service type's module is not included in the <code>--module</code> argument then that service type will not be included in the &quot;Uses&quot; or &quot;Provides&quot; sections (and if that leads to no services being included in the docs, then the &quot;Services&quot; section will not be generated at all).</p>\n<p>Is this intended behavior?</p>\n",
    "tags" : [ "java", "javadoc", "java-module" ],
    "owner" : {
      "account_id" : 8532578,
      "reputation" : 49884,
      "user_id" : 6395627,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/af0f9bfe593f36642a032cd7ea611e7d?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Slaw",
      "link" : "https://stackoverflow.com/users/6395627/slaw"
    },
    "is_answered" : true,
    "view_count" : 99,
    "answer_count" : 1,
    "score" : 3,
    "last_activity_date" : 1752666138,
    "creation_date" : 1752536087,
    "link" : "https://stackoverflow.com/questions/79701425/how-to-include-the-spi-uses-and-or-provides-section-for-a-module-with-javado",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79703350,
    "question_id" : 79701425,
    "body" : "<p>The problem only occurs if the service type being used or provided is not in one of the modules currently being documented by the Javadoc tool. This means any service type from an external library, including the standard library, won't be documented in the &quot;Services&quot; section.</p>\n<p>I submitted a bug report and it was accepted: <a href=\"https://bugs.openjdk.org/browse/JDK-8362273\" rel=\"nofollow noreferrer\">https://bugs.openjdk.org/browse/JDK-8362273</a>. According to the report, it affects Java 11 to 25.</p>\n",
    "score" : 1,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 8532578,
      "reputation" : 49884,
      "user_id" : 6395627,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/af0f9bfe593f36642a032cd7ea611e7d?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Slaw",
      "link" : "https://stackoverflow.com/users/6395627/slaw"
    },
    "creation_date" : 1752666138,
    "last_activity_date" : 1752666138,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : {
    "79703350" : [ {
      "comment_id" : 140822913,
      "post_id" : 79703350,
      "body" : "(Bug was closed as &quot;not an issue&quot;. I disagree with their reasoning and will try to follow up.)",
      "score" : 0,
      "owner" : {
        "account_id" : 8532578,
        "reputation" : 49884,
        "user_id" : 6395627,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/af0f9bfe593f36642a032cd7ea611e7d?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "Slaw",
        "link" : "https://stackoverflow.com/users/6395627/slaw"
      },
      "creation_date" : 1761662865,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}