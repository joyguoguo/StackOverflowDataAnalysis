{
  "question" : {
    "question_id" : 79623840,
    "title" : "AWSInspector client - how to search for vulnerabilities in specific images and tags?",
    "body" : "<p>I have a list of images in my ECR repo, and each has a specific tag. For example,\n<code>images/hello-world-api:1.0.0,images/other-app:2.0.1</code>, etc. What I'm trying to do is search in AWS Inspector for the vulnerabilities for these specific images and tags, and preferably do it in batch, i.e. instead of a separate call for each image, do it all in one call. Here's what my code looks like:</p>\n<pre><code>String[] images = imageNames.split(&quot;,&quot;);\nfor (String img : images) {\n    stringFilters.add(StringFilter.builder()\n            .comparison(StringComparison.EQUALS)\n            .value(img)\n            .build());\n}\n\nfor (String tag : imageTags.values()) {\n    if (!tag.trim().isBlank()) {\n        stringFilters.add(StringFilter.builder()\n                .comparison(StringComparison.EQUALS)\n                .value(tag)\n                .build());\n    }\n}\n\nList&lt;List&lt;StringFilter&gt;&gt; chunks = Lists.partition(stringFilters, 10);\n\nfor (List&lt;StringFilter&gt; nextBatch : chunks) {\n    boolean hasMore = true;\n    String nextToken = null;\n\n    ListFindingsRequest.Builder builder = ListFindingsRequest.builder()\n            .filterCriteria(\n                    FilterCriteria.builder()\n                            .ecrImageRepositoryName(nextBatch)\n                            .ecrImageTags(nextBatch)\n                            .build());\n\n    while (hasMore) {\n        ListFindingsRequest request = builder.build();\n        ListFindingsResponse response = inspectorClient.listFindings(request);\n        findings.addAll(response.findings());\n        nextToken = response.nextToken();\n        if (nextToken != null) {\n            builder = builder.nextToken(nextToken);\n        } else {\n            hasMore = false;\n        }\n    }\n}\n</code></pre>\n<p>The problem is that it searches for image names OR tags, i.e. it returns all results with matching image name OR tag. I'm trying to figure out how to build my filter so that it only returns results with matching image AND tag, but nothing in the AWS docs suggests it is possible. Does anyone have any ideas?</p>\n<p>Many thanks,</p>\n<p>E.</p>\n",
    "tags" : [ "java", "aws-sdk" ],
    "owner" : {
      "account_id" : 42000686,
      "reputation" : 11,
      "user_id" : 30548921,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/321240ee97ac69bc4f3576855002e7bf?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Eugene Berman",
      "link" : "https://stackoverflow.com/users/30548921/eugene-berman"
    },
    "is_answered" : false,
    "view_count" : 23,
    "answer_count" : 0,
    "score" : 1,
    "last_activity_date" : 1747326961,
    "creation_date" : 1747326961,
    "link" : "https://stackoverflow.com/questions/79623840/awsinspector-client-how-to-search-for-vulnerabilities-in-specific-images-and-t",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ ],
  "answer_comments" : { }
}