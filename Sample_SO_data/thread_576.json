{
  "question" : {
    "question_id" : 79787345,
    "title" : "Thymeleaf TemplateInputException when injecting dynamic fragment via ${content} in layout.html (Spring Boot 3.5.6)",
    "body" : "<p>I'm using Spring Boot 3.5.6 with Thymeleaf 3.1.3, and I'm trying to implement a dynamic layout system where I inject a fragment into layout.html using a model attribute.</p>\n<p><strong>Controller:</strong></p>\n<pre><code>@GetMapping(&quot;/home&quot;)\npublic String home(Model model) {\n    model.addAttribute(&quot;content&quot;, &quot;home :: content&quot;);\n    model.addAttribute(&quot;pageTitle&quot;, &quot;Home&quot;);\n    return &quot;layout&quot;;\n}\n</code></pre>\n<p><strong>layout.html:</strong></p>\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;\n&lt;head&gt;\n  &lt;title th:text=&quot;${pageTitle}&quot;&gt;Default Title&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n  &lt;header th:replace=&quot;header :: header&quot;&gt;&lt;/header&gt;\n  &lt;main&gt;\n    &lt;div th:replace=&quot;${content}&quot;&gt;&lt;/div&gt;\n  &lt;/main&gt;\n  &lt;footer th:replace=&quot;footer :: footer&quot;&gt;&lt;/footer&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n<p><strong>home.html:</strong></p>\n<pre><code>&lt;div th:fragment=&quot;content&quot;&gt;\n  &lt;h1&gt;Welcome Message&lt;/h1&gt;\n&lt;/div&gt;\n</code></pre>\n<p>All templates are located in src/main/resources/templates.</p>\n<p>When I run the app and access /home, I'm experiencing the following error:</p>\n<pre><code>org.thymeleaf.TemplateEngine             : [THYMELEAF][http-nio-8080-exec-1] Exception processing template &quot;layout&quot;: An error happened during template parsing (template: &quot;class path resource [templates/layout.html]&quot;)\n\norg.thymeleaf.exceptions.TemplateInputException: An error happened during template parsing (template: &quot;class path resource [templates/layout.html]&quot;)\n        at org.thymeleaf.templateparser.markup.AbstractMarkupTemplateParser.parse(AbstractMarkupTemplateParser.java:241) ~[thymeleaf-3.1.3.RELEASE.jar:3.1.3.RELEASE]\n        at org.thymeleaf.templateparser.markup.AbstractMarkupTemplateParser.parseStandalone(AbstractMarkupTemplateParser.java:100) ~[thymeleaf-3.1.3.RELEASE.jar:3.1.3.RELEASE]\n        at org.thymeleaf.engine.TemplateManager.parseAndProcess(TemplateManager.java:666) ~[thymeleaf-3.1.3.RELEASE.jar:3.1.3.RELEASE]\n        at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1103) ~[thymeleaf-3.1.3.RELEASE.jar:3.1.3.RELEASE]\n        at org.thymeleaf.TemplateEngine.process(TemplateEngine.java:1077) ~[thymeleaf-3.1.3.RELEASE.jar:3.1.3.RELEASE]\n        at org.thymeleaf.spring6.view.ThymeleafView.renderFragment(ThymeleafView.java:372) ~[thymeleaf-spring6-3.1.3.RELEASE.jar:3.1.3.RELEASE]\n        at org.thymeleaf.spring6.view.ThymeleafView.render(ThymeleafView.java:192) ~[thymeleaf-spring6-3.1.3.RELEASE.jar:3.1.3.RELEASE]\n        at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1438) ~[spring-webmvc-6.2.11.jar:6.2.11]\n        at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1168) ~[spring-webmvc-6.2.11.jar:6.2.11]\n        at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1106) ~[spring-webmvc-6.2.11.jar:6.2.11]\n        at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.11.jar:6.2.11]\n        at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.11.jar:6.2.11]\n        at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.11.jar:6.2.11]\n        at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.46.jar:6.0]\n\n</code></pre>\n<p>I vexed up trying all ways but didn't go through and hitting the same wall, really appreciate your help if someone would help!</p>\n<pre><code>Same error log I have provided in the question itself, I have tried all possible solutions over the internet, but none of them fixed my issue, hence, seeking assistance\nSolution1:\n&lt;div th:replace=&quot;~{__${contentFragment}__}&quot;&gt;&lt;/div&gt;\nSolution2:\n&lt;div th:replace=&quot;__${contentFragment}__&quot;&gt;&lt;/div&gt;\nSolution3:\n&lt;div th:replace=&quot;~{${contentFragment}}&quot;&gt;&lt;/div&gt;\nSolution4:\n&lt;div th:replace=&quot;${contentFragment}&quot;&gt;&lt;/div&gt;\nSolution5:\n&lt;div th:replace=&quot;~{${fragmentFile} :: ${fragmentName}}&quot;&gt;&lt;/div&gt;```\n</code></pre>\n",
    "tags" : [ "java", "spring-boot", "spring-mvc", "thymeleaf" ],
    "owner" : {
      "account_id" : 4317215,
      "reputation" : 159,
      "user_id" : 3526686,
      "user_type" : "registered",
      "accept_rate" : 60,
      "profile_image" : "https://www.gravatar.com/avatar/471fd6ea1b9ebe5afbcd1697a4aceeb9?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "IamDMahesh",
      "link" : "https://stackoverflow.com/users/3526686/iamdmahesh"
    },
    "is_answered" : false,
    "view_count" : 74,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1760165948,
    "creation_date" : 1760099528,
    "link" : "https://stackoverflow.com/questions/79787345/thymeleaf-templateinputexception-when-injecting-dynamic-fragment-via-content",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140790126,
    "post_id" : 79787345,
    "body" : "Sorry, I cannot recreate your problem using the information you have provided in the question. Your code works for me. Maybe someone else will be able to help.",
    "score" : 1,
    "owner" : {
      "account_id" : 12743722,
      "reputation" : 22571,
      "user_id" : 12567365,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/zNR3x.png?s=256",
      "display_name" : "andrewJames",
      "link" : "https://stackoverflow.com/users/12567365/andrewjames"
    },
    "creation_date" : 1760191758,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140789484,
    "post_id" : 79787345,
    "body" : "Please edit your question, instead of trying to squeeze a large stack trace into a comment - which just gets truncated (and is unreadable, anyway, without formatting).",
    "score" : 0,
    "owner" : {
      "account_id" : 12743722,
      "reputation" : 22571,
      "user_id" : 12567365,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/zNR3x.png?s=256",
      "display_name" : "andrewJames",
      "link" : "https://stackoverflow.com/users/12567365/andrewjames"
    },
    "creation_date" : 1760139000,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140789347,
    "post_id" : 79787345,
    "body" : "--- [nio-8080-exec-1] org.thymeleaf.TemplateEngine             : [THYMELEAF][http-nio-8080-exec-1] Exception processing template &quot;layout&quot;: An error happened during template parsing (template: &quot;class path resource [templates/layout.html]&quot;)  org.thymeleaf.exceptions.TemplateInputException: An error happened during template parsing (template: &quot;class path resource [templates/layout.html]&quot;)         at org.thymeleaf.templateparser.markup.AbstractMarkupTemplatePa&zwnj;&#8203;rser.parse(AbstractM&zwnj;&#8203;arkupTemplateParser.&zwnj;&#8203;java:241) ~[thymeleaf-3.1.3.RELEASE.jar:3.1.3.RELEASE]         at....",
    "score" : 0,
    "owner" : {
      "account_id" : 4317215,
      "reputation" : 159,
      "user_id" : 3526686,
      "user_type" : "registered",
      "accept_rate" : 60,
      "profile_image" : "https://www.gravatar.com/avatar/471fd6ea1b9ebe5afbcd1697a4aceeb9?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "IamDMahesh",
      "link" : "https://stackoverflow.com/users/3526686/iamdmahesh"
    },
    "creation_date" : 1760130890,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140788603,
    "post_id" : 79787345,
    "body" : "Having said that, my guess is that you need to use <code>th:replace=&quot;__${content}__&quot;</code>, instead of what you are showing us in your question. The <code>__${...}__</code> syntax is Thymeleaf&#39;s <a href=\"https://www.thymeleaf.org/doc/tutorials/3.1/usingthymeleaf.html#preprocessing\" rel=\"nofollow noreferrer\">preprocessor</a> syntax. It allows Thymeleaf to build a valid fragment selector from your dynamic content <i>before</i> attempting to evaluate that fragment selector. There may be other ways to solve this, too. This is just one suggestion, based on what I can see in the question.",
    "score" : 1,
    "owner" : {
      "account_id" : 12743722,
      "reputation" : 22571,
      "user_id" : 12567365,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/zNR3x.png?s=256",
      "display_name" : "andrewJames",
      "link" : "https://stackoverflow.com/users/12567365/andrewjames"
    },
    "creation_date" : 1760105179,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140788602,
    "post_id" : 79787345,
    "body" : "You have not shown us the full stack trace - where I expect you would see some very helpful &quot;caused by&quot; statements, including information about exactly which line in which template is causing a problem.",
    "score" : 1,
    "owner" : {
      "account_id" : 12743722,
      "reputation" : 22571,
      "user_id" : 12567365,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/zNR3x.png?s=256",
      "display_name" : "andrewJames",
      "link" : "https://stackoverflow.com/users/12567365/andrewjames"
    },
    "creation_date" : 1760105176,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}