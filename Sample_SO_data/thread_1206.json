{
  "question" : {
    "question_id" : 79731975,
    "title" : "Scope of Produces method",
    "body" : "<p>I have unresolved question about CDI:</p>\n<p>I have Producer class annotated with @ApplicationScoped and the @Produce method has no additional scope annotaion.</p>\n<pre><code>@ApplicationScoped\npublic class SecurityIdentityProducer {\n\n    public SecurityIdentityProducer() {\n    }\n\n    @Produces\n    public SecurityIdentity getSecurityIdentity() {\n      return SecurityIdentityImpl(); \n    }\n}\n</code></pre>\n<p>Will be the method getSecurityIdentity() invoked for each injection point, or will be the result from first invocation be reused?</p>\n<p>In order to invoke getSecurityIdentity() for every injection point, do I have to annotate that method with @RequestScoped like this?</p>\n<pre><code>@Produces\n@RequestScoped\npublic SecurityIdentity getSecurityIdentity() {\n  return SecurityIdentityImpl(); \n}\n</code></pre>\n<p>Or does it depend on scope of the Bean where injection is taking place?</p>\n<p>So for example the behavior won't be the same for a @Singleton Bean and for @Stateless Bean?</p>\n<p>Thank you ofor clarification.</p>\n<p>Best regards\nDalibor</p>\n",
    "tags" : [ "java", "jakarta-ee", "cdi" ],
    "owner" : {
      "account_id" : 13293455,
      "reputation" : 77,
      "user_id" : 9597256,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/9f1f3894aaec42c5fddcbb042069b5ac?s=256&d=identicon&r=PG",
      "display_name" : "dkalna",
      "link" : "https://stackoverflow.com/users/9597256/dkalna"
    },
    "is_answered" : true,
    "view_count" : 80,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1754915595,
    "creation_date" : 1754910515,
    "link" : "https://stackoverflow.com/questions/79731975/scope-of-produces-method",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79732051,
    "question_id" : 79731975,
    "body" : "<p>A producer method (or a producer field) behaves similarly to a class-based bean. Unless you explicitly declare a scope, <code>@Dependent</code> is assumed.</p>\n<p>For ease of understanding, think of producers as bean declarations - you need to declare a scope and qualifier(s) just as you would with a class-based bean.</p>\n<p>In your first code example, the <code>SecurityIdentity</code> bean is therefore a <code>@Dependent</code> bean and as such the producer <a href=\"https://jakarta.ee/specifications/cdi/4.0/jakarta-cdi-spec-4.0#dependent_context\" rel=\"nofollow noreferrer\">will be invoked for every injection point</a>.\nNote that <code>@Dependent</code> beans behave differently to other scopes where beans are created once within the context and &quot;live&quot; as long as the context does. The lifecycle of dependent beans is bound to whichever bean you inject them into and dependent bean instances are not shared.</p>\n<p>This leads me to the last part of your question - using <code>@RequestScoped</code>. With that configuration, the bean would be created at most once for each request (the same instance shared between injection points), and destroyed along with the request ending.</p>\n",
    "score" : 2,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 6963528,
      "reputation" : 7041,
      "user_id" : 5342297,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/ec65b3838b1d1ea981cdb5be0a7a4a57?s=256&d=identicon&r=PG",
      "display_name" : "Siliarus",
      "link" : "https://stackoverflow.com/users/5342297/siliarus"
    },
    "creation_date" : 1754915595,
    "last_activity_date" : 1754915595,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : {
    "79732051" : [ {
      "comment_id" : 140667641,
      "post_id" : 79732051,
      "body" : "great! thank you",
      "score" : 0,
      "owner" : {
        "account_id" : 13293455,
        "reputation" : 77,
        "user_id" : 9597256,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/9f1f3894aaec42c5fddcbb042069b5ac?s=256&d=identicon&r=PG",
        "display_name" : "dkalna",
        "link" : "https://stackoverflow.com/users/9597256/dkalna"
      },
      "creation_date" : 1755250132,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140664595,
      "post_id" : 79732051,
      "body" : "Into the singleton, yes. If there are more injection points for <code>SecurityIdentity</code>, it will be invoked for those too OFC.",
      "score" : 0,
      "owner" : {
        "account_id" : 6963528,
        "reputation" : 7041,
        "user_id" : 5342297,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/ec65b3838b1d1ea981cdb5be0a7a4a57?s=256&d=identicon&r=PG",
        "display_name" : "Siliarus",
        "link" : "https://stackoverflow.com/users/5342297/siliarus"
      },
      "creation_date" : 1755156286,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140660181,
      "post_id" : 79732051,
      "body" : "Hi and thank you for your response.   Just one more thing: If I inject SecurityIdentity in &#39;@Singleton&#39; bean without any other annotation, that means, &#39;@Dependent&#39; scope, it will be invoked only once, when that singleton will be instantiated, right?",
      "score" : 0,
      "owner" : {
        "account_id" : 13293455,
        "reputation" : 77,
        "user_id" : 9597256,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/9f1f3894aaec42c5fddcbb042069b5ac?s=256&d=identicon&r=PG",
        "display_name" : "dkalna",
        "link" : "https://stackoverflow.com/users/9597256/dkalna"
      },
      "creation_date" : 1755004209,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}