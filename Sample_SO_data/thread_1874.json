{
  "question" : {
    "question_id" : 79668560,
    "title" : "Spring Boot 3.4.6 validation not triggering for @Email and @NonNull on MongoDB @Document entity",
    "body" : "<p>I'm building a Spring Boot 3.4.6 application using MongoDB and encountering an issue where <code>@NonNull</code> and <code>@Email</code> annotations are not triggering validation errors/exceptions even though I am using <code>@Valid</code> <code>@RequestBody</code> in the Controller. The only validation that is working is <code>@Indexed (unique = true)</code></p>\n<p><em>(Yess, <code>@NonNull</code> and <code>@Email</code> are 2 completely different annotations...)</em></p>\n<p>I have tried:</p>\n<ul>\n<li>Rebuilding my entire project (<code>mvn clean build</code>)</li>\n<li>Checking for the required dependencies</li>\n<li>Confirmed all annotations are from <code>jakarta.validation.*</code>, not <code>javax.validation.*</code> (for <code>@Email</code> annotation)</li>\n<li>Sending clear invalid inputs using Postman</li>\n</ul>\n<p><strong>Yet, no validation error is triggered, and the user still gets created.</strong></p>\n<p>Here’s my setup:</p>\n<p><strong><code>User.java</code> Entity Class</strong></p>\n<pre><code>package com.sathwikhbhat.journalApp.entity;\n\nimport jakarta.validation.constraints.Email;\nimport lombok.AllArgsConstructor;\nimport lombok.Data;\nimport lombok.NoArgsConstructor;\nimport lombok.NonNull;\nimport org.bson.types.ObjectId;\nimport org.springframework.data.annotation.Id;\nimport org.springframework.data.mongodb.core.index.Indexed;\nimport org.springframework.data.mongodb.core.mapping.DBRef;\nimport org.springframework.data.mongodb.core.mapping.Document;\n\nimport java.util.ArrayList;\nimport java.util.List;\n\n@Data\n@NoArgsConstructor\n@AllArgsConstructor\n@Document(collection = &quot;users&quot;)\npublic class User {\n    @Id\n    private ObjectId id;\n    @Indexed(unique = true)\n    @NonNull\n    private String userName;\n    @NonNull\n    @Indexed(unique = true)\n    @Email\n    private String email;\n    private boolean sentimentAnalysis;\n    @NonNull\n    private String password;\n    @DBRef\n    private List&lt;JournalEntry&gt; journalEntries = new ArrayList&lt;&gt;();\n    private List&lt;String&gt; roles;\n}\n</code></pre>\n<p><strong><code>PublicController.java</code> Controller Class</strong></p>\n<pre><code>package com.sathwikhbhat.journalApp.controller;\n\nimport com.sathwikhbhat.journalApp.entity.User;\nimport com.sathwikhbhat.journalApp.service.UserService;\nimport jakarta.validation.Valid;\nimport lombok.extern.slf4j.Slf4j;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.dao.DuplicateKeyException;\nimport org.springframework.http.HttpStatus;\nimport org.springframework.http.ResponseEntity;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.PostMapping;\nimport org.springframework.web.bind.annotation.RequestBody;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RestController;\n\n@Slf4j\n@RestController\n@RequestMapping(&quot;/public&quot;)\npublic class PublicController {\n\n    @Autowired\n    private UserService userService;\n\n    @PostMapping(&quot;createUser&quot;)\n    public ResponseEntity&lt;?&gt; createUser(@Valid @RequestBody User user) {\n        try {\n            userService.saveNewUser(user);\n            log.info(&quot;User created successfully: {}&quot;, user.getUserName());\n            return new ResponseEntity&lt;&gt;(HttpStatus.CREATED);\n        } catch (DuplicateKeyException e) {\n            log.error(e.getMessage());\n            return new ResponseEntity&lt;&gt;(&quot;Username already exists: &quot;, HttpStatus.CONFLICT);\n        } catch (Exception e) {\n            log.error(e.getMessage());\n            return new ResponseEntity&lt;&gt;(&quot;Internal server error: &quot; + e.getMessage(), HttpStatus.INTERNAL_SERVER_ERROR);\n        }\n    }\n}\n</code></pre>\n<p>Any insights or suggestions would be greatly appreciated!</p>\n",
    "tags" : [ "java", "spring-boot", "annotations", "lombok", "jakarta-validation" ],
    "owner" : {
      "account_id" : 39094728,
      "reputation" : 33,
      "user_id" : 29104645,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/AIhRYv8J.png?s=256",
      "display_name" : "sathwikhbhat",
      "link" : "https://stackoverflow.com/users/29104645/sathwikhbhat"
    },
    "is_answered" : true,
    "view_count" : 128,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1750237630,
    "creation_date" : 1750141886,
    "link" : "https://stackoverflow.com/questions/79668560/spring-boot-3-4-6-validation-not-triggering-for-email-and-nonnull-on-mongodb",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79668679,
    "question_id" : 79668560,
    "body" : "<p>You mentioned that annotations <code>NonNull</code> and <code>Email</code> do not work.</p>\n<ul>\n<li><p>NonNull - Is not a a validation annotation. The annotation you are looking for is <code>NotNull</code> (from jakarta.validation.constraints)</p>\n</li>\n<li><p>Email - Is very permissive and email which you consider invalid may be considered valid by the annotation (see <a href=\"https://stackoverflow.com/q/50535214/2342529\">javax.validation.constraints.Email matching invalid email address</a> for details). You can add regex parameter to indicate what pattern you want to use to validate emails</p>\n</li>\n</ul>\n<p>Also, note that as indicated by @M. Deinum in comments, if you imported only <code>validation-api</code> in your project you have access to the annotations but there may not be a validator implementation used to validate them. Check if you have a dependency used to validate the annotations, such as <code>spring-boot-starter-validation</code></p>\n",
    "score" : 3,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 2714938,
      "reputation" : 6448,
      "user_id" : 2342529,
      "user_type" : "registered",
      "accept_rate" : 98,
      "profile_image" : "https://i.sstatic.net/SSkK4.jpg?s=256",
      "display_name" : "Alexandru Severin",
      "link" : "https://stackoverflow.com/users/2342529/alexandru-severin"
    },
    "creation_date" : 1750147534,
    "last_activity_date" : 1750147534,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140519913,
    "post_id" : 79668560,
    "body" : "yup, my code is working as expected now. Thanks a lot!",
    "score" : 0,
    "owner" : {
      "account_id" : 39094728,
      "reputation" : 33,
      "user_id" : 29104645,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/AIhRYv8J.png?s=256",
      "display_name" : "sathwikhbhat",
      "link" : "https://stackoverflow.com/users/29104645/sathwikhbhat"
    },
    "creation_date" : 1750154331,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140519761,
    "post_id" : 79668560,
    "body" : "Add <code>spring-boot-starter-validation</code> as that will pull in the correct and compatible dependencies. If you use the wrong mix of versions between API and the hibernate-validator it won&#39;t work.",
    "score" : 1,
    "owner" : {
      "account_id" : 3192259,
      "reputation" : 126800,
      "user_id" : 2696260,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/qHEzx.png?s=256",
      "display_name" : "M. Deinum",
      "link" : "https://stackoverflow.com/users/2696260/m-deinum"
    },
    "creation_date" : 1750152172,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140519714,
    "post_id" : 79668560,
    "body" : "Thanks @M.Deinum, I just realised that <code>@NonNull</code> doesn&#39;t work the way I thought. And, also, the <code>validation-api</code> dependency is solving my <code>@Email</code> validation issue. I had added <code>jakarta.validation-api</code> and <code>hibernate-validator</code>, but that seemed not to work...",
    "score" : 0,
    "owner" : {
      "account_id" : 39094728,
      "reputation" : 33,
      "user_id" : 29104645,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/AIhRYv8J.png?s=256",
      "display_name" : "sathwikhbhat",
      "link" : "https://stackoverflow.com/users/29104645/sathwikhbhat"
    },
    "creation_date" : 1750151253,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140519499,
    "post_id" : 79668560,
    "body" : "<code>@NonNull</code> is from Lombok and doesn&#39;t do anything for validation only object construction.  Wild guess you thought it would be a good idea to just add <code>validation-api</code> as a dependency and expected all to work. Instead add <code>spring-boot-starter-validation</code> and ditch the <code>validation-api</code> dependency.",
    "score" : 1,
    "owner" : {
      "account_id" : 3192259,
      "reputation" : 126800,
      "user_id" : 2696260,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/qHEzx.png?s=256",
      "display_name" : "M. Deinum",
      "link" : "https://stackoverflow.com/users/2696260/m-deinum"
    },
    "creation_date" : 1750146183,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140519444,
    "post_id" : 79668560,
    "body" : "@AlexandruSeverin Nope, it doesn&#39;t work for any other controller methods in this project. It&#39;s getting quite frustrating...",
    "score" : 0,
    "owner" : {
      "account_id" : 39094728,
      "reputation" : 33,
      "user_id" : 29104645,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/AIhRYv8J.png?s=256",
      "display_name" : "sathwikhbhat",
      "link" : "https://stackoverflow.com/users/29104645/sathwikhbhat"
    },
    "creation_date" : 1750144894,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140519408,
    "post_id" : 79668560,
    "body" : "Do validations work for you in any other controller method in that project? Maybe the issue is not specific to MongoDB entities",
    "score" : 0,
    "owner" : {
      "account_id" : 2714938,
      "reputation" : 6448,
      "user_id" : 2342529,
      "user_type" : "registered",
      "accept_rate" : 98,
      "profile_image" : "https://i.sstatic.net/SSkK4.jpg?s=256",
      "display_name" : "Alexandru Severin",
      "link" : "https://stackoverflow.com/users/2342529/alexandru-severin"
    },
    "creation_date" : 1750144005,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140519373,
    "post_id" : 79668560,
    "body" : "Please edit the question to limit it to a specific problem with enough detail to identify an adequate answer.",
    "score" : 0,
    "owner" : {
      "account_id" : -1,
      "reputation" : 1,
      "user_id" : -1,
      "user_type" : "moderator",
      "profile_image" : "https://www.gravatar.com/avatar/a007be5a61f6aa8f3e85ae2fc18dd66e?s=256&d=identicon&r=PG",
      "display_name" : "Community",
      "link" : "https://stackoverflow.com/users/-1/community"
    },
    "creation_date" : 1750142954,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79668679" : [ {
      "comment_id" : 140519736,
      "post_id" : 79668679,
      "body" : "Thanks, Alexandru. I just forgot how <code>@NonNull</code> works and ended up messing up this validation. And yes, <code>@Email</code> works fine after I added <code>spring-boot-starter-validation</code>. The <code>jakarta.validation-api</code> and <code>hibernate-validator</code> dependencies I added earlier weren’t the right ones...",
      "score" : 0,
      "owner" : {
        "account_id" : 39094728,
        "reputation" : 33,
        "user_id" : 29104645,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/AIhRYv8J.png?s=256",
        "display_name" : "sathwikhbhat",
        "link" : "https://stackoverflow.com/users/29104645/sathwikhbhat"
      },
      "creation_date" : 1750151643,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}