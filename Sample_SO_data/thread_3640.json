{
  "question" : {
    "question_id" : 79535092,
    "title" : "Spring boot v3.4 , JPA, Postgresql, No operator matches the given name and argument types. You might need to add explicit type casts",
    "body" : "<p>I can not figure out how to solve the following issue. Could you please help me?</p>\n<pre class=\"lang-none prettyprint-override\"><code>aused by: org.hibernate.exception.SQLGrammarException: could not execute statement [ERROR: operator does not exist: character varying = bigint\n  Hint: No operator matches the given name and argument types. You might need to add explicit type casts.\n  Position: 355] [update email_records set active=?,created_date_in_ms=? ...]\n</code></pre>\n<p>The point I am getting the exception:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Component\n@RequiredArgsConstructor\npublic class EmailSenderBatchJob {\n\n    @Async(&quot;...&quot;)\n    @Scheduled(cron = &quot;...&quot;)\n    public void mailJob() {\n        final int batchSize = 50;\n        Slice&lt;EmailEntity&gt; notSendEmails = emailRepository.getEmailWithStatus(EmailStatus.SCHEDULED, PageRequest.of(0, batchSize));\n        for (EmailEntity emailEntity : notSendEmails.getContent()) {\n            emailEntity.setEmailStatus(EmailStatus.SEND); // throw exception after calling save method\n            emailEntity.setActive(false);\n            emailRepository.save(emailEntity);\n        }\n}\n\n@Repository\npublic interface EmailRepository extends JpaRepository&lt;EmailEntity, String&gt; {\n\n    @Query(&quot;FROM EmailEntity ue WHERE ue.emailStatus = :emailStatus&quot;)\n    Slice&lt;EmailEntity&gt; getEmailWithStatus(@Param(&quot;emailStatus&quot;) EmailStatus emailStatus, PageRequest pageRequest);\n}\n</code></pre>\n<p>Here is the create table sql</p>\n<pre class=\"lang-sql prettyprint-override\"><code>CREATE TABLE email_records (\n    email_status character varying(100) NOT NULL,\n    id character varying(60) PRIMARY KEY NOT NULL\n);\n</code></pre>\n<p>Corresponding entity and converter</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class EmailEntity {\n  \n    @NotNull\n    @Column(name = &quot;email_status&quot;)\n    @Convert(converter = EmailStatusJPAConverter.class)\n    private EmailStatus emailStatus;\n        \n}\n\n@Converter(autoApply = true)\npublic class EmailStatusJPAConverter implements AttributeConverter&lt;EmailStatus, String&gt; {\n    @Override\n    public String convertToDatabaseColumn(EmailStatus attribute) {\n        return attribute.dbValue;\n    }\n\n    @Override\n    public EmailStatus convertToEntityAttribute(String dbData) {\n        return EmailStatus.fromDbValue(dbData);\n    }\n}\n\npublic enum EmailStatus {\n    UNKNOWN(&quot;UNKNOWN&quot;, &quot;UNKNOWN&quot;),\n    SCHEDULED(&quot;SCHEDULED&quot;, &quot;SCHEDULED&quot;),\n    SEND(&quot;SEND&quot;, &quot;SEND&quot;)\n    ;\n\n    public final String dbValue;\n    public final String value;\n\n    EmailStatus(String dbValue, String value) {\n        this.dbValue = dbValue;\n        this.value = value;\n    }\n\n    public static EmailStatus fromDbValue(String dbValue) {\n        for (EmailStatus each : values()) {\n            if (each.dbValue.equals(dbValue)) {\n                return each;\n            }\n        }\n        return EmailStatus.UNKNOWN;\n    }\n}\n</code></pre>\n<p>I tried @Enumareted(String) other solution on the Internet but none of them worked. I am using postgresql v16 with flyway</p>\n",
    "tags" : [ "java", "spring-boot", "jpa", "spring-data-jpa" ],
    "owner" : {
      "account_id" : 12206881,
      "reputation" : 980,
      "user_id" : 8909722,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/ff82ea436f7249c938b7e4d0eebd8d5e?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "monstereo",
      "link" : "https://stackoverflow.com/users/8909722/monstereo"
    },
    "is_answered" : false,
    "view_count" : 91,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1742946044,
    "creation_date" : 1742946044,
    "link" : "https://stackoverflow.com/questions/79535092/spring-boot-v3-4-jpa-postgresql-no-operator-matches-the-given-name-and-argum",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140265364,
    "post_id" : 79535092,
    "body" : "OMG you are right, i am just using wrong type for another field, after changing it everything was resolved. Many thanks",
    "score" : 0,
    "owner" : {
      "account_id" : 12206881,
      "reputation" : 980,
      "user_id" : 8909722,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/ff82ea436f7249c938b7e4d0eebd8d5e?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "monstereo",
      "link" : "https://stackoverflow.com/users/8909722/monstereo"
    },
    "creation_date" : 1742990969,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140265315,
    "post_id" : 79535092,
    "body" : "That still doesn&#39;t mean you&#39;re checking the correct parameter. If you configure your logger to level <code>DEBUG</code> for <code>org.hibernate.SQL</code> and <code>TRACE</code> for <code>org.hibernate.type.descriptor.sql</code> you will see the full query in the logs and every parameter that was bound to it. If memory serves, the query is hardcoded to be printed to <code>System.out</code>, so make sure that&#39;s not ignored",
    "score" : 0,
    "owner" : {
      "account_id" : 4751155,
      "reputation" : 5135,
      "user_id" : 3841161,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/224f38b7397570f11c5891d8db8ab13b?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "coladict",
      "link" : "https://stackoverflow.com/users/3841161/coladict"
    },
    "creation_date" : 1742990400,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140265248,
    "post_id" : 79535092,
    "body" : "@coladict but first insert operation works, problem arises when hibernate runs the update query ?",
    "score" : 0,
    "owner" : {
      "account_id" : 12206881,
      "reputation" : 980,
      "user_id" : 8909722,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/ff82ea436f7249c938b7e4d0eebd8d5e?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "monstereo",
      "link" : "https://stackoverflow.com/users/8909722/monstereo"
    },
    "creation_date" : 1742989757,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140264632,
    "post_id" : 79535092,
    "body" : "If <code>@Enumerated(EnumType.STRING)</code> didn&#39;t work, then perhaps you are looking at the wrong column entirely, and this is not the one causing the problem.",
    "score" : 0,
    "owner" : {
      "account_id" : 4751155,
      "reputation" : 5135,
      "user_id" : 3841161,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/224f38b7397570f11c5891d8db8ab13b?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "coladict",
      "link" : "https://stackoverflow.com/users/3841161/coladict"
    },
    "creation_date" : 1742982538,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140264185,
    "post_id" : 79535092,
    "body" : "both ORDINAL and STRING not working. And also i want to store enum as string (varchar) in the database @soonhankwon",
    "score" : 0,
    "owner" : {
      "account_id" : 12206881,
      "reputation" : 980,
      "user_id" : 8909722,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/ff82ea436f7249c938b7e4d0eebd8d5e?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "monstereo",
      "link" : "https://stackoverflow.com/users/8909722/monstereo"
    },
    "creation_date" : 1742975606,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140263491,
    "post_id" : 79535092,
    "body" : "Isn&#39;t EmailStatus set to the default value of @Enumerated(EnumType.ORDINAL)?",
    "score" : 0,
    "owner" : {
      "account_id" : 26632317,
      "reputation" : 289,
      "user_id" : 20249327,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a/ALm5wu1bp9GPoLNa_I9ZzDXU_Wfn7OdR-yy8vq2-hiGQDw=k-s256",
      "display_name" : "soonhankwon",
      "link" : "https://stackoverflow.com/users/20249327/soonhankwon"
    },
    "creation_date" : 1742953675,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}