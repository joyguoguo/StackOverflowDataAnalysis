{
  "question" : {
    "question_id" : 79560587,
    "title" : "spring-boot-web latency problem on RestController",
    "body" : "<p>I have a strange latency with the spring-boot-web rest endpoint (with Tomcat).\nWe have RestController with different methods. We paid attention to strange latency.\nFor example, I created a simple end-point that returns true (we have real end-points, but trying to isolate the issue, create this simple one end-point).\nHitting this end-point takes an average of 60 - 70 ms (looking into Spring's <code>sum(rate(http_server_requests_seconds_sum{kubernetes_pod_name=~&quot;$pod.*&quot;, release=&quot;$application&quot;, exception=&quot;none&quot;,  uri=&quot;/test&quot;, status !~ &quot;4.*&quot;}[2m])) / sum(rate(http_server_requests_seconds_count{kubernetes_pod_name=~&quot;$pod.*&quot;, exception=&quot;none&quot;,uri=&quot;/test&quot;, release=&quot;$application&quot;, status !~ &quot;4.*&quot;}[2m]))</code>).\nUsing Spring 3.4.4 (tried to downgrade to spring-boot version 3.3.7 - the same result).\nThere are no CPU or memory problems. I am just trying to understand if it's regular latency, or we have some misconfiguration or if there is any other problem. We are running on K8s.\nWe have a different service that talks with this one and see the latency on it, too.\nAny idea where the problem could be?</p>\n<p><strong>Update:</strong> I found the guilty part. It's SecurityFilterChain. Adding basic auth caused the delay: about an additional 50ms</p>\n<p>Does anyone know why?</p>\n",
    "tags" : [ "java", "spring-boot", "performance", "spring-security" ],
    "owner" : {
      "account_id" : 9141157,
      "reputation" : 93,
      "user_id" : 6798951,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/2019f756c3e86a9670cd0d1d20d2a4ea?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Mikhail Grinfeld",
      "link" : "https://stackoverflow.com/users/6798951/mikhail-grinfeld"
    },
    "is_answered" : false,
    "view_count" : 186,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1748542013,
    "creation_date" : 1744052027,
    "link" : "https://stackoverflow.com/questions/79560587/spring-boot-web-latency-problem-on-restcontroller",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79644418,
    "question_id" : 79560587,
    "body" : "<p>In this situation 50-60ms is normal latency. However if you want to increase performance you may use JWT auth instead of Basic Auth.<br />\n<strong>Why basic auth increase latency?</strong><br />\nBasic auth may introduce latency increase because credentials are sent to server in Base64 encoded string, server has to decode and validate credentials. Using JWT will reduce the performance overhead as server will not have query database again and again significantly reducing the latency. However you may use a workaround if you don't want to use JWT, on startup load all users in some static Map, you may use username as key and User Model as value, this will also help in reducing latency.</p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 16860149,
      "reputation" : 181,
      "user_id" : 12191150,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/fec9a6154254eb5fd901f4a0045c0b1f?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Yasin Ahmed",
      "link" : "https://stackoverflow.com/users/12191150/yasin-ahmed"
    },
    "creation_date" : 1748542013,
    "last_activity_date" : 1748542013,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140328340,
    "post_id" : 79560587,
    "body" : "If you use basic auth, your app is hashing your password. This needs some time. I don&#39;t know how much. It depends on the algo.",
    "score" : 0,
    "owner" : {
      "account_id" : 6463892,
      "reputation" : 17313,
      "user_id" : 5277820,
      "user_type" : "registered",
      "accept_rate" : 68,
      "profile_image" : "https://www.gravatar.com/avatar/6992b2117ccaf3d82f79a2062d0e93a5?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "dur",
      "link" : "https://stackoverflow.com/users/5277820/dur"
    },
    "creation_date" : 1744482346,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140311529,
    "post_id" : 79560587,
    "body" : "Not sure why but it needs access to the headers which leads to parsing the request which takes time.",
    "score" : 0,
    "owner" : {
      "account_id" : 3192259,
      "reputation" : 126800,
      "user_id" : 2696260,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/qHEzx.png?s=256",
      "display_name" : "M. Deinum",
      "link" : "https://stackoverflow.com/users/2696260/m-deinum"
    },
    "creation_date" : 1744112390,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}