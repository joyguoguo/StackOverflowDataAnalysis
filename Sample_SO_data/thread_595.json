{
  "question" : {
    "question_id" : 79786061,
    "title" : "Is there a bug in the method below (Data Structures &amp; Algorithms by Robert Lafore)",
    "body" : "<p>The method below has been taken from the book <em>Data Structures &amp; Algorithms by Robert Lafore</em>. This method is used to bubble sort a given array. <code>nElems</code> is the number of elements in the array. In my opinion, there is a bug in this method, so instead of <code>out &gt; 1</code> it should be <code>out &gt; 0</code>. Please help clarify.</p>\n<pre><code>public void bubbleSort() {\n    int out, in ;\n    for (out = nElems - 1; out &gt; 1; out--) // outer loop (backward)\n        for ( in = 0; in &lt; out; in ++) // inner loop (forward)\n            if (a[ in ] &gt; a[ in +1]) // out of order?\n                swap( in , in +1); // swap them\n}\n</code></pre>\n<pre><code>private void swap(int one, int two) {\n    long temp = a[one];\n    a[one] = a[two];\n    a[two] = temp;\n}\n</code></pre>\n<p>I tried to run the method, but I think it is wrong.</p>\n",
    "tags" : [ "java", "arrays", "data-structures", "bubble-sort" ],
    "owner" : {
      "account_id" : 5671193,
      "reputation" : 13,
      "user_id" : 4485754,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/34d8c30033a157348e8f5d6619b1b0eb?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Azer Shukurzade",
      "link" : "https://stackoverflow.com/users/4485754/azer-shukurzade"
    },
    "is_answered" : true,
    "view_count" : 101,
    "answer_count" : 2,
    "score" : 1,
    "last_activity_date" : 1759993429,
    "creation_date" : 1759989010,
    "link" : "https://stackoverflow.com/questions/79786061/is-there-a-bug-in-the-method-below-data-structures-algorithms-by-robert-lafor",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79786073,
    "question_id" : 79786061,
    "body" : "<p>The Problem is in the outer loop uses:</p>\n<p><code>for(out = nElems - 1; out &gt; 1; out--)</code></p>\n<p>That means the last iteration occurs when out == 2, not when out == 1. So when the array has only two elements left (out == 1), the loop stops too early, leaving the first two elements possibly unsorted.<br />\nThe correct code should be:<br />\n<code>for(out = nElems - 1; out &gt; 0; out--)</code><br />\nThis ensures the outer loop runs until only one element remains unsorted (which will automatically be the smallest element).</p>\n",
    "score" : 3,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 19899692,
      "reputation" : 21,
      "user_id" : 14579994,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/6d12ad10db0e357ccf697a9c9dcfc7c2?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Osamah Ghadheb",
      "link" : "https://stackoverflow.com/users/14579994/osamah-ghadheb"
    },
    "creation_date" : 1759989819,
    "last_activity_date" : 1759989819,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79786106,
    "question_id" : 79786061,
    "body" : "<p>You wrote:</p>\n<blockquote>\n<p>instead of <code>out &gt; 1</code> it should be <code>out &gt; 0</code>.</p>\n</blockquote>\n<p>That is a correct observation and correction.</p>\n<blockquote>\n<p>Please help clarify.</p>\n</blockquote>\n<p>The textbook version of the code will fail to sort an array correctly when the least value is at the very last index of the input array. That least value can &quot;travel back&quot; at most n-2 positions, by the repeated execution of the last swap in the inner loop, so that this least value ends up at the second position, while it needed to end up in the first position.</p>\n<p>The smallest test case that fails would be an array with just 2 values, which are not in the right order, like for example <code>{2, 1}</code>. In that case the outer loop will not make any iterations, and thus no swap will be performed.</p>\n<p>But any other input array that has its least value at the end, will not be sorted correctly, like for example <code>{2, 3, 1}</code> will be turned into <code>{2, 1, 3}</code>.</p>\n<h2>Remarks</h2>\n<p>It is striking that the author continues with a section on invariants where they (correctly) claim:</p>\n<blockquote>\n<p>the invariant is that the data items to the right of <code>outer</code> [sic] are sorted. This remains true throughout running the algorithm.</p>\n</blockquote>\n<p>This should have alerted them that at the end of the algorithm this invariant is only guaranteed for the data items at the right of index 1 -- as the value of <code>outer</code> is 1 when the loop exits on a non-empty input. That means this invariant rule gives no guarantee that involves the value at index 0.</p>\n<p>In subsequent section on &quot;efficiency of the Bubble Sort&quot;, they analyse that the number of comparisons is:</p>\n<p>(N−1) + (N−2) + (N−3) + ... + 1</p>\n<p>...but that last term (1) is a comparision that is not performed by their code. The last iteration of their outer loop will execute the inner loop <em>twice</em>, which is responsible for the previous term (2) in the above expression, leaving out the term 1.</p>\n",
    "score" : 2,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 7142980,
      "reputation" : 357143,
      "user_id" : 5459839,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/lUUgh.png?s=256",
      "display_name" : "trincot",
      "link" : "https://stackoverflow.com/users/5459839/trincot"
    },
    "creation_date" : 1759992731,
    "last_activity_date" : 1759993429,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140785515,
    "post_id" : 79786061,
    "body" : "The Problem is in the outer loop uses: for(out = nElems - 1; out &gt; 1; out--)  That means the last iteration occurs when out == 2, not when out == 1. So when the array has only two elements left (out == 1), the loop stops too early, leaving the first two elements possibly unsorted.  the correct code should be: for(out = nElems - 1; out &gt; 0; out--)  This ensures the outer loop runs until only one element remains unsorted (which will automatically be the smallest element).",
    "score" : 0,
    "owner" : {
      "account_id" : 19899692,
      "reputation" : 21,
      "user_id" : 14579994,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/6d12ad10db0e357ccf697a9c9dcfc7c2?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Osamah Ghadheb",
      "link" : "https://stackoverflow.com/users/14579994/osamah-ghadheb"
    },
    "creation_date" : 1759989685,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140785504,
    "post_id" : 79786061,
    "body" : "&quot;I try to run method&quot;, so ... did it work? Were the results as (to be) expected?",
    "score" : 5,
    "owner" : {
      "account_id" : 3116234,
      "reputation" : 9469,
      "user_id" : 2636929,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/85fa83a02c04af43fcd224821ca9b750?s=256&d=identicon&r=PG",
      "display_name" : "Stultuske",
      "link" : "https://stackoverflow.com/users/2636929/stultuske"
    },
    "creation_date" : 1759989096,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}