{
  "question" : {
    "question_id" : 79555687,
    "title" : "How to get played frames of javazoom player",
    "body" : "<p>I have a problem with getting played music frames by javazoom AdvancedPlayer. I'm coding player with slider, that can control music duration. Here you can see my code of max frames and test code of played frames. Method returns max frames of music works correctly, but played frames doesn't.</p>\n<p>skippedFrames is variable, that uses to calculate slider position after clicking on it, you can see code of this here:\nseekTo(targetTime) uses skipFrames</p>\n<pre><code>if (invisibleSliderRect.intersect(mx, my)) {\n            float clickPosition =  Math.max(0, Math.min(1, (mx - invisibleSliderRect.getX()) / invisibleSliderRect.getW()));\n            int targetTime = (int) ((float) (clickPosition * music.getMaxFrames()));\n            music.seekTo(targetTime);\n\n            return true;\n        }\n</code></pre>\n<p>Here is code of frames. getFramesPlayed() doesn't work correctly, it doesn't return frames like getMaxFrames(). It returns more than getMaxFrames(), not throws exceptions or etc.</p>\n<pre><code>public int getFramesPlayed() {\n        int framesPlayed = skippedFrames;\n        AudioDevice audioDevice = ((JavaZoomAccessor) player).getAudio();\n        SourceDataLine sourceDataLine;\n        if (player != null &amp;&amp; audioDevice instanceof JavaSoundAudioDevice js &amp;&amp; (sourceDataLine = ((JavaSoundAudioDeviceAccessor) js).getSource()) != null) {\n            long bytesWritten = sourceDataLine.getLongFramePosition();\n            int frameSize = sourceDataLine.getFormat().getFrameSize();\n            int playedFrames = 0;\n            if (frameSize &gt; 0) {\n                playedFrames = (int) (bytesWritten / frameSize);\n            }\n\n            framesPlayed += playedFrames;\n\n            int maxFrames = getMaxFrames();\n            if (framesPlayed &gt; maxFrames) framesPlayed = maxFrames;\n        }\n        return framesPlayed;\n    }\n\n    public int getMaxFrames() {\n        if (currentTrackFile == null) return 0;\n        try {\n            FileInputStream fis = new FileInputStream(currentTrackFile);\n            Bitstream bitstream = new Bitstream(fis);\n            Header header = null;\n            int frameCount = 0;\n            while ((header = bitstream.readFrame()) != null) {\n                frameCount++;\n                bitstream.closeFrame();\n            }\n\n            fis.close();\n            return frameCount;\n        } catch (Exception e) {\n            System.err.println(&quot;Error getting max frames: &quot; + e.getMessage());\n            return 0;\n        }\n    }\n</code></pre>\n",
    "tags" : [ "java", "javasound" ],
    "owner" : {
      "account_id" : 32551522,
      "reputation" : 9,
      "user_id" : 25419439,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a/ACg8ocLjyiTGd7TTeEy4kGr79e38g2m_v_iZhQgRVcwNqQd0QSHgUFo=k-s256",
      "display_name" : "Artik",
      "link" : "https://stackoverflow.com/users/25419439/artik"
    },
    "is_answered" : false,
    "view_count" : 44,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1751842887,
    "creation_date" : 1743779408,
    "link" : "https://stackoverflow.com/questions/79555687/how-to-get-played-frames-of-javazoom-player",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140300665,
    "post_id" : 79555687,
    "body" : "I know, but i havent change the variable name, cuz it was just a testing of code ^. But even after reading javadoc, i still dont understand how to do what i want. Because what i need literally doesnt work as its written there.",
    "score" : 0,
    "owner" : {
      "account_id" : 32551522,
      "reputation" : 9,
      "user_id" : 25419439,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a/ACg8ocLjyiTGd7TTeEy4kGr79e38g2m_v_iZhQgRVcwNqQd0QSHgUFo=k-s256",
      "display_name" : "Artik",
      "link" : "https://stackoverflow.com/users/25419439/artik"
    },
    "creation_date" : 1743791332,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140300222,
    "post_id" : 79555687,
    "body" : "The <a href=\"https://docs.oracle.com/en/java/javase/24/docs/api/java.desktop/javax/sound/sampled/DataLine.html#getLongFramePosition()\" rel=\"nofollow noreferrer\">Javadoc</a> says <code>getLongFramePosition</code> returns the number of <b>frames</b> written, not the number of bytes.",
    "score" : 0,
    "owner" : {
      "account_id" : 3159259,
      "reputation" : 111552,
      "user_id" : 2670892,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/4iPV5.png?s=256",
      "display_name" : "greg-449",
      "link" : "https://stackoverflow.com/users/2670892/greg-449"
    },
    "creation_date" : 1743783629,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}