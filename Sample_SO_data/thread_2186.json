{
  "question" : {
    "question_id" : 79640041,
    "title" : "How to control line spacing when filling PDF form fields with iText, especially under line break scenarios?",
    "body" : "<p>How to control line spacing when filling PDF form fields with iText, especially under line break scenarios?\njava code</p>\n<pre><code>package com.example.demo2.demos.test;\n\nimport com.lowagie.text.DocumentException;\nimport com.lowagie.text.pdf.*;\n\nimport java.io.*;\nimport java.util.HashMap;\nimport java.util.Map;\n\npublic class pdfWrite { public static void fillFormFields(InputStream inputStream, String outputPdfPath, Map&lt;String, String&gt; fieldValues) {\n        // 获取pdf中的表单域\n        String pdfPath = new String();\n        // 填写表单域并保存\n        outputPdfPath = new String();\n        fieldValues = new HashMap&lt;&gt;();\n        fieldValues.put(&quot;school&quot;, &quot;XX大学&quot;);\n        fieldValues.put(&quot;student&quot;, &quot;张三&quot;);\n        fieldValues.put(&quot;text1&quot;, &quot;12111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111113&quot;);\n        try {\n            inputStream = new FileInputStream(pdfPath);\n            PdfReader reader = new PdfReader(inputStream);\n            PdfStamper stamper = new PdfStamper(reader, new FileOutputStream(outputPdfPath));\n            AcroFields form = stamper.getAcroFields();\n\n            // 嵌入字体\n            BaseFont base = BaseFont.createFont (&quot;simfang.ttf&quot;, BaseFont.IDENTITY_H, BaseFont.EMBEDDED);\n\n            for (Map.Entry&lt;String, String&gt; entry : fieldValues.entrySet()) {\n                String fieldName = entry.getKey();\n                String fieldValue = entry.getValue();\n                form.setFieldProperty(fieldName, &quot;textfont&quot;, base, null);\n                form.setField(fieldName, fieldValue);\n            }\n\n            stamper.setFormFlattening(true);\n            stamper.close();\n            reader.close();\n        } catch (IOException | DocumentException e) {\n            e.printStackTrace();\n        }\n    }\n}\n</code></pre>\n<pre><code>pom.xml\n&lt;dependency&gt;\n             &lt;groupId&gt;com.lowagie&lt;/groupId&gt;             \n             &lt;artifactId&gt;itext&lt;/artifactId&gt;\n             &lt;version&gt;2.1.7&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p><a href=\"https://i.sstatic.net/ZgBU8amS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/ZgBU8amS.png\" alt=\"enter image description here\" /></a></p>\n<p>I have a PDF file containing form fields, one of which is a multi-line text field. When filling this field using Java code, I need to adjust the line spacing between rows. Specifically, I'm using iText (version 2.1.7) and have already tried setting the leading property, but the spacing doesn't appear to change as expected.I tried converting the field to a rich text box and writing style attributes, but it didn't work.</p>\n",
    "tags" : [ "java", "pdf", "itext" ],
    "owner" : {
      "account_id" : 26342001,
      "reputation" : 1,
      "user_id" : 20000958,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/a4462b8bb6f96516dcddb94916d1f02f?s=256&d=identicon&r=PG",
      "display_name" : "王者之座",
      "link" : "https://stackoverflow.com/users/20000958/%e7%8e%8b%e8%80%85%e4%b9%8b%e5%ba%a7"
    },
    "is_answered" : true,
    "view_count" : 61,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1748394684,
    "creation_date" : 1748332910,
    "link" : "https://stackoverflow.com/questions/79640041/how-to-control-line-spacing-when-filling-pdf-form-fields-with-itext-especially",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79641382,
    "question_id" : 79640041,
    "body" : "<p><strong>The tech basics</strong>:</p>\n<ul>\n<li><p>Appearance stream, <code>/AP</code>, of the acro field's widget annotation is the only way to set a line spacing (<strong>the leading, T<sub>l</sub></strong><sub>,</sub> in the PDF Spec) inside a PDF's Acro Field. (See <a href=\"https://opensource.adobe.com/dc-acrobat-sdk-docs/pdfstandards/PDF32000_2008.pdf\" rel=\"nofollow noreferrer\">PDF Reference 1.7; 12.7 Interactive Forms</a>).</p>\n</li>\n<li><p>Adobe Acrobat uses <strong>built-in</strong> appearance streams for different acro fields.</p>\n</li>\n</ul>\n<p>I don't know any software that allow setting line spacing inside the PDF Acro Field a priori. I believe, the main reason for this is that the visual representation of a custom appearance script and the one's of Acrobat's built-in script are different. I mean, you may write a predefined <code>/AP</code> with some text and altered line spacing, and Acrobat will display the desired appearance, but any change to a text will cause to revert back to the built-in Acrobat's appearance stream. And it looks <strong>very</strong> ugly.</p>\n<p>The only way of setting line spacing programmatically (i.e. not by editing the resulting PDF file) I can think of is adding Adobe Script to a Text Acro Field. For details, see:</p>\n<ul>\n<li><p><a href=\"https://www.pdfscripting.com/public/Formatting-Form-Fields.cfm\" rel=\"nofollow noreferrer\">Formatting Fields</a> -- the Acro script internals</p>\n</li>\n<li><p><a href=\"https://stackoverflow.com/questions/16409278/remove-javascript-from-pdf-using-itextsharp\">Add Javascript to PDF using iText</a> -- actually, the question there is <em>how to remove script from PDF</em> :), but all details and links are good.</p>\n</li>\n</ul>\n",
    "score" : 1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 35354441,
      "reputation" : 44,
      "user_id" : 27156279,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/oJPdtGFA.jpg?s=256",
      "display_name" : "Alexey Gagarinov",
      "link" : "https://stackoverflow.com/users/27156279/alexey-gagarinov"
    },
    "creation_date" : 1748394684,
    "last_activity_date" : 1748394684,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : { }
}