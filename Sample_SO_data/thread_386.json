{
  "question" : {
    "question_id" : 79804611,
    "title" : "How to include ResponseEntity in the spring RestClient",
    "body" : "<p>I am connecting to api.met.no to get the forecast for a given lat/lon using spring RestCLient with this code</p>\n<pre><code>  public ResponseEntity&lt;Forecast&gt; getLocationForecast(double latitude, double longitude) {\n    MetResponse response = restClient.get()\n            .uri(uriBuilder -&gt;\n                    uriBuilder\n                            .path(&quot;/weatherapi/locationforecast/2.0/compact&quot;)\n                            .queryParam(&quot;lat&quot;, latitude)\n                            .queryParam(&quot;lon&quot;, longitude)\n                            .build())\n            .accept(MediaType.APPLICATION_JSON)\n            .retrieve()\n            .toEntity(MetResponse.class)\n            .getBody();\n\n    assert response != null;\n    return ResponseEntity.ok().body(Forecast.fromMetResponse(response));\n\n}\n</code></pre>\n<p>I want to know if it is possible to add the ResponseEntity mapping directly in the RestClient something like</p>\n<pre><code>ResponseEntity&lt;Forecast&gt; response = restClient.get()\n            .uri(uriBuilder -&gt;\n                    uriBuilder\n                            .path(&quot;/weatherapi/locationforecast/2.0/compact&quot;)\n                            .queryParam(&quot;lat&quot;, latitude)\n                            .queryParam(&quot;lon&quot;, longitude)\n                            .build())\n            .accept(MediaType.APPLICATION_JSON)\n            .retrieve()\n            .toEntity(Forecast::fromMetResponse);\n</code></pre>\n<p>where fromMetResponse is</p>\n<pre><code> public static Forecast fromMetResponse(MetResponse response) \n</code></pre>\n<p>thanks,</p>\n<p>es</p>\n",
    "tags" : [ "java", "spring", "spring-restclient" ],
    "owner" : {
      "account_id" : 217454,
      "reputation" : 960,
      "user_id" : 473259,
      "user_type" : "registered",
      "accept_rate" : 100,
      "profile_image" : "https://www.gravatar.com/avatar/53bdeafabf39b462fa6bb179384d56a4?s=256&d=identicon&r=PG",
      "display_name" : "Goozo",
      "link" : "https://stackoverflow.com/users/473259/goozo"
    },
    "is_answered" : true,
    "view_count" : 96,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1762258633,
    "creation_date" : 1761817932,
    "link" : "https://stackoverflow.com/questions/79804611/how-to-include-responseentity-in-the-spring-restclient",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79808889,
    "question_id" : 79804611,
    "body" : "<p>I see your problem.</p>\n<p>The response from</p>\n<pre><code>/weatherapi/locationforecast/2.0/compact\n</code></pre>\n<p>may not always be a 200 OK so you want to give a more transparent response. Try this instead</p>\n<pre><code>public ResponseEntity&lt;Forecast&gt; getLocationForecast(double latitude, double longitude) {\n    \n    Response response1 = client.target(&quot;/weatherapi/locationforecast/2.0/compact&quot;)\n            .queryParam(&quot;lat&quot;, latitude)\n            .queryParam(&quot;lon&quot;, longitude)\n            .request(MediaType.APPLICATION_JSON_VALUE)\n            .get();\n\n    MetResponse mr = response1.readEntity(MetResponse.class);\n    assert mr != null;\n    Forecast f = Forecast.fromMetResponse(mr);\n    \n    ResponseEntity&lt;Forecast&gt; responseEntity = ResponseEntity\n            .status(response1.getStatus())\n            .header(&quot;h1&quot;, response1.getHeaderString(&quot;h1&quot;))\n            .header(&quot;h2&quot;, response1.getHeaderString(&quot;h2&quot;))\n            .header(&quot;h3&quot;, response1.getHeaderString(&quot;h3&quot;))\n            .header(&quot;h4&quot;, response1.getHeaderString(&quot;h4&quot;))\n            .contentType(MediaType.APPLICATION_JSON)\n            .body(f);\n    \n    return responseEntity;\n}\n</code></pre>\n<p>I don't know what rest client you're using but I used javax.ws.rs.Client above which returns a javax.ws.rs.core.Response. The specific artifact used was javax.ws.rs:javax.ws.rs-api:2.1.1</p>\n",
    "score" : 1,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 14740716,
      "reputation" : 49,
      "user_id" : 10645435,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/qVn3w.png?s=256",
      "display_name" : "Dreek",
      "link" : "https://stackoverflow.com/users/10645435/dreek"
    },
    "creation_date" : 1762258633,
    "last_activity_date" : 1762258633,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140826771,
    "post_id" : 79804611,
    "body" : "No and I doubt that that is what you really want. While you are returning a <code>ResponseEntity</code> I doubt you want to directly return the <code>ResponseEntity</code> from the call to the weather API (with its headers, status codes and what more). You can make it a bit shorter by doing <code>return ResponseEntity.ok(Forecast.fromMetResponse(response)</code>.",
    "score" : 2,
    "owner" : {
      "account_id" : 3192259,
      "reputation" : 126777,
      "user_id" : 2696260,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/qHEzx.png?s=256",
      "display_name" : "M. Deinum",
      "link" : "https://stackoverflow.com/users/2696260/m-deinum"
    },
    "creation_date" : 1761820159,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}