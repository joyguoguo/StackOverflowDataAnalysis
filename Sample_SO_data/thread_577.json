{
  "question" : {
    "question_id" : 79791962,
    "title" : "NoClassDefFoundError: org/slf4j/LoggerFactory when running in Intellij but works fine from the command line",
    "body" : "<p>I am having issues related to my tests which are failing because of slf4j-api being absent, which does not make sense because it is present as it is provided as a transitive dependency from one of the libraries.</p>\n<p>The error is:</p>\n<pre><code>java.lang.NoClassDefFoundError: org/slf4j/LoggerFactory\n\n    at nl.altindag.log.util.LogbackUtils.getSlf4jLogger(LogbackUtils.java:66)\n    at nl.altindag.log.util.LogbackUtils.getLogger(LogbackUtils.java:52)\n    at nl.altindag.log.LogCaptor.&lt;init&gt;(LogCaptor.java:56)\n    at nl.altindag.log.LogCaptor.forName(LogCaptor.java:91)\n    at nl.altindag.ssl@10.0.1-SNAPSHOT/nl.altindag.ssl.keymanager.KeyManagerFactoryWrapperShould.&lt;init&gt;(KeyManagerFactoryWrapperShould.java:41)\n    at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:490)\n    at java.base/java.util.Optional.orElseGet(Optional.java:369)\n    at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)\n    at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)\nCaused by: java.lang.ClassNotFoundException: org.slf4j.LoggerFactory\n    at java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:581)\n    at java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:178)\n    at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:526)\n    ... 9 more\n</code></pre>\n<p>Which indicates that the slf4j-api is absent. However, mvn dependency tree should give more insight of what is being present.</p>\n<pre><code>[INFO] --- dependency:3.7.0:tree (default-cli) @ ayza ---\n[INFO] io.github.hakky54:ayza:jar:10.0.1-SNAPSHOT\n[INFO] +- io.github.hakky54:yaslf4j:jar:1.0.5:compile\n[INFO] +- org.junit.jupiter:junit-jupiter-api:jar:5.14.0:test\n[INFO] |  +- org.opentest4j:opentest4j:jar:1.3.0:test\n[INFO] |  +- org.junit.platform:junit-platform-commons:jar:1.14.0:test\n[INFO] |  \\- org.apiguardian:apiguardian-api:jar:1.1.2:test\n[INFO] +- org.junit.jupiter:junit-jupiter-engine:jar:5.14.0:test\n[INFO] |  \\- org.junit.platform:junit-platform-engine:jar:1.14.0:test\n[INFO] +- org.mockito:mockito-junit-jupiter:jar:5.11.0:test\n[INFO] |  \\- org.mockito:mockito-core:jar:5.11.0:test\n[INFO] |     +- net.bytebuddy:byte-buddy-agent:jar:1.17.8:test\n[INFO] |     \\- org.objenesis:objenesis:jar:3.3:test\n[INFO] +- org.assertj:assertj-core:jar:3.27.6:test\n[INFO] |  \\- net.bytebuddy:byte-buddy:jar:1.17.8:test\n[INFO] +- io.github.hakky54:logcaptor:jar:2.12.1:test\n[INFO] |  +- ch.qos.logback:logback-classic:jar:1.3.15:test\n[INFO] |  |  \\- ch.qos.logback:logback-core:jar:1.3.15:test\n[INFO] |  +- org.apache.logging.log4j:log4j-to-slf4j:jar:2.25.1:test\n[INFO] |  |  \\- org.apache.logging.log4j:log4j-api:jar:2.25.1:test\n[INFO] |  \\- org.slf4j:jul-to-slf4j:jar:2.0.17:test\n[INFO] +- io.github.hakky54:ssl-server:jar:1.0.8:test\n[INFO] |  +- io.netty:netty-codec-http:jar:4.2.4.Final:test\n[INFO] |  |  +- io.netty:netty-common:jar:4.2.4.Final:test\n[INFO] |  |  +- io.netty:netty-buffer:jar:4.2.4.Final:test\n[INFO] |  |  +- io.netty:netty-transport:jar:4.2.4.Final:test\n[INFO] |  |  |  \\- io.netty:netty-resolver:jar:4.2.4.Final:test\n[INFO] |  |  +- io.netty:netty-codec-base:jar:4.2.4.Final:test\n[INFO] |  |  +- io.netty:netty-codec-compression:jar:4.2.4.Final:test\n[INFO] |  |  \\- io.netty:netty-handler:jar:4.2.4.Final:test\n[INFO] |  |     \\- io.netty:netty-transport-native-unix-common:jar:4.2.4.Final:test\n[INFO] |  \\- org.bouncycastle:bcpkix-jdk18on:jar:1.82:test\n[INFO] |     \\- org.bouncycastle:bcutil-jdk18on:jar:1.82:test\n[INFO] |        \\- org.bouncycastle:bcprov-jdk18on:jar:1.82:test\n[INFO] \\- org.java-websocket:Java-WebSocket:jar:1.6.0:test\n[INFO]    \\- org.slf4j:slf4j-api:jar:2.0.13:test\n</code></pre>\n<p>slf4j-api is being provided as a transitive dependency via <code>ch.qos.logback:logback-core</code> which comes from <code>io.github.hakky54:logcaptor</code> and <code>org.java-websocket:Java-WebSocket</code> which are both marked as test scoped dependencies.</p>\n<p>When I run <code>mvn dependency:list</code> it also correctly shows that <code>slf4j-api</code> is present, see here:</p>\n<pre><code>[INFO] The following files have been resolved:\n[INFO]    io.github.hakky54:yaslf4j:jar:1.0.5:compile -- module nl.altindag.yaslf4j\n[INFO]    org.junit.jupiter:junit-jupiter-api:jar:5.14.0:test -- module org.junit.jupiter.api\n[INFO]    org.opentest4j:opentest4j:jar:1.3.0:test -- module org.opentest4j\n[INFO]    org.junit.platform:junit-platform-commons:jar:1.14.0:test -- module org.junit.platform.commons\n[INFO]    org.apiguardian:apiguardian-api:jar:1.1.2:test -- module org.apiguardian.api\n[INFO]    org.junit.jupiter:junit-jupiter-engine:jar:5.14.0:test -- module org.junit.jupiter.engine\n[INFO]    org.junit.platform:junit-platform-engine:jar:1.14.0:test -- module org.junit.platform.engine\n[INFO]    org.mockito:mockito-junit-jupiter:jar:5.11.0:test -- module org.mockito.junit.jupiter [auto]\n[INFO]    org.mockito:mockito-core:jar:5.11.0:test -- module org.mockito [auto]\n[INFO]    net.bytebuddy:byte-buddy-agent:jar:1.17.8:test -- module net.bytebuddy.agent\n[INFO]    org.objenesis:objenesis:jar:3.3:test -- module org.objenesis [auto]\n[INFO]    org.assertj:assertj-core:jar:3.27.6:test -- module org.assertj.core\n[INFO]    net.bytebuddy:byte-buddy:jar:1.17.8:test -- module net.bytebuddy\n[INFO]    io.github.hakky54:logcaptor:jar:2.12.1:test -- module nl.altindag.logcaptor\n[INFO]    ch.qos.logback:logback-classic:jar:1.3.15:test -- module ch.qos.logback.classic\n[INFO]    ch.qos.logback:logback-core:jar:1.3.15:test -- module ch.qos.logback.core\n[INFO]    org.apache.logging.log4j:log4j-to-slf4j:jar:2.25.1:test -- module org.apache.logging.log4j.to.slf4j\n[INFO]    org.apache.logging.log4j:log4j-api:jar:2.25.1:test -- module org.apache.logging.log4j\n[INFO]    org.slf4j:jul-to-slf4j:jar:2.0.17:test -- module jul.to.slf4j\n[INFO]    io.github.hakky54:ssl-server:jar:1.0.8:test -- module nl.altindag.ssl.server\n[INFO]    io.netty:netty-codec-http:jar:4.2.4.Final:test -- module io.netty.codec.http\n[INFO]    io.netty:netty-common:jar:4.2.4.Final:test -- module io.netty.common\n[INFO]    io.netty:netty-buffer:jar:4.2.4.Final:test -- module io.netty.buffer\n[INFO]    io.netty:netty-transport:jar:4.2.4.Final:test -- module io.netty.transport\n[INFO]    io.netty:netty-resolver:jar:4.2.4.Final:test -- module io.netty.resolver\n[INFO]    io.netty:netty-codec-base:jar:4.2.4.Final:test -- module io.netty.codec\n[INFO]    io.netty:netty-codec-compression:jar:4.2.4.Final:test -- module io.netty.codec.compression\n[INFO]    io.netty:netty-handler:jar:4.2.4.Final:test -- module io.netty.handler\n[INFO]    io.netty:netty-transport-native-unix-common:jar:4.2.4.Final:test -- module io.netty.transport.unix.common\n[INFO]    org.bouncycastle:bcpkix-jdk18on:jar:1.82:test -- module org.bouncycastle.pkix\n[INFO]    org.bouncycastle:bcutil-jdk18on:jar:1.82:test -- module org.bouncycastle.util\n[INFO]    org.bouncycastle:bcprov-jdk18on:jar:1.82:test -- module org.bouncycastle.provider\n[INFO]    org.java-websocket:Java-WebSocket:jar:1.6.0:test -- module org.java_websocket\n[INFO]    org.slf4j:slf4j-api:jar:2.0.13:test -- module org.slf4j\n</code></pre>\n<p>I am using <a href=\"https://github.com/Hakky54/yaslf4j\" rel=\"nofollow noreferrer\">yaslf4j</a> as logging api. Which tries to log to slf4j api, fallbacks to log4j2 api and if that is also absent it fallsback to java util logging. I am using this custom logging api so I don't enforce my end-user to use slf4j however, if they are using slf4j it will redirect to logs to slf4j. And the same goes for log4j2. And some end-users don't prefer to use a logging api at all and in that case it will log it to java util logger. The <a href=\"https://github.com/Hakky54/yaslf4j/blob/master/pom.xml#L66-L71\" rel=\"nofollow noreferrer\">pom</a> of yaslf4j has declared slf4j as provided scope, so it will not be included as a transitive dependency for anyone who will use it. The <a href=\"https://github.com/Hakky54/ayza\" rel=\"nofollow noreferrer\">ayza</a> library where I am encountering the issue is now logging to yaslf4j during the tests. Sfl4j api is present during the tests so yaslf4j it forwarding to slf4j-api. I am using <a href=\"https://github.com/Hakky54/log-captor\" rel=\"nofollow noreferrer\">log-captor</a> to captured these logs so I can do assertion on it however it fails to create the logger as it is saying: <code>java.lang.NoClassDefFoundError: org/slf4j/LoggerFactory</code></p>\n<p>The strange part is when I am running <code>mvn clean install</code> from the terminal it works. When I am running the test from intellij as shown below it fails</p>\n<p><a href=\"https://i.sstatic.net/3WN9HwlD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/3WN9HwlD.png\" alt=\"intellij test runner\" /></a></p>\n<p><strong>How to reproduce?</strong></p>\n<ol>\n<li>run <code>git clone https://github.com/Hakky54/ayza.git</code></li>\n<li>run <code>git switch feature/make-slf4j-logger-optional</code></li>\n<li>ensure java 11 or above is configured</li>\n<li>run <code>mvn clean install</code></li>\n</ol>\n<p>Analyse the build result as it will show it has been build sucessfull.</p>\n<ol start=\"5\">\n<li>Open project from Intellij IDEA</li>\n<li>Run test from the explorer as shown from the screenshot above</li>\n</ol>\n<p>The test will fail</p>\n<p>Looking into the maven dependency tree, maven dependency list and the dependency declarations in the pom it gives me the feeling that everything is ok. Running it in the terminal confirms that it works as expected. So my feeling is saying that intellij has trouble resolving the dependencies, but I am not sure. Does someone know what I might have done wrong or should I configure intellij differently? As a side note, I did run invalidate caches. I have tried it on Mac OS and Linux/pop os getting the same failures.</p>\n",
    "tags" : [ "java", "maven", "intellij-idea", "slf4j", "maven-surefire-plugin" ],
    "owner" : {
      "account_id" : 9107988,
      "reputation" : 4077,
      "user_id" : 6777695,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/82120153a9fce415fd4983897d45d441?s=256&d=identicon&r=PG",
      "display_name" : "Hakan54",
      "link" : "https://stackoverflow.com/users/6777695/hakan54"
    },
    "is_answered" : true,
    "view_count" : 125,
    "answer_count" : 2,
    "score" : 0,
    "last_activity_date" : 1761814908,
    "creation_date" : 1760605414,
    "link" : "https://stackoverflow.com/questions/79791962/noclassdeffounderror-org-slf4j-loggerfactory-when-running-in-intellij-but-works",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79792161,
    "question_id" : 79791962,
    "body" : "<p>Try to include an implementation with the API:</p>\n<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n    &lt;artifactId&gt;slf4j-simple&lt;/artifactId&gt;\n    &lt;version&gt;2.0.13&lt;/version&gt;\n    &lt;scope&gt;test&lt;/scope&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>Also it's a good practice to always include the used dependencies in the pom file, even though you have them as transitive.</p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 41881735,
      "reputation" : 1,
      "user_id" : 30493645,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/rEAMUmEk.png?s=256",
      "display_name" : "Abdessamad Zouiten",
      "link" : "https://stackoverflow.com/users/30493645/abdessamad-zouiten"
    },
    "creation_date" : 1760618618,
    "last_activity_date" : 1761685679,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79792462,
    "question_id" : 79791962,
    "body" : "<p>The solution was to disable the module path as shown in the screenshot below.</p>\n<p><a href=\"https://i.sstatic.net/Jp7u8462.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/Jp7u8462.png\" alt=\"enter image description here\" /></a></p>\n",
    "score" : 0,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 9107988,
      "reputation" : 4077,
      "user_id" : 6777695,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/82120153a9fce415fd4983897d45d441?s=256&d=identicon&r=PG",
      "display_name" : "Hakan54",
      "link" : "https://stackoverflow.com/users/6777695/hakan54"
    },
    "creation_date" : 1760639266,
    "last_activity_date" : 1761814908,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140799996,
    "post_id" : 79791962,
    "body" : "@CrazyCoder I created a bug report here: <a href=\"https://youtrack.jetbrains.com/issue/IDEA-380831/NoClassDefFoundError-org-slf4j-LoggerFactory-when-running-in-Intellij-but-works-fine-from-the-command-line\" rel=\"nofollow noreferrer\">youtrack.jetbrains.com/issue/IDEA-380831/&hellip;</a>",
    "score" : 1,
    "owner" : {
      "account_id" : 9107988,
      "reputation" : 4077,
      "user_id" : 6777695,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/82120153a9fce415fd4983897d45d441?s=256&d=identicon&r=PG",
      "display_name" : "Hakan54",
      "link" : "https://stackoverflow.com/users/6777695/hakan54"
    },
    "creation_date" : 1760626632,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140799965,
    "post_id" : 79791962,
    "body" : "Please file a bug at <a href=\"https://youtrack.jetbrains.com/newIssue?project=IDEA\" rel=\"nofollow noreferrer\">youtrack.jetbrains.com/newIssue?project=IDEA</a>.",
    "score" : 0,
    "owner" : {
      "account_id" : 36734,
      "reputation" : 405100,
      "user_id" : 104891,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/0ff652685122f4500dd4f3c21fb32da2?s=256&d=identicon&r=PG",
      "display_name" : "CrazyCoder",
      "link" : "https://stackoverflow.com/users/104891/crazycoder"
    },
    "creation_date" : 1760625716,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140799408,
    "post_id" : 79791962,
    "body" : "Logback 1.3 is old and should use SLF4J 1.7, you have included 2.0. So likely this is an issue with IntellIJ / CLI using different resolution mechanisms resulting in a differelt slf4j-api version being included.",
    "score" : 0,
    "owner" : {
      "account_id" : 3192259,
      "reputation" : 126800,
      "user_id" : 2696260,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/qHEzx.png?s=256",
      "display_name" : "M. Deinum",
      "link" : "https://stackoverflow.com/users/2696260/m-deinum"
    },
    "creation_date" : 1760614156,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79792161" : [ {
      "comment_id" : 140799837,
      "post_id" : 79792161,
      "body" : "I can&#39;t include <code>slf4j-simple</code> as logback is already included as slf4j-api implementation",
      "score" : 0,
      "owner" : {
        "account_id" : 9107988,
        "reputation" : 4077,
        "user_id" : 6777695,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/82120153a9fce415fd4983897d45d441?s=256&d=identicon&r=PG",
        "display_name" : "Hakan54",
        "link" : "https://stackoverflow.com/users/6777695/hakan54"
      },
      "creation_date" : 1760623362,
      "content_license" : "CC BY-SA 4.0"
    } ],
    "79792462" : [ {
      "comment_id" : 140826616,
      "post_id" : 79792462,
      "body" : "Sure, it make sense indeed. Thank you @Gimby Not quite sure why they wanted a bug report on their page though. They could have helped me at stackoverflow",
      "score" : 0,
      "owner" : {
        "account_id" : 9107988,
        "reputation" : 4077,
        "user_id" : 6777695,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/82120153a9fce415fd4983897d45d441?s=256&d=identicon&r=PG",
        "display_name" : "Hakan54",
        "link" : "https://stackoverflow.com/users/6777695/hakan54"
      },
      "creation_date" : 1761814878,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140824650,
      "post_id" : 79792462,
      "body" : "Next time... at least give it a day or two before going on the &quot;it&#39;s a bug!&quot; trajectory. Don&#39;t let yourself be triggered to do things prematurely by people in comments.",
      "score" : 0,
      "owner" : {
        "account_id" : 187094,
        "reputation" : 5301,
        "user_id" : 424903,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/8oHZF.png?s=256",
        "display_name" : "Gimby",
        "link" : "https://stackoverflow.com/users/424903/gimby"
      },
      "creation_date" : 1761735684,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}