{
  "question" : {
    "question_id" : 79598615,
    "title" : "Binding binary expressions in FXML",
    "body" : "<p>From the docs it seems like it should be possible to use simple expressions when calculating Element properties but it always seems to give errors. Is the syntax here correct and is there any more guidance available?</p>\n<p>A small example (this is based on the <code>javafx-archetype-fxml</code> linked to from <a href=\"https://openjfx.io/openjfx-docs/#maven\" rel=\"nofollow noreferrer\">here</a>):</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n\n&lt;?import javafx.scene.layout.VBox?&gt;\n&lt;?import javafx.scene.control.Label?&gt;\n&lt;?import javafx.scene.control.Button?&gt;\n&lt;?import javafx.scene.control.TextField?&gt;\n&lt;?import javafx.geometry.Insets?&gt;\n\n&lt;VBox alignment=&quot;CENTER&quot; spacing=&quot;20.0&quot; xmlns=&quot;http://javafx.com/javafx/8.0.171&quot; xmlns:fx=&quot;http://javafx.com/fxml/1&quot; fx:controller=&quot;com.nowhere.PrimaryController&quot;&gt;\n    &lt;children&gt;\n        &lt;!-- WORKS --&gt;\n        &lt;Label text=&quot;${source.length}&quot; /&gt;\n        &lt;!-- ERROR --&gt;\n        &lt;Label text=&quot;${source.length*2}&quot; /&gt;\n        &lt;Button fx:id=&quot;primaryButton&quot; text=&quot;Switch to Secondary View&quot; onAction=&quot;#switchToSecondary&quot;/&gt;\n        &lt;TextField fx:id=&quot;source&quot; /&gt;\n    &lt;/children&gt;\n    &lt;padding&gt;\n        &lt;Insets bottom=&quot;20.0&quot; left=&quot;20.0&quot; right=&quot;20.0&quot; top=&quot;20.0&quot; /&gt;\n    &lt;/padding&gt;\n&lt;/VBox&gt;\n</code></pre>\n<p>This is intended to update the Label text with the length of text in the TextField (this is just as an example)</p>\n<p>A single variable <code>${source.length}</code> is OK but an expression <code>${source.length*2}</code> is not. It seems that any binary or unary expression is problematic.</p>\n<p>The error I see includes this stack trace:</p>\n<pre class=\"lang-none prettyprint-override\"><code>Caused by: java.lang.NullPointerException: Cannot invoke &quot;java.lang.Number.longValue()&quot; because &quot;&lt;parameter1&gt;&quot; is null\n    at javafx.fxml@24.0.1/com.sun.javafx.fxml.expression.Expression.lambda$multiply$2(Expression.java:932)\n    at javafx.fxml@24.0.1/com.sun.javafx.fxml.expression.BinaryExpression.evaluate(BinaryExpression.java:55)\n    at javafx.fxml@24.0.1/com.sun.javafx.fxml.expression.ExpressionValue.getValue(ExpressionValue.java:191)\n    at javafx.base@24.0.1/com.sun.javafx.binding.ExpressionHelper.addListener(ExpressionHelper.java:64)\n    at javafx.base@24.0.1/javafx.beans.value.ObservableValueBase.addListener(ObservableValueBase.java:57)\n    at javafx.fxml@24.0.1/com.sun.javafx.fxml.expression.ExpressionValue.addListener(ExpressionValue.java:200)\n    at javafx.base@24.0.1/javafx.beans.property.StringPropertyBase.bind(StringPropertyBase.java:171)\n    at javafx.fxml@24.0.1/javafx.fxml.FXMLLoader$Element.processPropertyAttribute(FXMLLoader.java:318)\n    at javafx.fxml@24.0.1/javafx.fxml.FXMLLoader$Element.processInstancePropertyAttributes(FXMLLoader.java:235)\n    at javafx.fxml@24.0.1/javafx.fxml.FXMLLoader$ValueElement.processEndElement(FXMLLoader.java:767)\n    at javafx.fxml@24.0.1/javafx.fxml.FXMLLoader.processEndElement(FXMLLoader.java:2939)\n    at javafx.fxml@24.0.1/javafx.fxml.FXMLLoader.loadImpl(FXMLLoader.java:2624)\n    ... 11 more\n</code></pre>\n<p>In the source for <code>com.sun.javafx.binding.ExpressionHelper</code> (line 64) it looks like <code>addListener</code> tries to get the value of the observable (comment says &quot;validate observable&quot;) but at this point the TextField has not been fully created and therefore its length evaluates to null, and the binary expression null * 2 fails. That's my understanding, could be wrong.</p>\n<p>I'm using Java 23 and JFX 24.0.1.</p>\n",
    "tags" : [ "java", "javafx" ],
    "owner" : {
      "account_id" : 82504,
      "reputation" : 7149,
      "user_id" : 231929,
      "user_type" : "registered",
      "accept_rate" : 88,
      "profile_image" : "https://www.gravatar.com/avatar/c3f49f314384bc17f0af6fc6c2246300?s=256&d=identicon&r=PG",
      "display_name" : "Peter Hull",
      "link" : "https://stackoverflow.com/users/231929/peter-hull"
    },
    "is_answered" : true,
    "view_count" : 86,
    "answer_count" : 1,
    "score" : 3,
    "last_activity_date" : 1745937363,
    "creation_date" : 1745936791,
    "link" : "https://stackoverflow.com/questions/79598615/binding-binary-expressions-in-fxml",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79598634,
    "question_id" : 79598615,
    "body" : "<p>I think your analysis is correct; in my opinion this is a bug.</p>\n<p>You can workaround this by defining the text field before you reference it in the FXML, using <code>&lt;fx:define&gt;</code> and <code>&lt;fx:reference&gt;</code>:</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n\n&lt;?import javafx.scene.layout.VBox?&gt;\n&lt;?import javafx.scene.control.Label?&gt;\n&lt;?import javafx.scene.control.Button?&gt;\n&lt;?import javafx.scene.control.TextField?&gt;\n&lt;?import javafx.geometry.Insets?&gt;\n\n&lt;VBox alignment=&quot;CENTER&quot; spacing=&quot;20.0&quot; xmlns=&quot;http://javafx.com/javafx/8.0.171&quot; xmlns:fx=&quot;http://javafx.com/fxml/1&quot; fx:controller=&quot;org.jamesd.examples.exprbinding.PrimaryController&quot;&gt;\n    &lt;fx:define&gt;&lt;TextField fx:id=&quot;source&quot; /&gt;&lt;/fx:define&gt;\n    &lt;children&gt;\n        &lt;!-- WORKS --&gt;\n        &lt;Label text=&quot;${source.length}&quot; /&gt;\n        &lt;!-- NOW ALSO WORKING --&gt;\n        &lt;Label text=&quot;${source.length*2}&quot; /&gt;\n        &lt;Button fx:id=&quot;primaryButton&quot; text=&quot;Switch to Secondary View&quot; onAction=&quot;#switchToSecondary&quot;/&gt;\n        &lt;fx:reference source=&quot;source&quot; /&gt;\n    &lt;/children&gt;\n    &lt;padding&gt;\n        &lt;Insets bottom=&quot;20.0&quot; left=&quot;20.0&quot; right=&quot;20.0&quot; top=&quot;20.0&quot; /&gt;\n    &lt;/padding&gt;\n&lt;/VBox&gt;\n</code></pre>\n",
    "score" : 4,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 2518243,
      "reputation" : 210906,
      "user_id" : 2189127,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/e8e6e627b4b90ec816c5c7aa04cbcc26?s=256&d=identicon&r=PG",
      "display_name" : "James_D",
      "link" : "https://stackoverflow.com/users/2189127/james-d"
    },
    "creation_date" : 1745937363,
    "last_activity_date" : 1745937363,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : {
    "79598634" : [ {
      "comment_id" : 140382196,
      "post_id" : 79598634,
      "body" : "A <a href=\"https://stackoverflow.com/a/23706030/1155209\">similar example using <code>fx:define</code></a>, but for a non-UI data holder, so it does not also use the <code>fx:reference</code>.",
      "score" : 2,
      "owner" : {
        "account_id" : 1180113,
        "reputation" : 160457,
        "user_id" : 1155209,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/5192e7cbcf2f72a847d6fb0d1552f049?s=256&d=identicon&r=PG",
        "display_name" : "jewelsea",
        "link" : "https://stackoverflow.com/users/1155209/jewelsea"
      },
      "creation_date" : 1745973279,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140381586,
      "post_id" : 79598634,
      "body" : "@PeterHull FXML is, in many ways, incomplete. For instance, basic bidirectional binding via FXML has yet to be implemented. And it doesn&#39;t seem to get much development relative to other parts of JavaFX (see bug database). Though that&#39;s not terribly surprising. Things like rendering performance, bugs in graphics/controls, and so on are more important. Plus, FXML works &quot;well enough&quot;; many bugs and not-yet-implemented enhancement requests can be worked around within a controller class.",
      "score" : 2,
      "owner" : {
        "account_id" : 8532578,
        "reputation" : 49884,
        "user_id" : 6395627,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/af0f9bfe593f36642a032cd7ea611e7d?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "Slaw",
        "link" : "https://stackoverflow.com/users/6395627/slaw"
      },
      "creation_date" : 1745955240,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140380632,
      "post_id" : 79598634,
      "body" : "&quot;NOW ALSO WORKING&quot; great. The archetype actually installs JFX 13 as a dependency which shows the same behaviour, so if it&#39;s a bug, it is a long-standing one.",
      "score" : 0,
      "owner" : {
        "account_id" : 82504,
        "reputation" : 7149,
        "user_id" : 231929,
        "user_type" : "registered",
        "accept_rate" : 88,
        "profile_image" : "https://www.gravatar.com/avatar/c3f49f314384bc17f0af6fc6c2246300?s=256&d=identicon&r=PG",
        "display_name" : "Peter Hull",
        "link" : "https://stackoverflow.com/users/231929/peter-hull"
      },
      "creation_date" : 1745938427,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}