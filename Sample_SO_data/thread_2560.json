{
  "question" : {
    "question_id" : 79612173,
    "title" : "application properties not loaded when using AnnotationConfigApplicationContext",
    "body" : "<p>I have a Spring Boot application that works fine. Its entry point is:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@SpringBootApplication(scanBasePackageClasses = {MyServicesConfiguration.class})\npublic class MyTestApplication {\n    public static void main(String[] args) {\n        new SpringApplicationBuilder(MyTestApplication.class)\n                .web(WebApplicationType.NONE)\n                .initializers(new ImportantContextInitializer())\n                .run(args);\n    }\n}\n</code></pre>\n<p>The <code>MyServicesConfiguration</code> is at the top of the package hierarchy, so <code>@ComponentScan</code> is able to find all <code>@Service</code> and <code>@Component</code> objects below:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Configuration\n@ComponentScan\n@EnableConfigurationProperties\npublic class MyServicesConfiguration {\n    @Bean\n    public ImportantBean getImportantBean(MyConfiguration configuration) {\n        return new ImportantBean(configuration);\n    }\n</code></pre>\n<p>Finally, the configuration properties class:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Component\n@ConfigurationProperties(prefix = &quot;my.configuration&quot;)\npublic class MvConfiguration {\n   private Integer aNumber;\n   private String aString;\n\n   // Public setters and getters are here\n}\n</code></pre>\n<p>There is a <code>application.yml</code> file at the top of the <code>resources</code> folder, as usual in <em>Spring</em>. When I launch <code>MyTestApplication</code>, it works as intended. Beans are initialized and properties are populated.</p>\n<p>I have another use case where I need to explicitly load the exact same context. For that I use <code>AnnotationConfigApplicationContext</code> like below:</p>\n<pre class=\"lang-java prettyprint-override\"><code>    AnnotationConfigApplicationContext ctx = new AnnotationConfigApplicationContext();\n    // ctx.register(MyServicesConfiguration.class); // Also tried this\n    ctx.register(MyTestApplication.class);\n    ctx.refresh();\n</code></pre>\n<p>I've got two questions:</p>\n<ul>\n<li>Executing <code>ctx.refresh</code> eventually fails because because property beans like <code>MyConfiguration</code> are instantiated but their properties are not set - <code>ImportantBean</code> receives a non-null <code>configuration</code>, but all properties of <code>configuration</code> are null.</li>\n<li>I also wonder how to make <code>AnnotationConfigApplicationContext</code> know about context initializers like <code>ImportantContextInitializer</code>.</li>\n</ul>\n",
    "tags" : [ "java", "spring" ],
    "owner" : {
      "account_id" : 2426974,
      "reputation" : 1261,
      "user_id" : 2118693,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/vVRBY.jpg?s=256",
      "display_name" : "jmgonet",
      "link" : "https://stackoverflow.com/users/2118693/jmgonet"
    },
    "is_answered" : false,
    "view_count" : 68,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1746702151,
    "creation_date" : 1746700017,
    "link" : "https://stackoverflow.com/questions/79612173/application-properties-not-loaded-when-using-annotationconfigapplicationcontext",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79612229,
    "question_id" : 79612173,
    "body" : "<p>To make sure that properties from <code>application.yml</code> or <code>application.properties</code> are loaded correctly, you need to use <code>SpringApplication</code> or <code>SpringApplicationBuilder</code>, because <code>AnnotationConfigApplicationContext</code> alone doesn't provide that functionality.</p>\n<p>If you must use <code>AnnotationConfigApplicationContext</code>, you can try to use Spring Bootâ€™s built-in application context to leverage all its defaults, including property loading:</p>\n<pre><code>ApplicationContext ctx = new SpringApplicationBuilder(MyTestApplication.class) \n    .web(WebApplicationType.NONE) \n    .initializers(new ImportantContextInitializer()) \n    .run();\n</code></pre>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 41805186,
      "reputation" : 104,
      "user_id" : 30456909,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/DvzmO04E.jpg?s=256",
      "display_name" : "jialin.zhou",
      "link" : "https://stackoverflow.com/users/30456909/jialin-zhou"
    },
    "creation_date" : 1746702151,
    "last_activity_date" : 1746702151,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : {
    "79612229" : [ {
      "comment_id" : 140407525,
      "post_id" : 79612229,
      "body" : "Well... the whole idea of having a <code>AnnotationConfigApplicationContext</code> was to avoid calling <code>SpringApplicationBuilder.run</code> because I don&#39;t want to launch the main application.",
      "score" : 0,
      "owner" : {
        "account_id" : 2426974,
        "reputation" : 1261,
        "user_id" : 2118693,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/vVRBY.jpg?s=256",
        "display_name" : "jmgonet",
        "link" : "https://stackoverflow.com/users/2118693/jmgonet"
      },
      "creation_date" : 1746706590,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}