{
  "question" : {
    "question_id" : 79571233,
    "title" : "How to add a directory to classpath from a gradle plugin?",
    "body" : "<p>I have a task which creates a directory within build-directory. There is one file within the directory. I am trying to add that directory to classpath from within a gradle plugin written in java.</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class Myplugin implements Plugin&lt;Project&gt; {\n    @Override\n    public void apply(Project target) {\n        SourceSetContainer sourceSetContainer = target.getExtensions().getByType(SourceSetContainer.class);\n        SourceSet main = sourceSetContainer.findByName(&quot;main&quot;);\n        assert main != null;\n        // Next line is adding 'my-directory' to the classpath\n        main.setRuntimeClasspath(main.getRuntimeClasspath().plus(target.getLayout().getBuildDirectory().dir(&quot;my-directory&quot;).get().getAsFileTree()));\n    }\n}\n</code></pre>\n<p>This results in classpath like this (notice the last line):</p>\n<pre><code>/Users/MYUSER/git/my-repo/build/classes/java/main, \n/Users/MYUSER/git/my-repo/build/classes/kotlin/main, \n/Users/MYUSER/git/my-repo/build/classes/groovy/main, \n/Users/MYUSER/git/my-repo/build/tmp/kapt3/classes/main, \n/Users/MYUSER/git/my-repo/build/resources/main, \n... Bunch of JAR  files ...\n/Users/MYUSER/git/my-repo/build/my-directory/my-file.yml   &lt;-----\n</code></pre>\n<p>However I want just want the directory to appear in the classpath, not the files within it. Something like this:</p>\n<pre><code>/Users/MYUSER/git/my-repo/build/classes/java/main, \n/Users/MYUSER/git/my-repo/build/classes/kotlin/main, \n/Users/MYUSER/git/my-repo/build/classes/groovy/main, \n/Users/MYUSER/git/my-repo/build/tmp/kapt3/classes/main, \n/Users/MYUSER/git/my-repo/build/resources/main, \n... Bunch of JAR  files ...\n/Users/MYUSER/git/my-repo/build/my-directory   &lt;-----\n</code></pre>\n<p>How to achieve this?</p>\n",
    "tags" : [ "java", "gradle", "classpath", "gradle-plugin" ],
    "owner" : {
      "account_id" : 21012443,
      "reputation" : 237,
      "user_id" : 15440747,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/61b5e0f423853a8979ca2a8acfcbb8ab?s=256&d=identicon&r=PG",
      "display_name" : "devxgb",
      "link" : "https://stackoverflow.com/users/15440747/devxgb"
    },
    "is_answered" : true,
    "view_count" : 39,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1744637319,
    "creation_date" : 1744523307,
    "link" : "https://stackoverflow.com/questions/79571233/how-to-add-a-directory-to-classpath-from-a-gradle-plugin",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79573260,
    "question_id" : 79571233,
    "body" : "<p>Below is the code, to add /build/my-directory/ as a directory entry to the classpath.</p>\n<pre><code>main.setRuntimeClasspath(\n    main.getRuntimeClasspath().plus(\n        target.files(target.getLayout().getBuildDirectory().dir(&quot;my-directory&quot;))\n    )\n);\n</code></pre>\n<p>The issue with getAsFileTree() in the problem is, it adds each file in the directory to the classpath.</p>\n",
    "score" : 2,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 7645025,
      "reputation" : 440,
      "user_id" : 5795975,
      "user_type" : "registered",
      "profile_image" : "https://lh6.googleusercontent.com/-6KwPUS4RnyA/AAAAAAAAAAI/AAAAAAAAC8w/auZqreI45x0/s256-rj/photo.jpg",
      "display_name" : "Vijay",
      "link" : "https://stackoverflow.com/users/5795975/vijay"
    },
    "creation_date" : 1744637319,
    "last_activity_date" : 1744637319,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140331767,
    "post_id" : 79571233,
    "body" : "@Vijay Works like a charm. Does exactly what I wanted. Thank you very much. You may post the comment as answer.",
    "score" : 1,
    "owner" : {
      "account_id" : 21012443,
      "reputation" : 237,
      "user_id" : 15440747,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/61b5e0f423853a8979ca2a8acfcbb8ab?s=256&d=identicon&r=PG",
      "display_name" : "devxgb",
      "link" : "https://stackoverflow.com/users/15440747/devxgb"
    },
    "creation_date" : 1744616436,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140330237,
    "post_id" : 79571233,
    "body" : "Can you try target.files(target.getLayout().getBuildDirectory().dir(&quot;my-&zwnj;&#8203;directory&quot;)) .",
    "score" : 0,
    "owner" : {
      "account_id" : 7645025,
      "reputation" : 440,
      "user_id" : 5795975,
      "user_type" : "registered",
      "profile_image" : "https://lh6.googleusercontent.com/-6KwPUS4RnyA/AAAAAAAAAAI/AAAAAAAAC8w/auZqreI45x0/s256-rj/photo.jpg",
      "display_name" : "Vijay",
      "link" : "https://stackoverflow.com/users/5795975/vijay"
    },
    "creation_date" : 1744557823,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}