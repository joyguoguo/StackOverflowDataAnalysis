{
  "question" : {
    "question_id" : 79652553,
    "title" : "Asserting Mono completion softly",
    "body" : "<p>Suppose I need to softly assert against multiple object properties, one of which is a <code>Mono</code>. Typically, you use <code>StepVerifier</code> to assert against that. However, the <code>verifyComplete()</code> call will not be soft. In case the hard assertion fails, previous &quot;soft&quot; assertion errors will not be displayed.</p>\n<p>How do I achieve my goal and retain all the assertion errors?</p>\n<pre class=\"lang-java prettyprint-override\"><code>import org.junit.jupiter.api.Test;\nimport reactor.core.publisher.Mono;\nimport reactor.test.StepVerifier;\n\nimport static org.assertj.core.api.SoftAssertions.assertSoftly;\n\npublic class SoftAssertionTest {\n\n    @Test\n    void testSoftAssertion() {\n        Mono&lt;String&gt; stringMono = Mono.just(&quot;some value&quot;);\n        SomeObject someObject = new SomeObject(42, stringMono);\n        assertSoftly(soft -&gt; {\n            soft.assertThat(someObject.anInt()).isEqualTo(24); // this is soft\n            StepVerifier.create(someObject.stringMono())\n                    .verifyComplete(); // but this is hard, hogs all the attention\n        });\n    }\n\n    record SomeObject(int anInt, Mono&lt;String&gt; stringMono) {}\n}\n</code></pre>\n",
    "tags" : [ "java", "project-reactor", "assertj" ],
    "owner" : {
      "account_id" : 10187542,
      "reputation" : 2681,
      "user_id" : 20692967,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/NZSXm.jpg?s=256",
      "display_name" : "Sergey Zolotarev",
      "link" : "https://stackoverflow.com/users/20692967/sergey-zolotarev"
    },
    "is_answered" : true,
    "view_count" : 178,
    "answer_count" : 2,
    "score" : -2,
    "last_activity_date" : 1749450314,
    "creation_date" : 1749031769,
    "link" : "https://stackoverflow.com/questions/79652553/asserting-mono-completion-softly",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79653506,
    "question_id" : 79652553,
    "body" : "<p>You could try wrapping the StepVerifier call inside the <a href=\"https://www.javadoc.io/static/org.assertj/assertj-core/4.0.0-M1/org.assertj.core/org/assertj/core/api/AbstractAssert.html#satisfies(java.util.function.Consumer...)\" rel=\"nofollow noreferrer\"><code>satisfies</code></a> assertion, something like:</p>\n<pre class=\"lang-java prettyprint-override\"><code> assertSoftly(soft -&gt; {\n            soft.assertThat(someObject.anInt()).isEqualTo(24);\n            soft.assertThat(someObject).satisfies(obj -&gt; StepVerifier.create(obj.stringMono()).verifyComplete());\n            // or \n            // soft.assertThat(someObject.stringMono()).satisfies(strMono -&gt; StepVerifier.create(strMono).verifyComplete());\n\n        });\n</code></pre>\n<p>I'm assuming here that <code>StepVerifier.create(obj.stringMono()).verifyComplete()</code> is throwing an <code>AssertionError</code>.</p>\n",
    "score" : 2,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 1407336,
      "reputation" : 7309,
      "user_id" : 1348834,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/cca907a8681a3bdf665a604d316fae00?s=256&d=identicon&r=PG",
      "display_name" : "Joel Costigliola",
      "link" : "https://stackoverflow.com/users/1348834/joel-costigliola"
    },
    "creation_date" : 1749071483,
    "last_activity_date" : 1749071483,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79653463,
    "question_id" : 79652553,
    "body" : "<p>Try with this</p>\n<pre><code>@Test\nvoid testSoftAssertion() {\n    Mono&lt;String&gt; stringMono = Mono.just(&quot;some value&quot;);\n    SomeObject someObject = new SomeObject(42, stringMono);\n\n    SoftAssertions.assertSoftly(soft -&gt; {\n        soft.assertThat(someObject.anInt()).isEqualTo(24); // causing it to fail\n\n        StepVerifier.create(someObject.stringMono())\n                .consumeNextWith(value -&gt;\n                        soft.assertThat(value).isEqualTo(&quot;another value&quot;) // causing it to fail\n                )\n                .verifyComplete();\n        //without verifyComplete()\n        //soft.assertThat(someObject.stringMono().block()).isEqualTo(&quot;another value&quot;);\n\n\n    });\n}\n\nrecord SomeObject(int anInt, Mono&lt;String&gt; stringMono) {}\n</code></pre>\n<p><a href=\"https://i.sstatic.net/Kng26WPG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/Kng26WPG.png\" alt=\"enter image description here\" /></a></p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 9808985,
      "reputation" : 194,
      "user_id" : 7267818,
      "user_type" : "registered",
      "accept_rate" : 57,
      "profile_image" : "https://i.sstatic.net/xDbzS.jpg?s=256",
      "display_name" : "0x52",
      "link" : "https://stackoverflow.com/users/7267818/0x52"
    },
    "creation_date" : 1749069637,
    "last_activity_date" : 1749108074,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140486628,
    "post_id" : 79652553,
    "body" : "@AndrewS it&#39;s impractical",
    "score" : 0,
    "owner" : {
      "account_id" : 10187542,
      "reputation" : 2681,
      "user_id" : 20692967,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/NZSXm.jpg?s=256",
      "display_name" : "Sergey Zolotarev",
      "link" : "https://stackoverflow.com/users/20692967/sergey-zolotarev"
    },
    "creation_date" : 1749041628,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140486587,
    "post_id" : 79652553,
    "body" : "Make that two different tests?",
    "score" : 0,
    "owner" : {
      "account_id" : 8909811,
      "reputation" : 2861,
      "user_id" : 6650475,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/fe85994d05ad7aaaa1c47d638b37bc45?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Andrew S",
      "link" : "https://stackoverflow.com/users/6650475/andrew-s"
    },
    "creation_date" : 1749040835,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79653463" : [ {
      "comment_id" : 140497620,
      "post_id" : 79653463,
      "body" : "@sergey-zolotarev and what Joel wrote to you, I understand is valid for you, and use verifyComplete as well, it is necessary, or else, replace it with the block operator, Now simply include the use of block by verifyComplete, but the most correct thing to do is to use verifyComplete.",
      "score" : 0,
      "owner" : {
        "account_id" : 9808985,
        "reputation" : 194,
        "user_id" : 7267818,
        "user_type" : "registered",
        "accept_rate" : 57,
        "profile_image" : "https://i.sstatic.net/xDbzS.jpg?s=256",
        "display_name" : "0x52",
        "link" : "https://stackoverflow.com/users/7267818/0x52"
      },
      "creation_date" : 1749409571,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140488896,
      "post_id" : 79653463,
      "body" : "<code>verifyComplete()</code> is still hard",
      "score" : 0,
      "owner" : {
        "account_id" : 10187542,
        "reputation" : 2681,
        "user_id" : 20692967,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/NZSXm.jpg?s=256",
        "display_name" : "Sergey Zolotarev",
        "link" : "https://stackoverflow.com/users/20692967/sergey-zolotarev"
      },
      "creation_date" : 1749095624,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}