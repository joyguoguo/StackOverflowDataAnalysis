{
  "question" : {
    "question_id" : 79581147,
    "title" : "Displaying a JavaFX Popup on a Swing app in cross-platform manner",
    "body" : "<p>Before all of the commenters start saying &quot;Just don't mix Swing and JavaFX&quot;, yeah I know, I know. It has caused us a lot of problems over the years but my team has a ton of swing code and we really don't have budget to re-write it all in JavaFX. We're trying to gradually transition portions of our code to JavaFX over time.</p>\n<p>Years ago I wrote a nice JavaFX utility that I use in several different applications that shows a little popup warnings in the bottom right corner of an application. It has a lot of cool features, which are pretty JavaFX dependent.</p>\n<p>I also wrote some code that allowed our team to use these warnings in Swing applications. It does this by making an invisible JavaFX stage to own the popups (since popups can't display without an owner window).</p>\n<p>I've been happy with the code for years, but only recently tried running it on Linux for the first time. It turns out that on Linux, my invisible stage is not invisible and I can't find any way to make it go away. I guess it's not the end of the world if there's a little empty stage, but it's pretty annoying and I'd like to get rid of it. I've tested on Ubuntu with both LXDE and Gnome.</p>\n<p>The full code for my warning popups is more than I'd like to post here, but here's a minimum reproducible example of displaying a JavaFX popup in a Swing app. It works fine in Windows, but in Linux, the dummy stage is visible and has its own icon in the task bar.</p>\n<pre class=\"lang-java prettyprint-override\"><code>import java.awt.Dimension;\nimport java.lang.reflect.InvocationTargetException;\n\nimport javax.swing.JButton;\nimport javax.swing.JFrame;\nimport javax.swing.JPanel;\nimport javax.swing.SwingUtilities;\n\nimport javafx.application.Platform;\nimport javafx.embed.swing.JFXPanel;\nimport javafx.scene.Scene;\nimport javafx.scene.control.Label;\nimport javafx.scene.layout.Pane;\nimport javafx.stage.Popup;\nimport javafx.stage.Stage;\nimport javafx.stage.StageStyle;\n\npublic class FxOnSwingProblemDemo extends JFrame {\n\n    private Stage dummyStage;\n    \n    public FxOnSwingProblemDemo() {\n        \n        initializeFxToolkit();\n        \n        JButton button = new JButton(&quot;Show popup&quot;);\n        \n        button.addActionListener(e -&gt; \n            Platform.runLater(() -&gt; {\n                Popup popup = new Popup();\n                popup.getContent().add(new Label(&quot;Hey look, a popup!&quot;));\n                popup.show(getDummyStage());\n            })\n        );\n        \n        JPanel root = new JPanel();\n        root.add(button);\n        \n        this.add(root);\n        this.setPreferredSize(new Dimension(500, 500));\n        this.pack();\n        //Note exit on close is important here to kill the FX Platform thread\n        this.setDefaultCloseOperation(EXIT_ON_CLOSE);\n        this.setVisible(true);\n    }\n    \n    private void initializeFxToolkit() {\n        Platform.setImplicitExit(false);\n        try {\n            SwingUtilities.invokeAndWait(JFXPanel::new);\n        } catch (InvocationTargetException e) {\n            e.printStackTrace();\n        } catch (InterruptedException e) {\n            Thread.currentThread().interrupt();\n        }\n    }\n    \n    private Stage getDummyStage() {\n        if(dummyStage == null) {\n\n          //Utility prevents icon from showing up on windows task bar\n          dummyStage = new Stage(StageStyle.UTILITY);\n          dummyStage.setScene(new Scene(new Pane()));\n          //Note, setting the width and height to very small numbers (so far tested with 0.1, 1, and 2)\n          //will result in GTK warnings that can't be suppressed printing to stderr on at least\n          //some linux environments. So we'll set it to a larger size. It really doesn't matter\n          //what size we pick as long as it is large enough to avoid the GTK warnings.\n          dummyStage.setWidth(100);\n          dummyStage.setHeight(100);\n          //Make it invisible\n          dummyStage.setOpacity(0.0);\n          //Don't allow closing\n          dummyStage.setOnCloseRequest(e -&gt; e.consume());\n          dummyStage.show();\n        }\n        \n        return dummyStage;\n    }\n\n    public static void main(String[] args) {\n        new FxOnSwingProblemDemo();\n    }\n}\n\n</code></pre>\n<p>I tried everything I can think of to make the window invisible, but haven't found a way yet. I also tried seeing if there's a way I can display a Popup without a real window by making my own subclass of Window that doesn't really display anything, but I haven't gotten very far since a lot Window's methods are final. Open to any ideas. If I have to just write a swing version of the warnings, then I guess I will, but I'd like to avoid it if I can.</p>\n",
    "tags" : [ "java", "linux", "swing", "javafx" ],
    "owner" : {
      "account_id" : 2819099,
      "reputation" : 994,
      "user_id" : 2423283,
      "user_type" : "registered",
      "accept_rate" : 86,
      "profile_image" : "https://www.gravatar.com/avatar/75057ee1361d4d3d169413ed4d8e88f5?s=256&d=identicon&r=PG",
      "display_name" : "NateW",
      "link" : "https://stackoverflow.com/users/2423283/natew"
    },
    "is_answered" : true,
    "view_count" : 60,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1745264375,
    "creation_date" : 1744983453,
    "link" : "https://stackoverflow.com/questions/79581147/displaying-a-javafx-popup-on-a-swing-app-in-cross-platform-manner",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79585210,
    "question_id" : 79581147,
    "body" : "<p>The comments from VGR and Slaw were both very helpful so I'm going to expand on them here for anyone else who comes looking at this question.</p>\n<h1></h1>\n<h1>Adding a JFXPanel to the Swing GlassPane</h1>\n<p>This was based on <a href=\"https://stackoverflow.com/users/1831987/vgr\">VGR</a>'s suggestion and it is what I ended up doing. This could be considered a workaround more than an answer to the actual question in the title since it does not actually display a popup, but in my particular case, this was actually the better solution.</p>\n<p>Basically, my implementation boiled down to:</p>\n<ul>\n<li><p>Create an AnchorPane to hold all of the warnings</p>\n</li>\n<li><p>make background transparent with <code>warningsPane.setStyle(&quot;-fx-background-color: transparent&quot;);</code></p>\n</li>\n<li><p>Create a Scene with the warnings pane as it's root and set it transparent as well with <code>scene.setFill(javafx.scene.paint.Color.TRANSPARENT);</code></p>\n</li>\n<li><p>Create a JFXPanel and setting it to use that new scene</p>\n<ul>\n<li>In my case I needed to allow clicking on the &quot;popups&quot; but needed to allow mouse actions to go through the rest of the pane transparently. Initially I wrote a mouse listener that re-dispatched events but then found that I was still losing mouse hovering effects (like cursor changes or buttons highlighting) so instead I overrode the <code>contains</code> method on the JFXPanel so that it only returned true if the mouse position was within one of the &quot;popups&quot;.</li>\n</ul>\n</li>\n<li><p>Set the JFrame's glass pane to my JFXPanel (<code>jFrame.setGlassPane(fxPanel); jFrame.getGlassPane().setVisible(true);</code> )</p>\n</li>\n<li><p>Then I modified all of my &quot;popup&quot; code to add nodes to that <code>warningsPane</code> object instead of actually producing popups. In my cases this was fairly significant re-work, but it actually resulted in a simpler product because before I had to do a lot of work to handle window moving and re-sizing but now everything in the <code>AnchorPane</code> just moves around with the window easily</p>\n</li>\n<li><p>For the JavaFX apps that use this same utility, I added a StackPane and put my <code>warningsPane</code> on the top. I called <code>warningPane.setPickOnBounds(false);</code> which allowed mouse events that weren't targeted on the warnings to pass through to the underlying controls.</p>\n</li>\n</ul>\n<h1>Using a Node instead of a Stage</h1>\n<p>This isn't the approach I used but I did test it out just to see. Slaw suggested that I try using <code>Popup.show(Node, double, double)</code> instead of <code>Popup.show(Window)</code>. The documentation says that this method will throw an <code>IllegalArgumentException</code> if the specified Node is not associated with a <code>Window</code> but I suppose the interpretation of &quot;Window&quot; there is up to some interpretation. I found that if I created a Node and didn't add it to anything, then I would get an IllegalArgumentException. However, if I added that node to a <code>JFXPanel</code> and added that panel somewhere in my Swing app, then the <code>Popup.show(Node, double, double)</code> method works just fine. I don't know if that's guaranteed to work in every version of JavaFX with every JRE, but in my case it seemed to work fine.</p>\n",
    "score" : 1,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 2819099,
      "reputation" : 994,
      "user_id" : 2423283,
      "user_type" : "registered",
      "accept_rate" : 86,
      "profile_image" : "https://www.gravatar.com/avatar/75057ee1361d4d3d169413ed4d8e88f5?s=256&d=identicon&r=PG",
      "display_name" : "NateW",
      "link" : "https://stackoverflow.com/users/2423283/natew"
    },
    "creation_date" : 1745264375,
    "last_activity_date" : 1745264375,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140349307,
    "post_id" : 79581147,
    "body" : "Am I correct in assuming that <a href=\"https://openjfx.io/javadoc/24/javafx.graphics/javafx/stage/PopupWindow.html#show(javafx.scene.Node,double,double)\" rel=\"nofollow noreferrer\"><code>PopupWindow#show(Node,double,double)</code></a> does not work for nodes being displayed in a Swing window? I&#39;ve never tried it, though the documentation does indicate an <code>IllegalArgumentException</code> would be thrown in that case.",
    "score" : 1,
    "owner" : {
      "account_id" : 8532578,
      "reputation" : 49884,
      "user_id" : 6395627,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/af0f9bfe593f36642a032cd7ea611e7d?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Slaw",
      "link" : "https://stackoverflow.com/users/6395627/slaw"
    },
    "creation_date" : 1745014232,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140348200,
    "post_id" : 79581147,
    "body" : "Off-topic, but consider using <a href=\"https://openjfx.io/javadoc/23/javafx.graphics/javafx/application/Platform.html#startup(java.lang.Runnable)\" rel=\"nofollow noreferrer\"><code>Platform.startup()</code></a> instead of creating and immediately discarding a <code>JFXPanel</code>.",
    "score" : 2,
    "owner" : {
      "account_id" : 2518243,
      "reputation" : 210906,
      "user_id" : 2189127,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/e8e6e627b4b90ec816c5c7aa04cbcc26?s=256&d=identicon&r=PG",
      "display_name" : "James_D",
      "link" : "https://stackoverflow.com/users/2189127/james-d"
    },
    "creation_date" : 1744986879,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140348131,
    "post_id" : 79581147,
    "body" : "@VGR. Good thinking. I&#39;m going to play around with that and let you know how it goes",
    "score" : 0,
    "owner" : {
      "account_id" : 2819099,
      "reputation" : 994,
      "user_id" : 2423283,
      "user_type" : "registered",
      "accept_rate" : 86,
      "profile_image" : "https://www.gravatar.com/avatar/75057ee1361d4d3d169413ed4d8e88f5?s=256&d=identicon&r=PG",
      "display_name" : "NateW",
      "link" : "https://stackoverflow.com/users/2423283/natew"
    },
    "creation_date" : 1744985599,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140348081,
    "post_id" : 79581147,
    "body" : "If my memory is correct, ControlsFX has a similar Alert/Popup. Try it out to see if it meets your needs.   <a href=\"https://github.com/controlsfx/controlsfx/wiki/ControlsFX-Features#notifications\" rel=\"nofollow noreferrer\">github.com/controlsfx/controlsfx/wiki/&hellip;</a>",
    "score" : 2,
    "owner" : {
      "account_id" : 2819940,
      "reputation" : 14002,
      "user_id" : 2423906,
      "user_type" : "registered",
      "accept_rate" : 100,
      "profile_image" : "https://i.sstatic.net/rkpYv.jpg?s=256",
      "display_name" : "SedJ601",
      "link" : "https://stackoverflow.com/users/2423906/sedj601"
    },
    "creation_date" : 1744984716,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140348071,
    "post_id" : 79581147,
    "body" : "If it&#39;s in the bottom right corner of the application, that means it&#39;s inside the application&#39;s window, right?  So I would use JavaFX Node classes rather than Popup, and I would place a <a href=\"https://openjfx.io/javadoc/23/javafx.swing/javafx/embed/swing/JFXPanel.html\" rel=\"nofollow noreferrer\">JFXPanel</a> in the Swing window&#39;s <a href=\"https://docs.oracle.com/en/java/javase/24/docs/api/java.desktop/javax/swing/JFrame.html#getGlassPane()\" rel=\"nofollow noreferrer\">glassPane</a>.  Not sure if that would allow you to continue using whatever JavaFX benefits you wish to retain.",
    "score" : 4,
    "owner" : {
      "account_id" : 2053598,
      "reputation" : 44936,
      "user_id" : 1831987,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/38b1c37530189ec4471a43a618e33f67?s=256&d=identicon&r=PG",
      "display_name" : "VGR",
      "link" : "https://stackoverflow.com/users/1831987/vgr"
    },
    "creation_date" : 1744984502,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}