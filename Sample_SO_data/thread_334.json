{
  "question" : {
    "question_id" : 79816348,
    "title" : "Write logs to database in quarkus application",
    "body" : "<p>How can I write my log messages to database in my quarkus application?</p>\n<p>I tried to create a ExtHandler like this:</p>\n<pre><code>package org.myorg;\n\nimport io.agroal.api.AgroalDataSource;\nimport jakarta.enterprise.context.ApplicationScoped;\nimport jakarta.inject.Inject;\nimport org.jboss.logmanager.ExtHandler;\nimport org.jboss.logmanager.ExtLogRecord;\n\nimport java.sql.Connection;\nimport java.sql.PreparedStatement;\nimport java.sql.SQLException;\n\n@ApplicationScoped\npublic class DatabaseLogHandler extends ExtHandler {\n\n  @Inject\n  private AgroalDataSource dataSource;\n\n  @Override\n  protected void doPublish(final ExtLogRecord record) {\n    try (final Connection conn = this.dataSource.getConnection();\n         final PreparedStatement ps = conn.prepareStatement(\n             &quot;INSERT INTO logs(timestamp, level, logger, message) VALUES (?, ?, ?, ?)&quot;)) {\n\n      ps.setLong(1, record.getMillis());\n      ps.setString(2, record.getLevel().toString());\n      ps.setString(3, record.getLoggerName());\n      ps.setString(4, record.getMessage());\n      ps.executeUpdate();\n\n    } catch (final SQLException e) {\n      e.printStackTrace();\n    }\n  }\n}\n</code></pre>\n<p>and added</p>\n<pre><code>quarkus.log.handler.database=DatabaseLogHandler\n</code></pre>\n<p>to my application.properties but the code is not being executed.</p>\n",
    "tags" : [ "java", "database", "logging", "quarkus" ],
    "owner" : {
      "account_id" : 44635457,
      "reputation" : 3,
      "user_id" : 31855812,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/469e8deed036952b99e9b5bba8127437?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "user31855812",
      "link" : "https://stackoverflow.com/users/31855812/user31855812"
    },
    "is_answered" : true,
    "view_count" : 116,
    "answer_count" : 2,
    "score" : 0,
    "last_activity_date" : 1763033953,
    "creation_date" : 1762846527,
    "link" : "https://stackoverflow.com/questions/79816348/write-logs-to-database-in-quarkus-application",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79818797,
    "question_id" : 79816348,
    "body" : "<p>This is a demonstration of proof-of-concept testing.</p>\n<h1>Create Quarkus Application</h1>\n<pre><code>mvn io.quarkus.platform:quarkus-maven-plugin:create \\\n    -DprojectGroupId=org.myorg \\\n    -DprojectArtifactId=quarkus-demo-database-log-handler \\\n    -DclassName=&quot;org.myorg.GreetingResource&quot; \\\n    -Dpath=&quot;/hello&quot;\n</code></pre>\n<h1>Add extensions</h1>\n<p>Add Support for PostgreSQL</p>\n<pre><code>cd quarkus-demo-database-log-handler\n\nmvn quarkus:add-extension -Dextensions=&quot;quarkus-jdbc-postgresql&quot;\n</code></pre>\n<p>You can use the following command to search for available extensions.</p>\n<pre><code>mvn quarkus:list-extensions\n</code></pre>\n<h1>Database - PostgreSQL</h1>\n<h2>init_postgresql_custom.sql</h2>\n<pre><code>CREATE TABLE app_log (\n    id       BIGSERIAL PRIMARY KEY,\n    log_time TIMESTAMPTZ DEFAULT NOW() NOT NULL,   -- now()\n    level    VARCHAR(20) NOT NULL,        -- event.getLevel().toString()\n    logger   VARCHAR(255) NOT NULL,       -- event.getLoggerName()\n    message  TEXT NOT NULL                -- event.getFormattedMessage()\n);\nCREATE INDEX idx_app_log_time ON app_log(log_time DESC);\nCREATE INDEX idx_app_log_level ON app_log(level);\n</code></pre>\n<h2>Use Docker to provide the PostgreSQL Server</h2>\n<pre><code>docker run \\\n  --name my-postgres-quarkus-log \\\n  -e POSTGRES_USER=demouser \\\n  -e POSTGRES_PASSWORD=Passw0rd! \\\n  -e POSTGRES_DB=demodb \\\n  -v $(pwd)/init_postgresql_custom.sql:/docker-entrypoint-initdb.d/init.sql \\\n  -p 5432:5432 \\\n  -d \\\n  postgres:18.0-alpine3.22\n</code></pre>\n<h1>application.properties</h1>\n<ul>\n<li>add datasource name: <code>logging</code></li>\n<li>add config like <code>quarkus.datasource.logging.xxx.yyy.zzz=aaa</code></li>\n</ul>\n<pre><code># --- Logging DataSource ---\nquarkus.datasource.logging.db-kind=postgresql\nquarkus.datasource.logging.jdbc.url=jdbc:postgresql://localhost:5432/demodb\nquarkus.datasource.logging.username=demouser\nquarkus.datasource.logging.password=Passw0rd!\n\n# Logging DataSource Agroal pool\nquarkus.datasource.logging.jdbc.max-size=20\nquarkus.datasource.logging.jdbc.min-size=2\nquarkus.datasource.logging.jdbc.acquisition-timeout=5\n\nquarkus.log.level=INFO\nquarkus.log.category.&quot;org.myorg&quot;.level=DEBUG\n\n\n# --- App DataSource ---\n# quarkus.datasource.db-kind=postgresql\n# quarkus.datasource.jdbc.url=jdbc:postgresql://localhost:5432/demodb\n# quarkus.datasource.username=demouser\n# quarkus.datasource.password=Passw0rd!\n\n# App DataSource Agroal pool\n# quarkus.datasource.jdbc.max-size=20\n# quarkus.datasource.jdbc.min-size=2\n# quarkus.datasource.jdbc.acquisition-timeout=5\n</code></pre>\n<h1>Appfile</h1>\n<pre><code>quarkus-demo-database-log-handler/src/main/java/org/myorg\n├── DatabaseLogHandler.java\n├── DatabaseLogHandlerInitializer.java\n└── GreetingResource.java\n\n</code></pre>\n<h2>DatabaseLogHandler.java</h2>\n<ul>\n<li>change Field Name: <code>log_time</code> (Not <code>timestamp</code> ) - init_postgresql_custom.sql</li>\n<li>change SQL command, use <code>now()</code> to fill into <code>log_time</code>.</li>\n<li>change <code>record.getMessage()</code></li>\n<li>it will get error content '%s %s (powered by Quarkus %s) started in %ss. %s'</li>\n<li>change it to <code>record.getFormattedMessage()</code>.</li>\n</ul>\n<pre><code>package org.myorg;\n\nimport io.agroal.api.AgroalDataSource;\nimport io.quarkus.agroal.DataSource;\nimport jakarta.enterprise.context.ApplicationScoped;\nimport org.jboss.logmanager.ExtHandler;\nimport org.jboss.logmanager.ExtLogRecord;\n\nimport java.sql.Connection;\nimport java.sql.PreparedStatement;\n\n@ApplicationScoped\npublic class DatabaseLogHandler extends ExtHandler {\n\n    private final AgroalDataSource dataSource;\n\n    public DatabaseLogHandler(@DataSource(&quot;logging&quot;) AgroalDataSource dataSource) {\n        this.dataSource = dataSource;\n    }\n\n    @Override\n    protected void doPublish(ExtLogRecord record) {\n        try (Connection conn = dataSource.getConnection()) {\n            PreparedStatement ps = conn.prepareStatement(\n             &quot;INSERT INTO app_log(level, logger, message, log_time) VALUES (?, ?, ?, now())&quot;\n            );\n            // &quot;INSERT INTO logs(timestamp, level, logger, message) VALUES (?, ?, ?, ?)&quot;))\n            // ps.setLong(1, record.getMillis()); &lt;- now()\n\n            ps.setString(1, record.getLevel().getName());\n            ps.setString(2, record.getLoggerName());\n            //ps.setString(4, record.getMessage()); //get '%s %s (powered by Quarkus %s) started in %ss. %s'\n            ps.setString(3, record.getFormattedMessage());\n            ps.executeUpdate();\n        } catch (Exception e) {\n            reportError(&quot;DB logging failed&quot;, e, java.util.logging.ErrorManager.WRITE_FAILURE);\n        }\n    }\n\n    @Override\n    public void flush() {\n        // not required\n    }\n\n    @Override\n    public void close() throws SecurityException {\n        // not required\n    }\n}\n</code></pre>\n<h2>DatabaseLogHandlerInitializer.java</h2>\n<p>Register DatabaseLogHandler.</p>\n<ul>\n<li>Inject DataSource from application.properties - quarkus.datasource.logging.xxxx=yyy</li>\n</ul>\n<pre><code>package org.myorg;\n\nimport io.agroal.api.AgroalDataSource;\nimport io.quarkus.runtime.StartupEvent;\nimport jakarta.enterprise.context.ApplicationScoped;\nimport jakarta.enterprise.event.Observes;\nimport jakarta.inject.Inject;\nimport org.jboss.logmanager.LogManager;\nimport org.jboss.logmanager.Logger;\n\n@ApplicationScoped\npublic class DatabaseLogHandlerInitializer {\n    @Inject\n    @io.quarkus.agroal.DataSource(&quot;logging&quot;)\n    AgroalDataSource dataSource;\n\n    void onStart(@Observes StartupEvent ev) {\n        DatabaseLogHandler dbHandler = new DatabaseLogHandler(dataSource);\n        Logger root = (Logger) LogManager.getLogManager().getLogger(&quot;&quot;);\n        root.addHandler(dbHandler);\n        System.err.println(&quot;&gt;&gt;&gt; [DatabaseLogHandlerInitializer] DatabaseLogHandler attached. handler count = &quot; + root.getHandlers().length);\n    }\n}\n</code></pre>\n<h2>GreetingResource.java</h2>\n<ul>\n<li>add slf4j Logger and LoggerFactory.</li>\n</ul>\n<pre><code>package org.myorg;\n\nimport jakarta.ws.rs.*;\nimport jakarta.ws.rs.core.MediaType;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\n@Path(&quot;/hello&quot;)\npublic class GreetingResource {\n    private static final Logger logger = LoggerFactory.getLogger(GreetingResource.class);\n\n    @GET\n    @Produces(MediaType.TEXT_PLAIN)\n    public String hello() {\n        logger.info(&quot;call hello().&quot;);\n        logger.debug(&quot;DDDDD - call hello().&quot;);\n        return &quot;Hello from Quarkus REST&quot;;\n    }\n\n    // helloWithParameter - PathParam\n    // /hello/John\n    @GET\n    @Path(&quot;/{name}&quot;)\n    @Produces(MediaType.TEXT_PLAIN)\n    public String helloWithParameter(@PathParam(&quot;name&quot;) String name) {\n        logger.info(&quot;Received name: {}&quot;, name);\n        logger.debug(&quot;DDDDD - Received name: {}&quot;, name);\n        return &quot;Hello, &quot; + name + &quot;!&quot;;\n    }\n\n    // /hello/with-query?name=John\n    @GET\n    @Path(&quot;/with-query&quot;)\n    @Produces(MediaType.TEXT_PLAIN)\n    public String helloWithQuery(@QueryParam(&quot;name&quot;) String name) {\n        logger.info(&quot;Received query name: {}&quot;, name);\n        logger.debug(&quot;DDDDD - query name: {}&quot;, name);\n        return &quot;Hello, &quot; + name + &quot;!&quot;;\n    }\n}\n</code></pre>\n<h1>pom.xml</h1>\n<ul>\n<li>Remove dependencies related to &quot;test&quot;.</li>\n</ul>\n<h1>Final Project tree</h1>\n<p>remove <code>test</code></p>\n<pre><code>quarkus-demo-database-log-handler\n├── pom.xml                     &lt;-- Change  \n├── init_postgresql_custom.sql  &lt;-- New\n├── README.md\n└── src\n    └── main\n        ├── docker\n            ....\n        ├── java\n        │   └── org\n        │       └── myorg\n        │           ├── DatabaseLogHandlerInitializer.java &lt;-- New\n        │           ├── DatabaseLogHandler.java            &lt;-- Change\n        │           └── GreetingResource.java              &lt;-- Change\n        └── resources\n            └── application.properties &lt;-- Change        \n</code></pre>\n<h1>Build For JVM</h1>\n<pre><code>mvn clean package\n</code></pre>\n<h2>Run</h2>\n<pre><code>java -jar target/quarkus-app/quarkus-run.jar\n</code></pre>\n<h2>Test</h2>\n<pre><code>curl http://localhost:8080/hello\n\ncurl http://localhost:8080/hello/John\n\ncurl http://localhost:8080/hello/with-query?name=John\n</code></pre>\n<h2>Verify - Table contents</h2>\n<p>Using database tools, connect to PostgreSQL, inspect the table, and see if there are any records of the logs we just wrote.</p>\n<p><a href=\"https://i.sstatic.net/ZLfkAknm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/ZLfkAknm.png\" alt=\"enter image description here\" /></a>.</p>\n<p>Console Output:</p>\n<pre><code>$ java -jar target/quarkus-app/quarkus-run.jar\n&gt;&gt;&gt; [DatabaseLogHandlerInitializer] DatabaseLogHandler attached. handler count = 2\n__  ____  __  _____   ___  __ ____  ______ \n --/ __ \\/ / / / _ | / _ \\/ //_/ / / / __/ \n -/ /_/ / /_/ / __ |/ , _/ ,&lt; / /_/ /\\ \\   \n--\\___\\_\\____/_/ |_/_/|_/_/|_|\\____/___/   \n2025-11-13 19:08:46,974 INFO  [io.quarkus] (main) quarkus-demo-database-log-handler 1.0.0-SNAPSHOT on JVM (powered by Quarkus 3.29.2) started in 0.913s. Listening on: http://0.0.0.0:8080\n2025-11-13 19:08:47,476 INFO  [io.quarkus] (main) Profile prod activated. \n2025-11-13 19:08:47,478 INFO  [io.quarkus] (main) Installed features: [agroal, cdi, jdbc-postgresql, narayana-jta, rest, smallrye-context-propagation, vertx]\n2025-11-13 19:09:07,730 INFO  [org.myo.GreetingResource] (executor-thread-1) call hello().\n2025-11-13 19:09:07,733 DEBUG [org.myo.GreetingResource] (executor-thread-1) DDDDD - call hello().\n2025-11-13 19:09:07,760 INFO  [org.myo.GreetingResource] (executor-thread-1) Received name: John\n2025-11-13 19:09:07,763 DEBUG [org.myo.GreetingResource] (executor-thread-1) DDDDD - Received name: John\n2025-11-13 19:09:07,783 INFO  [org.myo.GreetingResource] (executor-thread-1) Received query name: John\n2025-11-13 19:09:07,785 DEBUG [org.myo.GreetingResource] (executor-thread-1) DDDDD - query name: John\n</code></pre>\n<h1>Build For Native</h1>\n<pre><code>mvn clean package -Dnative\n</code></pre>\n<h2>Run</h2>\n<pre><code>./target/quarkus-demo-database-log-handler-1.0.0-SNAPSHOT-runner\n</code></pre>\n<h2>Test</h2>\n<pre><code>curl http://localhost:8080/hello\n\ncurl http://localhost:8080/hello/John-2\n\ncurl http://localhost:8080/hello/with-query?name=John-3\n</code></pre>\n<p>Console Output:</p>\n<pre><code>$ ./target/quarkus-demo-database-log-handler-1.0.0-SNAPSHOT-runner\n&gt;&gt;&gt; [DatabaseLogHandlerInitializer] DatabaseLogHandler attached. handler count = 2\n__  ____  __  _____   ___  __ ____  ______ \n --/ __ \\/ / / / _ | / _ \\/ //_/ / / / __/ \n -/ /_/ / /_/ / __ |/ , _/ ,&lt; / /_/ /\\ \\   \n--\\___\\_\\____/_/ |_/_/|_/_/|_|\\____/___/   \n2025-11-13 19:34:10,414 INFO  [io.quarkus] (main) quarkus-demo-database-log-handler 1.0.0-SNAPSHOT native (powered by Quarkus 3.29.2) started in 0.087s. Listening on: http://0.0.0.0:8080\n2025-11-13 19:34:10,469 INFO  [io.quarkus] (main) Profile prod activated. \n2025-11-13 19:34:10,471 INFO  [io.quarkus] (main) Installed features: [agroal, cdi, jdbc-postgresql, narayana-jta, rest, smallrye-context-propagation, vertx]\n2025-11-13 19:34:36,330 INFO  [org.myo.GreetingResource] (executor-thread-1) call hello().\n2025-11-13 19:34:36,333 DEBUG [org.myo.GreetingResource] (executor-thread-1) DDDDD - call hello().\n2025-11-13 19:34:36,366 INFO  [org.myo.GreetingResource] (executor-thread-1) Received name: John-2\n2025-11-13 19:34:36,368 DEBUG [org.myo.GreetingResource] (executor-thread-1) DDDDD - Received name: John-2\n2025-11-13 19:34:36,399 INFO  [org.myo.GreetingResource] (executor-thread-1) Received query name: John-3\n2025-11-13 19:34:36,401 DEBUG [org.myo.GreetingResource] (executor-thread-1) DDDDD - query name: John-3\n</code></pre>\n<h2>Verify</h2>\n<p>Using database tools, connect to PostgreSQL, inspect the table, and see if there are any records of the logs we just wrote.</p>\n<p><a href=\"https://i.sstatic.net/gjj7a7Iz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/gjj7a7Iz.png\" alt=\"enter image description here\" /></a>.</p>\n",
    "score" : 1,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 26698569,
      "reputation" : 4070,
      "user_id" : 20306007,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/98bbc403493aee3681b71dae7abef66e?s=256&d=identicon&r=PG",
      "display_name" : "life888888",
      "link" : "https://stackoverflow.com/users/20306007/life888888"
    },
    "creation_date" : 1763033953,
    "last_activity_date" : 1763033953,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79817937,
    "question_id" : 79816348,
    "body" : "<p>This is a demonstration of proof-of-concept testing.</p>\n<ul>\n<li>Concept 1: involves using SLF4J + LOGBACK.</li>\n<li>Concept 2: involves using LOGBACK to output logs to the database.</li>\n<li>Concept 3: uses PostgreSQL as the database.</li>\n</ul>\n<h1>Create Quarkus Application</h1>\n<pre><code>mvn io.quarkus.platform:quarkus-maven-plugin:create \\\n    -DprojectGroupId=com.example \\\n    -DprojectArtifactId=quarkus-demo \\\n    -DclassName=&quot;com.example.GreetingResource&quot; \\\n    -Dpath=&quot;/hello&quot;\n</code></pre>\n<h1>Add extensions</h1>\n<p>Add Support for PostgreSQL and Logback.</p>\n<pre><code>cd quarkus-demo\nmvn quarkus:add-extension -Dextensions=&quot;logging-logback&quot;\nmvn quarkus:add-extension -Dextensions=&quot;quarkus-jdbc-postgresql&quot;\n</code></pre>\n<p>You can use the following command to search for available extensions.</p>\n<pre><code>mvn quarkus:list-extensions\n</code></pre>\n<h1>Round 1 - Use Logback's built-in DBAppender</h1>\n<p><a href=\"https://logback.qos.ch/manual/appenders.html\" rel=\"nofollow noreferrer\">https://logback.qos.ch/manual/appenders.html</a></p>\n<pre><code>As of logback version 1.2.8 DBAppender no longer ships with logback-classic. However, DBAppender for logback-classic is available under the following Maven coordinates:\n\nch.qos.logback.db:logback-classic-db:1.2.11.1\n</code></pre>\n<p>Round 1 : Fail.</p>\n<h1>Round 2 - Use ch.qos.logback.db:logback-classic-db:1.2.11.1 DBAppender</h1>\n<p>The logback version referenced by logback-classic-db is incompatible with the version referenced by quarkus logback.</p>\n<p>Round 2 : Fail.</p>\n<h1>Round 3 - Write your own custom Logback appender.</h1>\n<pre><code>quarkus-demo/src/main/java/com/example/log\n├── AsyncPostgresAppender.java\n└── PostgresAppender.java\n</code></pre>\n<h2>PostgresAppender.java</h2>\n<pre><code>package com.example.log;\n\nimport ch.qos.logback.classic.spi.ILoggingEvent;\nimport ch.qos.logback.core.AppenderBase;\n\nimport java.sql.Connection;\nimport java.sql.DriverManager;\nimport java.sql.PreparedStatement;\n\npublic class PostgresAppender extends AppenderBase&lt;ILoggingEvent&gt; {\n\n    private String url;\n    private String user;\n    private String password;\n\n    @Override\n    protected void append(ILoggingEvent event) {\n        try (Connection conn = DriverManager.getConnection(url, user, password)) {\n            PreparedStatement stmt = conn.prepareStatement(\n                    &quot;INSERT INTO app_log(level, logger, message, ts) VALUES (?, ?, ?, now())&quot;\n            );\n            stmt.setString(1, event.getLevel().toString());\n            stmt.setString(2, event.getLoggerName());\n            stmt.setString(3, event.getFormattedMessage());\n            stmt.executeUpdate();\n        } catch (Exception e) {\n            addError(&quot;Failed to write log to DB&quot;, e);\n        }\n    }\n\n    public void setUrl(String url) {\n        this.url = url;\n    }\n\n    public void setUser(String user) {\n        this.user = user;\n    }\n\n    public void setPassword(String password) {\n        this.password = password;\n    }\n}\n</code></pre>\n<h2>AsyncPostgresAppender.java</h2>\n<pre><code>package com.example.log;\n\nimport ch.qos.logback.classic.spi.ILoggingEvent;\nimport ch.qos.logback.core.AppenderBase;\n\nimport java.sql.Connection;\nimport java.sql.DriverManager;\nimport java.sql.PreparedStatement;\nimport java.util.concurrent.ArrayBlockingQueue;\nimport java.util.concurrent.BlockingQueue;\n\npublic class AsyncPostgresAppender extends AppenderBase&lt;ILoggingEvent&gt; {\n\n    private String url;\n    private String user;\n    private String password;\n    private int queueSize = 1024;\n\n    private BlockingQueue&lt;ILoggingEvent&gt; queue;\n    private Thread worker;\n    private volatile boolean running = true;\n\n    @Override\n    public void start() {\n        queue = new ArrayBlockingQueue&lt;&gt;(queueSize);\n\n        worker = new Thread(() -&gt; {\n            while (running || !queue.isEmpty()) {\n                try {\n                    // Wait Event\n                    ILoggingEvent event = queue.take();\n                    writeToDB(event);\n                } catch (InterruptedException ignored) {\n                } catch (Exception e) {\n                    addError(&quot;Error writing log to DB&quot;, e);\n                }\n            }\n        }, &quot;AsyncPostgresAppender-Worker&quot;);\n\n        worker.setDaemon(true);\n        worker.start();\n        super.start();\n    }\n\n    @Override\n    protected void append(ILoggingEvent event) {\n        if (!running) return;\n        if (!queue.offer(event)) {\n            addError(&quot;Queue full, dropping log: &quot; + event.getFormattedMessage());\n        }\n    }\n\n    private void writeToDB(ILoggingEvent event) {\n        try (Connection conn = DriverManager.getConnection(url, user, password);\n             PreparedStatement stmt = conn.prepareStatement(\n                     &quot;INSERT INTO app_log(level, logger, message, ts) VALUES (?, ?, ?, now())&quot;)) {\n            stmt.setString(1, event.getLevel().toString());\n            stmt.setString(2, event.getLoggerName());\n            stmt.setString(3, event.getFormattedMessage());\n            stmt.executeUpdate();\n        } catch (Exception e) {\n            addError(&quot;Failed to write log to DB&quot;, e);\n        }\n    }\n\n    @Override\n    public void stop() {\n        running = false;\n        if (worker != null) {\n            worker.interrupt();\n            try {\n                worker.join(5000);\n            } catch (InterruptedException ignored) {}\n        }\n        super.stop();\n    }\n\n    public void setUrl(String url) {\n        this.url = url;\n    }\n\n    public void setUser(String user) {\n        this.user = user;\n    }\n\n    public void setPassword(String password) {\n        this.password = password;\n    }\n\n    public void setQueueSize(int queueSize) {\n        this.queueSize = queueSize;\n    }\n}\n</code></pre>\n<h1>Database</h1>\n<h2>init_logback_my.sql</h2>\n<pre><code>CREATE TABLE app_log (\n    id       BIGSERIAL PRIMARY KEY,\n    ts       TIMESTAMPTZ DEFAULT NOW(),   -- now()\n    level    VARCHAR(16) NOT NULL,        -- event.getLevel().toString()\n    logger   VARCHAR(255) NOT NULL,       -- event.getLoggerName()\n    message  TEXT NOT NULL                -- event.getFormattedMessage()\n);\nCREATE INDEX idx_app_log_ts ON app_log(ts DESC);\nCREATE INDEX idx_app_log_level ON app_log(level);\n</code></pre>\n<h2>Use Docker to provide the PostgreSQL Server</h2>\n<pre><code>docker run \\\n  --name my-postgres-log \\\n  -e POSTGRES_USER=demouser \\\n  -e POSTGRES_PASSWORD=Passw0rd! \\\n  -e POSTGRES_DB=demodb \\\n  -v $(pwd)/init_logback_my.sql:/docker-entrypoint-initdb.d/init.sql \\\n  -p 5432:5432 \\\n  -d \\\n  postgres:18.0-alpine3.22  \n</code></pre>\n<h1>Logback Config File</h1>\n<pre><code>quarkus-demo/src/main/resources\n├── application.properties\n└── logback.xml\n</code></pre>\n<h2>logback.xml</h2>\n<pre><code>&lt;configuration&gt;\n    &lt;appender name=&quot;CONSOLE&quot; class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt;\n        &lt;encoder&gt;\n            &lt;pattern&gt;%d %-5level %logger{36} - ***&gt;&gt;&gt; %msg%n&lt;/pattern&gt;\n        &lt;/encoder&gt;\n    &lt;/appender&gt;\n\n    &lt;appender name=&quot;FILE&quot; class=&quot;ch.qos.logback.core.FileAppender&quot;&gt;\n        &lt;file&gt;app.log&lt;/file&gt; \n        &lt;encoder&gt;\n            &lt;pattern&gt;%d %-5level %logger{36} - ***&gt;&gt;&gt; %msg%n&lt;/pattern&gt;\n        &lt;/encoder&gt;\n        &lt;append&gt;true&lt;/append&gt; \n    &lt;/appender&gt;\n\n\n    &lt;appender name=&quot;DB&quot; class=&quot;com.example.log.PostgresAppender&quot;&gt;\n        &lt;url&gt;jdbc:postgresql://localhost:5432/demodb&lt;/url&gt;\n        &lt;user&gt;demouser&lt;/user&gt;\n        &lt;password&gt;Passw0rd!&lt;/password&gt;\n    &lt;/appender&gt;\n\n&lt;!--\n    &lt;appender name=&quot;ASYNC_DB&quot; class=&quot;com.example.log.AsyncPostgresAppender&quot;&gt;\n        &lt;url&gt;jdbc:postgresql://localhost:5432/demodb&lt;/url&gt;\n        &lt;user&gt;demouser&lt;/user&gt;\n        &lt;password&gt;Passw0rd!&lt;/password&gt;\n        &lt;queueSize&gt;2048&lt;/queueSize&gt;\n    &lt;/appender&gt;\n--&gt;\n\n    &lt;root level=&quot;INFO&quot;&gt;\n        &lt;appender-ref ref=&quot;CONSOLE&quot;/&gt;\n        &lt;appender-ref ref=&quot;FILE&quot;/&gt;\n        &lt;appender-ref ref=&quot;DB&quot;/&gt;\n\n&lt;!--\n        &lt;appender-ref ref=&quot;ASYNC_DB&quot;/&gt;\n--&gt;\n    &lt;/root&gt;\n&lt;/configuration&gt;\n</code></pre>\n<h1>Appfile</h1>\n<pre><code>quarkus-demo/src/main/java/com/example\n├── GreetingResource.java\n└── log\n    ├── AsyncPostgresAppender.java\n    └── PostgresAppender.java\n</code></pre>\n<h2>GreetingResource.java</h2>\n<ul>\n<li>add slf4j Logger and LoggerFactory.</li>\n</ul>\n<pre><code>package com.example;\n\nimport jakarta.ws.rs.*;\nimport jakarta.ws.rs.core.MediaType;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\n@Path(&quot;/hello&quot;)\npublic class GreetingResource {\n    private static final Logger logger = LoggerFactory.getLogger(GreetingResource.class);\n\n    @GET\n    @Produces(MediaType.TEXT_PLAIN)\n    public String hello() {\n        logger.info(&quot;call hello().&quot;);\n        return &quot;Hello from Quarkus REST&quot;;\n    }\n\n    // helloWithParameter - PathParam\n    // /hello/John\n    @GET\n    @Path(&quot;/{name}&quot;)\n    @Produces(MediaType.TEXT_PLAIN)\n    public String helloWithParameter(@PathParam(&quot;name&quot;) String name) {\n        logger.info(&quot;Received name: {}&quot;, name);\n        return &quot;Hello, &quot; + name + &quot;!&quot;;\n    }\n\n    // /hello/with-query?name=John\n    @GET\n    @Path(&quot;/with-query&quot;)\n    @Produces(MediaType.TEXT_PLAIN)\n    public String helloWithQuery(@QueryParam(&quot;name&quot;) String name) {\n        logger.info(&quot;Received query name: {}&quot;, name);\n        return &quot;Hello, &quot; + name + &quot;!&quot;;\n    }\n}\n</code></pre>\n<h1>pom.xml</h1>\n<ul>\n<li>Remove dependencies related to &quot;test&quot;.</li>\n<li>Confirm the following content has been added:</li>\n</ul>\n<pre><code>        &lt;dependency&gt;\n            &lt;groupId&gt;io.quarkiverse.logging.logback&lt;/groupId&gt;\n            &lt;artifactId&gt;quarkus-logging-logback&lt;/artifactId&gt;\n            &lt;version&gt;1.1.2&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;io.quarkus&lt;/groupId&gt;\n            &lt;artifactId&gt;quarkus-jdbc-postgresql&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;\n            &lt;artifactId&gt;logback-classic&lt;/artifactId&gt;\n            &lt;version&gt;1.4.14&lt;/version&gt;\n            &lt;scope&gt;compile&lt;/scope&gt;\n        &lt;/dependency&gt;\n</code></pre>\n<h2>full pom.xml</h2>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;project xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;\n         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    &lt;groupId&gt;com.example&lt;/groupId&gt;\n    &lt;artifactId&gt;quarkus-demo&lt;/artifactId&gt;\n    &lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt;\n\n    &lt;properties&gt;\n        &lt;compiler-plugin.version&gt;3.14.1&lt;/compiler-plugin.version&gt;\n        &lt;maven.compiler.release&gt;17&lt;/maven.compiler.release&gt;\n        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\n        &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;\n        &lt;quarkus.platform.artifact-id&gt;quarkus-bom&lt;/quarkus.platform.artifact-id&gt;\n        &lt;quarkus.platform.group-id&gt;io.quarkus.platform&lt;/quarkus.platform.group-id&gt;\n        &lt;quarkus.platform.version&gt;3.29.2&lt;/quarkus.platform.version&gt;\n        &lt;skipITs&gt;true&lt;/skipITs&gt;\n        &lt;surefire-plugin.version&gt;3.5.4&lt;/surefire-plugin.version&gt;\n    &lt;/properties&gt;\n\n    &lt;dependencyManagement&gt;\n        &lt;dependencies&gt;\n            &lt;dependency&gt;\n                &lt;groupId&gt;${quarkus.platform.group-id}&lt;/groupId&gt;\n                &lt;artifactId&gt;${quarkus.platform.artifact-id}&lt;/artifactId&gt;\n                &lt;version&gt;${quarkus.platform.version}&lt;/version&gt;\n                &lt;type&gt;pom&lt;/type&gt;\n                &lt;scope&gt;import&lt;/scope&gt;\n            &lt;/dependency&gt;\n        &lt;/dependencies&gt;\n    &lt;/dependencyManagement&gt;\n\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;io.quarkus&lt;/groupId&gt;\n            &lt;artifactId&gt;quarkus-arc&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;io.quarkus&lt;/groupId&gt;\n            &lt;artifactId&gt;quarkus-rest&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;io.quarkiverse.logging.logback&lt;/groupId&gt;\n            &lt;artifactId&gt;quarkus-logging-logback&lt;/artifactId&gt;\n            &lt;version&gt;1.1.2&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;io.quarkus&lt;/groupId&gt;\n            &lt;artifactId&gt;quarkus-jdbc-postgresql&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;\n            &lt;artifactId&gt;logback-classic&lt;/artifactId&gt;\n            &lt;version&gt;1.4.14&lt;/version&gt;\n            &lt;scope&gt;compile&lt;/scope&gt;\n        &lt;/dependency&gt;\n\n    &lt;/dependencies&gt;\n\n    &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;${quarkus.platform.group-id}&lt;/groupId&gt;\n                &lt;artifactId&gt;quarkus-maven-plugin&lt;/artifactId&gt;\n                &lt;version&gt;${quarkus.platform.version}&lt;/version&gt;\n                &lt;extensions&gt;true&lt;/extensions&gt;\n                &lt;executions&gt;\n                    &lt;execution&gt;\n                        &lt;goals&gt;\n                            &lt;goal&gt;build&lt;/goal&gt;\n                            &lt;goal&gt;generate-code&lt;/goal&gt;\n                            &lt;goal&gt;generate-code-tests&lt;/goal&gt;\n                            &lt;goal&gt;native-image-agent&lt;/goal&gt;\n                        &lt;/goals&gt;\n                    &lt;/execution&gt;\n                &lt;/executions&gt;\n            &lt;/plugin&gt;\n            &lt;plugin&gt;\n                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\n                &lt;version&gt;${compiler-plugin.version}&lt;/version&gt;\n                &lt;configuration&gt;\n                    &lt;parameters&gt;true&lt;/parameters&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n            &lt;plugin&gt;\n                &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;\n                &lt;version&gt;${surefire-plugin.version}&lt;/version&gt;\n                &lt;configuration&gt;\n                    &lt;argLine&gt;--add-opens java.base/java.lang=ALL-UNNAMED&lt;/argLine&gt;\n                    &lt;systemPropertyVariables&gt;\n                        &lt;java.util.logging.manager&gt;org.jboss.logmanager.LogManager&lt;/java.util.logging.manager&gt;\n                        &lt;maven.home&gt;${maven.home}&lt;/maven.home&gt;\n                    &lt;/systemPropertyVariables&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n            &lt;plugin&gt;\n                &lt;artifactId&gt;maven-failsafe-plugin&lt;/artifactId&gt;\n                &lt;version&gt;${surefire-plugin.version}&lt;/version&gt;\n                &lt;executions&gt;\n                    &lt;execution&gt;\n                        &lt;goals&gt;\n                            &lt;goal&gt;integration-test&lt;/goal&gt;\n                            &lt;goal&gt;verify&lt;/goal&gt;\n                        &lt;/goals&gt;\n                    &lt;/execution&gt;\n                &lt;/executions&gt;\n                &lt;configuration&gt;\n                    &lt;argLine&gt;--add-opens java.base/java.lang=ALL-UNNAMED&lt;/argLine&gt;\n                    &lt;systemPropertyVariables&gt;\n                        &lt;native.image.path&gt;${project.build.directory}/${project.build.finalName}-runner\n                        &lt;/native.image.path&gt;\n                        &lt;java.util.logging.manager&gt;org.jboss.logmanager.LogManager&lt;/java.util.logging.manager&gt;\n                        &lt;maven.home&gt;${maven.home}&lt;/maven.home&gt;\n                    &lt;/systemPropertyVariables&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n\n    &lt;profiles&gt;\n        &lt;profile&gt;\n            &lt;id&gt;native&lt;/id&gt;\n            &lt;activation&gt;\n                &lt;property&gt;\n                    &lt;name&gt;native&lt;/name&gt;\n                &lt;/property&gt;\n            &lt;/activation&gt;\n            &lt;properties&gt;\n                &lt;quarkus.package.jar.enabled&gt;false&lt;/quarkus.package.jar.enabled&gt;\n                &lt;skipITs&gt;false&lt;/skipITs&gt;\n                &lt;quarkus.native.enabled&gt;true&lt;/quarkus.native.enabled&gt;\n            &lt;/properties&gt;\n        &lt;/profile&gt;\n    &lt;/profiles&gt;\n&lt;/project&gt;\n</code></pre>\n<p>Final</p>\n<pre><code>quarkus-demo\n├── pom.xml             &lt;-- Change\n├── README.md\n├── init_logback_my.sql &lt;-- New\n└── src\n    └── main\n        ├── docker\n        ...\n        ├── java\n        │   └── com\n        │       └── example\n        │           ├── GreetingResource.java          &lt;-- Change\n        │           └── log\n        │               ├── AsyncPostgresAppender.java &lt;-- New\n        │               └── PostgresAppender.java      &lt;-- New\n        └── resources\n            ├── application.properties\n            └── logback.xml             &lt;-- New\n</code></pre>\n<h1>Build For JVM</h1>\n<pre><code>mvn clean package\n</code></pre>\n<h2>Run</h2>\n<pre><code>java -jar target/quarkus-app/quarkus-run.jar\n</code></pre>\n<h2>Test</h2>\n<pre><code>curl http://localhost:8080/hello\n\ncurl http://localhost:8080/hello/John\n\ncurl http://localhost:8080/hello/with-query?name=John\n</code></pre>\n<h2>Verify</h2>\n<p>Using database tools, connect to PostgreSQL, inspect the table, and see if there are any records of the logs we just wrote.</p>\n<p><a href=\"https://i.sstatic.net/3K0PTElD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/3K0PTElD.png\" alt=\"enter image description here\" /></a>.</p>\n<h1>Build For Native</h1>\n<pre><code>mvn clean package -Dnative\n</code></pre>\n<h2>Run</h2>\n<pre><code>./target/quarkus-demo-1.0.0-SNAPSHOT-runner\n</code></pre>\n<h2>Test</h2>\n<pre><code>curl http://localhost:8080/hello\n\ncurl http://localhost:8080/hello/John\n\ncurl http://localhost:8080/hello/with-query?name=John\n</code></pre>\n<p>Console Output:</p>\n<pre><code>$ ./target/quarkus-demo-1.0.0-SNAPSHOT-runner\n2025-11-12 15:47:43,128 INFO  io.quarkus - ***&gt;&gt;&gt; quarkus-demo 1.0.0-SNAPSHOT native (powered by Quarkus 3.29.2) started in 0.085s. Listening on: http://0.0.0.0:8080\n2025-11-12 15:47:43,187 INFO  io.quarkus - ***&gt;&gt;&gt; Profile prod activated. \n2025-11-12 15:47:43,237 INFO  io.quarkus - ***&gt;&gt;&gt; Installed features: [agroal, cdi, jdbc-postgresql, logging-logback, narayana-jta, rest, smallrye-context-propagation, vertx]\n2025-11-12 15:47:59,785 INFO  com.example.GreetingResource - ***&gt;&gt;&gt; call hello().\n2025-11-12 15:47:59,864 INFO  com.example.GreetingResource - ***&gt;&gt;&gt; Received name: John\n2025-11-12 15:47:59,939 INFO  com.example.GreetingResource - ***&gt;&gt;&gt; Received query name: John\n</code></pre>\n<h2>Verify</h2>\n<p>Using database tools, connect to PostgreSQL, inspect the table, and see if there are any records of the logs we just wrote.</p>\n<p><a href=\"https://i.sstatic.net/XWiBIajc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/XWiBIajc.png\" alt=\"enter image description here\" /></a>.</p>\n<p>The above is executable. It's not perfect, but it's executable.</p>\n<p>There are many more test combinations (Round 4, 5, 6,....), but they all failed.</p>\n<p>Only this imperfect but executable example is retained.</p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 26698569,
      "reputation" : 4070,
      "user_id" : 20306007,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/98bbc403493aee3681b71dae7abef66e?s=256&d=identicon&r=PG",
      "display_name" : "life888888",
      "link" : "https://stackoverflow.com/users/20306007/life888888"
    },
    "creation_date" : 1762962817,
    "last_activity_date" : 1762963352,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140848755,
    "post_id" : 79816348,
    "body" : "I&#39;m not sure if it is possible that way, just read that extending ExtHandler could work... I do not mind migrating to another logger. Do you have examples for Quarkus?",
    "score" : 0,
    "owner" : {
      "account_id" : 44635457,
      "reputation" : 3,
      "user_id" : 31855812,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/469e8deed036952b99e9b5bba8127437?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "user31855812",
      "link" : "https://stackoverflow.com/users/31855812/user31855812"
    },
    "creation_date" : 1762873120,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140848672,
    "post_id" : 79816348,
    "body" : "Have you considered migrating the underlying logging to SLF4J + LOG4J2 or SLF4J + LOGBACK? We would use the Appender of LOG4J2 or LOGBACK to write logs to the DB (using a JDBC Appender or Cassandra Appender).",
    "score" : 0,
    "owner" : {
      "account_id" : 26698569,
      "reputation" : 4070,
      "user_id" : 20306007,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/98bbc403493aee3681b71dae7abef66e?s=256&d=identicon&r=PG",
      "display_name" : "life888888",
      "link" : "https://stackoverflow.com/users/20306007/life888888"
    },
    "creation_date" : 1762870301,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140848056,
    "post_id" : 79816348,
    "body" : "Are you sure is it possibile di add a new handler in that way? I&#39;ve checked documentation but I haven&#39;t found anything about custom handler support...",
    "score" : 0,
    "owner" : {
      "account_id" : 3052937,
      "reputation" : 18534,
      "user_id" : 2587166,
      "user_type" : "registered",
      "accept_rate" : 83,
      "profile_image" : "https://i.sstatic.net/pgHgd.jpg?s=256",
      "display_name" : "Luca Basso Ricci",
      "link" : "https://stackoverflow.com/users/2587166/luca-basso-ricci"
    },
    "creation_date" : 1762847312,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}