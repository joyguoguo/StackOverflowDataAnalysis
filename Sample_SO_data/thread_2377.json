{
  "question" : {
    "question_id" : 79624468,
    "title" : "Spring AI Pgvector | VectorStore Bad Return Type With Jackson",
    "body" : "<p>I am using some 3rd party cloud platform which requires jackson with version <code>2.7.9</code>. When integrating wit Pgvector and Spring AI, during the application startup, it gives error about Bad Return Type of Pgvector Factory method,coming from jackson.</p>\n<p>Maven <code>Pom.xml</code></p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;properties&gt;\n        &lt;spring-ai.version&gt;1.0.0-M6&lt;/spring-ai.version&gt;\n    &lt;/properties&gt;\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.ai&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-ai-pgvector-store-spring-boot-starter&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.fasterxml.jackson.module&lt;/groupId&gt;\n            &lt;artifactId&gt;jackson-module-jakarta-xmlbind-annotations&lt;/artifactId&gt;\n            &lt;version&gt;2.13.3&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.amazonaws&lt;/groupId&gt;\n            &lt;artifactId&gt;aws-java-sdk-iam&lt;/artifactId&gt;\n            &lt;version&gt;1.11.998&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.amazonaws&lt;/groupId&gt;\n            &lt;artifactId&gt;aws-java-sdk-s3&lt;/artifactId&gt;\n            &lt;version&gt;1.11.336&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.amazonaws&lt;/groupId&gt;\n            &lt;artifactId&gt;aws-java-sdk-sts&lt;/artifactId&gt;\n            &lt;version&gt;1.11.336&lt;/version&gt;\n        &lt;/dependency&gt;\n        \n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.ai&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-ai-openai-spring-boot-starter&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.ai&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-ai-pdf-document-reader&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n    &lt;/dependencies&gt;\n    &lt;dependencyManagement&gt;\n        &lt;dependencies&gt;\n            &lt;dependency&gt;\n                &lt;groupId&gt;com.fasterxml.jackson.datatype&lt;/groupId&gt;\n                &lt;artifactId&gt;jackson-datatype-jsr310&lt;/artifactId&gt;\n                &lt;version&gt;2.7.9&lt;/version&gt;\n            &lt;/dependency&gt;\n\n            &lt;dependency&gt;\n                &lt;groupId&gt;org.springframework.ai&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-ai-bom&lt;/artifactId&gt;\n                &lt;version&gt;${spring-ai.version}&lt;/version&gt;\n                &lt;type&gt;pom&lt;/type&gt;\n                &lt;scope&gt;import&lt;/scope&gt;\n            &lt;/dependency&gt;\n        &lt;/dependencies&gt;\n    &lt;/dependencyManagement&gt;\n</code></pre>\n<p>Terminal Error log</p>\n<pre><code>1: Error creating bean with name 'vectorStore' defined in class path resource [org/springframework/ai/autoconfigure/vectorstore/pgvector/PgVectorStoreAutoConfiguration.class]: Failed to instantiate [org.springframework.ai.vectorstore.pgvector.PgVectorStore]: Factory method 'vectorStore' threw exception with message: Bad return type\nException Details:\n  Location:\n    com/fasterxml/jackson/databind/cfg/MapperBuilder.streamFactory()Lcom/fasterxml/jackson/core/TokenStreamFactory; @7: areturn\n  Reason:\n    Type 'com/fasterxml/jackson/core/JsonFactory' (current frame, stack[0]) is not assignable to 'com/fasterxml/jackson/core/TokenStreamFactory' (from method signature)\n  Current Frame:\n    bci: @7\n    flags: { }\n    locals: { 'com/fasterxml/jackson/databind/cfg/MapperBuilder' }\n    stack: { 'com/fasterxml/jackson/core/JsonFactory' }\n  Bytecode:\n    0000000: 2ab4 0002 b600 08b0                    \n</code></pre>\n",
    "tags" : [ "java", "spring", "pgvector", "spring-ai" ],
    "owner" : {
      "account_id" : 21815610,
      "reputation" : 11,
      "user_id" : 16112471,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/28e55cf13e5016a5bbe2923f42852879?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "YihanDuan",
      "link" : "https://stackoverflow.com/users/16112471/yihanduan"
    },
    "is_answered" : false,
    "view_count" : 72,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1747369440,
    "creation_date" : 1747369440,
    "link" : "https://stackoverflow.com/questions/79624468/spring-ai-pgvector-vectorstore-bad-return-type-with-jackson",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ ],
  "answer_comments" : { }
}