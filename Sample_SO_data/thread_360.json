{
  "question" : {
    "question_id" : 79812806,
    "title" : "Integrating a Jakarta Persistence implementation with modular JavaFX/Maven/JLink app",
    "body" : "<p>Quick background information for context: I'm writing a relatively small tool for a small gaming community to download and manage user generated content. It's a modular Java 24 + JavaFX Project done with Maven and IntelliJ.</p>\n<p>I store data on a SQLite DB. So far I've used bare-metal <a href=\"https://en.wikipedia.org/wiki/Java_Database_Connectivity\" rel=\"nofollow noreferrer\">JDBC</a> and wrote queries myself. As the tool grows, I would like to simplify DB access. At work we use <a href=\"https://en.wikipedia.org/wiki/Hibernate_(framework)\" rel=\"nofollow noreferrer\">Hibernate</a> <a href=\"https://en.wikipedia.org/wiki/Object%E2%80%93relational_mapping\" rel=\"nofollow noreferrer\">ORM</a> in a <a href=\"https://en.wikipedia.org/wiki/Jakarta_EE\" rel=\"nofollow noreferrer\">Jakarta EE</a> environment with <a href=\"https://jakarta.ee/specifications/cdi/\" rel=\"nofollow noreferrer\">Jakarta Contexts and Dependency Injection (CDI)</a> etc., but I've read you can use Hibernate without relying on dependency injection.</p>\n<p>So I've tried Hibernate for my tool and it does work well in my dev environment. Problems arise when trying to package a build via jlink, specifically using the <code>javafx-maven-plugin</code> to make things a lot easier for me.</p>\n<p>The downside is that Hibernate does not seem to be modularized. Meaning I cannot easily package it with <a href=\"https://openjdk.org/jeps/282\" rel=\"nofollow noreferrer\"><em>jlink</em></a>. Running <code>mvn javafx:jlink</code> reports the &quot;automatic module cannot be used with jlink&quot;.</p>\n<p>I've then tried <a href=\"https://en.wikipedia.org/wiki/EclipseLink\" rel=\"nofollow noreferrer\">EclipseLink</a> as an alternative <a href=\"https://jakarta.ee/specifications/persistence/\" rel=\"nofollow noreferrer\">Jakarta Persistence (JPA)</a> implementation, had no issues with automatic modules but other resources apparently not being properly packaged with jlink. Specifically some locale resources appeared to be missing when trying to launch the packaged app, so they got left out the final package.</p>\n<p>The last resort would be trying some SQL-first libraries like <a href=\"https://en.wikipedia.org/wiki/JOOQ_Object_Oriented_Querying\" rel=\"nofollow noreferrer\">jOOQ</a> to at least make it more bearable than plain JDBC. But I'd really prefer a Jakarta Persistence/ORM approach to keep database handling as easy and painless as possible.</p>\n<p>Does anyone have a working approach I can use for my case? Or share your setup that actually works for you? Or find a way to get any Jakarta Persistence implementation to work well with the module system and Maven/JLink? The reason I'm using these is that packaging really is as simple as invoking a single Maven goal and for the most part that worked really well. Especially because of that I'm hesitant to get into any other packaging method, like the other jlink Maven plugin or something like jpackage, which seem to be very tedious to configure and get working.</p>\n",
    "tags" : [ "java", "hibernate", "maven", "jpa", "javafx" ],
    "owner" : {
      "account_id" : 10369604,
      "reputation" : 561,
      "user_id" : 7647658,
      "user_type" : "registered",
      "accept_rate" : 71,
      "profile_image" : "https://lh4.googleusercontent.com/-q6rixRNwaEM/AAAAAAAAAAI/AAAAAAAAAB4/lkaUbIx6x9E/s256-rj/photo.jpg",
      "display_name" : "GenerationLost",
      "link" : "https://stackoverflow.com/users/7647658/generationlost"
    },
    "is_answered" : true,
    "view_count" : 158,
    "answer_count" : 1,
    "score" : 5,
    "last_activity_date" : 1762684722,
    "creation_date" : 1762551301,
    "link" : "https://stackoverflow.com/questions/79812806/integrating-a-jakarta-persistence-implementation-with-modular-javafx-maven-jlink",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79814249,
    "question_id" : 79812806,
    "body" : "<p>The remaining issue that prevented my jlink build was rather simple to solve, thanks to a crucial hint in the <a href=\"https://stackoverflow.com/questions/79812806/jpa-implementation-that-works-well-with-javafx-maven-jlink#comment140842732_79812806\">comments by jewelsea</a>. So here is a more complete overview of a working scenario.</p>\n<p><a href=\"https://mvnrepository.com/artifact/org.eclipse.persistence/eclipselink\" rel=\"nofollow noreferrer\">EclipseLink</a> is a modular dependency that works well with jlink packaging through the <a href=\"https://mvnrepository.com/artifact/org.openjfx/javafx-maven-plugin\" rel=\"nofollow noreferrer\"><code>javafx-maven-plugin</code></a>. To satisfy dependency modules on <code>jakarta.transaction</code>, an additional dependency to <code>jakarta.enterprise.cdi-api</code> is needed in your Maven project, even if <a href=\"https://jakarta.ee/specifications/cdi/\" rel=\"nofollow noreferrer\">CDI</a> is not used in the project itself.</p>\n<p>Required modules in the <a href=\"https://www.baeldung.com/java-modularity\" rel=\"nofollow noreferrer\"><code>module-info.java</code></a> file would be:</p>\n<ul>\n<li>jakarta.persistence</li>\n<li>jakarta.transaction</li>\n<li>org.eclipse.persistence.jpa</li>\n<li>org.eclipse.persistence.core</li>\n</ul>\n<h2><code>include-locales</code></h2>\n<p>The last missing step is to let jlink include locales, so the necessary resources needed for EclipseLink are bundled with the application. For this, an option needs to be added to the <code>javafx-maven-plugin</code>:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;options&gt;\n    &lt;option&gt;--include-locales=en&lt;/option&gt;\n&lt;/options&gt;\n</code></pre>\n<p>This way, there are no dependencies on automatic modules that jlink can't handle (like for example with <code>hibernate</code>) and the packaging and resulting runtime image works just fine.</p>\n",
    "score" : 4,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 10369604,
      "reputation" : 561,
      "user_id" : 7647658,
      "user_type" : "registered",
      "accept_rate" : 71,
      "profile_image" : "https://lh4.googleusercontent.com/-q6rixRNwaEM/AAAAAAAAAAI/AAAAAAAAAB4/lkaUbIx6x9E/s256-rj/photo.jpg",
      "display_name" : "GenerationLost",
      "link" : "https://stackoverflow.com/users/7647658/generationlost"
    },
    "creation_date" : 1762613527,
    "last_activity_date" : 1762684722,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140844472,
    "post_id" : 79812806,
    "body" : "Define, link, or tag your abbreviations on first use, such as “UGC”. And the Jakarta EE community has moved away from using the abbreviations, preferring full names of their technologies.",
    "score" : 0,
    "owner" : {
      "account_id" : 322981,
      "reputation" : 346951,
      "user_id" : 642706,
      "user_type" : "registered",
      "accept_rate" : 58,
      "profile_image" : "https://i.sstatic.net/ZWEI3.jpg?s=256",
      "display_name" : "Basil Bourque",
      "link" : "https://stackoverflow.com/users/642706/basil-bourque"
    },
    "creation_date" : 1762618321,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140844403,
    "post_id" : 79812806,
    "body" : "@Slaw, yes I use both ways too",
    "score" : 0,
    "owner" : {
      "account_id" : 5998820,
      "reputation" : 16283,
      "user_id" : 4712734,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/f6e922a2cb7e2da59286f27b162aaca5?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "DuncG",
      "link" : "https://stackoverflow.com/users/4712734/duncg"
    },
    "creation_date" : 1762614410,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140844400,
    "post_id" : 79812806,
    "body" : "@DuncG &quot;<i>ie It is still worthwhile using jlink&quot;</i> -- Just want to point out that jpackage <i>always</i> uses jlink when creating the application image, whether via <code>--runtime-image</code> for a preexisting runtime image or via arguments like <code>--module-path</code>, <code>--add-modules</code>, and <code>--jlink-options</code> for a runtime image it generates in the same invocation.",
    "score" : 1,
    "owner" : {
      "account_id" : 8532578,
      "reputation" : 49884,
      "user_id" : 6395627,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/af0f9bfe593f36642a032cd7ea611e7d?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Slaw",
      "link" : "https://stackoverflow.com/users/6395627/slaw"
    },
    "creation_date" : 1762614290,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140843316,
    "post_id" : 79812806,
    "body" : "@jewelsea this singlehandedly solved the issue I had with the EclipseLink implementation re jlink. Thank you for this. Considering this is now a working solution within my constraints, I&#39;ll add this as the solution to my question (as soon as the question is re-opened)",
    "score" : 3,
    "owner" : {
      "account_id" : 10369604,
      "reputation" : 561,
      "user_id" : 7647658,
      "user_type" : "registered",
      "accept_rate" : 71,
      "profile_image" : "https://lh4.googleusercontent.com/-q6rixRNwaEM/AAAAAAAAAAI/AAAAAAAAAB4/lkaUbIx6x9E/s256-rj/photo.jpg",
      "display_name" : "GenerationLost",
      "link" : "https://stackoverflow.com/users/7647658/generationlost"
    },
    "creation_date" : 1762606624,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140843073,
    "post_id" : 79812806,
    "body" : "@VGR Sorry for confusion, I mean that jlink can be setup to make a runtime on part of the module dependencies such as jre+javafx+others, and jpackage uses the combination. ie It is still worthwhile using jlink.",
    "score" : 0,
    "owner" : {
      "account_id" : 5998820,
      "reputation" : 16283,
      "user_id" : 4712734,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/f6e922a2cb7e2da59286f27b162aaca5?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "DuncG",
      "link" : "https://stackoverflow.com/users/4712734/duncg"
    },
    "creation_date" : 1762589275,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140842911,
    "post_id" : 79812806,
    "body" : "@DuncG jlink can only work with non-automatic named modules (i.e., the module must have a <code>module-info</code> descriptor). But you&#39;re right about jpackage; that tool can work with non-modular code.",
    "score" : 2,
    "owner" : {
      "account_id" : 8532578,
      "reputation" : 49884,
      "user_id" : 6395627,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/af0f9bfe593f36642a032cd7ea611e7d?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Slaw",
      "link" : "https://stackoverflow.com/users/6395627/slaw"
    },
    "creation_date" : 1762573469,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140842796,
    "post_id" : 79812806,
    "body" : "@DuncG I was under the impression that non-modular jars cannot be jlink&#39;d.",
    "score" : 0,
    "owner" : {
      "account_id" : 2053598,
      "reputation" : 44936,
      "user_id" : 1831987,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/38b1c37530189ec4471a43a618e33f67?s=256&d=identicon&r=PG",
      "display_name" : "VGR",
      "link" : "https://stackoverflow.com/users/1831987/vgr"
    },
    "creation_date" : 1762558376,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140842732,
    "post_id" : 79812806,
    "body" : "<i>&quot;some locale resources appeared to be missing when trying to launch the packaged app&quot;</i> -&gt; jlink has options for handling locales, see <a href=\"https://docs.oracle.com/en/java/javase/25/docs/specs/man/jlink.html#plugin-include-locales\" rel=\"nofollow noreferrer\"><code>include-locales</code></a>.",
    "score" : 3,
    "owner" : {
      "account_id" : 1180113,
      "reputation" : 160457,
      "user_id" : 1155209,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/5192e7cbcf2f72a847d6fb0d1552f049?s=256&d=identicon&r=PG",
      "display_name" : "jewelsea",
      "link" : "https://stackoverflow.com/users/1155209/jewelsea"
    },
    "creation_date" : 1762554110,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140842718,
    "post_id" : 79812806,
    "body" : "It seems a bit extreme to re-implement a working application just because Maven isn&#39;t applying the right steps for jlink / jpackage (both of which work fine with modular or non-module jars).",
    "score" : 2,
    "owner" : {
      "account_id" : 5998820,
      "reputation" : 16283,
      "user_id" : 4712734,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/f6e922a2cb7e2da59286f27b162aaca5?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "DuncG",
      "link" : "https://stackoverflow.com/users/4712734/duncg"
    },
    "creation_date" : 1762553313,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140842692,
    "post_id" : 79812806,
    "body" : "And if you use it right (clean code architecture) you can even migrate it to a web version with spring boot without hassle.",
    "score" : 0,
    "owner" : {
      "account_id" : 209503,
      "reputation" : 23867,
      "user_id" : 460557,
      "user_type" : "registered",
      "accept_rate" : 100,
      "profile_image" : "https://www.gravatar.com/avatar/b4565f97815833390c9c880e9e8522e4?s=256&d=identicon&r=PG",
      "display_name" : "Jorge Campos",
      "link" : "https://stackoverflow.com/users/460557/jorge-campos"
    },
    "creation_date" : 1762551890,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140842691,
    "post_id" : 79812806,
    "body" : "I would suggest using Spring Boot + JavaFX. SB will give you all the power of the framework for your use cases plus a bunch more if you need in the future, it is well maintained and it will be fairly easier to upgrade in future (new versions). Take a look at this <a href=\"https://spring.io/blog/2019/01/16/spring-tips-javafx\" rel=\"nofollow noreferrer\">spring.io/blog/2019/01/16/spring-tips-javafx</a>",
    "score" : 0,
    "owner" : {
      "account_id" : 209503,
      "reputation" : 23867,
      "user_id" : 460557,
      "user_type" : "registered",
      "accept_rate" : 100,
      "profile_image" : "https://www.gravatar.com/avatar/b4565f97815833390c9c880e9e8522e4?s=256&d=identicon&r=PG",
      "display_name" : "Jorge Campos",
      "link" : "https://stackoverflow.com/users/460557/jorge-campos"
    },
    "creation_date" : 1762551820,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79814249" : [ {
      "comment_id" : 140865271,
      "post_id" : 79814249,
      "body" : "@jewelsea At least in Java 25, jlink fails for me with &quot;<i>Error: jdk.localedata module was not specified with --add-modules option</i>&quot; if I pass <code>--include-locales</code> without ensuring the <code>jdk.localedata</code> module is resolved (even if I only include the &quot;en-US&quot; locale). I suspect that module is being resolved by other means for GenerationLost (perhaps indirectly required by one of the root modules) since they aren&#39;t getting that error. Or maybe the error was added in Java 25.",
      "score" : 1,
      "owner" : {
        "account_id" : 8532578,
        "reputation" : 49884,
        "user_id" : 6395627,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/af0f9bfe593f36642a032cd7ea611e7d?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "Slaw",
        "link" : "https://stackoverflow.com/users/6395627/slaw"
      },
      "creation_date" : 1763677494,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140851620,
      "post_id" : 79814249,
      "body" : "You are only including an English locale.  What <a href=\"https://docs.oracle.com/en/java/javase/25/docs/api/jdk.localedata/module-summary.html\" rel=\"nofollow noreferrer\"><code>jdk.localedata</code></a> does is provide &quot;the locale data for locales other than US locale.&quot;. The US locale is, &quot;en-US&quot;, so it includes English already.  If you needed a different locale that didn&#39;t use English, then possibly your app would fail without the appropriate data from the <code>jdk.localedata</code> module.",
      "score" : 2,
      "owner" : {
        "account_id" : 1180113,
        "reputation" : 160457,
        "user_id" : 1155209,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/5192e7cbcf2f72a847d6fb0d1552f049?s=256&d=identicon&r=PG",
        "display_name" : "jewelsea",
        "link" : "https://stackoverflow.com/users/1155209/jewelsea"
      },
      "creation_date" : 1763007100,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140851380,
      "post_id" : 79814249,
      "body" : "@jewelsea I&#39;m not sure why exactly this is required, but thanks for the information. Specifically for my project it does not seem to be required, as in the final build runs without issue even without the module mentioned.",
      "score" : 0,
      "owner" : {
        "account_id" : 10369604,
        "reputation" : 561,
        "user_id" : 7647658,
        "user_type" : "registered",
        "accept_rate" : 71,
        "profile_image" : "https://lh4.googleusercontent.com/-q6rixRNwaEM/AAAAAAAAAAI/AAAAAAAAAB4/lkaUbIx6x9E/s256-rj/photo.jpg",
        "display_name" : "GenerationLost",
        "link" : "https://stackoverflow.com/users/7647658/generationlost"
      },
      "creation_date" : 1762986235,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140847517,
      "post_id" : 79814249,
      "body" : "The <code>jlink</code> documentation for <a href=\"https://docs.oracle.com/en/java/javase/25/docs/specs/man/jlink.html#plugin-include-locales\" rel=\"nofollow noreferrer\"><code>--include-locales</code></a>, also says: <i>&quot;Ensure that you add the module <code>jdk.localedata</code> when using this option.&quot;</i>, example <code>--add-modules jdk.localedata --include-locales=en,ja,*-IN</code>.  If using the JavaFX Maven plugin you could either <code>requires jdk.localedata</code> in your <code>module-info.java</code>, or add it as an option to the plugin: <code>&lt;option&gt;--add-modules jdk.locale.data&lt;&#47;option&gt;</code>.",
      "score" : 2,
      "owner" : {
        "account_id" : 1180113,
        "reputation" : 160457,
        "user_id" : 1155209,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/5192e7cbcf2f72a847d6fb0d1552f049?s=256&d=identicon&r=PG",
        "display_name" : "jewelsea",
        "link" : "https://stackoverflow.com/users/1155209/jewelsea"
      },
      "creation_date" : 1762807219,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}