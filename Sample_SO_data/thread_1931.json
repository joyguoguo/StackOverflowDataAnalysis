{
  "question" : {
    "question_id" : 79663008,
    "title" : "How to send a complex object in dynamo attribute using sdk?",
    "body" : "<p>I am trying to insert a record in dynamodb and then get it processed using a lambda via SQS. This record contains a complex object. When I am inserting it using the sdk, i am able to see the record in dynamodb as a JSON string but when it is being read by the lambda, it is not getting serialized correctly. Below is the record to be inserted:</p>\n<pre><code>class Person {\nint age, \nString name, \nAddress address }\n\nclass Address {\n  String street,\nStrint country }\n</code></pre>\n<p>record in dynamodb is:</p>\n<pre><code>&quot;Address&quot;:&quot;{\\&quot;street&quot;:\\&quot;1\\&quot;, \\&quot;country\\&quot;:&quot;\\IN\\&quot; }&quot;.\n</code></pre>\n<p>I want the address record to be in simple json form so that I can map it to a java POJO:</p>\n<p><code>&quot;Address&quot;:{&quot;street&quot;:&quot;1&quot;, &quot;country&quot;:&quot;IN&quot; }</code> .</p>\n<p>should I change the attribute type or how should i proceed with this?</p>\n",
    "tags" : [ "java", "amazon-dynamodb", "aws-sdk", "amazon-sqs" ],
    "owner" : {
      "account_id" : 3135892,
      "reputation" : 1541,
      "user_id" : 2652405,
      "user_type" : "registered",
      "accept_rate" : 38,
      "profile_image" : "https://www.gravatar.com/avatar/95fa845d233e25f4a2a0c8cc792a07a4?s=256&d=identicon&r=PG",
      "display_name" : "AppleBud",
      "link" : "https://stackoverflow.com/users/2652405/applebud"
    },
    "is_answered" : false,
    "view_count" : 42,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1756808987,
    "creation_date" : 1749709017,
    "link" : "https://stackoverflow.com/questions/79663008/how-to-send-a-complex-object-in-dynamo-attribute-using-sdk",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79753377,
    "question_id" : 79663008,
    "body" : "<p>If I understood properly, the problem is:<br />\nYou’re storing <code>Address</code> as a <strong>string (S)</strong> with JSON inside, so Lambda reads <code>&quot;Address&quot;:&quot;{\\&quot;street\\&quot;:\\&quot;1\\&quot;,\\&quot;country\\&quot;:\\&quot;IN\\&quot;}&quot;</code>. But your POJO mapping expects a <strong>map/document (M)</strong>: <code>&quot;Address&quot;:{&quot;street&quot;:&quot;1&quot;,&quot;country&quot;:&quot;IN&quot;}</code>. The types don’t match → deserialization fails.</p>\n<p>Usage of the <code>DynamoDbEnhancedClient</code> could be a solution. Something like this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>import software.amazon.awssdk.services.dynamodb.DynamoDbClient;\nimport software.amazon.awssdk.enhanced.dynamodb.*;\nimport software.amazon.awssdk.enhanced.dynamodb.mapper.annotations.*;\n\n@DynamoDbBean\npublic class Person {\n    private String id;\n    private Integer age;\n    private String name;\n    private Address address;\n\n    @DynamoDbPartitionKey\n    public String getId() { return id; }\n    public void setId(String id) { this.id = id; }\n\n    public Integer getAge() { return age; }\n    public void setAge(Integer age) { this.age = age; }\n\n    public String getName() { return name; }\n    public void setName(String name) { this.name = name; }\n\n    // Nested bean will be stored as a Map (document attribute)\n    public Address getAddress() { return address; }\n    public void setAddress(Address address) { this.address = address; }\n}\n\n@DynamoDbBean\npublic class Address {\n    private String street;\n    private String country;\n\n    public String getStreet() { return street; }\n    public void setStreet(String street) { this.street = street; }\n\n    public String getCountry() { return country; }\n    public void setCountry(String country) { this.country = country; }\n}\n\n// --- usage ---\nDynamoDbClient low = DynamoDbClient.create();\nDynamoDbEnhancedClient enhanced = DynamoDbEnhancedClient.builder()\n        .dynamoDbClient(low)\n        .build();\n\nDynamoDbTable&lt;Person&gt; table = enhanced.table(\n        &quot;People&quot;,\n        TableSchema.fromBean(Person.class)\n);\n\n// Write\nPerson p = new Person();\np.setId(&quot;person#123&quot;);\np.setAge(30);\np.setName(&quot;John&quot;);\nAddress a = new Address();\na.setStreet(&quot;1&quot;);\na.setCountry(&quot;IN&quot;);\np.setAddress(a);\n\ntable.putItem(p);\n\n// Read (Lambda side)\nPerson loaded = table.getItem(Key.builder().partitionValue(&quot;person#123&quot;).build());\n</code></pre>\n<p>In this case Address would be stored in DynamoDB as a Map (M), not a string:</p>\n<pre><code>{\n  &quot;PK&quot;: &quot;person#123&quot;,\n  &quot;Age&quot;: 30,\n  &quot;Name&quot;: &quot;John&quot;,\n  &quot;Address&quot;: { &quot;street&quot;: &quot;1&quot;, &quot;country&quot;: &quot;IN&quot; }\n}\n</code></pre>\n<p>Such a way your Lambda can map directly to Person/Address without manual JSON parsing.</p>\n<p><strong>If you must keep the low-level client</strong> (for any reason)<strong>,</strong> ensure you build <code>AttributeValue.m(...)</code> for Address instead of <code>s(...)</code>.</p>\n<p>But I'd highly recommend to use the enhanced client.</p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 2259434,
      "reputation" : 315,
      "user_id" : 1989862,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/Znxjz.jpg?s=256",
      "display_name" : "Alexander Yakutskiy",
      "link" : "https://stackoverflow.com/users/1989862/alexander-yakutskiy"
    },
    "creation_date" : 1756808987,
    "last_activity_date" : 1756808987,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140517190,
    "post_id" : 79663008,
    "body" : "Can you elaborate what the purpose of SQS is in your application and why it&#39;s required?",
    "score" : 0,
    "owner" : {
      "account_id" : 8452211,
      "reputation" : 961,
      "user_id" : 6340707,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/sOLxK.jpg?s=256",
      "display_name" : "PeskyPotato",
      "link" : "https://stackoverflow.com/users/6340707/peskypotato"
    },
    "creation_date" : 1750076790,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}