{
  "question" : {
    "question_id" : 79571005,
    "title" : "Need to handle gsettings schema in flatpak-builder",
    "body" : "<p>I have a Java project that uses Java-GI Gtk/Adw bindings. It uses a maven plugin to generate a .desktop, metainfo.xml and .yml manifest. Then I run flatpak-builder:</p>\n<p><code>flatpak-builder --force-clean --user --verbose --install build-dir ca.footeware.java.texty3.yml</code></p>\n<p>No errors but I'm getting one when running it:</p>\n<p><code>flatpak run ca.footeware.java.texty3</code></p>\n<p><code>GLib-GIO-ERROR **: 17:34:02.022: Settings schema 'ca.footeware.java.texty3' is not installed</code></p>\n<p><strong>ca.footeware.java.texty3.yml</strong></p>\n<pre><code>app-id: &quot;ca.footeware.java.texty3&quot;\nruntime: &quot;org.gnome.Platform&quot;\nruntime-version: &quot;48&quot;\nsdk: &quot;org.gnome.Sdk&quot;\nsdk-extensions:\n- &quot;org.freedesktop.Sdk.Extension.openjdk&quot;\ncommand: &quot;texty3&quot;\nmodules:\n- name: &quot;openjdk&quot;\n  buildsystem: &quot;simple&quot;\n  build-commands:\n  - &quot;/usr/lib/sdk/openjdk/install.sh&quot;\n  sources: []\n- name: &quot;texty3&quot;\n  buildsystem: &quot;simple&quot;\n  build-commands:\n  - &quot;install -D ca.footeware.java.texty3.svg /app/share/icons/hicolor/scalable/apps/ca.footeware.java.texty3.svg&quot;\n  - &quot;install -D ca.footeware.java.texty3.desktop /app/share/applications/ca.footeware.java.texty3.desktop&quot;\n  - &quot;install -D ca.footeware.java.texty3.metainfo.xml /app/share/appdata/ca.footeware.java.texty3.metainfo.xml&quot;\n  - &quot;install -D adw-0.11.2.jar /app/share/adw.jar&quot;\n  - &quot;install -D gio-0.11.2.jar /app/share/gio.jar&quot;\n  - &quot;install -D gmodule-0.11.2.jar /app/share/gmodule.jar&quot;\n  - &quot;install -D glib-0.11.2.jar /app/share/glib.jar&quot;\n  - &quot;install -D gobject-0.11.2.jar /app/share/gobject.jar&quot;\n  - &quot;install -D gtk-0.11.2.jar /app/share/gtk.jar&quot;\n  - &quot;install -D gdk-0.11.2.jar /app/share/gdk.jar&quot;\n  - &quot;install -D gdkpixbuf-0.11.2.jar /app/share/gdkpixbuf.jar&quot;\n  - &quot;install -D pango-0.11.2.jar /app/share/pango.jar&quot;\n  - &quot;install -D harfbuzz-0.11.2.jar /app/share/harfbuzz.jar&quot;\n  - &quot;install -D cairo-1.18.4.1.jar /app/share/cairo.jar&quot;\n  - &quot;install -D pangocairo-0.11.2.jar /app/share/pangocairo.jar&quot;\n  - &quot;install -D gsk-0.11.2.jar /app/share/gsk.jar&quot;\n  - &quot;install -D graphene-0.11.2.jar /app/share/graphene.jar&quot;\n  - &quot;install -D texty3.jar /app/share/texty3.jar&quot;\n  - &quot;install -D texty3 /app/bin/texty3&quot;\n  - &quot;mkdir -p /app/share/glib-2.0/schemas&quot;\n  - &quot;install -D ca.footeware.java.texty3.gschema.xml /app/share/glib-2.0/schemas&quot;\n  - &quot;glib-compile-schemas /app/share/glib-2.0/schemas&quot;\n  sources:\n  - type: &quot;file&quot;\n    path: &quot;ca.footeware.java.texty3.svg&quot;\n  - type: &quot;file&quot;\n    path: &quot;ca.footeware.java.texty3.desktop&quot;\n  - type: &quot;file&quot;\n    path: &quot;ca.footeware.java.texty3.metainfo.xml&quot;\n  - type: &quot;file&quot;\n    url: &quot;https://repo.maven.apache.org/maven2/io/github/jwharm/javagi/adw/0.11.2/adw-0.11.2.jar&quot;\n    sha256: &quot;5e5760e8b6f468b3af8a6b33f084019dd576722afda74bc7191c2028902140a0&quot;\n  - type: &quot;file&quot;\n    url: &quot;https://repo.maven.apache.org/maven2/io/github/jwharm/javagi/gio/0.11.2/gio-0.11.2.jar&quot;\n    sha256: &quot;b821be77ecf39f2ebd54dcc08b8a0cfbe0db2c01968af5237f6c21d6f1d5bd9d&quot;\n  - type: &quot;file&quot;\n    url: &quot;https://repo.maven.apache.org/maven2/io/github/jwharm/javagi/gmodule/0.11.2/gmodule-0.11.2.jar&quot;\n    sha256: &quot;029640063c9b23fc7750b09927e24b2f6d6998385bf9b28fc46393814822c5f2&quot;\n  - type: &quot;file&quot;\n    url: &quot;https://repo.maven.apache.org/maven2/io/github/jwharm/javagi/glib/0.11.2/glib-0.11.2.jar&quot;\n    sha256: &quot;e66842ac8303ebe40d76291cebb249183085cfc7fbdea6be28d2a35ac5ad29b6&quot;\n  - type: &quot;file&quot;\n    url: &quot;https://repo.maven.apache.org/maven2/io/github/jwharm/javagi/gobject/0.11.2/gobject-0.11.2.jar&quot;\n    sha256: &quot;f8b770db26920ba8cc621d39ef455262bfb26427425bb743eefa8b99540e5a96&quot;\n  - type: &quot;file&quot;\n    url: &quot;https://repo.maven.apache.org/maven2/io/github/jwharm/javagi/gtk/0.11.2/gtk-0.11.2.jar&quot;\n    sha256: &quot;269224e677ddaa8420314fe839d64ca1bcb243b7b3aa7b77149b19c198488f92&quot;\n  - type: &quot;file&quot;\n    url: &quot;https://repo.maven.apache.org/maven2/io/github/jwharm/javagi/gdk/0.11.2/gdk-0.11.2.jar&quot;\n    sha256: &quot;e114cc15797c00be5b368aef353e22a1ee9cae329c6f9bba62d8561e4a211afd&quot;\n  - type: &quot;file&quot;\n    url: &quot;https://repo.maven.apache.org/maven2/io/github/jwharm/javagi/gdkpixbuf/0.11.2/gdkpixbuf-0.11.2.jar&quot;\n    sha256: &quot;2b2f10fda06b5fd02c379400241c77c11aeaa0401ab67b3fe6ba8d0470b2c1b2&quot;\n  - type: &quot;file&quot;\n    url: &quot;https://repo.maven.apache.org/maven2/io/github/jwharm/javagi/pango/0.11.2/pango-0.11.2.jar&quot;\n    sha256: &quot;74a9203f94c7e95bf5aa40e11e053d3213e1acc347706f8c7e97e91cae20a3f3&quot;\n  - type: &quot;file&quot;\n    url: &quot;https://repo.maven.apache.org/maven2/io/github/jwharm/javagi/harfbuzz/0.11.2/harfbuzz-0.11.2.jar&quot;\n    sha256: &quot;357eee4db76f893d13637d9c77ff160f9c44f821efc11d0c4afc82a8db95eea0&quot;\n  - type: &quot;file&quot;\n    url: &quot;https://repo.maven.apache.org/maven2/io/github/jwharm/cairobindings/cairo/1.18.4.1/cairo-1.18.4.1.jar&quot;\n    sha256: &quot;aaba7bd4a2b3e865306b4eaa5d036e50e50a920838b935995280e63a1985e755&quot;\n  - type: &quot;file&quot;\n    url: &quot;https://repo.maven.apache.org/maven2/io/github/jwharm/javagi/pangocairo/0.11.2/pangocairo-0.11.2.jar&quot;\n    sha256: &quot;5dd466e154423c75a4051503c25fff0624aaacd45def0b43e13c3892a7728843&quot;\n  - type: &quot;file&quot;\n    url: &quot;https://repo.maven.apache.org/maven2/io/github/jwharm/javagi/gsk/0.11.2/gsk-0.11.2.jar&quot;\n    sha256: &quot;b3fddc57ffaad61543fc28968bf71bf4df93692c5e908153688249535e54bada&quot;\n  - type: &quot;file&quot;\n    url: &quot;https://repo.maven.apache.org/maven2/io/github/jwharm/javagi/graphene/0.11.2/graphene-0.11.2.jar&quot;\n    sha256: &quot;45ff246c1b9fbc794ff34d540e34f07a63bf5bfe1e678ba34b0687f44f90dc03&quot;\n  - type: &quot;file&quot;\n    path: &quot;texty3.jar&quot;\n  - type: &quot;file&quot;\n    path: &quot;texty3&quot;\n  - type: &quot;file&quot;\n    path: &quot;../../src/main/resources/ca.footeware.java.texty3.gschema.xml&quot;\nfinish-args:\n- &quot;--socket=session-bus&quot;\n- &quot;--socket=wayland&quot;\n- &quot;--socket=ssh-auth&quot;\n- &quot;--device=dri&quot;\n- &quot;--share=network&quot;\n- &quot;--share=ipc&quot;\n- &quot;--filesystem=home&quot;\n- &quot;--env=PATH=/app/jre/bin:/app/bin:/usr/bin&quot;\n- &quot;--env=JAVA_HOME=/app/jre&quot;\n</code></pre>\n<p>Note I have a <em>source</em> for the <code>.gschema.xml</code> and install it in the main module's <em>build-commands</em> and then I call <code>glib-compile-schemas /app/share/glib-2.0/schemas</code>.</p>\n<p>I checked that the <code>.gschema.xml</code> and the compiled version are where they should be:</p>\n<pre><code>‚ùØ flatpak run --command=sh ca.footeware.java.texty3\n[\uD83D\uDCE6 ca.footeware.java.texty3 ~]$ ls -l /app/share/glib-2.0/schemas/\ntotal 8\n-rwxr-xr-x 3 craig craig 846 Dec 31  1969 ca.footeware.java.texty3.gschema.xml\n-rw-r--r-- 3 craig craig 420 Dec 31  1969 gschemas.compiled\n</code></pre>\n<p>So the schema files are there but not being found by the application. Anyone have any ideas?</p>\n",
    "tags" : [ "java", "gtk", "flatpak", "gsettings", "flatpak-builder" ],
    "owner" : {
      "account_id" : 2645778,
      "reputation" : 474,
      "user_id" : 2288506,
      "user_type" : "registered",
      "accept_rate" : 25,
      "profile_image" : "https://www.gravatar.com/avatar/0dff0ff19db0fbcba1cfa9cb5eb901f6?s=256&d=identicon&r=PG",
      "display_name" : "CraigFoote",
      "link" : "https://stackoverflow.com/users/2288506/craigfoote"
    },
    "is_answered" : true,
    "view_count" : 142,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1744681458,
    "creation_date" : 1744497155,
    "link" : "https://stackoverflow.com/questions/79571005/need-to-handle-gsettings-schema-in-flatpak-builder",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79573683,
    "question_id" : 79571005,
    "body" : "<p>In gschema.xml:</p>\n<pre><code>&lt;schema id=&quot;texty3&quot; path=&quot;/ca/footeware/java/texty3/&quot;&gt;\n</code></pre>\n<p>it should be <code>&quot;ca.footeware.java.texty3&quot;</code>.</p>\n",
    "score" : 0,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 2645778,
      "reputation" : 474,
      "user_id" : 2288506,
      "user_type" : "registered",
      "accept_rate" : 25,
      "profile_image" : "https://www.gravatar.com/avatar/0dff0ff19db0fbcba1cfa9cb5eb901f6?s=256&d=identicon&r=PG",
      "display_name" : "CraigFoote",
      "link" : "https://stackoverflow.com/users/2288506/craigfoote"
    },
    "creation_date" : 1744650284,
    "last_activity_date" : 1744681458,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140330268,
    "post_id" : 79571005,
    "body" : "No change. echo $GSETTINGS_SCHEMA_DIR returns /app/share/glib-2.0/schemas",
    "score" : 0,
    "owner" : {
      "account_id" : 2645778,
      "reputation" : 474,
      "user_id" : 2288506,
      "user_type" : "registered",
      "accept_rate" : 25,
      "profile_image" : "https://www.gravatar.com/avatar/0dff0ff19db0fbcba1cfa9cb5eb901f6?s=256&d=identicon&r=PG",
      "display_name" : "CraigFoote",
      "link" : "https://stackoverflow.com/users/2288506/craigfoote"
    },
    "creation_date" : 1744559089,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140330239,
    "post_id" : 79571005,
    "body" : "tRY updatING your ca.footeware.java.texty3.yml to include:  finish-args:   ...   - &quot;--env=GSETTINGS_SCHEMA_DIR=/app/share/glib-2.0/schemas&quot;",
    "score" : 0,
    "owner" : {
      "account_id" : 7645025,
      "reputation" : 440,
      "user_id" : 5795975,
      "user_type" : "registered",
      "profile_image" : "https://lh6.googleusercontent.com/-6KwPUS4RnyA/AAAAAAAAAAI/AAAAAAAAC8w/auZqreI45x0/s256-rj/photo.jpg",
      "display_name" : "Vijay",
      "link" : "https://stackoverflow.com/users/5795975/vijay"
    },
    "creation_date" : 1744557997,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}