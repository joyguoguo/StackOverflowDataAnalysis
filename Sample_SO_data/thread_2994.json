{
  "question" : {
    "question_id" : 79579533,
    "title" : "Powershell Build Script: Edit a file, readback file to confirm contents, run ApacheANT to build JAR. Jar file looks like file edits were not made",
    "body" : "<p>Making a build script that edits a Config.java file to set the build type. Then run APACHE ANT command line version to generate a JAR file. Apache ANT runs an XML build file.</p>\n<p>When I run it, the file gets edited and the JAR file gets created but the JAR file does not reflect the changes I made to config.java.</p>\n<ul>\n<li>I have tried deleting and re-making Config.java with the new content.</li>\n<li>I have tried adding sleeps between.</li>\n<li>I have tried printing the whole file before running the build with ANT (it shows the changes I want, still builds with old content)</li>\n</ul>\n<p>From what I have read it doesn't seem like you need to close/release a file when using set-content/get-content.</p>\n<p>Here is the code:</p>\n<pre><code>$Originalfilecontent = Get-Content -Path &quot;$ConfigPath&quot; \n\n$filecontent = $Originalfilecontent | ForEach-Object {$_}\n$filecontent[30] = &quot;&quot;\n$filecontent[31] = &quot;&quot;\n$filecontent[32] = &quot;&quot;\n$filecontent[33] = -join(&quot;  private final static String GuiReleaseType = &quot;, '&quot;', $ReleaseType.toLower(), '&quot;', ';') \n$filecontent[15] = -join(&quot;  public final static String sGuiVersion = &quot;, '&quot;', $ReleaseVersion, '&quot;', ';') \n\nSet-content -Path &quot;$ConfigPath&quot; -Value $filecontent \n\n#Create Runnable JAR\nWrite-Host &quot;=== Creating JAR file ===&quot;\nStart-Process -FilePath &quot;$AntPath&quot; -ArgumentList &quot;-buildfile&quot;, &quot;$AntScript&quot; -Wait \n</code></pre>\n<p>When I run the script a second time after it finishes the first time, it does build with the edits. So it does seem like the file isn't getting released until the end of the script or something  like that.</p>\n<p>Any ideas?</p>\n<pre><code>Here is the top of the buildfile:\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;\n&lt;project default=&quot;create_run_jar&quot; name=&quot;Create Runnable Jar for Project server&quot;&gt;\n    &lt;!--this file was created by Eclipse Runnable JAR Export Wizard--&gt;\n    &lt;!--ANT 1.7 is required                                        --&gt;\n    &lt;!--define folder properties--&gt;\n    &lt;property name=&quot;dir.buildfile&quot; value=&quot;.&quot;/&gt;\n    &lt;property name=&quot;dir.workspace&quot; value=&quot;${dir.buildfile}/..&quot;/&gt;\n    &lt;property name=&quot;dir.jarfile&quot; value=&quot;${dir.buildfile}&quot;/&gt;\n    &lt;target name=&quot;create_run_jar&quot;&gt;\n        &lt;jar destfile=&quot;${dir.jarfile}/timingGUI.jar&quot; filesetmanifest=&quot;mergewithoutmain&quot;&gt;\n            &lt;manifest&gt;\n                &lt;attribute name=&quot;Main-Class&quot; value=&quot;com.folder.chromium.MainDesktopFrame&quot;/&gt;\n                &lt;attribute name=&quot;Class-Path&quot; value=&quot;.&quot;/&gt;\n            &lt;/manifest&gt;\n</code></pre>\n<p>It works correctly if I call the script, let it complete and then call it again.\nThe config file is required to get a build that will run.\nfirst time around always finishes using default settings in the config (un-edited).</p>\n",
    "tags" : [ "java", "powershell", "ant" ],
    "owner" : {
      "account_id" : 41460006,
      "reputation" : 1,
      "user_id" : 30300639,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/8cbbb7172f594faffe1dab2f1a260b62?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Simon",
      "link" : "https://stackoverflow.com/users/30300639/simon"
    },
    "is_answered" : false,
    "view_count" : 53,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1744904993,
    "creation_date" : 1744901573,
    "link" : "https://stackoverflow.com/questions/79579533/powershell-build-script-edit-a-file-readback-file-to-confirm-contents-run-apa",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140347127,
    "post_id" : 79579533,
    "body" : "Your ant fragment does not show compile so you might be jarring class of previous build. Add <code>dir</code> message printing timestamp of the java and class files for every stage so you can see when they change",
    "score" : 0,
    "owner" : {
      "account_id" : 5998820,
      "reputation" : 16283,
      "user_id" : 4712734,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/f6e922a2cb7e2da59286f27b162aaca5?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "DuncG",
      "link" : "https://stackoverflow.com/users/4712734/duncg"
    },
    "creation_date" : 1744959261,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140345232,
    "post_id" : 79579533,
    "body" : "I would not get a useable build without that file. It contains a default that I&#39;m trying to change and it always comes up with the default for the first run.",
    "score" : 0,
    "owner" : {
      "account_id" : 41460006,
      "reputation" : 1,
      "user_id" : 30300639,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/8cbbb7172f594faffe1dab2f1a260b62?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Simon",
      "link" : "https://stackoverflow.com/users/30300639/simon"
    },
    "creation_date" : 1744904684,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140345090,
    "post_id" : 79579533,
    "body" : "$configPath C:\\Users\\Myfolder\\Documents\\gui\\gui\\web\\server\\src\\com\\folde&zwnj;&#8203;r\\ui\\Config.java $AntScript C:\\Users\\MyFolder\\Documents\\gui\\gui\\web\\server\\timingGUI.xml",
    "score" : 0,
    "owner" : {
      "account_id" : 41460006,
      "reputation" : 1,
      "user_id" : 30300639,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/8cbbb7172f594faffe1dab2f1a260b62?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Simon",
      "link" : "https://stackoverflow.com/users/30300639/simon"
    },
    "creation_date" : 1744902927,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140345026,
    "post_id" : 79579533,
    "body" : "The simplest explanation is that the ANT script is not actually using your &quot;config file&quot; to begin with. Post the relevant sections of the build file (including any target src paths) and show us the values stored in <code>$ConfigPath</code> and <code>$AntScript</code>",
    "score" : 0,
    "owner" : {
      "account_id" : 366852,
      "reputation" : 178265,
      "user_id" : 712649,
      "user_type" : "registered",
      "accept_rate" : 100,
      "profile_image" : "https://i.sstatic.net/tP0yV.jpg?s=256",
      "display_name" : "Mathias R. Jessen",
      "link" : "https://stackoverflow.com/users/712649/mathias-r-jessen"
    },
    "creation_date" : 1744901991,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}