{
  "question" : {
    "question_id" : 79616695,
    "title" : "JavaFX bidirectional bindings desync",
    "body" : "<p>I'm starting to learn JavaFX for a personal project, and I thought it would be a good idea to try to practice some basic things first. I decided to first sync two FieldText items so each one would reflect the changes made to the other.</p>\n<p>Problem is, it keeps desyncing. After some unspecified time (or some unspecified, non-consistent number of uses), whether I decide to change from writing in one field to the other, or even just keep writing in one of them, the other field stops reflecting the changes. At that point, no matter what I do, the bind is broken and no field reflects what is done to the other.</p>\n<p>Here's what I'm doing, hopefully someone can point out what I'm doing wrong:</p>\n<pre><code>import javafx.application.Application;\nimport javafx.beans.property.SimpleStringProperty;\nimport javafx.beans.property.StringProperty;\nimport javafx.scene.Scene;\nimport javafx.scene.control.Label;\nimport javafx.scene.control.TextField;\nimport javafx.scene.layout.BorderPane;\nimport javafx.stage.Stage;\nimport javafx.util.StringConverter;\n\npublic class MainWindow extends Application {\n    StringConverter&lt;String&gt; conv;\n\n    @Override\n    public void start(Stage primaryStage) {\n        BorderPane borderPane = new BorderPane();\n    \n        StringProperty test = new SimpleStringProperty(&quot;&quot;);\n        TextField tf1 = new TextField();\n        TextField tf2 = new TextField();\n        conv = new StringConverter&lt;String&gt;() {\n\n            @Override\n            public String fromString(String str) {\n                if (str == null)\n                    return &quot;&quot;;\n                return str;\n            }\n\n            @Override\n            public String toString(String str) {\n                if (str == null)\n                    return &quot;&quot;;\n                return str;\n            }\n        };\n\n    \n    tf1.textProperty().bindBidirectional(test, conv);\n    tf2.textProperty().bindBidirectional(test, conv);\n    \n    Label currentValLabel = new Label(&quot;&quot;+test.get());\n    test.addListener((obs, oldVal, newVal) -&gt; {\n        currentValLabel.setText(&quot;Valor: &quot;+ newVal);\n    });\n    \n    \n    borderPane.setTop(tf1);\n    borderPane.setBottom(tf2);\n    borderPane.setCenter(currentValLabel);\n    Scene scene = new Scene(borderPane, 600, 400);\n    primaryStage.setTitle(&quot;BorderPane en JavaFX&quot;);\n    primaryStage.setScene(scene);\n    primaryStage.show();\n}\n</code></pre>\n<p>}</p>\n",
    "tags" : [ "java", "javafx" ],
    "owner" : {
      "account_id" : 22060220,
      "reputation" : 41,
      "user_id" : 16323042,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/808115d3239d4688473a6550f1da9ba8?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "jack",
      "link" : "https://stackoverflow.com/users/16323042/jack"
    },
    "is_answered" : true,
    "view_count" : 74,
    "answer_count" : 1,
    "score" : 2,
    "last_activity_date" : 1747107546,
    "creation_date" : 1746981215,
    "link" : "https://stackoverflow.com/questions/79616695/javafx-bidirectional-bindings-desync",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79616972,
    "question_id" : 79616695,
    "body" : "<p>The <code>test</code> property instance is most likely being garbage collected. When that happens the bidirectional bindings &quot;break&quot;. Meaning updating one text field no longer updates <code>test</code> (because it doesn't exist) and so neither the other text field nor the label get updated.</p>\n<p>A bidirectional binding explicitly does not prevent either of the two properties from being garbage collected. This is <a href=\"https://openjfx.io/javadoc/24/javafx.base/javafx/beans/property/Property.html#bindBidirectional(javafx.beans.property.Property)\" rel=\"nofollow noreferrer\">documented</a>:</p>\n<blockquote>\n<p>JavaFX bidirectional binding implementation use weak listeners. This means bidirectional binding does not prevent properties from being garbage collected.</p>\n</blockquote>\n<p>The solution is to maintain a strong reference to <code>test</code>. Probably the best way to implement that is to store the <code>test</code> property in a field of your <code>MainWindow</code> class.</p>\n<hr />\n<p>Doing the following, at least in JavaFX 24, is another way to keep a strong reference to <code>test</code>:</p>\n<pre><code>// import javafx.beans.binding.Bindings\ncurrentLabel.textProperty().bind(Bindings.concat(&quot;Valor: &quot;, test));\n</code></pre>\n<p>You would do this instead of adding a <code>ChangeListener</code> to <code>test</code>. Though I'm not sure that the documentation of either <code>Property::bind(ObservableValue)</code> or <code>Bindings::concat(Object...)</code> strictly <em>guarantee</em> the observable(s) will be strongly referenced. If I'm wrong about that, please someone let me know in the comments.</p>\n",
    "score" : 4,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 8532578,
      "reputation" : 49884,
      "user_id" : 6395627,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/af0f9bfe593f36642a032cd7ea611e7d?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Slaw",
      "link" : "https://stackoverflow.com/users/6395627/slaw"
    },
    "creation_date" : 1747002068,
    "last_activity_date" : 1747107546,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : { }
}