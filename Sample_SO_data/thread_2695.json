{
  "question" : {
    "question_id" : 79602097,
    "title" : "How to solve IDEA&#39;s null check on arrays?",
    "body" : "<p>In package-info.java, I add the default null-checking config:</p>\n<pre><code>@DefaultNonNull // means all params and vars are nonnull by default\n</code></pre>\n<p>IDEA's null-checking is OK <strong>except for arrays</strong>. On the array, for example:</p>\n<pre><code>@Nullable String @Nullable [] arr = new String[]{&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, null};\n</code></pre>\n<p>Although I set the array and its elements to be nullable, IDEA still reminds me that there is a null element:</p>\n<blockquote>\n<p>'null' is stored to an array of @NotNull elements</p>\n</blockquote>\n<p><a href=\"https://i.sstatic.net/82cPv05T.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/82cPv05T.png\" alt=\"enter image description here\" /></a></p>\n<p>How to make the <code>@Nullable</code> works?</p>\n<p>IDEA version:</p>\n<pre><code>IntelliJ IDEA 2025.1 (Community Edition)\nBuild #IC-251.23774.435, built on April 14, 2025\nSource revision: 9b2a2c261c093\nRuntime version: 21.0.6+9-b895.109 amd64 (JCEF 122.1.9)\nVM: OpenJDK 64-Bit Server VM by JetBrains s.r.o.\nToolkit: sun.awt.windows.WToolkit\nWindows 10.0\nKotlin plugin: K2 mode\nGC: G1 Young Generation, G1 Concurrent GC, G1 Old Generation\nMemory: 2048M\nCores: 16\nRegistry:\n  ide.experimental.ui=true\n  llm.show.ai.promotion.window.on.start=false\n  terminal.new.ui=true\nNon-Bundled Plugins:\n  de.kontext_e.idea.plugins.jqa (2.0)\n  Lombook Plugin (251.23774.460)\n  org.jetbrains.plugins.github (251.23774.435-IU)\n  com.alibabacloud.intellij.cosy (2.3.0)\nKotlin: 251.23774.435-IJ\n</code></pre>\n<p>And here are the <code>DefaultNonNull</code> and <code>Nullable</code>:</p>\n<pre><code>import javax.annotation.Nonnull;\nimport javax.annotation.meta.TypeQualifierDefault;\nimport javax.annotation.meta.TypeQualifierNickname;\nimport javax.annotation.meta.When;\nimport java.lang.annotation.Documented;\nimport java.lang.annotation.ElementType;\nimport java.lang.annotation.Retention;\nimport java.lang.annotation.RetentionPolicy;\nimport java.lang.annotation.Target;\n\n@Documented\n@Retention(RetentionPolicy.RUNTIME)\n@Nonnull(when = When.ALWAYS)\n@TypeQualifierNickname\n@Target({\n    ElementType.TYPE,\n    ElementType.METHOD,\n    ElementType.CONSTRUCTOR,\n    ElementType.PACKAGE,\n})\n@TypeQualifierDefault({\n    ElementType.METHOD,\n    ElementType.FIELD,\n    ElementType.PARAMETER,\n    ElementType.LOCAL_VARIABLE,\n    ElementType.TYPE_PARAMETER,\n    ElementType.TYPE_USE,\n})\npublic @interface DefaultNonNull {\n}\n</code></pre>\n<p>Andâ€¦</p>\n<pre><code>import javax.annotation.Nonnull;\nimport javax.annotation.meta.TypeQualifierNickname;\nimport javax.annotation.meta.When;\nimport java.lang.annotation.Documented;\nimport java.lang.annotation.ElementType;\nimport java.lang.annotation.Retention;\nimport java.lang.annotation.RetentionPolicy;\nimport java.lang.annotation.Target;\n\n@Documented\n@Nonnull(\n    when = When.MAYBE\n)\n@Retention(RetentionPolicy.RUNTIME)\n@TypeQualifierNickname\n@Target({\n    ElementType.METHOD,\n    ElementType.FIELD,\n    ElementType.PARAMETER,\n    ElementType.LOCAL_VARIABLE,\n    ElementType.TYPE_USE,\n})\npublic @interface Nullable {\n}\n</code></pre>\n<p>The jsr305 lib from: <code>com.google.code.findbugs:jsr305:3.0.2</code></p>\n",
    "tags" : [ "java", "intellij-idea" ],
    "owner" : {
      "account_id" : 9149557,
      "reputation" : 2181,
      "user_id" : 6804605,
      "user_type" : "registered",
      "accept_rate" : 75,
      "profile_image" : "https://www.gravatar.com/avatar/e082e95565375bb16bbf40988a47e1ac?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "FredSuvn",
      "link" : "https://stackoverflow.com/users/6804605/fredsuvn"
    },
    "is_answered" : false,
    "view_count" : 83,
    "answer_count" : 0,
    "score" : 2,
    "last_activity_date" : 1746334675,
    "creation_date" : 1746112946,
    "link" : "https://stackoverflow.com/questions/79602097/how-to-solve-ideas-null-check-on-arrays",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140393768,
    "post_id" : 79602097,
    "body" : "@BasilBourque The jsr305 lib from: <code>com.google.code.findbugs:jsr305:3.0.2</code>, <code>DefaultNonNull</code> and <code>Nullable</code> are written by me (depends jsr305).",
    "score" : 0,
    "owner" : {
      "account_id" : 9149557,
      "reputation" : 2181,
      "user_id" : 6804605,
      "user_type" : "registered",
      "accept_rate" : 75,
      "profile_image" : "https://www.gravatar.com/avatar/e082e95565375bb16bbf40988a47e1ac?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "FredSuvn",
      "link" : "https://stackoverflow.com/users/6804605/fredsuvn"
    },
    "creation_date" : 1746334685,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140393260,
    "post_id" : 79602097,
    "body" : "(A) From what library are you pulling <code>javax.annotation.Nonnull</code>? (B) Did you write that code for  <code>DefaultNonNull</code> &amp; <code>Nullable</code>? Or are you getting that from a library? What library? There are so many null-tracking libraries in Java. And now there is a movement towards JSpecify. So you need to be <i>really specific</i>.",
    "score" : 0,
    "owner" : {
      "account_id" : 322981,
      "reputation" : 346951,
      "user_id" : 642706,
      "user_type" : "registered",
      "accept_rate" : 58,
      "profile_image" : "https://i.sstatic.net/ZWEI3.jpg?s=256",
      "display_name" : "Basil Bourque",
      "link" : "https://stackoverflow.com/users/642706/basil-bourque"
    },
    "creation_date" : 1746298817,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140392811,
    "post_id" : 79602097,
    "body" : "@BasilBourque IDEA version and <code>@Nullable</code> and <code>@DefaultNonNull</code> are added",
    "score" : 2,
    "owner" : {
      "account_id" : 9149557,
      "reputation" : 2181,
      "user_id" : 6804605,
      "user_type" : "registered",
      "accept_rate" : 75,
      "profile_image" : "https://www.gravatar.com/avatar/e082e95565375bb16bbf40988a47e1ac?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "FredSuvn",
      "link" : "https://stackoverflow.com/users/6804605/fredsuvn"
    },
    "creation_date" : 1746282985,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}