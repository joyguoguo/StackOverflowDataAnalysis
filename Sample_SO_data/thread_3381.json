{
  "question" : {
    "question_id" : 79553028,
    "title" : "Java Sping in container can&#39;t connect to external oracle database",
    "body" : "<p>I have a java spring boot inside docker a container which has to connect to an external Oracle database, i have set the db properties in the application.yml file.\nThe connection shouldn't require TLS/SSL.\nThe tnsnames.ora file is including the connection to the database.\nThe connection works on DBeaver.\nI am not using docker-compose.</p>\n<p><code>Telnet</code> on <em>ip 1521</em> works from the machine, i don't have it the docker container.</p>\n<p><strong>sqlplus:</strong></p>\n<pre><code>ERROR:\nORA-12170: TNS:Connect timeout occurred\n\n\nEnter user-name: username\nEnter password:\nERROR:\nORA-12162: TNS:net service name is incorrectly specified\n</code></pre>\n<p><strong>tnsping dbname</strong></p>\n<pre><code>TNS Ping Utility for Linux: Version 19.0.0.0.0 - Production on 03-APR-2025 14:58:53\n\nCopyright (c) 1997, 2019, Oracle.  All rights reserved.\n\nUsed parameter files:\n\n\nUsed TNSNAMES adapter to resolve the alias\nAttempting to contact (DESCRIPTION = (ADDRESS = (PROTOCOL = TCP)(HOST = **.**.***.***)(PORT = 1521)) (CONNECT_DATA = (SERVER = DEDICATED) (SERVICE_NAME = dbname)))\nOK (20 msec)\n</code></pre>\n<p><strong>application.yml</strong></p>\n<pre><code> spring:\n      datasource:\n        hikari:\n          connection-timeout: 30000 # 30 seconds (default is 30 seconds)\n          maximum-pool-size: 30\n          minimum-idle: 10\n     db-datasource:\n        jdbc-url: jdbc:oracle:thin:@**.**.***.***:1521/dbname\n        username: username\n        password: password\n        type: oracle.ucp.jdbc.PoolDataSource\n        oracleucp:\n          min-pool-size: 10\n          max-pool-size: 30\n</code></pre>\n<p><strong>Exception:</strong></p>\n<pre><code> 2025-04-03 12:30:07 - Servlet.service() for servlet\n [dispatcherServlet] in context with path [] threw exception [Request\n processing failed; nested exception is\n org.springframework.jdbc.CannotGetJdbcConnectionException: Failed to\n obtain JDBC Connection; nested exception is\n java.sql.SQLRecoverableException: ORA-17820: The network adapter could\n not establish the connection.\n (CONNECTION_ID=Hs5/EibCSvqAgNOlroqmEQ==)] with root cause\n oracle.net.ns.NetException: ORA-17820: The network adapter could not\n establish the connection. (CONNECTION_ID=Hs5/EibCSvqAgNOlroqmEQ==)\n         at oracle.net.nt.ConnStrategy.execute(ConnStrategy.java:729)\n         at oracle.net.resolver.AddrResolution.resolveAndExecute(AddrResolution.java:688)\n         at oracle.net.ns.NSProtocol.establishConnection(NSProtocol.java:935)\n         at oracle.net.ns.NSProtocol.establishConnection(NSProtocol.java:908)\n         at oracle.net.ns.NSProtocolNIO.redirectConnection(NSProtocolNIO.java:519)\n         at oracle.net.ns.NSProtocolNIO.handleConnectPacketResponse(NSProtocolNIO.java:441)\n         at oracle.net.ns.NSProtocolNIO.negotiateConnection(NSProtocolNIO.java:262)\n         at oracle.net.ns.NSProtocol.connect(NSProtocol.java:327)\n         at oracle.jdbc.driver.T4CConnection.connectSession(T4CConnection.java:2882)\n         at oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:811)\n         at oracle.jdbc.driver.PhysicalConnection.connect(PhysicalConnection.java:1132)\n         at oracle.jdbc.driver.T4CDriverExtension.getConnection(T4CDriverExtension.java:104)\n         at oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:837)\n         at oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:664)\n         at com.zaxxer.hikari.util.DriverDataSource.getConnection(DriverDataSource.java:138)\n         at com.zaxxer.hikari.pool.PoolBase.newConnection(PoolBase.java:364)\n         at com.zaxxer.hikari.pool.PoolBase.newPoolEntry(PoolBase.java:206)\n         at com.zaxxer.hikari.pool.HikariPool.createPoolEntry(HikariPool.java:476)\n         at com.zaxxer.hikari.pool.HikariPool.checkFailFast(HikariPool.java:561)\n         at com.zaxxer.hikari.pool.HikariPool.&lt;init(HikariPool.java:115)\n         at com.zaxxer.hikari.HikariDataSource.getConnection(HikariDataSource.java:112)\n         at org.springframework.jdbc.datasource.DataSourceUtils.fetchConnection(DataSourceUtils.java:159)\n         at org.springframework.jdbc.datasource.DataSourceUtils.doGetConnection(DataSourceUtils.java:117)\n         at org.springframework.jdbc.datasource.DataSourceUtils.getConnection(DataSourceUtils.java:80)\n         at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:646)\n         at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:713)\n         at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:738)\n         at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:794)\n         at org.springframework.jdbc.core.namedparam.NamedParameterJdbcTemplate.query(NamedParameterJdbcTemplate.java:209)\n         at org.springframework.jdbc.core.namedparam.NamedParameterJdbcTemplate.query(NamedParameterJdbcTemplate.java:221)\n         at it.telecomitalia.mdc.gino.repository.GinoRepository.getOfferTypeByCode(GinoRepository.java:70)\n         at it.telecomitalia.mdc.gino.repository.GinoRepository$$FastClassBySpringCGLIB$$636333f4.invoke(&lt;generated)\n         at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)\n         at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)\n         at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)\n         at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)\n         at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)\n         at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)\n         at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)\n         at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)\n         at it.telecomitalia.mdc.gino.repository.GinoRepository$$EnhancerBySpringCGLIB$$58afd782.getOfferTypeByCode(&lt;generated)\n         at it.telecomitalia.mdc.gino.service.GinoService.getOfferType(GinoService.java:16)\n         at it.telecomitalia.mdc.fetrcs.service.FetrcsServiceInformative.getOffers(FetrcsServiceInformative.java:261)\n         at it.telecomitalia.mdc.fetrcs.controller.FetrcsController.getOffers(FetrcsController.java:61)\n         at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native\n Method)\n         at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n         at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n         at java.base/java.lang.reflect.Method.invoke(Method.java:566)\n         at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)\n         at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)\n         at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)\n         at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)\n         at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)\n         at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)\n         at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1071)\n         at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:964)\n         at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)\n         at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)\n         at javax.servlet.http.HttpServlet.service(HttpServlet.java:670)\n         at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)\n         at javax.servlet.http.HttpServlet.service(HttpServlet.java:779)\n         at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227)\n         at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)\n         at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)\n         at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)\n         at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)\n         at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)\n         at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)\n         at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)\n         at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)\n         at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)\n         at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)\n         at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)\n         at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)\n         at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)\n         at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)\n         at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)\n         at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)\n         at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)\n         at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)\n         at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)\n         at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)\n         at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:177)\n         at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)\n         at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:541)\n         at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135)\n         at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)\n         at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)\n         at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:360)\n         at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)\n         at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)\n         at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:891)\n         at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1784)\n         at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)\n         at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)\n         at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)\n         at org.apache.tomcat.util.threads.TaskThread$WrappingRu\n</code></pre>\n",
    "tags" : [ "java", "spring", "oracle-database", "docker", "exception" ],
    "owner" : {
      "account_id" : 8117448,
      "reputation" : 200,
      "user_id" : 6115491,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/heP0o.jpg?s=256",
      "display_name" : "CCC",
      "link" : "https://stackoverflow.com/users/6115491/ccc"
    },
    "is_answered" : false,
    "view_count" : 61,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1743686326,
    "creation_date" : 1743685816,
    "link" : "https://stackoverflow.com/questions/79553028/java-sping-in-container-cant-connect-to-external-oracle-database",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140300123,
    "post_id" : 79553028,
    "body" : "I have tried other oracle dbs and connections are working, it&#39;s probably the db server that is blocking connections, i asked the team who manges it to check. In the meanwhile i will read the documentantion, thank you",
    "score" : 0,
    "owner" : {
      "account_id" : 8117448,
      "reputation" : 200,
      "user_id" : 6115491,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/heP0o.jpg?s=256",
      "display_name" : "CCC",
      "link" : "https://stackoverflow.com/users/6115491/ccc"
    },
    "creation_date" : 1743781945,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140297870,
    "post_id" : 79553028,
    "body" : "@CCC You may want to review the documentation for Docker networking.  For connecting to internal services, you add extra_hosts: host.docker.internal:host-gateway.  Read and understand this, it can be a bit confusing: <a href=\"https://docs.docker.com/engine/network/\" rel=\"nofollow noreferrer\">docs.docker.com/engine/network</a>",
    "score" : 0,
    "owner" : {
      "account_id" : 477214,
      "reputation" : 6000,
      "user_id" : 888580,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/758d48012fbe517a8c250f1384e2025b?s=256&d=identicon&r=PG",
      "display_name" : "lane.maxwell",
      "link" : "https://stackoverflow.com/users/888580/lane-maxwell"
    },
    "creation_date" : 1743746198,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140295163,
    "post_id" : 79553028,
    "body" : "by doing docker run --network=host i can&#39;t call api inside the project, getting: Error: connect ECONNREFUSED",
    "score" : 0,
    "owner" : {
      "account_id" : 8117448,
      "reputation" : 200,
      "user_id" : 6115491,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/heP0o.jpg?s=256",
      "display_name" : "CCC",
      "link" : "https://stackoverflow.com/users/6115491/ccc"
    },
    "creation_date" : 1743689199,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140295062,
    "post_id" : 79553028,
    "body" : "same difference, you are trying to reach internal ip addres in docker which has its own network. Try binding docker to your network if you are on linux (<code>docker run --network=host ...</code>)",
    "score" : 0,
    "owner" : {
      "account_id" : 16657879,
      "reputation" : 4340,
      "user_id" : 12038714,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a-/AAuE7mAgRe8u2G_kzJJ-KZ2yZwAD1E4kxs9eRlqnY45BUw=k-s256",
      "display_name" : "asgarov1",
      "link" : "https://stackoverflow.com/users/12038714/asgarov1"
    },
    "creation_date" : 1743688266,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140294983,
    "post_id" : 79553028,
    "body" : "no, i am using an ip 10.41.***.***:1521/dbname",
    "score" : 0,
    "owner" : {
      "account_id" : 8117448,
      "reputation" : 200,
      "user_id" : 6115491,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/heP0o.jpg?s=256",
      "display_name" : "CCC",
      "link" : "https://stackoverflow.com/users/6115491/ccc"
    },
    "creation_date" : 1743687508,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140294973,
    "post_id" : 79553028,
    "body" : "are you using <code>localhost</code> inside of <code>spring.db-datasource.jdbc-url</code>?",
    "score" : 0,
    "owner" : {
      "account_id" : 16657879,
      "reputation" : 4340,
      "user_id" : 12038714,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a-/AAuE7mAgRe8u2G_kzJJ-KZ2yZwAD1E4kxs9eRlqnY45BUw=k-s256",
      "display_name" : "asgarov1",
      "link" : "https://stackoverflow.com/users/12038714/asgarov1"
    },
    "creation_date" : 1743687342,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140294953,
    "post_id" : 79553028,
    "body" : "i just checked and TNS connection is ok, trying with a dbms it works fine",
    "score" : 0,
    "owner" : {
      "account_id" : 8117448,
      "reputation" : 200,
      "user_id" : 6115491,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/heP0o.jpg?s=256",
      "display_name" : "CCC",
      "link" : "https://stackoverflow.com/users/6115491/ccc"
    },
    "creation_date" : 1743687141,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140294903,
    "post_id" : 79553028,
    "body" : "<code>ORA-12162: TNS:net service name is incorrectly specified</code> not much we can do here, check the TNS connection details of your db and fix the connection string",
    "score" : 0,
    "owner" : {
      "account_id" : 16657879,
      "reputation" : 4340,
      "user_id" : 12038714,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a-/AAuE7mAgRe8u2G_kzJJ-KZ2yZwAD1E4kxs9eRlqnY45BUw=k-s256",
      "display_name" : "asgarov1",
      "link" : "https://stackoverflow.com/users/12038714/asgarov1"
    },
    "creation_date" : 1743686416,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}