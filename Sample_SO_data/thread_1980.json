{
  "question" : {
    "question_id" : 79658744,
    "title" : "JAVA awt.print.PrinterJob setPrintable() is slow caused by sun.awt.windows.WPrinterjob.HandleRecord",
    "body" : "<p>I ran the following code</p>\n<pre><code>package printertest;\n\nimport java.awt.print.PrinterJob;\nimport java.time.LocalDateTime;\n\npublic class Printertest {\n    public static void main(String[] args) {\n        \n        System.out.println(&quot;java.version: &quot;+System.getProperty(&quot;java.version&quot;));\n        PrinterJob printerJob = PrinterJob.getPrinterJob();\n        LocalDateTime time = LocalDateTime.now();\n        System.out.println(time);\n        printerJob.setPrintable(new PrintObject());\n        time = LocalDateTime.now();\n        System.out.println(time);\n    }\n}\n</code></pre>\n<p>which returns</p>\n<pre><code>java.version: 21.0.1\n2025-06-09T12:17:06.215255200\n2025-06-09T12:17:54.463001900\n</code></pre>\n<p>as you can see setPrintable takes nearly a minute\nFollowing the code I found that</p>\n<pre><code>private long getPrintDC() {\n    return handleRecord.mPrintDC;\n}\n</code></pre>\n<p>inside Sun.awt.windows.WPrinterJob caused the waiting time.\nCallstack:</p>\n<pre><code>WPrinterJob.getPrintDC() line: 934  \nWPrinterJob.getDefaultPage(PageFormat) line: not available [native method]\nWPrinterJob.defaultPage(PageFormat) line: 767   \nWPrinterJob(RasterPrinterJob).setPrintable(Printable) line: 1166    \nPrintertest.main(String[]) line: 13 \n</code></pre>\n<p>Interesting besides facts:\nI ran the code on my laptop too, which should be slower than my PC but took max a second\nBoth: Windows 11\nthe only difference is the number of added printers.</p>\n<p>Other users who had similar problems (but no answer):</p>\n<p><a href=\"https://forums.oracle.com/ords/apexds/post/slow-printing-when-using-setprintable-or-print-method-in-pr-6041\" rel=\"nofollow noreferrer\">Slow printing when using setPrintable or print method in PrinterJob class</a></p>\n<p><a href=\"https://post.bytes.com/forum/topic/java/779894-very-slow-printing-with-java-%E2%80%8Bawt-%E2%80%8Bprint-%E2%80%8Bprinterjob\" rel=\"nofollow noreferrer\">very slow printing with java.​awt.​print.​PrinterJob</a></p>\n<p><a href=\"https://forums.oracle.com/ords/apexds/post/why-printing-is-so-slow-8200\" rel=\"nofollow noreferrer\">Why printing is so slow</a></p>\n<p><a href=\"https://stackoverflow.com/questions/52242769/why-is-this-java-page-printing-code-so-extraordinarily-slow-and-is-there-any-alt\">Why is this Java Page Printing so extraordinarily slow</a></p>\n<p>So my Question is: What could cause that long waiting time?</p>\n<p>EDIT: I noticed that the waiting time is dependent on the Printer! I tested the code with a turned off printer, which seemed to cause the problem. It took nearly no time with my printer turned on.</p>\n",
    "tags" : [ "java", "sun", "java-print" ],
    "owner" : {
      "account_id" : 42445744,
      "reputation" : 11,
      "user_id" : 30756050,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/951a8387061d3da5e47090a600ecc719?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Joseph Schie&#223;l",
      "link" : "https://stackoverflow.com/users/30756050/joseph-schie%c3%9fl"
    },
    "is_answered" : false,
    "view_count" : 43,
    "answer_count" : 0,
    "score" : 1,
    "last_activity_date" : 1749469045,
    "creation_date" : 1749466077,
    "link" : "https://stackoverflow.com/questions/79658744/java-awt-print-printerjob-setprintable-is-slow-caused-by-sun-awt-windows-wprin",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140499322,
    "post_id" : 79658744,
    "body" : "You might see better results if you use the more modern <a href=\"https://docs.oracle.com/en/java/javase/24/docs/api/java.desktop/javax/print/package-summary.html\" rel=\"nofollow noreferrer\">javax.print</a> package instead of java.awt.print.",
    "score" : 0,
    "owner" : {
      "account_id" : 2053598,
      "reputation" : 44936,
      "user_id" : 1831987,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/38b1c37530189ec4471a43a618e33f67?s=256&d=identicon&r=PG",
      "display_name" : "VGR",
      "link" : "https://stackoverflow.com/users/1831987/vgr"
    },
    "creation_date" : 1749477274,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140499083,
    "post_id" : 79658744,
    "body" : "Your edit seems an answer rather than a clarification of the question.",
    "score" : 1,
    "owner" : {
      "account_id" : 372682,
      "reputation" : 26512,
      "user_id" : 721855,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/vZiox.png?s=256",
      "display_name" : "aled",
      "link" : "https://stackoverflow.com/users/721855/aled"
    },
    "creation_date" : 1749471983,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}