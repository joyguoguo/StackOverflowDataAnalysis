{
  "question" : {
    "question_id" : 79643142,
    "title" : "Apache POI 5.4.1 setCellStyleProperty(Cell cell, String propertyName, Object propertyValue) doesn&#39;t support DATA_FORMAT. Why?",
    "body" : "<p>I just upgraded POI from 5.2.3 to 5.4.1 and found this method has been deprecated:</p>\n<pre><code>setCellStyleProperty(Cell cell, String propertyName, Object propertyValue)\n</code></pre>\n<p>and this new method has been added to replace it (notice 2nd arg is an enum now):</p>\n<pre><code>setCellStyleProperty(Cell cell, CellPropertyType property, Object propertyValue) \n</code></pre>\n<p>The old method is deprecated but is still there. It appears it was modified to convert old constants to the new Enum values by looking up values in the namePropertyMap and then calls the new method with the updated enum value which seems like a good intermediate solution. Here is the new code for the old method:</p>\n<pre><code>public static void setCellStyleProperty(Cell cell, String propertyName, Object propertyValue) {\n    setCellStyleProperty(cell, (CellPropertyType)namePropertyMap.get(propertyName), propertyValue);\n}\n</code></pre>\n<p>However, for whatever reason, the namePropertyMap they have defined is missing a key for the CellUtils.DATA_FORMAT constant so when you call the old method (which you would think should translate ALL the keys), it doesn't find a match, it doesn't format the date and prints this error:</p>\n<pre><code>Ignoring unrecognized CellUtil format properties key: null. \n</code></pre>\n<p>This means old code which used to work fine with the old method now requires you to update your code to call the new method directly when setting a DATA_FORMAT.</p>\n<p>My question here is why was CellUtil.DATA_FORMAT (and CellUtil.WRAP_TEXT) left out of the lookup map, and, if done intentionally, why?</p>\n",
    "tags" : [ "java", "apache-poi" ],
    "owner" : {
      "account_id" : 1042691,
      "reputation" : 573,
      "user_id" : 1048376,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/417c0aafba70fa08d6ac0fc8972f093c?s=256&d=identicon&r=PG",
      "display_name" : "splashout",
      "link" : "https://stackoverflow.com/users/1048376/splashout"
    },
    "is_answered" : false,
    "view_count" : 192,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1748478521,
    "creation_date" : 1748478521,
    "link" : "https://stackoverflow.com/questions/79643142/apache-poi-5-4-1-setcellstylepropertycell-cell-string-propertyname-object-pro",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140473244,
    "post_id" : 79643142,
    "body" : "Hi @Abra I submitted a bug and it looks like they already fixed it! Impressive. I assume it will be in the next release (5.4.2) or the one after. Thanks for the advice! <a href=\"https://bz.apache.org/bugzilla/show_bug.cgi?id=69701\" rel=\"nofollow noreferrer\">bz.apache.org/bugzilla/show_bug.cgi?id=69701</a>",
    "score" : 0,
    "owner" : {
      "account_id" : 1042691,
      "reputation" : 573,
      "user_id" : 1048376,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/417c0aafba70fa08d6ac0fc8972f093c?s=256&d=identicon&r=PG",
      "display_name" : "splashout",
      "link" : "https://stackoverflow.com/users/1048376/splashout"
    },
    "creation_date" : 1748623115,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140471051,
    "post_id" : 79643142,
    "body" : "Yeah, good point.",
    "score" : 0,
    "owner" : {
      "account_id" : 1042691,
      "reputation" : 573,
      "user_id" : 1048376,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/417c0aafba70fa08d6ac0fc8972f093c?s=256&d=identicon&r=PG",
      "display_name" : "splashout",
      "link" : "https://stackoverflow.com/users/1048376/splashout"
    },
    "creation_date" : 1748567288,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140468166,
    "post_id" : 79643142,
    "body" : "Maybe you should report a <a href=\"https://bz.apache.org/bugzilla/buglist.cgi?product=POI\" rel=\"nofollow noreferrer\">bug</a>?",
    "score" : 1,
    "owner" : {
      "account_id" : 2485939,
      "reputation" : 20969,
      "user_id" : 2164365,
      "user_type" : "registered",
      "accept_rate" : 40,
      "profile_image" : "https://i.sstatic.net/RKSgV.png?s=256",
      "display_name" : "Abra",
      "link" : "https://stackoverflow.com/users/2164365/abra"
    },
    "creation_date" : 1748491791,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}