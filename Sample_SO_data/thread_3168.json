{
  "question" : {
    "question_id" : 79567460,
    "title" : "Spring Cloud Kubernetes does not reload properties from ConfigMap (watch and polling both fail to refresh)",
    "body" : "<p>I'm using Spring Boot 3.1.4 and Spring Cloud 2022.0.5 with the dependency:</p>\n<pre><code>&lt;dependency&gt;\n  &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n  &lt;artifactId&gt;spring-cloud-starter-kubernetes-fabric8-config&lt;/artifactId&gt;\n  &lt;version&gt;3.0.5&lt;/version&gt; &lt;!-- explicitly overridden --&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>My goal is to dynamically populate a list of values when the Kubernetes ConfigMap is edited on the fly, without restarting the application.\nHere's what I have:</p>\n<p>@ConfigurationProperties bean with @RefreshScope</p>\n<p>ConfigMap is loaded correctly at startup\nI've enabled both watch mode and polling mode, but neither seems to trigger a refresh</p>\n<p>bootstrap.properties:</p>\n<pre><code>spring.application.name=app-config\nspring.cloud.kubernetes.enabled=true\nspring.cloud.kubernetes.config.enabled=true\nspring.cloud.kubernetes.config.name=app-config\nspring.cloud.kubernetes.config.namespace=default\nspring.cloud.kubernetes.config.reload.enabled=true\nspring.cloud.kubernetes.config.reload.mode=polling\nspring.cloud.kubernetes.config.reload.strategy=refresh\nspring.cloud.kubernetes.config.reload.period=5000\n</code></pre>\n<p>role-reader:</p>\n<pre><code>apiVersion: rbac.authorization.k8s.io/v1\nkind: Role\nmetadata:\n  name: configmap-reader\n  namespace: default\nrules:\n  - apiGroups: [&quot;&quot;]\n    resources: [&quot;configmaps&quot;]\n    verbs: [&quot;get&quot;, &quot;list&quot;, &quot;watch&quot;]\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: RoleBinding\nmetadata:\n  name: configmap-reader-binding\n  namespace: default\nsubjects:\n  - kind: ServiceAccount\n    name: default\n    namespace: default\nroleRef:\n  kind: Role\n  name: configmap-reader\n  apiGroup: rbac.authorization.k8s.io\n</code></pre>\n<p>I verified:</p>\n<ol>\n<li>The app has RBAC permissions to get, list, watch configmaps</li>\n<li>The ConfigMap gets mounted and read</li>\n<li>The @RefreshScope bean is injected properly and used in a REST\ncontroller</li>\n</ol>\n<p>But when I edit the ConfigMap, nothing happens:</p>\n<ol>\n<li>No logs appear (even with TRACE logging)</li>\n<li>The updated config values never show up via REST</li>\n<li>@RefreshScope bean is never re-initialized</li>\n</ol>\n",
    "tags" : [ "java", "spring", "kubernetes", "spring-cloud" ],
    "owner" : {
      "account_id" : 22279339,
      "reputation" : 111,
      "user_id" : 16518165,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/7099b83b0f56f6758b9165466d72b5fa?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "stepanevgen2013",
      "link" : "https://stackoverflow.com/users/16518165/stepanevgen2013"
    },
    "is_answered" : false,
    "view_count" : 74,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1744314218,
    "creation_date" : 1744314218,
    "link" : "https://stackoverflow.com/questions/79567460/spring-cloud-kubernetes-does-not-reload-properties-from-configmap-watch-and-pol",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ ],
  "answer_comments" : { }
}