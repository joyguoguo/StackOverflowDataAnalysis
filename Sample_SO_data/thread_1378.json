{
  "question" : {
    "question_id" : 79713300,
    "title" : "PDFBox API set value for non English characters will display as garbled text",
    "body" : "<p>For Apache PDFBox API, I use unicode font named Arial Unicode MS to set value for a PDF form field.</p>\n<pre><code>PDFont unicodeFont = null;\n// Get Unicode font for signing the non english languages in pdf\ntry (InputStream stream = Thread.currentThread().getContextClassLoader().getResourceAsStream(&quot;ARIALUNI.TTF&quot;)) {\n    unicodeFont = PDType0Font.load(document, stream);\n    PDResources resources = getPDResources(form);\n    resources.put(COSName.getPDFName(unicodeFont.getName()), unicodeFont);\n    form.setDefaultResources(resources);\n}\ntextField.setDefaultAppearance(String.format(&quot;/%s 9 Tf 0.32 0.32 0.32 rg&quot;, unicodeFont.getName()));\ntextField.setValue(content);\n</code></pre>\n<p>But for non English characters such as Chinese or Hebrew, the content displayed as garbled text. The content displayed correctly in mac os but garbled text in windows. I used Adobe Reader software. Looks like Windows does not have Arial Unicode MS font by default. But my code make this font as embedded font. But it does not work. How can I do to fix the issue?</p>\n<p>For accessibilty purpose, I have to use textField.setValue(content) API.\nBut the font could not be embedded correctly.</p>\n",
    "tags" : [ "java", "pdfbox" ],
    "owner" : {
      "account_id" : 39505749,
      "reputation" : 1,
      "user_id" : 29309806,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/2692b7047dae039fb4b5e285057c5241?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Hu Chris",
      "link" : "https://stackoverflow.com/users/29309806/hu-chris"
    },
    "is_answered" : false,
    "view_count" : 74,
    "closed_date" : 1754217448,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1754146601,
    "creation_date" : 1753357977,
    "link" : "https://stackoverflow.com/questions/79713300/pdfbox-api-set-value-for-non-english-characters-will-display-as-garbled-text",
    "closed_reason" : "Duplicate"
  },
  "answers" : [ {
    "answer_id" : 79723438,
    "question_id" : 79713300,
    "body" : "<p>As @<a href=\"https://stackoverflow.com/users/535646/tilman-hausherr\" title=\"19,121 reputation\">Tilman Hausherr</a> pointed out, you embed a subsetted Unicode font, but I think the font is subsetted correctly. You may share your PDF for examination.</p>\n<p>I believe you see the wrong order of Arabic/Hebrew words and/or reversed order of symbols in those words. Is it what you mean by &quot;garbled&quot;?</p>\n<p>PDFBox doesn't support RTL scripts, so in case of RTL you need to use a 3rd-party library for BIDI reordering. See a good discussion about this topic and the solution here: <a href=\"https://stackoverflow.com/questions/48284888\">Writing Arabic with PDFBOX with correct characters presentation form without being separated</a></p>\n<p>---</p>\n<p>As for proper text displaying on MacOS:</p>\n<p>The default value of text fields (/V value in the Text field dictionary) is constructed using explicit UTF_16BE encoding.</p>\n<p>Text in the default appearance stream is created by Unicode code points and the Java default character encoding.</p>\n<p>You may compare the /V value in the field dictionary and the text inside the default appearance stream of the field (in angular brackets before the Tj operator).</p>\n<p>So I guess you have different Java/System encodings on Windows and MacOS. Another thing I can think of is that a viewing PDF software on MacOS skips the Appearance Stream dictionaries of AcroForm (text) fields, but I very doubt about the latter one.</p>\n",
    "score" : -1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 35354441,
      "reputation" : 44,
      "user_id" : 27156279,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/oJPdtGFA.jpg?s=256",
      "display_name" : "Alexey Gagarinov",
      "link" : "https://stackoverflow.com/users/27156279/alexey-gagarinov"
    },
    "creation_date" : 1754146601,
    "last_activity_date" : 1754146601,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140638900,
    "post_id" : 79713300,
    "body" : "The linked answer isn&#39;t helpful. Better look at <a href=\"https://stackoverflow.com/questions/65701597/added-font-not-loading-correct-pdfbox-for-acroform\" title=\"added font not loading correct pdfbox for acroform\">stackoverflow.com/questions/65701597/&hellip;</a>",
    "score" : 0,
    "owner" : {
      "account_id" : 255529,
      "reputation" : 19234,
      "user_id" : 535646,
      "user_type" : "registered",
      "accept_rate" : 40,
      "profile_image" : "https://i.sstatic.net/yGyps.jpg?s=256",
      "display_name" : "Tilman Hausherr",
      "link" : "https://stackoverflow.com/users/535646/tilman-hausherr"
    },
    "creation_date" : 1754230593,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140617399,
    "post_id" : 79713300,
    "body" : "queeg could well be right. Make your question less woolly by specifying the codepoints of problematic characters. While there&#39;s no such thing as a Unicode &#39;omnifont&#39;, you might be able to embed a font better suited to your purpose, <i>plus</i> I wouldn&#39;t be surprised if embedding Arial Unicode MS breaks the terms of its licence",
    "score" : 1,
    "owner" : {
      "account_id" : 22124137,
      "reputation" : 4243,
      "user_id" : 16376827,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/1ImPw.png?s=256",
      "display_name" : "g00se",
      "link" : "https://stackoverflow.com/users/16376827/g00se"
    },
    "creation_date" : 1753431198,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140616558,
    "post_id" : 79713300,
    "body" : "Sounds like whatever font is used to render the document - it is missing some glyphs. If the font in use is embedded, why should it happen only on one platform?",
    "score" : 1,
    "owner" : {
      "account_id" : 5289146,
      "reputation" : 9940,
      "user_id" : 4222206,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/416696430ab23f397a5dbeda73e72896?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "queeg",
      "link" : "https://stackoverflow.com/users/4222206/queeg"
    },
    "creation_date" : 1753396734,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140615318,
    "post_id" : 79713300,
    "body" : "disable subsetting when loading the font (this question is likely a duplicate)",
    "score" : 0,
    "owner" : {
      "account_id" : 255529,
      "reputation" : 19234,
      "user_id" : 535646,
      "user_type" : "registered",
      "accept_rate" : 40,
      "profile_image" : "https://i.sstatic.net/yGyps.jpg?s=256",
      "display_name" : "Tilman Hausherr",
      "link" : "https://stackoverflow.com/users/535646/tilman-hausherr"
    },
    "creation_date" : 1753366608,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}