{
  "question" : {
    "question_id" : 79664877,
    "title" : "Why does method-level produces not override class-level in Spring when generating OpenAPI spec with springdoc?",
    "body" : "<p>Using Spring Boot (3.5.0) with springdoc (2.8.9) I noticed something unexpected when specifying produces at both the class and method levels in a @RestController.</p>\n<p>According to the Javadoc for <code>org.springframework.web.bind.annotation.RequestMapping#produces</code>:</p>\n<blockquote>\n<p>Supported at the type level as well as at the method level! If specified at both levels, the method level produces condition overrides the type level condition.</p>\n</blockquote>\n<p>However, in my example controller below:</p>\n<pre><code>@RestController\n@RequestMapping(produces = MediaType.APPLICATION_JSON_VALUE)\npublic class MediaTypeDemoController {\n\n    @GetMapping(&quot;/json&quot;)\n    public ResponseEntity&lt;Map&lt;String, String&gt;&gt; getJsonResponse() {\n        Map&lt;String, String&gt; response = Map.of(&quot;message&quot;, &quot;This is JSON&quot;);\n        return ResponseEntity.ok(response);\n    }\n\n    @GetMapping(value = &quot;/xml&quot;, produces = MediaType.APPLICATION_XML_VALUE)\n    public ResponseEntity&lt;String&gt; getXmlResponse() {\n        String xml = &quot;&lt;message&gt;This is XML&lt;/message&gt;&quot;;\n        return ResponseEntity.ok(xml);\n    }\n}\n</code></pre>\n<p>The OpenAPI spec generated for <code>GET /xml</code> includes both <code>application/json</code> and <code>application/xml</code> as possible response media types. I expected it to only list <code>application/xml</code>, since it's explicitly declared at the method level.</p>\n<p><strong>Update:</strong>\nFixed by <a href=\"https://github.com/springdoc/springdoc-openapi/pull/3026\" rel=\"nofollow noreferrer\">https://github.com/springdoc/springdoc-openapi/pull/3026</a></p>\n",
    "tags" : [ "java", "spring-boot", "openapi", "springdoc" ],
    "owner" : {
      "account_id" : 390323,
      "reputation" : 111,
      "user_id" : 750308,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/b03ebe98138bd5c42fa68627837d32f9?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Nicklas",
      "link" : "https://stackoverflow.com/users/750308/nicklas"
    },
    "is_answered" : false,
    "view_count" : 88,
    "answer_count" : 0,
    "score" : 1,
    "last_activity_date" : 1753764927,
    "creation_date" : 1749818935,
    "link" : "https://stackoverflow.com/questions/79664877/why-does-method-level-produces-not-override-class-level-in-spring-when-generatin",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140513141,
    "post_id" : 79664877,
    "body" : "I think this behavior was introduced by <a href=\"https://github.com/springdoc/springdoc-openapi/pull/2600\" rel=\"nofollow noreferrer\">PR #2600</a> in springdoc 2.6.0.",
    "score" : 0,
    "owner" : {
      "account_id" : 390323,
      "reputation" : 111,
      "user_id" : 750308,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/b03ebe98138bd5c42fa68627837d32f9?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Nicklas",
      "link" : "https://stackoverflow.com/users/750308/nicklas"
    },
    "creation_date" : 1749890558,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140511851,
    "post_id" : 79664877,
    "body" : "I would suggest opening an issue on Spring board.",
    "score" : 0,
    "owner" : {
      "account_id" : 209503,
      "reputation" : 23867,
      "user_id" : 460557,
      "user_type" : "registered",
      "accept_rate" : 100,
      "profile_image" : "https://www.gravatar.com/avatar/b4565f97815833390c9c880e9e8522e4?s=256&d=identicon&r=PG",
      "display_name" : "Jorge Campos",
      "link" : "https://stackoverflow.com/users/460557/jorge-campos"
    },
    "creation_date" : 1749829632,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140511539,
    "post_id" : 79664877,
    "body" : "This looks like an inconsistency between the openapi spec generation and the actual behavior. The documentation you mentioned is correct and that is how @RequestMapping#produces behaves. I am not sure if it is a bug, but you can use the @Operation to generate the spec as you want.",
    "score" : 0,
    "owner" : {
      "account_id" : 29897314,
      "reputation" : 407,
      "user_id" : 22911863,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/z1YDCFM5.jpg?s=256",
      "display_name" : "authorizeduser",
      "link" : "https://stackoverflow.com/users/22911863/authorizeduser"
    },
    "creation_date" : 1749823115,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}