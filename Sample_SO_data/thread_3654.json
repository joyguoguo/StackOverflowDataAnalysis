{
  "question" : {
    "question_id" : 79533818,
    "title" : "ClassNotFoundExcetion is thrown by library when class is present in the application&#39;s classpath",
    "body" : "<p>I have a Maven project with the following dependencies:</p>\n<ul>\n<li><code>org.apache.poi:poi-ooxml:4.1.0</code></li>\n<li><code>org.apache.poi:poi:4.1.0</code></li>\n<li>An internal dependency/library, lets call it <strong>Lib-A</strong>, which was built using Gradle. This internal library uses the above two libraries that is, on its own it has dependencies on the above POI libraries but with different version. This is verified from the library's gradle file in the project.</li>\n</ul>\n<p>The application however throws a runtime exception:</p>\n<pre><code>java.lang.ClassNotFoundException: org.apache.poi.POIXMLTypeLoader\n    at java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:641)\n    at java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:188)\n    at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:525)\n    at org.openxmlformats.schemas.spreadsheetml.x2006.main.CTWorkbook$Factory.newInstance(Unknown Source)\n    at org.apache.poi.xssf.usermodel.XSSFWorkbook.onWorkbookCreate(XSSFWorkbook.java:456)\n    at org.apache.poi.xssf.usermodel.XSSFWorkbook.&lt;init&gt;(XSSFWorkbook.java:259)\n    at org.apache.poi.xssf.usermodel.XSSFWorkbook.&lt;init&gt;(XSSFWorkbook.java:253)\n    at org.apache.poi.xssf.usermodel.XSSFWorkbook.&lt;init&gt;(XSSFWorkbook.java:241)\n    at &lt;some line at Lib-A&gt;\n    ...&lt;more logs&gt;\n</code></pre>\n<p>The missing class <code>org.apache.poi.POIXMLTypeLoader</code> is actually available in <a href=\"https://javadoc.io/static/org.apache.poi/poi-ooxml/4.1.0/org/apache/poi/ooxml/POIXMLTypeLoader.html\" rel=\"nofollow noreferrer\"><code>org.apache.poi:poi:4.1.0</code></a>. Why is <code>ClassNotFoundException</code> still thrown in the application? Is <strong>Lib-A</strong> not aware that the class is available in the classpath?</p>\n",
    "tags" : [ "java", "maven", "exception", "gradle", "classnotfoundexception" ],
    "owner" : {
      "account_id" : 9368669,
      "reputation" : 103,
      "user_id" : 6952691,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/3913d377bb815f7269ed34e7e13ec7e2?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "user6952691",
      "link" : "https://stackoverflow.com/users/6952691/user6952691"
    },
    "is_answered" : true,
    "view_count" : 67,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1742924296,
    "creation_date" : 1742909169,
    "link" : "https://stackoverflow.com/questions/79533818/classnotfoundexcetion-is-thrown-by-library-when-class-is-present-in-the-applicat",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79534454,
    "question_id" : 79533818,
    "body" : "<p>Ok <code>org.apache.poi.POIXMLTypeLoader</code> is an old classname.  It was moved to a new package <code>org.apache.poi.ooxml.POIXMLTypeLoader</code> .   If you are experiencing <code>org.apache.poi.POIXMLTypeLoader</code> ClassNotFoundException it's because an old version of the library exists on the classpath and it's requesting the older version of the fully qualified class name.</p>\n<p>And while <code>gradle dependencies</code> may NOT be showing another version of it. The dependency could still be there if another jar packaged POI in its jar file.  If your Lib-A has this dependency with POI I'd check it and make sure they didn't do something hinky like packaging other dependencies in their Jar.</p>\n<p>You also want to make sure you are using the official POI jar files from Maven central.  If you have other repos in your project they could be to blame.  You don't want to get pwned by a supply chain attack.  Something a dep that packages other libs &quot;hinky&quot; versions could signify.</p>\n",
    "score" : 1,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 51881,
      "reputation" : 39410,
      "user_id" : 155020,
      "user_type" : "registered",
      "accept_rate" : 80,
      "profile_image" : "https://i.sstatic.net/fEqVo.png?s=256",
      "display_name" : "chubbsondubs",
      "link" : "https://stackoverflow.com/users/155020/chubbsondubs"
    },
    "creation_date" : 1742924296,
    "last_activity_date" : 1742924296,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140261214,
    "post_id" : 79533818,
    "body" : "probably issue of your IDE not indexing the dependency, have you tried running it with  maven something like <code>mvn exec:java -Dexec.mainClass=&quot;com.example.Main&quot;</code> or <code>mvn exec:java -D&quot;exec.mainClass&quot;=&quot;com.example.Main&quot;</code> for windows",
    "score" : 0,
    "owner" : {
      "account_id" : 4477746,
      "reputation" : 1098,
      "user_id" : 3642410,
      "user_type" : "registered",
      "accept_rate" : 100,
      "profile_image" : "https://i.sstatic.net/zvDmw.jpg?s=256",
      "display_name" : "Karim",
      "link" : "https://stackoverflow.com/users/3642410/karim"
    },
    "creation_date" : 1742911615,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140261180,
    "post_id" : 79533818,
    "body" : "@SzymonRoziewski From the dependency tree, the only version of both POI libraries are the ones specified above (<code>4.1.0</code>), as mentioned the project&#39;s POM. The class <code>POIXMLTypeLoader</code> is in <code>poi-ooxml:4.1.0</code>",
    "score" : 0,
    "owner" : {
      "account_id" : 9368669,
      "reputation" : 103,
      "user_id" : 6952691,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/3913d377bb815f7269ed34e7e13ec7e2?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "user6952691",
      "link" : "https://stackoverflow.com/users/6952691/user6952691"
    },
    "creation_date" : 1742911144,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140261058,
    "post_id" : 79533818,
    "body" : "Check the dependency tree <code>mvn dependency:tree</code>. 1. Check if the <code>POIXMLTypeLoader</code> class exists. Open the <code>poi-4.1.0</code> JAR and confirm that <code>org.apache.poi.POIXMLTypeLoader</code> exists.  When Maven resolves dependencies, it uses the principle of nearest dependency in the dependency tree, another dependency can overwrite it.",
    "score" : 0,
    "owner" : {
      "account_id" : 5505924,
      "reputation" : 1031,
      "user_id" : 4373784,
      "user_type" : "registered",
      "accept_rate" : 62,
      "profile_image" : "https://i.sstatic.net/jY9up.jpg?s=256",
      "display_name" : "Szymon Roziewski",
      "link" : "https://stackoverflow.com/users/4373784/szymon-roziewski"
    },
    "creation_date" : 1742909695,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}