{
  "question" : {
    "question_id" : 79572353,
    "title" : "How to convert a http response with content type application/json to application/octet-stream?",
    "body" : "<h2>What is the issue?</h2>\n<ul>\n<li>We use AWS API Gateway for integration with the AWS S3 using REST calls.</li>\n<li>In the API Gateway transformation <strong>we haven't supported <code>HTTP_HEADERS</code> yet.</strong> And we don't want to roll out changes without prior notifying to the clients and that'll take time.</li>\n<li>The default <code>ACCEPT</code> header API Gateway's Integration Request uses is\n<code>APPLICATION/JSON</code>.</li>\n<li>So, S3 responds with <code>Content-Type</code> : <code>APPLICATION/JSON</code> header. However, the content is of type <code>APPLICATION/OCTET-STREAM</code>.</li>\n<li>On de deserialization of content I encounter <code>java.util.zip.ZipException: incorrect header check</code> error due to <code>Content-Type</code> mismatch.</li>\n</ul>\n<h3>Code Snippet:</h3>\n<pre class=\"lang-java prettyprint-override\"><code>    String apiUrl = &quot;https://url&quot;;\n\n    //REQUEST \n    final var client = HttpClients.createDefault();\n    HttpGet httpGet = new HttpGet(apiUrl);\n    httpGet.addHeader(&quot;Accept&quot;, &quot;application/octet-stream&quot;); //IT IS USELESS TO ADD HERE (IGNORED).\n\n\n    //RESPONSE      \n    var response = client.execute(httpGet);\n \n\n    //DESERIALIZATION\n    byte[] responseString = EntityUtils.toByteArray(response.getEntity());\n\n         \n    CustomObject fullValuationObject = CompressedReadWriteFormat.deserializeDeflated(responseString);\n</code></pre>\n<h3>What I've already tried?</h3>\n<ul>\n<li><strong>WORKED</strong>: I've created an another API Gateway that accepts <code>ACCEPT</code> header with value of <code>APPLICATION/OCTET-STREAM</code> and the response got successfully de serialized. However, we don't want to create another API Gateway for the same.</li>\n</ul>\n<hr />\n<p>Any solution that could apparently change the content on the Application layer(Java) would be great.</p>\n<p>I'll highly appreciate for any solution.</p>\n",
    "tags" : [ "java", "http", "http-headers", "aws-api-gateway", "apache-httpclient-5.x" ],
    "owner" : {
      "account_id" : 8056033,
      "reputation" : 3375,
      "user_id" : 6073148,
      "user_type" : "registered",
      "accept_rate" : 75,
      "profile_image" : "https://i.sstatic.net/6LMP5.jpg?s=256",
      "display_name" : "Zahid Khan",
      "link" : "https://stackoverflow.com/users/6073148/zahid-khan"
    },
    "is_answered" : false,
    "view_count" : 77,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1744646672,
    "creation_date" : 1744605324,
    "link" : "https://stackoverflow.com/questions/79572353/how-to-convert-a-http-response-with-content-type-application-json-to-application",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ ],
  "answer_comments" : { }
}