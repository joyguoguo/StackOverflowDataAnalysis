{
  "question" : {
    "question_id" : 79606913,
    "title" : "Receiving Data Too Long for column",
    "body" : "<p>I'm working with a <strong>Spring Boot</strong> application using JPA and Hibernate, and I'm trying to persist a field that is serialized as JSON using a custom <strong>@Converter</strong>. The field is mapped to a varchar(2000) column in <strong>MySQL</strong>.<br/>\n<strong>DTO:</strong></p>\n<pre class=\"lang-java prettyprint-override\"><code>@XmlElement\nprivate Object value;\n</code></pre>\n<p><strong>Entity:</strong></p>\n<pre class=\"lang-java prettyprint-override\"><code>@Column(name = &quot;value&quot;)\n@Convert(converter = JpaConverterJson.class)\nprivate Object value;\n</code></pre>\n<p><strong>Converter:</strong></p>\n<pre class=\"lang-java prettyprint-override\"><code>@Component\n@Converter\n@Slf4j\npublic class JpaConverterJson implements AttributeConverter&lt;Object, String&gt; {\n\n    @Autowired\n    private ObjectMapper objectMapper;\n\n    @Override\n    public String convertToDatabaseColumn(Object meta) {\n        try {\n            objectMapper.disable(SerializationFeature.WRAP_ROOT_VALUE);\n            return objectMapper.writeValueAsString(meta);\n        } catch (JsonProcessingException ex) {\n            log.error(&quot;JsonProcessingException encoding Object into String: {}&quot;, ex.getMessage());\n            return null;\n        }\n    }\n\n    @Override\n    public Object convertToEntityAttribute(String dbData) {\n        try {\n            return objectMapper.readValue(dbData, Object.class);\n        } catch (IOException ex) {\n            log.error(&quot;IOException decoding json from database: {}&quot;, ex.getMessage());\n            return null;\n        }\n    }\n}\n</code></pre>\n<p><strong>Issue:</strong></p>\n<p>When I run a native SQL INSERT query, the data gets stored correctly.</p>\n<p>But when I persist the entity using JPA, I get this error:</p>\n<pre class=\"lang-java prettyprint-override\"><code>com.mysql.cj.jdbc.exceptions.MysqlDataTruncation: Data truncation: Data too long for column 'value' at row 1\n</code></pre>\n<p>Why does Hibernate fail to persist the data when the native SQL works?</p>\n",
    "tags" : [ "java", "spring-boot", "hibernate", "jpa" ],
    "owner" : {
      "account_id" : 21507989,
      "reputation" : 53,
      "user_id" : 15851104,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a-/AOh14Gjvq_HbFLrX3KnIFdlTtxqgxMB3VeAolKY2YbWrvw=k-s256",
      "display_name" : "Ibrahim Alvi",
      "link" : "https://stackoverflow.com/users/15851104/ibrahim-alvi"
    },
    "is_answered" : true,
    "view_count" : 102,
    "answer_count" : 1,
    "score" : 3,
    "last_activity_date" : 1746467787,
    "creation_date" : 1746448277,
    "link" : "https://stackoverflow.com/questions/79606913/receiving-data-too-long-for-column",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79607411,
    "question_id" : 79606913,
    "body" : "<p>Before persisting the JSON string, Hibernate validates its length against the defined column size (e.g., <code>VARCHAR(2000)</code>). If the content exceeds this limit, it throws a <code>Data too long for column</code> exception. In contrast, native SQL operations may silently truncate the data or bypass length validation altogether.</p>\n<hr />\n<p>Use <code>LONGTEXT</code> to handle large JSON:</p>\n<pre><code>@Column(name = &quot;value&quot;, columnDefinition = &quot;LONGTEXT&quot;)\n@Convert(converter = JpaConverterJson.class)\nprivate Object value;\n</code></pre>\n<p>And update the column in MySQL:</p>\n<p><code>[LONGTEXT</code> avoids size issues for large JSON data]</p>\n<pre><code>ALTER TABLE your_table MODIFY COLUMN value LONGTEXT;\n</code></pre>\n<p>I hope your problem is solved.</p>\n",
    "score" : 2,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 21304134,
      "reputation" : 343,
      "user_id" : 15679642,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/J0mfw.jpg?s=256",
      "display_name" : "Mehdi sahraei",
      "link" : "https://stackoverflow.com/users/15679642/mehdi-sahraei"
    },
    "creation_date" : 1746467787,
    "last_activity_date" : 1746467787,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140396947,
    "post_id" : 79606913,
    "body" : "Also <code>objectMapper.readValue(dbData, Object.class);</code> is super suspicious. How does it know what class to instantiate? From what I can tell it doesn&#39;t do what you expect it to do.",
    "score" : 0,
    "owner" : {
      "account_id" : 4497436,
      "reputation" : 20786,
      "user_id" : 3656904,
      "user_type" : "registered",
      "accept_rate" : 67,
      "profile_image" : "https://www.gravatar.com/avatar/8bdbd1f89f8907e8e8b15ab88c084c65?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "talex",
      "link" : "https://stackoverflow.com/users/3656904/talex"
    },
    "creation_date" : 1746450396,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140396927,
    "post_id" : 79606913,
    "body" : "@IbrahimAlvi first it is not tread safe method, but even it was thread safe some other method do not expect your <code>objectMapper</code> to be changed and even if all methods set that value to one they want between setting it and using <code>objectMapper</code> other method can change it too. If you need <code>ObjectMapper</code> to be configured in specific way create new instance. It isn&#39;t related to your problem, I just noticed that bizarre code and decided to warn you.",
    "score" : 0,
    "owner" : {
      "account_id" : 4497436,
      "reputation" : 20786,
      "user_id" : 3656904,
      "user_type" : "registered",
      "accept_rate" : 67,
      "profile_image" : "https://www.gravatar.com/avatar/8bdbd1f89f8907e8e8b15ab88c084c65?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "talex",
      "link" : "https://stackoverflow.com/users/3656904/talex"
    },
    "creation_date" : 1746450127,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140396885,
    "post_id" : 79606913,
    "body" : "@talex, can you please specify why not to do so, as it is already written code, and right now I am trying solutions to fix it? Would appreciate a reason behind it.",
    "score" : 0,
    "owner" : {
      "account_id" : 21507989,
      "reputation" : 53,
      "user_id" : 15851104,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a-/AOh14Gjvq_HbFLrX3KnIFdlTtxqgxMB3VeAolKY2YbWrvw=k-s256",
      "display_name" : "Ibrahim Alvi",
      "link" : "https://stackoverflow.com/users/15851104/ibrahim-alvi"
    },
    "creation_date" : 1746449472,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140396869,
    "post_id" : 79606913,
    "body" : "I would make sure the data really does not exceed your specified limit in your code",
    "score" : 1,
    "owner" : {
      "account_id" : 22279939,
      "reputation" : 124,
      "user_id" : 16508439,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a-/AOh14GjpvnWvanjcji81GAs_mzuvXCWwU8XoT1UBTvhrEw=k-s256",
      "display_name" : "rento",
      "link" : "https://stackoverflow.com/users/16508439/rento"
    },
    "creation_date" : 1746449146,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140396862,
    "post_id" : 79606913,
    "body" : "Aside from your specific question, storing JSIN data as a string in a <code>VARCHAR</code> column almost always leads to problems later. There are many questions here where developers have done this and can&#39;t then retrieve or query the data efficiently. Ask yourself if you should deserialize your JSON data and store it as native MySQL columns.",
    "score" : 2,
    "owner" : {
      "account_id" : 2095810,
      "reputation" : 5436,
      "user_id" : 14853083,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/tiedu.png?s=256",
      "display_name" : "Tangentially Perpendicular",
      "link" : "https://stackoverflow.com/users/14853083/tangentially-perpendicular"
    },
    "creation_date" : 1746449033,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140396851,
    "post_id" : 79606913,
    "body" : "&quot;objectMapper.disable(SerializationFeature.WRAP_ROOT_VALUE);&zwnj;&#8203;&quot; please don&#39;t do it.",
    "score" : 0,
    "owner" : {
      "account_id" : 4497436,
      "reputation" : 20786,
      "user_id" : 3656904,
      "user_type" : "registered",
      "accept_rate" : 67,
      "profile_image" : "https://www.gravatar.com/avatar/8bdbd1f89f8907e8e8b15ab88c084c65?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "talex",
      "link" : "https://stackoverflow.com/users/3656904/talex"
    },
    "creation_date" : 1746448747,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}