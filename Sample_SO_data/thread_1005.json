{
  "question" : {
    "question_id" : 79752982,
    "title" : "TextView Gradient Colour not showing properly in android",
    "body" : "<p>I am trying to implement the gradient design into textview like below via <code>LinearGradient</code> but after trying for several hours even with AI tools i am not able to get desired result.\n<a href=\"https://i.sstatic.net/UmqWTqhE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/UmqWTqhE.png\" alt=\"Gradient textview \" /></a></p>\n<p>I used this as reference <a href=\"https://stackoverflow.com/questions/2680607/text-with-gradient-in-android\">Text with gradient in Android</a></p>\n<p><strong>Layout XML</strong></p>\n<pre><code>&lt;androidx.core.widget.NestedScrollView xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\n    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;\n    android:layout_width=&quot;match_parent&quot;\n    android:layout_height=&quot;match_parent&quot;\n    android:background=&quot;#CCEBCD&quot;\n    android:clickable=&quot;true&quot;\n    android:fillViewport=&quot;true&quot;\n    android:focusable=&quot;true&quot;&gt;\n\n    &lt;androidx.constraintlayout.widget.ConstraintLayout\n        android:layout_width=&quot;match_parent&quot;\n        android:layout_height=&quot;wrap_content&quot;\n        android:paddingStart=&quot;20dp&quot;\n        android:paddingEnd=&quot;20dp&quot;\n        android:paddingBottom=&quot;20dp&quot;&gt;\n\n        &lt;TextView\n            android:id=&quot;@+id/createAccount&quot;\n            android:layout_width=&quot;wrap_content&quot;\n            android:layout_height=&quot;wrap_content&quot;\n            android:text=&quot;Create An Account&quot;\n            android:textAlignment=&quot;center&quot;\n            android:textSize=&quot;32sp&quot;\n            android:textStyle=&quot;bold&quot;\n            app:layout_constraintEnd_toEndOf=&quot;parent&quot;\n            app:layout_constraintStart_toStartOf=&quot;parent&quot;\n            app:layout_constraintTop_toTopOf=&quot;parent&quot; /&gt;\n</code></pre>\n<p><strong>Code:</strong></p>\n<pre><code>TextView titleText = view.findViewById(R.id.createAccount);\nfloat textWidth = titleText.getPaint().measureText(titleText.getText().toString());\n\nShader titleGradient = new LinearGradient(\n                0, 0, textWidth, 0,       \n                new int[]{\n                        getResources().getColor(R.color.black),\n                        getResources().getColor(R.color.green_gradient)\n                },Shader.TileMode.CLAMP \n        );\n        titleText.getPaint().setShader(titleGradient);\n        titleText.invalidate();\n</code></pre>\n<p>I also tried with post and making textview <code>match_parent</code>/0dp but still getting same result. I\n<a href=\"https://i.sstatic.net/JAlCJq2C.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/JAlCJq2C.png\" alt=\"Output Of my code\" /></a></p>\n",
    "tags" : [ "java", "android", "textview", "linear-gradients" ],
    "owner" : {
      "account_id" : 8725718,
      "reputation" : 1748,
      "user_id" : 6527410,
      "user_type" : "registered",
      "accept_rate" : 53,
      "profile_image" : "https://i.sstatic.net/Bpdap.jpg?s=256",
      "display_name" : "androidXP",
      "link" : "https://stackoverflow.com/users/6527410/androidxp"
    },
    "is_answered" : false,
    "view_count" : 105,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1756804427,
    "creation_date" : 1756771950,
    "link" : "https://stackoverflow.com/questions/79752982/textview-gradient-colour-not-showing-properly-in-android",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79753287,
    "question_id" : 79752982,
    "body" : "<p>he problem is usually that the <code>TextView</code>’s width isn’t finalized when you’re creating the <code>LinearGradient</code>. At the moment you’re measuring, <code>titleText.getWidth()</code> or even <code>measureText()</code> might not give the actual drawn width yet, because layout hasn’t completed.</p>\n<pre><code>TextView titleText = view.findViewById(R.id.createAccount);\n\ntitleText.getViewTreeObserver().addOnGlobalLayoutListener(\n        new ViewTreeObserver.OnGlobalLayoutListener() {\n            @Override\n            public void onGlobalLayout() {\n                titleText.getViewTreeObserver().removeOnGlobalLayoutListener(this);\n\n                float textWidth = titleText.getPaint().measureText(titleText.getText().toString());\n\n                Shader titleGradient = new LinearGradient(\n                        0, 0, textWidth, 0,\n                        new int[]{\n                                getResources().getColor(R.color.black),\n                                getResources().getColor(R.color.green_gradient)\n                        },\n                        null,\n                        Shader.TileMode.CLAMP\n                );\n                titleText.getPaint().setShader(titleGradient);\n                titleText.invalidate();\n            }\n        });\n</code></pre>\n",
    "score" : -1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 21877746,
      "reputation" : 1,
      "user_id" : 16166545,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/7j7q1LeK.jpg?s=256",
      "display_name" : "edith oga",
      "link" : "https://stackoverflow.com/users/16166545/edith-oga"
    },
    "creation_date" : 1756804427,
    "last_activity_date" : 1756804427,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140746942,
    "post_id" : 79752982,
    "body" : "Enter <code>null</code> in <code>LinearGradient</code> 6th argument.",
    "score" : 0,
    "owner" : {
      "account_id" : 6979173,
      "reputation" : 1473,
      "user_id" : 6576302,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/WZY3L.jpg?s=256",
      "display_name" : "C.F.G",
      "link" : "https://stackoverflow.com/users/6576302/c-f-g"
    },
    "creation_date" : 1758277189,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140710634,
    "post_id" : 79752982,
    "body" : "@MikeM. I tried with <code>Color.Black</code> but the setting <code>android:textColor=&quot;@color&#47;black&quot;</code> in xml help me in getting effect.",
    "score" : 1,
    "owner" : {
      "account_id" : 8725718,
      "reputation" : 1748,
      "user_id" : 6527410,
      "user_type" : "registered",
      "accept_rate" : 53,
      "profile_image" : "https://i.sstatic.net/Bpdap.jpg?s=256",
      "display_name" : "androidXP",
      "link" : "https://stackoverflow.com/users/6527410/androidxp"
    },
    "creation_date" : 1756863154,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140710632,
    "post_id" : 79752982,
    "body" : "@AlexeyGagarinov i didnt use <code>textView.setTextColor()</code> but i set colour in xml and now i see <code>Shader</code> effect.",
    "score" : 0,
    "owner" : {
      "account_id" : 8725718,
      "reputation" : 1748,
      "user_id" : 6527410,
      "user_type" : "registered",
      "accept_rate" : 53,
      "profile_image" : "https://i.sstatic.net/Bpdap.jpg?s=256",
      "display_name" : "androidXP",
      "link" : "https://stackoverflow.com/users/6527410/androidxp"
    },
    "creation_date" : 1756862907,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140708386,
    "post_id" : 79752982,
    "body" : "Your LinearGradient implementation is almost correct, but there&#39;s a crucial issue with timing and the TextView&#39;s measured dimensions. When you call getPaint().measureText(), the TextView&#39;s layout might not have been fully measured yet, leading to a text width of 0. This results in the gradient not being applied correctly.  The Solution The correct approach is to wait for the TextView to be laid out before creating and applying the LinearGradient. You can achieve this using a ViewTreeObserver.OnGlobalLayoutListener.",
    "score" : 0,
    "owner" : {
      "account_id" : 29415784,
      "reputation" : 23,
      "user_id" : 22538645,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/kZJ83RLb.jpg?s=256",
      "display_name" : "Er. Abhishek Tandon",
      "link" : "https://stackoverflow.com/users/22538645/er-abhishek-tandon"
    },
    "creation_date" : 1756796703,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140708048,
    "post_id" : 79752982,
    "body" : "Yeah, that looks like a leftover alpha value from the original color. Even when you set a <code>Shader</code> on a <code>Paint</code>, it will still use the alpha from its color value, and most themes&#39; text colors are not 100% opaque. That&#39;s what that answer ^ is doing: it&#39;s resetting the alpha by using an opaque color. You can do the same with any opaque value, e.g., just <code>Color.BLACK</code>.",
    "score" : 0,
    "owner" : {
      "account_id" : 3397419,
      "reputation" : 39331,
      "user_id" : 2850651,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/ooWVw.jpg?s=256",
      "display_name" : "Mike M.",
      "link" : "https://stackoverflow.com/users/2850651/mike-m"
    },
    "creation_date" : 1756776766,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140708015,
    "post_id" : 79752982,
    "body" : "Did you try <code>textView.setTextColor()</code> using the first color of the gradient, as suggested in the link you mentioned? (See the 2nd answer there).",
    "score" : 2,
    "owner" : {
      "account_id" : 35354441,
      "reputation" : 44,
      "user_id" : 27156279,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/oJPdtGFA.jpg?s=256",
      "display_name" : "Alexey Gagarinov",
      "link" : "https://stackoverflow.com/users/27156279/alexey-gagarinov"
    },
    "creation_date" : 1756774331,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79753287" : [ {
      "comment_id" : 140710635,
      "post_id" : 79753287,
      "body" : "I already mentioned that i used post for this.",
      "score" : 0,
      "owner" : {
        "account_id" : 8725718,
        "reputation" : 1748,
        "user_id" : 6527410,
        "user_type" : "registered",
        "accept_rate" : 53,
        "profile_image" : "https://i.sstatic.net/Bpdap.jpg?s=256",
        "display_name" : "androidXP",
        "link" : "https://stackoverflow.com/users/6527410/androidxp"
      },
      "creation_date" : 1756863196,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}