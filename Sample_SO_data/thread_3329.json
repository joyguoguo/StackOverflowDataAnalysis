{
  "question" : {
    "question_id" : 79555622,
    "title" : "how to keep the value up and organize the cycle correctly?",
    "body" : "<p>I have this code:</p>\n<pre><code>import java.util.List; import java.util.Scanner;\n\npublic class AddElementsInLists {\n\n    private static final Object lock1 = new Object();\n    private static final Object lock2 = new Object();\n    private static final Object lock3 = new Object();\n\n\n    public static void addingForFirstList(String double1, Scanner scanner1, &gt;List&lt;String&gt; firstValues) {\n        synchronized (lock1) {\n            double1 = scanner1.nextLine();\n            firstValues.add(double1);\n        }\n    }\n\n    public static void addingForSymbolsList1(String symbol, Scanner scanner2, List&lt;String&gt; symbols) {\n         synchronized (lock2) {\n            symbol = scanner2.nextLine();\n            symbols.add(symbol);\n         }\n    }\n\n    public static void addingForSecondList(String double2, Scanner scanner3, List&lt;String&gt; secondValues) {\n         synchronized (lock3) {\n            double2 = scanner3.nextLine();\n            secondValues.add(double2);\n        }\n    } } import java.util.ArrayList; import java.util.List; import java.util.Scanner;\n\npublic class Test {\n    private static Scanner scanner1 = new Scanner(System.in);\n    private static Scanner scanner2 = new Scanner(System.in);\n    private static Scanner scanner3 = new Scanner(System.in);\n\n    private static String double1;\n    private static String symbol;\n    private static String double2;\n\n    private static List&lt;String&gt; firstValues = new ArrayList&lt;&gt;();\n    private static List&lt;String&gt; symbols = new ArrayList&lt;&gt;();\n    private static List&lt;String&gt; secondValues = new ArrayList&lt;&gt;();\n\n\n    public static void main(String[] args) throws InterruptedException, NullPointerException {\n        while(true) {\n            if (scanner1.nextLine().equals(&quot;=&quot;) | scanner2.nextLine().equals(&quot;=&quot;) | scanner3.nextLine().equals(&quot;=&quot;)){\n                System.out.println(firstValues);\n                System.out.println(symbols);\n                System.out.println(secondValues);\n                break;\n            }else {\n\n\n                Thread thread1 = new Thread(() -&gt; AddElementsInLists.addingForFirstList(double1, scanner1, firstValues));\n\n                Thread thread2 = new Thread(() -&gt; AddElementsInLists.addingForSymbolsList1(symbol, scanner2, symbols));\n\n                Thread thread3 = new Thread(() -&gt; AddElementsInLists.addingForSecondList(double2, scanner3, secondValues));\n\n                thread1.start();\n                thread2.start();\n                thread3.start();\n\n                thread1.join();\n                thread2.join();\n                thread3.join();\n            }\n        }\n    } } import java.util.ArrayList; import java.util.List; import java.util.Scanner;\n\npublic class Test {\n    private static Scanner scanner1 = new Scanner(System.in);\n    private static Scanner scanner2 = new Scanner(System.in);\n    private static Scanner scanner3 = new Scanner(System.in);\n\n    private static String double1;\n    private static String symbol;\n    private static String double2;\n\n    private static List&lt;String&gt; firstValues = new ArrayList&lt;&gt;();\n    private static List&lt;String&gt; symbols = new ArrayList&lt;&gt;();\n    private static List&lt;String&gt; secondValues = new ArrayList&lt;&gt;();\n\n\n    public static void main(String[] args) throws InterruptedException, NullPointerException {\n        while(true) {\n            if (scanner1.nextLine().equals(&quot;=&quot;) | scanner2.nextLine().equals(&quot;=&quot;) | &gt;scanner3.nextLine().equals(&quot;=&quot;)){\n                System.out.println(firstValues);\n                System.out.println(symbols);\n                System.out.println(secondValues);\n                break;\n            }else {\n\n\n                Thread thread1 = new Thread(() -&gt; AddElementsInLists.addingForFirstList(double1, scanner1, firstValues));\n\n                Thread thread2 = new Thread(() -&gt; AddElementsInLists.addingForSymbolsList1(symbol, scanner2, symbols));\n\n                Thread thread3 = new Thread(() -&gt; AddElementsInLists.addingForSecondList(double2, scanner3, secondValues));\n\n                thread1.start();\n                thread2.start();\n                thread3.start();\n\n                thread1.join();\n                thread2.join();\n                thread3.join();\n            }\n        }\n    } }  import java.util.ArrayList; import java.util.List; import java.util.Scanner;\n\npublic class Test {\n    private static Scanner scanner1 = new Scanner(System.in);\n    private static Scanner scanner2 = new Scanner(System.in);\n    private static Scanner scanner3 = new Scanner(System.in);\n\n    private static String double1;\n    private static String symbol;\n    private static String double2;\n\n    private static List&lt;String&gt; firstValues = new ArrayList&lt;&gt;();\n    private static List&lt;String&gt; symbols = new ArrayList&lt;&gt;();\n    private static List&lt;String&gt; secondValues = new ArrayList&lt;&gt;();\n\n\n    public static void main(String[] args) throws InterruptedException, NullPointerException {\n        while(true) {\n            if (scanner1.nextLine().equals(&quot;=&quot;) | scanner2.nextLine().equals(&quot;=&quot;) | scanner3.nextLine().equals(&quot;=&quot;)){\n                System.out.println(firstValues);\n                System.out.println(symbols);\n                System.out.println(secondValues);\n                break;\n            }else {\n\n\n                Thread thread1 = new Thread(() -&gt; AddElementsInLists.addingForFirstList(double1, scanner1, firstValues));\n\n                Thread thread2 = new Thread(() -&gt; AddElementsInLists.addingForSymbolsList1(symbol, scanner2, symbols));\n\n                Thread thread3 = new Thread(() -&gt; AddElementsInLists.addingForSecondList(double2, scanner3, secondValues));\n\n                thread1.start();\n                thread2.start();\n                thread3.start();\n\n                thread1.join();\n                thread2.join();\n                thread3.join();\n            }\n        }\n    } }\n</code></pre>\n<p>While writing a console calculator app, I ran into this problem: I cannot use multithreading to write in different threads in different sheets what the user enters.</p>\n<p>The first problem is that according to my condition, the loop should stop when I enter =, but my loop does not stop.</p>\n<p>The second problem is that some of the entered information is simply lost and does not end up in the end sheet.</p>\n<p>I've tried a lot of things, but nothing works, please tell me how to write data in 4 sheets in parallel in an infinite loop in different threads using multithreading, provided that when the user enters = the loop stops???</p>\n",
    "tags" : [ "java", "string", "multithreading", "java.util.scanner", "infinity" ],
    "owner" : {
      "account_id" : 35216779,
      "reputation" : 7,
      "user_id" : 27056544,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/d1a0ba5480c1b3eec0902a4acb494ae2?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Матвей Шавлов",
      "link" : "https://stackoverflow.com/users/27056544/%d0%9c%d0%b0%d1%82%d0%b2%d0%b5%d0%b9-%d0%a8%d0%b0%d0%b2%d0%bb%d0%be%d0%b2"
    },
    "is_answered" : true,
    "view_count" : 59,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1743872488,
    "creation_date" : 1743778065,
    "link" : "https://stackoverflow.com/questions/79555622/how-to-keep-the-value-up-and-organize-the-cycle-correctly",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79555747,
    "question_id" : 79555622,
    "body" : "<p>Problem 1: Multiple Scanner.nextLine() calls</p>\n<p>In this block:</p>\n<pre><code>if (scanner1.nextLine().equals(&quot;=&quot;) | scanner2.nextLine().equals(&quot;=&quot;) | scanner3.nextLine().equa\n</code></pre>\n<p>You're calling .nextLine() three times in the if check. That means you're consuming input before even starting your threads, and potentially skipping user inputs that were meant for the actual logic.</p>\n<p>Problem 2: You're passing variables like double1, symbol to threads, but not using them properly. Strings are immutable and you're not updating shared state in a thread-safe way,  so the values are effectively being lost.</p>\n<p>Problem 3: You're using 3 Scanner instances on the same System.in stream,this is not safe or supported and leads to weird input behavior.</p>\n<p>Below is the updated code.</p>\n<pre><code>import java.util.*;\nimport java.util.concurrent.*;\n\npublic class ParallelInputTagged {\n\n    private static final List&lt;String&gt; firstValues = Collections.synchronizedList(new ArrayList&lt;&gt;());\n    private static final List&lt;String&gt; symbols = Collections.synchronizedList(new ArrayList&lt;&gt;());\n    private static final List&lt;String&gt; secondValues = Collections.synchronizedList(new ArrayList&lt;&gt;());\n\n    private static final BlockingQueue&lt;String&gt; q1 = new LinkedBlockingQueue&lt;&gt;();\n    private static final BlockingQueue&lt;String&gt; qs = new LinkedBlockingQueue&lt;&gt;();\n    private static final BlockingQueue&lt;String&gt; q2 = new LinkedBlockingQueue&lt;&gt;();\n\n    private static volatile boolean running = true;\n\n    public static void main(String[] args) throws InterruptedException {\n        Scanner scanner = new Scanner(System.in);\n\n        // Reader thread: routes inputs to correct queues\n        Thread reader = new Thread(() -&gt; {\n            while (running) {\n                String input = scanner.nextLine();\n                if (input.equals(&quot;=&quot;)) {\n                    running = false;\n                    q1.offer(&quot;STOP&quot;);\n                    qs.offer(&quot;STOP&quot;);\n                    q2.offer(&quot;STOP&quot;);\n                    break;\n                }\n\n                if (input.startsWith(&quot;1:&quot;)) {\n                    q1.offer(input.substring(2));\n                } else if (input.startsWith(&quot;s:&quot;)) {\n                    qs.offer(input.substring(2));\n                } else if (input.startsWith(&quot;2:&quot;)) {\n                    q2.offer(input.substring(2));\n                } else {\n                    System.out.println(&quot;Invalid input. Use 1:&lt;val&gt;, s:&lt;val&gt;, or 2:&lt;val&gt;&quot;);\n                }\n            }\n        });\n\n        // Each worker reads only from its own queue\n        Thread worker1 = new Thread(() -&gt; process(q1, firstValues, &quot;1st&quot;));\n        Thread workerS = new Thread(() -&gt; process(qs, symbols, &quot;Symbol&quot;));\n        Thread worker2 = new Thread(() -&gt; process(q2, secondValues, &quot;2nd&quot;));\n\n        reader.start();\n        worker1.start();\n        workerS.start();\n        worker2.start();\n\n        reader.join();\n        worker1.join();\n        workerS.join();\n        worker2.join();\n\n        System.out.println(&quot;First Values: &quot; + firstValues);\n        System.out.println(&quot;Symbols     : &quot; + symbols);\n        System.out.println(&quot;Second Values: &quot; + secondValues);\n    }\n\n    private static void process(BlockingQueue&lt;String&gt; queue, List&lt;String&gt; list, String name) {\n        while (running || !queue.isEmpty()) {\n            try {\n                String value = queue.poll(100, TimeUnit.MILLISECONDS);\n                if (value == null || value.equals(&quot;STOP&quot;)) continue;\n                list.add(value);\n                System.out.println(&quot;[&quot; + name + &quot;] Added: &quot; + value);\n            } catch (InterruptedException e) {\n                Thread.currentThread().interrupt();\n            }\n        }\n    }\n}\n</code></pre>\n",
    "score" : 2,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 7645025,
      "reputation" : 440,
      "user_id" : 5795975,
      "user_type" : "registered",
      "profile_image" : "https://lh6.googleusercontent.com/-6KwPUS4RnyA/AAAAAAAAAAI/AAAAAAAAC8w/auZqreI45x0/s256-rj/photo.jpg",
      "display_name" : "Vijay",
      "link" : "https://stackoverflow.com/users/5795975/vijay"
    },
    "creation_date" : 1743780744,
    "last_activity_date" : 1743788243,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : {
    "79555747" : [ {
      "comment_id" : 140302403,
      "post_id" : 79555747,
      "body" : "yes, you&#39;rs code is working, thank you so much",
      "score" : 1,
      "owner" : {
        "account_id" : 35216779,
        "reputation" : 7,
        "user_id" : 27056544,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/d1a0ba5480c1b3eec0902a4acb494ae2?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "Матвей Шавлов",
        "link" : "https://stackoverflow.com/users/27056544/%d0%9c%d0%b0%d1%82%d0%b2%d0%b5%d0%b9-%d0%a8%d0%b0%d0%b2%d0%bb%d0%be%d0%b2"
      },
      "creation_date" : 1743858441,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140300488,
      "post_id" : 79555747,
      "body" : "I&#39;ve  tagged the input and used separate queues per sheet, can you check the updated code if it works.",
      "score" : 0,
      "owner" : {
        "account_id" : 7645025,
        "reputation" : 440,
        "user_id" : 5795975,
        "user_type" : "registered",
        "profile_image" : "https://lh6.googleusercontent.com/-6KwPUS4RnyA/AAAAAAAAAAI/AAAAAAAAC8w/auZqreI45x0/s256-rj/photo.jpg",
        "display_name" : "Vijay",
        "link" : "https://stackoverflow.com/users/5795975/vijay"
      },
      "creation_date" : 1743788311,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140300449,
      "post_id" : 79555747,
      "body" : "Thank you very much, your code is working, but the sheets are not always filled out correctly, is there any way to fix this? Thank you again.",
      "score" : 0,
      "owner" : {
        "account_id" : 35216779,
        "reputation" : 7,
        "user_id" : 27056544,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/d1a0ba5480c1b3eec0902a4acb494ae2?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "Матвей Шавлов",
        "link" : "https://stackoverflow.com/users/27056544/%d0%9c%d0%b0%d1%82%d0%b2%d0%b5%d0%b9-%d0%a8%d0%b0%d0%b2%d0%bb%d0%be%d0%b2"
      },
      "creation_date" : 1743787541,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}