{
  "question" : {
    "question_id" : 79794964,
    "title" : "How to access usageMetadata (token usage) from GenerateContentResponse using google-genai Java SDK (v1.23.0) with Gemini 2.5 Flash?",
    "body" : "<p>I use AI only for translating korean into English and arranging my text.</p>\n<p>I'm working with the <a href=\"https://github.com/google/generative-ai-java\" rel=\"nofollow noreferrer\">Google GenAI Java SDK</a> — <code>com.google.genai:google-genai:1.23.0</code> — in a Spring Boot 3 application, running inside a GitHub Codespaces environment.</p>\n<p>I’m calling the Gemini 2.5 Flash model like this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>GenerateContentResponse response = geminiClient.models()\n    .generateContent(modelName, prompt, generationConfig);\n\nString answer = response.text(); // This part works well\n</code></pre>\n<p>Now, I want to <strong>log the token usage information</strong>, such as:</p>\n<ul>\n<li>prompt token count</li>\n<li>candidates token count</li>\n<li>total token count</li>\n</ul>\n<p>I understand this should come from <code>usageMetadata()</code>, but I cannot seem to access the fields correctly.</p>\n<hr />\n<ul>\n<li>I'm using <strong>GitHub Codespaces</strong>, so I can't easily “Ctrl + click” into class definitions to explore available methods.</li>\n<li>I’ve searched the <a href=\"https://github.com/google/generative-ai-java\" rel=\"nofollow noreferrer\">official SDK documentation</a> and Javadocs, but <strong>I couldn’t find any clear documentation</strong> for the <code>GenerateContentResponseUsageMetadata</code> class or its available methods.</li>\n<li>I’ve also searched online (GitHub, Google, Dev forums), and some posts suggest that <code>usageMetadata</code> may not be exposed reliably in some SDK versions or model responses.</li>\n<li>I’ve confirmed that <code>response.toString()</code> does sometimes include <code>usageMetadata</code> as a JSON fragment, e.g.:</li>\n</ul>\n<pre class=\"lang-json prettyprint-override\"><code>&quot;usageMetadata&quot;: {\n  &quot;promptTokenCount&quot;: 30,\n  &quot;candidatesTokenCount&quot;: 65,\n  &quot;totalTokenCount&quot;: 95\n}\n</code></pre>\n<p>So the data exists — I just can’t access it via the Java SDK directly.</p>\n<hr />\n<ol>\n<li><strong>What is the correct way to import and use <code>usageMetadata()</code> in v1.23.0</strong>?</li>\n<li><strong>What are the exact method names</strong> (if any) to retrieve the token counts?</li>\n<li><strong>Is this feature even fully supported in SDK v1.23.0</strong>, or should I parse the raw JSON manually as a workaround?</li>\n</ol>\n<p>Any advice or examples would be much appreciated — especially from anyone who has successfully retrieved token usage in Java using the Gemini 2.5 Flash model.</p>\n<p>Thanks in advance!</p>\n<p>I attempted the following:</p>\n<pre class=\"lang-java prettyprint-override\"><code>import com.google.genai.types.GenerateContentResponseUsageMetadata;\n\n...\n\nGenerateContentResponseUsageMetadata usage = response.usageMetadata().orElse(null);\n\nif (usage != null) {\n    int promptTokens = usage.getPromptTokenCount();  // error\n    int completionTokens = usage.getCandidatesTokenCount();  // error\n    int totalTokens = usage.getTotalTokenCount();  // error\n}\n</code></pre>\n<p>But I keep getting <strong>&quot;cannot find symbol&quot;</strong> errors for all three method calls above, suggesting the methods don’t exist.</p>\n<p>I also tried calling them without <code>get</code>, like <code>usage.promptTokenCount()</code>, but that didn’t work either.</p>\n",
    "tags" : [ "java", "spring-boot", "token", "google-gemini" ],
    "owner" : {
      "account_id" : 44379218,
      "reputation" : 1,
      "user_id" : 31722309,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/3eb839f46d6b390a1d603a8a3f539379?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "user31722309",
      "link" : "https://stackoverflow.com/users/31722309/user31722309"
    },
    "is_answered" : false,
    "view_count" : 72,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1760968375,
    "creation_date" : 1760968375,
    "link" : "https://stackoverflow.com/questions/79794964/how-to-access-usagemetadata-token-usage-from-generatecontentresponse-using-goo",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ ],
  "answer_comments" : { }
}