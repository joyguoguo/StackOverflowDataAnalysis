{
  "question" : {
    "question_id" : 79611479,
    "title" : "trying to get events from icloud calendar using java/com.github.caldav4j",
    "body" : "<p>Using Java, I am trying to use com.github.caldav4j to download events from my iCloud calendar.</p>\n<p>Using caldav4j i am successfully getting the principal_url and got a list of calendars and got the calender URL that i needed..</p>\n<p>But now when I try to retrieve the events from the calendar i am getting a 400</p>\n<p>A lot of articles say the 400 is an auth issue , but i am asssuming since I am using those same creds to get the calendar URL those creds are ok...</p>\n<p>thanks in advance for any help.....</p>\n<p>Trying to retrieve\nI first do</p>\n<pre><code>        ICAL_PROD_ID =  &quot;-//Apple Inc.//iCloud Calendar//EN&quot;;\n\n        //my calendar path is from the property find\n        calendarPath = &quot;/16*******/calendars/ad4****-****-481b-****-7f74****acfb/&quot;\n\n        this.calDAVCollection = new CalDAVCollection(\n            calendarPath,\n            httpHost,\n            methodFactory,\n            ICAL_PROD_ID);\n</code></pre>\n<p>I then do</p>\n<pre><code>            // Create calendar query directly instead of using GenerateQuery\n        CalendarQuery calendarQuery = new CalendarQuery();\n\n        // Create comp filter for VCALENDAR\n        CompFilter calendarCompFilter = new CompFilter(&quot;VCALENDAR&quot;);\n\n        // Create comp filter for VEVENT\n        CompFilter eventCompFilter = new CompFilter(Component.VEVENT);\n\n        // Set time range filter to specified dates\n        DateTime startDateTime = new DateTime(startDate);\n        DateTime endDateTime = new DateTime(endDate);\n        TimeRange timeRange = new TimeRange(startDateTime, endDateTime);\n        eventCompFilter.setTimeRange(timeRange);\n\n        // Add VEVENT filter to VCALENDAR filter\n        calendarCompFilter.addCompFilter(eventCompFilter);\n\n        // Set the comp filter to the query\n        calendarQuery.setCompFilter(calendarCompFilter);\n\n        // Request calendar data\n        CalendarData calendarData = new CalendarData();\n        calendarQuery.setCalendarDataProp(calendarData);\n\n        // Add debugging for query\n        logger.debug(&quot;Executing calendar query for date range: {} to {}&quot;, startDate, endDate);\n\n\n\n        // Execute the request using the collection's method\n        List&lt;Calendar&gt; calendars = calDAVCollection.queryCalendars(httpClient, calendarQuery);\n</code></pre>\n<p>the error i get from calDAVCollection.queryCalendars is</p>\n<pre><code>            com.github.caldav4j.exceptions.CalDAV4JException: Problem executing method\n            at com.github.caldav4j.CalDAVCollection.getCalDAVResources(CalDAVCollection.java:927) ~[caldav4j-1.0.5.jar:?]\n            at com.github.caldav4j.CalDAVCollection.queryCalendars(CalDAVCollection.java:779) ~[caldav4j-1.0.5.jar:?]\n            at com.unitnet.calendar.caldav.service.iCloudCalendarService.getEvents(iCloudCalendarService.java:189) ~[classes/:?]\n            at com.unitnet.calendar.caldav.utils.CalDAVSyncThread.syncCalendar(CalDAVSyncThread.java:90) ~[classes/:?]\n            at com.unitnet.calendar.caldav.utils.CalDAVSyncThread.run(CalDAVSyncThread.java:50) ~[classes/:?]\n        Caused by: org.apache.jackrabbit.webdav.DavException\n            at org.apache.jackrabbit.webdav.client.methods.BaseDavRequest.getResponseBodyAsMultiStatus(BaseDavRequest.java:93) ~[jackrabbit-webdav-2.20.3.jar:?]\n            at com.github.caldav4j.CalDAVCollection.getCalDAVResources(CalDAVCollection.java:905) ~[caldav4j-1.0.5.jar:?]\n            ... 4 more\n        Caused by: java.io.IOException: XML parsing error\n            at org.apache.jackrabbit.webdav.client.methods.BaseDavRequest.getResponseBodyAsDocument(BaseDavRequest.java:73) ~[jackrabbit-webdav-2.20.3.jar:?]\n            at org.apache.jackrabbit.webdav.client.methods.BaseDavRequest.getResponseBodyAsMultiStatus(BaseDavRequest.java:87) ~[jackrabbit-webdav-2.20.3.jar:?]\n            at com.github.caldav4j.CalDAVCollection.getCalDAVResources(CalDAVCollection.java:905) ~[caldav4j-1.0.5.jar:?]\n            ... 4 more\n        Caused by: org.xml.sax.SAXParseException: Premature end of file.\n            at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.createSAXParseException(ErrorHandlerWrapper.java:204) ~[?:?]\n            at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.fatalError(ErrorHandlerWrapper.java:178) ~[?:?]\n            at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(XMLErrorReporter.java:400) ~[?:?]\n            at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(XMLErrorReporter.java:327) ~[?:?]\n            at com.sun.org.apache.xerces.internal.impl.XMLScanner.reportFatalError(XMLScanner.java:1465) ~[?:?]\n            at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl$PrologDriver.next(XMLDocumentScannerImpl.java:1013) ~[?:?]\n            at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:605) ~[?:?]\n            at com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.next(XMLNSDocumentScannerImpl.java:112) ~[?:?]\n            at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:542) ~[?:?]\n            at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:889) ~[?:?]\n            at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:825) ~[?:?]\n            at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:141) ~[?:?]\n            at com.sun.org.apache.xerces.internal.parsers.DOMParser.parse(DOMParser.java:247) ~[?:?]\n            at com.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse(DocumentBuilderImpl.java:342) ~[?:?]\n            at javax.xml.parsers.DocumentBuilder.parse(DocumentBuilder.java:122) ~[?:?]\n            at org.apache.jackrabbit.webdav.xml.DomUtil.parseDocument(DomUtil.java:104) ~[jackrabbit-webdav-2.20.3.jar:?]\n            at org.apache.jackrabbit.webdav.client.methods.BaseDavRequest.getResponseBodyAsDocument(BaseDavRequest.java:69) ~[jackrabbit-webdav-2.20.3.jar:?]\n            at org.apache.jackrabbit.webdav.client.methods.BaseDavRequest.getResponseBodyAsMultiStatus(BaseDavRequest.java:87) ~[jackrabbit-webdav-2.20.3.jar:?]\n            at com.github.caldav4j.CalDAVCollection.getCalDAVResources(CalDAVCollection.java:905) ~[caldav4j-1.0.5.jar:?]\n            \n</code></pre>\n",
    "tags" : [ "java", "icloud", "caldav", "icloud-api" ],
    "owner" : {
      "account_id" : 250579,
      "reputation" : 1917,
      "user_id" : 527387,
      "user_type" : "registered",
      "accept_rate" : 57,
      "profile_image" : "https://i.sstatic.net/C0LBS.png?s=256",
      "display_name" : "randy",
      "link" : "https://stackoverflow.com/users/527387/randy"
    },
    "is_answered" : false,
    "view_count" : 59,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1746657413,
    "creation_date" : 1746657413,
    "link" : "https://stackoverflow.com/questions/79611479/trying-to-get-events-from-icloud-calendar-using-java-com-github-caldav4j",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ ],
  "answer_comments" : { }
}