{
  "question" : {
    "question_id" : 79615506,
    "title" : "Spotless java error: underscore used as an identifier",
    "body" : "<p>I'm rearranging my Gradle build setup and I almost have it working, except for one problem with the Spotless plugin, which is now reporting the error below:</p>\n<pre><code>&gt; Task :spotlessJava FAILED\nStep 'removeUnusedImports' found problem in 'XXX.java':\n37:26: error: '_' used as an identifier\n  (use of '_' as an identifier is forbidden for lambda parameters)\n</code></pre>\n<p>I'm using Gradle 8.13 with my <code>JAVA_HOME</code> pointing to JDK 17, but I'm using the JDK 22 toolchain, so underscores definitely ought to be supported:</p>\n<pre><code>java {\n    toolchain {\n        languageVersion = JavaLanguageVersion.of(22)\n    }\n}\n</code></pre>\n<p>I don't know how to go about troubleshooting this. Does it mean somehow that spotless thinks I'm using Java 17? (Why does spotless even care?)</p>\n",
    "tags" : [ "java", "gradle", "spotless" ],
    "owner" : {
      "account_id" : 294084,
      "reputation" : 1046,
      "user_id" : 597767,
      "user_type" : "registered",
      "accept_rate" : 75,
      "profile_image" : "https://www.gravatar.com/avatar/0e3ddbeb8e6e2493815f1d4a2d979c7c?s=256&d=identicon&r=PG",
      "display_name" : "Doradus",
      "link" : "https://stackoverflow.com/users/597767/doradus"
    },
    "is_answered" : true,
    "view_count" : 104,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1746884887,
    "creation_date" : 1746882870,
    "link" : "https://stackoverflow.com/questions/79615506/spotless-java-error-underscore-used-as-an-identifier",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79615538,
    "question_id" : 79615506,
    "body" : "<p>I've got this working now.</p>\n<p>In an earlier troubleshooting round, I had changed my spotless configuration to include this line, for reasons I don't recall:</p>\n<pre><code>target '**/src/*/java/**/*.java'\n</code></pre>\n<p>This line was not necessary, and removing it made the error disappear.</p>\n<p>I believe what was happening was this:</p>\n<p>The library supports language level 21, but test code is allowed to use newer features of Java from 22 onward, including underscores as identifiers. When I added the above <code>target</code> directive, I was telling spotless to override its usual file discovery rules and instead find all <code>.java</code> files, which I think caused it to assume I was using Java 21 for all of them. When I remove this line, the default discovery rules apply, and so it uses Java 21 rules for library code and newer rules for test code, as desired.</p>\n",
    "score" : 2,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 294084,
      "reputation" : 1046,
      "user_id" : 597767,
      "user_type" : "registered",
      "accept_rate" : 75,
      "profile_image" : "https://www.gravatar.com/avatar/0e3ddbeb8e6e2493815f1d4a2d979c7c?s=256&d=identicon&r=PG",
      "display_name" : "Doradus",
      "link" : "https://stackoverflow.com/users/597767/doradus"
    },
    "creation_date" : 1746884887,
    "last_activity_date" : 1746884887,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : { }
}