{
  "question" : {
    "question_id" : 79550128,
    "title" : "Intermittent &quot;Error parsing HTTP request header&quot; when calling API in Spring Boot 2.7.4",
    "body" : "<p>I'm facing an issue that I can't seem to resolve, as I have difficulty identifying the root cause. I hope to find some help here.</p>\n<p>I have a web service coded in Java Spring Boot version 2.7.4, with a simple GET endpoint as an example:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@GetMapping(&quot;api/datas/options&quot;)\npublic List&lt;Option&gt; getAllOptions(){\n    return pomppdoptRepository.findAll();   \n}\n</code></pre>\n<p>I'm trying to send a request to this endpoint using Postman. Here is my Postman configuration:</p>\n<p>[https://ibb.co/8n3nfdnP][1]</p>\n<p>When I send the request, I do receive a 200 OK response, but when I check my logs, I notice parsing errors.</p>\n<p>Logs:</p>\n<pre class=\"lang-none prettyprint-override\"><code>Received [GET /api/datas/options HTTP/1.1\nAuthorization: Bearer token\nUser-Agent: PostmanRuntime/7.43.3\nAccept: */*\nCache-Control: no-cache\nPostman-Token: 57c14232-ed07-4247-a00a-19cf2eb34d5e\nHost: localhost:8082\nAccept-Encoding: gzip, deflate, br\nConnection: keep-alive\nCookie: JSESSIONID=90155C405D55A5E7968C4617A05BE184\n\n]\n</code></pre>\n<p>Errors:</p>\n<pre class=\"lang-none prettyprint-override\"><code>2025-04-02 10:07:41.383 DEBUG 24432 --- [nio-8082-exec-5] o.apache.coyote.http11.Http11Processor   : Error parsing HTTP request header\n\njava.io.EOFException: null\n    at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.fillReadBuffer(NioEndpoint.java:1340) ~[tomcat-embed-core-9.0.65.jar:9.0.65]\n    at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.read(NioEndpoint.java:1227) ~[tomcat-embed-core-9.0.65.jar:9.0.65]\n    at org.apache.coyote.http11.Http11InputBuffer.fill(Http11InputBuffer.java:805) ~[tomcat-embed-core-9.0.65.jar:9.0.65]\n    at org.apache.coyote.http11.Http11InputBuffer.parseRequestLine(Http11InputBuffer.java:360) ~[tomcat-embed-core-9.0.65.jar:9.0.65]\n    at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:271) ~[tomcat-embed-core-9.0.65.jar:9.0.65]\n    at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) ~[tomcat-embed-core-9.0.65.jar:9.0.65]\n    at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:890) ~[tomcat-embed-core-9.0.65.jar:9.0.65]\n    at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1789) ~[tomcat-embed-core-9.0.65.jar:9.0.65]\n    at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) ~[tomcat-embed-core-9.0.65.jar:9.0.65]\n    at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.65.jar:9.0.65]\n    at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.65.jar:9.0.65]\n    at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.65.jar:9.0.65]\n    at java.base/java.lang.Thread.run(Thread.java:842) ~[na:na]\n</code></pre>\n<pre class=\"lang-none prettyprint-override\"><code>2025-04-02 10:07:41.383 DEBUG 24432 --- [nio-8082-exec-5] o.apache.coyote.http11.Http11Processor   : Error state [CLOSE_CONNECTION_NOW] reported while processing request\n\njava.io.EOFException: null\n    at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.fillReadBuffer(NioEndpoint.java:1340) ~[tomcat-embed-core-9.0.65.jar:9.0.65]\n    at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.read(NioEndpoint.java:1227) ~[tomcat-embed-core-9.0.65.jar:9.0.65]\n    at org.apache.coyote.http11.Http11InputBuffer.fill(Http11InputBuffer.java:805) ~[tomcat-embed-core-9.0.65.jar:9.0.65]\n    at org.apache.coyote.http11.Http11InputBuffer.parseRequestLine(Http11InputBuffer.java:360) ~[tomcat-embed-core-9.0.65.jar:9.0.65]\n    at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:271) ~[tomcat-embed-core-9.0.65.jar:9.0.65]\n    at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) ~[tomcat-embed-core-9.0.65.jar:9.0.65]\n    at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:890) ~[tomcat-embed-core-9.0.65.jar:9.0.65]\n    at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1789) ~[tomcat-embed-core-9.0.65.jar:9.0.65]\n    at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) ~[tomcat-embed-core-9.0.65.jar:9.0.65]\n    at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.65.jar:9.0.65]\n    at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.65.jar:9.0.65]\n    at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.65.jar:9.0.65]\n    at java.base/java.lang.Thread.run(Thread.java:842) ~[na:na]\n</code></pre>\n<p>However, if I immediately resend the request, the error does not appear in the logs. But if I wait for a few minutes and try again, the error comes back.</p>\n<p>I would like to resolve this issue because I believe it is related to another problem I am facing when linking multiple APIs using async/sync calls. When I send multiple simultaneous requests, I encounter the same issue again.</p>\n<p>application.yml</p>\n<pre class=\"lang-yaml prettyprint-override\"><code>logging:\n  level:\n    org.apache.coyote.http11: DEBUG\n    org.springframework.web: DEBUG\n    org.apache.coyote.http11.Http11Processor: DEBUG\n\nserver:\n  tomcat:\n    threads:\n      max: 200\n      min-spare: 10\n    accesslog:\n      enabled: true\n      pattern: &quot;%h %l %u %t \\&quot;%r\\&quot; %s %b&quot;\n    connection-timeout: 60000  # 60 secondes\n    keep-alive-timeout: 60000  # 60 secondes\n  port: 8082\n\nspring:\n  datasource:\n    hikari:\n      connection-test-query: SELECT 1\n      maximum-pool-size: 20\n      minimum-idle: 5\n      idle-timeout: 60000\n      max-lifetime: 1800000\n      connection-timeout: 30000\n  jpa:\n    show-sql: true\n    open-in-view: false\n    properties:\n      hibernate:\n        format_sql: true\n    hibernate:\n      naming:\n        physical-strategy: org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl\n        implicit-strategy: org.hibernate.boot.model.naming.ImplicitNamingStrategyLegacyJpaImpl\n</code></pre>\n<p>Has anyone encountered a similar issue or has an idea on how to resolve this?</p>\n",
    "tags" : [ "java", "spring", "spring-boot", "postman" ],
    "owner" : {
      "account_id" : 27928228,
      "reputation" : 9,
      "user_id" : 21326872,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/b0ad19cb399c4b718d0d0c5ab0f0c12f?s=256&d=identicon&r=PG",
      "display_name" : "Wassupppp",
      "link" : "https://stackoverflow.com/users/21326872/wassupppp"
    },
    "is_answered" : false,
    "view_count" : 791,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1743593009,
    "creation_date" : 1743583412,
    "link" : "https://stackoverflow.com/questions/79550128/intermittent-error-parsing-http-request-header-when-calling-api-in-spring-boot",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79550478,
    "question_id" : 79550128,
    "body" : "<p>The key log entry is <code>Error parsing HTTP request header java.io.EOFException</code>.</p>\n<p>This indicates Tomcat attempted to read a new HTTP request from the connection but hit an EOF - essentially, the client (Postman in this case) closed the connection while Tomcat was expecting more data.</p>\n<p>This can happen when:</p>\n<ul>\n<li><p>A connection is reused after being idle for too long (Postman reuses keep-alive connections).</p>\n</li>\n<li><p>A TCP connection was terminated by the client, firewall, proxy, or NAT router due to timeout.</p>\n</li>\n<li><p>The connection was half-closed or reset, but Tomcat wasn’t aware and tried to parse a new request line.</p>\n</li>\n</ul>\n<p>To validate this is the actual issue, please instruct Postman to not keep alive connections:</p>\n<ul>\n<li><p>Go to <code>Postman Settings &gt; General</code> and toggle off <code>Use Keep-Alive</code></p>\n</li>\n<li><p>Or add a <code>Connection: close</code> header manually in your request</p>\n</li>\n</ul>\n<p>This prevents Postman from keeping sockets open and avoids the issue entirely during testing from Postman.</p>\n",
    "score" : -1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 16043894,
      "reputation" : 913,
      "user_id" : 11579604,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/z1aaG.png?s=256",
      "display_name" : "Patrycja Wegrzynowicz",
      "link" : "https://stackoverflow.com/users/11579604/patrycja-wegrzynowicz"
    },
    "creation_date" : 1743593009,
    "last_activity_date" : 1743593009,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140289664,
    "post_id" : 79550128,
    "body" : "@MarkRotteveel I&#39;ve just upgraded to 2.7.18, but unfortunately this doesn&#39;t solve my problem. However, we can now rule out a version problem.",
    "score" : 0,
    "owner" : {
      "account_id" : 27928228,
      "reputation" : 9,
      "user_id" : 21326872,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/b0ad19cb399c4b718d0d0c5ab0f0c12f?s=256&d=identicon&r=PG",
      "display_name" : "Wassupppp",
      "link" : "https://stackoverflow.com/users/21326872/wassupppp"
    },
    "creation_date" : 1743586133,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140289549,
    "post_id" : 79550128,
    "body" : "Spring Boot 2.7.4 is pretty old (September 2022). The latest publicly available Spring Boot 2.7.x is 2.7.18 (November 2023). I suggest you update to that version to exclude the possibility this is a bug that was fixed a <b>long</b> time ago. Also consider upgrading to Spring Boot 3 (but that would be more involved).",
    "score" : 0,
    "owner" : {
      "account_id" : 213468,
      "reputation" : 110282,
      "user_id" : 466862,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=256&d=identicon&r=PG",
      "display_name" : "Mark Rotteveel",
      "link" : "https://stackoverflow.com/users/466862/mark-rotteveel"
    },
    "creation_date" : 1743584601,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79550478" : [ {
      "comment_id" : 140290325,
      "post_id" : 79550478,
      "body" : "So, I wasn&#39;t able to disable this option in Postman settings, but I modified the header in the Headers section by replacing Connection: keep-alive with Connection: close. Then, I retested by sending multiple requests, and now I get the &quot;parsing HTTP request header&quot; error on every request I send. So, if I send 10 requests, the error message appears 10 times, whereas at first, it only happened on the first request. I don’t understand: if I close the connection, it shouldn&#39;t try to reuse an open connection. Instead, it should open and close a new one for each request, right?",
      "score" : 0,
      "owner" : {
        "account_id" : 27928228,
        "reputation" : 9,
        "user_id" : 21326872,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/b0ad19cb399c4b718d0d0c5ab0f0c12f?s=256&d=identicon&r=PG",
        "display_name" : "Wassupppp",
        "link" : "https://stackoverflow.com/users/21326872/wassupppp"
      },
      "creation_date" : 1743595753,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}