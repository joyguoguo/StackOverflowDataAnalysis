{
  "question" : {
    "question_id" : 79842376,
    "title" : "Httpclient in java send a POST request",
    "body" : "<p>I want to make an API caller with all CRUD methods using java<br />\nI want to be able to get all the data with json then parse it and only get data with it's unique id</p>\n<p>The thing that I can't figure out is how do I send data using an API. I get that I can use an id but what if I need to modify not one but 2 or more fields how do I do it then while Parsing a json?</p>\n<p>So I have implemented the GET method but I can't think of how to implement the POST one</p>\n<p>Here is the code from my methods class where I have all the methods</p>\n<p>I'm using Jackson to parse json and Java's Httpclient</p>\n<pre><code>import com.fasterxml.jackson.core.type.TypeReference;\nimport com.fasterxml.jackson.databind.ObjectMapper;\nimport com.fasterxml.jackson.databind.annotation.JsonPOJOBuilder;\n\nimport java.io.IOException;\nimport java.net.URI;\nimport java.net.http.HttpClient;\nimport java.net.http.HttpRequest;\nimport java.net.http.HttpResponse;\nimport java.time.Duration;\nimport java.util.Collections;\nimport java.util.List;\nimport java.util.Map;\n\npublic class methods extends link{\n\n    private final ObjectMapper mapper = new ObjectMapper();\n    private final String url = &quot;https://jsonplaceholder.typicode.com/todos&quot;;\n\n\n    public List&lt;dataGettingBack&gt; getAllMethod() throws IOException, InterruptedException {\n\n\n        HttpClient httpClientGet = HttpClient.newBuilder().connectTimeout(Duration.ofSeconds(10)).build();\n        HttpRequest httpGetReq = HttpRequest\n                .newBuilder(URI.create(url))\n                .header(&quot;Content-Type&quot;, &quot;application/json&quot;)\n                .GET()\n                .build();\n\n        HttpResponse&lt;String&gt; res = httpClientGet.send(httpGetReq, HttpResponse.BodyHandlers.ofString());\n        return mapper.readValue(res.body(), new TypeReference&lt;List&lt;dataGettingBack&gt;&gt;(){});\n    }\n\n    public List&lt;dataGettingBack&gt; getOne(int id) throws IOException, InterruptedException, error {\n        HttpClient httpGetOne = HttpClient.newBuilder().connectTimeout(Duration.ofSeconds(10)).build();\n        HttpRequest httpOne = HttpRequest\n                .newBuilder(URI.create(url + &quot;/&quot;+ id))\n                .header(&quot;Content-Type&quot;,&quot;application/json&quot;)\n                .GET()\n                .build();\n\n        HttpResponse&lt;String&gt; responce = httpGetOne.send(httpOne, HttpResponse.BodyHandlers.ofString());\n\n        if (responce.statusCode() == 404) { throw new error(&quot;Not found &quot;+ responce.statusCode()); }\n\n\n        return Collections.singletonList(mapper.readValue(responce.body(), dataGettingBack.class));\n    }\n\n    public void putMethod(int id) throws IOException, InterruptedException, error\n    {\n        HttpClient httpClientPut = HttpClient.newBuilder().connectTimeout(Duration.ofSeconds(10)).build();\n        HttpRequest httpPutReq = HttpRequest\n                .newBuilder(URI.create(url+ &quot;/&quot; +id))\n                .PUT(HttpRequest.BodyPublishers.ofString(url))\n                .header(&quot;Content-Type&quot;, &quot;application/json&quot;)\n                .build();\n\n        HttpResponse&lt;String&gt; response = httpClientPut.send(httpPutReq, HttpResponse.BodyHandlers.ofString());\n\n        \n    }\n\n    public void postMethod() {\n\n        HttpClient httpClientPost = HttpClient.newBuilder().connectTimeout(Duration.ofSeconds(10)).build();\n        HttpRequest httpPostReq = HttpRequest\n                .newBuilder(URI.create(url))\n                //.POST()\n                .header(&quot;Content-Type&quot;, &quot;application/json&quot;)\n                .build();\n\n\n    }\n\n\n\n    public void deleteMethod(int id)\n    {\n\n        HttpClient httpClientDelete = HttpClient.newBuilder().connectTimeout(Duration.ofSeconds(10)).build();\n        HttpRequest httpDelReq = HttpRequest\n                .newBuilder(URI.create(url))\n                .DELETE()\n                .header(&quot;Content-Type&quot;, &quot;application/json&quot;)\n                .build();\n\n\n    }\n\n}\n</code></pre>\n<p>Here is how I get my data back</p>\n<pre><code>public record dataGettingBack(Integer userId, Integer id, String title, boolean completed) {}\n</code></pre>\n<p>That's the output when I run it all</p>\n<pre><code>[dataGettingBack[userId=1, id=10, title=illo est ratione doloremque quia maiores aut, completed=true]]\n</code></pre>\n<p>I also have an error class</p>\n<pre><code>public class error extends Throwable\n{ public error(String massege) { super(massege); } }\n</code></pre>\n<p>as well as link class</p>\n<pre><code>abstract class link\n{\n    public String url;\n}\n</code></pre>\n<p>That's what I have in main</p>\n<pre><code>public static void main(String[] args) throws Exception, error\n{\n    methods methods  = new methods();\n\n    List&lt;dataGettingBack&gt; getAll = methods.getAllMethod();\n    List&lt;dataGettingBack&gt; one = methods.getOne(10);\n\n    System.out.println(one);\n}\n</code></pre>\n<p>I started my programming classes a few months ago and that's my first project on my own</p>\n",
    "tags" : [ "java", "rest", "post" ],
    "owner" : {
      "account_id" : 19699166,
      "reputation" : 1,
      "user_id" : 14422362,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a-/AOh14GhMI5hMVs1TAvtGeZIUIcaASpcFBQpjVn9vMmfElQ=k-s256",
      "display_name" : "Dmitry Fedorov",
      "link" : "https://stackoverflow.com/users/14422362/dmitry-fedorov"
    },
    "is_answered" : true,
    "view_count" : 57,
    "answer_count" : 2,
    "score" : -1,
    "last_activity_date" : 1765375152,
    "creation_date" : 1765315797,
    "link" : "https://stackoverflow.com/questions/79842376/httpclient-in-java-send-a-post-request",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79842417,
    "question_id" : 79842376,
    "body" : "<p>You can implement the POST request like below:</p>\n<pre><code>    import java.net.URI;\n    import java.net.http.HttpRequest;\n    import java.net.http.HttpRequest.BodyPublishers;\n\n    String requestBody = &quot;{\\&quot;key\\&quot;:\\&quot;value\\&quot;}&quot;; // Example JSON body\n    HttpRequest request = HttpRequest.newBuilder()\n            .uri(URI.create(url))\n            .header(&quot;Content-Type&quot;, &quot;application/json&quot;) // Set appropriate Content-Type\n            .POST(BodyPublishers.ofString(requestBody)) // Specify POST method and body\n            .build();\n</code></pre>\n",
    "score" : 2,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 7035715,
      "reputation" : 75,
      "user_id" : 5390970,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/809ow.png?s=256",
      "display_name" : "Roy Yin",
      "link" : "https://stackoverflow.com/users/5390970/roy-yin"
    },
    "creation_date" : 1765319301,
    "last_activity_date" : 1765319301,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79843032,
    "question_id" : 79842376,
    "body" : "<p>I used gson library to convert the data to json when sending it</p>\n<pre><code>public String putMethod(int id) throws IOException, InterruptedException, error\n{\n    HttpClient httpClientPut = HttpClient.newBuilder().connectTimeout(Duration.ofSeconds(10)).build();\n    HttpRequest httpPutReq = HttpRequest\n            .newBuilder(URI.create(url+ &quot;/&quot; +id))\n            .PUT(HttpRequest.BodyPublishers.ofString(&quot;&quot;))\n            .header(&quot;Content-Type&quot;, &quot;application/json&quot;)\n            .build();\n\n    HttpResponse&lt;String&gt; response = httpClientPut.send(httpPutReq, HttpResponse.BodyHandlers.ofString());\n    dataGettingBack body = new dataGettingBack(3, 1,&quot;test-test&quot;,true);\n\n    return gson.toJson(body);\n}\n</code></pre>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 19699166,
      "reputation" : 1,
      "user_id" : 14422362,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a-/AOh14GhMI5hMVs1TAvtGeZIUIcaASpcFBQpjVn9vMmfElQ=k-s256",
      "display_name" : "Dmitry Fedorov",
      "link" : "https://stackoverflow.com/users/14422362/dmitry-fedorov"
    },
    "creation_date" : 1765375152,
    "last_activity_date" : 1765375152,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140896352,
    "post_id" : 79842376,
    "body" : "I&#39;m glad you got it sorted out but for goodness&#39; sake, you need to get your <a href=\"https://technojeeves.com/index.php/aliasjava1/106-java-style-conventions\" rel=\"nofollow noreferrer\">naming</a> right or your code is difficult and unpleasant to read",
    "score" : 1,
    "owner" : {
      "account_id" : 22124137,
      "reputation" : 4244,
      "user_id" : 16376827,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/1ImPw.png?s=256",
      "display_name" : "g00se",
      "link" : "https://stackoverflow.com/users/16376827/g00se"
    },
    "creation_date" : 1765376993,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140895646,
    "post_id" : 79842376,
    "body" : "Is your problem on the client side or the server side? Have you created the server as well? Which specific part of your code is wrong?",
    "score" : 0,
    "owner" : {
      "account_id" : 8532578,
      "reputation" : 49884,
      "user_id" : 6395627,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/af0f9bfe593f36642a032cd7ea611e7d?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Slaw",
      "link" : "https://stackoverflow.com/users/6395627/slaw"
    },
    "creation_date" : 1765352921,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140895251,
    "post_id" : 79842376,
    "body" : "You don&#39;t have to &#39;think&#39; it: you have to consult the documentation.",
    "score" : 0,
    "owner" : {
      "account_id" : 71739,
      "reputation" : 311870,
      "user_id" : 207421,
      "user_type" : "registered",
      "accept_rate" : 82,
      "profile_image" : "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=256&d=identicon&r=PG",
      "display_name" : "user207421",
      "link" : "https://stackoverflow.com/users/207421/user207421"
    },
    "creation_date" : 1765322051,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79842417" : [ {
      "comment_id" : 140896291,
      "post_id" : 79842417,
      "body" : "Thanks, a couple more guides and I have done what I wanted to do            dataGettingBack body = new dataGettingBack(3, 1,&quot;test-test&quot;,true);          return gson.toJson(body);",
      "score" : 2,
      "owner" : {
        "account_id" : 19699166,
        "reputation" : 1,
        "user_id" : 14422362,
        "user_type" : "registered",
        "profile_image" : "https://lh3.googleusercontent.com/a-/AOh14GhMI5hMVs1TAvtGeZIUIcaASpcFBQpjVn9vMmfElQ=k-s256",
        "display_name" : "Dmitry Fedorov",
        "link" : "https://stackoverflow.com/users/14422362/dmitry-fedorov"
      },
      "creation_date" : 1765375037,
      "content_license" : "CC BY-SA 4.0"
    } ],
    "79843032" : [ {
      "comment_id" : 140896920,
      "post_id" : 79843032,
      "body" : "@VGR Thanks I didn&#39;t notice that at first when it started working   I used Jackson this time and it worked as well    String jsonBody = mapper.writeValueAsString(body);  .PUT(HttpRequest.BodyPublishers.ofString(jsonBody))",
      "score" : 0,
      "owner" : {
        "account_id" : 19699166,
        "reputation" : 1,
        "user_id" : 14422362,
        "user_type" : "registered",
        "profile_image" : "https://lh3.googleusercontent.com/a-/AOh14GhMI5hMVs1TAvtGeZIUIcaASpcFBQpjVn9vMmfElQ=k-s256",
        "display_name" : "Dmitry Fedorov",
        "link" : "https://stackoverflow.com/users/14422362/dmitry-fedorov"
      },
      "creation_date" : 1765395543,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140896375,
      "post_id" : 79843032,
      "body" : "I very much doubt <code>HttpRequest.BodyPublishers.ofString(&quot;&quot;)</code> addresses the question.  There probably is an object that needs to be serialized using Jackson.",
      "score" : 2,
      "owner" : {
        "account_id" : 2053598,
        "reputation" : 44971,
        "user_id" : 1831987,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/38b1c37530189ec4471a43a618e33f67?s=256&d=identicon&r=PG",
        "display_name" : "VGR",
        "link" : "https://stackoverflow.com/users/1831987/vgr"
      },
      "creation_date" : 1765377457,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}