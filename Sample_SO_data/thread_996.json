{
  "question" : {
    "question_id" : 79753631,
    "title" : "Hikari Pool Size stuck on default",
    "body" : "<p>I have to increase the DB connection pool limit for my DB (Aurora) and I want to set my maximumPoolSize for Hikari to be higher than the default value (default = 10) but the maximumPoolSize still does not get set in a deployed environment. It seems like it works locally but not in higher environments. Code:</p>\n<pre><code>@Slf4j\npublic class IAMAuthDataSource extends HikariDataSource {\n\n @Override\n public String getPassword() {\n    String configpwd = super.getPassword();\n    if (configpwd != null &amp;&amp; !configpwd.trim().isEmpty()) {\n        return configpwd;\n    }\n        return getToken();\n    }\n\n private String getToken() {\n    URI datasourceUri = URI.create(getJdbcUrl().substring(5));\n    Region region = new DefaultAwsRegionProviderChain().getRegion();\n    \n    RdsUtilities generator = RdsUtilities.builder()\n    .credentialsProvider(WebIdentityTokenFileCredentialsProvider.create())\n    .region(region)\n    .build();\n    \n    GenerateAuthenticationTokenRequest request = GenerateAuthenticationTokenRequest.builder()\n    .hostname(datasourceUri.getHost())\n    .port(datasourceUri.getPort())\n    .username(getUsername())\n    .region(region)\n    .build();\n    \n    return generator.generateAuthenticationToken(request);\n    }\n\n @Primary\n @Bean\n public DataSource dataSource() {\n    HikariDataSource ds = new IAMAuthDataSource();\n    ds.setMaximumPoolSize(30);\n    ds.setPoolName(&quot;newDBPool&quot;);\n    log.debug(&quot;Pool name configured: {}&quot;, ds.getPoolName());\n    return ds;\n }\n}\n</code></pre>\n<p>Even if I set a new pool with custom name and pool size here and set it as primary, it doesn't take effect. It's set locally but not when deployed. When deployed, it still refers to HikariPool-1.</p>\n<p>I also made sure that the same properties are set in my application properties for all envs where set these props:</p>\n<p><code>spring.datasource.hikari.maximumPoolSize=30 spring.datasource.hikari.maxLifetime=1200000</code></p>\n<p>I'm using Spring Boot 2.5.</p>\n",
    "tags" : [ "java", "spring-boot", "hikaricp" ],
    "owner" : {
      "account_id" : 6552564,
      "reputation" : 7,
      "user_id" : 5066442,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/2c011a5788fab9798d42d848d9d371e5?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Foobar",
      "link" : "https://stackoverflow.com/users/5066442/foobar"
    },
    "is_answered" : false,
    "view_count" : 97,
    "answer_count" : 1,
    "score" : -3,
    "last_activity_date" : 1756888501,
    "creation_date" : 1756824493,
    "link" : "https://stackoverflow.com/questions/79753631/hikari-pool-size-stuck-on-default",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79754334,
    "question_id" : 79753631,
    "body" : "<p>You have to inject datasource property to be able to read other properties</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Bean\n@ConfigurationProperties(prefix = &quot;spring.datasource.hikari&quot;)\npublic DataSource dataSource(DataSourceProperties dataSourceProperties) {\n    return dataSourceProperties.initializeDataSourceBuilder().build();\n}\n</code></pre>\n<p>The method <code>initializeDataSourceBuilder</code> takes datasource class name where you will put reference to <code>IAMAuthDataSource</code></p>\n<hr />\n<p>Or you can just simply pass your class name as type <a href=\"https://docs.spring.io/spring-boot/api/java/org/springframework/boot/autoconfigure/jdbc/DataSourceProperties.html#setType(java.lang.Class)\" rel=\"nofollow noreferrer\">See the doc</a> in application.yaml file with</p>\n<pre class=\"lang-yaml prettyprint-override\"><code>spring:\n  datasource:\n    type: com.your.package.IAMAuthDataSource\n    hikari:\n      minimum-idle: 5\n      maximum-pool-size: 20\n      connection-timeout: 20000\n      ...\n</code></pre>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 10673275,
      "reputation" : 1418,
      "user_id" : 7857701,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/oLY4i.jpg?s=256",
      "display_name" : "SnigJi",
      "link" : "https://stackoverflow.com/users/7857701/snigji"
    },
    "creation_date" : 1756888501,
    "last_activity_date" : 1756888501,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140710987,
    "post_id" : 79753631,
    "body" : "@Foobar Read <a href=\"https://docs.spring.io/spring-boot/how-to/data-access.html#howto.data-access.configure-custom-datasource\" rel=\"nofollow noreferrer\">Configure a Custom DataSource</a>, and specifically note its use of <code>@Configuration</code> and <code>@ConfigurationProperties</code>.",
    "score" : 0,
    "owner" : {
      "account_id" : 213468,
      "reputation" : 110282,
      "user_id" : 466862,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=256&d=identicon&r=PG",
      "display_name" : "Mark Rotteveel",
      "link" : "https://stackoverflow.com/users/466862/mark-rotteveel"
    },
    "creation_date" : 1756883593,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140710977,
    "post_id" : 79753631,
    "body" : "@life888888 Both will work, see <a href=\"https://docs.spring.io/spring-boot/reference/features/external-config.html#features.external-config.typesafe-configuration-properties.relaxed-binding\" rel=\"nofollow noreferrer\">Relaxed Binding</a>",
    "score" : 0,
    "owner" : {
      "account_id" : 213468,
      "reputation" : 110282,
      "user_id" : 466862,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=256&d=identicon&r=PG",
      "display_name" : "Mark Rotteveel",
      "link" : "https://stackoverflow.com/users/466862/mark-rotteveel"
    },
    "creation_date" : 1756883375,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140710843,
    "post_id" : 79753631,
    "body" : "<a href=\"https://docs.spring.io/spring-boot/appendix/application-properties/index.html\" rel=\"nofollow noreferrer\">docs.spring.io/spring-boot/appendix/application-properties/&hellip;</a> , <code>spring.datasource.hikari.maximum-pool-size</code> , <b>maximum-pool-size</b> not <b>maximumPoolSize</b>",
    "score" : 0,
    "owner" : {
      "account_id" : 26698569,
      "reputation" : 4070,
      "user_id" : 20306007,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/98bbc403493aee3681b71dae7abef66e?s=256&d=identicon&r=PG",
      "display_name" : "life888888",
      "link" : "https://stackoverflow.com/users/20306007/life888888"
    },
    "creation_date" : 1756877367,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140710245,
    "post_id" : 79753631,
    "body" : "How do I make sure it uses the properties?",
    "score" : 0,
    "owner" : {
      "account_id" : 6552564,
      "reputation" : 7,
      "user_id" : 5066442,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/2c011a5788fab9798d42d848d9d371e5?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Foobar",
      "link" : "https://stackoverflow.com/users/5066442/foobar"
    },
    "creation_date" : 1756843250,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140709865,
    "post_id" : 79753631,
    "body" : "The way you&#39;re configuring the data source does not use the properties.",
    "score" : 0,
    "owner" : {
      "account_id" : 213468,
      "reputation" : 110282,
      "user_id" : 466862,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=256&d=identicon&r=PG",
      "display_name" : "Mark Rotteveel",
      "link" : "https://stackoverflow.com/users/466862/mark-rotteveel"
    },
    "creation_date" : 1756832054,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79754334" : [ {
      "comment_id" : 140762994,
      "post_id" : 79754334,
      "body" : "I have been passing class name as type without specifying config property but still running into same error",
      "score" : 0,
      "owner" : {
        "account_id" : 6552564,
        "reputation" : 7,
        "user_id" : 5066442,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/2c011a5788fab9798d42d848d9d371e5?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "Foobar",
        "link" : "https://stackoverflow.com/users/5066442/foobar"
      },
      "creation_date" : 1758933686,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}