{
  "question" : {
    "question_id" : 79808779,
    "title" : "Change default success URL in Spring Security using Vaadin 24",
    "body" : "<p>Has anyone been able to change the default success URL after login in Vaadin 24, where we are supposed to handle the filter as follows:</p>\n<pre><code>public SecurityFilterChain securityFilterChain(@NonNull HttpSecurity http) throws Exception {\n        return http.with(VaadinSecurityConfigurer.vaadin(),\n                        configurer -&gt; configurer.loginView(LoginView.class))\n                .authenticationProvider(authenticationProvider)\n                .build();\n    }\n</code></pre>\n<p>I tried adding .formLogin() after .with also after .authenticationProvider, but no result. It still redirects to /.</p>\n<p>I would be happy for any solution, including hacking the RequestCache if needed. But even Google AI mode could not help with this one. It eventually suggested that I use a different version of Vaadin (facepalm).</p>\n<p>PS: Extension of VaadinWebSecurity is deprecated since 24.9 and slated for deletion, which is why I am going with this &quot;new&quot; approach from the documentation.</p>\n<p><em>Today I tried this, but it did not work, maybe I have a problem with the approach?</em></p>\n<pre><code>http.with(VaadinSecurityConfigurer.vaadin(),\n                        configurer -&gt; configurer.loginView(LoginView.class)\n                                .withObjectPostProcessor(new ObjectPostProcessor&lt;FormLoginConfigurer&lt;HttpSecurity&gt;&gt;() {\n                                    @Override\n                                    public &lt;O extends FormLoginConfigurer&lt;HttpSecurity&gt;&gt; O postProcess(O object) {\n                                        return (O) object.defaultSuccessUrl(&quot;/my-success-path&quot;);\n                                    }\n                                }))\n</code></pre>\n",
    "tags" : [ "java", "spring", "spring-security", "vaadin-flow", "java-21" ],
    "owner" : {
      "account_id" : 18944447,
      "reputation" : 105,
      "user_id" : 13823700,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a-/AOh14GgtEA0BwTNM3NAUoElSgnw09281BGl203f3McYuew=k-s256",
      "display_name" : "Jennifer",
      "link" : "https://stackoverflow.com/users/13823700/jennifer"
    },
    "is_answered" : true,
    "view_count" : 97,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1763033665,
    "creation_date" : 1762251155,
    "link" : "https://stackoverflow.com/questions/79808779/change-default-success-url-in-spring-security-using-vaadin-24",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79815291,
    "question_id" : 79808779,
    "body" : "<p>With the <code>VaadinAwareSecurityContextHolderStrategyConfiguration</code> configuration, you would need to provide an instance of <code>VaadinSavedRequestAwareAuthenticationSuccessHandler</code> as a shared object.</p>\n<pre class=\"lang-java prettyprint-override\"><code>import com.vaadin.flow.spring.security.VaadinSavedRequestAwareAuthenticationSuccessHandler;\n//...\n\n@Bean\npublic SecurityFilterChain vaadinSecurityFilterChain(HttpSecurity http) throws Exception {\n    //...\n    http.setSharedObject(VaadinSavedRequestAwareAuthenticationSuccessHandler.class, createSuccessHandler());\n\n    http.with(vaadin(), vaadin -&gt; {\n        vaadin.loginView(LoginView.class);\n    });\n\n    return http.build();\n}\n\n\npublic VaadinSavedRequestAwareAuthenticationSuccessHandler createSuccessHandler() {\n    var successHandler = new VaadinSavedRequestAwareAuthenticationSuccessHandler();\n    successHandler.setDefaultTargetUrl(&quot;/myview&quot;);\n    successHandler.setAlwaysUseDefaultTargetUrl(true);\n    return successHandler;\n}\n</code></pre>\n<p>It's possible in your <code>LoginView</code> you already have a redirect to <code>&quot;&quot;</code> if user is already logged in, so you would also need to change the URL there, for consistency.</p>\n<pre><code>@Override\npublic void beforeEnter(BeforeEnterEvent event) {\n    if (authenticatedUser.get().isPresent()) {\n        // Already logged in\n        setOpened(false);\n        event.forwardTo(&quot;/myview&quot;);\n    }\n    setError(event.getLocation().getQueryParameters().getParameters().containsKey(&quot;error&quot;));\n}\n</code></pre>\n",
    "score" : 1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 4308659,
      "reputation" : 194,
      "user_id" : 4461115,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/D18Of.png?s=256",
      "display_name" : "Herberts Markūns",
      "link" : "https://stackoverflow.com/users/4461115/herberts-mark%c5%abns"
    },
    "creation_date" : 1762758957,
    "last_activity_date" : 1763033665,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140836005,
    "post_id" : 79808779,
    "body" : "Yes, among hundreds of similar. But the extension of VaadinWebSecurity is deprecated and slated for deletion. Which is why you see the with(VaadinSecurityConfigurer) in my question above.",
    "score" : 0,
    "owner" : {
      "account_id" : 18944447,
      "reputation" : 105,
      "user_id" : 13823700,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a-/AOh14GgtEA0BwTNM3NAUoElSgnw09281BGl203f3McYuew=k-s256",
      "display_name" : "Jennifer",
      "link" : "https://stackoverflow.com/users/13823700/jennifer"
    },
    "creation_date" : 1762270199,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140835534,
    "post_id" : 79808779,
    "body" : "Have you checked this hint: <a href=\"https://stackoverflow.com/a/78657751/8962195\">stackoverflow.com/a/78657751/8962195</a>",
    "score" : 0,
    "owner" : {
      "account_id" : 12280349,
      "reputation" : 10658,
      "user_id" : 8962195,
      "user_type" : "registered",
      "profile_image" : "https://lh6.googleusercontent.com/-ChBQjQ88R30/AAAAAAAAAAI/AAAAAAAACI0/3U1w_xL02pg/s256-rj/photo.jpg",
      "display_name" : "Tatu Lund",
      "link" : "https://stackoverflow.com/users/8962195/tatu-lund"
    },
    "creation_date" : 1762255865,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79815291" : [ {
      "comment_id" : 140869777,
      "post_id" : 79815291,
      "body" : "Nothing new should be added to the main page. the <code>beforeEnter</code> changed mentioned in my answer, is supposed to go only in <code>LoginView</code> (if it has a redirect there already).  The important part is modifications you need to make to the security configuration <code>vaadinSecurityFilterChain</code>, or in your case <code>securityFilterChain</code>.",
      "score" : 0,
      "owner" : {
        "account_id" : 4308659,
        "reputation" : 194,
        "user_id" : 4461115,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/D18Of.png?s=256",
        "display_name" : "Herberts Markūns",
        "link" : "https://stackoverflow.com/users/4461115/herberts-mark%c5%abns"
      },
      "creation_date" : 1763971921,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140867669,
      "post_id" : 79815291,
      "body" : "Thank you, Herberts Markūns, are you suggesting that I add this to the beforeEnter of the main page? Because beforeEnter on the login view is executed only on login, after which the main page is used. In this case I would need to be able to determine that this is an automatic redirection after login, rather than a deliberate visit to the main page.",
      "score" : 0,
      "owner" : {
        "account_id" : 18944447,
        "reputation" : 105,
        "user_id" : 13823700,
        "user_type" : "registered",
        "profile_image" : "https://lh3.googleusercontent.com/a-/AOh14GgtEA0BwTNM3NAUoElSgnw09281BGl203f3McYuew=k-s256",
        "display_name" : "Jennifer",
        "link" : "https://stackoverflow.com/users/13823700/jennifer"
      },
      "creation_date" : 1763813556,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140852246,
      "post_id" : 79815291,
      "body" : "@Jennifer You are correct, sorry for incomplete solution. It seemed to work as intended when I first tested it, but when re-testing it, it worked as you described.   I have updated my answer with a proper solution this time, please have a look.",
      "score" : 0,
      "owner" : {
        "account_id" : 4308659,
        "reputation" : 194,
        "user_id" : 4461115,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/D18Of.png?s=256",
        "display_name" : "Herberts Markūns",
        "link" : "https://stackoverflow.com/users/4461115/herberts-mark%c5%abns"
      },
      "creation_date" : 1763033767,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140850507,
      "post_id" : 79815291,
      "body" : "Thank you, Herberts Markūns, I am already doing that for authenticated users that try to visit the login page. But what about the redirect after successful login? That is what I need, so that the user goes not to the main page, but there. But I do not want to make a BeforeEnterEvent redirect from the main page, unless there were a way to understand that the user just came there from a successful login and not from some other source.",
      "score" : 0,
      "owner" : {
        "account_id" : 18944447,
        "reputation" : 105,
        "user_id" : 13823700,
        "user_type" : "registered",
        "profile_image" : "https://lh3.googleusercontent.com/a-/AOh14GgtEA0BwTNM3NAUoElSgnw09281BGl203f3McYuew=k-s256",
        "display_name" : "Jennifer",
        "link" : "https://stackoverflow.com/users/13823700/jennifer"
      },
      "creation_date" : 1762955534,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}