{
  "question" : {
    "question_id" : 79613259,
    "title" : "Use Spring with @Scheduled to run same method with multiple configurations and instances",
    "body" : "<p>Consider I have a program which should run a scheduled job from the same method but for different configurations and instances.</p>\n<p>I want method <code>task</code> run multiple job instances in different configurations, for example:</p>\n<ul>\n<li>a) job 1, run every 2 minutes with parameter X = 10</li>\n<li>d) job 2, run every 3 minutes with parameter X = 20</li>\n<li>c) job 3, run every 5 minutes with parameter X = 30</li>\n<li>d) job 5, disabled</li>\n</ul>\n<p>At least I want to provide the configuration via application.yml to make it dynamic.</p>\n<pre><code>@Scheduled(...)\npublic void task(MyJobParameters params) {\n    String x = params.getX();\n    // do something with &quot;x&quot;\n}\n</code></pre>\n<p>I want to avoid doing this:</p>\n<pre><code>@Scheduled(fixedRateString=&quot;120000&quot;)\npublic void taskA() {\n    String x = &quot;10&quot;;\n    //do something for A\n}\n\n@Scheduled(fixedRateString=&quot;180000&quot;)\npublic void taskB() {\n    String x = &quot;20&quot;;\n    //do something for B\n}\n\n@Scheduled(fixedRateString=&quot;300000&quot;)\npublic void taskC() {\n    String x = &quot;30&quot;;\n    //do something for C\n}\n\n@Scheduled(fixedRateString=&quot;300000&quot;)\npublic void taskD() {\n    String x = &quot;30&quot;;\n    //do something for D\n}\n</code></pre>\n<p>Should I use something different other than @Scheduled?</p>\n",
    "tags" : [ "java", "spring" ],
    "owner" : {
      "account_id" : 1060789,
      "reputation" : 420,
      "user_id" : 1062463,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/H3XSU.jpg?s=256",
      "display_name" : "danieldestro",
      "link" : "https://stackoverflow.com/users/1062463/danieldestro"
    },
    "is_answered" : true,
    "view_count" : 83,
    "answer_count" : 2,
    "score" : 2,
    "last_activity_date" : 1746795977,
    "creation_date" : 1746743905,
    "link" : "https://stackoverflow.com/questions/79613259/use-spring-with-scheduled-to-run-same-method-with-multiple-configurations-and-i",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79613381,
    "question_id" : 79613259,
    "body" : "<p>You could consider using Spring @ConfigurationProperties. First you create a DTO: i.e. TaskDTO with fields for x and rate, maybe an extra field to distinguish A/B/C/D(?).</p>\n<p><code>public record TaskDTO(String x, String rate) {}</code></p>\n<p>Then you can define your application.properties for each task with the same prefix, so you can have spring ConfigurationProperties read it into a list.</p>\n<p>application.properties</p>\n<pre><code>task.list[0].x=10\ntask.list[0].rate=120000\n</code></pre>\n<pre><code>@Slf4j\n@Configuration\n@ConfigurationProperties(prefix = &quot;task&quot;)\npublic class TaskDTOInit {\n    private final List&lt;TaskDTO&gt; list = new ArrayList&lt;&gt;();\n\n    public List&lt;TaskDTO&gt; getList() {\n        return list;\n    }\n}\n</code></pre>\n<p>Then you can access the List of your task definitions, and you can create a method to just use a ScheduledExecutorService to schedule your task. Though, you would need to pass the DTO into the scope of the Runnable (<a href=\"https://www.baeldung.com/java-thread-parameters\" rel=\"nofollow noreferrer\">https://www.baeldung.com/java-thread-parameters</a>). This is only the case, if the code is the same for each method, but only the configurations differ. Else, you can set up the methods for each configuration, and in the runnable use some sort of if-else to check.</p>\n<pre class=\"lang-java prettyprint-override\"><code>@PostConstruct\npublic void scheduleTasks(List&lt;TaskDTO&gt; tasks) {\n    for (var dto : tasks) {\n        //sample runnable for submitting\n        scheduler.scheduleAtFixedRate(() -&gt; {\n            var x = dto.x()\n            var task = dto.task()\n        \n            if (task.equals(&quot;A&quot;)) {\n                doA(x) //sample to implement\n            } //etc\n        }, 0, dto.rate(), TimeUnit.MILLISECONDS); //o is delay for starting task\n    }\n}\n</code></pre>\n",
    "score" : 4,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 21724606,
      "reputation" : 1441,
      "user_id" : 16034206,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/MRBdT.jpg?s=256",
      "display_name" : "pebble unit",
      "link" : "https://stackoverflow.com/users/16034206/pebble-unit"
    },
    "creation_date" : 1746754949,
    "last_activity_date" : 1746795977,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79613851,
    "question_id" : 79613259,
    "body" : "<p>You can refer  :</p>\n<p>TaskScheduler.scheduleAtFixedRate(task, delay, period);</p>\n<p>It allows you to create schedules manually.</p>\n",
    "score" : 2,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 15237833,
      "reputation" : 59,
      "user_id" : 10994988,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/ThZEj.jpg?s=256",
      "display_name" : "winston",
      "link" : "https://stackoverflow.com/users/10994988/winston"
    },
    "creation_date" : 1746783531,
    "last_activity_date" : 1746783531,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140409551,
    "post_id" : 79613259,
    "body" : "what is the context of do something for A/B/C/D? are the code the same but dependent on the parameters provided?",
    "score" : 0,
    "owner" : {
      "account_id" : 21724606,
      "reputation" : 1441,
      "user_id" : 16034206,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/MRBdT.jpg?s=256",
      "display_name" : "pebble unit",
      "link" : "https://stackoverflow.com/users/16034206/pebble-unit"
    },
    "creation_date" : 1746752796,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}