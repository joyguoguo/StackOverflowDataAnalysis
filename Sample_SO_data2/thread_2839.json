{
  "question" : {
    "question_id" : 79594242,
    "title" : "How to manage multiple JPA base entities (UUID, Long ID, Soft Delete) without redundant classes?",
    "body" : "<p>This question is likely already asked, but I am not satisfied with the answers. I add the link for reference.</p>\n<p><a href=\"https://stackoverflow.com/questions/49447721/how-to-inherit-from-multiple-base-abstract-classes-in-jpa\">Previous Question</a></p>\n<p>Now, coming to the point, I have six different abstract classes which could be individually extended by a Hibernate entity.</p>\n<ul>\n<li>BaseEntity</li>\n<li>BaseEntityImplUUID</li>\n<li>BaseEntityImplLong</li>\n<li>BaseEntitySoftDeletable</li>\n<li>BaseEntitySoftDeletableImplUUID</li>\n<li>BaseEntitySoftDeletableImplLong</li>\n</ul>\n<p>Note: Some classes extend one of these abstract classes, while some don't.</p>\n<p>BaseEntity.java</p>\n<pre><code>@Getter\n@Setter\n@NoArgsConstructor\n@AllArgsConstructor\n@MappedSuperclass\npublic abstract class BaseEntity {\n    @Column(name = &quot;created_at&quot;, updatable = false, nullable = false)\n    protected Instant createdAt;\n\n    @Column(name = &quot;updated_at&quot;, nullable = false)\n    protected Instant updatedAt;\n\n    @PrePersist\n    protected void onCreate() {\n        Instant now = Instant.now();\n        if (createdAt == null)\n            this.createdAt = now;\n        this.updatedAt = now;\n    }\n\n    @PreUpdate\n    protected void onUpdate() {\n        this.updatedAt = Instant.now();\n    }\n}\n</code></pre>\n<p>BaseEntityImplUUID.java</p>\n<pre><code>@Getter\n@Setter\n@NoArgsConstructor\n@AllArgsConstructor\n@MappedSuperclass\npublic abstract class BaseEntityImplUUID extends BaseEntity {\n    @Id\n    @Column(length = 36, nullable = false, unique = true, updatable = false)\n    protected UUID id;\n\n    @Override\n    protected void onCreate() {\n        super.onCreate();\n        if (this.id == null)\n            this.id = UUIDFactory.generate();\n    }\n}\n</code></pre>\n<p>BaseEntityImplLong.java</p>\n<pre><code>@Getter\n@Setter\n@NoArgsConstructor\n@AllArgsConstructor\n@MappedSuperclass\npublic abstract class BaseEntityImplLong extends BaseEntity {\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    protected Long id;\n}\n</code></pre>\n<p>BaseEntitySoftDeletable.java</p>\n<pre><code>@Getter\n@Setter\n@NoArgsConstructor\n@AllArgsConstructor\n@MappedSuperclass\npublic class BaseEntitySoftDeletable extends BaseEntity {\n    @Column(name = &quot;deleted_at&quot;)\n    private Instant deletedAt;\n\n    @Column(name = &quot;is_deleted&quot;)\n    private Boolean isDeleted;\n}\n</code></pre>\n<p>As same as the <code>BaseEntitySoftDeletable</code> class, the <code>BaseEntitySoftDeletableImplUUID</code> abstract class extends the <code>BaseEntityImplUUID</code> abstract class, and the <code>BaseEntitySoftDeletableImplLong</code> abstract class extends the <code>BaseEntityImplLong</code> abstract class.</p>\n<p>I found two answers from the previous question (I mentioned above) and the same from ChatGPT, Claude, and GeminiAI.</p>\n<ol>\n<li>Create six separate abstract classes with different behaviors and fields, like in my code.</li>\n<li>Use composition with @Embeddable and @Embedded annotations.</li>\n</ol>\n<p>Rather than using multiple class explosion or composition, I need a way that uses inheritance effectively. I expect answers to the following two questions.</p>\n<ol>\n<li>What is another effective way that uses inheritance or something?</li>\n<li>If there is still no other way, what's the best practice?</li>\n</ol>\n<p>Note: I tried with custom annotation, but it is a bit difficult to handle with Hibernate filters and listeners for me. But still, I am ready to accept a better answer, though.</p>\n",
    "tags" : [ "java", "spring-boot", "spring-data-jpa", "entity", "abstract-class" ],
    "owner" : {
      "account_id" : 18913393,
      "reputation" : 13,
      "user_id" : 13798994,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/Lh7l66Bd.jpg?s=256",
      "display_name" : "Aadhil Ahamed",
      "link" : "https://stackoverflow.com/users/13798994/aadhil-ahamed"
    },
    "is_answered" : true,
    "view_count" : 93,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1745775475,
    "creation_date" : 1745690165,
    "link" : "https://stackoverflow.com/questions/79594242/how-to-manage-multiple-jpa-base-entities-uuid-long-id-soft-delete-without-re",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79595293,
    "question_id" : 79594242,
    "body" : "<blockquote>\n<p>Rather than using multiple class explosion or composition, I need a way that uses inheritance effectively. I expect answers to the following two questions.</p>\n<ol>\n<li>What is another effective way that uses inheritance or something?</li>\n</ol>\n</blockquote>\n<p>You have these alternatives for obtaining entity properties and / or behavior other than by implementing them directly in the entity class:</p>\n<ul>\n<li><p>JPA entity classes can inherit persistent properties, callback methods, and associated annotations from mapped superclasses.  Java does not have multiple inheritance of classes, and interfaces cannot have instance variables, and JPA in any case does not, generally, pay attention to annotations from implemented interfaces, so in practice, there is no multiple inheritance vector that is useful for your purposes.</p>\n</li>\n<li><p>JPA entity classes can embed embeddable clases, such that instances are a direct part of the persistent state of the containing entity.  Embedded classes can of course have methods, but they cannot provide lifecycle callbacks to their parent entity, and in general, relatively few JPA annotations apply to embeddable classes or their members.</p>\n</li>\n<li><p>JPA entity classes can implement arbitrary interfaces, and thereby obtain method implementations from default methods of those interfaces.  But you cannot provide or access persistent properties that way, nor can you expect that JPA will recognize or honor annotations applied to such default methods, so this doesn't have much relevance to persistence.</p>\n</li>\n</ul>\n<blockquote>\n<ol start=\"2\">\n<li>If there is still no other way, what's the best practice?</li>\n</ol>\n</blockquote>\n<p>Generally, it's not the issue you're making it.  Projects tend to be fairly consistent across their persistence units, such that they don't have a need for the plethora of choices of entity base classes that you are trying to provide.  Many don't rely on inheritance at all to provide features to their entities.  Few rely on much broadly-scoped polymorphic behavior, and it's not usually much needed because most uses of entities are naturally specific to particular entity types.</p>\n<p>In your place, I'd probably use at most two mapped entity superclasses: your <code>BaseEntity</code> and maybe <code>BaseEntityImplUUID</code>.  It is not a coincidence that these two alone are sufficient to provide for all the entity lifecycle callbacks in the example code.  If I was allowing for entities with different <code>Id</code> types, then I would expect entities to provide for those themselves, except maybe UUIDs, though adding <code>BaseEntityImplLong</code> wouldn't be egregious.</p>\n<p>I would consider supporting the soft-deletable feature with an <code>@Embeddable</code> class providing the <code>isDeleted</code> and <code>deletedAt</code> properties (though I note that <code>isDeleted</code> is probably redundant).  That does not get you a polymorphic interface to soft deletion, but, again, you probably wouldn't benefit much from such anyway.</p>\n",
    "score" : 1,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 2792262,
      "reputation" : 190832,
      "user_id" : 2402272,
      "user_type" : "registered",
      "accept_rate" : 85,
      "profile_image" : "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=256&d=identicon&r=PG",
      "display_name" : "John Bollinger",
      "link" : "https://stackoverflow.com/users/2402272/john-bollinger"
    },
    "creation_date" : 1745775475,
    "last_activity_date" : 1745775475,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140373999,
    "post_id" : 79594242,
    "body" : "@JohnBollinger, I mentioned it in my question. I asked two questions which didn&#39;t answer in the referenced question. And I mentioned &quot;I need a way that uses inheritance...&quot;, so I need to know if there is any other way to do that. If there is not, then what&#39;s the better solution to handle this type of situation? That&#39;s my second question.",
    "score" : 0,
    "owner" : {
      "account_id" : 18913393,
      "reputation" : 13,
      "user_id" : 13798994,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/Lh7l66Bd.jpg?s=256",
      "display_name" : "Aadhil Ahamed",
      "link" : "https://stackoverflow.com/users/13798994/aadhil-ahamed"
    },
    "creation_date" : 1745768503,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140373076,
    "post_id" : 79594242,
    "body" : "All right. In that case, how is this not a dupe of the question you referenced? If you have reason to think that there is more to be said than its answers already say, then please edit the question to explain why you think so, and to focus the question there.",
    "score" : 0,
    "owner" : {
      "account_id" : 2792262,
      "reputation" : 190832,
      "user_id" : 2402272,
      "user_type" : "registered",
      "accept_rate" : 85,
      "profile_image" : "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=256&d=identicon&r=PG",
      "display_name" : "John Bollinger",
      "link" : "https://stackoverflow.com/users/2402272/john-bollinger"
    },
    "creation_date" : 1745731695,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140372592,
    "post_id" : 79594242,
    "body" : "@mlecz, Sure, I will check it out.",
    "score" : 0,
    "owner" : {
      "account_id" : 18913393,
      "reputation" : 13,
      "user_id" : 13798994,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/Lh7l66Bd.jpg?s=256",
      "display_name" : "Aadhil Ahamed",
      "link" : "https://stackoverflow.com/users/13798994/aadhil-ahamed"
    },
    "creation_date" : 1745702091,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140372589,
    "post_id" : 79594242,
    "body" : "@JohnBollinger, Yes, but I tried to say that I wanted to generalize them. The first three base entities extend the <i>SoftDeleteable</i> fields and methods in the same way. So, if I can create another abstract class for it and extend it, it would be the answer. But we cannot extend two classes at the same time.",
    "score" : 0,
    "owner" : {
      "account_id" : 18913393,
      "reputation" : 13,
      "user_id" : 13798994,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/Lh7l66Bd.jpg?s=256",
      "display_name" : "Aadhil Ahamed",
      "link" : "https://stackoverflow.com/users/13798994/aadhil-ahamed"
    },
    "creation_date" : 1745702007,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140372581,
    "post_id" : 79594242,
    "body" : "@Joan, I think so, that it is overkill while adding filters or <code>@Where</code> annotations.",
    "score" : 0,
    "owner" : {
      "account_id" : 18913393,
      "reputation" : 13,
      "user_id" : 13798994,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/Lh7l66Bd.jpg?s=256",
      "display_name" : "Aadhil Ahamed",
      "link" : "https://stackoverflow.com/users/13798994/aadhil-ahamed"
    },
    "creation_date" : 1745701620,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140372576,
    "post_id" : 79594242,
    "body" : "cannot help with the answer, but your SoftDeletable entity should throw on @PreRemove",
    "score" : 0,
    "owner" : {
      "account_id" : 4034639,
      "reputation" : 1026,
      "user_id" : 3319557,
      "user_type" : "registered",
      "accept_rate" : 100,
      "profile_image" : "https://www.gravatar.com/avatar/42ab59abebcd13046bc3af50b66180a6?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "mlecz",
      "link" : "https://stackoverflow.com/users/3319557/mlecz"
    },
    "creation_date" : 1745701187,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140372480,
    "post_id" : 79594242,
    "body" : "I&#39;m not following what you mean by &quot;<i>without creating different classes for each use case</i>&quot;, in the context of having &quot;<i>multiple base entities</i>&quot;.  How are multiple base entities not inherently multiple classes?",
    "score" : 0,
    "owner" : {
      "account_id" : 2792262,
      "reputation" : 190832,
      "user_id" : 2402272,
      "user_type" : "registered",
      "accept_rate" : 85,
      "profile_image" : "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=256&d=identicon&r=PG",
      "display_name" : "John Bollinger",
      "link" : "https://stackoverflow.com/users/2402272/john-bollinger"
    },
    "creation_date" : 1745696945,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140372466,
    "post_id" : 79594242,
    "body" : "@Joan, what do you mean by &quot;You can also add fields in the interface&quot;?  Per <a href=\"https://docs.oracle.com/javase/specs/jls/se23/html/jls-9.html\" rel=\"nofollow noreferrer\">JLS 23</a>, interfaces (still) cannot have instance variables.",
    "score" : 0,
    "owner" : {
      "account_id" : 2792262,
      "reputation" : 190832,
      "user_id" : 2402272,
      "user_type" : "registered",
      "accept_rate" : 85,
      "profile_image" : "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=256&d=identicon&r=PG",
      "display_name" : "John Bollinger",
      "link" : "https://stackoverflow.com/users/2402272/john-bollinger"
    },
    "creation_date" : 1745696457,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140372379,
    "post_id" : 79594242,
    "body" : "To be honest right now the only other way I can think of is using annotations (like lombok ones) that add method and fields at compile time. But it will be an overkill solution.",
    "score" : 0,
    "owner" : {
      "account_id" : 26746848,
      "reputation" : 453,
      "user_id" : 20346807,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a/ALm5wu3JY7zmtBLIKO51iCoerZOU2SjkVZ97Khtr_zmC=k-s256",
      "display_name" : "Joan",
      "link" : "https://stackoverflow.com/users/20346807/joan"
    },
    "creation_date" : 1745693378,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140372343,
    "post_id" : 79594242,
    "body" : "Yes, but it should be initialized. This does not exactly fulfil my requirement.",
    "score" : 0,
    "owner" : {
      "account_id" : 18913393,
      "reputation" : 13,
      "user_id" : 13798994,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/Lh7l66Bd.jpg?s=256",
      "display_name" : "Aadhil Ahamed",
      "link" : "https://stackoverflow.com/users/13798994/aadhil-ahamed"
    },
    "creation_date" : 1745692332,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140372323,
    "post_id" : 79594242,
    "body" : "You can also add fields in the interface. But yes I mean that.",
    "score" : 0,
    "owner" : {
      "account_id" : 26746848,
      "reputation" : 453,
      "user_id" : 20346807,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a/ALm5wu3JY7zmtBLIKO51iCoerZOU2SjkVZ97Khtr_zmC=k-s256",
      "display_name" : "Joan",
      "link" : "https://stackoverflow.com/users/20346807/joan"
    },
    "creation_date" : 1745692013,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140372312,
    "post_id" : 79594242,
    "body" : "@Joan I am using Java 21.",
    "score" : 0,
    "owner" : {
      "account_id" : 18913393,
      "reputation" : 13,
      "user_id" : 13798994,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/Lh7l66Bd.jpg?s=256",
      "display_name" : "Aadhil Ahamed",
      "link" : "https://stackoverflow.com/users/13798994/aadhil-ahamed"
    },
    "creation_date" : 1745691210,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140372309,
    "post_id" : 79594242,
    "body" : "Did you mean creating an interface named <code>SoftDeletable</code> and implementing it, while adding the <code>deletedAt</code> and <code>isDeleted</code> fields in every entity?",
    "score" : 0,
    "owner" : {
      "account_id" : 18913393,
      "reputation" : 13,
      "user_id" : 13798994,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/Lh7l66Bd.jpg?s=256",
      "display_name" : "Aadhil Ahamed",
      "link" : "https://stackoverflow.com/users/13798994/aadhil-ahamed"
    },
    "creation_date" : 1745691137,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140372290,
    "post_id" : 79594242,
    "body" : "Maybe you can try with interfaces and default method implementations if you&#39;re using a &quot;modern&quot; Java version.",
    "score" : 0,
    "owner" : {
      "account_id" : 26746848,
      "reputation" : 453,
      "user_id" : 20346807,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a/ALm5wu3JY7zmtBLIKO51iCoerZOU2SjkVZ97Khtr_zmC=k-s256",
      "display_name" : "Joan",
      "link" : "https://stackoverflow.com/users/20346807/joan"
    },
    "creation_date" : 1745690504,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79595293" : [ {
      "comment_id" : 140376414,
      "post_id" : 79595293,
      "body" : "@AadhilAhamed, that refers to the first part of the same sentence: &quot;That does not get you a polymorphic interface to soft deletion&quot;.  And polymorphic soft deletion probably doesn&#39;t help you much because, as I said earlier, most entity uses are naturally specific to particular entity types.  So if you&#39;re working with <code>User</code>s, say, then you know that they are soft-deletable and at need, you use their specific soft-deletion feature.  You wouldn&#39;t (probably) benefit from soft deletion being inherited from a superclass, so that it could be performed polymorphically.",
      "score" : 0,
      "owner" : {
        "account_id" : 2792262,
        "reputation" : 190832,
        "user_id" : 2402272,
        "user_type" : "registered",
        "accept_rate" : 85,
        "profile_image" : "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=256&d=identicon&r=PG",
        "display_name" : "John Bollinger",
        "link" : "https://stackoverflow.com/users/2402272/john-bollinger"
      },
      "creation_date" : 1745844054,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140375161,
      "post_id" : 79595293,
      "body" : "I realized that <code>BaseEntity</code> and <code>BaseEntityImplUUID</code> are sufficient, and that <code>@Embeddable</code> can be used for soft-deletion. But I don&#39;t understand the &quot;you probably wouldn&#39;t benefit much from such anyway.&quot;",
      "score" : 0,
      "owner" : {
        "account_id" : 18913393,
        "reputation" : 13,
        "user_id" : 13798994,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/Lh7l66Bd.jpg?s=256",
        "display_name" : "Aadhil Ahamed",
        "link" : "https://stackoverflow.com/users/13798994/aadhil-ahamed"
      },
      "creation_date" : 1745816631,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}