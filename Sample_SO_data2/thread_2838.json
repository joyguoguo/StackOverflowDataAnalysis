{
  "question" : {
    "question_id" : 79594331,
    "title" : "How do I send a calendar invite using Firebase&#39;s email extension?",
    "body" : "<p>I am trying to send users an email with a calendar invite for a date they chose to adopt an animal, for an animal shelter app. So far my code looks like this:</p>\n<pre><code>private void sendEmail() {\n    try {\n        DateTimeFormatter formatter = DateTimeFormatter.ofPattern(&quot;dd/MM/yyyy&quot;);\n        LocalDate date = LocalDate.parse(ti_date.getText().toString(), formatter);\n        String icsContent = generateICS(date);\n        String base64Ics = Base64.encodeToString(icsContent.getBytes(StandardCharsets.UTF_8), Base64.DEFAULT);\n\n\n        // Prepare email document for Firestore\n        Map&lt;String, Object&gt; attachment = new HashMap&lt;&gt;();\n        attachment.put(&quot;filename&quot;, &quot;adoption_event.ics&quot;);\n        attachment.put(&quot;content&quot;, base64Ics);\n        attachment.put(&quot;type&quot;, &quot;application/ics&quot;);\n\n        Map&lt;String, Object&gt; message = new HashMap&lt;&gt;();\n        message.put(&quot;subject&quot;, &quot;Adoption Appointment Reminder&quot;);\n        message.put(&quot;text&quot;, &quot;Hello &quot; + userName + &quot;,\\n\\nThis is a reminder for your adoption appointment of &quot; + animalName + &quot; on &quot; + ti_date.getText().toString() + &quot;.&quot;);\n\n        Map&lt;String, Object&gt; emailDoc = new HashMap&lt;&gt;();\n        emailDoc.put(&quot;to&quot;, email);\n        message.put(&quot;attachments&quot;, Arrays.asList(attachment));\n        emailDoc.put(&quot;message&quot;, message);\n\n        db.collection(&quot;mail&quot;)\n                .add(emailDoc)\n                .addOnSuccessListener(documentReference -&gt; {\n                    Toast.makeText(AdoptionPage.this, &quot;Email sent with calendar invite!&quot;, Toast.LENGTH_SHORT).show();\n                    home();\n                })\n                .addOnFailureListener(e -&gt; {\n                    Log.e(&quot;AdoptionPage&quot;, &quot;Error sending email&quot;, e);\n                    Toast.makeText(AdoptionPage.this, &quot;Failed to send email.&quot;, Toast.LENGTH_SHORT).show();\n                });\n\n    } catch (Exception e) {\n        e.printStackTrace();\n        Toast.makeText(this, &quot;Failed to create invite.&quot;, Toast.LENGTH_SHORT).show();\n    }\n}\n\nprivate static String generateICS(LocalDate date) {\n    // create an event from 10:00 to 11:00 UTC\n    String start = date.atTime(10, 0).format(DateTimeFormatter.ofPattern(&quot;yyyyMMdd'T'HHmmss'Z'&quot;));\n    String end = date.atTime(11, 0).format(DateTimeFormatter.ofPattern(&quot;yyyyMMdd'T'HHmmss'Z'&quot;));\n\n    String dtstamp = LocalDateTime.now().format(DateTimeFormatter.ofPattern(&quot;yyyyMMdd'T'HHmmss'Z'&quot;));\n\n    StringBuilder sb = new StringBuilder();\n    sb.append(&quot;BEGIN:VCALENDAR&quot;).append(&quot;\\r\\n&quot;);\n    sb.append(&quot;VERSION:2.0&quot;).append(&quot;\\r\\n&quot;);\n    sb.append(&quot;PRODID:-//PetShelter//PetShelterApp//EN&quot;).append(&quot;\\r\\n&quot;);\n    sb.append(&quot;CALSCALE:GREGORIAN&quot;).append(&quot;\\r\\n&quot;);\n    sb.append(&quot;METHOD:REQUEST&quot;).append(&quot;\\r\\n&quot;);\n    sb.append(&quot;BEGIN:VEVENT&quot;).append(&quot;\\r\\n&quot;);\n    sb.append(&quot;UID:&quot;).append(UUID.randomUUID()).append(&quot;@gmail.com&quot;).append(&quot;\\r\\n&quot;);\n    sb.append(&quot;SUMMARY:Adoption Appointment&quot;).append(&quot;\\r\\n&quot;);\n    sb.append(&quot;DESCRIPTION:This is a reminder for the adoption you scheduled&quot;).append(&quot;\\r\\n&quot;);\n    sb.append(&quot;DTSTART:&quot;).append(start).append(&quot;\\r\\n&quot;);\n    sb.append(&quot;DTEND:&quot;).append(end).append(&quot;\\r\\n&quot;);\n    sb.append(&quot;DTSTAMP:&quot;).append(dtstamp).append(&quot;\\r\\n&quot;);\n    sb.append(&quot;ORGANIZER;CN=Organizer Name:mailto:&quot;).append(myEmail).append(&quot;\\r\\n&quot;);\n    sb.append(&quot;ATTENDEE;CN=Attendee Name;RSVP=TRUE:mailto:&quot;).append(email).append(&quot;\\r\\n&quot;);\n    sb.append(&quot;LOCATION:Online Zoom&quot;).append(&quot;\\r\\n&quot;);\n    sb.append(&quot;SEQUENCE:0&quot;).append(&quot;\\r\\n&quot;);\n    sb.append(&quot;STATUS:CONFIRMED&quot;).append(&quot;\\r\\n&quot;);\n    sb.append(&quot;TRANSP:OPAQUE&quot;).append(&quot;\\r\\n&quot;);\n    sb.append(&quot;END:VEVENT&quot;).append(&quot;\\r\\n&quot;);\n    sb.append(&quot;END:VCALENDAR&quot;);\n\n\n    return sb.toString();\n}\n</code></pre>\n<p>I do manage to send an email, but when I try to open the file with the calendar app, I get a &quot;describe error&quot;.\nI'm currently using Firebase's email extension to send the email, but any other suggestions are more than welcomed. I just don't want the user's email app to open to send the email, like I saw in most tutorials.\nLooks like it's a problem with the ics file formatting, but I can't see anything not fitting.</p>\n",
    "tags" : [ "java", "android", "firebase-extensions" ],
    "owner" : {
      "account_id" : 20946013,
      "reputation" : 1,
      "user_id" : 15388856,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/46dcd907211d751b9284482907817102?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "MeowSpaceCat",
      "link" : "https://stackoverflow.com/users/15388856/meowspacecat"
    },
    "is_answered" : false,
    "view_count" : 27,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1745698252,
    "creation_date" : 1745696564,
    "link" : "https://stackoverflow.com/questions/79594331/how-do-i-send-a-calendar-invite-using-firebases-email-extension",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ ],
  "answer_comments" : { }
}