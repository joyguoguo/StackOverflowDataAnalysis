{
  "question" : {
    "question_id" : 79563204,
    "title" : "JAXB Context expects empty namespace no matter what",
    "body" : "<p>I am facing an issue when unmarshalling an XML to my XJC Schema based generated classes using JAXB. I have read every post I've found so far, trying already who knows how many things, without success.</p>\n<p>I have generated my Java classes using <code>xjc -d &quot;/myDir/src&quot; -p nodeset.generated ./UANodeSet.xsd</code>, where UANodeSet.xsd is <a href=\"https://github.com/OPCFoundation/UA-Nodeset/blob/latest/Schema/UANodeSet.xsd\" rel=\"nofollow noreferrer\">this</a>.</p>\n<p>In my Java code, I call unmarshall the <a href=\"https://github.com/OPCFoundation/UA-Nodeset/blob/latest/Schema/Opc.Ua.NodeSet2.xml\" rel=\"nofollow noreferrer\">NodeSet2.xml</a> file to the generated class <code>UANodeSet</code> (Root element) like:</p>\n<pre class=\"lang-java prettyprint-override\"><code>String packageName = UANodeSet.class.getPackage().getName();\nJAXBContext context = JAXBContext.newInstance(packageName);\nUnmarshaller unmarshaller = context.createUnmarshaller();\nunmarshaller.setEventHandler(event -&gt; {\n                System.err.println(&quot;JAXB EVENT: &quot; + event.getMessage());\n                return true; // continue after error\n            });\nString filePath = &quot;C:/Users/mr/Downloads/Opc.Ua.NodeSet2.xml&quot;;\nFile file = new File(filePath);\nJAXBElement&lt;UANodeSet&gt; nodeSet = (JAXBElement&lt;UANodeSet&gt;)unmarshaller.unmarshal(new StreamSource(file), UANodeSet.class);\nUANodeSet nd = nodeSet.getValue();\n</code></pre>\n<p>This outputs the following:</p>\n<pre><code>JAXB EVENT: unexpected element (uri:&quot;http://opcfoundation.org/UA/2011/03/UANodeSet.xsd&quot;, local:&quot;Models&quot;). Expected elements are &lt;{}models&gt;,&lt;{}serverUris&gt;,&lt;{}extensions&gt;,&lt;{}aliases&gt;,&lt;{}namespaceUris&gt;,&lt;{}lastModified&gt; \nJAXB EVENT: unexpected element (uri:&quot;http://opcfoundation.org/UA/2011/03/UANodeSet.xsd&quot;, local:&quot;Aliases&quot;). Expected elements are &lt;{}models&gt;,&lt;{}serverUris&gt;,&lt;{}extensions&gt;,&lt;{}aliases&gt;,&lt;{}namespaceUris&gt;,&lt;{}lastModified&gt; \nJAXB EVENT: unexpected element (uri:&quot;http://opcfoundation.org/UA/2011/03/UANodeSet.xsd&quot;, local:&quot;UAObject&quot;). Expected elements are &lt;{}models&gt;,&lt;{}serverUris&gt;,&lt;{}extensions&gt;,&lt;{}aliases&gt;,&lt;{}namespaceUris&gt;,&lt;{}lastModified&gt; \nJAXB EVENT: unexpected element (uri:&quot;http://opcfoundation.org/UA/2011/03/UANodeSet.xsd&quot;, local:&quot;UAObject&quot;). Expected elements are &lt;{}models&gt;,&lt;{}serverUris&gt;,&lt;{}extensions&gt;,&lt;{}aliases&gt;,&lt;{}namespaceUris&gt;,&lt;{}lastModified&gt; \nJAXB EVENT: unexpected element (uri:&quot;http://opcfoundation.org/UA/2011/03/UANodeSet.xsd&quot;, local:&quot;UADataType&quot;). Expected elements are &lt;{}models&gt;,&lt;{}serverUris&gt;,&lt;{}extensions&gt;,&lt;{}aliases&gt;,&lt;{}namespaceUris&gt;,&lt;{}lastModified&gt;\n\n...\n</code></pre>\n<p>and <code>nd</code> is populated with a <code>UANodeSet</code> object with <code>null</code> values.</p>\n<p>I confirm I have a file named <code>package-info.java</code> within the same package (<code>nodeset.generated</code>) with the following content:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@XmlSchema(\n    namespace = &quot;http://opcfoundation.org/UA/2011/03/UANodeSet.xsd&quot;,\n    elementFormDefault = XmlNsForm.QUALIFIED)\npackage nodeset.generated;\n\nimport jakarta.xml.bind.annotation.XmlNsForm;\nimport jakarta.xml.bind.annotation.XmlSchema;\n</code></pre>\n<p>To have as reference, here is what <code>UANodeSet</code> looks like:</p>\n<pre class=\"lang-java prettyprint-override\"><code>package nodeset.generated;\n\nimport java.util.ArrayList;\nimport java.util.List;\nimport javax.xml.datatype.XMLGregorianCalendar;\nimport jakarta.xml.bind.annotation.XmlAccessType;\nimport jakarta.xml.bind.annotation.XmlAccessorType;\nimport jakarta.xml.bind.annotation.XmlAttribute;\nimport jakarta.xml.bind.annotation.XmlElement;\nimport jakarta.xml.bind.annotation.XmlElements;\nimport jakarta.xml.bind.annotation.XmlRootElement;\nimport jakarta.xml.bind.annotation.XmlSchemaType;\nimport jakarta.xml.bind.annotation.XmlType;\n\n@XmlAccessorType(XmlAccessType.FIELD)\n@XmlType(name = &quot;&quot;, propOrder = {\n    &quot;namespaceUris&quot;,\n    &quot;serverUris&quot;,\n    &quot;models&quot;,\n    &quot;aliases&quot;,\n    &quot;extensions&quot;,\n    &quot;uaObjectOrUAVariableOrUAMethod&quot;\n})\n@XmlRootElement(name = &quot;UANodeSet&quot;)\npublic class UANodeSet {\n\n    @XmlElement(name=&quot;NamespaceUris&quot;)\n    protected UriTable namespaceUris;\n    @XmlElement(name=&quot;ServerUris&quot;)\n    protected UriTable serverUris;\n    @XmlElement(name=&quot;Models&quot;)\n    protected ModelTable models;\n    @XmlElement(name=&quot;Aliases&quot;)\n    protected AliasTable aliases;\n    @XmlElement(name=&quot;Extensions&quot;)\n    protected ListOfExtensions extensions;\n    @XmlElements({\n        @XmlElement(name=&quot;UAObject&quot;, type = UAObject.class),\n        @XmlElement(name=&quot;UAVariable&quot;, type = UAVariable.class),\n        @XmlElement(name=&quot;UAMethod&quot;, type = UAMethod.class),\n        @XmlElement(name=&quot;UAView&quot;, type = UAView.class),\n        @XmlElement(name=&quot;UAObjectType&quot;, type = UAObjectType.class),\n        @XmlElement(name=&quot;UAVariableType&quot;, type = UAVariableType.class),\n        @XmlElement(name=&quot;UADataType&quot;, type = UADataType.class),\n        @XmlElement(name=&quot;UAReferenceType&quot;, type = UAReferenceType.class)\n    })\n    protected List&lt;UANode&gt; uaObjectOrUAVariableOrUAMethod;\n    @XmlAttribute(name = &quot;LastModified&quot;)\n    @XmlSchemaType(name = &quot;dateTime&quot;)\n    protected XMLGregorianCalendar lastModified;\n\n...\n</code></pre>\n<p><strong>Things I've tried</strong></p>\n<ol>\n<li>Instantiate the <code>JAXBContext</code> from <code>UANodeSet.class</code> (<code>JAXBContext context = JAXBContext.newInstance(UANodeSet.class);</code>) =&gt; nothing has changed</li>\n<li>Add manually <code>namespace = &quot;http://opcfoundation.org/UA/2011/03/UANodeSet.xsd&quot;</code> to <code>@XmlType</code>s and/or <code>@XmlElement</code>s <code>@XmlRootElement</code> =&gt; <code>JAXBContext</code> continues to say the expected elements are <code>&lt;{}models&gt;,&lt;{}serverUris&gt;,&lt;{}extensions&gt;,&lt;{}aliases&gt;,&lt;{}namespaceUris&gt;,&lt;{}lastModified&gt;</code></li>\n<li>Removing <code>package-info.java</code> file completely, and add the <code>namespace=&quot;http://opcfoundation.org/UA/2011/03/UANodeSet.xsd&quot;</code> attribute everywhere (<code>@XmlType</code>s, <code>@XmlElement</code>s, <code>@XmlRootElement</code>) =&gt; no changes.</li>\n</ol>\n<p>Basically, I cannot make my <code>JAXBContext</code> expect the proper namespace for the <code>UANodeSet</code> elements.</p>\n<p>Any help is appreciated, I have been fighting with this since too long already.</p>\n",
    "tags" : [ "java", "xml", "xsd", "jaxb", "opc-ua" ],
    "owner" : {
      "account_id" : 18964531,
      "reputation" : 161,
      "user_id" : 13839278,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/c0f4e5ea04bc9087df2e6c51874b1029?s=256&d=identicon&r=PG",
      "display_name" : "Miguel",
      "link" : "https://stackoverflow.com/users/13839278/miguel"
    },
    "is_answered" : true,
    "view_count" : 123,
    "answer_count" : 2,
    "score" : 1,
    "last_activity_date" : 1744233117,
    "creation_date" : 1744154515,
    "link" : "https://stackoverflow.com/questions/79563204/jaxb-context-expects-empty-namespace-no-matter-what",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79565339,
    "question_id" : 79563204,
    "body" : "<p>Well, I cannot really explain why because I lack years of experience with Java and Plug-in Development Environment, but the problem seems to be that my XML unmarshalling is in a different plug-in as my generated classes.</p>\n<p>If I create my <code>JAXBContext</code> from <code>ObjectFactory.class</code> in a plug-in project different from where the package <code>nodeset.generated</code> is defined (package that holds the XJC generated classes), then the context doesn't know about <code>UANodeSet</code> class. I find it strange, because <code>nodeset.generated</code> is being exported, and imported in the unmarshalling package.</p>\n<p>I have moved the unmarshalling methods to <code>nodeset.generated</code> and everything worked like charm.</p>\n<p>If someone can give the details on why this could be, I will happily edit this answer.</p>\n",
    "score" : 1,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 18964531,
      "reputation" : 161,
      "user_id" : 13839278,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/c0f4e5ea04bc9087df2e6c51874b1029?s=256&d=identicon&r=PG",
      "display_name" : "Miguel",
      "link" : "https://stackoverflow.com/users/13839278/miguel"
    },
    "creation_date" : 1744233117,
    "last_activity_date" : 1744233117,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79563236,
    "question_id" : 79563204,
    "body" : "<p>While not a direct answer to your question, I am currently using XJC and JAXB on the exact same schema in this project: <a href=\"https://github.com/digitalpetri/uanodeset\" rel=\"nofollow noreferrer\">https://github.com/digitalpetri/uanodeset</a></p>\n<p>I use <code>jaxb2-maven-plugin</code> as configured here: <a href=\"https://github.com/digitalpetri/uanodeset/blob/ec3c182f0c808667994951c19f1c7d2b42c46c92/uanodeset-core/pom.xml#L55-L91\" rel=\"nofollow noreferrer\">https://github.com/digitalpetri/uanodeset/blob/ec3c182f0c808667994951c19f1c7d2b42c46c92/uanodeset-core/pom.xml#L55-L91</a></p>\n<p>Parsing the UANodeSet XML file is simply:</p>\n<pre><code>/**\n * Read and parse an XML document conforming to the &lt;a\n * href=&quot;http://opcfoundation.org/UA/2011/03/UANodeSet.xsd&quot;&gt;UANodeSet&lt;/a&gt; schema from an {@link\n * InputStream}.\n *\n * @param inputStream the {@link InputStream} to read from.\n * @return a {@link UANodeSet}.\n * @throws JAXBException if an error occurs while unmarshalling.\n */\npublic static UANodeSet parse(InputStream inputStream) throws JAXBException {\n  JAXBContext jaxbContext = JAXBContext.newInstance(ObjectFactory.class);\n\n  return (UANodeSet) jaxbContext.createUnmarshaller().unmarshal(inputStream);\n}\n</code></pre>\n<p>If you can't use my project, maybe you can at least re-use some of the code.</p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 31322,
      "reputation" : 7060,
      "user_id" : 85927,
      "user_type" : "registered",
      "accept_rate" : 50,
      "profile_image" : "https://www.gravatar.com/avatar/b0b8436de25045f597f45e8ba4748141?s=256&d=identicon&r=PG",
      "display_name" : "Kevin Herron",
      "link" : "https://stackoverflow.com/users/85927/kevin-herron"
    },
    "creation_date" : 1744156761,
    "last_activity_date" : 1744184077,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140314247,
    "post_id" : 79563204,
    "body" : "Use <a href=\"https://stackoverflow.com/editing-help#code\">code block</a> format for the error too. Quote format makes it lose the structure and is less readable.",
    "score" : 0,
    "owner" : {
      "account_id" : 372682,
      "reputation" : 26512,
      "user_id" : 721855,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/vZiox.png?s=256",
      "display_name" : "aled",
      "link" : "https://stackoverflow.com/users/721855/aled"
    },
    "creation_date" : 1744164949,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79563236" : [ {
      "comment_id" : 140317879,
      "post_id" : 79563236,
      "body" : "Myself I am using JAXB downloaded from here: <a href=\"https://eclipse-ee4j.github.io/jaxb-ri/\" rel=\"nofollow noreferrer\">eclipse-ee4j.github.io/jaxb-ri</a> Have grabbed the <code>.jar</code> files at <code>&#47;mod</code> and added them to a folder called <code>&#47;lib</code> inside my PDE project. Then I&#39;ve added them to the classpath, and compile works. But then I get the errors explained in the post",
      "score" : 0,
      "owner" : {
        "account_id" : 18964531,
        "reputation" : 161,
        "user_id" : 13839278,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/c0f4e5ea04bc9087df2e6c51874b1029?s=256&d=identicon&r=PG",
        "display_name" : "Miguel",
        "link" : "https://stackoverflow.com/users/13839278/miguel"
      },
      "creation_date" : 1744229836,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140317673,
      "post_id" : 79563236,
      "body" : "Although I am not an OSGI user, I do know enough to tell you that Maven and OSGI are orthogonal. Maven is a build tool, whereas OSGI is kind of a framework for building modular applications. I don&#39;t know why it doesn&#39;t work for you in your environment though. Maybe different versions of the JAXB / XML bind API dependencies?",
      "score" : 0,
      "owner" : {
        "account_id" : 31322,
        "reputation" : 7060,
        "user_id" : 85927,
        "user_type" : "registered",
        "accept_rate" : 50,
        "profile_image" : "https://www.gravatar.com/avatar/b0b8436de25045f597f45e8ba4748141?s=256&d=identicon&r=PG",
        "display_name" : "Kevin Herron",
        "link" : "https://stackoverflow.com/users/85927/kevin-herron"
      },
      "creation_date" : 1744226165,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140317540,
      "post_id" : 79563236,
      "body" : "thanks! all the classes look exactly the same.. Still don&#39;t know why it&#39;s not working on my project. I am not using Maven, I am using OSGI. I am new to Java, so I honestly don&#39;t know what could the differences be",
      "score" : 0,
      "owner" : {
        "account_id" : 18964531,
        "reputation" : 161,
        "user_id" : 13839278,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/c0f4e5ea04bc9087df2e6c51874b1029?s=256&d=identicon&r=PG",
        "display_name" : "Miguel",
        "link" : "https://stackoverflow.com/users/13839278/miguel"
      },
      "creation_date" : 1744224036,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140317494,
      "post_id" : 79563236,
      "body" : "<a href=\"https://gist.github.com/kevinherron/07ae95612b1241494cd7ccf8dff3d71a\" rel=\"nofollow noreferrer\">gist.github.com/kevinherron/07ae95612b1241494cd7ccf8dff3d71a</a>  if you check out and build the project you&#39;ll be able to inspect all of the generated sources.",
      "score" : 0,
      "owner" : {
        "account_id" : 31322,
        "reputation" : 7060,
        "user_id" : 85927,
        "user_type" : "registered",
        "accept_rate" : 50,
        "profile_image" : "https://www.gravatar.com/avatar/b0b8436de25045f597f45e8ba4748141?s=256&d=identicon&r=PG",
        "display_name" : "Kevin Herron",
        "link" : "https://stackoverflow.com/users/85927/kevin-herron"
      },
      "creation_date" : 1744223465,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140317283,
      "post_id" : 79563236,
      "body" : "How does your <code>ObjectFactory</code> class look like? If I use your code, I get the following error: <code>jakarta.xml.bind.UnmarshalException: unexpected element (uri:&quot;http:&#47;&#47;opcfoundation.org&#47;UA&#47;2011&#47;03&#47;UANodeSet.xsd&quot;, local:&quot;UANodeSet&quot;). Expected elements are (none)</code>",
      "score" : 0,
      "owner" : {
        "account_id" : 18964531,
        "reputation" : 161,
        "user_id" : 13839278,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/c0f4e5ea04bc9087df2e6c51874b1029?s=256&d=identicon&r=PG",
        "display_name" : "Miguel",
        "link" : "https://stackoverflow.com/users/13839278/miguel"
      },
      "creation_date" : 1744219527,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}