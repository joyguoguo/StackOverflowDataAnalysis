{
  "question" : {
    "question_id" : 79609706,
    "title" : "Unable to package Log4j2 in maven project",
    "body" : "<p>This was my original pom.xml file I started with:</p>\n<pre><code>&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    &lt;groupId&gt;com.calculator&lt;/groupId&gt;\n    &lt;artifactId&gt;GraphingCalculator&lt;/artifactId&gt;\n    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;\n\n    &lt;properties&gt;\n        &lt;maven.compiler.source&gt;23&lt;/maven.compiler.source&gt;\n        &lt;maven.compiler.target&gt;23&lt;/maven.compiler.target&gt;\n        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\n    &lt;/properties&gt;\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.matheclipse&lt;/groupId&gt;\n            &lt;artifactId&gt;matheclipse-core&lt;/artifactId&gt;\n            &lt;version&gt;3.0.0&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n            &lt;artifactId&gt;slf4j-nop&lt;/artifactId&gt;\n            &lt;version&gt;2.0.9&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;\n            &lt;artifactId&gt;log4j-core&lt;/artifactId&gt;\n            &lt;version&gt;2.21.1&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n            &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;\n            &lt;version&gt;1.7.36&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.scilab.forge&lt;/groupId&gt;\n            &lt;artifactId&gt;jlatexmath&lt;/artifactId&gt;\n            &lt;version&gt;1.0.7&lt;/version&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n\n&lt;/project&gt;\n</code></pre>\n<p>I then compiling the jar using: <code>mvn clean package</code>.</p>\n<p>I then ran the jar using:\n<code>java -jar GraphingCalculator-1.0-SNAPSHOT.jar</code></p>\n<p>This gave me the error:</p>\n<blockquote>\n<p>no main manifest attribute, in GraphingCalculator-1.0-SNAPSHOT.jar</p>\n</blockquote>\n<p>I did some research and tried adding this to my pom.xml:</p>\n<pre><code>&lt;build&gt;\n    &lt;plugins&gt;\n        &lt;plugin&gt;\n            &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n            &lt;artifactId&gt;maven-jar-plugin&lt;/artifactId&gt;\n            &lt;version&gt;3.2.0&lt;/version&gt;\n            &lt;configuration&gt;\n                &lt;archive&gt;\n                    &lt;manifest&gt;\n                        &lt;addClasspath&gt;true&lt;/addClasspath&gt;\n                        &lt;classpathPrefix&gt;lib/&lt;/classpathPrefix&gt;\n                        &lt;mainClass&gt;com.calculator.Main&lt;/mainClass&gt; &lt;!-- Replace with your actual main class --&gt;\n                    &lt;/manifest&gt;\n                &lt;/archive&gt;\n            &lt;/configuration&gt;\n        &lt;/plugin&gt;\n        \n        &lt;plugin&gt;\n            &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n            &lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt;\n            &lt;version&gt;3.4.1&lt;/version&gt;\n            &lt;executions&gt;\n                &lt;execution&gt;\n                    &lt;phase&gt;package&lt;/phase&gt;\n                    &lt;goals&gt;\n                        &lt;goal&gt;shade&lt;/goal&gt;\n                    &lt;/goals&gt;\n                    &lt;configuration&gt;\n                        &lt;transformers&gt;\n                            &lt;transformer implementation=&quot;org.apache.maven.plugins.shade.resource.ManifestResourceTransformer&quot;&gt;\n                                &lt;mainClass&gt;com.calculator.Main&lt;/mainClass&gt;\n                            &lt;/transformer&gt;\n                        &lt;/transformers&gt;\n                    &lt;/configuration&gt;\n                &lt;/execution&gt;\n            &lt;/executions&gt;\n        &lt;/plugin&gt;\n\n        &lt;plugin&gt;\n            &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n            &lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt;\n            &lt;version&gt;3.4.1&lt;/version&gt;\n            &lt;executions&gt;\n                &lt;execution&gt;\n                    &lt;phase&gt;package&lt;/phase&gt;\n                    &lt;goals&gt;\n                        &lt;goal&gt;shade&lt;/goal&gt;\n                    &lt;/goals&gt;\n                    &lt;configuration&gt;\n                        &lt;transformers&gt;\n                            &lt;transformer implementation=&quot;org.apache.maven.plugins.shade.resource.ManifestResourceTransformer&quot;&gt;\n                                &lt;mainClass&gt;com.calculator.Main&lt;/mainClass&gt;\n                            &lt;/transformer&gt;\n                        &lt;/transformers&gt;\n                        &lt;filters&gt;\n                            &lt;filter&gt;\n                                &lt;artifact&gt;*:*&lt;/artifact&gt;\n                                &lt;excludes&gt;\n                                    &lt;exclude&gt;META-INF/*.SF&lt;/exclude&gt;\n                                    &lt;exclude&gt;META-INF/*.DSA&lt;/exclude&gt;\n                                    &lt;exclude&gt;META-INF/*.RSA&lt;/exclude&gt;\n                                &lt;/excludes&gt;\n                            &lt;/filter&gt;\n                        &lt;/filters&gt;\n                    &lt;/configuration&gt;\n                &lt;/execution&gt;\n            &lt;/executions&gt;\n        &lt;/plugin&gt;\n    &lt;/plugins&gt;\n&lt;/build&gt;\n</code></pre>\n<p>Then when I run, I get this error:</p>\n<blockquote>\n<p>WARNING: Runtime environment or build system does not support\nmulti-release JARs. This will impact location-based features.\nException in thread &quot;main&quot; java.lang.ExceptionInInitializerError\nat com.calculator.ExpressionEvaluator.(ExpressionEvaluator.java:31)\nat com.calculator.Main.(Main.java:78)\nat com.calculator.Main.main(Main.java:711) Caused by: java.lang.UnsupportedOperationException: No class provided, and an\nappropriate one cannot be found.\nat org.apache.logging.log4j.LogManager.callerClass(LogManager.java:573)\nat org.apache.logging.log4j.LogManager.getLogger(LogManager.java:598)\nat org.apache.logging.log4j.LogManager.getLogger(LogManager.java:585)\nat org.matheclipse.core.eval.ExprEvaluator.(ExprEvaluator.java:136)\n... 3 more</p>\n</blockquote>\n<p>How would I fix my pom.xml to allow my jar file to be run? I don't ever use Log4j2 myself in my code, but I use the Symja API to handle math, which I think uses Log4j2. I couldn't figure out how to remove Log4j2 while getting Symja to still work so I just kept it. When I run my code as a java file, it works perfectly fine but when I try to package it into a jar, it breaks, and I can't run it.</p>\n",
    "tags" : [ "java", "maven", "jar", "log4j", "log4j2" ],
    "owner" : {
      "account_id" : 20562981,
      "reputation" : 67,
      "user_id" : 15093068,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a-/AOh14GifyyjF0x17KUpIsu-JCke86Y3ACul-66aR0mCW-Q=k-s256",
      "display_name" : "Srikar Anumolu",
      "link" : "https://stackoverflow.com/users/15093068/srikar-anumolu"
    },
    "is_answered" : true,
    "view_count" : 222,
    "answer_count" : 2,
    "score" : 1,
    "last_activity_date" : 1746628919,
    "creation_date" : 1746583677,
    "link" : "https://stackoverflow.com/questions/79609706/unable-to-package-log4j2-in-maven-project",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79609925,
    "question_id" : 79609706,
    "body" : "<p>Check the <a href=\"https://stackoverflow.com/questions/79511756/log4j-implementation-not-found-in-fat-jar\">Log4j implementation not found in fat JAR</a> question.\nWhile your symptoms differ, the root cause of both problems is <strong>shading</strong>, which, if done incorrectly, will break the libraries you shade.</p>\n<p>In your particular case your application does not have the <code>Multi-Release: true</code> entry in the manifest, which prevents Log4j API from using the Java 9+ version of <code>StackLocator</code> and causes the appearance of the warning:</p>\n<pre><code>WARNING: Runtime environment or build system does not support multi-release JARs. This will impact location-based features.\n</code></pre>\n<p>and the exception that follows.\nSee our <a href=\"https://logging.apache.org/log4j/2.x/faq.html#single-jar\" rel=\"nofollow noreferrer\">FAQ entry about single-JAR applications</a> for a list of other possible problems with shading.</p>\n<p>Using the <a href=\"https://maven.apache.org/plugins/maven-shade-plugin/\" rel=\"nofollow noreferrer\">Maven Shade Plugin</a> requires knowing a lot of technical details about the libraries you shade. Fortunately there is an alternative: &quot;JAR-in-JAR&quot; packaging allows you to bundle all your dependencies in a single JAR, without breaking the dependency JARs themselves.</p>\n<p>To create a &quot;JAR-in-JAR&quot; archive, you can use for example Spring Boot Maven plugin:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;plugin&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n    &lt;version&gt;3.4.5&lt;/version&gt;\n    &lt;executions&gt;\n        &lt;execution&gt;\n            &lt;goals&gt;\n                &lt;goal&gt;repackage&lt;/goal&gt;\n            &lt;/goals&gt;\n        &lt;/execution&gt;\n    &lt;/executions&gt;\n&lt;/plugin&gt;\n</code></pre>\n",
    "score" : 4,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 16269349,
      "reputation" : 16729,
      "user_id" : 11748454,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/qyBNp.jpg?s=256",
      "display_name" : "Piotr P. Karwasz",
      "link" : "https://stackoverflow.com/users/11748454/piotr-p-karwasz"
    },
    "creation_date" : 1746600579,
    "last_activity_date" : 1746601025,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79609751,
    "question_id" : 79609706,
    "body" : "<p>It looks like you're mixing incompatible dependencies. Try to remove the following from your pom.xml:</p>\n<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n    &lt;artifactId&gt;slf4j-nop&lt;/artifactId&gt;\n    &lt;version&gt;2.0.9&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n    &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;\n    &lt;version&gt;1.7.36&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>And add only Log4j 2.x:</p>\n<pre><code>&lt;dependency&gt;\n   &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;\n   &lt;artifactId&gt;log4j-core&lt;/artifactId&gt;\n   &lt;version&gt;2.21.1&lt;/version&gt;\n   &lt;scope&gt;runtime&lt;/scope&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n   &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;\n   &lt;artifactId&gt;log4j-api&lt;/artifactId&gt;\n    &lt;version&gt;2.21.1&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>Even if you don't use Log4j2 directly, the Symja API depends on it.</p>\n<p>After removing them, rebuild your project with:</p>\n<pre><code>mvn clean package\n</code></pre>\n<p><strong>Update</strong>:\nAs suggested by <a href=\"https://stackoverflow.com/users/11748454/piotr-p-karwasz\">Piotr P. Karwasz</a> in the comments, to future-proof the project and avoid accidental dependency conflicts, you can also add the following to your pom.xml:</p>\n<pre><code>&lt;dependencyManagement&gt;\n    &lt;dependencies&gt;\n        &lt;!-- To lock SLF4J to version 2.x --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n            &lt;artifactId&gt;slf4j-bom&lt;/artifactId&gt;\n            &lt;version&gt;2.0.9&lt;/version&gt;\n            &lt;type&gt;pom&lt;/type&gt;\n            &lt;scope&gt;import&lt;/scope&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n&lt;/dependencyManagement&gt;\n\n</code></pre>\n<p>And add the SLF4J bridge to Log4j 2 for any future libraries that might use SLF4J:</p>\n<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;\n    &lt;artifactId&gt;log4j-slf4j2-impl&lt;/artifactId&gt;\n    &lt;version&gt;2.21.1&lt;/version&gt;\n    &lt;scope&gt;runtime&lt;/scope&gt;\n&lt;/dependency&gt;\n\n</code></pre>\n<p>This way, even if you or a library starts using SLF4J in the future, the logging will automatically go through Log4j 2 without conflicts.</p>\n",
    "score" : 1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 38931631,
      "reputation" : 671,
      "user_id" : 29023248,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/WxoZEuKw.png?s=256",
      "display_name" : "Aleksey Bykov",
      "link" : "https://stackoverflow.com/users/29023248/aleksey-bykov"
    },
    "creation_date" : 1746588660,
    "last_activity_date" : 1746603928,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : {
    "79609751" : [ {
      "comment_id" : 140404930,
      "post_id" : 79609751,
      "body" : "I have tried removing SL4J and adding only Log4j 2.x, but I still get the same error.",
      "score" : 0,
      "owner" : {
        "account_id" : 20562981,
        "reputation" : 67,
        "user_id" : 15093068,
        "user_type" : "registered",
        "profile_image" : "https://lh3.googleusercontent.com/a-/AOh14GifyyjF0x17KUpIsu-JCke86Y3ACul-66aR0mCW-Q=k-s256",
        "display_name" : "Srikar Anumolu",
        "link" : "https://stackoverflow.com/users/15093068/srikar-anumolu"
      },
      "creation_date" : 1746635218,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140402928,
      "post_id" : 79609751,
      "body" : "Thank you, that&#39;s an excellent point! Iâ€™m updating my answer to include your suggestions about using <code>log4j-slf4j2-impl</code>, the SLF4J BOM, and setting <code>log4j-core</code> to runtime scope. This will definitely help future-proof the project. Really appreciate the feedback!",
      "score" : 1,
      "owner" : {
        "account_id" : 38931631,
        "reputation" : 671,
        "user_id" : 29023248,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/WxoZEuKw.png?s=256",
        "display_name" : "Aleksey Bykov",
        "link" : "https://stackoverflow.com/users/29023248/aleksey-bykov"
      },
      "creation_date" : 1746603086,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140402848,
      "post_id" : 79609751,
      "body" : "<i>Nit</i>: <code>log4j-core</code> should be in the <code>runtime</code> scope. This has several advantages: 1. Your code can not depend on a specific implementation of the <a href=\"https://logging.apache.org/log4j/2.x/manual/api.html\" rel=\"nofollow noreferrer\">Log4j API</a>, 2. The IDE does not suggest you to use any classes from Log4j Core.",
      "score" : 1,
      "owner" : {
        "account_id" : 16269349,
        "reputation" : 16729,
        "user_id" : 11748454,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/qyBNp.jpg?s=256",
        "display_name" : "Piotr P. Karwasz",
        "link" : "https://stackoverflow.com/users/11748454/piotr-p-karwasz"
      },
      "creation_date" : 1746601807,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140402835,
      "post_id" : 79609751,
      "body" : "Nice catch! \uD83D\uDCAF Even if the current dependencies do no seem to use SLF4J, to future-proof the project I would add an SLF4J implementation anyway, which requires: 1. Adding <code>log4j-slf4j2-impl</code> to the <code>runtime</code> scope. 2. You also need to add <a href=\"https://mvnrepository.com/artifact/org.slf4j/slf4j-bom/2.0.17\" rel=\"nofollow noreferrer\"><code>slf4j-bom</code></a> to the <code>&lt;dependencyManagement&gt;</code> section to prevent Maven from using version 1.x of the library.",
      "score" : 1,
      "owner" : {
        "account_id" : 16269349,
        "reputation" : 16729,
        "user_id" : 11748454,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/qyBNp.jpg?s=256",
        "display_name" : "Piotr P. Karwasz",
        "link" : "https://stackoverflow.com/users/11748454/piotr-p-karwasz"
      },
      "creation_date" : 1746601623,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}