{
  "question" : {
    "question_id" : 79606130,
    "title" : "LinkedIn Register Upload API — &quot;recipes field required&quot; or &quot;recipe not allowed&quot; even with correct payload",
    "body" : "<p>I'm trying to register an image upload for a LinkedIn post using their /assets?action=registerUpload endpoint. I've followed their documentation to the letter, used both recipes and recipe, tested in Postman and Java (with both Map-based and ObjectNode-based JSON construction), and I either get:</p>\n<ul>\n<li><p>ERROR :: /recipe :: unrecognized field</p>\n</li>\n<li><p>or ERROR :: /recipes :: field is required but not found</p>\n</li>\n</ul>\n<p>Here's the exact payload I'm sending (which matches LinkedIn’s docs and multiple working examples):</p>\n<pre><code>{\n  &quot;registerUploadRequest&quot;: {\n    &quot;owner&quot;: &quot;urn:li:person:&lt;my user id&gt;&quot;,\n    &quot;recipes&quot;: [\n      &quot;urn:li:digitalmediaRecipe:feedshare-image&quot;\n    ],\n    &quot;serviceRelationships&quot;: [\n      {\n        &quot;identifier&quot;: &quot;urn:li:userGeneratedContent&quot;,\n        &quot;relationshipType&quot;: &quot;OWNER&quot;\n      }\n    ],\n    &quot;supportedUploadMechanism&quot;: [\n      &quot;SYNCHRONOUS_UPLOAD&quot;\n    ]\n  }\n}\n</code></pre>\n<p>And here’s the Java code generating it:</p>\n<pre><code>public JsonNode registerUpload(String userUrn, String accessToken, boolean isVideo, Long fileSize) throws Exception {\n\n        System.out.println(accessToken);\n\n        if (isVideo &amp;&amp; (fileSize == null || fileSize &lt;= 0)) {\n            throw new IllegalArgumentException(&quot;File size must be positive for video uploads&quot;);\n        }\n\n        String url = &quot;https://api.linkedin.com/rest/assets?action=registerUpload&quot;;\n\n        // Create the request as a Map structure instead of using JsonNode directly\n        Map&lt;String, Object&gt; registerUploadRequest = new HashMap&lt;&gt;();\n        Map&lt;String, Object&gt; requestBody = new HashMap&lt;&gt;();\n\n        requestBody.put(&quot;owner&quot;, userUrn);\n\n        // Create recipe as a simple List\n        List&lt;String&gt; recipes = new ArrayList&lt;&gt;();\n        recipes.add(isVideo ? &quot;urn:li:digitalmediaRecipe:feedshare-video&quot; : &quot;urn:li:digitalmediaRecipe:feedshare-image&quot;);\n        requestBody.put(&quot;recipes&quot;, recipes);\n\n        if (isVideo) {\n            requestBody.put(&quot;fileSize&quot;, fileSize);\n        }\n\n        // Create supportedUploadMechanism as a simple List\n        List&lt;String&gt; mechanisms = new ArrayList&lt;&gt;();\n        mechanisms.add(&quot;SYNCHRONOUS_UPLOAD&quot;);\n        requestBody.put(&quot;supportedUploadMechanism&quot;, mechanisms);\n\n        // Create serviceRelationships as a List of Maps\n        List&lt;Map&lt;String, String&gt;&gt; relationships = new ArrayList&lt;&gt;();\n        Map&lt;String, String&gt; relationship = new HashMap&lt;&gt;();\n        relationship.put(&quot;relationshipType&quot;, &quot;OWNER&quot;);\n        relationship.put(&quot;identifier&quot;, &quot;urn:li:userGeneratedContent&quot;);\n        relationships.add(relationship);\n        requestBody.put(&quot;serviceRelationships&quot;, relationships);\n\n        // Final payload\n        registerUploadRequest.put(&quot;registerUploadRequest&quot;, requestBody);\n\n        ObjectMapper mapper = new ObjectMapper();\n        String jsonPayload = mapper.writeValueAsString(registerUploadRequest);\n\n        HttpHeaders headers = new HttpHeaders();\n        headers.setBearerAuth(accessToken);\n        headers.setContentType(MediaType.APPLICATION_JSON);\n        headers.add(&quot;LinkedIn-Version&quot;, &quot;202411&quot;);\n\n        System.out.println(jsonPayload);\n\n        HttpEntity&lt;String&gt; request = new HttpEntity&lt;&gt;(jsonPayload, headers);\n        RestTemplate restTemplate = new RestTemplate();\n\n        ResponseEntity&lt;String&gt; response = restTemplate.postForEntity(url, request, String.class);\n        if (!response.getStatusCode().is2xxSuccessful()) {\n            throw new RuntimeException(&quot;LinkedIn upload registration failed: &quot; + response.getBody());\n        }\n\n        return mapper.readTree(response.getBody());\n    }\n</code></pre>\n<p>And yes, I'm using the correct urn:li:person:* owner, valid token, correct scopes, and headers including LinkedIn-Version: 202411.</p>\n<p>I even started testig directly on the API with Postman and nothing got better.</p>\n<p>What doesn’t work:</p>\n<ul>\n<li>Switching between recipe and recipes</li>\n<li>Replacing &quot;SYNCHRONOUS_UPLOAD&quot; with &quot;ASYNC_UPLOAD&quot;</li>\n<li>Removing or adding fileSize</li>\n<li>Switching between Map and structured JSON</li>\n</ul>\n<p>WTF is wrong with this API? Anyone managed to get consistent results with feedshare-image uploads recently?</p>\n",
    "tags" : [ "java", "spring-boot", "linkedin-api" ],
    "owner" : {
      "account_id" : 30348327,
      "reputation" : 1,
      "user_id" : 23257443,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/PIHxn.jpg?s=256",
      "display_name" : "Amir Chebbi",
      "link" : "https://stackoverflow.com/users/23257443/amir-chebbi"
    },
    "is_answered" : false,
    "view_count" : 41,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1746398078,
    "creation_date" : 1746398078,
    "link" : "https://stackoverflow.com/questions/79606130/linkedin-register-upload-api-recipes-field-required-or-recipe-not-allowed",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ ],
  "answer_comments" : { }
}