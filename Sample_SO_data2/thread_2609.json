{
  "question" : {
    "question_id" : 79611095,
    "title" : "JGit RefNotFoundException When Checking Out Branch from Azure DevOps Repository while trying to access the branch",
    "body" : "<p>I'm using JGit to clone and interact with a Git repository hosted on Azure DevOps. My goal is to clone the master branch, checkout to my specified branch (branchName), update the <code>&lt;revision&gt;</code> value from the <code>pom.xml</code> file under the <code>&lt;properties&gt;</code> tag (using <code>pomManipulations.modifyPomFile(pomFilePath)</code>), and then push the updated local branch back to the remote repository of the same branch. While the revision value is fetched correctly, I'm encountering a <code>RefNotFoundException</code> when attempting to check out the branch.</p>\n<p><strong>Issue:</strong> The code successfully clones the repository and fetches the revision value from <code>pom.xml</code>, but when attempting to checkout the master branch, I receive a <code>RefNotFoundException</code>. This suggests that the branch reference cannot be resolved.</p>\n<p><strong>NOTE:</strong> The branch name I'm providing is correct and that branch also exists remotely in AzureDevops.</p>\n<p>Here's the relevant portion of my code:</p>\n<pre class=\"lang-java prettyprint-override\"><code>import org.eclipse.jgit.api.Git;\nimport org.eclipse.jgit.api.errors.GitAPIException;\nimport org.eclipse.jgit.transport.UsernamePasswordCredentialsProvider;\nimport com.fasterxml.jackson.databind.JsonNode;\nimport com.fasterxml.jackson.dataformat.xml.XmlMapper;\nimport java.io.File;\nimport java.io.IOException;\nimport java.nio.file.Files;\nimport java.nio.file.Paths;\n\npublic class AzureDevOpsBranchUpdater {\n\n    private static final String PAT_FILE_PATH = &quot;path/to/pat.txt&quot;; // Update with the correct path\n\n    public String updatePom(String organization, String project, String repositoryName, String branchName, String Id) {\n\n        String repoUrl = &quot;https://dev.azure.com/&quot; + organization + &quot;/&quot; + project + &quot;/_git/&quot; + repositoryName;\n        String localRepoPath = &quot;C:/Users/&quot; + Id + &quot;/AutomatePipeline/&quot; + repositoryName;\n        String pomFilePath = localRepoPath + &quot;/pom.xml&quot;;\n\n        try {\n            // Read the Personal Access Token (PAT)\n            String PAT = Files.readString(Paths.get(PAT_FILE_PATH)).trim();\n\n            // Clone the repository and checkout master\n            Git git = Git.cloneRepository()\n                    .setURI(repoUrl)\n                    .setDirectory(new File(localRepoPath))\n                    .setCredentialsProvider(new UsernamePasswordCredentialsProvider(&quot;&quot;, PAT))\n                    .setBranch(&quot;master&quot;)\n                    .call();\n\n            // Checkout the specified branch\n            git.checkout().setName(branchName).call();\n\n            // Pull the latest changes from master\n            git.fetch().setCredentialsProvider(new UsernamePasswordCredentialsProvider(&quot;&quot;, PAT)).call();\n\n            MergeResult mergeResult = git.merge()\n                    .include(git.getRepository().findRef(&quot;master&quot;))\n                    .call();\n\n            if (!mergeResult.getMergeStatus().isSuccessful()) {\n                return &quot;Merge conflicts occurred: &quot; + mergeResult.getMergeStatus();\n            }\n\n            // Modify the pom.xml file\n            pomManipulations.modifyPomFile(pomFilePath);\n\n            // Commit the changes\n            git.add().addFilepattern(&quot;pom.xml&quot;).call();\n            git.commit().setMessage(&quot;Updated pom.xml&quot;).call();\n\n            // Push the changes to the remote branch\n            git.push().setCredentialsProvider(new UsernamePasswordCredentialsProvider(&quot;&quot;, PAT)).call();\n\n            return &quot;Branch &quot;+ BRANCH +&quot;'s pom.xml updated successfully&quot;;\n\n        } catch (GitAPIException | IOException e) {\n            e.printStackTrace();\n            return &quot;Error: &quot; + e.getMessage();\n        }\n    }\n\n    private String getRevisionFromPom(String pomFilePath) throws IOException {\n        XmlMapper xmlMapper = new XmlMapper();\n        JsonNode root = xmlMapper.readTree(new File(pomFilePath));\n        JsonNode propertiesNode = root.findPath(&quot;properties&quot;);\n        if (propertiesNode.isMissingNode()) {\n            return null; // &lt;properties&gt; tag not found\n        }\n        JsonNode revisionNode = propertiesNode.findPath(&quot;revision&quot;);\n        if (revisionNode.isMissingNode()) {\n            return null; // &lt;revision&gt; tag not found in the &lt;properties&gt; section\n        }\n        return revisionNode.asText(); // Return the revision value\n    }\n}\n\n</code></pre>\n<p>Troubleshooting Steps Taken:</p>\n<ul>\n<li>Verified the branch name and existence in the remote repository.</li>\n<li>Ensured the Personal Access Token (PAT) has necessary permissions.\nChecked network connectivity and repository URL.</li>\n<li>Confirmed Git configurations are correct.</li>\n</ul>\n<p><strong>Question:</strong> What could be causing the <code>RefNotFoundException</code> during the checkout process, and how can I resolve it?</p>\n",
    "tags" : [ "java", "git", "spring-boot", "azure-devops", "git-api" ],
    "owner" : {
      "account_id" : 30677141,
      "reputation" : 9,
      "user_id" : 23518856,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a/ACg8ocJ8ca-M2wxMoUl7-7ZEERhSfbIfKu8dmnSHVJsqJExH=k-s256",
      "display_name" : "Hrishi",
      "link" : "https://stackoverflow.com/users/23518856/hrishi"
    },
    "is_answered" : false,
    "view_count" : 33,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1746639312,
    "creation_date" : 1746638283,
    "link" : "https://stackoverflow.com/questions/79611095/jgit-refnotfoundexception-when-checking-out-branch-from-azure-devops-repository",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140410136,
    "post_id" : 79611095,
    "body" : "Maybe clone the required branch or all branches. See <a href=\"https://archive.eclipse.org/jgit/site/5.4.2.201908231537-r/apidocs/org/eclipse/jgit/api/CloneCommand.html#setCloneAllBranches-boolean-\" rel=\"nofollow noreferrer\">archive.eclipse.org/jgit/site/5.4.2.201908231537-r/apidocs/o&zwnj;&#8203;rg/&hellip;</a>",
    "score" : 0,
    "owner" : {
      "account_id" : 320612,
      "reputation" : 1033,
      "user_id" : 4436450,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/-te9rScaaC0M/AAAAAAAAAAI/AAAAAAAAADo/chh_aFA-6Bc/s256-rj/photo.jpg",
      "display_name" : "Martin Theiss",
      "link" : "https://stackoverflow.com/users/4436450/martin-theiss"
    },
    "creation_date" : 1746776675,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}