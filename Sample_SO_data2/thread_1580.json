{
  "question" : {
    "question_id" : 79696740,
    "title" : "How to download file from a given link without opening the link",
    "body" : "<p>I am currently developing a web application using Vaadin24. I have a link <code>https://mylink.com/package/version</code>. When opening this link, the server will automatically handle the file streaming and make your browser download the correct package with the correct version which is a <code>.zip</code> file. Notice you cannot type the full zip file name in the URL; this is not something I can change.</p>\n<p>Can I make Vaadin open the link to download the package without making a new tab or changing the current tab?</p>\n<p>I have already a way to create the correct URL and I have a button that calls the function <code>private void downloadExistingPackage()</code>.</p>\n",
    "tags" : [ "java", "spring-boot", "vaadin", "vaadin24" ],
    "owner" : {
      "account_id" : 24790476,
      "reputation" : 41,
      "user_id" : 18673488,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/25a01d9a0be0a809903ae4e377d1a762?s=256&d=identicon&r=PG",
      "display_name" : "Nickgismokato",
      "link" : "https://stackoverflow.com/users/18673488/nickgismokato"
    },
    "is_answered" : true,
    "view_count" : 144,
    "closed_date" : 1752154033,
    "answer_count" : 1,
    "score" : 3,
    "last_activity_date" : 1752150721,
    "creation_date" : 1752136319,
    "link" : "https://stackoverflow.com/questions/79696740/how-to-download-file-from-a-given-link-without-opening-the-link",
    "closed_reason" : "Needs details or clarity"
  },
  "answers" : [ {
    "answer_id" : 79697057,
    "question_id" : 79696740,
    "body" : "<p>This is easily done with <code>Anchor</code> component, which represents a simple link <code>&lt;a href=&quot;&quot;&gt;&lt;/a&gt;</code>.</p>\n<h1>External website</h1>\n<pre class=\"lang-java prettyprint-override\"><code>@Route(&quot;&quot;)\npublic class RootPage extends VerticalLayout {\npublic RootPage() {\n    var anchor = new Anchor(&quot;https://your-external-link&quot;, &quot;Download&quot;);\n    add(anchor);\n  }\n}\n</code></pre>\n<h1>Internal resource</h1>\n<p>To download an internal server file, use resource loading. For example, you can use <code>ClassLoader.getSystemResourceAsStream</code>, which seeks files in <code>resources</code> folder in case of a usual Maven Spring Boot project.</p>\n<p>You might use <code>-1</code> for <code>Content-Length</code>, as <code>InputStream</code> can't be used to determine the file size.</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Route(&quot;&quot;)\npublic class RootPage extends VerticalLayout {\n  public RootPage() {\n    var inputStream = ClassLoader.getSystemResourceAsStream(&quot;static/123.txt&quot;);\n\n    var downloadHandler = DownloadHandler.fromInputStream(\n        (DownloadEvent event) -&gt;\n            new DownloadResponse(stream, &quot;your changed name.txt&quot;, &quot;text/plain&quot;, -1));\n\n    var anchor = new Anchor(downloadHandler, &quot;Download&quot;);\n    add(anchor);\n  }\n}\n</code></pre>\n<h1>Bonus: trigger download programatically</h1>\n<p>To trigger download programatically, try using this method with client-side JavaScript:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Route(&quot;&quot;)\npublic class RootPage extends VerticalLayout {\n  public RootPage() {\n    var stream = ClassLoader.getSystemResourceAsStream(&quot;static/123.txt&quot;);\n\n    var downloadHandler = DownloadHandler.fromInputStream(\n        (DownloadEvent event) -&gt;\n            new DownloadResponse(stream, &quot;your file name.txt&quot;, &quot;text/plain&quot;, -1));\n\n    var uuid = UUID.randomUUID().toString();\n\n    var anchor = new Anchor(downloadHandler, &quot;Download&quot;);\n    anchor.getElement().getStyle().setDisplay(Style.Display.NONE);\n    anchor.getElement().setAttribute(&quot;id&quot;, uuid);\n    add(anchor);\n\n    var page = UI.getCurrent().getPage();\n    page.executeJs(&quot;document.getElementById($0).click()&quot;, uuid)\n        .then((JsonValue result) -&gt; remove(anchor));\n  }\n}\n</code></pre>\n<p>Explanation:</p>\n<ul>\n<li><p><code>Style.Display.NONE</code> hides the button from UI, but it would still work programatically;</p>\n</li>\n<li><p><code>anchor.getElement().setAttribute(&quot;id&quot;, uuid)</code> sets a unique ID to the link to reference it by later;</p>\n</li>\n<li><p><code>page.executeJs(...).then(...)</code> executes the client-side JavaScript, <strong>and only then</strong> removes the component from the DOM. This is important, as the client JavaScript is executed asynchronously. It has some performance cost, but it is Vaadin. You already have big performance cost of running a server-side render application.</p>\n</li>\n</ul>\n<hr />\n<p>All above methods don't open new tabs or change the current tab, at least in modern browsers.</p>\n<p>Sources:</p>\n<ul>\n<li><p><a href=\"https://vaadin.com/docs/latest/flow/advanced/downloads;\" rel=\"noreferrer\">https://vaadin.com/docs/latest/flow/advanced/downloads;</a></p>\n</li>\n<li><p><a href=\"https://vaadin.com/docs/latest/styling;\" rel=\"noreferrer\">https://vaadin.com/docs/latest/styling;</a></p>\n</li>\n<li><p><a href=\"https://docs.oracle.com/javase/8/docs/api/java/lang/ClassLoader.html\" rel=\"noreferrer\">https://docs.oracle.com/javase/8/docs/api/java/lang/ClassLoader.html</a>.</p>\n</li>\n</ul>\n",
    "score" : 5,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 40864244,
      "reputation" : 632,
      "user_id" : 30001713,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/f59ea01a76709335047f0cee269d788e?s=256&d=identicon&r=PG",
      "display_name" : "biggujo",
      "link" : "https://stackoverflow.com/users/30001713/biggujo"
    },
    "creation_date" : 1752150721,
    "last_activity_date" : 1752150721,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140580988,
    "post_id" : 79696740,
    "body" : "If you improve your Question, we may re-open it.",
    "score" : 0,
    "owner" : {
      "account_id" : 322981,
      "reputation" : 347089,
      "user_id" : 642706,
      "user_type" : "registered",
      "accept_rate" : 58,
      "profile_image" : "https://i.sstatic.net/ZWEI3.jpg?s=256",
      "display_name" : "Basil Bourque",
      "link" : "https://stackoverflow.com/users/642706/basil-bourque"
    },
    "creation_date" : 1752181262,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140579925,
    "post_id" : 79696740,
    "body" : "Please add the code you have tried and how it failed (e.g. errors, stacktraces, logs, ...) so we can improve on it.",
    "score" : 0,
    "owner" : {
      "account_id" : 3837378,
      "reputation" : 37323,
      "user_id" : 3181392,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/SIgPs.png?s=256",
      "display_name" : "cfrick",
      "link" : "https://stackoverflow.com/users/3181392/cfrick"
    },
    "creation_date" : 1752154050,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140579330,
    "post_id" : 79696740,
    "body" : "My impression from your description is that this is the sort of situation where you would click a download button, the server generates a download link/button that you click and the download starts. It&#39;s a bit hard to give a definite answer without knowing how the target page works, but you could use a headless browser to automate the interaction with the page, download the file and then stream it to the user like you would any other file that is on the server machine. I&#39;m not sure vaadin can do this but Selenium should be a tool worth investigating for this.",
    "score" : 0,
    "owner" : {
      "account_id" : 45213,
      "reputation" : 27280,
      "user_id" : 133203,
      "user_type" : "registered",
      "accept_rate" : 97,
      "profile_image" : "https://i.sstatic.net/Fp3hB.jpg?s=256",
      "display_name" : "Federico klez Culloca",
      "link" : "https://stackoverflow.com/users/133203/federico-klez-culloca"
    },
    "creation_date" : 1752140724,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140579246,
    "post_id" : 79696740,
    "body" : "You are asking how to solve something in code without showing the code. There are many ways to trigger downloads... show yours. The problems you describe would make me think you are using an unorthodox method, it should &quot;just work&quot; without fuss.",
    "score" : 2,
    "owner" : {
      "account_id" : 187094,
      "reputation" : 5301,
      "user_id" : 424903,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/8oHZF.png?s=256",
      "display_name" : "Gimby",
      "link" : "https://stackoverflow.com/users/424903/gimby"
    },
    "creation_date" : 1752139165,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140579222,
    "post_id" : 79696740,
    "body" : "Modern browsers should not replace the current document, if the response the requested URL gives is not &quot;displayable&quot;, but triggers the download dialog. So what happens, when you simply create a link to it, using the Anchor class with the <code>Anchor(String href, String text)</code> signature?",
    "score" : 0,
    "owner" : {
      "account_id" : 1530592,
      "reputation" : 97801,
      "user_id" : 1427878,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/f6bd890954a792dbee22792c2402f13a?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "C3roe",
      "link" : "https://stackoverflow.com/users/1427878/c3roe"
    },
    "creation_date" : 1752138644,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140579195,
    "post_id" : 79696740,
    "body" : "Sir. My code already generate the link. I have the link. But, and this is where you should read carefully, I have no idea how to make vaadin open a link to download a file without making it open a new tab or change the current tab. I am asking for if such a functionality exists. I can already make it open a tab with the link to download. I cannot give you a minimal example, because I don&#39;t know if such a thing exists.  Again. My question is not how I make Vaadin open a link. It is how to make it open a link without changing website or open a new tab....",
    "score" : 0,
    "owner" : {
      "account_id" : 24790476,
      "reputation" : 41,
      "user_id" : 18673488,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/25a01d9a0be0a809903ae4e377d1a762?s=256&d=identicon&r=PG",
      "display_name" : "Nickgismokato",
      "link" : "https://stackoverflow.com/users/18673488/nickgismokato"
    },
    "creation_date" : 1752138020,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140579154,
    "post_id" : 79696740,
    "body" : "Becauce all the packages is in a table. I can then press a specific package/version and then press the universal downlaod button that takes the active element and parse the data to create a link. And not all packages have a valid link anymore since they have been deprecated but still need to be shown.  To be more specific. All packages metadata is on a seperate metadatabase which I download from. So to generate the URL, I need the data from the metadatabase which is a dynamic link. This is done with an algorithm. I don&#39;t want to generate 2000+ link everytime the website updates. Only once.",
    "score" : 0,
    "owner" : {
      "account_id" : 24790476,
      "reputation" : 41,
      "user_id" : 18673488,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/25a01d9a0be0a809903ae4e377d1a762?s=256&d=identicon&r=PG",
      "display_name" : "Nickgismokato",
      "link" : "https://stackoverflow.com/users/18673488/nickgismokato"
    },
    "creation_date" : 1752137243,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140579135,
    "post_id" : 79696740,
    "body" : "If you already have the URL, then why are you creating a button that invokes some method; why do you not just create an <code>Anchor</code> pointing to that URL?",
    "score" : 0,
    "owner" : {
      "account_id" : 1530592,
      "reputation" : 97801,
      "user_id" : 1427878,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/f6bd890954a792dbee22792c2402f13a?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "C3roe",
      "link" : "https://stackoverflow.com/users/1427878/c3roe"
    },
    "creation_date" : 1752136819,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79697057" : [ {
      "comment_id" : 140599325,
      "post_id" : 79697057,
      "body" : "It is also possible without using id: <code>UI.getCurrent().getPage().executeJs(&quot;$0.click()&quot;, getElement());</code> <code>getElement()</code> is called on an <code>Anchor</code> instance.",
      "score" : 1,
      "owner" : {
        "account_id" : 14571259,
        "reputation" : 1186,
        "user_id" : 10524503,
        "user_type" : "registered",
        "profile_image" : "https://lh4.googleusercontent.com/-TTMbFydM2wc/AAAAAAAAAAI/AAAAAAAAIbU/tMY5KezwBbg/s256-rj/photo.jpg",
        "display_name" : "MarekChr",
        "link" : "https://stackoverflow.com/users/10524503/marekchr"
      },
      "creation_date" : 1752827902,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}