{
  "question" : {
    "question_id" : 79844408,
    "title" : "Java JNI cmake issue",
    "body" : "<p>I have a simple Java program that calls a native method, which in turn calls <code>std::cout</code>.<br />\nI compile it with:</p>\n<pre class=\"lang-bash prettyprint-override\"><code>clang -I $ENV:JAVA_HOME\\include -I $ENV:JAVA_HOME\\include\\win32 .\\Main.c -o Main.o\nclang -shared -o Main.dll .\\Main.o\n</code></pre>\n<p>Compiled this way, it works correctly and no errors occur.</p>\n<p>However, I also use CMake for code compiling.<br />\nMy <code>CMakeLists.txt</code> is as follows:</p>\n<pre class=\"lang-none prettyprint-override\"><code>cmake_minimum_required(VERSION 4.0)\nproject(something CXX)\n\nset(CMAKE_CXX_STANDARD 14)\nset(CMAKE_C_STANDARD 11)\nset(CMAKE_BUILD_TYPE RELEASE)\nset(LIBRARY_OUTPUT_PATH &quot;${PROJECT_SOURCE_DIR}/mylib&quot;)\nset(CMAKE_RUNTIME_OUTPUT_DIRECTORY &quot;${PROJECT_SOURCE_DIR}/mylib&quot;)\nset(CMAKE_ARCHIVE_OUTPUT_DIRECTORY &quot;${PROJECT_SOURCE_DIR}/mylib&quot;)\n\ninclude_directories(build)\ninclude_directories(build/generated)\ninclude_directories(build/generated/sources)\ninclude_directories(build/generated/sources/headers)\ninclude_directories(build/generated/sources/headers/java)\ninclude_directories(build/generated/sources/headers/java/main)\ninclude_directories($ENV{JAVA_HOME}/include)\ninclude_directories($ENV{JAVA_HOME}/include/win32)\n\nadd_library(something SHARED\n        build/generated/sources/headers/java/main/org_qmained_Main.h\n        something.cpp)\n</code></pre>\n<p>It works correctly when no &quot;external&quot; library is used.<br />\n<code>stdio.h</code> functions like <code>printf</code> work, but it fails on <code>std::vector</code> or <code>std::cout</code> with the error:</p>\n<blockquote>\n<p>The specified procedure could not be found</p>\n</blockquote>\n<p>What can be a reason for this error?</p>\n<p>UPD: Found out a reason of this bug. My MinGW path was under some other paths. I moved the MinGW g++ at the very top of my path environment variable, the error was fixed.</p>\n",
    "tags" : [ "java", "c++", "cmake", "java-native-interface" ],
    "owner" : {
      "account_id" : 27893852,
      "reputation" : 1,
      "user_id" : 21299610,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/f7156a4e8e963fcb6845d19e5147ce5c?s=256&d=identicon&r=PG",
      "display_name" : "qmained",
      "link" : "https://stackoverflow.com/users/21299610/qmained"
    },
    "is_answered" : false,
    "view_count" : 75,
    "closed_date" : 1765532045,
    "answer_count" : 0,
    "score" : -1,
    "last_activity_date" : 1765577328,
    "creation_date" : 1765491464,
    "link" : "https://stackoverflow.com/questions/79844408/java-jni-cmake-issue",
    "closed_reason" : "Not suitable for this site"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140899320,
    "post_id" : 79844408,
    "body" : "Please do not use <code>include_directories</code> it is available to maintain backward comparability and should not be used in modern cmake. Now use of <code>target_include_directories</code> is recommended.",
    "score" : 0,
    "owner" : {
      "account_id" : 1477351,
      "reputation" : 40406,
      "user_id" : 1387438,
      "user_type" : "registered",
      "accept_rate" : 68,
      "profile_image" : "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=256&d=identicon&r=PG",
      "display_name" : "Marek R",
      "link" : "https://stackoverflow.com/users/1387438/marek-r"
    },
    "creation_date" : 1765531729,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140899316,
    "post_id" : 79844408,
    "body" : "I see <code>Main.c</code> in manual compilation, but not in <code>CMakeLists.txt</code> file. Also file is has <code>.c</code> extension (so compiler will treat this as C code) and you are complaining about c++ features.",
    "score" : 0,
    "owner" : {
      "account_id" : 1477351,
      "reputation" : 40406,
      "user_id" : 1387438,
      "user_type" : "registered",
      "accept_rate" : 68,
      "profile_image" : "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=256&d=identicon&r=PG",
      "display_name" : "Marek R",
      "link" : "https://stackoverflow.com/users/1387438/marek-r"
    },
    "creation_date" : 1765531549,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140898979,
    "post_id" : 79844408,
    "body" : "The source compiled at the command line is a .c file and cmake uses a .cpp file? Use the same source file for both cases and share the c, c++ and Java sources for a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.",
    "score" : 1,
    "owner" : {
      "account_id" : 372682,
      "reputation" : 26512,
      "user_id" : 721855,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/vZiox.png?s=256",
      "display_name" : "aled",
      "link" : "https://stackoverflow.com/users/721855/aled"
    },
    "creation_date" : 1765511842,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140898977,
    "post_id" : 79844408,
    "body" : "Is the error happening at execution time or compilation time? If at execution, share the full error and stacktrace and a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.",
    "score" : 0,
    "owner" : {
      "account_id" : 372682,
      "reputation" : 26512,
      "user_id" : 721855,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/vZiox.png?s=256",
      "display_name" : "aled",
      "link" : "https://stackoverflow.com/users/721855/aled"
    },
    "creation_date" : 1765511669,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140898851,
    "post_id" : 79844408,
    "body" : "It may be missing some Microsoft Visual C++ Redistributable.",
    "score" : 1,
    "owner" : {
      "account_id" : 9067781,
      "reputation" : 43434,
      "user_id" : 6752050,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/7kSR8.png?s=256",
      "display_name" : "3CEZVQ",
      "link" : "https://stackoverflow.com/users/6752050/3cezvq"
    },
    "creation_date" : 1765497581,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}