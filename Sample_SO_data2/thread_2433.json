{
  "question" : {
    "question_id" : 79623098,
    "title" : "ClassCastException with simple-jndi",
    "body" : "<p>I'm using simple-jndi 0.25. I've got the following file <code>jdbc/RCVCERMAPB/EnregistrementTracesApplicatives/default.properties</code></p>\n<p><code>default.properties</code> contains:</p>\n<pre class=\"lang-ini prettyprint-override\"><code>type=javax.sql.DataSource\ndriver=org.postgresql.Driver\nurl=jdbc:postgresql://172.25.94.30:5432/rspdb3\nuser=rcvcermapb_traceappli\npassword=rcvcermapb_traceappli\n</code></pre>\n<p>In the code, I call:</p>\n<pre class=\"lang-java prettyprint-override\"><code>final DataSource dataSourceTA = (DataSource) GestionnaireConnexionJndi.getInstance()\n        .rechercherObjet( &quot;jdbc/RCVCERMAPB/EnregistrementTracesApplicatives&quot; );\n</code></pre>\n<p>which calls</p>\n<pre class=\"lang-java prettyprint-override\"><code>Object objetObtenu = contexte.lookup(&quot;jdbc/RCVCERMAPB/EnregistrementTracesApplicatives&quot;);\n</code></pre>\n<p>I get the following error:</p>\n<blockquote>\n<p>Exception in thread &quot;main&quot; java.lang.ClassCastException: class org.osjava.sj.jndi.MemoryContext cannot be cast to class javax.sql.DataSource (org.osjava.sj.jndi.MemoryContext is in unnamed module of loader 'app'; javax.sql.DataSource is in module java.sql of loader 'platform')</p>\n</blockquote>\n<p>What causes this and how do I fix it?</p>\n",
    "tags" : [ "java", "jndi" ],
    "owner" : {
      "account_id" : 488295,
      "reputation" : 21,
      "user_id" : 8894339,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/02c11d59fea7db9dc0d2828570585aa6?s=256&d=identicon&r=PG",
      "display_name" : "Alain Michel",
      "link" : "https://stackoverflow.com/users/8894339/alain-michel"
    },
    "is_answered" : true,
    "view_count" : 71,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1747392975,
    "creation_date" : 1747304169,
    "link" : "https://stackoverflow.com/questions/79623098/classcastexception-with-simple-jndi",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79624918,
    "question_id" : 79623098,
    "body" : "<p>I've found the problem.</p>\n<p>When I debug context.lookup() from</p>\n<pre><code>DataSource ds = (DataSource)context.lookup(&quot;jdbc/RCVCERMAPB/EnregistrementTracesApplicatives&quot;);\n</code></pre>\n<p>I get:</p>\n<pre><code>MemoryContext{namesToObjects={default=org.postgresql.Driver::::jdbc:postgresql://172.25.94.30:5432/rspdb3::::rcvcermapb_traceappli}, subContexts={}, env={org.osjava.sj.jndi.shared=true, org.osjava.sj.root=src/main/resources/jndi/, java.naming.factory.initial=org.osjava.sj.MemoryContextFactory, org.osjava.sj.delimiter=/, jndi.syntax.separator=/, jndi.syntax.direction=left_to_right, org.osjava.sj.factory=org.osjava.sj.MemoryContextFactory}, nameParser=org.osjava.sj.jndi.SimpleNameParser@dbd940d, nameInNamespace=jdbc/RCVCERMAPB/EnregistrementTracesApplicatives, nameLock=true}\n</code></pre>\n<p>The datasource has the name default.</p>\n<p>So I need to do a<br />\n<code>context.lookup(&quot;jdbc/RCVCERMAPB/EnregistrementTracesApplicatives/default&quot;)</code><br />\nto get it</p>\n<p>or define my datasource in <code>jdbc/RCVCERMAPB/EnregistrementTracesApplicatives.properties</code> rather than <code>jdbc/RCVCERMAPB/EnregistrementTracesApplicatives/default.properties</code></p>\n<p>It works fine this way.</p>\n<p>Thanks to those who read my question and also to <a href=\"https://stackoverflow.com/users/466862/mark-rotteveel\">Mark Rotteveel</a> for the editting.</p>\n",
    "score" : 1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 488295,
      "reputation" : 21,
      "user_id" : 8894339,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/02c11d59fea7db9dc0d2828570585aa6?s=256&d=identicon&r=PG",
      "display_name" : "Alain Michel",
      "link" : "https://stackoverflow.com/users/8894339/alain-michel"
    },
    "creation_date" : 1747388634,
    "last_activity_date" : 1747392975,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140428296,
    "post_id" : 79623098,
    "body" : "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.",
    "score" : 1,
    "owner" : {
      "account_id" : 213468,
      "reputation" : 110280,
      "user_id" : 466862,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=256&d=identicon&r=PG",
      "display_name" : "Mark Rotteveel",
      "link" : "https://stackoverflow.com/users/466862/mark-rotteveel"
    },
    "creation_date" : 1747305599,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}