{
  "question" : {
    "question_id" : 79824517,
    "title" : "Best way to merge Keycloak data and Application data",
    "body" : "<p>I’m developing an application in which login and roles are entirely handled by Keycloak. My Java backend has an application database that also contains additional user business data. I’ve been asked to retrieve all users registered in the application based on their roles. The problem is that only Keycloak knows the roles, while I normally handle pagination on the database side.<br />\nWhat would be the best practice to efficiently achieve this goal?<br />\nCurrently, I'm loading all user data from the database (filtering by other parameters I have in the DB, though it could be all of them), mapping their roles one by one, removing the roles I'm not interested in, and then paginating the remaining users.</p>\n",
    "tags" : [ "java", "hibernate", "keycloak" ],
    "owner" : {
      "account_id" : 11845933,
      "reputation" : 51,
      "user_id" : 8668467,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/041a22963a94cc64c8db207e3e2cacd4?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Ixiodor",
      "link" : "https://stackoverflow.com/users/8668467/ixiodor"
    },
    "is_answered" : false,
    "view_count" : 50,
    "answer_count" : 2,
    "score" : 0,
    "last_activity_date" : 1763562237,
    "creation_date" : 1763559700,
    "link" : "https://stackoverflow.com/questions/79824517/best-way-to-merge-keycloak-data-and-application-data",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79824549,
    "question_id" : 79824517,
    "body" : "<p>Maybe invert that approach:</p>\n<ul>\n<li><a href=\"https://www.baeldung.com/java-keycloak-search-users#5-search-by-role\" rel=\"nofollow noreferrer\">find all users with the role</a></li>\n<li>then query the DB for the additional user details.</li>\n</ul>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 8909811,
      "reputation" : 2861,
      "user_id" : 6650475,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/fe85994d05ad7aaaa1c47d638b37bc45?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Andrew S",
      "link" : "https://stackoverflow.com/users/6650475/andrew-s"
    },
    "creation_date" : 1763561412,
    "last_activity_date" : 1763561412,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79824567,
    "question_id" : 79824517,
    "body" : "<p>I was probably not specific enough in describing the problem. They might also want to filter by properties that are not roles but business-related attributes. The issue is that the filtering criteria could be a mix of business data and Keycloak data.</p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 11845933,
      "reputation" : 51,
      "user_id" : 8668467,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/041a22963a94cc64c8db207e3e2cacd4?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Ixiodor",
      "link" : "https://stackoverflow.com/users/8668467/ixiodor"
    },
    "creation_date" : 1763562237,
    "last_activity_date" : 1763562237,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : {
    "79824567" : [ {
      "comment_id" : 140863357,
      "post_id" : 79824567,
      "body" : "Instead of posting something like this as an answer, consider editing your original question",
      "score" : 0,
      "owner" : {
        "account_id" : 22627540,
        "reputation" : 1209,
        "user_id" : 16805423,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/LA3Jp.jpg?s=256",
        "display_name" : "Brentspine",
        "link" : "https://stackoverflow.com/users/16805423/brentspine"
      },
      "creation_date" : 1763595752,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}