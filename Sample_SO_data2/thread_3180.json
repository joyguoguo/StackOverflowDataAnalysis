{
  "question" : {
    "question_id" : 79568868,
    "title" : "Why are you allowed to assign a field to itself?",
    "body" : "<p>I've been coding in Java since 2005 and never thought that the code like that would actually be compilable:</p>\n<pre><code>public class FooClass {\n\n    public static final String FOO = FooClass.FOO;\n\n}\n</code></pre>\n<p>Intellij IDEA calls it &quot;initialized with self assignment&quot;.\nIf someone showed me this code and asked whether it will compile or not, I would be 100% sure it should be a compilation error, as the variable was not actually explicitly assigned to any value.</p>\n<p>I am bit shocked, because even such a nonsense as below appears to be legit:</p>\n<pre><code>public class FooClass {\n    public static final String FOO_1 = FooClass.FOO_2;\n    public static final String FOO_2 = FooClass.FOO_1;\n}\n</code></pre>\n<p>No brainer, that such a variable appear to contain <code>null</code> value effectively. But Gosh, why?</p>\n<p>I bumped into this piece of code in my project, because it was source of a bug. Someone did a refactoring and replaced the actual string constant with this self reference. Convince me that this is not a Java language bug, because otherwise it is a nasty way to shoot oneself in the foot!</p>\n<p><strong>UPD:</strong> I tested it on Java 21 only.</p>\n",
    "tags" : [ "java", "compilation", "specifications", "java-21" ],
    "owner" : {
      "account_id" : 1597725,
      "reputation" : 35171,
      "user_id" : 1479414,
      "user_type" : "registered",
      "accept_rate" : 71,
      "profile_image" : "https://www.gravatar.com/avatar/c286de045787a6dc24c3afb97ec23ce1?s=256&d=identicon&r=PG",
      "display_name" : "Andremoniy",
      "link" : "https://stackoverflow.com/users/1479414/andremoniy"
    },
    "is_answered" : true,
    "view_count" : 244,
    "answer_count" : 1,
    "score" : 6,
    "last_activity_date" : 1744886139,
    "creation_date" : 1744375225,
    "link" : "https://stackoverflow.com/questions/79568868/why-are-you-allowed-to-assign-a-field-to-itself",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79579020,
    "question_id" : 79568868,
    "body" : "<p>The point is that static variables are first created all at once, <strong>and then</strong> initialized.\nAt creation they are set to default value of their type. Initialization takes place in encountered textual order.</p>\n<p>At least JLS 21 says:</p>\n<blockquote>\n<p><strong>4.12.5 Initial Values of Variables</strong></p>\n<p>Every variable in a program must have a value before its value is used:</p>\n<p>• Each class variable, instance variable, or array component is initialized with a</p>\n<p><em>default value</em> when it is created (§15.9, §15.10.2):</p>\n<p>[...]</p>\n<p>– For all reference types (§4.3), the default value is null.</p>\n</blockquote>\n<blockquote>\n<p><strong>8.3.2 Field Initialization</strong></p>\n</blockquote>\n<blockquote>\n<p>If a declarator in a field declaration has a variable initializer, then the declarator\nhas the semantics of an assignment (§15.26) to the declared variable.</p>\n<p>If the declarator is for a class variable (that is, a static field) (§8.3.1.1), then the\nfollowing rules apply to its initializer:</p>\n<p>[...]</p>\n<ul>\n<li>At run time, the initializer is evaluated and the assignment performed exactly\nonce, when the class is initialized (§12.4.2).</li>\n</ul>\n</blockquote>\n<blockquote>\n<p><strong>12.3.2 Preparation of a Class or Interface</strong></p>\n<p>Preparation involves creating the static fields (class variables and constants) for\na class or interface and initializing such fields to the default values (§4.12.5). This\ndoes not require the execution of any source code; explicit initializers for static\nfields are executed as part of initialization (§12.4), not preparation.</p>\n<p><strong>12.4.2 Detailed Initialization Procedure</strong></p>\n<ol start=\"9\">\n<li>Next, execute either the class variable initializers and static initializers of the\nclass, or the field initializers of the interface, in textual order, as though they\nwere a single block.</li>\n</ol>\n</blockquote>\n<p>You can also try:</p>\n<pre><code>public class Main { \n    static final int i = Main.i+1;\n}\n</code></pre>\n<p>which is perfectly legal.</p>\n<p>That one will show you that the described process takes place effectively:</p>\n<pre><code>public class Main {\n    public static final String FOO_1 = Main.FOO_2+&quot;Foo&quot;;\n    public static final String FOO_2 = Main.FOO_1+&quot;Bar&quot;;\n}\n\n</code></pre>\n",
    "score" : 1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 370994,
      "reputation" : 36649,
      "user_id" : 719263,
      "user_type" : "registered",
      "accept_rate" : 100,
      "profile_image" : "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=256&d=identicon&r=PG",
      "display_name" : "Jean-Baptiste Yun&#232;s",
      "link" : "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"
    },
    "creation_date" : 1744885257,
    "last_activity_date" : 1744886139,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140362194,
    "post_id" : 79568868,
    "body" : "A thought experiment: <i>WHY</i> are you so sure this should be a compilation error?  It seems your reasoning is &quot;anything that let&#39;s users shoot their feet is a language bug&quot;.  But, not only is it almost impossible to reliably forbid &quot;all the code that someone thinks should obviously be an error&quot;, if a language tried to do this, I think you would not enjoy programming in that language.  There would be so many ad-hoc rules and restrictions that you would (rightly) say &quot;no one can keep this in their head.&quot;  And there would still be infinitely many things to complain that the language doesn&#39;t forbid.",
    "score" : 2,
    "owner" : {
      "account_id" : 1416522,
      "reputation" : 96421,
      "user_id" : 3553087,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/Q2cTS.gif?s=256",
      "display_name" : "Brian Goetz",
      "link" : "https://stackoverflow.com/users/3553087/brian-goetz"
    },
    "creation_date" : 1745423500,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140326039,
    "post_id" : 79568868,
    "body" : "Java goes to some length to forbid meaningless code. And your code is meaningless alright. But it’s hard to make a simple rule for how to distinguish your code from meaningful code. So it’s good that IDEs warn you, and the best we can do is take such warnings seriously.",
    "score" : 2,
    "owner" : {
      "account_id" : 7612423,
      "reputation" : 87409,
      "user_id" : 5772882,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/8283c64511fa80afed5259d10850168f?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Anonymous",
      "link" : "https://stackoverflow.com/users/5772882/anonymous"
    },
    "creation_date" : 1744400896,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140325608,
    "post_id" : 79568868,
    "body" : "The behavior is based on <a href=\"https://docs.oracle.com/javase/specs/jls/se24/html/jls-16.html\" rel=\"nofollow noreferrer\">the following definition (JLS &#167;16)</a>: “<i>An access to its value consists of the simple name of the variable (or, for a field, the simple name of the field qualified by this)…</i>” and <code>FooClass.FOO</code> is neither a simple name nor qualified with <code>this</code>. Hence, it’s not an access in the sense of the remainder of the section which restricts the matching accesses to be only allowed when the variable is definitely assigned.",
    "score" : 6,
    "owner" : {
      "account_id" : 3211603,
      "reputation" : 301001,
      "user_id" : 2711488,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/t2hoD.jpg?s=256",
      "display_name" : "Holger",
      "link" : "https://stackoverflow.com/users/2711488/holger"
    },
    "creation_date" : 1744392536,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140325567,
    "post_id" : 79568868,
    "body" : "By using a qualified access (<code>FooClass.FOO</code>), you’re disabling the initialized check. Had you written <code>FOO = FOO</code> you would have received the compiler error.",
    "score" : 2,
    "owner" : {
      "account_id" : 3211603,
      "reputation" : 301001,
      "user_id" : 2711488,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/t2hoD.jpg?s=256",
      "display_name" : "Holger",
      "link" : "https://stackoverflow.com/users/2711488/holger"
    },
    "creation_date" : 1744391884,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140324943,
    "post_id" : 79568868,
    "body" : "Are you asking about any field or variable (<code>x = x</code>) or specifically because this one is <code>static</code> and <code>final</code> (and accessed through a qualified name)?",
    "score" : 0,
    "owner" : {
      "account_id" : 195331,
      "reputation" : 281049,
      "user_id" : 438154,
      "user_type" : "registered",
      "accept_rate" : 98,
      "profile_image" : "https://www.gravatar.com/avatar/4ec21df1e55febf8deb2e3b24b9cb39b?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Sotirios Delimanolis",
      "link" : "https://stackoverflow.com/users/438154/sotirios-delimanolis"
    },
    "creation_date" : 1744382915,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140324720,
    "post_id" : 79568868,
    "body" : "&quot;Convince me this is not a java bug&quot;: The JLS is the specification that <code>javac</code> must adhere to. If it does it is therefore not a bug. And the JLS indeed says this is right. I assume what you&#39;re <i>actually</i> asking is: Make this bizarre rule in the JLS make sense. Which is inherently tricky; SO doesn&#39;t &quot;like&quot; opion, and the JLS as a rule does not state the underlying design principles for its choices. Since ~10 years ago most debate is held out in the open on the various openjdk mailing lists, but this choice predates it. I have a pretty good answer for you, but, question&#39;s closed.",
    "score" : 0,
    "owner" : {
      "account_id" : 401843,
      "reputation" : 107206,
      "user_id" : 768644,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/b13bedc5215730fbce5edff6c130988a?s=256&d=identicon&r=PG",
      "display_name" : "rzwitserloot",
      "link" : "https://stackoverflow.com/users/768644/rzwitserloot"
    },
    "creation_date" : 1744379511,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140324711,
    "post_id" : 79568868,
    "body" : "Well this compiles because the JLS doesn&#39;t say it won&#39;t compile. You can go through the specification and see that this does not contradict everything that says. The field having the value of <code>null</code> is also correct, according to the JLS.  What are you expecting as an answer here?",
    "score" : 0,
    "owner" : {
      "account_id" : 6651855,
      "reputation" : 292280,
      "user_id" : 5133585,
      "user_type" : "registered",
      "accept_rate" : 96,
      "profile_image" : "https://i.sstatic.net/dfqcw.png?s=256",
      "display_name" : "Sweeper",
      "link" : "https://stackoverflow.com/users/5133585/sweeper"
    },
    "creation_date" : 1744379362,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140324512,
    "post_id" : 79568868,
    "body" : "Eclipse says &quot;The assignment to variable FOO has no effect&quot; (just a warning)",
    "score" : 0,
    "owner" : {
      "account_id" : 3159259,
      "reputation" : 111562,
      "user_id" : 2670892,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/4iPV5.png?s=256",
      "display_name" : "greg-449",
      "link" : "https://stackoverflow.com/users/2670892/greg-449"
    },
    "creation_date" : 1744375875,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}