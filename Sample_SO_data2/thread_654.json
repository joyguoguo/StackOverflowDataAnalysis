{
  "question" : {
    "question_id" : 79789490,
    "title" : "Hibernate (5.3.3.Final) + Redisson (3.17.7) in a SBT project isn&#39;t evicting the cache from redis based on configured TTL",
    "body" : "<p>I am using a java-scala project and have configured the RedissonClient programmatically:</p>\n<pre><code>public class RedissonConfigurationFactory extends RedissonRegionFactory{\n\nprivate static RedissonClient redisson;\n\n@SuppressWarnings({&quot;rawtypes&quot;, &quot;unchecked&quot;})\n@OverRide\nprotected RedissonClient createRedissonClient(Map properties) {\nif (redisson == null) {\nConfig config = new Config();\nString redisHost = System.getenv().getOrDefault(&quot;REDIS_HOST&quot;, &quot;localhost&quot;);\nString redisPort = System.getenv().getOrDefault(&quot;REDIS_PORT&quot;, &quot;6379&quot;);\nString redisPassword = System.getenv(&quot;REDIS_PASSWORD&quot;);\n\n  config.setCodec(new SerializationCodec());\n\n  config.useSingleServer()\n    .setAddress(&quot;redis://&quot; + redisHost + &quot;:&quot; + redisPort)\n    .setPassword(redisPassword)\n    .setDatabase(0)\n    .setConnectionPoolSize(64)\n    .setTimeout(3000)\n    .setRetryAttempts(3)\n    .setRetryInterval(1500);\n\n  redisson = Redisson.create(config);\n\n}\nreturn redisson;\n}\n\n}\n</code></pre>\n<p>And configured this class in hibernate.cfg.xml:</p>\n<pre><code>&lt;property name=&quot;hibernate.cache.region.factory_class&quot;&gt;\n  RedissonConfigurationFactory\n&lt;/property&gt;\n&lt;property name=&quot;hibernate.cache.redisson.my_region.eviction.max_entries&quot;&gt;2&lt;/property&gt;\n&lt;property name=&quot;hibernate.cache.redisson.my_region.expiration.time_to_live&quot;&gt;5000&lt;/property&gt; \n&lt;property name=&quot;hibernate.cache.redisson.my_region.localcache.eviction_policy&quot;&gt;LRU&lt;/property&gt;\n\n</code></pre>\n<p>This is my entity class:</p>\n<pre><code>@org.hibernate.annotations.Cache(usage = org.hibernate.annotations.CacheConcurrencyStrategy.READ_WRITE, region = &quot;my_region&quot;)\npublic class EntityClass{}\n</code></pre>\n<p>Even after configuring this time_to_live property on a region, the cache entry is not getting removed from the redis cache.\nI verified this using RedisInsights GUI as well, there also corresponding to this &quot;Hash&quot; key TTL is set to No limit.</p>\n<p>When checked redisson MapCacheEvictionTask logs, there also I am getting below log statement for the region even after the time_to_live time has passed:</p>\n<p>&quot;loggerName&quot;:&quot;org.redisson.eviction.MapCacheEvictionTask&quot;,&quot;message&quot;:&quot;0 elements evicted. Object name: EntityClass&quot;</p>\n<p>Essentially when TTL has passed, the call to DB should have been made which is not visible in logs and everytime it is getting picked from cache itself. Not eviction can cause redis server memory to increase indefinitely until removed or freed manually.</p>\n<p>Why this TTL property might not be getting applied in redisson?</p>\n",
    "tags" : [ "java", "hibernate", "caching", "redis", "redisson" ],
    "owner" : {
      "account_id" : 20607714,
      "reputation" : 11,
      "user_id" : 15127557,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/ZZWXF.jpg?s=256",
      "display_name" : "Vishal Dubey",
      "link" : "https://stackoverflow.com/users/15127557/vishal-dubey"
    },
    "is_answered" : false,
    "view_count" : 29,
    "answer_count" : 0,
    "score" : 1,
    "last_activity_date" : 1760375009,
    "creation_date" : 1760375009,
    "link" : "https://stackoverflow.com/questions/79789490/hibernate-5-3-3-final-redisson-3-17-7-in-a-sbt-project-isnt-evicting-the",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ ],
  "answer_comments" : { }
}