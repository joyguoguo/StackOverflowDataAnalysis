{
  "question" : {
    "question_id" : 79652661,
    "title" : "Spring Boot Integration Tests without MBean Server",
    "body" : "<p>Running Integration Tests with Maven verify (./mvnw verify) fails using the Spring Boot Maven Plugin.</p>\n<p>Spring Boot 3.4.6\nJava 21</p>\n<p>This fails because it relies on an MBean Server running.</p>\n<pre><code>[ERROR] Failed to execute goal org.springframework.boot:spring-boot-maven-plugin:3.4.2:start (pre-integration-test) on project application-name: Failed to connect to MBean server at port 9001: Could not invoke shutdown operation: Connection refused to host: 127.0.0.1; nested exception is:\n[ERROR]         java.net.ConnectException: Connection refused: connect\n[ERROR] -&gt; [Help 1]\n</code></pre>\n<p>I am using the pre and post executions on the <code>spring-boot-maven-plugin</code>, since <code>springdoc-openapi-maven-plugin</code> needs it to generate the openapi.json.</p>\n<p>Is there any way to avoid it to rely on an MBean server?<br />\nI have tried to disable JMX, but it did not work.</p>\n<pre><code>&lt;plugin&gt;\n    &lt;groupId&gt;org.springdoc&lt;/groupId&gt;\n    &lt;artifactId&gt;springdoc-openapi-maven-plugin&lt;/artifactId&gt;\n    &lt;version&gt;1.4&lt;/version&gt;\n    &lt;configuration&gt;\n        &lt;apiDocsUrl&gt;http://localhost:8088/actuator/openapi/${project.artifactId}&lt;/apiDocsUrl&gt;\n        &lt;outputFileName&gt;openapi.json&lt;/outputFileName&gt;\n    &lt;/configuration&gt;\n    &lt;executions&gt;\n        &lt;execution&gt;\n            &lt;id&gt;generate-openapi&lt;/id&gt;\n            &lt;goals&gt;\n                &lt;goal&gt;generate&lt;/goal&gt;\n            &lt;/goals&gt;\n        &lt;/execution&gt;\n    &lt;/executions&gt;\n&lt;/plugin&gt;\n&lt;plugin&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n    &lt;configuration&gt;\n        &lt;jvmArguments&gt;-Dspring.profiles.active=it&lt;/jvmArguments&gt;\n        &lt;excludes&gt;\n            &lt;exclude&gt;\n                &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;\n                &lt;artifactId&gt;lombok&lt;/artifactId&gt;\n            &lt;/exclude&gt;\n        &lt;/excludes&gt;\n        &lt;image&gt;\n            &lt;builder&gt;paketobuildpacks/builder-jammy-tiny&lt;/builder&gt;\n            &lt;name&gt;${docker.publishRegistry.url}/${project.name}:${project.version}&lt;/name&gt;\n            &lt;createdDate&gt;${maven.build.timestamp}&lt;/createdDate&gt;\n            &lt;cleanCache&gt;true&lt;/cleanCache&gt;\n            &lt;env&gt;\n                &lt;BP_NATIVE_IMAGE&gt;false&lt;/BP_NATIVE_IMAGE&gt;\n                &lt;BP_JVM_VERSION&gt;${java.version}&lt;/BP_JVM_VERSION&gt;\n                &lt;BP_OCI_SOURCE&gt;${project.scm.url}&lt;/BP_OCI_SOURCE&gt;\n                &lt;BP_OCI_CREATED&gt;${maven.build.timestamp}&lt;/BP_OCI_CREATED&gt;\n                &lt;BP_OCI_VERSION&gt;${project.version}&lt;/BP_OCI_VERSION&gt;\n                &lt;BP_OCI_DESCRIPTION&gt;${project.description}&lt;/BP_OCI_DESCRIPTION&gt;\n            &lt;/env&gt;\n        &lt;/image&gt;\n    &lt;/configuration&gt;\n    &lt;executions&gt;\n        &lt;execution&gt;\n            &lt;id&gt;pre-integration-test&lt;/id&gt;\n            &lt;goals&gt;\n                &lt;goal&gt;start&lt;/goal&gt;\n            &lt;/goals&gt;\n        &lt;/execution&gt;\n        &lt;execution&gt;\n            &lt;id&gt;post-integration-test&lt;/id&gt;\n            &lt;goals&gt;\n                &lt;goal&gt;stop&lt;/goal&gt;\n            &lt;/goals&gt;\n        &lt;/execution&gt;\n    &lt;/executions&gt;\n&lt;/plugin&gt;\n</code></pre>\n<p>For running the integration tests I could use <code>maven-failsafe-plugin</code> instead, and remove the pre/post integration-test executions from <code>spring-boot-maven-plugin</code>. It will run the integration tests **/*IT.java</p>\n<pre><code>&lt;plugin&gt;\n    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n    &lt;artifactId&gt;maven-failsafe-plugin&lt;/artifactId&gt;\n    &lt;version&gt;3.5.3&lt;/version&gt;\n    &lt;configuration&gt;\n        &lt;argLine&gt;-Dspring.profiles.active=it&lt;/argLine&gt;\n        &lt;includes&gt;\n            &lt;include&gt;**/*IT.java&lt;/include&gt;\n        &lt;/includes&gt;\n    &lt;/configuration&gt;\n    &lt;executions&gt;\n        &lt;execution&gt;\n            &lt;id&gt;integration-tests&lt;/id&gt;\n            &lt;goals&gt;\n                &lt;goal&gt;integration-test&lt;/goal&gt;\n                &lt;goal&gt;verify&lt;/goal&gt;\n            &lt;/goals&gt;\n        &lt;/execution&gt;\n    &lt;/executions&gt;\n&lt;/plugin&gt;\n</code></pre>\n<p>However then I will not be able to generate the openapi during the build.</p>\n",
    "tags" : [ "java", "spring-boot", "spring-boot-maven-plugin", "maven-failsafe-plugin" ],
    "owner" : {
      "account_id" : 2058273,
      "reputation" : 911,
      "user_id" : 1835477,
      "user_type" : "registered",
      "accept_rate" : 59,
      "profile_image" : "https://www.gravatar.com/avatar/3b65fecacf57c96ec1f85b26804c6d32?s=256&d=identicon&r=PG",
      "display_name" : "DJViking",
      "link" : "https://stackoverflow.com/users/1835477/djviking"
    },
    "is_answered" : false,
    "view_count" : 49,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1749036645,
    "creation_date" : 1749036645,
    "link" : "https://stackoverflow.com/questions/79652661/spring-boot-integration-tests-without-mbean-server",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ ],
  "answer_comments" : { }
}