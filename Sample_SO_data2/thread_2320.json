{
  "question" : {
    "question_id" : 79632765,
    "title" : "More on reading numbers with Apache POI",
    "body" : "<p>I need to read human-entered numbers from an excel file (typically xslx but xsl sometimes as well).</p>\n<p>Using <code>DataFormatter.formatCellValue()</code> is unsatisfactory. If the user has set numeric format with  two decimal places, I will get two decimal places, whereas I need the actual number.</p>\n<p>Using <code>getNumericCellValue()</code> does not always work either. I see cases where reading &quot;1&quot; returns &quot;0.999999999998&quot; rather than &quot;1.0&quot;. The format is General (I cannot force my users to use Number); I see &quot;1&quot; both in the cell and in the formula bar; when I save as CSV and view in Notepad, I also see exactly &quot;1&quot;. In short, I absolutely don't see where the noise comes from.</p>\n<p><code>SetCellType(STRING)</code> is deprecated.</p>\n<p>The number in question doesn't have to be integer so I cannot simply round the double value, and as the thread below illustrates, floating point numbers are also subject to noise.</p>\n<p>Thanks for any ideas!</p>\n<p>PS I've looked at similar questions, e.g. <a href=\"https://stackoverflow.com/questions/31205969/apache-poi-make-rounds-on-numeric-values-it-reads\">Apache POI make rounds on numeric values it reads?</a></p>\n<p>â€” but cannot find a satisfying answer. I am using POI version 5.4.0</p>\n",
    "tags" : [ "java", "apache-poi" ],
    "owner" : {
      "account_id" : 23493242,
      "reputation" : 1,
      "user_id" : 17543992,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/5d08ebc773418642c9f017d34dd9a413?s=256&d=identicon&r=PG",
      "display_name" : "chatmalin",
      "link" : "https://stackoverflow.com/users/17543992/chatmalin"
    },
    "is_answered" : false,
    "view_count" : 100,
    "closed_date" : 1748175946,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1747940218,
    "creation_date" : 1747861551,
    "link" : "https://stackoverflow.com/questions/79632765/more-on-reading-numbers-with-apache-poi",
    "closed_reason" : "Duplicate"
  },
  "answers" : [ {
    "answer_id" : 79634366,
    "question_id" : 79632765,
    "body" : "<p>I have finally found this answer, and it works for all the cases I've tried so far. The numbers are read exactly as the user typed them in. <a href=\"https://stackoverflow.com/questions/36018660/how-to-set-a-cell-format-to-text\">How to set a cell format to Text</a></p>\n<p>Also works with an old POI version (3.11) that I have in production, so no need to upgrade just for this.</p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 23493242,
      "reputation" : 1,
      "user_id" : 17543992,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/5d08ebc773418642c9f017d34dd9a413?s=256&d=identicon&r=PG",
      "display_name" : "chatmalin",
      "link" : "https://stackoverflow.com/users/17543992/chatmalin"
    },
    "creation_date" : 1747940218,
    "last_activity_date" : 1747940218,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140448099,
    "post_id" : 79632765,
    "body" : "SO is more about helping you with code that you have written rather than showing you a code example of how to achieve something, therefore I suggest that you read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and then <a href=\"https://stackoverflow.com/posts/79632765/edit\">edit</a> your question and post your code, using <a href=\"https://stackoverflow.com/editing-help\">markdown</a> to format it, preferably as a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Then people may be able to reproduce your problem and subsequently help you to fix your code.",
    "score" : 2,
    "owner" : {
      "account_id" : 2485939,
      "reputation" : 20969,
      "user_id" : 2164365,
      "user_type" : "registered",
      "accept_rate" : 40,
      "profile_image" : "https://i.sstatic.net/RKSgV.png?s=256",
      "display_name" : "Abra",
      "link" : "https://stackoverflow.com/users/2164365/abra"
    },
    "creation_date" : 1747890179,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79634366" : [ {
      "comment_id" : 140457052,
      "post_id" : 79634366,
      "body" : "If this is not a duplicate, please <a href=\"https://stackoverflow.com/posts/79634366/edit\">edit</a> your question/answer with your revised approach <i>or</i> post an answer in the <a href=\"https://stackoverflow.com/q/36018660/230513\">duplicate</a>.",
      "score" : 0,
      "owner" : {
        "account_id" : 81822,
        "reputation" : 206045,
        "user_id" : 230513,
        "user_type" : "registered",
        "accept_rate" : 100,
        "profile_image" : "https://www.gravatar.com/avatar/632732029bf05854c17d0dea6c82dcb4?s=256&d=identicon&r=PG",
        "display_name" : "trashgod",
        "link" : "https://stackoverflow.com/users/230513/trashgod"
      },
      "creation_date" : 1748176159,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140455271,
      "post_id" : 79634366,
      "body" : "If the answer to the other question answers your question, then your question is a <a href=\"https://stackoverflow.com/help/duplicates\">duplicate</a>.",
      "score" : 0,
      "owner" : {
        "account_id" : 2485939,
        "reputation" : 20969,
        "user_id" : 2164365,
        "user_type" : "registered",
        "accept_rate" : 40,
        "profile_image" : "https://i.sstatic.net/RKSgV.png?s=256",
        "display_name" : "Abra",
        "link" : "https://stackoverflow.com/users/2164365/abra"
      },
      "creation_date" : 1748090436,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}