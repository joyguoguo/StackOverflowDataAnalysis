{
  "question" : {
    "question_id" : 79688301,
    "title" : "MyBatis Dynamic SQL with PostgreSQL Throws Syntax Error When Certain Parameters Are Combined",
    "body" : "<p>I'm facing an issue with MyBatis dynamic SQL generation. When combining certain search parameters, the SQL it generates causes a PostgreSQL error:</p>\n<blockquote>\n<p>org.postgresql.util.PSQLException: ERROR: syntax error at or near\n&quot;flight_number&quot;</p>\n</blockquote>\n<p>This happens only when I pass airlineCode, flightNumber, and flightDate together (or airlineCode + flightNumber). But if I pass just flightNumber, or airlineCode with a flight date range, it works fine.</p>\n<pre><code>&lt;select id=&quot;fetchAllUpdAirRetroactiveCostList&quot; resultMap=&quot;airUpdRetroactiveCostVOs&quot;&gt;\n    SELECT\n        airline_code,\n        contract_code,\n        flight_number,\n        flight_date,\n        contract_route_code,\n        airline_fare_basis_code,\n        currency,\n        adult_cost,\n        child_cost,\n        infant_cost,\n        cabin_class,\n        ops_req_id,\n        unique_retro_id\n    FROM ITRVL_AIR_RETRO_UPD\n    &lt;where&gt;\n        TENANT_ID = :tenant_id\n        &lt;if test=&quot;searchVO.airlineCode != null and searchVO.airlineCode != ''&quot;&gt;\n            AND airline_code = #{searchVO.airlineCode}\n        &lt;/if&gt;\n        &lt;if test=&quot;searchVO.contractCode != null and searchVO.contractCode != ''&quot;&gt;\n            AND contract_code = #{searchVO.contractCode}\n        &lt;/if&gt;\n        &lt;if test=&quot;searchVO.flightNumber != null&quot;&gt;\n            AND flight_number = #{searchVO.flightNumber}\n        &lt;/if&gt;\n        &lt;if test=&quot;searchVO.fromDate != null and searchVO.toDate != null&quot;&gt;\n            AND flight_date BETWEEN CAST(#{searchVO.fromDate} AS DATE) AND CAST(#{searchVO.toDate} AS DATE)\n        &lt;/if&gt;\n    &lt;/where&gt;\n&lt;/select&gt;\n</code></pre>\n<p>flightNumber is an Integer in the Java searchVO.\nI suspect MyBatis is generating SQL like AND flight_number = when parameters aren't fully populated.\nHow can I safely handle optional parameters in MyBatis so that it doesnâ€™t generate malformed SQL like AND flight_number =?</p>\n<p>Is there a better way to conditionally build dynamic SQL for PostgreSQL in MyBatis?</p>\n",
    "tags" : [ "java", "spring", "postgresql", "mybatis", "mybatis-sql" ],
    "owner" : {
      "account_id" : 38149385,
      "reputation" : 1,
      "user_id" : 28622821,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/4149923a5be517c434b0bab7c2f72cd4?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Rijo Thomas Mathew",
      "link" : "https://stackoverflow.com/users/28622821/rijo-thomas-mathew"
    },
    "is_answered" : false,
    "view_count" : 79,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1751519043,
    "creation_date" : 1751517147,
    "link" : "https://stackoverflow.com/questions/79688301/mybatis-dynamic-sql-with-postgresql-throws-syntax-error-when-certain-parameters",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140571146,
    "post_id" : 79688301,
    "body" : "Welcome to the SO community. The community will help you with issues, but there are some expectation of you. Please spend a few minuets to <a href=\"https://stackoverflow.com/tour\">Take the Tour</a> and review <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>. Then update your question to include table definition(s) (DDL), sample data, and expected results. All as <a href=\"https://senseful.github.io/text-table/\" rel=\"nofollow noreferrer\">formatted text</a> or even better a <a href=\"https://dbfiddle.uk/\" rel=\"nofollow noreferrer\">fiddle</a>, but - <b>no images</b>.",
    "score" : 0,
    "owner" : {
      "account_id" : 10335627,
      "reputation" : 15120,
      "user_id" : 7623856,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/081db16b893361086f632752bc3ec09d?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Belayer",
      "link" : "https://stackoverflow.com/users/7623856/belayer"
    },
    "creation_date" : 1751903763,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140561598,
    "post_id" : 79688301,
    "body" : "Please enable DEBUG level logging and add the output (the part that contains the SQL statement being executed) to the question.",
    "score" : 1,
    "owner" : {
      "account_id" : 1314580,
      "reputation" : 3724,
      "user_id" : 1261766,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/W21fG.png?s=256",
      "display_name" : "ave",
      "link" : "https://stackoverflow.com/users/1261766/ave"
    },
    "creation_date" : 1751538640,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}