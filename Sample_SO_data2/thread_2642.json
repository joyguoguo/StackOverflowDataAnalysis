{
  "question" : {
    "question_id" : 79609126,
    "title" : "Turkish characters are corrupted when reading ISO-8859-1 CSV file with Java InputStream",
    "body" : "<p>I am reading and processing CSV files in a Spring Boot based application. The CSV file is in ISO-8859-1 format and contains Turkish characters. When I first read the file with <code>BufferedReader</code> the content appears correct, but when logged or transferred to other services the Turkish characters are corrupted.</p>\n<p>For example:</p>\n<ul>\n<li>Original: <code>EDIRNE;IPSALA;ATATÜRK;28.04.2025;16:28:00;İİÇŞÜĞİİİ</code></li>\n<li>Corrupted: <code>EDÝRNE;IPSALA;ATATÜRK;28.04.2025;16:28:00;ÝÇÞÜÐÝÝÝ</code></li>\n</ul>\n<p>My CSV reading code:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public List&lt;String&gt; read(InputStream inputStream) { \nlogger.info(&quot;csv read started&quot;); \nList&lt;String&gt; csvFileContent = new ArrayList&lt;&gt;(); \n\ntry { \nBufferedReader reader = new BufferedReader(new InputStreamReader(inputStream)); \nString line; \nwhile ((line = reader.readLine()) != null) { \ncsvFileContent.add(line); \n} \nreader.close(); \n} catch (IOException e) { \n//Handle exception \n} \nlogger.info(&quot;csv read finished&quot;); \nlogger.info(csvFileContent.toString()); \nreturn csvFileContent;\n}\n</code></pre>\n<p>My CSV processing code:</p>\n<pre class=\"lang-java prettyprint-override\"><code>private CSVParser parseCsvContent(List&lt;String&gt; sftpContent) throws IOException {\n    return CSVParser.parse(String.join(&quot;\\n&quot;, sftpContent),\n            CSVFormat.DEFAULT.builder()\n                    .setHeader()\n                    .setDelimiter(';')\n                    .build());\n}\n</code></pre>\n<p>code to read files from SFTP:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public List&lt;String&gt; readFromSFTP(String ftpAddress, Integer ftpPort, String ftpUserName, String ftpPassword, String ftpDirectory) {\n    logger.info(&quot;readFromSFTP started&quot;);\n    try {\n        Session session = sftpSessionFactory.createSession(ftpUserName, ftpAddress, ftpPort, ftpPassword);\n        ChannelSftp channel = sftpChannelService.createAndConnectChannel(session);\n        logger.info(&quot;channel: &quot;+channel.isConnected());\n        \n        String targetFileName = getValidFileNames(channel, ftpDirectory);\n        logger.info(&quot;/readFromSFTP/targetedFileName: &quot;+targetFileName);\n        \n        channel.cd(ftpDirectory);\n        if (targetFileName != null) {\n            InputStream inputStream = channel.get(targetFileName);\n            sftpFileContent = fileReadingService.readFromStream(inputStream, targetFileName);\n        } else {\n            setValidFileName(null);\n            logger.warn(&quot;There are no valid CSV files available for processing.&quot;); \n        }\n        channel.disconnect();\n        session.disconnect();\n\n    } catch (JSchException | SftpException e) {\n        throw new SftpFileAccessException(&quot;Error while accessing or processing SFTP files.&quot;+ e.getMessage(),e);\n    } catch (Exception e) {\n        e.printStackTrace();\n    }\n    logger.info(&quot;readFromSFTP finished&quot;);\n    return sftpFileContent;\n}\n</code></pre>\n<p>I tried the following in the <code>read</code> method.</p>\n<p><code>BufferedReader reader = new BufferedReader(new InputStreamReader(inputStream, &quot;ISO-8859-1&quot;));</code></p>\n<p><code>BufferedReader reader = new BufferedReader(new InputStreamReader(inputStream, &quot;UTF-8&quot;)); </code>\n<code>BufferedReader reader = new BufferedReader(new InputStreamReader(inputStream, StandardCharsets.UTF_8));</code></p>\n<p><code>BufferedReader reader = new BufferedReader(new InputStreamReader(inputStream, &quot;ISO-8859-9&quot;));</code></p>\n<p>But the result did not change.</p>\n<p>When I did the following mode and debugged it, I saw that I received the data in csvFileContent with Turkish characters. However, it still failed when the data is written to the log or transferred to services.</p>\n<pre><code>BufferedReader reader = new BufferedReader(new InputStreamReader(inputStream, &quot;windows-1254&quot;));\n</code></pre>\n",
    "tags" : [ "java", "spring-boot", "csv", "sftp", "iso-8859-1" ],
    "owner" : {
      "account_id" : 14148196,
      "reputation" : 43,
      "user_id" : 10220928,
      "user_type" : "registered",
      "profile_image" : "https://lh6.googleusercontent.com/-lxxtYfAnYGA/AAAAAAAAAAI/AAAAAAAAAA8/JaXp2QgHnbc/s256-rj/photo.jpg",
      "display_name" : "Mustafa",
      "link" : "https://stackoverflow.com/users/10220928/mustafa"
    },
    "is_answered" : true,
    "view_count" : 137,
    "answer_count" : 2,
    "score" : 0,
    "last_activity_date" : 1746648239,
    "creation_date" : 1746549477,
    "link" : "https://stackoverflow.com/questions/79609126/turkish-characters-are-corrupted-when-reading-iso-8859-1-csv-file-with-java-inpu",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79609154,
    "question_id" : 79609126,
    "body" : "<blockquote>\n<p>The CSV file is in ISO-8859-1 format and contains Turkish characters.</p>\n</blockquote>\n<p>ISO-8859-1 doesn't support all <a href=\"https://en.wikipedia.org/wiki/Wikipedia:Turkish_characters\" rel=\"nofollow noreferrer\">Turkish characters</a>:</p>\n<blockquote>\n<p>The <a href=\"https://en.wikipedia.org/wiki/Turkish_alphabet\" rel=\"nofollow noreferrer\">Turkish alphabet</a> contains six letters not present in standard ISO 8859-1, and that will therefore present problems for Wikipedia use: Dotted uppercase &quot;I&quot;, dotless lowercase &quot;i&quot;, upper- and lowercase &quot;G&quot; with breve accent, and upper- and lowercase &quot;S&quot; with cedilla.</p>\n</blockquote>\n<p>If it needs to be encoded or interpreted as an ISO-8859-? character set, it would need to be <a href=\"https://en.wikipedia.org/wiki/ISO/IEC_8859-9\" rel=\"nofollow noreferrer\">ISO-8859-9</a>.</p>\n",
    "score" : 6,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 162699,
      "reputation" : 141055,
      "user_id" : 3788176,
      "user_type" : "registered",
      "accept_rate" : 54,
      "profile_image" : "https://www.gravatar.com/avatar/44c841338e1646af9a977f1fa0e23948?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Andy Turner",
      "link" : "https://stackoverflow.com/users/3788176/andy-turner"
    },
    "creation_date" : 1746550592,
    "last_activity_date" : 1746601160,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79609669,
    "question_id" : 79609126,
    "body" : "<h2>tl;dr</h2>\n<p>Write your data in the appropriate character set/encoding such as ISO-8859-9 (or, better, Unicode (UTF-8)).</p>\n<pre class=\"lang-java prettyprint-override\"><code>Files.writeString ( path , turkish , Charset.forName ( &quot;ISO-8859-9&quot; ) );\n</code></pre>\n<p>Read your data according to that same character set/encoding.</p>\n<pre class=\"lang-java prettyprint-override\"><code>Files.lines ( path , Charset.forName ( &quot;ISO-8859-9&quot; ) )\n</code></pre>\n<h2>ISO-8859-1 not complete Turkish</h2>\n<p>The <a href=\"https://stackoverflow.com/a/79609154/642706\">Answer by Andy Turner</a> is correct and clear. Your use of <a href=\"https://en.wikipedia.org/wiki/ISO/IEC_8859-1\" rel=\"nofollow noreferrer\">ISO-8859-1</a> (“Latin-1”) is not appropriate for the text you want to write and read. It lacks some characters needed for <a href=\"https://en.wikipedia.org/wiki/Turkish_language\" rel=\"nofollow noreferrer\">Turkish language</a>.</p>\n<h2>ISO-8859-9 for Turkish</h2>\n<p>Your data file needs to be written using a character set such as <a href=\"https://en.wikipedia.org/wiki/ISO/IEC_8859-9\" rel=\"nofollow noreferrer\">ISO-8859-9</a> (“Latin-5”).</p>\n<p>To quote Wikipedia:</p>\n<blockquote>\n<p>ISO/IEC 8859-9:1999 … is informally referred to as <strong>Latin-5</strong> or <em>Turkish</em>. It was designed to cover the <a href=\"https://en.wikipedia.org/wiki/Turkish_language\" rel=\"nofollow noreferrer\">Turkish language</a> (and the vast majority of users use it for that language, even though it can also be used for some other languages), designed as being of more use than the <a href=\"https://en.wikipedia.org/wiki/ISO/IEC_8859-3\" rel=\"nofollow noreferrer\">ISO/IEC 8859-3</a> encoding. It is identical to ISO/IEC 8859-1 except for the replacement of six <a href=\"https://en.wikipedia.org/wiki/Icelandic_language\" rel=\"nofollow noreferrer\">Icelandic</a> characters (Ðð, Ýý, Þþ) with characters unique to the Turkish alphabet (Ğğ, İ, ı, Şş). And the uppercase of i is İ; the lowercase of I is ı.</p>\n</blockquote>\n<h2>Example code</h2>\n<p>Here is some example code showing how using the proper character set can successfully write and read your desired text.</p>\n<p>This little example app writes a temporary file with your desired string. Then the app pauses, so you can go inspect that written file. When the app resumes, it reads that file, and dumps the text to console. Upon exiting, the app deletes the temporary file.</p>\n<pre class=\"lang-java prettyprint-override\"><code>package work.basil.example.text;\n\nimport java.io.IOException;\nimport java.nio.charset.*;\nimport java.nio.file.Files;\nimport java.nio.file.Path;\nimport java.util.stream.Stream;\n\npublic class Turkish\n{\n    public static void main ( String[] args )\n    {\n        // Charset.availableCharsets ( ).forEach ( ( k , v ) -&gt; System.out.println ( k + &quot; = &quot; + v ) );\n        String charSetName = &quot;ISO-8859-9&quot;;  // Latin-9 for Turkish characters in a ISO-8859 character set. Tip: Use UTF-8 instead if feasible.\n        if ( ! Charset.isSupported ( charSetName ) ) { throw new RuntimeException ( &quot;Charset not supported: &quot; + charSetName ); }\n        Charset charset = Charset.forName ( charSetName );\n\n        final String turkish = &quot;EDIRNE;IPSALA;ATATÜRK;28.04.2025;16:28:00;İİÇŞÜĞİİİ&quot;;\n\n        // Write -------------------------------------------\n        System.out.println ( &quot;Press Enter/Return to write file with sample Turkish text.&quot; );\n        System.console ( ).readLine ( );\n        Path path = null;\n        try\n        {\n            path = Files.createTempFile ( &quot;ExampleTurkish&quot; , &quot;.txt&quot; );\n            path.toFile ( ).deleteOnExit ( );  // Eventually delete, when app exits.\n            Files.writeString ( path , turkish , charset );\n            System.out.println ( &quot;Example Turkish file written to: &quot; + path );\n        }\n        catch ( IOException e )\n        {\n            throw new RuntimeException ( e );\n        }\n\n        // Paused here, so you can examine the file with a hex-editor if you so desire.\n\n        // Read  -------------------------------------------\n        System.out.println ( &quot;Press Enter/Return to read sample Turkish file.&quot; );\n        System.console ( ).readLine ( );\n        try\n                (\n                        Stream &lt; String &gt; linesStream = Files.lines ( path , charset )\n                )\n        {\n            linesStream.forEach ( System.out :: println );\n            System.out.println ( &quot;Versus original: &quot; );\n            System.out.println ( turkish );\n        }\n        catch ( IOException e )\n        {\n            throw new RuntimeException ( e );\n        }\n    }\n}\n</code></pre>\n<p>When run:</p>\n<pre class=\"lang-none prettyprint-override\"><code>EDIRNE;IPSALA;ATATÜRK;28.04.2025;16:28:00;İİÇŞÜĞİİİ\nVersus original: \nEDIRNE;IPSALA;ATATÜRK;28.04.2025;16:28:00;İİÇŞÜĞİİİ\n</code></pre>\n<p>During that pause you could inspect that file with a text-editor or a hex-editor. Here we use the <a href=\"https://hexfiend.com/\" rel=\"nofollow noreferrer\"><em>Hex Fiend</em></a> app available on macOS to read that file.</p>\n<p>The catch is that you must manually instruct your hex-editor as to what character set should be assumed for reading this file. Yes, amazingly, after <a href=\"https://en.wikipedia.org/wiki/Computer_file#Etymology\" rel=\"nofollow noreferrer\">64 years of file systems</a>, the computer information industry has not yet invented metadata to indicate the character set nor character encoding of a file.</p>\n<p>To instruct <em>Hex Fiend</em> about the character encoding:</p>\n<ol>\n<li>Add <code>Turkish (ISO Latin 5)</code> (meaning ISO-8859-9) to the <code>Text Encoding</code> menu.</li>\n<li>Choose that item on the <code>Text Encoding</code> menu.</li>\n</ol>\n<p>You can then see the proper Turkish characters appear on the right side. Shown in this screenshot:</p>\n<p><a href=\"https://i.sstatic.net/YG1Lt5x7.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/YG1Lt5x7.jpg\" alt=\"screenshot of Hex Fiend app displaying correctly the desired Turkish characters\" /></a></p>\n<h2>UTF-8</h2>\n<p>The ideal solution would be abandoning the legacy character encodings including both Latin-1 and Latin-5.</p>\n<p>\uD83D\uDC49\uD83C\uDFFD Instead, just use <a href=\"https://en.wikipedia.org/wiki/UTF-8\" rel=\"nofollow noreferrer\">UTF-8</a>.</p>\n<p>In Java, that is <a href=\"https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/nio/charset/StandardCharsets.html#UTF_8\" rel=\"nofollow noreferrer\"><code>StandardCharsets.UTF_8</code></a>. In modern Java, <a href=\"https://openjdk.org/jeps/400\" rel=\"nofollow noreferrer\">UTF-8 is used by default</a> for most purposes across all platforms. But I recommend specifying explicitly rather than rely implicitly on default.</p>\n<p>For more info, see:</p>\n<ul>\n<li><a href=\"https://utf8everywhere.org/\" rel=\"nofollow noreferrer\"><em>UTF-8 Everywhere Manifesto</em></a></li>\n<li><a href=\"https://www.joelonsoftware.com/2003/10/08/the-absolute-minimum-every-software-developer-absolutely-positively-must-know-about-unicode-and-character-sets-no-excuses/\" rel=\"nofollow noreferrer\"><em>The Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses!)</em></a> by Joel Splotsky</li>\n</ul>\n<hr />\n<p>By the way, a tip: Educate the publisher of your data about using standard <a href=\"https://en.wikipedia.org/wiki/ISO_8601\" rel=\"nofollow noreferrer\">ISO 8601</a> formats for exchanging date-time values in text. Example: <code>2025-04-28T16:28:00</code> rather than <code>28.04.2025;16:28:00</code>. And if that was meant to represent a moment, attach an offset and time zone for complete information. For offset of zero, append a <code>Z</code>: <code>2025-04-28T16:28:00Z</code>.</p>\n",
    "score" : 0,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 322981,
      "reputation" : 347089,
      "user_id" : 642706,
      "user_type" : "registered",
      "accept_rate" : 58,
      "profile_image" : "https://i.sstatic.net/ZWEI3.jpg?s=256",
      "display_name" : "Basil Bourque",
      "link" : "https://stackoverflow.com/users/642706/basil-bourque"
    },
    "creation_date" : 1746579472,
    "last_activity_date" : 1746648239,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140401831,
    "post_id" : 79609126,
    "body" : "There&#39;s a lot of indirection in your code which makes it difficult to follow, but worse, in your FTP code (which I assume is the origin of your reading) you call a method called <code>readFromStream</code> yet you post the code of a method called <code>read</code>. This doesn&#39;t make sense, so it&#39;s as yet too early to say what the problem is",
    "score" : 0,
    "owner" : {
      "account_id" : 22124137,
      "reputation" : 4244,
      "user_id" : 16376827,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/1ImPw.png?s=256",
      "display_name" : "g00se",
      "link" : "https://stackoverflow.com/users/16376827/g00se"
    },
    "creation_date" : 1746563418,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79609669" : [ {
      "comment_id" : 140403221,
      "post_id" : 79609669,
      "body" : "<i>We changed file format</i> Not sure what that means. More importantly, you already stated you used: <i>BufferedReader reader = new BufferedReader(new InputStreamReader(inputStream, &quot;ISO-8859-9&quot;)); <b>But the result did not change.</i></b> (My emphasis) so I&#39;m baffled",
      "score" : 0,
      "owner" : {
        "account_id" : 22124137,
        "reputation" : 4244,
        "user_id" : 16376827,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/1ImPw.png?s=256",
        "display_name" : "g00se",
        "link" : "https://stackoverflow.com/users/16376827/g00se"
      },
      "creation_date" : 1746608366,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140402913,
      "post_id" : 79609669,
      "body" : "Thanks for your all response. We changed file format",
      "score" : 0,
      "owner" : {
        "account_id" : 14148196,
        "reputation" : 43,
        "user_id" : 10220928,
        "user_type" : "registered",
        "profile_image" : "https://lh6.googleusercontent.com/-lxxtYfAnYGA/AAAAAAAAAAI/AAAAAAAAAA8/JaXp2QgHnbc/s256-rj/photo.jpg",
        "display_name" : "Mustafa",
        "link" : "https://stackoverflow.com/users/10220928/mustafa"
      },
      "creation_date" : 1746602833,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140402814,
      "post_id" : 79609669,
      "body" : "Please don&#39;t edit my answers into your style: I will just roll them back.",
      "score" : 0,
      "owner" : {
        "account_id" : 162699,
        "reputation" : 141055,
        "user_id" : 3788176,
        "user_type" : "registered",
        "accept_rate" : 54,
        "profile_image" : "https://www.gravatar.com/avatar/44c841338e1646af9a977f1fa0e23948?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "Andy Turner",
        "link" : "https://stackoverflow.com/users/3788176/andy-turner"
      },
      "creation_date" : 1746601221,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}