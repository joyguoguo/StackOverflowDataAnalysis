{
  "question" : {
    "question_id" : 79733339,
    "title" : "MongoRepository bean not found when repository is in external JAR dependency",
    "body" : "<p>My microservice uses an external dependency which is a JAR build by my company.\nI can't figure why the bean is not found.</p>\n<pre><code>***************************\nAPPLICATION FAILED TO START\n***************************\n\\00\\00\\00\\00\\00\\00\nDescription:\nParameter 1 of constructor in my.package.service.AuthorizationService required a bean of type 'my.package.repository.I2b2QueryRepository' that could not be found.\nAction:\nConsider defining a bean of type 'my.package.repository.I2b2QueryRepository' in your configuration.\n</code></pre>\n<p><strong>Repository</strong></p>\n<pre><code>public interface I2b2QueryRepository extends MongoRepository&lt;I2b2Query, String&gt; {\n    I2b2Query findOneById(String queryId);\n}\n</code></pre>\n<p><strong>Service</strong></p>\n<pre><code>private final ProjectMicroserviceFeignClient projectMicroserviceFeignClient;\nprivate final I2b2QueryRepository i2b2QueryRepository;\n\npublic AuthorizationService(ProjectMicroserviceFeignClient projectMicroserviceFeignClient, I2b2QueryRepository i2b2QueryRepository) {\n    this.projectMicroserviceFeignClient = projectMicroserviceFeignClient;\n    this.i2b2QueryRepository = i2b2QueryRepository;\n}\n</code></pre>\n<p><strong>My package</strong></p>\n<pre><code>@SpringBootApplication\n@EnableMongoRepositories(basePackageClasses = I2b2QueryRepository.class)\npublic class MyPackage {\n\n    public static void main(String[] args) {\n    }\n}\n</code></pre>\n<p>I tried :</p>\n<ul>\n<li>with and without the <code>@SPringBootApplication</code> and <code>@EnableMongoRepositories</code> annotations</li>\n<li>adding <code>@componentScan(&quot;my.package&quot;)</code> to the main class of the package</li>\n<li>adding <code>@componentScan(scanBasePackages = ...)</code> to the main class of parent project</li>\n<li>with or without <code>@Repository</code> annotation on the repository</li>\n<li><code>@autowired</code> and constructor injection in AuthorizationService</li>\n<li>Adding <code>@EnableMongoRepositories</code> to the main class of parent project but it leads to other errors and I am not sure this is the proper solution</li>\n</ul>\n<p><strong>Package structure of the external dependency: (Edited)</strong></p>\n<pre><code>src/\n├── main/\n│   └── java/\n│       └── com/\n│           └── example/\n│               ├── MyPackage.java\n│               └── authorization/\n│                   ├── service/\n│                   │   └── AuthorizationService.java\n│                   └── repository/\n│                       ├── ProjectMicroserviceFeign.java\n│                       └── I2b2QueryRepository.java\n│           ├── META-INF/\n│           ├── application.properties\n</code></pre>\n<p>Globally I have tried solutions from <a href=\"https://stackoverflow.com/questions/40384056/consider-defining-a-bean-of-type-package-in-your-configuration-spring-boot\">this question</a>, without success for now.</p>\n<p><strong>UPDATE 1</strong></p>\n<p><strong>Main project class</strong></p>\n<pre><code>@SpringBootApplication(scanBasePackages = { &quot;main.project.path&quot;, &quot;my.package.path&quot;}\n@EnableMangoRepositories(basePackageClasses = {I2b2QueryRepository.class}\n@EnableElasticSearchRepositories(basePackageClasses = {MyESRepo.class}\n@EnableJpaRepositories(basePackageClasses = {MyJpaRepo.class},\npublic class MainProjectApp {\n}\n</code></pre>\n<p><strong>UPDATE 2</strong></p>\n<p><strong>Main project's package structure</strong></p>\n<pre><code>src/\n└── main/\n    └── java/\n        └── com/\n            └── example/\n                ├── MainProjectApp.java\n                └── repository/\n                    ├── I2b2QueryRepository.java    (Mango)\n                    ├── UserRepository.java         (JPA)\n                    ├── UserSearchRepository.java   (Elasticsearch)\n</code></pre>\n",
    "tags" : [ "java", "spring-boot", "dependency-injection", "microservices" ],
    "owner" : {
      "account_id" : 8056132,
      "reputation" : 403,
      "user_id" : 6073219,
      "user_type" : "registered",
      "accept_rate" : 80,
      "profile_image" : "https://www.gravatar.com/avatar/e746f335363b80c443a3b206851f4970?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Ryley38",
      "link" : "https://stackoverflow.com/users/6073219/ryley38"
    },
    "is_answered" : false,
    "view_count" : 74,
    "answer_count" : 0,
    "score" : 1,
    "last_activity_date" : 1755076938,
    "creation_date" : 1755009865,
    "link" : "https://stackoverflow.com/questions/79733339/mongorepository-bean-not-found-when-repository-is-in-external-jar-dependency",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140662301,
    "post_id" : 79733339,
    "body" : "Let us <a href=\"https://chat.stackoverflow.com/rooms/259728/discussion-between-ryley38-and-m-deinum\">continue this discussion in chat</a>.",
    "score" : 0,
    "owner" : {
      "account_id" : 8056132,
      "reputation" : 403,
      "user_id" : 6073219,
      "user_type" : "registered",
      "accept_rate" : 80,
      "profile_image" : "https://www.gravatar.com/avatar/e746f335363b80c443a3b206851f4970?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Ryley38",
      "link" : "https://stackoverflow.com/users/6073219/ryley38"
    },
    "creation_date" : 1755079139,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140662208,
    "post_id" : 79733339,
    "body" : "@M.Deinum, I’m not entirely sure about the best practice you’re referring to. I’ve updated the question to show a simplified package structure of the main project. Do you think it needs refactoring?",
    "score" : 0,
    "owner" : {
      "account_id" : 8056132,
      "reputation" : 403,
      "user_id" : 6073219,
      "user_type" : "registered",
      "accept_rate" : 80,
      "profile_image" : "https://www.gravatar.com/avatar/e746f335363b80c443a3b206851f4970?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Ryley38",
      "link" : "https://stackoverflow.com/users/6073219/ryley38"
    },
    "creation_date" : 1755076763,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140662154,
    "post_id" : 79733339,
    "body" : "If you follow the best practices (put the application class in a top level package) and share the same top level package amongst all your other projects all those <code>@Enable*</code> configurations wouldn&#39;t be needed. If that isn&#39;t possible you could also try to add an auto-configuration to those other projects which would include the <code>@Enable*</code> specific annotations, that way you would only need to include the dependency (and the proper mongo, jpa etc. configuration).",
    "score" : 0,
    "owner" : {
      "account_id" : 3192259,
      "reputation" : 126826,
      "user_id" : 2696260,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/qHEzx.png?s=256",
      "display_name" : "M. Deinum",
      "link" : "https://stackoverflow.com/users/2696260/m-deinum"
    },
    "creation_date" : 1755075435,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140662118,
    "post_id" : 79733339,
    "body" : "@M.Deinum I try to make it work using EnableMangoRepository on the application class of the launched project. The error has disappeared, but it seems I need to apply this solution to all the repositories used — both those in the package and those in the project that imports it. My project uses many different types of repositories (JPA, Mongo, Elastic). Is this a configuration mistake on my part? (I have updated my question with the application class of the main project.)",
    "score" : 0,
    "owner" : {
      "account_id" : 8056132,
      "reputation" : 403,
      "user_id" : 6073219,
      "user_type" : "registered",
      "accept_rate" : 80,
      "profile_image" : "https://www.gravatar.com/avatar/e746f335363b80c443a3b206851f4970?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Ryley38",
      "link" : "https://stackoverflow.com/users/6073219/ryley38"
    },
    "creation_date" : 1755074348,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140661929,
    "post_id" : 79733339,
    "body" : "No adding it to the external dependency doesn&#39;t make any sense. It must be added to the application class that you are launching.",
    "score" : 0,
    "owner" : {
      "account_id" : 3192259,
      "reputation" : 126826,
      "user_id" : 2696260,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/qHEzx.png?s=256",
      "display_name" : "M. Deinum",
      "link" : "https://stackoverflow.com/users/2696260/m-deinum"
    },
    "creation_date" : 1755069585,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140661909,
    "post_id" : 79733339,
    "body" : "@M.Deinum I agree, the package structure was confusing. I’ve updated the diagram to show a simplified version of the JAR that’s used as an external dependency. I’ve also removed the user package since it’s not relevant here. Should the EnableMongoRepository annotation be placed in the application class of the package (MyPackage in this example)?",
    "score" : 0,
    "owner" : {
      "account_id" : 8056132,
      "reputation" : 403,
      "user_id" : 6073219,
      "user_type" : "registered",
      "accept_rate" : 80,
      "profile_image" : "https://www.gravatar.com/avatar/e746f335363b80c443a3b206851f4970?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Ryley38",
      "link" : "https://stackoverflow.com/users/6073219/ryley38"
    },
    "creation_date" : 1755069230,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140661137,
    "post_id" : 79733339,
    "body" : "Your package structure look strange why isn&#39;t <code>authorization</code> and <code>User</code> (why the uppercse) not under <code>com.example</code>? What is that <code>MyPackage</code> thing I don&#39;t see it anywhere? If that is part of oyour other jar containing the Mongo repository it doesn&#39;t make sense as why should that be there. The <code>@EnableMongoRepository</code> should be on your <code>Application</code> class.",
    "score" : 0,
    "owner" : {
      "account_id" : 3192259,
      "reputation" : 126826,
      "user_id" : 2696260,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/qHEzx.png?s=256",
      "display_name" : "M. Deinum",
      "link" : "https://stackoverflow.com/users/2696260/m-deinum"
    },
    "creation_date" : 1755028322,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}