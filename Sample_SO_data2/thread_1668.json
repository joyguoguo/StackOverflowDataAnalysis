{
  "question" : {
    "question_id" : 79689193,
    "title" : "Validating an Ed25519 public key (isOnCurve check) in Java",
    "body" : "<p>Is there a standard way to validate an Ed25519 public key (check that it's really a point on the curve and not some random bytes) using the standard Java Crypto APIs and/or BouncyCastle?</p>\n<p>I found a python example here for a slightly different curve, but I would rather not re-implement it manually if that's avoidable: <a href=\"https://security.stackexchange.com/questions/233099/validating-an-ed25519-public-key\">Validating an Ed25519 public key</a></p>\n<p>For the context, here's how I'm creating a <code>PublicKey</code> object from raw bytes (though I guess it succeeds for any bytes in <code>rawKey</code>):</p>\n<pre><code>KeyFactory keyFactory = KeyFactory.getInstance(&quot;Ed25519&quot;);\nSubjectPublicKeyInfo subjectPublicKeyInfo = new SubjectPublicKeyInfo(new AlgorithmIdentifier(EdECObjectIdentifiers.id_Ed25519), rawKey);\nX509EncodedKeySpec x509EncodedKeySpec = new X509EncodedKeySpec(subjectPublicKeyInfo.getEncoded());\nPublicKey publicKey = keyFactory.generatePublic(x509EncodedKeySpec);\n</code></pre>\n",
    "tags" : [ "java", "cryptography", "bouncycastle", "public-key-encryption", "elliptic-curve" ],
    "owner" : {
      "account_id" : 9606388,
      "reputation" : 6034,
      "user_id" : 7132300,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/bb0f4dcab67c7a619f1645da889aac69?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "algrid",
      "link" : "https://stackoverflow.com/users/7132300/algrid"
    },
    "is_answered" : true,
    "view_count" : 199,
    "answer_count" : 1,
    "score" : 1,
    "last_activity_date" : 1758958289,
    "creation_date" : 1751560775,
    "link" : "https://stackoverflow.com/questions/79689193/validating-an-ed25519-public-key-isoncurve-check-in-java",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79690929,
    "question_id" : 79689193,
    "body" : "<p>The validity of a 32 bytes public key in the sense of <a href=\"https://datatracker.ietf.org/doc/html/rfc8032\" rel=\"nofollow noreferrer\">RFC 8032</a> can be performed with BouncyCastle's <a href=\"https://downloads.bouncycastle.org/java/docs/bcprov-jdk18on-javadoc/org/bouncycastle/math/ec/rfc8032/Ed25519.html#validatePublicKeyFull(byte%5B%5D,int)\" rel=\"nofollow noreferrer\"><code>Ed25519.validatePublicKeyFull()</code></a>.<br />\nUnfortunately, the documentation for this function is missing. The <a href=\"https://github.com/bcgit/bc-java/blob/r1rv81/core/src/main/java/org/bouncycastle/math/ec/rfc8032/Ed25519.java#L1489\" rel=\"nofollow noreferrer\">source code</a> of <code>validatePublicKeyFull()</code> shows that this function basically does the following:</p>\n<ol>\n<li><a href=\"https://github.com/bcgit/bc-java/blob/r1rv81/core/src/main/java/org/bouncycastle/math/ec/rfc8032/Ed25519.java#L212\" rel=\"nofollow noreferrer\"><code>checkPointFullVar()</code></a> checks whether the curve point defined by the 32 bytes public key is the identity point, non-canonical (&gt;= P), or a member of small (insecure) subgroups. If one of these applies, the key is invalid.</li>\n<li><a href=\"https://github.com/bcgit/bc-java/blob/r1rv81/core/src/main/java/org/bouncycastle/math/ec/rfc8032/Ed25519.java#L290\" rel=\"nofollow noreferrer\"><code>decodePointVar()</code></a> attempts to reconstruct the x-coordinate of the curve point from the 32 bytes public key. If this is not successful, the key is invalid (s. RFC 8032, <a href=\"https://datatracker.ietf.org/doc/html/rfc8032#section-5.1.3\" rel=\"nofollow noreferrer\">5.1.3</a>).</li>\n<li><a href=\"https://github.com/bcgit/bc-java/blob/r1rv81/core/src/main/java/org/bouncycastle/math/ec/rfc8032/Ed25519.java#L248\" rel=\"nofollow noreferrer\"><code>checkPointOrderVar()</code></a> multiplies the curve point defined by the 32 bytes public key by the order of the curve. If this operation does not give the identity point, the key is invalid (because then the curve point is not in the prime order subgroup).</li>\n</ol>\n<p>The BouncyCastle tests contain some <a href=\"https://github.com/bcgit/bc-java/blob/r1rv81/core/src/test/java/org/bouncycastle/math/ec/rfc8032/test/Ed25519Test.java#L439\" rel=\"nofollow noreferrer\">examples</a> for <code>validatePublicKeyFull()</code>.</p>\n<hr />\n<p>Besides <code>validatePublicKeyFull()</code>, there is also <a href=\"https://github.com/bcgit/bc-java/blob/r1rv81/core/src/main/java/org/bouncycastle/math/ec/rfc8032/Ed25519.java#L1530\" rel=\"nofollow noreferrer\"><code>validatePublicKeyPartial()</code></a>, which only performs the first two checks (1) and (2).<br />\n<code>validatePublicKeyPartial()</code> is intended for a faster validation, which only checks basic properties but does not guarantee validity, while <code>validatePublicKeyFull()</code> guarantees validity.</p>\n",
    "score" : 2,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 12359353,
      "reputation" : 50593,
      "user_id" : 9014097,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/Y9EVM.jpg?s=256",
      "display_name" : "Topaco",
      "link" : "https://stackoverflow.com/users/9014097/topaco"
    },
    "creation_date" : 1751707427,
    "last_activity_date" : 1758958289,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140566628,
    "post_id" : 79689193,
    "body" : "You&#39;re welcome. I put my comment as answer.",
    "score" : 1,
    "owner" : {
      "account_id" : 12359353,
      "reputation" : 50593,
      "user_id" : 9014097,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/Y9EVM.jpg?s=256",
      "display_name" : "Topaco",
      "link" : "https://stackoverflow.com/users/9014097/topaco"
    },
    "creation_date" : 1751707501,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140564636,
    "post_id" : 79689193,
    "body" : "@Topaco it seems to work, thank you! If you add it as an answer, I will accept it.",
    "score" : 0,
    "owner" : {
      "account_id" : 9606388,
      "reputation" : 6034,
      "user_id" : 7132300,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/bb0f4dcab67c7a619f1645da889aac69?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "algrid",
      "link" : "https://stackoverflow.com/users/7132300/algrid"
    },
    "creation_date" : 1751623815,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140563114,
    "post_id" : 79689193,
    "body" : "BC exposes <a href=\"https://downloads.bouncycastle.org/java/docs/bcprov-jdk18on-javadoc/org/bouncycastle/math/ec/rfc8032/Ed25519.html#validatePublicKeyFull(byte%5B%5D,int)\" rel=\"nofollow noreferrer\"><code>Ed25519.validatePublicKeyFull()</code></a>, which checks the strict validity of the raw (= 32 bytes) public key according to RFC8032 including whether the point is on the curve, but also further checks (e.g. a small order and non-canonical format check).",
    "score" : 0,
    "owner" : {
      "account_id" : 12359353,
      "reputation" : 50593,
      "user_id" : 9014097,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/Y9EVM.jpg?s=256",
      "display_name" : "Topaco",
      "link" : "https://stackoverflow.com/users/9014097/topaco"
    },
    "creation_date" : 1751569131,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}