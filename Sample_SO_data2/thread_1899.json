{
  "question" : {
    "question_id" : 79669198,
    "title" : "Provide default component width, allow shrinking inside JScrollPane",
    "body" : "<p>Here's what I want.</p>\n<ol>\n<li>I want a component to have a default &quot;preferred&quot; width.</li>\n<li><em>(important)</em> The component is fine with being shrunk to some degree, it's just it shouldn't be displayed in a shrunk state initially.</li>\n<li>I also want it to be inside a <code>JScrollPane</code>.</li>\n</ol>\n<p>Can I square the three together?</p>\n<p>The problem is any component's <code>preferredSize</code> effectively becomes its <code>minimumSize</code> if it's placed inside a <code>JScrollPane</code>, it never shrinks — but it <em>is</em> cropped. I can't meet the second requirement while also meeting the other two. As shown in the second screenshot, the component's cropped (not shrunk) once I shrink the container beyond the component's preferred width.</p>\n<p>I think another way to put it is this: I expect the scroller to &quot;kick in&quot; (e.g. show the scrollbar, if it's &quot;as needed&quot;) <em>only once</em> its components' <em>minimum</em> (not <em>preferred</em>) sizes can no longer be honored.</p>\n<pre class=\"lang-java prettyprint-override\"><code>import javax.swing.BorderFactory;\nimport javax.swing.JFrame;\nimport javax.swing.JPanel;\nimport javax.swing.JScrollPane;\nimport javax.swing.SwingUtilities;\nimport javax.swing.WindowConstants;\nimport java.awt.Color;\nimport java.awt.Dimension;\n\npublic class ScrollPaneDemo {\n\n    public static void main(String[] args) {\n        SwingUtilities.invokeLater(ScrollPaneDemo::launch);\n    }\n\n    private static void launch() {\n        JFrame frame = new JFrame(&quot;ScrollPane Demo&quot;);\n        frame.setContentPane(createScrollPane());\n        frame.setLocationRelativeTo(null);\n        frame.pack();\n        frame.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);\n        frame.setVisible(true);\n    }\n\n    private static JScrollPane createScrollPane() {\n        JScrollPane scrollPane = new JScrollPane(createScrollablePanel());\n        scrollPane.setHorizontalScrollBarPolicy(JScrollPane.HORIZONTAL_SCROLLBAR_NEVER);\n        return scrollPane;\n    }\n\n    private static JPanel createScrollablePanel() {\n        JPanel panel = new JPanel();\n        panel.setBorder(BorderFactory.createLineBorder(Color.RED, 3));\n        panel.setPreferredSize(new Dimension(250, 150));\n        return panel;\n    }\n}\n</code></pre>\n<p><a href=\"https://i.sstatic.net/8PV3O9TK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/8PV3O9TK.png\" alt=\"container exceeds the component's preferred width\" /></a></p>\n<p><a href=\"https://i.sstatic.net/9QIl9pdK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/9QIl9pdK.png\" alt=\"container is less than the component's preferred width, the component's cropped\" /></a></p>\n",
    "tags" : [ "java", "swing" ],
    "owner" : {
      "account_id" : 10187542,
      "reputation" : 2683,
      "user_id" : 20692967,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/NZSXm.jpg?s=256",
      "display_name" : "Sergey Zolotarev",
      "link" : "https://stackoverflow.com/users/20692967/sergey-zolotarev"
    },
    "is_answered" : true,
    "view_count" : 101,
    "answer_count" : 2,
    "score" : 3,
    "last_activity_date" : 1750255633,
    "creation_date" : 1750167772,
    "link" : "https://stackoverflow.com/questions/79669198/provide-default-component-width-allow-shrinking-inside-jscrollpane",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79670132,
    "question_id" : 79669198,
    "body" : "<p>I implemented VGR's idea. It works.</p>\n<h1>Scenario #1: reference to <code>JScrollPane</code> available at instantiation</h1>\n<pre><code>private static JScrollPane createScrollPane() {\n    JScrollPane scrollPane = new JScrollPane();\n    scrollPane.setViewportView(createScrollablePanel(scrollPane));\n    scrollPane.setHorizontalScrollBarPolicy(JScrollPane.HORIZONTAL_SCROLLBAR_NEVER);\n    return scrollPane;\n}\n\nprivate static JPanel createScrollablePanel(JScrollPane scrollPane) {\n    JPanel panel = new ScrollablePanel(scrollPane);\n    panel.setBorder(BorderFactory.createLineBorder(Color.RED, 3));\n    panel.setPreferredSize(new Dimension(350, 250)); // not honored\n    panel.setMinimumSize(new Dimension(200, 250)); // honored\n    return panel;\n}\n\nprivate static class ScrollablePanel extends JPanel implements Scrollable {\n\n    private final JViewport viewport;\n\n    private ScrollablePanel(JScrollPane scrollPane) {\n        this(scrollPane.getViewport());\n    }\n\n    private ScrollablePanel(JViewport viewport) {\n        this.viewport = viewport;\n    }\n\n    @Override\n    public Dimension getPreferredScrollableViewportSize() {\n        return getPreferredSize();\n    }\n\n    @Override\n    public int getScrollableUnitIncrement(Rectangle visibleRect, int orientation, int direction) {\n        return 5; // arbitrary\n    }\n\n    @Override\n    public int getScrollableBlockIncrement(Rectangle visibleRect, int orientation, int direction) {\n        return 10; // arbitrary\n    }\n\n    @Override\n    public boolean getScrollableTracksViewportWidth() {\n        return getMinimumSize().getWidth() &lt;= viewport.getWidth();\n    }\n\n    @Override\n    public boolean getScrollableTracksViewportHeight() {\n        return getMinimumSize().getHeight() &lt;= viewport.getHeight();\n    }\n}\n</code></pre>\n<p><a href=\"https://i.sstatic.net/Ums7IRuE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/Ums7IRuE.png\" alt=\"the component's shown in its preferred size\" /></a></p>\n<p><a href=\"https://i.sstatic.net/5337qXBH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/5337qXBH.png\" alt=\"the component's shrunk beyond its preferred width as the viewport's shrunk\" /></a></p>\n<p><a href=\"https://i.sstatic.net/GsUKFPpQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/GsUKFPpQ.png\" alt=\"the viewport's shrunk beyond the component's minimum width, the component's cropped\" /></a></p>\n<h1>Scenario #2: reference to <code>JScrollPane</code> <strong>not</strong> available at instantiation</h1>\n<pre class=\"lang-java prettyprint-override\"><code>    private static JPanel createScrollablePanel() {\n        JPanel panel = new ScrollablePanel();\n        panel.setBorder(BorderFactory.createLineBorder(Color.RED, 3));\n        panel.setPreferredSize(new Dimension(250, 150)); // not honored\n        panel.setMinimumSize(new Dimension(150, 150)); // honored\n        return panel;\n    }\n\n    private static class ScrollablePanel extends JPanel implements Scrollable {\n\n        private JScrollPane scrollPane;\n\n        @Override\n        public Dimension getPreferredScrollableViewportSize() {\n            return getPreferredSize();\n        }\n\n        @Override\n        public int getScrollableUnitIncrement(Rectangle visibleRect, int orientation, int direction) {\n            if (scrollPaneNotFound()) return 5; // arbitrary\n            JScrollBar scrollBar = scrollPane.getVerticalScrollBar();\n            return scrollBar.getUnitIncrement();\n        }\n\n        private boolean scrollPaneNotFound() {\n            return !scrollPaneFound();\n        }\n\n        private boolean scrollPaneFound() {\n            if (scrollPane != null) return true;\n            scrollPane = findScrollPane().orElse(null);\n            return scrollPane != null;\n        }\n\n        public Optional&lt;JScrollPane&gt; findScrollPane() {\n            JScrollPane scrollPane = (JScrollPane) SwingUtilities.getAncestorOfClass(JScrollPane.class, this);\n            return Optional.ofNullable(scrollPane);\n        }\n\n        @Override\n        public int getScrollableBlockIncrement(Rectangle visibleRect, int orientation, int direction) {\n            if (scrollPaneNotFound()) return 10; // arbitrary\n            JScrollBar scrollBar = scrollPane.getVerticalScrollBar();\n            return scrollBar.getBlockIncrement();\n        }\n\n        @Override\n        public boolean getScrollableTracksViewportWidth() {\n            if (scrollPaneNotFound()) return false;\n            return getMinimumSize().getWidth() &lt;= scrollPane.getViewport().getWidth();\n        }\n\n        @Override\n        public boolean getScrollableTracksViewportHeight() {\n            if (scrollPaneNotFound()) return false;\n            return getMinimumSize().getHeight() &lt;= scrollPane.getViewport().getHeight();\n        }\n    }\n</code></pre>\n<h2>Caveat</h2>\n<p>It won't work if the component is not directly set as the scroller's view.</p>\n<pre class=\"lang-java prettyprint-override\"><code>    private static JScrollPane createScrollPane() {\n        JScrollPane scrollPane = new JScrollPane();\n\n        JPanel panel = new JPanel(new BorderLayout()); // this will break everything\n        panel.add(createScrollablePanel());\n\n        scrollPane.setViewportView(panel);\n        scrollPane.setHorizontalScrollBarPolicy(JScrollPane.HORIZONTAL_SCROLLBAR_NEVER);\n        return scrollPane;\n    }\n</code></pre>\n<p>It's because <code>ScrollPaneLayout</code> doesn't search for <code>Scrollable</code>s recursively:</p>\n<pre class=\"lang-java prettyprint-override\"><code>// javax.swing.ScrollPaneLayout#layoutContainer\n        if (!isEmpty &amp;&amp; view instanceof Scrollable) {\n            sv = (Scrollable)view;\n            viewTracksViewportWidth = sv.getScrollableTracksViewportWidth();\n            viewTracksViewportHeight = sv.getScrollableTracksViewportHeight();\n        }\n</code></pre>\n",
    "score" : 2,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 10187542,
      "reputation" : 2683,
      "user_id" : 20692967,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/NZSXm.jpg?s=256",
      "display_name" : "Sergey Zolotarev",
      "link" : "https://stackoverflow.com/users/20692967/sergey-zolotarev"
    },
    "creation_date" : 1750228951,
    "last_activity_date" : 1750243826,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79670770,
    "question_id" : 79669198,
    "body" : "<p>If I understand the requirement you use the <code>ScrollablePanel</code> with the &quot;FIT&quot; parameter:</p>\n<pre><code>import javax.swing.BorderFactory;\nimport javax.swing.JFrame;\nimport javax.swing.JPanel;\nimport javax.swing.JScrollPane;\nimport javax.swing.SwingUtilities;\nimport javax.swing.WindowConstants;\nimport java.awt.*;\nimport java.awt.Dimension;\n\npublic class ScrollPaneDemo {\n\n    public static void main(String[] args) {\n        SwingUtilities.invokeLater(ScrollPaneDemo::launch);\n    }\n\n    private static void launch() {\n        JFrame frame = new JFrame(&quot;ScrollPane Demo&quot;);\n        frame.setContentPane(createScrollPane());\n        frame.setLocationRelativeTo(null);\n        frame.pack();\n        frame.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);\n        frame.setVisible(true);\n    }\n\n    private static JScrollPane createScrollPane() {\n        JScrollPane scrollPane = new JScrollPane(createScrollablePanel());\n        scrollPane.setHorizontalScrollBarPolicy(JScrollPane.HORIZONTAL_SCROLLBAR_NEVER);\n        return scrollPane;\n    }\n\n    private static JPanel createScrollablePanel() {\n//        JPanel panel = new JPanel();\n        ScrollablePanel panel = new ScrollablePanel();\n        panel.setScrollableWidth( ScrollablePanel.ScrollableSizeHint.FIT );\n        panel.setBorder(BorderFactory.createLineBorder(Color.RED, 3));\n        panel.setPreferredSize(new Dimension(250, 150));\n        return panel;\n    }\n}\n</code></pre>\n<p>If none of the parameters do exactly what you require, then yes, you will need to do a custom implementation the implements the Scrollable interface.</p>\n",
    "score" : 1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 44852,
      "reputation" : 324711,
      "user_id" : 131872,
      "user_type" : "registered",
      "accept_rate" : 100,
      "profile_image" : "https://www.gravatar.com/avatar/a0ced8e21d2a761db718acb6362b9225?s=256&d=identicon&r=PG",
      "display_name" : "camickr",
      "link" : "https://stackoverflow.com/users/131872/camickr"
    },
    "creation_date" : 1750255314,
    "last_activity_date" : 1750255633,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140523245,
    "post_id" : 79669198,
    "body" : "@VGR also, please see the edit to my answer. It&#39;s a significant limitation. Any workarounds you can think of?",
    "score" : 0,
    "owner" : {
      "account_id" : 10187542,
      "reputation" : 2683,
      "user_id" : 20692967,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/NZSXm.jpg?s=256",
      "display_name" : "Sergey Zolotarev",
      "link" : "https://stackoverflow.com/users/20692967/sergey-zolotarev"
    },
    "creation_date" : 1750242636,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140522988,
    "post_id" : 79669198,
    "body" : "@VGR Without &quot;custom creating&quot;, the containers are always <code>new JPanel()</code>s. While it doesn&#39;t really relate to this particular question, do you have some suggestions in mind?",
    "score" : 0,
    "owner" : {
      "account_id" : 10187542,
      "reputation" : 2683,
      "user_id" : 20692967,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/NZSXm.jpg?s=256",
      "display_name" : "Sergey Zolotarev",
      "link" : "https://stackoverflow.com/users/20692967/sergey-zolotarev"
    },
    "creation_date" : 1750237458,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140522987,
    "post_id" : 79669198,
    "body" : "@VGR I implemented your suggestion (see my answer). It works., thank you! However, in <a href=\"https://www.jetbrains.com/help/idea/gui-designer.html\" rel=\"nofollow noreferrer\">GUI Designer</a>, you can&#39;t have custom containers without &quot;custom creating&quot; them which requires a field and an instantiation statement in <code>createUIComponents()</code> for each of your containers (nested forms are not an option, it would make the type count explode). If composition is complex, it would bloat the field count massively",
    "score" : 0,
    "owner" : {
      "account_id" : 10187542,
      "reputation" : 2683,
      "user_id" : 20692967,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/NZSXm.jpg?s=256",
      "display_name" : "Sergey Zolotarev",
      "link" : "https://stackoverflow.com/users/20692967/sergey-zolotarev"
    },
    "creation_date" : 1750237438,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140522623,
    "post_id" : 79669198,
    "body" : "@camickr can you refactor VGR&#39;s solution (see my answer) to use <i>your</i> <code>ScrollablePanel</code>? If so, please post",
    "score" : 0,
    "owner" : {
      "account_id" : 10187542,
      "reputation" : 2683,
      "user_id" : 20692967,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/NZSXm.jpg?s=256",
      "display_name" : "Sergey Zolotarev",
      "link" : "https://stackoverflow.com/users/20692967/sergey-zolotarev"
    },
    "creation_date" : 1750229175,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140521388,
    "post_id" : 79669198,
    "body" : "Check out the <a href=\"https://tips4java.wordpress.com/2009/12/20/scrollable-panel/\" rel=\"nofollow noreferrer\">Scrollable Panel</a> which implements Scrollable and allows you to configure some properties.",
    "score" : 1,
    "owner" : {
      "account_id" : 44852,
      "reputation" : 324711,
      "user_id" : 131872,
      "user_type" : "registered",
      "accept_rate" : 100,
      "profile_image" : "https://www.gravatar.com/avatar/a0ced8e21d2a761db718acb6362b9225?s=256&d=identicon&r=PG",
      "display_name" : "camickr",
      "link" : "https://stackoverflow.com/users/131872/camickr"
    },
    "creation_date" : 1750182488,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140521293,
    "post_id" : 79669198,
    "body" : "Have the getScrollableTracksViewportWidth method (and perhaps also getScrollableTracksViewportHeight) return true, unless the panel’s minimum size is larger than its parent JViewport’s size.",
    "score" : 0,
    "owner" : {
      "account_id" : 2053598,
      "reputation" : 44991,
      "user_id" : 1831987,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/38b1c37530189ec4471a43a618e33f67?s=256&d=identicon&r=PG",
      "display_name" : "VGR",
      "link" : "https://stackoverflow.com/users/1831987/vgr"
    },
    "creation_date" : 1750180494,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140520826,
    "post_id" : 79669198,
    "body" : "@VGR can you elaborate a little?",
    "score" : 0,
    "owner" : {
      "account_id" : 10187542,
      "reputation" : 2683,
      "user_id" : 20692967,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/NZSXm.jpg?s=256",
      "display_name" : "Sergey Zolotarev",
      "link" : "https://stackoverflow.com/users/20692967/sergey-zolotarev"
    },
    "creation_date" : 1750172361,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140520682,
    "post_id" : 79669198,
    "body" : "You may be able to solve this by making a subclass of JPanel that implements <a href=\"https://docs.oracle.com/en/java/javase/24/docs/api/java.desktop/javax/swing/Scrollable.html\" rel=\"nofollow noreferrer\">Scrollable</a>.",
    "score" : 3,
    "owner" : {
      "account_id" : 2053598,
      "reputation" : 44991,
      "user_id" : 1831987,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/38b1c37530189ec4471a43a618e33f67?s=256&d=identicon&r=PG",
      "display_name" : "VGR",
      "link" : "https://stackoverflow.com/users/1831987/vgr"
    },
    "creation_date" : 1750169987,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79670132" : [ {
      "comment_id" : 140537801,
      "post_id" : 79670132,
      "body" : "It doesn’t work when you wrap the <code>Scrollable</code> in another <code>JPanel</code> but it would work if you wrap it in a <code>JLayer</code> which allows all sorts of customizations.",
      "score" : 1,
      "owner" : {
        "account_id" : 3211603,
        "reputation" : 301001,
        "user_id" : 2711488,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/t2hoD.jpg?s=256",
        "display_name" : "Holger",
        "link" : "https://stackoverflow.com/users/2711488/holger"
      },
      "creation_date" : 1750760710,
      "content_license" : "CC BY-SA 4.0"
    } ],
    "79670770" : [ {
      "comment_id" : 140538449,
      "post_id" : 79670770,
      "body" : "I think, an answer should be self-contained and not require readers to search for a comment at a different post.",
      "score" : 1,
      "owner" : {
        "account_id" : 3211603,
        "reputation" : 301001,
        "user_id" : 2711488,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/t2hoD.jpg?s=256",
        "display_name" : "Holger",
        "link" : "https://stackoverflow.com/users/2711488/holger"
      },
      "creation_date" : 1750773025,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140537962,
      "post_id" : 79670770,
      "body" : "It comes from Rob&#39;s blog (see the comments)",
      "score" : 0,
      "owner" : {
        "account_id" : 10187542,
        "reputation" : 2683,
        "user_id" : 20692967,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/NZSXm.jpg?s=256",
        "display_name" : "Sergey Zolotarev",
        "link" : "https://stackoverflow.com/users/20692967/sergey-zolotarev"
      },
      "creation_date" : 1750763469,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140537766,
      "post_id" : 79670770,
      "body" : "Where does <code>ScrollablePanel</code> come from? It does not even appear in the <code>import</code>s.",
      "score" : 1,
      "owner" : {
        "account_id" : 3211603,
        "reputation" : 301001,
        "user_id" : 2711488,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/t2hoD.jpg?s=256",
        "display_name" : "Holger",
        "link" : "https://stackoverflow.com/users/2711488/holger"
      },
      "creation_date" : 1750759955,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140524067,
      "post_id" : 79670770,
      "body" : "Thank you. But the page you linked (and wrote) says, <i>&quot;Scrollbars will <b>never</b> appear.&quot;</i> They are <i>expected</i> to appear if the minimal dimensions can&#39;t be met",
      "score" : 0,
      "owner" : {
        "account_id" : 10187542,
        "reputation" : 2683,
        "user_id" : 20692967,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/NZSXm.jpg?s=256",
        "display_name" : "Sergey Zolotarev",
        "link" : "https://stackoverflow.com/users/20692967/sergey-zolotarev"
      },
      "creation_date" : 1750258448,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}