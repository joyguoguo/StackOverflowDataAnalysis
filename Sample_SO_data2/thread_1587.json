{
  "question" : {
    "question_id" : 79696044,
    "title" : "Java cacerts of type JKS is being loaded while the KeyStore.getDefaultType() is still PKCS12",
    "body" : "<p><code>cacerts</code>, the default truststore of Java is of type JKS in OpenJDK 17. So while trying to load it, I have KeyStore.getDefaultType() set to PKCS12 by default and I am still able to load them.</p>\n<p>I've tried following approach to load them and there were no issues,</p>\n<pre class=\"lang-java prettyprint-override\"><code>import javax.net.ssl.TrustManagerFactory;\nimport java.io.FileInputStream;\nimport java.security.KeyStore;\n\npublic class MyClass {\n    public static void main(String[] args) throws Exception {\n        String defaultType = KeyStore.getDefaultType();\n        System.out.println(&quot;Default Keystore Type: &quot; + defaultType);\n        \n        String javaHome = System.getProperty(&quot;java.home&quot;);\n        String cacertsPath = javaHome + &quot;/lib/security/cacerts&quot;;\n        KeyStore trustStore = KeyStore.getInstance(defaultType);\n        \n        try (FileInputStream fis = new FileInputStream(cacertsPath)) {\n            trustStore.load(fis, &quot;changeit&quot;.toCharArray());\n        }\n        TrustManagerFactory tmf = TrustManagerFactory.getInstance(TrustManagerFactory.getDefaultAlgorithm());\n        tmf.init(trustStore);\n\n        System.out.println(&quot;Loaded truststore with &quot; + trustStore.size() + &quot; entries&quot;);\n    }\n}\n</code></pre>\n<p>I was expecting an error to be thrown since the types are mismatching. But that isn't happening. Why is it so?</p>\n<p>Find snippet for the same code <a href=\"https://www.jdoodle.com/ga/APmwxS53HZFIV2pQetZX5g%3D%3D\" rel=\"nofollow noreferrer\">here</a></p>\n<p>Snippet showing the type of <code>cacerts</code> file can be viewed <a href=\"https://www.jdoodle.com/ga/9xl7yusnzfJeZwbuvQW5lg%3D%3D\" rel=\"nofollow noreferrer\">here</a></p>\n",
    "tags" : [ "java", "keystore", "jks", "java-security", "cacerts" ],
    "owner" : {
      "account_id" : 16655382,
      "reputation" : 163,
      "user_id" : 12036945,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a-/AAuE7mAKawswmaMggsTGzOHtracsZ6VbwFndxdN-O_wSOA=k-s256",
      "display_name" : "Kiran Deep",
      "link" : "https://stackoverflow.com/users/12036945/kiran-deep"
    },
    "is_answered" : true,
    "view_count" : 87,
    "answer_count" : 1,
    "score" : 1,
    "last_activity_date" : 1752148237,
    "creation_date" : 1752082976,
    "link" : "https://stackoverflow.com/questions/79696044/java-cacerts-of-type-jks-is-being-loaded-while-the-keystore-getdefaulttype-is",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79696865,
    "question_id" : 79696044,
    "body" : "<p>In order to make this thing work as expected we can set the JVM arg,<br />\n<code>keystore.type.compat=false</code></p>\n<p>By default the value is set to <code>true</code> and can be found at\n<code>$JAVA_HOME/conf/security/java.security</code></p>\n<blockquote>\n<p>Controls compatibility mode for JKS and PKCS12 keystore types.</p>\n<p>When set to 'true', both JKS and PKCS12 keystore types support loading\nkeystore files in either JKS or PKCS12 format. When set to 'false' the\nJKS keystore type supports loading only JKS keystore files and the PKCS12\nkeystore type supports loading only PKCS12 keystore files.</p>\n<p><code>keystore.type.compat=true</code></p>\n</blockquote>\n",
    "score" : 3,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 16655382,
      "reputation" : 163,
      "user_id" : 12036945,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a-/AAuE7mAKawswmaMggsTGzOHtracsZ6VbwFndxdN-O_wSOA=k-s256",
      "display_name" : "Kiran Deep",
      "link" : "https://stackoverflow.com/users/12036945/kiran-deep"
    },
    "creation_date" : 1752141580,
    "last_activity_date" : 1752148237,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : { }
}