{
  "question" : {
    "question_id" : 79727513,
    "title" : "API 35 - Handle edge-to-edge in PreferenceFragmentCompat during landscape mode",
    "body" : "<p>I am working on edge-to-edge, API 35, for a Material 2, Java Android project.</p>\n<p>I use the following guideline when performing edge-to-edge setup</p>\n<ol>\n<li><code>AppBarLayout</code> = <code>android:fitsSystemWindows=&quot;true&quot;</code></li>\n<li><code>DrawerLayout</code> = Not set</li>\n<li><code>NavigationView</code> = Not set</li>\n</ol>\n<p>During activity <code>onCreate</code>, I am calling this function.</p>\n<pre><code>private void edgeToEdgeIfPossible(boolean windowLightStatusBar) {\n    if (windowLightStatusBar) {\n        EdgeToEdge.enable(\n                this,\n                SystemBarStyle.light(\n                        ContextCompat.getColor(this, android.R.color.transparent),\n                        ContextCompat.getColor(this, android.R.color.transparent)\n                )\n        );\n    } else {\n        EdgeToEdge.enable(\n                this,\n                SystemBarStyle.dark(\n                        ContextCompat.getColor(this, android.R.color.transparent)\n                )\n        );\n    }\n}\n</code></pre>\n<p>To handle landscape mode in <code>PreferenceFragmentCompat</code>, we have the following code</p>\n<pre><code>private void edgeToEdgeIfPossible() {\n    final RecyclerView recyclerView = getListView();\n\n    if (recyclerView != null) {\n        // 1. Allow content to be drawn behind the navigation bar\n        recyclerView.setClipToPadding(false);\n\n        // Store the original padding of the RecyclerView. This is crucial\n        // to preserve any theme-defined padding.\n        final Rect initialPadding = new Rect(\n                recyclerView.getPaddingLeft(),\n                recyclerView.getPaddingTop(),\n                recyclerView.getPaddingRight(),\n                recyclerView.getPaddingBottom()\n        );\n\n        // 2. Apply a listener to handle window insets for all orientations\n        ViewCompat.setOnApplyWindowInsetsListener(recyclerView, (v, insets) -&gt; {\n            // Get the insets for the system bars (status bar, navigation bar)\n            Insets theInsets = insets.getInsets(\n                    WindowInsetsCompat.Type.systemBars() | WindowInsetsCompat.Type.displayCutout()\n            );\n\n            v.setPadding(\n                    initialPadding.left + theInsets.left,\n                    initialPadding.top + 0,\n                    initialPadding.right + theInsets.right,\n                    initialPadding.bottom + theInsets.bottom\n            );\n\n            // Return the insets to allow the system to continue processing them\n            return insets;\n        });\n    }\n}\n</code></pre>\n<p><a href=\"https://i.sstatic.net/eYKPwzvI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/eYKPwzvI.png\" alt=\"enter image description here\" /></a></p>\n<p>I was wondering, should we provide left margin for the toolbar? If yes, how we should do it?</p>\n",
    "tags" : [ "java", "android", "xml", "edge-to-edge" ],
    "owner" : {
      "account_id" : 27431,
      "reputation" : 42870,
      "user_id" : 72437,
      "user_type" : "registered",
      "accept_rate" : 86,
      "profile_image" : "https://i.sstatic.net/ay0Dg.jpg?s=256",
      "display_name" : "Cheok Yan Cheng",
      "link" : "https://stackoverflow.com/users/72437/cheok-yan-cheng"
    },
    "is_answered" : true,
    "view_count" : 366,
    "answer_count" : 2,
    "score" : 1,
    "last_activity_date" : 1755253866,
    "creation_date" : 1754494423,
    "link" : "https://stackoverflow.com/questions/79727513/api-35-handle-edge-to-edge-in-preferencefragmentcompat-during-landscape-mode",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79730324,
    "question_id" : 79727513,
    "body" : "<p>According to the Material 2 <a href=\"https://m2.material.io/components/app-bars-top#specs\" rel=\"nofollow noreferrer\">specs</a> for an <code>AppBar</code>, this is meant to be <code>16dp</code> offset to the screen edge. While I think that Material 3 might rather be suitable for edge-to-edge; at least most documentation seems to use it.</p>\n<ul>\n<li>In XMl, <code>AppBarLayout</code> needs <code>android:fitsSystemWindows=&quot;true&quot;</code> to handle top insets.</li>\n<li>With Compose / M3, this works similar: <a href=\"https://developer.android.com/develop/ui/compose/layouts/insets#material3-components\" rel=\"nofollow noreferrer\">Material Components in Compose</a>.</li>\n</ul>\n<p>Concerning the insets, the documentation has two relevant articles:</p>\n<ul>\n<li><p><a href=\"https://developer.android.com/develop/ui/compose/system/insets#system-bar-icons\" rel=\"nofollow noreferrer\">About window insets</a></p>\n</li>\n<li><p><a href=\"https://developer.android.com/develop/ui/views/layout/edge-to-edge#backward-compatible-dispatching\" rel=\"nofollow noreferrer\">Backward compatible inset dispatching</a></p>\n</li>\n</ul>\n<p>Which suggests to use <code>androidx.core:core:1.16.0</code> or later to test the insets:</p>\n<pre><code>// Call before consuming insets\nViewGroupCompat.installCompatInsetsDispatch(rootView);\n</code></pre>\n<p>With status-bar &amp; app-bar vertically stacked, this isn't exactly edge-to-edge.</p>\n<blockquote>\n<p>Use offsets to avoid displaying important content and touch targets behind system bars.</p>\n</blockquote>\n<p>There's two new properties: <code>android:enforceNavigationBarContrast=&quot;false&quot;</code> and <code>android:enforceStatusBarContrast=&quot;false&quot;</code>. It is suggest to use this listener: <a href=\"https://developer.android.com/reference/androidx/core/view/WindowInsetsControllerCompat\" rel=\"nofollow noreferrer\"><code>WindowInsetsControllerCompat.OnControllableInsetsChangedListener</code></a>.</p>\n",
    "score" : 1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 263656,
      "reputation" : 79658,
      "user_id" : 549372,
      "user_type" : "registered",
      "accept_rate" : 100,
      "profile_image" : "https://www.gravatar.com/avatar/430cfd8b3056a0425f950cb1c6abd208?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Martin Zeitler",
      "link" : "https://stackoverflow.com/users/549372/martin-zeitler"
    },
    "creation_date" : 1754696919,
    "last_activity_date" : 1754697240,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79736331,
    "question_id" : 79727513,
    "body" : "<p>When working with edge-to-edge layouts on Android, especially with AppBarLayout and a Toolbar inside it, handling system window insets properly is crucial to avoid your UI being obscured by system bars or display cutouts.</p>\n<p><strong>Should you provide a left margin (or padding) for the Toolbar?</strong></p>\n<p>Usually, yes, you want to apply the left inset as padding to the Toolbar, so the toolbar content (like the navigation icon and title) doesn’t get overlapped by system gestures or the display cutout on devices with curved edges or notches.</p>\n<p><strong>How to handle left padding/margin for Toolbar with edge-to-edge?</strong></p>\n<p>Since you are doing edge-to-edge with transparent system bars, you want your Toolbar to extend under the status bar and system gestures area, but visually keep the content offset to avoid overlap.</p>\n<p><strong>Recommended approach:</strong></p>\n<p>Use WindowInsetsCompat to get the left inset and apply it as padding to the Toolbar.</p>\n<p>Here’s a typical way:</p>\n<pre><code>ViewCompat.setOnApplyWindowInsetsListener(toolbar, (v, insets) -&gt; {\n    Insets systemBarsInsets = insets.getInsets(WindowInsetsCompat.Type.systemBars());\n\n    v.setPadding(\n        systemBarsInsets.left,    // Add left inset as padding\n        v.getPaddingTop(),        // Preserve original top padding (usually status bar height is handled by fitsSystemWindows or AppBarLayout)\n        v.getPaddingRight(),      // Preserve right padding\n        v.getPaddingBottom()      // Preserve bottom padding\n    );\n\n    return insets;\n});\n</code></pre>\n<p><strong>Why padding, not margin?</strong></p>\n<p>Padding pushes the content inside the Toolbar inward, keeping the background color or elevation full width.</p>\n<p>Margin would create space outside the Toolbar, which may not behave as nicely with elevation/shadows and the overall layout.</p>\n<p><strong>Important:</strong></p>\n<p>You already have AppBarLayout set with android:fitsSystemWindows=&quot;true&quot;, which means the system will handle status bar insets on it.</p>\n<p>But for the left inset, usually related to system gesture navigation on some devices (e.g., Pixel 4 gesture navigation on the left edge), you should apply that manually to the Toolbar’s padding.</p>\n<p>This keeps your navigation icon clickable and visible, not overlapped by gesture areas.</p>\n<p><strong>Summary</strong></p>\n<p>Keep fitsSystemWindows=&quot;true&quot; on AppBarLayout.</p>\n<p>On your Toolbar inside it, add a WindowInsets listener to apply left padding based on system bars inset.</p>\n<p>Don’t set margin — use padding to keep the Toolbar full width but offset its content.</p>\n",
    "score" : -1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 1096470,
      "reputation" : 29424,
      "user_id" : 1089967,
      "user_type" : "registered",
      "accept_rate" : 59,
      "profile_image" : "https://www.gravatar.com/avatar/1f256b904ff621d678598d8fa49f86c5?s=256&d=identicon&r=PG",
      "display_name" : "lance-java",
      "link" : "https://stackoverflow.com/users/1089967/lance-java"
    },
    "creation_date" : 1755253866,
    "last_activity_date" : 1755253866,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140652957,
    "post_id" : 79727513,
    "body" : "Does the <code>ViewCompat.setOnApplyWindowInsetsListener</code> callback get triggered every time the device orientation changed?",
    "score" : 0,
    "owner" : {
      "account_id" : 13654747,
      "reputation" : 41291,
      "user_id" : 9851608,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/WlSRX.png?s=256",
      "display_name" : "Zain",
      "link" : "https://stackoverflow.com/users/9851608/zain"
    },
    "creation_date" : 1754686773,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}