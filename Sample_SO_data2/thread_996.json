{
  "question" : {
    "question_id" : 79747790,
    "title" : "SpringBoot 4 Redis session and ViewExpiredException",
    "body" : "<p>I'm trying to create the skeleton for a new web app, with SpringBoot 4, JSF 4 and session cluster with redis. Everything works until I try to replicate Spring session with Redis.</p>\n<p>This is abstract of pom.xml</p>\n<pre><code>&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n    xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    \n    &lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;4.0.0-M1&lt;/version&gt;\n        &lt;!--&lt;version&gt;3.5.4&lt;/version&gt;--&gt;\n        &lt;!--&lt;version&gt;4.0.0-M1&lt;/version&gt;--&gt;\n    &lt;/parent&gt;\n    \n    &lt;groupId&gt;cloud.prova1&lt;/groupId&gt;\n    &lt;artifactId&gt;prova&lt;/artifactId&gt;\n    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n    &lt;packaging&gt;war&lt;/packaging&gt;\n    &lt;description&gt;Gestionale per gli Hotel&lt;/description&gt;\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;\n             &lt;scope&gt;provided&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-websocket&lt;/artifactId&gt;\n        &lt;/dependency&gt;       \n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-data-jdbc&lt;/artifactId&gt;\n        &lt;/dependency&gt;   \n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n&lt;!--        \n       &lt;dependency&gt;\n         &lt;groupId&gt;org.springframework.session&lt;/groupId&gt;\n         &lt;artifactId&gt;spring-session-jdbc&lt;/artifactId&gt;\n       &lt;/dependency&gt;\n--&gt;     \n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;\n        &lt;/dependency&gt;           \n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.session&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-session-data-redis&lt;/artifactId&gt;      \n        &lt;/dependency&gt;\n\n&lt;!--        &lt;dependency&gt;\n            &lt;groupId&gt;io.lettuce&lt;/groupId&gt;\n            &lt;artifactId&gt;lettuce-core&lt;/artifactId&gt;\n            &lt;version&gt;6.7.1.RELEASE&lt;/version&gt;\n        &lt;/dependency&gt;   \n        \n        &lt;dependency&gt;\n           &lt;groupId&gt;redis.clients&lt;/groupId&gt;\n          &lt;artifactId&gt;jedis&lt;/artifactId&gt;\n        &lt;/dependency&gt;--&gt;\n\n\n        &lt;!--JSF - Jakarta--&gt;    \n        &lt;dependency&gt;\n            &lt;groupId&gt;org.glassfish&lt;/groupId&gt;\n            &lt;artifactId&gt;jakarta.faces&lt;/artifactId&gt;\n            &lt;version&gt;4.1.2&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;jakarta.faces&lt;/groupId&gt;\n            &lt;artifactId&gt;jakarta.faces-api&lt;/artifactId&gt;\n            &lt;version&gt;4.1.2&lt;/version&gt;\n        &lt;/dependency&gt;\n</code></pre>\n<p>and this is the error:</p>\n<pre><code>27-Aug-2025 11:09:29.637 SEVERE [http-nio-8080-exec-10] com.sun.faces.context.AjaxExceptionHandlerImpl.handlePartialResponseError jakarta.faces.application.ViewExpiredException: viewId:/pages/login.xhtml - View /pages/login.xhtml could not be restored.\n        jakarta.faces.application.ViewExpiredException: viewId:/pages/login.xhtml - View /pages/login.xhtml could not be restored.\n                at com.sun.faces.lifecycle.RestoreViewPhase.execute(RestoreViewPhase.java:165)\n                at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:72)\n                at com.sun.faces.lifecycle.RestoreViewPhase.doPhase(RestoreViewPhase.java:96)\n                at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:131)\n                at jakarta.faces.webapp.FacesServlet.executeLifecyle(FacesServlet.java:689)\n                at jakarta.faces.webapp.FacesServlet.service(FacesServlet.java:449)\n                at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:130)\n                at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)\n                at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:109)\n                at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:108)\n                at org.springframework.security.web.FilterChainProxy.lambda$doFilterInternal$3(FilterChainProxy.java:232)\n                at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:368)\n                at org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(AuthorizationFilter.java:100)\n                at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:377)\n                at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:125)\n                at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:119)\n                at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:377)\n                at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:100)\n                at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:377)\n                at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179)\n                at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:377)\n                at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)\n                at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:377)\n                at org.springframework.security.web.authentication.ui.DefaultLogoutPageGeneratingFilter.doFilterInternal(DefaultLogoutPageGeneratingFilter.java:60)\n                at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)\n                at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:377)\n                at org.springframework.security.web.authentication.ui.DefaultLoginPageGeneratingFilter.doFilter(DefaultLoginPageGeneratingFilter.java:216)\n                at org.springframework.security.web.authentication.ui.DefaultLoginPageGeneratingFilter.doFilter(DefaultLoginPageGeneratingFilter.java:202)\n                at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:377)\n                at org.springframework.security.web.authentication.ui.DefaultResourcesFilter.doFilter(DefaultResourcesFilter.java:73)\n                at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:377)\n                at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:236)\n                at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:230)\n                at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:377)\n                at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:108)\n                at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:94)\n                at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:377)\n                at org.springframework.security.web.csrf.CsrfFilter.doFilterInternal(CsrfFilter.java:134)\n                at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)\n                at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:377)\n                at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)\n                at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)\n                at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)\n                at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:377)\n                at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)\n                at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)\n                at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:377)\n                at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)\n                at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)\n                at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:377)\n                at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)\n                at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)\n                at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:377)\n                at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:234)\n                at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:192)\n                at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)\n                at org.springframework.web.filter.ServletRequestPathFilter.doFilter(ServletRequestPathFilter.java:52)\n                at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)\n                at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)\n                at org.springframework.security.config.annotation.web.configuration.WebSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebSecurityConfiguration.java:317)\n                at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:355)\n                at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:272)\n                at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:109)\n                at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)\n                at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)\n                at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:109)\n                at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)\n                at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)\n                at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:109)\n                at org.springframework.session.web.http.SessionRepositoryFilter.doFilterInternal(SessionRepositoryFilter.java:142)\n                at org.springframework.session.web.http.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:82)\n                at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:109)\n                at org.springframework.boot.web.servlet.support.ErrorPageFilter.doFilter(ErrorPageFilter.java:124)\n                at org.springframework.boot.web.servlet.support.ErrorPageFilter$1.doFilterInternal(ErrorPageFilter.java:99)\n                at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)\n                at org.springframework.boot.web.servlet.support.ErrorPageFilter.doFilter(ErrorPageFilter.java:117)\n                at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:109)\n                at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:199)\n                at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)\n                at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:109)\n                at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)\n                at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:79)\n                at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)\n                at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)\n                at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)\n                at org.apache.catalina.valves.AbstractAccessLogValve.invoke(AbstractAccessLogValve.java:666)\n                at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)\n                at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)\n                at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:396)\n                at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)\n                at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)\n                at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1773)\n                at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)\n                at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n                at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:637)\n                at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:59)\n                at java.base/java.lang.Thread.run(Thread.java:1447)\n</code></pre>\n<p>I've tried several solutions:</p>\n<ul>\n<li>Springboot version 3.5.5</li>\n<li>Session cluster with JDBC</li>\n<li>org.apache.myfaces.USE_ENCRYPTION = fasle (as servlet parameter)</li>\n</ul>\n<p>But I still get the same problem from command button in jsf page\nAny suggestions on how to replicate the session in Spring and JSF are greatly appreciated.</p>\n",
    "tags" : [ "java", "spring-boot", "session", "redis" ],
    "owner" : {
      "account_id" : 2820797,
      "reputation" : 1,
      "user_id" : 2424597,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/742d13ae8051b318fdd47180bab91310?s=256&d=identicon&r=PG",
      "display_name" : "Dade",
      "link" : "https://stackoverflow.com/users/2424597/dade"
    },
    "is_answered" : false,
    "view_count" : 70,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1756294616,
    "creation_date" : 1756287684,
    "link" : "https://stackoverflow.com/questions/79747790/springboot-4-redis-session-and-viewexpiredexception",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ ],
  "answer_comments" : { }
}