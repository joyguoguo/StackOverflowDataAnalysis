{
  "question" : {
    "question_id" : 79656346,
    "title" : "Long term behavior of ScheduledExecutorService.scheduleAtFixedRate when tasks run too long",
    "body" : "<p>I'm using <code>java.util.concurrent.ScheduledExcecutorService.scheduleAtFixedRate</code> to execute a task periodically.  I run it once every minute and it usually completes after 5 seconds, but occasionally runs longer than a minute.  The <code>scheduleAtFixedRate</code> service behaves as I'd expect it to, per the Javadoc: &quot;If any execution of this task takes longer than its period, then subsequent executions may start late, but will not concurrently execute.&quot;  This is the behavior that I want, and I can see that it's working correctly.</p>\n<p>That got me wondering, thoughâ€¦ If the task is set to queue every 60 seconds and I get <em>really</em> unlucky and every iteration ends up taking longer than 60 seconds, will the work queue eventually fill memory and throw an <code>OutOfMemoryException</code>?  I can't find this documented anywhere and the source code does sort of imply that this would be the case.  If it is, is there a more robust way to handle this?</p>\n",
    "tags" : [ "java", "java.util.concurrent" ],
    "owner" : {
      "account_id" : 1398023,
      "reputation" : 1121,
      "user_id" : 1327398,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/225ac437c123dafa9fa55c17b0488773?s=256&d=identicon&r=PG",
      "display_name" : "Joshua Davies",
      "link" : "https://stackoverflow.com/users/1327398/joshua-davies"
    },
    "is_answered" : false,
    "view_count" : 112,
    "answer_count" : 0,
    "score" : 2,
    "last_activity_date" : 1749236711,
    "creation_date" : 1749235123,
    "link" : "https://stackoverflow.com/questions/79656346/long-term-behavior-of-scheduledexecutorservice-scheduleatfixedrate-when-tasks-ru",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140494281,
    "post_id" : 79656346,
    "body" : "If I&#39;m not mistaken, the <code>ScheduledThreadPoolExecutor</code> implementation only schedules the next execution after the current one completes, regardless of fixed-delay or fixed-rate. So, the queue shouldn&#39;t overflow if you get unlucky with a task&#39;s execution time.  Whether that behavior is guaranteed by the <code>ScheduledExecutorService</code> interface, I&#39;m not sure.",
    "score" : 8,
    "owner" : {
      "account_id" : 8532578,
      "reputation" : 49904,
      "user_id" : 6395627,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/af0f9bfe593f36642a032cd7ea611e7d?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Slaw",
      "link" : "https://stackoverflow.com/users/6395627/slaw"
    },
    "creation_date" : 1749240576,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140494264,
    "post_id" : 79656346,
    "body" : "But if each task ends up taking more than 60 seconds, will it still end up being completed and the queue won&#39;t overflow",
    "score" : 1,
    "owner" : {
      "account_id" : 18586978,
      "reputation" : 3850,
      "user_id" : 15000097,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/yFl4M.jpg?s=256",
      "display_name" : "Georgii Lvov",
      "link" : "https://stackoverflow.com/users/15000097/georgii-lvov"
    },
    "creation_date" : 1749240119,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140494253,
    "post_id" : 79656346,
    "body" : "Test it every 1 second and simulate a 2 second delay, with a low heap set and see what happens.",
    "score" : 5,
    "owner" : {
      "account_id" : 372682,
      "reputation" : 26512,
      "user_id" : 721855,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/vZiox.png?s=256",
      "display_name" : "aled",
      "link" : "https://stackoverflow.com/users/721855/aled"
    },
    "creation_date" : 1749239807,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140494241,
    "post_id" : 79656346,
    "body" : "@ryanwebjackson yeah, that might be safer, although I was really hoping to have the task kick off as close to every 60 seconds as possible; fixed delay appears to pause in between iterations no matter how long the iteration took.  I guess if this really does cause problems, I&#39;ll look into that approach, thanks.",
    "score" : 0,
    "owner" : {
      "account_id" : 1398023,
      "reputation" : 1121,
      "user_id" : 1327398,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/225ac437c123dafa9fa55c17b0488773?s=256&d=identicon&r=PG",
      "display_name" : "Joshua Davies",
      "link" : "https://stackoverflow.com/users/1327398/joshua-davies"
    },
    "creation_date" : 1749239413,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140494138,
    "post_id" : 79656346,
    "body" : "It could happen, I believe. What context are you operating under? / Do you need to use scheduleAtFixedRate, or would scheduleWithFixedDelay work?",
    "score" : 2,
    "owner" : {
      "account_id" : 543600,
      "reputation" : 1062,
      "user_id" : 2125723,
      "user_type" : "registered",
      "accept_rate" : 80,
      "profile_image" : "https://www.gravatar.com/avatar/fe638a46efe97afc9c9dd039de54fb6b?s=256&d=identicon&r=PG",
      "display_name" : "ryanwebjackson",
      "link" : "https://stackoverflow.com/users/2125723/ryanwebjackson"
    },
    "creation_date" : 1749235873,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}