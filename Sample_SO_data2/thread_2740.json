{
  "question" : {
    "question_id" : 79600566,
    "title" : "Building a single java project for different jdk versions",
    "body" : "<p>Is there a proper or easy way of building one project for different JDK versions, the project would use different versions of its dependency depending on what JDK version it's built with.</p>\n<p>I have a Java project that is built using JDK8, the project uses <code>javax</code> and its dependencies of course also uses JDK8. Now another project that uses this as a dependency is being upgraded to JDK 17, so that means I need to upgrade the dependency project to JDK 17 as well (I was getting compile errors due to <code>javax</code>), so I upgraded to jakarta and updated the dependencies to more recent versions (some now requiring JDK9 at minimum). This is all fine and I got everything working with JDK 17 and removed all traces of <code>javax</code>.</p>\n<p>My dilemma though is this project is still actively updated and used as a dependency by other projects running on JDK8 (no chance of them being upgraded anytime soon) but since I upgraded it to JDK 17 they now get compile errors because of the jdk version difference. My only option now is to just publish 2 different versions, one jdk8 and one JDK 17.</p>\n<p>The JDK8 would have dependencies with lower version because it's the final version compatible for JDK8, for example</p>\n<pre><code>dependecies {\n    implementation: 'org.example:dependency-a:1.5.0'\n}\n</code></pre>\n<p>But the JDK 17 version would be upgraded (assume I can't use the lower version due to compatibility issues)</p>\n<pre><code>dependecies {\n    implementation: 'org.example:dependency-a:2.0.0'\n}\n</code></pre>\n<p>Assuming all code stays the same for both version and it's just the dependencies that are different, is there a way for me to just have this on a single project and every time I <code>build</code> I would get a JDK8 and JDK 17 version of my project? My only other option is to just maintain 2 separate branches and update, build, and publish both when there are changes.</p>\n",
    "tags" : [ "java", "gradle", "publish", "maven-publish" ],
    "owner" : {
      "account_id" : 7646924,
      "reputation" : 1420,
      "user_id" : 5797253,
      "user_type" : "registered",
      "accept_rate" : 46,
      "profile_image" : "https://www.gravatar.com/avatar/3accd3ee89e21599f1ecad73a853ff9c?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "crimson589",
      "link" : "https://stackoverflow.com/users/5797253/crimson589"
    },
    "is_answered" : false,
    "view_count" : 122,
    "answer_count" : 0,
    "score" : 1,
    "last_activity_date" : 1746280179,
    "creation_date" : 1746024510,
    "link" : "https://stackoverflow.com/questions/79600566/building-a-single-java-project-for-different-jdk-versions",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140388081,
    "post_id" : 79600566,
    "body" : "<a href=\"https://www.baeldung.com/java-multi-release-jar\" rel=\"nofollow noreferrer\">baeldung.com/java-multi-release-jar</a>",
    "score" : 1,
    "owner" : {
      "account_id" : 322981,
      "reputation" : 347089,
      "user_id" : 642706,
      "user_type" : "registered",
      "accept_rate" : 58,
      "profile_image" : "https://i.sstatic.net/ZWEI3.jpg?s=256",
      "display_name" : "Basil Bourque",
      "link" : "https://stackoverflow.com/users/642706/basil-bourque"
    },
    "creation_date" : 1746127780,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140388069,
    "post_id" : 79600566,
    "body" : "If you are dealing with Jakarta EE and the <code>jakarta.*</code> package name change, you need to say so. You Question as currently written is unclear.",
    "score" : 0,
    "owner" : {
      "account_id" : 322981,
      "reputation" : 347089,
      "user_id" : 642706,
      "user_type" : "registered",
      "accept_rate" : 58,
      "profile_image" : "https://i.sstatic.net/ZWEI3.jpg?s=256",
      "display_name" : "Basil Bourque",
      "link" : "https://stackoverflow.com/users/642706/basil-bourque"
    },
    "creation_date" : 1746127522,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140386348,
    "post_id" : 79600566,
    "body" : "In Gradle, you can use <code>if</code> in the <code>dependencies</code> section, and the same can be done for conditionally including or excluding sources from compilation in <code>sourceSets</code>. Though, I would not recommend that for a great change like using jakarta vs javax (which BTW, has nothing to do with Java 8 vs Java 17).",
    "score" : 0,
    "owner" : {
      "account_id" : 213468,
      "reputation" : 110280,
      "user_id" : 466862,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=256&d=identicon&r=PG",
      "display_name" : "Mark Rotteveel",
      "link" : "https://stackoverflow.com/users/466862/mark-rotteveel"
    },
    "creation_date" : 1746082888,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140386344,
    "post_id" : 79600566,
    "body" : "It seems like your question is about Java EE vs Jakarta EE. You might want to take a look at <a href=\"https://github.com/eclipse-transformer/transformer\" rel=\"nofollow noreferrer\">Eclipse Transformer</a> for that (though there are less and less reasons to continue supporting JDK 8 and it gets more expensive the longer you do so). For having different code for different JDKs, you can also use multi-release JARs.",
    "score" : 0,
    "owner" : {
      "account_id" : 15064163,
      "reputation" : 17111,
      "user_id" : 10871900,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/720202b6e19abc330dcd92e6a1254562?s=256&d=identicon&r=PG",
      "display_name" : "dan1st",
      "link" : "https://stackoverflow.com/users/10871900/dan1st"
    },
    "creation_date" : 1746082663,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140385303,
    "post_id" : 79600566,
    "body" : "I believe that a generally accepted way to handle such a situation is <a href=\"https://openjdk.org/jeps/14\" rel=\"nofollow noreferrer\">JEP 14: The Tip &amp; Tail Model of Library Development</a>. In your source control system make branches for Java 8 and Java 17. They say itâ€™s manageable.",
    "score" : 3,
    "owner" : {
      "account_id" : 7612423,
      "reputation" : 87409,
      "user_id" : 5772882,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/8283c64511fa80afed5259d10850168f?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Anonymous",
      "link" : "https://stackoverflow.com/users/5772882/anonymous"
    },
    "creation_date" : 1746039312,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140384610,
    "post_id" : 79600566,
    "body" : "&quot;<i>Assuming all code stays the same for both version and it&#39;s just the dependencies that are different</i>&quot; is not a reasonable.  The package names appear at least in <code>import</code> statements in at least some of your source files, and they appear in the corresponding class files as well.  It may be that you can isolate the classes that must differ so as to maintain different branches only for these, but it&#39;s unclear whether that would provide enough advantage to be worth it.",
    "score" : 3,
    "owner" : {
      "account_id" : 2792262,
      "reputation" : 190832,
      "user_id" : 2402272,
      "user_type" : "registered",
      "accept_rate" : 85,
      "profile_image" : "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=256&d=identicon&r=PG",
      "display_name" : "John Bollinger",
      "link" : "https://stackoverflow.com/users/2402272/john-bollinger"
    },
    "creation_date" : 1746025177,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140384607,
    "post_id" : 79600566,
    "body" : "You can have a common base for compatible things, hence isolating javax/jakarta pains, but two branches for the incompatibilities is easiest IMHO.",
    "score" : 1,
    "owner" : {
      "account_id" : 960307,
      "reputation" : 110397,
      "user_id" : 984823,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/Z2KYN.jpg?s=256",
      "display_name" : "Joop Eggen",
      "link" : "https://stackoverflow.com/users/984823/joop-eggen"
    },
    "creation_date" : 1746025122,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}