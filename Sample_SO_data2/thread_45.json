{
  "question" : {
    "question_id" : 79843454,
    "title" : "How to notify ViewScoped bean from SessionScoped bean with no active request/view context",
    "body" : "<p>I have a Quarkus + Camel + Primefaces app/service which receives messages from AMQ Artemis. The receiving bean is ApplicationScopped and it also re-sends certain events to specific SessionBean(s).</p>\n<p>I have hand rolled SessionBeanRegistry (also ApplicationScoped) and Session bean(s) are self registered, by adding its reference to the list of listeners in SessionBeanRegistry (which is injected into the Session bean(s)) and self unregistered in its PostCostruct and PreDestroy methods. SessionBeanRegistry is injected into another ApplicationScoped bean which is receiving messages from AMQ and then message is forwarded to the Session bean(s) using reference(s) stored in SessionBeanRegistry.</p>\n<p>Is there a good/standard way to forward some events from the SessionBean to currently active related ViewScoped bean(s)? All the forwarding (Camel route -&gt; ApplicationScoped -&gt; SessionScoped -&gt; ViewScopped) happens in the same thread with no active request context, not using any reactive components.</p>\n<p>What I tried with no luck (ViewScoped bean listener is never called) so far:</p>\n<ul>\n<li><p>added @ActivateRequestContext annotation to the ApplicationScoped bean observer method  (called by Camel processor on message arrival from AMQ) and firing event destined to ViewScopped beans from there.</p>\n</li>\n<li><p>tried to make ViewScoped bean to self register as a listener to SessionScoped bean using the object reference. Registration part works, but I cant call the ViewScoped bean by the reference due to &quot;jakarta.enterprise.context.ContextNotActiveException: ViewScoped context was not active when trying to obtain a bean instance for a client proxy of CLASS bean&quot;. Annotating entry method with @ActivateRequestContext doesn't help.</p>\n</li>\n</ul>\n<p>Is this a valid/supported use case? Any pointers for making it work?</p>\n<p>UPDATE: Ditching this approach for a 'standard' way of doing the same -  would get the message from the Session bean(s) in the View/UI and invoke corresponding/bound ViewScoped bean using JavaScript. So, its the same result but from a different side, and <a href=\"https://showcase.omnifaces.org/push/socket\" rel=\"nofollow noreferrer\">https://showcase.omnifaces.org/push/socket</a> makes it pretty straightforward.</p>\n",
    "tags" : [ "java", "primefaces", "quarkus", "cdi" ],
    "owner" : {
      "account_id" : 21801616,
      "reputation" : 31,
      "user_id" : 16100365,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/4c08ca6dceeee7ae359e3c6fc067f730?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "zeppelinux",
      "link" : "https://stackoverflow.com/users/16100365/zeppelinux"
    },
    "is_answered" : false,
    "view_count" : 42,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1765711950,
    "creation_date" : 1765403466,
    "link" : "https://stackoverflow.com/questions/79843454/how-to-notify-viewscoped-bean-from-sessionscoped-bean-with-no-active-request-vie",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140898440,
    "post_id" : 79843454,
    "body" : "I&#39;m agree this is not a standard way to notify user (at the end the UI should be updated on the next http request) about some stuff happening in the system. The only thig that prevents it from working is that @ActivateRequestContext does not make &#39;alive&#39; ViewScoped instances accessible by their references. Im not even sure if this is a valid usage, as being pointed by Jorge and Ladicek, because of differences in JSF and CDI lifecycles. It also can lead to some bad things breaking JSF bindings/state. Abandoning this approach and going to do the same from other way around (using WebSockets).",
    "score" : 0,
    "owner" : {
      "account_id" : 21801616,
      "reputation" : 31,
      "user_id" : 16100365,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/4c08ca6dceeee7ae359e3c6fc067f730?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "zeppelinux",
      "link" : "https://stackoverflow.com/users/16100365/zeppelinux"
    },
    "creation_date" : 1765473633,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140897672,
    "post_id" : 79843454,
    "body" : "In other words, there&#39;s an architectural mismatch that you need to fix.",
    "score" : 0,
    "owner" : {
      "account_id" : 385127,
      "reputation" : 6762,
      "user_id" : 742081,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/238e8b2100a5366b226234b946026462?s=256&d=identicon&r=PG",
      "display_name" : "Ladicek",
      "link" : "https://stackoverflow.com/users/742081/ladicek"
    },
    "creation_date" : 1765445027,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140897670,
    "post_id" : 79843454,
    "body" : "Most scopes (such as <code>@ApplicationScoped</code> or <code>@RequestScoped</code> or <code>@ViewScoped</code>) are <i>normal scopes</i>, which means that what you actually get injected is a <i>client proxy</i>. The client proxy receives invocations and forwards them to the &quot;currently active&quot; instance, as determined by the context implementation. If the context is not currently active, you will get <code>ContextNotActiveException</code>. I don&#39;t know anything about JSF, but it seems <code>@ViewScoped</code> beans are only active during a JSF request. Clearly there&#39;s none when you receive a message from Artemis.",
    "score" : 0,
    "owner" : {
      "account_id" : 385127,
      "reputation" : 6762,
      "user_id" : 742081,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/238e8b2100a5366b226234b946026462?s=256&d=identicon&r=PG",
      "display_name" : "Ladicek",
      "link" : "https://stackoverflow.com/users/742081/ladicek"
    },
    "creation_date" : 1765444977,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140897426,
    "post_id" : 79843454,
    "body" : "I believe you are mixing some concepts here. You are confusing “a bean instance exists” with “its scope’s context is currently active and can be used from this thread”. There is no such thing as active context based on postconstruct/predestroy. I would suggest you to read about the JSF Lifecycle. A context is active only during specific phases of the app lifecycle (e.g. an HTTP request, a JSF view render, etc.). The scenario you want to implement is not even a valid use case IMHO, you should rely on updating a repository/data model from the AMQ and adding some pooling from the view.",
    "score" : 0,
    "owner" : {
      "account_id" : 209503,
      "reputation" : 23867,
      "user_id" : 460557,
      "user_type" : "registered",
      "accept_rate" : 100,
      "profile_image" : "https://www.gravatar.com/avatar/b4565f97815833390c9c880e9e8522e4?s=256&d=identicon&r=PG",
      "display_name" : "Jorge Campos",
      "link" : "https://stackoverflow.com/users/460557/jorge-campos"
    },
    "creation_date" : 1765430208,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140897144,
    "post_id" : 79843454,
    "body" : "@Ladicek by currently active I mean ViewScoped bean that has its PostConstruct method called, but its PreDestroy is not called yet, so it&#39;s active (not destroyed).",
    "score" : 0,
    "owner" : {
      "account_id" : 21801616,
      "reputation" : 31,
      "user_id" : 16100365,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/4c08ca6dceeee7ae359e3c6fc067f730?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "zeppelinux",
      "link" : "https://stackoverflow.com/users/16100365/zeppelinux"
    },
    "creation_date" : 1765405723,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140897123,
    "post_id" : 79843454,
    "body" : "What do you mean by &quot;currently active ViewScoped beans&quot;? Apparently, there are <i>none</i> currently active, so you probably have a different understanding of what &quot;currently active&quot; means, compared to CDI. That&#39;s where the issue stems from.",
    "score" : 0,
    "owner" : {
      "account_id" : 385127,
      "reputation" : 6762,
      "user_id" : 742081,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/238e8b2100a5366b226234b946026462?s=256&d=identicon&r=PG",
      "display_name" : "Ladicek",
      "link" : "https://stackoverflow.com/users/742081/ladicek"
    },
    "creation_date" : 1765404414,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}