{
  "question" : {
    "question_id" : 79591280,
    "title" : "Receive management messages in my own consumer",
    "body" : "<p>I am using embedded ActiveMQ Artemis 2.40.0.</p>\n<p>I would like to track which clients create which temp-queues, so that I can send messages to specific clients.</p>\n<p>My <code>broker.xml</code> snippet:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;management-address&gt;activemq.management&lt;/management-address&gt;\n&lt;addresses&gt;\n  &lt;address name=&quot;activemq.management&quot;&gt;\n    &lt;multicast&gt;\n      &lt;queue name=&quot;activemq.management&quot;/&gt;\n    &lt;/multicast&gt;\n  &lt;/address&gt;\n  ...\n&lt;/addresses&gt;\n</code></pre>\n<p>My code snippet:</p>\n<pre class=\"lang-java prettyprint-override\"><code>ServerLocator locator = ActiveMQClient.createServerLocator(&quot;vm://0&quot;);\nlocator.setMinLargeMessageSize(6291456);\n\nClientSessionFactory clientSessionFactory = locator.createSessionFactory();\nsession_ = clientSessionFactory.createSession(false, true);\n\nClientConsumer notificationConsumer = session_.createConsumer(&quot;activemq.management&quot;);\nnotificationConsumer.setMessageHandler(new MessageHandler() {\n  @Override\n  public void onMessage(ClientMessage clientMessage) {\n    log_.info(&quot;&gt;&gt;&gt; Received notification:&quot;);\n  }\n});\n</code></pre>\n<p>My python client:</p>\n<pre class=\"lang-py prettyprint-override\"><code>#!venv/bin/python3\n\nimport time\nimport stomp\nimport json\nimport uuid\n\nclass MyListener(stomp.ConnectionListener):\n  def on_error(self, frame):\n    print(f&quot;received an error {frame.body}&quot;)\n\n  def on_heartbeat(self):\n    print('on heartbeat')\n\n  def on_disconnected(self):\n    print('on disconnect')\n\n  def on_message(self, frame):\n    print(f&quot;received a message: {frame.body}&quot;)\n    #print(f&quot;received a message: {frame}&quot;)\n\nmyuuid = uuid.uuid4()\nprint(f&quot;myuuid = {myuuid}&quot;)\n\nconn = stomp.Connection12([('127.0.0.1', 61616)], heartbeats=(5000,5000))\n#conn.set_listener('', stomp.PrintingListener())\nconn.set_listener('', MyListener())\n\nconn.connect(None, None, wait=True)\n\nprint(&quot;subscribing...&quot;)\nconn.subscribe(destination=f&quot;/temp-queue/{myuuid}&quot;, id=3, ack='auto')\nprint(&quot;sleeping...&quot;)\n\ntime.sleep(60)\n\n</code></pre>\n<p>I was hoping to receive a management message when the client connects and when it creates a temp-queue, but I don't receive any messages in my <code>MessageHandler</code> implementation.</p>\n<p>What have I done wrong so that I don't receive any messages?</p>\n",
    "tags" : [ "python", "java", "activemq-artemis" ],
    "owner" : {
      "account_id" : 16122418,
      "reputation" : 31,
      "user_id" : 11638068,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/72f53776d3351ec86500f997dc56e4b9?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Gord",
      "link" : "https://stackoverflow.com/users/11638068/gord"
    },
    "is_answered" : true,
    "view_count" : 70,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1745564827,
    "creation_date" : 1745520116,
    "link" : "https://stackoverflow.com/questions/79591280/receive-management-messages-in-my-own-consumer",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79591394,
    "question_id" : 79591280,
    "body" : "<p>Your Python client isn't using management messages to create any queues, temporary or otherwise. It's using the STOMP protocol to subscribe to a particular destination and the broker responds to that by creating the requisite address &amp; queue. This functionality is discussed in <a href=\"https://activemq.apache.org/components/artemis/documentation/latest/address-model.html#automatic-configuration\" rel=\"nofollow noreferrer\">the documentation</a>.</p>\n<p>That said, even if the Python client <em>was</em> sending management messages to explicitly create broker resources you would still not receive those messages in your Java client because management messages aren't treated like normal messages. Management messages are <em>for the broker</em>. The broker consumes those messages and does not route them like normal messages.</p>\n",
    "score" : 2,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 11434008,
      "reputation" : 36292,
      "user_id" : 8381946,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/-ORs8fPNVzDU/AAAAAAAAAAI/AAAAAAAADBs/F3IsdsProVY/s256-rj/photo.jpg",
      "display_name" : "Justin Bertram",
      "link" : "https://stackoverflow.com/users/8381946/justin-bertram"
    },
    "creation_date" : 1745525754,
    "last_activity_date" : 1745525754,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140366951,
    "post_id" : 79591280,
    "body" : "I&#39;ve removed the opinion-based &#39;best&#39; question, and included my python client (which does not use management messages to create its temporary queue).  I&#39;d still like to to know who is consuming messages on which temp-queue, so that I can send messages to specific clients.",
    "score" : 0,
    "owner" : {
      "account_id" : 16122418,
      "reputation" : 31,
      "user_id" : 11638068,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/72f53776d3351ec86500f997dc56e4b9?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Gord",
      "link" : "https://stackoverflow.com/users/11638068/gord"
    },
    "creation_date" : 1745523561,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79591394" : [ {
      "comment_id" : 140367311,
      "post_id" : 79591394,
      "body" : "It&#39;s also worth noting that asynchronous message brokers like ActiveMQ Artemis as well as the various supported messaging protocols and APIs are intentionally designed with a logical separation between producers and consumers. Your use-case isn&#39;t clear, but it&#39;s generally not normal to want or need to send messages to <i>specific</i> consumers.",
      "score" : 0,
      "owner" : {
        "account_id" : 11434008,
        "reputation" : 36292,
        "user_id" : 8381946,
        "user_type" : "registered",
        "profile_image" : "https://lh3.googleusercontent.com/-ORs8fPNVzDU/AAAAAAAAAAI/AAAAAAAADBs/F3IsdsProVY/s256-rj/photo.jpg",
        "display_name" : "Justin Bertram",
        "link" : "https://stackoverflow.com/users/8381946/justin-bertram"
      },
      "creation_date" : 1745532341,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140367291,
      "post_id" : 79591394,
      "body" : "Second, the documentation you linked is about management <b>notification</b> messages. These messages use the address defined by <code>management-notification-address</code> in <code>broker.xml</code> (<code>activemq.notifications</code> by default). These messages are categorically different from the management messages sent to the <code>activemq.management</code> address defined by <code>management-address</code> that you&#39;re attempting to receive in your question.",
      "score" : 0,
      "owner" : {
        "account_id" : 11434008,
        "reputation" : 36292,
        "user_id" : 8381946,
        "user_type" : "registered",
        "profile_image" : "https://lh3.googleusercontent.com/-ORs8fPNVzDU/AAAAAAAAAAI/AAAAAAAADBs/F3IsdsProVY/s256-rj/photo.jpg",
        "display_name" : "Justin Bertram",
        "link" : "https://stackoverflow.com/users/8381946/justin-bertram"
      },
      "creation_date" : 1745531626,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140367281,
      "post_id" : 79591394,
      "body" : "There&#39;s a couple of things to note here. First, that documentation you&#39;re referencing is for version <i>2.4.0</i> which was released in May 2018 (almost 7 years ago now). According to your question you&#39;re using 2.40.0 which is currently the latest release. The corresponding documentation for 2.40.0 is <a href=\"https://activemq.apache.org/components/artemis/documentation/latest/management.html#management-notifications\" rel=\"nofollow noreferrer\">here</a>. I strongly recommend you use up-to-date documentation.",
      "score" : 0,
      "owner" : {
        "account_id" : 11434008,
        "reputation" : 36292,
        "user_id" : 8381946,
        "user_type" : "registered",
        "profile_image" : "https://lh3.googleusercontent.com/-ORs8fPNVzDU/AAAAAAAAAAI/AAAAAAAADBs/F3IsdsProVY/s256-rj/photo.jpg",
        "display_name" : "Justin Bertram",
        "link" : "https://stackoverflow.com/users/8381946/justin-bertram"
      },
      "creation_date" : 1745531438,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140367207,
      "post_id" : 79591394,
      "body" : "I have been trying to follow the documentation at <a href=\"https://activemq.apache.org/components/artemis/documentation/2.4.0/management.html\" rel=\"nofollow noreferrer\">activemq.apache.org/components/artemis/documentation/2.4.0/&hellip;</a>&zwnj;&#8203;.  That page has a section called &quot;Receiving Notification Messages&quot; that talks about consuming management messages.  It seems to be what I&#39;m looking for... is that not correct?",
      "score" : 0,
      "owner" : {
        "account_id" : 16122418,
        "reputation" : 31,
        "user_id" : 11638068,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/72f53776d3351ec86500f997dc56e4b9?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "Gord",
        "link" : "https://stackoverflow.com/users/11638068/gord"
      },
      "creation_date" : 1745529436,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140367101,
      "post_id" : 79591394,
      "body" : "Thanks.  I guess this is entirely the wrong approach.  Is there a way for me to know which client is on the end of a temp-queue?",
      "score" : 0,
      "owner" : {
        "account_id" : 16122418,
        "reputation" : 31,
        "user_id" : 11638068,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/72f53776d3351ec86500f997dc56e4b9?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "Gord",
        "link" : "https://stackoverflow.com/users/11638068/gord"
      },
      "creation_date" : 1745526549,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}