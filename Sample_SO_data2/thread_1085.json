{
  "question" : {
    "question_id" : 79748780,
    "title" : "How do I make an `XMLInputFactory2`?",
    "body" : "<p>I want to use StAX2 to parse an XML file. For that it seems I need an <code>XMLEventReader2</code>, and to make one it seems I need an <code>XMLInputFactory2</code>. The one thing I found to make this, a <code>Stax2InputFactoryProvider</code>, seems like a dead end because I can't find anything to make that. Everything else I can find makes an <code>XMLInputFactory</code>, without the 2.</p>\n<p>I tried simply casting:</p>\n<pre class=\"lang-java prettyprint-override\"><code>XMLInputFactory2 factory = (XMLInputFactory2)XMLInputFactory2.newInstance();\n</code></pre>\n<p>and that seems to work (I don't immediately get a <code>ClassCastException</code>), but it's disgusting and looks like it's going to break at any second. Is this correct? I can't imagine so. How do I make this <code>XMLInputFactory2</code>?</p>\n",
    "tags" : [ "java", "xml", "stax" ],
    "owner" : {
      "account_id" : 17201994,
      "reputation" : 448,
      "user_id" : 29046053,
      "user_type" : "registered",
      "profile_image" : "https://lh4.googleusercontent.com/-MOC4Vt0c__w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf8MQWSf6wFQ9vE0GSA1yvKPSXUSg/s256-rj/photo.jpg",
      "display_name" : "Coarse Rosinflower",
      "link" : "https://stackoverflow.com/users/29046053/coarse-rosinflower"
    },
    "is_answered" : true,
    "view_count" : 94,
    "answer_count" : 2,
    "score" : 0,
    "last_activity_date" : 1756555968,
    "creation_date" : 1756367273,
    "link" : "https://stackoverflow.com/questions/79748780/how-do-i-make-an-xmlinputfactory2",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79751138,
    "question_id" : 79748780,
    "body" : "<p>I'm currently using aalto, so (as <a href=\"https://stackoverflow.com/users/466862/mark-rotteveel\">Mark Rotteveel</a> pointed out) I can spawn an instance directly like:</p>\n<pre class=\"lang-java prettyprint-override\"><code>final XMLInputFactory2 factory = new com.fasterxml.aalto.stax.InputFactoryImpl();\n</code></pre>\n<p>This can be modified to be any specific implementation.</p>\n",
    "score" : 1,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 17201994,
      "reputation" : 448,
      "user_id" : 29046053,
      "user_type" : "registered",
      "profile_image" : "https://lh4.googleusercontent.com/-MOC4Vt0c__w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf8MQWSf6wFQ9vE0GSA1yvKPSXUSg/s256-rj/photo.jpg",
      "display_name" : "Coarse Rosinflower",
      "link" : "https://stackoverflow.com/users/29046053/coarse-rosinflower"
    },
    "creation_date" : 1756555968,
    "last_activity_date" : 1756555968,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79750366,
    "question_id" : 79748780,
    "body" : "<p>According to the documentation for <code>javax.xml.stream.XMLInputFactory</code>, giving that string as input for <code>XMLInputFactory#newFactory(String factoryId, ClassLoader loader)</code>, should use the service loader mechanism to create a factory instance. Trying with woodstox and this code:</p>\n<pre><code>    XMLInputFactory f = XMLInputFactory.newFactory(&quot;javax.xml.stream.XMLInputFactory&quot;, null);\n\n    System.out.println(f.getClass().getName());\n    System.out.println(XMLInputFactory2.class.isInstance(f));\n</code></pre>\n<p>produces as output</p>\n<pre><code>com.ctc.wstx.stax.WstxInputFactory\ntrue\n</code></pre>\n<p>So it should be safe to cast it to an <code>XMLInputFactory2</code>.</p>\n",
    "score" : -1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 116746,
      "reputation" : 12898,
      "user_id" : 306030,
      "user_type" : "registered",
      "accept_rate" : 70,
      "profile_image" : "https://i.sstatic.net/y053l.jpg?s=256",
      "display_name" : "forty-two",
      "link" : "https://stackoverflow.com/users/306030/forty-two"
    },
    "creation_date" : 1756475473,
    "last_activity_date" : 1756475473,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140698506,
    "post_id" : 79748780,
    "body" : "The idea behind <code>newInstance()</code>/<code>newFactory()</code> is to decouple the API from the actual implementation by locating it dynamically on the classpath. Maybe you could use the other <code>newFactory</code> method (accepting a string and a classloader, but reading the javadoc, that doesn&#39;t work very intuitively, so you might just as well instantiate it directly).",
    "score" : 0,
    "owner" : {
      "account_id" : 213468,
      "reputation" : 110280,
      "user_id" : 466862,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=256&d=identicon&r=PG",
      "display_name" : "Mark Rotteveel",
      "link" : "https://stackoverflow.com/users/466862/mark-rotteveel"
    },
    "creation_date" : 1756383848,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140698489,
    "post_id" : 79748780,
    "body" : "@MarkRotteveel Currently using <code>XMLInputFactory2 factory = new com.fasterxml.aalto.stax.InputFactoryImpl();</code>, and it seems to work. Is that how I&#39;m supposed to do that? It seems like there&#39;s a reason that isn&#39;t the obvious solutionâ€¦",
    "score" : 0,
    "owner" : {
      "account_id" : 17201994,
      "reputation" : 448,
      "user_id" : 29046053,
      "user_type" : "registered",
      "profile_image" : "https://lh4.googleusercontent.com/-MOC4Vt0c__w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf8MQWSf6wFQ9vE0GSA1yvKPSXUSg/s256-rj/photo.jpg",
      "display_name" : "Coarse Rosinflower",
      "link" : "https://stackoverflow.com/users/29046053/coarse-rosinflower"
    },
    "creation_date" : 1756383567,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140697991,
    "post_id" : 79748780,
    "body" : "You can, but I would prefer throwing a little more explicit exception than a <code>ClassCastException</code>.",
    "score" : 0,
    "owner" : {
      "account_id" : 213468,
      "reputation" : 110280,
      "user_id" : 466862,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=256&d=identicon&r=PG",
      "display_name" : "Mark Rotteveel",
      "link" : "https://stackoverflow.com/users/466862/mark-rotteveel"
    },
    "creation_date" : 1756369356,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140697986,
    "post_id" : 79748780,
    "body" : "@MarkRotteveel In the case of being unable to get a StAX2 instance, I think I would want to throw anyway, so it&#39;s probably fine.",
    "score" : 0,
    "owner" : {
      "account_id" : 17201994,
      "reputation" : 448,
      "user_id" : 29046053,
      "user_type" : "registered",
      "profile_image" : "https://lh4.googleusercontent.com/-MOC4Vt0c__w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf8MQWSf6wFQ9vE0GSA1yvKPSXUSg/s256-rj/photo.jpg",
      "display_name" : "Coarse Rosinflower",
      "link" : "https://stackoverflow.com/users/29046053/coarse-rosinflower"
    },
    "creation_date" : 1756369299,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140697971,
    "post_id" : 79748780,
    "body" : "I&#39;m posting these as comments, and not an answer, as I haven&#39;t touched Stax in years, and I can&#39;t recall if there is a better way to get a Stax2 instance. You can always create the actual implementation factory you want to use directly instead of relying on the lookup performed by <code>XMLInputFactory.newInstance()</code>, e.g. use <code>new WstxInputFactory()</code> if you want to use Woodstox).",
    "score" : 0,
    "owner" : {
      "account_id" : 213468,
      "reputation" : 110280,
      "user_id" : 466862,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=256&d=identicon&r=PG",
      "display_name" : "Mark Rotteveel",
      "link" : "https://stackoverflow.com/users/466862/mark-rotteveel"
    },
    "creation_date" : 1756368785,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140697968,
    "post_id" : 79748780,
    "body" : "First of all, use <code>XMLInputFactory.newInstance()</code>. Static methods like <code>newInstance()</code> cannot be overloaded, so qualify it with the actual class (interface) that provides it. Second, given how the factory is found and loaded, there is no guarantee that <code>newInstance()</code> returns an instance of <code>XMLInputFactory2</code> as it is possible an implementation that does not implement Stax2 extension is found first, use a checked cast instead (e.g. <code>if (XMLInputFactory.newInstance instanceof XMLInputFactory2 inputFactory) {...} else {...}</code>.",
    "score" : 0,
    "owner" : {
      "account_id" : 213468,
      "reputation" : 110280,
      "user_id" : 466862,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=256&d=identicon&r=PG",
      "display_name" : "Mark Rotteveel",
      "link" : "https://stackoverflow.com/users/466862/mark-rotteveel"
    },
    "creation_date" : 1756368594,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79750366" : [ {
      "comment_id" : 140703248,
      "post_id" : 79750366,
      "body" : "Using <code>&quot;javax.xml.stream.XMLInputFactory&quot;</code> as the factoryId will simply return the first it finds, and would be the same as using the <code>newFactory()</code>/<code>newInstance()</code> variant (without parameters), so you&#39;re still at the same place as the question, and as such don&#39;t really provide an answer.",
      "score" : 1,
      "owner" : {
        "account_id" : 213468,
        "reputation" : 110280,
        "user_id" : 466862,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=256&d=identicon&r=PG",
        "display_name" : "Mark Rotteveel",
        "link" : "https://stackoverflow.com/users/466862/mark-rotteveel"
      },
      "creation_date" : 1756543625,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}