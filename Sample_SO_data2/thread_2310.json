{
  "question" : {
    "question_id" : 79633909,
    "title" : "Making MapStruct extract value from source, return as target value",
    "body" : "<p>MapStruct can take a plain value and set it to a target object's field.</p>\n<p>However, it seems, it can't do the opposite: extract a value and return it as a target object.</p>\n<pre class=\"lang-java prettyprint-override\"><code>import com.example.pixel_user_api.data.entity.EmailData;\nimport org.mapstruct.Mapper;\nimport org.mapstruct.Mapping;\n\n@Mapper\npublic interface EmailMapper {\n    @Mapping(source = &quot;email&quot;, target = &quot;.&quot;)\n    String toString(EmailData emailData); // doesn't work\n\n    @Mapping(source = &quot;.&quot;, target = &quot;email&quot;)\n    EmailData toEmailData(String email); // works\n}\n</code></pre>\n<pre class=\"lang-java prettyprint-override\"><code>import lombok.Getter;\nimport lombok.Setter;\n\n@Getter\n@Setter\npublic class EmailData {\n    private Long id;\n    private String email;\n}\n</code></pre>\n<p>Here's what MapStruct generated:</p>\n<pre class=\"lang-java prettyprint-override\"><code>    @Override\n    public String toString(EmailData emailData) {\n        if ( emailData == null ) {\n            return null;\n        }\n\n        String string = new String();\n\n        return string;\n    }\n\n    @Override\n    public EmailData toEmailData(String email) {\n        if ( email == null ) {\n            return null;\n        }\n\n        EmailData emailData = new EmailData();\n\n        emailData.setEmail( email );\n\n        return emailData;\n    }\n</code></pre>\n<p>While <code>toString(EmailData)</code> is straightforward to implement yourself (<code>return emailData.getEmail()</code>), I'm curious: can I make the first method to work too?</p>\n<p>A test that has to pass:</p>\n<pre class=\"lang-java prettyprint-override\"><code>import com.example.pixel_user_api.mapper.EmailMapper;\nimport org.junit.jupiter.api.Test;\nimport org.mapstruct.factory.Mappers;\n\nimport static org.assertj.core.api.Assertions.assertThat;\n\nclass EmailDataTest {\n    \n    @Test\n    void testMapper() {\n        String expectedEmail = &quot;example@mail.com&quot;;\n        EmailData emailData = new EmailData();\n        emailData.setEmail(expectedEmail);\n        EmailMapper mapper = Mappers.getMapper(EmailMapper.class);\n        String actualEmail = mapper.toString(emailData);\n        assertThat(actualEmail).isEqualTo(expectedEmail); // fails here\n    }\n}\n</code></pre>\n<pre><code>org.opentest4j.AssertionFailedError: \nexpected: &quot;example@mail.com&quot;\n but was: &quot;&quot;\nExpected :&quot;example@mail.com&quot;\nActual   :&quot;&quot;\n</code></pre>\n<p>Java 17, MapStruct 1.6.3</p>\n",
    "tags" : [ "java", "mapstruct" ],
    "owner" : {
      "account_id" : 10187542,
      "reputation" : 2683,
      "user_id" : 20692967,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/NZSXm.jpg?s=256",
      "display_name" : "Sergey Zolotarev",
      "link" : "https://stackoverflow.com/users/20692967/sergey-zolotarev"
    },
    "is_answered" : true,
    "view_count" : 91,
    "answer_count" : 3,
    "score" : 0,
    "last_activity_date" : 1748099559,
    "creation_date" : 1747922330,
    "link" : "https://stackoverflow.com/questions/79633909/making-mapstruct-extract-value-from-source-return-as-target-value",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79634887,
    "question_id" : 79633909,
    "body" : "<p>I suppose this type of mapping is not supported because (my opinion) is quite hard to give a good level of personalization converting multiple values into a single one (how to concat values, how to separate them, etc).</p>\n<p>So, if you really want to use mapstruct to build a toString() just provide an implementation to `String toString(EmailData emailData);` by yourself.</p>\n",
    "score" : 1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 3052937,
      "reputation" : 18534,
      "user_id" : 2587166,
      "user_type" : "registered",
      "accept_rate" : 83,
      "profile_image" : "https://i.sstatic.net/pgHgd.jpg?s=256",
      "display_name" : "Luca Basso Ricci",
      "link" : "https://stackoverflow.com/users/2587166/luca-basso-ricci"
    },
    "creation_date" : 1747977978,
    "last_activity_date" : 1747977978,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79636900,
    "question_id" : 79633909,
    "body" : "<p>Since the mapping is simple enough, just implement it yourself like Luca Basso Ricci already said:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Mapper\npublic interface EmailMapper {\n    default String toString(EmailData emailData) {\n        return emailData == null ? null : emailData.getEmail();\n    }\n\n    @Mapping(source = &quot;.&quot;, target = &quot;email&quot;)\n    EmailData toEmailData(String email); // works\n}\n</code></pre>\n",
    "score" : 1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 1211967,
      "reputation" : 9964,
      "user_id" : 1180351,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/pKB8y.png?s=256",
      "display_name" : "Rob Spoor",
      "link" : "https://stackoverflow.com/users/1180351/rob-spoor"
    },
    "creation_date" : 1748099559,
    "last_activity_date" : 1748099559,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79634031,
    "question_id" : 79633909,
    "body" : "<p>Maybe define a <code>toString</code> method that returns the <code>email</code> property of the <code>EmailData</code> class?</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Override\npublic String toString() {\n    return this.email;\n}\n</code></pre>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 1960454,
      "reputation" : 49131,
      "user_id" : 1762224,
      "user_type" : "registered",
      "accept_rate" : 61,
      "profile_image" : "https://www.gravatar.com/avatar/20969bd926bb6a29ee19a07a25f7fea8?s=256&d=identicon&r=PG",
      "display_name" : "Mr. Polywhirl",
      "link" : "https://stackoverflow.com/users/1762224/mr-polywhirl"
    },
    "creation_date" : 1747926359,
    "last_activity_date" : 1747926985,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : {
    "79634031" : [ {
      "comment_id" : 140449885,
      "post_id" : 79634031,
      "body" : "@SergeyZolotarev I think the issue is that, while it is easy to parse stuff, it is much harder to determine what to serialize.",
      "score" : 0,
      "owner" : {
        "account_id" : 1960454,
        "reputation" : 49131,
        "user_id" : 1762224,
        "user_type" : "registered",
        "accept_rate" : 61,
        "profile_image" : "https://www.gravatar.com/avatar/20969bd926bb6a29ee19a07a25f7fea8?s=256&d=identicon&r=PG",
        "display_name" : "Mr. Polywhirl",
        "link" : "https://stackoverflow.com/users/1762224/mr-polywhirl"
      },
      "creation_date" : 1747927075,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140449845,
      "post_id" : 79634031,
      "body" : "That&#39;s one way to do it. However, <code>toString()</code> should never be relied upon in business logic",
      "score" : 0,
      "owner" : {
        "account_id" : 10187542,
        "reputation" : 2683,
        "user_id" : 20692967,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/NZSXm.jpg?s=256",
        "display_name" : "Sergey Zolotarev",
        "link" : "https://stackoverflow.com/users/20692967/sergey-zolotarev"
      },
      "creation_date" : 1747926579,
      "content_license" : "CC BY-SA 4.0"
    } ],
    "79636900" : [ {
      "comment_id" : 140455601,
      "post_id" : 79636900,
      "body" : "I tried some stuff already, including <code>expression = &quot;java(emailData.getEmail())&quot;</code>, but the default method is the only thing I got working myself.",
      "score" : 0,
      "owner" : {
        "account_id" : 1211967,
        "reputation" : 9964,
        "user_id" : 1180351,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/pKB8y.png?s=256",
        "display_name" : "Rob Spoor",
        "link" : "https://stackoverflow.com/users/1180351/rob-spoor"
      },
      "creation_date" : 1748102345,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140455543,
      "post_id" : 79636900,
      "body" : "Yeah, I know. I just wondered whether I had to. Maybe, there&#39;s some <code>@MagicAnnotation</code> I could put",
      "score" : 0,
      "owner" : {
        "account_id" : 10187542,
        "reputation" : 2683,
        "user_id" : 20692967,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/NZSXm.jpg?s=256",
        "display_name" : "Sergey Zolotarev",
        "link" : "https://stackoverflow.com/users/20692967/sergey-zolotarev"
      },
      "creation_date" : 1748100393,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}