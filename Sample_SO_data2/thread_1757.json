{
  "question" : {
    "question_id" : 79680449,
    "title" : "How to redirect 404 to root with spring boot 3",
    "body" : "<p>I have a spring boot application with an angular frontend. I migrated it from spring boot 2.7.18 to 3.3.11. I had following code to redirect all not found pages to root:</p>\n<pre><code>@Bean\npublic ErrorPageRegistrar errorPageRegistrar() {\n    return new ErrorPageRegistrar() {\n        @Override\n        public void registerErrorPages(ErrorPageRegistry registry) {\n            registry.addErrorPages(new ErrorPage(HttpStatus.NOT_FOUND, &quot;/index.html&quot;));\n        }\n    };\n</code></pre>\n<p>This seems not to work anymore after migration. No redirection, there is only a page opening printing the json response like this:</p>\n<pre><code>{&quot;type&quot;:&quot;about:blank&quot;,&quot;title&quot;:&quot;Not Found&quot;,&quot;status&quot;:404,&quot;detail&quot;:&quot;No static resource gggg.&quot;,&quot;instance&quot;:&quot;/gggg&quot;}\n</code></pre>\n<p>Can anyone give me a hint why this is not working and how resolve this? I checked the migration guides and looked for documentation or examples but did not found anything helpful.</p>\n",
    "tags" : [ "java", "spring", "spring-boot", "migration" ],
    "owner" : {
      "account_id" : 4972058,
      "reputation" : 207,
      "user_id" : 3999476,
      "user_type" : "registered",
      "accept_rate" : 75,
      "profile_image" : "https://www.gravatar.com/avatar/efd57f1310a437ecc6dc14da1ded1336?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Juliane",
      "link" : "https://stackoverflow.com/users/3999476/juliane"
    },
    "is_answered" : true,
    "view_count" : 258,
    "answer_count" : 2,
    "score" : 3,
    "last_activity_date" : 1753080110,
    "creation_date" : 1750939016,
    "link" : "https://stackoverflow.com/questions/79680449/how-to-redirect-404-to-root-with-spring-boot-3",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79680570,
    "question_id" : 79680449,
    "body" : "<h1>Universal controller, redirect (simple)</h1>\n<p>If your don't have advanced logic, you can write a controller that accepts any path and returns a redirect. Such redirect would be handled by the browser in a correct way.</p>\n<p><code>**</code> means any path with any path segments, i.e. both <code>/test</code> and <code>/a/b/c/d/e/f</code> would work if you don't have other controllers assigned to those paths.</p>\n<p>With this approach, the browser will receive an HTTP 301 status with a <code>Location</code> header. All browsers know how to deal with this situtation, so you will have an additional round trip between client and server to fetch the actual needed page.</p>\n<pre class=\"lang-java prettyprint-override\"><code>@RestController\npublic class RedirectOnNonMatchingPathController {\n  @RequestMapping(&quot;**&quot;)\n  public ResponseEntity&lt;Void&gt; anyHandle() {\n    return ResponseEntity.status(HttpStatus.FOUND)\n        .location(URI.create(&quot;/index.html&quot;))\n        .build();\n  }\n}\n</code></pre>\n<h1>Universal controller, forward (simple)</h1>\n<p>You can also apply a forward. There is no additional network trips, because internally Spring Boot will render the <code>index.html</code> even though you see in browser your desired non-existing path, e.g. <code>/non/existing/path</code>. This is also known as a forward (instead of redirect).</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Controller\npublic class RedirectController {\n  @RequestMapping(&quot;**&quot;)\n  public String anyHandle() {\n    return &quot;forward:/index.html&quot;;\n  }\n}\n</code></pre>\n<h1>WebServerFactoryCustomizer, forward (advanced)</h1>\n<p>You can create a <code>WebServerFactoryCustomizer</code> which adds a page to forward to on a given HTTP status.</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Configuration\npublic class WebServerFactoryConfiguration {\n  @Bean\n  public WebServerFactoryCustomizer&lt;ConfigurableServletWebServerFactory&gt; webServerFactoryCustomizer() {\n    return factory -&gt; {\n      factory.addErrorPages(new ErrorPage(HttpStatus.NOT_FOUND, &quot;/index.html&quot;));\n    };\n  }\n}\n</code></pre>\n<h1>Forward vs. Redirect</h1>\n<div class=\"s-table-container\"><table class=\"s-table\">\n<thead>\n<tr>\n<th></th>\n<th>Redirect</th>\n<th>Forward</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Network trips</td>\n<td>2 (1 to a non-existing page + 1 to a redirect page)</td>\n<td>1, which is just the non-existing page rendered to the <code>index.html</code></td>\n</tr>\n<tr>\n<td>Workflow</td>\n<td>Client sends the request to <code>/non/existing/page</code>, gets HTTP 301 and makes an additional request to the needed page <code>/index.html</code></td>\n<td>Client sends the request to <code>/non/existing/page</code>, and gets the body of <code>/index.html</code>, but the URL stays <code>/non/existing/page</code></td>\n</tr>\n</tbody>\n</table></div>\n<h1>Sources</h1>\n<ul>\n<li><a href=\"https://www.baeldung.com/servlet-redirect-forward;\" rel=\"nofollow noreferrer\">https://www.baeldung.com/servlet-redirect-forward;</a></li>\n<li><a href=\"https://medium.com/devdomain/spring-boots-restcontroller-vs-controller-a-comprehensive-guide-c045ab1c97a9;\" rel=\"nofollow noreferrer\">https://medium.com/devdomain/spring-boots-restcontroller-vs-controller-a-comprehensive-guide-c045ab1c97a9;</a></li>\n<li><a href=\"https://stackoverflow.com/questions/28697681/spring-mvc-controller-what-is-the-difference-between-return-forward-return;\">Spring MVC Controller: what is the difference between &quot;return forward&quot;, &quot;return redirect&quot; and &quot;return jsp file&quot;</a></li>\n<li><a href=\"https://docs.spring.io/spring-boot/api/java/org/springframework/boot/web/server/WebServerFactoryCustomizer.html\" rel=\"nofollow noreferrer\">https://docs.spring.io/spring-boot/api/java/org/springframework/boot/web/server/WebServerFactoryCustomizer.html</a>.</li>\n</ul>\n",
    "score" : 2,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 40864244,
      "reputation" : 632,
      "user_id" : 30001713,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/f59ea01a76709335047f0cee269d788e?s=256&d=identicon&r=PG",
      "display_name" : "biggujo",
      "link" : "https://stackoverflow.com/users/30001713/biggujo"
    },
    "creation_date" : 1750944109,
    "last_activity_date" : 1750945855,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79708666,
    "question_id" : 79680449,
    "body" : "<p>You need to define a <code>WebMvcConfigurer</code> that forwards all non-static paths (paths not ending with <code>.js</code>, <code>.css</code>, etc.) to <code>index.html</code>. This is how single-page applications like Angular handle frontend routing.</p>\n<pre><code>import org.springframework.context.annotation.Configuration;\nimport org.springframework.web.servlet.config.annotation.ViewControllerRegistry;\nimport org.springframework.web.servlet.config.annotation.WebMvcConfigurer;\n\n@Configuration\npublic class WebConfig implements WebMvcConfigurer {\n\n    @Override\n    public void addViewControllers(ViewControllerRegistry registry) {\n        // Forward requests without file extension to index.html\n        registry.addViewController(&quot;/{spring:[\\\\w\\\\-]+}&quot;)\n                .setViewName(&quot;forward:/index.html&quot;);\n\n        // Forward nested routes (e.g., /dashboard/settings) to index.html\n        registry.addViewController(&quot;/{spring:[\\\\w\\\\-]+}/**{spring:?!(\\\\.js|\\\\.css|\\\\.png|\\\\.jpg|\\\\.jpeg|\\\\.svg|\\\\.html)$}&quot;)\n                .setViewName(&quot;forward:/index.html&quot;);\n    }\n}\n</code></pre>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 43143301,
      "reputation" : 1,
      "user_id" : 31100133,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/672c9f96bc5d89a122bdad264d2a1f03?s=256&d=identicon&r=PG",
      "display_name" : "Daranidaran S",
      "link" : "https://stackoverflow.com/users/31100133/daranidaran-s"
    },
    "creation_date" : 1753080110,
    "last_activity_date" : 1753080110,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140573259,
    "post_id" : 79680449,
    "body" : "@MathiasAlonso Can you help me and give me a hit how i can react on this static resource errors now?",
    "score" : 0,
    "owner" : {
      "account_id" : 4972058,
      "reputation" : 207,
      "user_id" : 3999476,
      "user_type" : "registered",
      "accept_rate" : 75,
      "profile_image" : "https://www.gravatar.com/avatar/efd57f1310a437ecc6dc14da1ded1336?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Juliane",
      "link" : "https://stackoverflow.com/users/3999476/juliane"
    },
    "creation_date" : 1751971455,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140544127,
    "post_id" : 79680449,
    "body" : "In Spring Boot 2, the <b>ErrorPageRegistrar</b> approach worked fine for forwarding 404s to index.html. In Spring Boot 3: -Static resource errors (like missing /gggg) are handled differently. -<b>ErrorPageRegistrar</b> doesn&#39;t handle missing static resources the same way it did before. -Now Spring uses Problem Details RFC 7807 by default for errors (hence your JSON).",
    "score" : 0,
    "owner" : {
      "account_id" : 30900356,
      "reputation" : 11,
      "user_id" : 23718471,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/05da27e53c2097944e34d91b60c759c9?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Mathias Alonso",
      "link" : "https://stackoverflow.com/users/23718471/mathias-alonso"
    },
    "creation_date" : 1750939644,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79680570" : [ {
      "comment_id" : 140573195,
      "post_id" : 79680570,
      "body" : "Thank you very much for your answer. Sorry I could not test this earlier. The simple solutions redirect and forward result in endless loops and stackoverflow and the advanced solution seems to have no effect.",
      "score" : 0,
      "owner" : {
        "account_id" : 4972058,
        "reputation" : 207,
        "user_id" : 3999476,
        "user_type" : "registered",
        "accept_rate" : 75,
        "profile_image" : "https://www.gravatar.com/avatar/efd57f1310a437ecc6dc14da1ded1336?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "Juliane",
        "link" : "https://stackoverflow.com/users/3999476/juliane"
      },
      "creation_date" : 1751970013,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}