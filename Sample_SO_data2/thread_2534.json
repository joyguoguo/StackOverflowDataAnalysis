{
  "question" : {
    "question_id" : 79616408,
    "title" : "JavaBeans custom property editor fails to connect to SQL Server database using Microsoft JDBC driver from Eclipse WindowBuilder",
    "body" : "<p>I am using Eclipse IDE for Java Developers version 2025-03 with WindowBuilder 1.20.0.202503172036 on Windows 10. My [Eclipse] Java project uses JDK 1.8.0_201. I am using Microsoft JDBC driver for SQL Server 12.10, specifically this JAR file: <code>mssql-jdbc-12.10.0.jre8.jar</code>. The database is SQL Server 13.0.7050.2.</p>\n<p>I use the following code to connect to the database from Java.<br />\n(Note that the below code uses fictitious host name and port and database name and user name and user password.)</p>\n<pre class=\"lang-java prettyprint-override\"><code>Class.forName(&quot;com.microsoft.sqlserver.jdbc.SQLServerDriver&quot;);\njava.util.Properties props = new java.util.Properties();\nprops.setProperty(&quot;password&quot;, &quot;Mountbatten&quot;);\nprops.setProperty(&quot;userName&quot;, &quot;Philip&quot;);\nprops.setProperty(&quot;databaseName&quot;, &quot;Windsor&quot;);\nprops.setProperty(&quot;trustServerCertificate&quot;,&quot;true&quot;);\nString url = &quot;jdbc:sqlserver://balmoral:2024&quot;;\njava.sql.Connection conn = java.sql.DriverManager.getConnection(url, props);\n</code></pre>\n<p>If I run this code from the <code>main</code> method of a Java class the connection is established, however, from <em>WindowBuilder</em>, the connection is <strong>not</strong> established and the following stack trace appears in [Eclipse] workspace log file.</p>\n<pre class=\"lang-none prettyprint-override\"><code>!ENTRY org.eclipse.wb.core 4 4 2025-05-11 10:30:10.134\n!MESSAGE Designer [1.10.200.202503182030.202505110850]: Range [0, -14) out of bounds for length 1\n!STACK 0\njava.lang.StringIndexOutOfBoundsException: Range [0, -14) out of bounds for length 1\n    at java.base/jdk.internal.util.Preconditions$1.apply(Preconditions.java:55)\n    at java.base/jdk.internal.util.Preconditions$1.apply(Preconditions.java:52)\n    at java.base/jdk.internal.util.Preconditions$4.apply(Preconditions.java:213)\n    at java.base/jdk.internal.util.Preconditions$4.apply(Preconditions.java:210)\n    at java.base/jdk.internal.util.Preconditions.outOfBounds(Preconditions.java:98)\n    at java.base/jdk.internal.util.Preconditions.outOfBoundsCheckFromToIndex(Preconditions.java:112)\n    at java.base/jdk.internal.util.Preconditions.checkFromToIndex(Preconditions.java:349)\n    at java.base/java.lang.String.checkBoundsBeginEnd(String.java:4865)\n    at java.base/java.lang.String.substring(String.java:2834)\n    at com.microsoft.sqlserver.jdbc.ConfigurableRetryLogic.getCurrentClassPath(ConfigurableRetryLogic.java:312)\n    at com.microsoft.sqlserver.jdbc.ConfigurableRetryLogic.readFromFile(ConfigurableRetryLogic.java:339)\n    at com.microsoft.sqlserver.jdbc.ConfigurableRetryLogic.setUpStatementRules(ConfigurableRetryLogic.java:207)\n    at com.microsoft.sqlserver.jdbc.ConfigurableRetryLogic.&lt;init&gt;(ConfigurableRetryLogic.java:89)\n    at com.microsoft.sqlserver.jdbc.ConfigurableRetryLogic.getInstance(ConfigurableRetryLogic.java:106)\n    at com.microsoft.sqlserver.jdbc.SQLServerConnection.connectInternal(SQLServerConnection.java:2600)\n    at com.microsoft.sqlserver.jdbc.SQLServerConnection.connect(SQLServerConnection.java:2207)\n    at com.microsoft.sqlserver.jdbc.SQLServerDriver.connect(SQLServerDriver.java:1320)\n    at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:683)\n    at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:191)\n    at idb.utils.sql.sqlserve.SqlSrvDb.getDbConnection(SqlSrvDb.java:159)\n    at idb.utils.sql.DbConFac.getDbConnection(DbConFac.java:99)\n    at idb.development.editors.Ct0TableModel.setData(IdbTableDataEditorGUI.java:324)\n    at idb.development.editors.IdbTableDataEditorGUI.populateTable(IdbTableDataEditorGUI.java:215)\n    at idb.development.editors.IdbTableDataEditorGUI.setPropertyData(IdbTableDataEditorGUI.java:125)\n    at qt.development.editors.QtPropertyEditorGUIAdapter.setPropertyData(QtPropertyEditorGUIAdapter.java:153)\n    at qt.development.editors.QtTableDataEditor.setValue(QtTableDataEditor.java:53)\n    at org.eclipse.wb.internal.swing.model.property.editor.beans.PropertyEditorWrapper$DialogPresentation.onClick(PropertyEditorWrapper.java:208)\n    at org.eclipse.wb.internal.core.model.property.editor.presentation.ButtonPropertyEditorPresentation.lambda$2(ButtonPropertyEditorPresentation.java:56)\n    at org.eclipse.draw2d.ButtonModel.lambda$0(ButtonModel.java:137)\n    at java.base/java.util.concurrent.CopyOnWriteArrayList.forEach(CopyOnWriteArrayList.java:891)\n    at org.eclipse.draw2d.ButtonModel.fireActionPerformed(ButtonModel.java:137)\n    at org.eclipse.draw2d.ButtonModel$DefaultFiringBehavior.released(ButtonModel.java:488)\n    at java.base/java.util.concurrent.CopyOnWriteArrayList.forEach(CopyOnWriteArrayList.java:891)\n    at org.eclipse.draw2d.ButtonModel.fireReleased(ButtonModel.java:170)\n    at org.eclipse.draw2d.ButtonModel.setPressed(ButtonModel.java:446)\n    at org.eclipse.draw2d.ClickableEventHandler.mouseReleased(ClickableEventHandler.java:108)\n    at org.eclipse.draw2d.Figure.handleMouseReleased(Figure.java:1040)\n    at org.eclipse.draw2d.SWTEventDispatcher.dispatchMouseReleased(SWTEventDispatcher.java:294)\n    at org.eclipse.gef.ui.parts.DomainEventDispatcher.dispatchMouseReleased(DomainEventDispatcher.java:426)\n    at org.eclipse.draw2d.LightweightSystem$EventHandler.mouseUp(LightweightSystem.java:598)\n    at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:258)\n    at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:91)\n    at org.eclipse.swt.widgets.Display.sendEvent(Display.java:4321)\n    at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1208)\n    at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:4119)\n    at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3707)\n    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$5.run(PartRenderingEngine.java:1151)\n    at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:339)\n    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:1042)\n    at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:153)\n    at org.eclipse.ui.internal.Workbench.lambda$3(Workbench.java:668)\n    at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:339)\n    at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:576)\n    at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:173)\n    at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:178)\n    at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:208)\n    at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:149)\n    at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:115)\n    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:467)\n    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:298)\n    at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)\n    at java.base/java.lang.reflect.Method.invoke(Method.java:580)\n    at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:670)\n    at org.eclipse.equinox.launcher.Main.basicRun(Main.java:607)\n    at org.eclipse.equinox.launcher.Main.run(Main.java:1492)\n</code></pre>\n<p>Note that prior to using Microsoft's JDBC driver, I was using <a href=\"https://jtds.sourceforge.net/\" rel=\"nofollow noreferrer\">jTDS</a> driver which was successfully connecting with the exact same environment detailed above, i.e. same Eclipse, same WindowBuilder and same SQL Server database. Here is the jTDS code.</p>\n<pre class=\"lang-java prettyprint-override\"><code>String url = &quot;jdbc:jtds:sqlserver://balmoral:2024/Windsor&quot;;\njava.util.Properties props = new java.util.Properties();\nprops.setProperty(&quot;password&quot;, &quot;Mountbatten&quot;);\nprops.setProperty(&quot;user&quot;, &quot;Philip&quot;);\njava.sql.Connection conn = java.sql.DriverManager.getConnection(url, props);\n</code></pre>\n<p>I am asking for instructions on what I need to do in order to successfully connect to the SQL Server database from a JavaBeans custom editor in Eclipse WindowBuilder.</p>\n<h2>EDIT</h2>\n<p>(12 May 2025)</p>\n<p>From the link provided in <a href=\"https://stackoverflow.com/questions/79616408/javabeans-custom-property-editor-fails-to-connect-to-sql-server-database-using-m#comment140415639_79616408\">this comment</a>, it looks like the code of class <code>com.microsoft.sqlserver.jdbc.ConfigurableRetryLogic</code> gets a URI like <code>file:/</code> which it does not expect to get. As <em>siggemannen</em> mentioned in <a href=\"https://stackoverflow.com/questions/79616408/javabeans-custom-property-editor-fails-to-connect-to-sql-server-database-using-m#comment140416151_79616408\">this comment</a>, it appears to be a bug. I tried to report an issue on the GitHub page but I think I was unsuccessful.</p>\n",
    "tags" : [ "java", "sql-server", "eclipse", "jdbc", "windowbuilder" ],
    "owner" : {
      "account_id" : 2485939,
      "reputation" : 20969,
      "user_id" : 2164365,
      "user_type" : "registered",
      "accept_rate" : 40,
      "profile_image" : "https://i.sstatic.net/RKSgV.png?s=256",
      "display_name" : "Abra",
      "link" : "https://stackoverflow.com/users/2164365/abra"
    },
    "is_answered" : true,
    "view_count" : 102,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1747046902,
    "creation_date" : 1746960762,
    "link" : "https://stackoverflow.com/questions/79616408/javabeans-custom-property-editor-fails-to-connect-to-sql-server-database-using-m",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79617679,
    "question_id" : 79616408,
    "body" : "<p>I took a look at the source code and it looks like a bug in the microsoft jdbc driver, it tries to read a config file from classpath and fails when path isn't a simple url, like for example eclipse built-in classpath and others containers.</p>\n<p>This bug was already reported at <a href=\"https://github.com/microsoft/mssql-jdbc/issues/2658\" rel=\"nofollow noreferrer\">https://github.com/microsoft/mssql-jdbc/issues/2658</a> so you can probably downgrade the driver and upgrade when this issue is fixed, they're usually quite quick with fixes!</p>\n",
    "score" : 1,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 17972905,
      "reputation" : 10131,
      "user_id" : 13061224,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/GyOMS.jpg?s=256",
      "display_name" : "siggemannen",
      "link" : "https://stackoverflow.com/users/13061224/siggemannen"
    },
    "creation_date" : 1747046902,
    "last_activity_date" : 1747046902,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140416264,
    "post_id" : 79616408,
    "body" : "@siggemannen - not sure about that but what I <i>am</i> sure about is that the driver is expected to be on the classpath",
    "score" : 0,
    "owner" : {
      "account_id" : 22124137,
      "reputation" : 4244,
      "user_id" : 16376827,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/1ImPw.png?s=256",
      "display_name" : "g00se",
      "link" : "https://stackoverflow.com/users/16376827/g00se"
    },
    "creation_date" : 1747005364,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140416151,
    "post_id" : 79616408,
    "body" : "This is a 100% bug in sql server jdbc driver, there&#39;s no need to use whatever the classpath mangling the driver does inside of ConfigurableRetryLogic. It doesn&#39;t seem to handle slashes madness eclipse uses at least. You should report it on their github page",
    "score" : 0,
    "owner" : {
      "account_id" : 17972905,
      "reputation" : 10131,
      "user_id" : 13061224,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/GyOMS.jpg?s=256",
      "display_name" : "siggemannen",
      "link" : "https://stackoverflow.com/users/13061224/siggemannen"
    },
    "creation_date" : 1746999596,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140415704,
    "post_id" : 79616408,
    "body" : "@LukeWoodward Right, thanks",
    "score" : 0,
    "owner" : {
      "account_id" : 22124137,
      "reputation" : 4244,
      "user_id" : 16376827,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/1ImPw.png?s=256",
      "display_name" : "g00se",
      "link" : "https://stackoverflow.com/users/16376827/g00se"
    },
    "creation_date" : 1746983341,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140415639,
    "post_id" : 79616408,
    "body" : "@g00se: the JDBC driver is open source: <a href=\"https://github.com/microsoft/mssql-jdbc/\" rel=\"nofollow noreferrer\">github.com/microsoft/mssql-jdbc</a>",
    "score" : 0,
    "owner" : {
      "account_id" : 20338,
      "reputation" : 65367,
      "user_id" : 48503,
      "user_type" : "registered",
      "accept_rate" : 100,
      "profile_image" : "https://www.gravatar.com/avatar/672f798341250dd228b286738e8d6309?s=256&d=identicon&r=PG",
      "display_name" : "Luke Woodward",
      "link" : "https://stackoverflow.com/users/48503/luke-woodward"
    },
    "creation_date" : 1746980828,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140415488,
    "post_id" : 79616408,
    "body" : "Of course, you have to ask yourself, if that <i>is</i> the classpath, then how does the driver get loaded? Try putting it on the classpath. Also, I&#39;m wondering why resort to a driver that&#39;s not open source when the open source one was working in the first place?",
    "score" : 0,
    "owner" : {
      "account_id" : 22124137,
      "reputation" : 4244,
      "user_id" : 16376827,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/1ImPw.png?s=256",
      "display_name" : "g00se",
      "link" : "https://stackoverflow.com/users/16376827/g00se"
    },
    "creation_date" : 1746974718,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140415476,
    "post_id" : 79616408,
    "body" : "Well that looks OK. It <i>looks</i> like for some reason the configurable (connection) retry logic is substringing the classpath and failing. The problem is going to made difficult to investigate by that driver (I&#39;m guessing) being closed-source",
    "score" : 0,
    "owner" : {
      "account_id" : 22124137,
      "reputation" : 4244,
      "user_id" : 16376827,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/1ImPw.png?s=256",
      "display_name" : "g00se",
      "link" : "https://stackoverflow.com/users/16376827/g00se"
    },
    "creation_date" : 1746974180,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140415431,
    "post_id" : 79616408,
    "body" : "@g00se <code>C:\\Users\\Abra\\eclipse\\\\plugins&#47;org.eclipse.equinox.launcher_&zwnj;&#8203;1.6.1000.v20250227-1&zwnj;&#8203;734.jar</code>",
    "score" : 0,
    "owner" : {
      "account_id" : 2485939,
      "reputation" : 20969,
      "user_id" : 2164365,
      "user_type" : "registered",
      "accept_rate" : 40,
      "profile_image" : "https://i.sstatic.net/RKSgV.png?s=256",
      "display_name" : "Abra",
      "link" : "https://stackoverflow.com/users/2164365/abra"
    },
    "creation_date" : 1746972716,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140415300,
    "post_id" : 79616408,
    "body" : "What does <code>System.out.println(System.getProperty(&quot;java.class.path&quot;));</code> give? Looks like it&#39;s having problems parsing the classpath",
    "score" : 0,
    "owner" : {
      "account_id" : 22124137,
      "reputation" : 4244,
      "user_id" : 16376827,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/1ImPw.png?s=256",
      "display_name" : "g00se",
      "link" : "https://stackoverflow.com/users/16376827/g00se"
    },
    "creation_date" : 1746966360,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79617679" : [ {
      "comment_id" : 140735889,
      "post_id" : 79617679,
      "body" : "Bug is fixed in version 12.10.1, released 18 June 2025.",
      "score" : 0,
      "owner" : {
        "account_id" : 2485939,
        "reputation" : 20969,
        "user_id" : 2164365,
        "user_type" : "registered",
        "accept_rate" : 40,
        "profile_image" : "https://i.sstatic.net/RKSgV.png?s=256",
        "display_name" : "Abra",
        "link" : "https://stackoverflow.com/users/2164365/abra"
      },
      "creation_date" : 1757911045,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140417610,
      "post_id" : 79617679,
      "body" : "I confirm that the previous version of Microsoft JDBC driver for SQL Server, i.e. version 12.8.1, does not have this bug and my custom JavaBeans property editor successfully connects to SQL Server database from Eclipse WindowBuilder.",
      "score" : 0,
      "owner" : {
        "account_id" : 2485939,
        "reputation" : 20969,
        "user_id" : 2164365,
        "user_type" : "registered",
        "accept_rate" : 40,
        "profile_image" : "https://i.sstatic.net/RKSgV.png?s=256",
        "display_name" : "Abra",
        "link" : "https://stackoverflow.com/users/2164365/abra"
      },
      "creation_date" : 1747048482,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}