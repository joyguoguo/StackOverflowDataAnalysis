{
  "question" : {
    "question_id" : 79693118,
    "title" : "Convert Microsoft Word docx to html using Apache POI",
    "body" : "<p>I have to convert word docx files to html keeping the html format exactly the same as if it was converted by word itself. It will run in a production server where Office (Microsoft, OpenOffice, LibreOffice,...) are not allowed to be installed.</p>\n<p>I'm using Apache POI.</p>\n<p>As far as now I can get all elements of the docx document. The XWPFParagraph has a parameter where has the style used in the Microsoft Word document. I can access to the font-family, font-size and other parameters values in the Paragraph object but there are some definitions in the style that are not in the Paragraph nor in the Runs objects.</p>\n<p>I check on the internet and here and the suggestions are to use the properties in the Paragraph and the Run objects. But I cannot find, for example, a bold for characters that is defined in the style and not in the Paragraph nor in the Run.</p>\n<p>I tried several libraries, but the conversion has not the quality we need (DocConv, iText, Docx4j, JRTF, OpenSagres, PDFtoHTML, ...</p>\n<p>I'm also developing unzipping the docx to xml and using SAX, but I think itÂ´s a better job if I can do it all with POI.</p>\n<p>How can I get the list of Styles and their properties (name, alignment, font Family, Font size, ...) using POI?</p>\n<p>Thanks for any help.</p>\n<p>My code so far is this:</p>\n<pre><code>public class Start2 {\n\n    public static void main(String[] args) throws InvalidFormatException, IOException {\n        String inputDoc = &quot;D:/TestOutput/OriginalDoc.docx&quot;;\n        String styleP, styleR, auxTexto;\n        \n        boolean div = false;\n        \n        String htmlStart = &quot;&lt;html&gt;\\r\\n&quot;;\n        String htmlHead = &quot;&lt;meta http-equiv='Content-Type' content='text/html; charset=windows-1252'&gt;\\r\\n&quot; +\n                        &quot;&lt;meta name='viewport' content='width=device-width, initial-scale=1.0'&gt;\\r\\n&quot;;       \n        String htmlFilename = &quot;D:/TestOutput/TestOutput.html&quot;;\n        File htmlFile = new File(htmlFilename);\n        BufferedWriter bw = new BufferedWriter(new OutputStreamWriter(new FileOutputStream(htmlFile, false), StandardCharsets.UTF_8));\n        \n        FileInputStream fis = new FileInputStream(inputDoc);\n        XWPFDocument xdoc = new XWPFDocument(OPCPackage.open(fis));\n        List&lt;XWPFParagraph&gt; paragraphs = xdoc.getParagraphs();\n        \n        bw.write(htmlStart + &quot;\\r\\n&quot;);\n        bw.write(&quot;&lt;head&gt;\\r\\n&quot;);\n        bw.write(htmlHead);\n        bw.write(&quot;&lt;style&gt;\\r\\n&quot;);\n        bw.write(&quot;html {font-family:Arial;}\\r\\n&quot;);  // margin-left: 30px; margin-right: 30px; \n        \n        // ???\n        \n        bw.write(&quot;&lt;/style&gt;\\r\\n&quot;);\n        bw.write(&quot;&lt;/head&gt;\\r\\n&quot;);\n        bw.write(&quot;&lt;body&gt;\\r\\n&quot;);\n        \n        for(XWPFParagraph para : paragraphs) {\n            if (para.getStyle() != null) {\n                bw.write(&quot;&lt;p class='&quot; + para.getStyle() + &quot;'&quot;);\n                div = true;\n            } else {\n                bw.write(&quot;&lt;p&quot;);\n                div = false;\n            }\n            styleP = &quot;style='&quot;;\n            if (para.getFirstLineIndent() &gt; 0) {\n                styleP+= &quot;text-indent:&quot; + para.getFirstLineIndent() +&quot;;&quot;;\n            }\n            \n            if(para.getAlignment() != null) {\n                auxTexto = para.getAlignment().name().toLowerCase();\n                if (auxTexto.equalsIgnoreCase(&quot;both&quot;)) {\n                    auxTexto = &quot;justify&quot;;\n                }\n                styleP+= &quot;text-align: &quot; + auxTexto + &quot;;&quot;;\n            }\n            \n            if (!&quot;style='&quot;.equals(styleP)) {\n                bw.write(&quot; &quot; + styleP + &quot;'&gt;&quot;);\n            } else {\n                bw.write(&quot;&gt;&quot;);\n            }\n            \n            for(XWPFRun run : para.getRuns()) {\n                \n                styleR = &quot; style='&quot;;\n                if (run.getFontFamily() != null) {\n                    styleR+= &quot;font-family:&quot; + run.getFontFamily() + &quot;;&quot;;\n                }\n                \n                \n                bw.write(run.text());\n//                System.out.println(run.text() + &quot; Images: &quot; + run.getEmbeddedPictures().size());\n            }\n            if (div) {\n                bw.write(&quot;&lt;/p&gt;\\r\\n&quot;);\n            } else {\n                bw.write(&quot;&lt;/p&gt;&quot;);\n            }\n        }\n        bw.write(&quot;&lt;/body&gt;\\r\\n&quot;);\n        bw.write(&quot;&lt;/html&gt;&quot;);\n        bw.close();\n        System.out.println(&quot;END PGM&quot;);\n    }\n    \n}\n</code></pre>\n",
    "tags" : [ "java", "ms-word", "apache-poi" ],
    "owner" : {
      "account_id" : 2751365,
      "reputation" : 145,
      "user_id" : 2370686,
      "user_type" : "registered",
      "accept_rate" : 50,
      "profile_image" : "https://www.gravatar.com/avatar/b0491362419dab8c8ab0612ca6b6f684?s=256&d=identicon&r=PG",
      "display_name" : "Augusto",
      "link" : "https://stackoverflow.com/users/2370686/augusto"
    },
    "is_answered" : true,
    "view_count" : 90,
    "answer_count" : 1,
    "score" : 2,
    "last_activity_date" : 1751904307,
    "creation_date" : 1751903737,
    "link" : "https://stackoverflow.com/questions/79693118/convert-microsoft-word-docx-to-html-using-apache-poi",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79693125,
    "question_id" : 79693118,
    "body" : "<p>You can access Word styles in Apache POI using the <strong>XWPFStyles</strong> class from the document. Here's a <strong>short explanation</strong>:</p>\n<ul>\n<li><p>Get the document styles using:</p>\n<pre><code>XWPFStyles styles = xdoc.getStyles();\n\n</code></pre>\n</li>\n<li><p>For each style, get its properties like font, alignment, bold, etc. Example:</p>\n<pre><code>for (XWPFStyle style : styles.getUsedStyles()) {\n    System.out.println(&quot;Style ID: &quot; + style.getStyleId());\n    System.out.println(&quot;Name: &quot; + style.getName());\n    // Access paragraph and run properties\n    if (style.getCTStyle().isSetRPr()) {\n        // Check for bold, font family, etc.\n    }\n}\n\n</code></pre>\n</li>\n<li><p>The style properties might be in the <strong>CTStyle -&gt; RPr</strong> (Run Properties) or <strong>PPr</strong> (Paragraph Properties).</p>\n</li>\n</ul>\n",
    "score" : 3,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 42917556,
      "reputation" : 46,
      "user_id" : 30985472,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/9cdacc10b039622b20fff295ae6a5260?s=256&d=identicon&r=PG",
      "display_name" : "Linda John Eckles",
      "link" : "https://stackoverflow.com/users/30985472/linda-john-eckles"
    },
    "creation_date" : 1751904307,
    "last_activity_date" : 1751904307,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140572038,
    "post_id" : 79693118,
    "body" : "Apache Tika has some support for converting Word docs to HTML - built using POI.",
    "score" : 0,
    "owner" : {
      "account_id" : 964210,
      "reputation" : 1076,
      "user_id" : 987959,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/a51610eaffa3f4e8022a07bcd070ab3c?s=256&d=identicon&r=PG",
      "display_name" : "PJ Fanning",
      "link" : "https://stackoverflow.com/users/987959/pj-fanning"
    },
    "creation_date" : 1751927567,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}