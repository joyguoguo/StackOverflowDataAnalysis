{
  "question" : {
    "question_id" : 79562715,
    "title" : "Why are the MD5 values in AWS SDK version 2.31.16 different from previous versions?",
    "body" : "<p>I have a project that uses the <code>software.amazon.awssdk</code> dependency to manage (copy, move, delete) content in AWS buckets.</p>\n<p>This is the method the project uses to copy an object into a bucket. The <code>S3Client</code> is of the class <code>software.amazon.awssdk.services.s3</code>. It uses the MD5 value of the file to ensure that the copy has completed without corruption.</p>\n<pre><code>public String putS3Object(S3Client s3Client, String bucketName, String key, String md5Checksum,\n                                  String contnent) {\n    PutObjectRequest metadataPutRequest = PutObjectRequest.builder()\n            .bucket(bucketName)\n            .key(key)\n            .contentMD5(md5Checksum)\n            .build();\n    byte[] bytes = org.apache.commons.codec.binary.Base64.decodeBase64(contnent);\n    PutObjectResponse putObjectResponse = s3Client.putObject(metadataPutRequest, RequestBody.fromBytes(bytes));\n    return putObjectResponse.eTag();\n}\n</code></pre>\n<p>The metadata is calculated by using this method</p>\n<pre><code>\npublic static String generateFileChecksum(Path path) {\n    try (var inputStream = Files.newInputStream(path)) {\n        return Base64.encodeBase64String(DigestUtils.md5(inputStream));\n    } catch (IOException e) {\n        throw new IllegalStateException(&quot;Failure computing checksum for file &quot;+ path.toFile().getAbsolutePath(), e);\n    }\n}\n</code></pre>\n<p>All of this code worked fine previously.</p>\n<p>Since I have updated the library from version <code>2.21.41</code> to version <code>2.31.16</code> the MD5 checksum being calculated by the S3Client’s putObject method has changed. I am unsure why and I’m unsure how to refactor my code to account for the change. How is MD5 calculation handled in the latest library?</p>\n",
    "tags" : [ "java", "spring-boot", "amazon-s3" ],
    "owner" : {
      "account_id" : 11865640,
      "reputation" : 415,
      "user_id" : 8683238,
      "user_type" : "registered",
      "accept_rate" : 100,
      "profile_image" : "https://www.gravatar.com/avatar/10b76fad3be494ae66fe743481356a05?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Space Cadet",
      "link" : "https://stackoverflow.com/users/8683238/space-cadet"
    },
    "is_answered" : false,
    "view_count" : 146,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1744198984,
    "creation_date" : 1744133451,
    "link" : "https://stackoverflow.com/questions/79562715/why-are-the-md5-values-in-aws-sdk-version-2-31-16-different-from-previous-versio",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140315194,
    "post_id" : 79562715,
    "body" : "<a href=\"https://github.com/aws/aws-sdk-java-v2/compare/2.21.41...2.31.16\" rel=\"nofollow noreferrer\">github.com/aws/aws-sdk-java-v2/compare/2.21.41...2.31.16</a> That&#39;s 1.5 years of development. Maybe you could try different versions to find out which version introduced the changes?",
    "score" : 0,
    "owner" : {
      "account_id" : 1888781,
      "reputation" : 2498,
      "user_id" : 1707427,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/4d1a2608ee35e2df7d2400a02e62bb20?s=256&d=identicon&r=PG",
      "display_name" : "S&#246;ren",
      "link" : "https://stackoverflow.com/users/1707427/s%c3%b6ren"
    },
    "creation_date" : 1744188759,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140314866,
    "post_id" : 79562715,
    "body" : "Thanks for this tip. The previous version was:  software.amazon.awssdk:s3 -&gt; 2.21.41 (*)",
    "score" : 0,
    "owner" : {
      "account_id" : 11865640,
      "reputation" : 415,
      "user_id" : 8683238,
      "user_type" : "registered",
      "accept_rate" : 100,
      "profile_image" : "https://www.gravatar.com/avatar/10b76fad3be494ae66fe743481356a05?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Space Cadet",
      "link" : "https://stackoverflow.com/users/8683238/space-cadet"
    },
    "creation_date" : 1744183831,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140313245,
    "post_id" : 79562715,
    "body" : "Please go back in your git history and use <code>.&#47;gradlew dependencies</code> to find out what version of the aws sdk you were using before.",
    "score" : 0,
    "owner" : {
      "account_id" : 1888781,
      "reputation" : 2498,
      "user_id" : 1707427,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/4d1a2608ee35e2df7d2400a02e62bb20?s=256&d=identicon&r=PG",
      "display_name" : "S&#246;ren",
      "link" : "https://stackoverflow.com/users/1707427/s%c3%b6ren"
    },
    "creation_date" : 1744138322,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140313083,
    "post_id" : 79562715,
    "body" : "<code>generateFileChecksum</code> works on a <code>Path</code>, <code>putS3Object</code> works on an Base64 encoded String. There&#39;s a lot that could go wrong in between. Could you please create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that shows your problem? e.g., a hard coded byte array with a hard coded md5 sum, that you can upload with one version of the library and not with the other.",
    "score" : 0,
    "owner" : {
      "account_id" : 1888781,
      "reputation" : 2498,
      "user_id" : 1707427,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/4d1a2608ee35e2df7d2400a02e62bb20?s=256&d=identicon&r=PG",
      "display_name" : "S&#246;ren",
      "link" : "https://stackoverflow.com/users/1707427/s%c3%b6ren"
    },
    "creation_date" : 1744135419,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}