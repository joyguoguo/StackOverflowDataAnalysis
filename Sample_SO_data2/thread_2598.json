{
  "question" : {
    "question_id" : 79611987,
    "title" : "Spring testing loads wrong data.sql file?",
    "body" : "<p>The issue I am having is that Spring is trying to load the wrong data.sql file. I want to use a specific test.sql and application properties file.</p>\n<p>Here is my folder structure:</p>\n<pre><code>main\n  -resources\n    -application.properties\n    -data.sql\ntest\n  -resources\n    -application.properties\n    -data.sql\n</code></pre>\n<p>When I run my test, Spring tries to load <code>main/data.sql</code> file, and throws errors on database name etc.</p>\n<p>For example, here is a test file:</p>\n<pre><code>@DataJpaTest\n@AutoConfigureTestDatabase(replace = AutoConfigureTestDatabase.Replace.NONE)\n@ActiveProfiles(&quot;test&quot;)\npublic class SomeRepositoryTest { ... }\n</code></pre>\n<p>Here is my <code>test/application.properties</code>:</p>\n<pre><code>spring.datasource.url=jdbc:h2:mem:testdb;DB_CLOSE_DELAY=-1\nspring.datasource.driverClassName=org.h2.Driver\nspring.datasource.username=sa\nspring.datasource.password=\nspring.jpa.hibernate.ddl-auto=create-drop\nspring.jpa.properties.hibernate.dialect=org.hibernate.dialect.H2Dialect\nspring.jpa.defer-datasource-initialization=true\nspring.sql.init.mode=always\nspring.sql.init.schema-locations=classpath:data.sql\n</code></pre>\n<p>I've tried to change the names, play around with my properties file, etc but I have had no success on getting Spring to load the test data file for my test. Any suggestions?</p>\n",
    "tags" : [ "java", "spring", "spring-boot", "hibernate" ],
    "owner" : {
      "account_id" : 4030419,
      "reputation" : 3640,
      "user_id" : 5328691,
      "user_type" : "registered",
      "accept_rate" : 100,
      "profile_image" : "https://www.gravatar.com/avatar/9a192a9167fbddc9a2280720264eeb5d?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "CJR",
      "link" : "https://stackoverflow.com/users/5328691/cjr"
    },
    "is_answered" : false,
    "view_count" : 70,
    "answer_count" : 2,
    "score" : 0,
    "last_activity_date" : 1746728471,
    "creation_date" : 1746692528,
    "link" : "https://stackoverflow.com/questions/79611987/spring-testing-loads-wrong-data-sql-file",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79612231,
    "question_id" : 79611987,
    "body" : "<p>Did you try to change the <code>application.properties</code> located in test directory to <code>application-&lt;active-profile&gt;.properites</code></p>\n<p>i,e <code>application-test.properties</code></p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 14715869,
      "reputation" : 1,
      "user_id" : 10627854,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/s256-rj/photo.jpg",
      "display_name" : "Kavitha Hawaldar",
      "link" : "https://stackoverflow.com/users/10627854/kavitha-hawaldar"
    },
    "creation_date" : 1746702187,
    "last_activity_date" : 1746702187,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79612954,
    "question_id" : 79611987,
    "body" : "<p>Your problem is not with the <code>application.properties</code> naming or the active profile. The issue is Spring Boot loads <code>data.sql</code> from <code>src/main/resources</code> by default, unless you explicitly tell it otherwise.</p>\n<p>Even though your <code>application.properties</code> under <code>src/test/resources</code> is loaded correctly, Spring Boot still picks up <code>data.sql</code> from main because the data initialization script locations are not overridden.</p>\n<p>This current property:</p>\n<pre><code>spring.sql.init.schema-locations=classpath:data.sql\n</code></pre>\n<p>Only affects <code>schema.sql</code>, not <code>data.sql</code>.</p>\n<p>To tell Spring Boot to use the <code>data.sql</code> from the <code>test/resources</code> folder, add this line to your <code>test/application.properties</code>:</p>\n<pre><code>spring.sql.init.data-locations=classpath:data.sql\n</code></pre>\n<p>This will force Spring Boot to use <code>src/test/resources/data.sql</code> during your tests.</p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 38931631,
      "reputation" : 671,
      "user_id" : 29023248,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/WxoZEuKw.png?s=256",
      "display_name" : "Aleksey Bykov",
      "link" : "https://stackoverflow.com/users/29023248/aleksey-bykov"
    },
    "creation_date" : 1746728471,
    "last_activity_date" : 1746728471,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : { }
}