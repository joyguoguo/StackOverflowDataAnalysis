{
  "question" : {
    "question_id" : 79846783,
    "title" : "I wrote a variation of the double-to-string algorithm Ryu and I&#39;m struggling with coverage tests",
    "body" : "<p>I wrote a variation of Ryu double-to-stream algorithm. My version has no meaningful impact on the code, for the purpose of this question you can read the <a href=\"https://github.com/ulfjack/ryu/blob/master/src/main/java/info/adams/ryu/RyuDouble.java\" rel=\"nofollow noreferrer\">original file</a>.</p>\n<p>I'm writing coverage test for my application and I cant find a double value, parameter of the function <code>public static String doubleToString(double value)</code>, that will lead the subsequent call to <code>private static int decimalLength(long v)</code> return 1.</p>\n<p>The <code>decimalLength</code> function is called <a href=\"https://github.com/ulfjack/ryu/blob/1264a946ba66eab320e927bfd2362e0c8580c42f/src/main/java/info/adams/ryu/RyuDouble.java#L241\" rel=\"nofollow noreferrer\">only once here</a> to compute a variable called <code>vplength</code> like this <code>final int vplength = decimalLength(dp);</code>.</p>\n<p>The <code>decimalLength</code> function simply count the number of digits, base 10, of whatever long is passed to it. So the problem is finding a double value that will make the <code>dp</code> value &lt; 10.</p>\n<p>There are not a lot of comment in the original code so I am having troubles finding out the solution. I started reading the <a href=\"https://dl.acm.org/doi/10.1145/3296979.3192369\" rel=\"nofollow noreferrer\">ACM article</a> but it will take some time.</p>\n",
    "tags" : [ "java", "math", "binary", "double", "code-coverage" ],
    "owner" : {
      "account_id" : 9325387,
      "reputation" : 93,
      "user_id" : 6922878,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/961274c1414700ab722cbd45632b99cb?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Vento",
      "link" : "https://stackoverflow.com/users/6922878/vento"
    },
    "is_answered" : false,
    "view_count" : 82,
    "closed_date" : 1765809037,
    "answer_count" : 0,
    "score" : -3,
    "last_activity_date" : 1765790466,
    "creation_date" : 1765664640,
    "link" : "https://stackoverflow.com/questions/79846783/i-wrote-a-variation-of-the-double-to-string-algorithm-ryu-and-im-struggling-wit",
    "closed_reason" : "Needs details or clarity"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140903840,
    "post_id" : 79846783,
    "body" : "@EricPostpischil I rewrite the whole question so the whole thing can be analyzed by just looking at the original algorithm code. Thank you for your suggestions :)",
    "score" : 0,
    "owner" : {
      "account_id" : 9325387,
      "reputation" : 93,
      "user_id" : 6922878,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/961274c1414700ab722cbd45632b99cb?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Vento",
      "link" : "https://stackoverflow.com/users/6922878/vento"
    },
    "creation_date" : 1765790526,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140903206,
    "post_id" : 79846783,
    "body" : "@EricPostpischil I admit I added too much information, I wanted to add context to avoid the usual &quot;Why are you doing X? You should do Y instead&quot; as per Stackoverflow customs.  The code is not commented a lot because the original algorithm is not commented a lot, I only removed few variables and if statements related to features I did not use. Nevertheless I&#39;ll improve the comments on the new code I added. As per the second point, yes I should have added it as an answer. It will take some time but I will follow your suggestion.  P.s. &quot;What are dv, dp, dm?&quot; I would like to know too :(",
    "score" : 0,
    "owner" : {
      "account_id" : 9325387,
      "reputation" : 93,
      "user_id" : 6922878,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/961274c1414700ab722cbd45632b99cb?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Vento",
      "link" : "https://stackoverflow.com/users/6922878/vento"
    },
    "creation_date" : 1765740487,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140903058,
    "post_id" : 79846783,
    "body" : "Document the code more. You have a routine called <code>fillBuffer</code> with no comment prior to it, and the comment just after the declaration says “Otherwise extract the mantissa and exponent bits and run the full algorithm.” Those contrast and do not make things clear for a reader: Extracting a mantissa is not filling a buffer. What bits is <code>fillBuffer</code> being passed in its <code>bits</code> argument? What are <code>dv</code>, <code>dp</code>, <code>dm</code>? What is each section of code doing?",
    "score" : 0,
    "owner" : {
      "account_id" : 113187,
      "reputation" : 233380,
      "user_id" : 298225,
      "user_type" : "registered",
      "accept_rate" : 100,
      "profile_image" : "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=256&d=identicon&r=PG",
      "display_name" : "Eric Postpischil",
      "link" : "https://stackoverflow.com/users/298225/eric-postpischil"
    },
    "creation_date" : 1765729535,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140903053,
    "post_id" : 79846783,
    "body" : "If the second point is solved, the solution should be entered as an answer, not edited into the question, or the question can be removed from the post entirely, as nobody else has answered it yet. (Editing a post to remove a question that has been answered would be problematic.)",
    "score" : 1,
    "owner" : {
      "account_id" : 113187,
      "reputation" : 233380,
      "user_id" : 298225,
      "user_type" : "registered",
      "accept_rate" : 100,
      "profile_image" : "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=256&d=identicon&r=PG",
      "display_name" : "Eric Postpischil",
      "link" : "https://stackoverflow.com/users/298225/eric-postpischil"
    },
    "creation_date" : 1765729343,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140903052,
    "post_id" : 79846783,
    "body" : "… A point of doing that is that somebody might have some interesting in devising numbers with the specified properties. It is less likely that somebody is going to dig through your code and figure out what code flow needs to happen to get to that point.",
    "score" : 0,
    "owner" : {
      "account_id" : 113187,
      "reputation" : 233380,
      "user_id" : 298225,
      "user_type" : "registered",
      "accept_rate" : 100,
      "profile_image" : "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=256&d=identicon&r=PG",
      "display_name" : "Eric Postpischil",
      "link" : "https://stackoverflow.com/users/298225/eric-postpischil"
    },
    "creation_date" : 1765729279,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140903049,
    "post_id" : 79846783,
    "body" : "Delete the nine bullet items at the start. They are irrelevant to the question of finding test cases. Write the question you are asking at the start. Describe the test cases to be found by more than their effect at a single point of code. For example, for 1, you want to “cover” the last line of <code>decimalLength</code>. I presume you mean to find a value such that the <code>return 1;</code> is executed, rather than a prior case? State the mathematical properties that a number needs to have to get to the point where <code>decimalLength</code> is called with the argument <code>dp</code> less than 10, thus getting to the last line…",
    "score" : 2,
    "owner" : {
      "account_id" : 113187,
      "reputation" : 233380,
      "user_id" : 298225,
      "user_type" : "registered",
      "accept_rate" : 100,
      "profile_image" : "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=256&d=identicon&r=PG",
      "display_name" : "Eric Postpischil",
      "link" : "https://stackoverflow.com/users/298225/eric-postpischil"
    },
    "creation_date" : 1765729227,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}