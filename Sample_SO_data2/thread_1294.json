{
  "question" : {
    "question_id" : 79726753,
    "title" : "How to map additional aliased columns from a native query to a JPA entity when the column does not physically exist?",
    "body" : "<p>I have the following Spring Data JPA repository method using a native query with an aliased column that does not exist physically in the database table:</p>\n<pre><code>@Repository\npublic interface GetDatesByIdRepository extends JpaRepository&lt;GetDatesJpaEntity, Long&gt; {\n    @Query(\n        value = &quot;&quot;&quot;\n            select\n                sch.id,\n                sch.status,\n                sch.patientid,\n                sch.appointmentdate,\n                sch.starttime,\n                sch.duration,\n                sch.departmentid,\n                sch.templatedId,\n                block.id as replacementblockId\n            from\n                Dates sch\n            left join Dates block on sch.id = block.templateappointmentid and sch.id != block.id\n            where\n                sch.id = :dateId\n            &quot;&quot;&quot;,\n        nativeQuery = true)\n    GetDatesJpaEntity findDatesByIdWithReplacement(Long dateId);\n}\n</code></pre>\n<p>And the entity:</p>\n<pre><code>@AllArgsConstructor\n@NoArgsConstructor\n@Entity\npublic class GetDatesJpaEntity {\n    @Id\n    @Column(name = &quot;ID&quot;)\n    public long id;\n\n    @Column(name = &quot;TEMPLATEDID&quot;)\n    public Long templatedId;\n\n    @Column(name = &quot;PATIENTLOCATIONID&quot;)\n    public Long patientLocationId;\n\n    @Column(name = &quot;PATIENTID&quot;)\n    public Long patientId;\n\n    @Column(name = &quot;STATUS&quot;)\n    public String status;\n\n    @Column(name = &quot;APPOINTMENTDATE&quot;)\n    public LocalDateTime appointmentDate;\n\n    @Column(name = &quot;STARTTIME&quot;)\n    public LocalDateTime startTime;\n\n    @Column(name = &quot;DURATION&quot;)\n    public Long duration;\n\n    @Column(name = &quot;DEPARTMENTID&quot;)\n    public Long departmentId;\n}\n</code></pre>\n<p>The problem is that the aliased column replacementblockId does not exist in the table and is not mapped in the entity. I initially tried to add this field to the entity as:</p>\n<pre><code>@Column(name = &quot;REPLACEMENTBLOCKID&quot;)\nprivate long replacementBlockId;\n</code></pre>\n<p>But this causes errors because the column does not physically exist.</p>\n<p>What is the best practice or recommended approach to handle this scenario in Spring Data JPA? I want to avoid major refactoring such as introducing DTOs if possible.</p>\n",
    "tags" : [ "java", "spring", "jpa", "spring-data-jpa", "nativequery" ],
    "owner" : {
      "account_id" : 6099776,
      "reputation" : 2219,
      "user_id" : 4759182,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/bbf667ccbf157a60ff9ceb2199239d35?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "rasilvap",
      "link" : "https://stackoverflow.com/users/4759182/rasilvap"
    },
    "is_answered" : false,
    "view_count" : 59,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1754446401,
    "creation_date" : 1754446401,
    "link" : "https://stackoverflow.com/questions/79726753/how-to-map-additional-aliased-columns-from-a-native-query-to-a-jpa-entity-when-t",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140676794,
    "post_id" : 79726753,
    "body" : "Best practice is.. to use the JPA entity annotations as they are. You have a data value that is in another table, so presumably it already has entity representation somewhere, and should/could have mapped the sch.id = block.templateappointmentid relationship in the model somehow. So what you are asking for is a projection of these two entities which avoids you having to forever modify the existing GetDatesJpaEntity entity to handle non-existing fields. Treat it like an entity or a DTO, but not both if you can. Otherwise, map it to the entity as a secondary table and not ever insert the entity",
    "score" : 0,
    "owner" : {
      "account_id" : 231721,
      "reputation" : 21335,
      "user_id" : 496099,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/efa7510cf47d7bd79e80486246e7e39e?s=256&d=identicon&r=PG",
      "display_name" : "Chris",
      "link" : "https://stackoverflow.com/users/496099/chris"
    },
    "creation_date" : 1755617738,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140648012,
    "post_id" : 79726753,
    "body" : "Why can&#39;t you just have a DTO with 2 fields of the <code>Date</code> entity - <code>date</code> referring to the original entity you select in your query and <code>replacementBlock</code> as the entity you seem to be joining to the first one? This would even allow you to get rid of the native query and use JPAs  DTO projection mechanism (&quot;SELECT new org.foo.DateWithReplacement(sch, replacementBlock) FROM Date sch ....&quot;)",
    "score" : 0,
    "owner" : {
      "account_id" : 1580843,
      "reputation" : 13706,
      "user_id" : 1466267,
      "user_type" : "registered",
      "accept_rate" : 91,
      "profile_image" : "https://www.gravatar.com/avatar/c47d1f7544a8c4a1bb7a41d511f53604?s=256&d=identicon&r=PG",
      "display_name" : "SpaceTrucker",
      "link" : "https://stackoverflow.com/users/1466267/spacetrucker"
    },
    "creation_date" : 1754544974,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140645367,
    "post_id" : 79726753,
    "body" : "What do you want hibernate to do when you read/update that entity?",
    "score" : 1,
    "owner" : {
      "account_id" : 4497436,
      "reputation" : 20796,
      "user_id" : 3656904,
      "user_type" : "registered",
      "accept_rate" : 67,
      "profile_image" : "https://www.gravatar.com/avatar/8bdbd1f89f8907e8e8b15ab88c084c65?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "talex",
      "link" : "https://stackoverflow.com/users/3656904/talex"
    },
    "creation_date" : 1754463769,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140645353,
    "post_id" : 79726753,
    "body" : "Look at <code>SecondaryTable</code> annotation.",
    "score" : 0,
    "owner" : {
      "account_id" : 4497436,
      "reputation" : 20796,
      "user_id" : 3656904,
      "user_type" : "registered",
      "accept_rate" : 67,
      "profile_image" : "https://www.gravatar.com/avatar/8bdbd1f89f8907e8e8b15ab88c084c65?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "talex",
      "link" : "https://stackoverflow.com/users/3656904/talex"
    },
    "creation_date" : 1754463260,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}