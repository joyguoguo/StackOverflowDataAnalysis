{
  "question" : {
    "question_id" : 79579785,
    "title" : "Converting Duration to YearToSecond with jooq I don&#39;t get the initial value when converting back to Duration",
    "body" : "<p>I'm trying to convert from a <code>Duration</code> into jooq's <code>YearToSecond</code> and then convert back to duration. I've realised that my result is different from the initial duration. Here's my test:</p>\n<p>If I do:</p>\n<pre class=\"lang-scala prettyprint-override\"><code>val duration = Duration.parse(&quot;P365D&quot;)\nval yearsDays = YearToSecond.valueOf(duration)\nval result = yearsDays.toDuration\nassertEquals(result, duration) \n</code></pre>\n<p>I get:</p>\n<pre class=\"lang-none prettyprint-override\"><code>=&gt; Diff (- obtained, + expected)\n-PT8886H\n+PT8760H\n</code></pre>\n<p>Is this expected? Is there an alternative?\nBTW, i'm using jooq version 3.19.19.</p>\n",
    "tags" : [ "java", "scala", "jooq" ],
    "owner" : {
      "account_id" : 10458062,
      "reputation" : 127,
      "user_id" : 7709729,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/nVYWI.jpg?s=256",
      "display_name" : "Pedro Alipio",
      "link" : "https://stackoverflow.com/users/7709729/pedro-alipio"
    },
    "is_answered" : false,
    "view_count" : 118,
    "answer_count" : 0,
    "score" : 1,
    "last_activity_date" : 1744916795,
    "creation_date" : 1744910859,
    "link" : "https://stackoverflow.com/questions/79579785/converting-duration-to-yeartosecond-with-jooq-i-dont-get-the-initial-value-when",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140361429,
    "post_id" : 79579785,
    "body" : "I&#39;ve added this: forcedType&gt;           &lt;name&gt;duration&lt;/name&gt;           &lt;userType&gt;java.time.Duration&lt;/userType&gt;           &lt;binding&gt;servicevalidation.api.repo.IntervalToDurationBindin&zwnj;&#8203;g&lt;/binding&gt;           &lt;includeTypes&gt;(?i:INTERVAL)&lt;/includeTypes&gt;           &lt;nullability&gt;ALL&lt;/nullability&gt;         &lt;/forcedType&gt;",
    "score" : 0,
    "owner" : {
      "account_id" : 10458062,
      "reputation" : 127,
      "user_id" : 7709729,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/nVYWI.jpg?s=256",
      "display_name" : "Pedro Alipio",
      "link" : "https://stackoverflow.com/users/7709729/pedro-alipio"
    },
    "creation_date" : 1745412935,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140361422,
    "post_id" : 79579785,
    "body" : "I&#39;ve created custom bindings for Duration and I&#39;ve specify it in the jooq-codegen.xml. The code gets generated correctly but jooq still calls createField with YearToSecond as I&#39;ve mentioned.",
    "score" : 0,
    "owner" : {
      "account_id" : 10458062,
      "reputation" : 127,
      "user_id" : 7709729,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/nVYWI.jpg?s=256",
      "display_name" : "Pedro Alipio",
      "link" : "https://stackoverflow.com/users/7709729/pedro-alipio"
    },
    "creation_date" : 1745412867,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140357108,
    "post_id" : 79579785,
    "body" : "<i>&quot;Thanks but that doesn&#39;t seem to help. Jooq bindings use YearToSecond. And I don&#39;t seem to find a way to override it with a custom binding for durations.&quot;</i> You didn&#39;t show what you tried, so it&#39;s hard to help you with that, specifically. You can definitely override jOOQ&#39;s default behaviour with bindings...",
    "score" : 0,
    "owner" : {
      "account_id" : 247217,
      "reputation" : 223532,
      "user_id" : 521799,
      "user_type" : "registered",
      "accept_rate" : 89,
      "profile_image" : "https://www.gravatar.com/avatar/eb96efa7a5664ba1c4ebf586abd4121f?s=256&d=identicon&r=PG",
      "display_name" : "Lukas Eder",
      "link" : "https://stackoverflow.com/users/521799/lukas-eder"
    },
    "creation_date" : 1745313853,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140354207,
    "post_id" : 79579785,
    "body" : "I think this might solve my problem: test(&quot;Test jooq duration&quot;) {     val duration = Duration.parse(&quot;PT8886H&quot;)     val dayToSecond = DayToSecond.valueOf(duration)     val yearToSecond = YearToSecond(null, dayToSecond)     val result = yearToSecond.getDayToSecond.toDuration     assertEquals(result, duration) }",
    "score" : 0,
    "owner" : {
      "account_id" : 10458062,
      "reputation" : 127,
      "user_id" : 7709729,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/nVYWI.jpg?s=256",
      "display_name" : "Pedro Alipio",
      "link" : "https://stackoverflow.com/users/7709729/pedro-alipio"
    },
    "creation_date" : 1745235078,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140349352,
    "post_id" : 79579785,
    "body" : "@Pedo Alpio, can you try <code>INTERVAL</code> datatype instead of duration.",
    "score" : 0,
    "owner" : {
      "account_id" : 7645025,
      "reputation" : 440,
      "user_id" : 5795975,
      "user_type" : "registered",
      "profile_image" : "https://lh6.googleusercontent.com/-6KwPUS4RnyA/AAAAAAAAAAI/AAAAAAAAC8w/auZqreI45x0/s256-rj/photo.jpg",
      "display_name" : "Vijay",
      "link" : "https://stackoverflow.com/users/5795975/vijay"
    },
    "creation_date" : 1745015604,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140348726,
    "post_id" : 79579785,
    "body" : "Getting this error:  no suitable method found for createField(org.jooq.Name,org.jooq.DataType&lt;org.jooq.types.Y&zwnj;&#8203;earToSecond&gt;,service&zwnj;&#8203;validation.db.schema&zwnj;&#8203;.servicevalidation.t&zwnj;&#8203;ables.ProviderBasedR&zwnj;&#8203;estrictions,java.lan&zwnj;&#8203;g.String,servicevali&zwnj;&#8203;dation.api.repo.Post&zwnj;&#8203;gresIntervalDuration&zwnj;&#8203;Binding)",
    "score" : 0,
    "owner" : {
      "account_id" : 10458062,
      "reputation" : 127,
      "user_id" : 7709729,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/nVYWI.jpg?s=256",
      "display_name" : "Pedro Alipio",
      "link" : "https://stackoverflow.com/users/7709729/pedro-alipio"
    },
    "creation_date" : 1744997881,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140348503,
    "post_id" : 79579785,
    "body" : "Thanks but that doesn&#39;t seem to help. Jooq bindings use YearToSecond. And I don&#39;t seem to find a way to override it with a custom binding for durations. No matter what is still using YearToSecond in the generated code.",
    "score" : 0,
    "owner" : {
      "account_id" : 10458062,
      "reputation" : 127,
      "user_id" : 7709729,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/nVYWI.jpg?s=256",
      "display_name" : "Pedro Alipio",
      "link" : "https://stackoverflow.com/users/7709729/pedro-alipio"
    },
    "creation_date" : 1744993299,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140345732,
    "post_id" : 79579785,
    "body" : "<code>SELECT EXTRACT(EPOCH FROM your_interval_column) AS duration_seconds FROM your_table;</code> Then in Java/Kotlin:  <code>val seconds = record.get(&quot;duration_seconds&quot;, Long::class.java)  val duration = Duration.ofSeconds(seconds)</code>",
    "score" : 0,
    "owner" : {
      "account_id" : 7645025,
      "reputation" : 440,
      "user_id" : 5795975,
      "user_type" : "registered",
      "profile_image" : "https://lh6.googleusercontent.com/-6KwPUS4RnyA/AAAAAAAAAAI/AAAAAAAAC8w/auZqreI45x0/s256-rj/photo.jpg",
      "display_name" : "Vijay",
      "link" : "https://stackoverflow.com/users/5795975/vijay"
    },
    "creation_date" : 1744913215,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140345725,
    "post_id" : 79579785,
    "body" : "Jooq converts postgres Intervals to YearToSecond. How can I stick to Durations?",
    "score" : 0,
    "owner" : {
      "account_id" : 10458062,
      "reputation" : 127,
      "user_id" : 7709729,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/nVYWI.jpg?s=256",
      "display_name" : "Pedro Alipio",
      "link" : "https://stackoverflow.com/users/7709729/pedro-alipio"
    },
    "creation_date" : 1744912978,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140345673,
    "post_id" : 79579785,
    "body" : "Yes, the mismatch is expected: jOOQâ€™s YearToSecond assumes 1 year = 365.25 days, which causes rounding when converting durations. Use DayToSecond or stick to Duration for exact time math to avoid this approximation.",
    "score" : 0,
    "owner" : {
      "account_id" : 7645025,
      "reputation" : 440,
      "user_id" : 5795975,
      "user_type" : "registered",
      "profile_image" : "https://lh6.googleusercontent.com/-6KwPUS4RnyA/AAAAAAAAAAI/AAAAAAAAC8w/auZqreI45x0/s256-rj/photo.jpg",
      "display_name" : "Vijay",
      "link" : "https://stackoverflow.com/users/5795975/vijay"
    },
    "creation_date" : 1744911727,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}