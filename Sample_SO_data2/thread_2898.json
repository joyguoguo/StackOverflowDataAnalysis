{
  "question" : {
    "question_id" : 79589237,
    "title" : "Cassandra Connecting with SSL .crt,.key file using Java throwing bad certificate error",
    "body" : "<p>I'm trying to connect to Cassandra with SSL authentication using Spring Boot.</p>\n<p>When I tried to connect to Cassandra using the cqlsh terminal with .crt and .key file it connected,\nbut when I tried in Spring Boot(.crt and .key will be converted into keystore and truststore) I received the following exception:</p>\n<pre class=\"lang-none prettyprint-override\"><code>Caused by: javax.net.ssl.SSLHandshakeException: Received fatal alert: bad_certificate\n                at java.base/sun.security.ssl.Alert.createSSLException(Alert.java:131) ~[?:?]\n</code></pre>\n<p>This is the method I used to create the SSLContext object with the keystore and truststore:</p>\n<pre><code>public SSLContext getSSLCertificate5() {\n    log.info(&quot;getSSLCertificate5---- &quot;);\n    SSLContext sslContext = null;\n    try {\n        String key = usageServiceProperties.getCassandraKeyStorePassword();\n        \n        //Load keystore\n        KeyStore keyStore = KeyStore.getInstance(&quot;JKS&quot;);\n        keyStore.load(usageServiceProperties.getKeyStorePath().getInputStream(), key.toCharArray());\n        KeyManagerFactory keyManagerFactory = KeyManagerFactory.getInstance(&quot;SunX509&quot;);\n        keyManagerFactory.init(keyStore, key.toCharArray());\n\n        TrustManagerFactory tmf = TrustManagerFactory.getInstance(&quot;SunX509&quot;);\n        KeyStore trustStore = KeyStore.getInstance(&quot;JKS&quot;);\n        trustStore.load(usageServiceProperties.getTrustStorePath().getInputStream(), key.toCharArray());\n        tmf.init(trustStore);\n    \n        sslContext = SSLContext.getInstance(&quot;TLS&quot;);\n        sslContext.init(keyManagerFactory.getKeyManagers(), tmf.getTrustManagers() , null);\n\n    } catch (Exception e) {\n        log.error(&quot;Error occured-- &quot;,e);\n    }\n\n    return sslContext;\n}\n</code></pre>\n<p>I tried all possibilities, but I haven't been able to connect, can anyone help on this? Cassandra should connect with SSL auth using Spring Boot.</p>\n",
    "tags" : [ "java", "spring-boot", "authentication", "ssl", "cassandra" ],
    "owner" : {
      "account_id" : 10330627,
      "reputation" : 11,
      "user_id" : 7620565,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/-Gcegxz7ETBE/AAAAAAAAAAI/AAAAAAAAABs/VRCmCciQNg4/s256-rj/photo.jpg",
      "display_name" : "deepak aravind",
      "link" : "https://stackoverflow.com/users/7620565/deepak-aravind"
    },
    "is_answered" : true,
    "view_count" : 73,
    "answer_count" : 1,
    "score" : 1,
    "last_activity_date" : 1745512288,
    "creation_date" : 1745431717,
    "link" : "https://stackoverflow.com/questions/79589237/cassandra-connecting-with-ssl-crt-key-file-using-java-throwing-bad-certificate",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79591093,
    "question_id" : 79589237,
    "body" : "<p>If you are using Spring Boot 3.1 or later, you don't need to do this yourself since Spring Boot can do it for you with <a href=\"https://docs.spring.io/spring-boot/reference/features/ssl.html\" rel=\"nofollow noreferrer\">SSL bundles</a>.</p>\n<p>Define a bundle for the certificate and key in your <code>application.yml</code> file (no need to convert them to a Java keystore) and apply the bundle to the Cassandra connection:</p>\n<pre class=\"lang-yaml prettyprint-override\"><code>spring:\n  ssl:\n    bundle:\n      pem:\n        cassandra-ssl:\n          keystore:\n            certificate: &quot;classpath:cassandra.crt&quot;\n            private-key: &quot;classpath:cassandra.key&quot;\n  cassandra:\n    ssl:\n      bundle: &quot;cassandra-ssl&quot;\n</code></pre>\n<p>This can also be done using <code>application.properties</code> instead of <code>application.yml</code>.</p>\n",
    "score" : 1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 1362416,
      "reputation" : 5399,
      "user_id" : 1299533,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/5fecafb1f46cd05cd8caaa6e9a4b9cad?s=256&d=identicon&r=PG",
      "display_name" : "Scott Frederick",
      "link" : "https://stackoverflow.com/users/1299533/scott-frederick"
    },
    "creation_date" : 1745512288,
    "last_activity_date" : 1745512288,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140363438,
    "post_id" : 79589237,
    "body" : "Convert .crt + .key to .p12 and import the CA cert to a truststore. Then configure SSLContext with correct KeyManager and TrustManager to authenticate with Cassandra from Java.",
    "score" : 0,
    "owner" : {
      "account_id" : 7645025,
      "reputation" : 440,
      "user_id" : 5795975,
      "user_type" : "registered",
      "profile_image" : "https://lh6.googleusercontent.com/-6KwPUS4RnyA/AAAAAAAAAAI/AAAAAAAAC8w/auZqreI45x0/s256-rj/photo.jpg",
      "display_name" : "Vijay",
      "link" : "https://stackoverflow.com/users/5795975/vijay"
    },
    "creation_date" : 1745450824,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}