{
  "question" : {
    "question_id" : 79807175,
    "title" : "Delete a file from one PC to another on the LAN",
    "body" : "<p>I use Java 17 on Debian 12.12 and I need to delete a file that resides on another PC in LAN, also with Debian 12.12.\nThis is my test program:</p>\n<pre><code>package filedelete;\n\nimport com.hierynomus.smbj.SMBClient;\nimport com.hierynomus.smbj.auth.AuthenticationContext;\nimport com.hierynomus.smbj.connection.Connection;\nimport com.hierynomus.smbj.session.Session;\nimport com.hierynomus.smbj.share.DiskShare;\nimport java.io.IOException;\nimport java.util.logging.Level;\nimport java.util.logging.Logger;\n\npublic class FileDelete {\n\n  static void DelFile() {\n    SMBClient client = new SMBClient();\n    try (Connection cnt = client.connect(&quot;192.168.1.2&quot;)) {\n      AuthenticationContext ac = new AuthenticationContext(&quot;UserName&quot;, &quot;UserPassword&quot;.toCharArray(), &quot;&quot;);\n      Session ses = cnt.authenticate(ac);\n      try (DiskShare ds = (DiskShare) ses.connectShare(&quot;Dati&quot;)) {\n        ds.rm(&quot;/Temp/Pippo.txt&quot;);\n      }\n    } catch (IOException ex) {\n      Logger.getLogger(FileDelete.class.getName()).log(Level.SEVERE, null, ex);\n    }\n  }\n\n  public static void main(String[] args) {\n    DelFile();\n  }\n}\n\n</code></pre>\n<p>The program deletes the file <code>/Temp/Pippo.txt</code> but then waits about a minute and gives me the following error on the line <code>ds.rm(&quot;/Temp/Pippo.txt&quot;);</code>:</p>\n<blockquote>\n<p>Exception in thread &quot;main&quot; com.hierynomus.smbj.common.SMBRuntimeException: com.hierynomus.protocol.transport.TransportException: java.util.concurrent.ExecutionException: com.hierynomus.smbj.common.SMBRuntimeException: com.hierynomus.protocol.transport.TransportException: java.io.EOFException: EOF while reading packet</p>\n</blockquote>\n<p>I need to insert the deletion of a file into a loop of a more complex program that operates on directories and files. I need to solve this problem, since the program, with this error, stops and interrupts the rest of the operations that the program should do.</p>\n<p>Does anyone know how to solve the situation?</p>\n",
    "tags" : [ "java", "debian", "runtime-error", "delete-file", "lan" ],
    "owner" : {
      "account_id" : 19082404,
      "reputation" : 49,
      "user_id" : 19263575,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/2c5d78ac03d256fe075c420a4acff01e?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "ZioCrick",
      "link" : "https://stackoverflow.com/users/19263575/ziocrick"
    },
    "is_answered" : true,
    "view_count" : 277,
    "answer_count" : 1,
    "score" : -4,
    "last_activity_date" : 1762349102,
    "creation_date" : 1762092756,
    "link" : "https://stackoverflow.com/questions/79807175/delete-a-file-from-one-pc-to-another-on-the-lan",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79810106,
    "question_id" : 79807175,
    "body" : "<p>This is an example of a program I made to try the solution with <strong>JSch</strong> and it worked.</p>\n<pre><code>package filedelete;\n\nimport com.jcraft.jsch.*;\nimport java.util.logging.Level;\n\npublic class FileDelete {\n  static void DelFile() {\n    JSch jsch = new JSch();\n    Session session = null;\n    try {\n      session = jsch.getSession(&quot;UserName&quot;, &quot;IpAddres&quot;, 22);\n    } catch (JSchException ex) {\n      java.util.logging.Logger.getLogger(FileDelete.class.getName()).log(Level.SEVERE, null, ex);\n      return;\n    }\n    session.setPassword(&quot;UserPassword&quot;);\n    session.setConfig(&quot;StrictHostKeyChecking&quot;, &quot;no&quot;);\n    try {\n      session.connect();                \n    } catch (JSchException ex) {\n      java.util.logging.Logger.getLogger(FileDelete.class.getName()).log(Level.SEVERE, null, ex);\n      return;\n    }\n    Channel channel = null;\n    try {\n      channel = session.openChannel(&quot;sftp&quot;);\n      channel.connect();\n    } catch (JSchException ex) {\n      java.util.logging.Logger.getLogger(FileDelete.class.getName()).log(Level.SEVERE, null, ex);\n      return;\n    }\n    ChannelSftp sftp = (ChannelSftp) channel;\n    try {\n      sftp.rm(&quot;/media/Dati/Temp/Link.txt&quot;);\n    } catch (SftpException ex) {\n      java.util.logging.Logger.getLogger(FileDelete.class.getName()).log(Level.SEVERE, null, ex);\n    }\n    sftp.exit();\n    session.disconnect();\n  }  \n\n  public static void main(String[] args) {\n    DelFile();\n  }\n}\n</code></pre>\n",
    "score" : 1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 19082404,
      "reputation" : 49,
      "user_id" : 19263575,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/2c5d78ac03d256fe075c420a4acff01e?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "ZioCrick",
      "link" : "https://stackoverflow.com/users/19263575/ziocrick"
    },
    "creation_date" : 1762349102,
    "last_activity_date" : 1762349102,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140837856,
    "post_id" : 79807175,
    "body" : "My friends, I thank you from the bottom of my heart for your help, and in particular @PeterMmm and g00se who referred me to JSch, which solved the problem for me. Now I&#39;m publishing the source code. Now I have another big problem, but I open a new question.",
    "score" : 0,
    "owner" : {
      "account_id" : 19082404,
      "reputation" : 49,
      "user_id" : 19263575,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/2c5d78ac03d256fe075c420a4acff01e?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "ZioCrick",
      "link" : "https://stackoverflow.com/users/19263575/ziocrick"
    },
    "creation_date" : 1762349030,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140837495,
    "post_id" : 79807175,
    "body" : "Which SMB version does the server offer? Try to force the connection to run on a different SMB version.",
    "score" : 0,
    "owner" : {
      "account_id" : 44408768,
      "reputation" : 76,
      "user_id" : 31737384,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/564083619b88e3f94fb3d5555fbfc494?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Febrian",
      "link" : "https://stackoverflow.com/users/31737384/febrian"
    },
    "creation_date" : 1762337099,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140835560,
    "post_id" : 79807175,
    "body" : "<i>@g00se The data disks of my PCs are ntfs</i> Again, that&#39;s somewhat strange for a Linux box but is not a problem for the client, which would simply have a mount type of ntfs. In fact, you don&#39;t even need to specify the fs type when using <code>sshfs</code>. Worth also saying that recent Windows has SSH by default - it just needs to be enabled",
    "score" : 0,
    "owner" : {
      "account_id" : 22124137,
      "reputation" : 4244,
      "user_id" : 16376827,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/1ImPw.png?s=256",
      "display_name" : "g00se",
      "link" : "https://stackoverflow.com/users/16376827/g00se"
    },
    "creation_date" : 1762256851,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140835421,
    "post_id" : 79807175,
    "body" : "I&#39;m talking about <a href=\"https://linuxcommandlibrary.com/man/smbclient\" rel=\"nofollow noreferrer\"><code>smbclient</code></a> not your app",
    "score" : 0,
    "owner" : {
      "account_id" : 22124137,
      "reputation" : 4244,
      "user_id" : 16376827,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/1ImPw.png?s=256",
      "display_name" : "g00se",
      "link" : "https://stackoverflow.com/users/16376827/g00se"
    },
    "creation_date" : 1762251402,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140834998,
    "post_id" : 79807175,
    "body" : "@Gil Yes, of course, I&#39;m sure. In fact, the program manages to delete the file on my NAS on which there is a copy of the folders of the PC disk.  The problem exists only in the connection between 2 PCs. It&#39;s not a problem of permissions because they are the same on the two PCs and I use the same user.",
    "score" : 0,
    "owner" : {
      "account_id" : 19082404,
      "reputation" : 49,
      "user_id" : 19263575,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/2c5d78ac03d256fe075c420a4acff01e?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "ZioCrick",
      "link" : "https://stackoverflow.com/users/19263575/ziocrick"
    },
    "creation_date" : 1762238978,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140834989,
    "post_id" : 79807175,
    "body" : "@g00se The data disks of my PCs are ntfs, so with SSH it doesn&#39;t work? About: &quot;try that file delete with smbclient&quot; as I described in my initial question, the file is deleted, but then the program stops for a minute and finally gives me the error I reported.",
    "score" : 0,
    "owner" : {
      "account_id" : 19082404,
      "reputation" : 49,
      "user_id" : 19263575,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/2c5d78ac03d256fe075c420a4acff01e?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "ZioCrick",
      "link" : "https://stackoverflow.com/users/19263575/ziocrick"
    },
    "creation_date" : 1762238668,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140834878,
    "post_id" : 79807175,
    "body" : "Are you sure that <b>/Temp/Pippo.txt</b> isn&#39;t actually <b>/tmp/Pippo.txt</b>? Unix-like systems use <b>/tmp</b>, not <b>/Temp/</b>. There might be a permissions issue. If you generate this file with one user and try to delete it with another, an error might also occur.",
    "score" : 0,
    "owner" : {
      "account_id" : 15074809,
      "reputation" : 65,
      "user_id" : 12253435,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/fz1eeiX6.png?s=256",
      "display_name" : "Gil",
      "link" : "https://stackoverflow.com/users/12253435/gil"
    },
    "creation_date" : 1762228517,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140834343,
    "post_id" : 79807175,
    "body" : "Any PC the files of which you want to share would be acting as an SSH server. As far as Thunar is concerned, if your remote box is mounted via an sshfs mount, it would be accessible. It&#39;s no different to accessing a mapped drive on Windows Explorer. <i>What do you mean by &quot;you try the same op from smbclient&quot;?</i> I mean try that file delete with <code>smbclient</code> and see what happens",
    "score" : 0,
    "owner" : {
      "account_id" : 22124137,
      "reputation" : 4244,
      "user_id" : 16376827,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/1ImPw.png?s=256",
      "display_name" : "g00se",
      "link" : "https://stackoverflow.com/users/16376827/g00se"
    },
    "creation_date" : 1762196701,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140834205,
    "post_id" : 79807175,
    "body" : "@g00se Thank you for your explanation. You&#39;re right, in fact I don&#39;t use root on my pcs. In the program I brought I put it only as an example. You are talking about an SSH server, but then does it mean that I don&#39;t have to install SSH Server on every PC, but only on one of them? If, on the other hand, I have to install it on every PC, does it mean that I can access the disks shared by the others from every PC even with Thunar and therefore I can uninstall Samba?  Sorry but I didn&#39;t understand your second message.  What do you mean by &quot;you try the same op from smbclient&quot;?",
    "score" : 0,
    "owner" : {
      "account_id" : 19082404,
      "reputation" : 49,
      "user_id" : 19263575,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/2c5d78ac03d256fe075c420a4acff01e?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "ZioCrick",
      "link" : "https://stackoverflow.com/users/19263575/ziocrick"
    },
    "creation_date" : 1762192510,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140833813,
    "post_id" : 79807175,
    "body" : "fwiw I executed your code without problem so I&#39;d recommend you try the same op from <code>smbclient</code> and see what happens",
    "score" : 0,
    "owner" : {
      "account_id" : 22124137,
      "reputation" : 4244,
      "user_id" : 16376827,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/1ImPw.png?s=256",
      "display_name" : "g00se",
      "link" : "https://stackoverflow.com/users/16376827/g00se"
    },
    "creation_date" : 1762182039,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140833769,
    "post_id" : 79807175,
    "body" : "It <i>is</i> true that using samba between two Linux boxes is not the normal approach. It would be better to use SSH, as not only is it more natural but it&#39;s more secure too. Don&#39;t allow root logins though. In fact you should really ban root logins across the board. Once you&#39;ve installed an SSH server, you can use SSH mounts, which would be rather like mapping a drive to a remote Samba share",
    "score" : 1,
    "owner" : {
      "account_id" : 22124137,
      "reputation" : 4244,
      "user_id" : 16376827,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/1ImPw.png?s=256",
      "display_name" : "g00se",
      "link" : "https://stackoverflow.com/users/16376827/g00se"
    },
    "creation_date" : 1762180985,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140833639,
    "post_id" : 79807175,
    "body" : "Dear @PeterMmm, thank you for your suggestion.  I downloaded jsch and created a test program but found that it requires an SSH server.  No SSH server is installed on my PCs.  Strange that samba is not good because the PCs in my LAN communicate well via Debian&#39;s Thunar file manager.  Since I&#39;m not a system administrator and I&#39;ve already had a thousand problems with samba, I wouldn&#39;t want to face other difficulties to install a new network protocol.  Isn&#39;t there some other solution?",
    "score" : 0,
    "owner" : {
      "account_id" : 19082404,
      "reputation" : 49,
      "user_id" : 19263575,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/2c5d78ac03d256fe075c420a4acff01e?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "ZioCrick",
      "link" : "https://stackoverflow.com/users/19263575/ziocrick"
    },
    "creation_date" : 1762176121,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140833285,
    "post_id" : 79807175,
    "body" : "@PeterMmm there needs to be <i>some</i> kind of file sharing protocol other than Samba going on to allow that, so what is it?",
    "score" : 0,
    "owner" : {
      "account_id" : 22124137,
      "reputation" : 4244,
      "user_id" : 16376827,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/1ImPw.png?s=256",
      "display_name" : "g00se",
      "link" : "https://stackoverflow.com/users/16376827/g00se"
    },
    "creation_date" : 1762163209,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140832515,
    "post_id" : 79807175,
    "body" : "Why do you use SMBClient for this task? It is Linux to Linux.  <a href=\"https://github.com/mwiede/jsch\" rel=\"nofollow noreferrer\">github.com/mwiede/jsch</a> <a href=\"https://epaul.github.io/jsch-documentation/javadoc/com/jcraft/jsch/ChannelSftp.html#rm-java.lang.String-\" rel=\"nofollow noreferrer\">epaul.github.io/jsch-documentation/javadoc/com/jcraft/jsch/&hellip;</a>",
    "score" : 2,
    "owner" : {
      "account_id" : 39574,
      "reputation" : 24690,
      "user_id" : 114226,
      "user_type" : "registered",
      "accept_rate" : 79,
      "profile_image" : "https://i.sstatic.net/FHfgU.png?s=256",
      "display_name" : "PeterMmm",
      "link" : "https://stackoverflow.com/users/114226/petermmm"
    },
    "creation_date" : 1762112277,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140832361,
    "post_id" : 79807175,
    "body" : "@qrtt1 do you have an example of using pywinrm to show me? I searched on web but I can&#39;t find anything, not even the documentation. Or a link to a site where there is documentation with examples. Thank you.",
    "score" : 0,
    "owner" : {
      "account_id" : 19082404,
      "reputation" : 49,
      "user_id" : 19263575,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/2c5d78ac03d256fe075c420a4acff01e?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "ZioCrick",
      "link" : "https://stackoverflow.com/users/19263575/ziocrick"
    },
    "creation_date" : 1762103951,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140832269,
    "post_id" : 79807175,
    "body" : "@MarcePuente Oh, sorry about that. Thank you for letting me know.",
    "score" : 0,
    "owner" : {
      "account_id" : 24172783,
      "reputation" : 1324,
      "user_id" : 21440243,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/YzROW.jpg?s=256",
      "display_name" : "Starship",
      "link" : "https://stackoverflow.com/users/21440243/starship"
    },
    "creation_date" : 1762098604,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140832234,
    "post_id" : 79807175,
    "body" : "I use pywinrm from ubuntu to control my windows iot device. it really works.",
    "score" : 0,
    "owner" : {
      "account_id" : 32701,
      "reputation" : 7977,
      "user_id" : 90909,
      "user_type" : "registered",
      "accept_rate" : 89,
      "profile_image" : "https://www.gravatar.com/avatar/f3ad889e0325646eb4acff65bbfdc059?s=256&d=identicon&r=PG",
      "display_name" : "qrtt1",
      "link" : "https://stackoverflow.com/users/90909/qrtt1"
    },
    "creation_date" : 1762096463,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140832225,
    "post_id" : 79807175,
    "body" : "@Marce Puente I had tried the close but the program stops on the ds.rm and that&#39;s where it gives me the error.",
    "score" : 0,
    "owner" : {
      "account_id" : 19082404,
      "reputation" : 49,
      "user_id" : 19263575,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/2c5d78ac03d256fe075c420a4acff01e?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "ZioCrick",
      "link" : "https://stackoverflow.com/users/19263575/ziocrick"
    },
    "creation_date" : 1762096087,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140832222,
    "post_id" : 79807175,
    "body" : "@qrtt1 as I wrote in my question, I&#39;m not using Windows but Debian.",
    "score" : 0,
    "owner" : {
      "account_id" : 19082404,
      "reputation" : 49,
      "user_id" : 19263575,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/2c5d78ac03d256fe075c420a4acff01e?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "ZioCrick",
      "link" : "https://stackoverflow.com/users/19263575/ziocrick"
    },
    "creation_date" : 1762095915,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140832219,
    "post_id" : 79807175,
    "body" : "Dear @Starship I also included the error message in the code formatting. Ok for the try-catch, but the fact is that on that line the program stops for a minute and if my program has to delete dozens of files, it would take tens of minutes.",
    "score" : 0,
    "owner" : {
      "account_id" : 19082404,
      "reputation" : 49,
      "user_id" : 19263575,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/2c5d78ac03d256fe075c420a4acff01e?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "ZioCrick",
      "link" : "https://stackoverflow.com/users/19263575/ziocrick"
    },
    "creation_date" : 1762095800,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140832199,
    "post_id" : 79807175,
    "body" : "If the program works fine and the only issue is that you get an error at the end which stops the program, then just use a try-catch to have it go back to the regular program once it errors out.",
    "score" : 0,
    "owner" : {
      "account_id" : 24172783,
      "reputation" : 1324,
      "user_id" : 21440243,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/YzROW.jpg?s=256",
      "display_name" : "Starship",
      "link" : "https://stackoverflow.com/users/21440243/starship"
    },
    "creation_date" : 1762094611,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140832197,
    "post_id" : 79807175,
    "body" : "Brother, WinRM is a much more suitable protocol for this task. You can remotely execute a PowerShell command to delete the file instead. SMB isn’t really designed for this kind of operation — you might want to reconsider your approach.",
    "score" : 0,
    "owner" : {
      "account_id" : 32701,
      "reputation" : 7977,
      "user_id" : 90909,
      "user_type" : "registered",
      "accept_rate" : 89,
      "profile_image" : "https://www.gravatar.com/avatar/f3ad889e0325646eb4acff65bbfdc059?s=256&d=identicon&r=PG",
      "display_name" : "qrtt1",
      "link" : "https://stackoverflow.com/users/90909/qrtt1"
    },
    "creation_date" : 1762094482,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79810106" : [ {
      "comment_id" : 140838000,
      "post_id" : 79810106,
      "body" : "Yes, you can use sftp, which is an ssh  client, to do that if you want. But if this is a frequent requirement, it would be a lot simpler to have a permanent ssh mount and simply do <code>Files.delete(Path.of(&quot;mountpoint&#47;media&#47;Dati&#47;Temp&#47;Link.txt&quot;))&zwnj;&#8203;;</code>",
      "score" : 0,
      "owner" : {
        "account_id" : 22124137,
        "reputation" : 4244,
        "user_id" : 16376827,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/1ImPw.png?s=256",
        "display_name" : "g00se",
        "link" : "https://stackoverflow.com/users/16376827/g00se"
      },
      "creation_date" : 1762353338,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}