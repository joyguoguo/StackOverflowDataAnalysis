{
  "question" : {
    "question_id" : 79836333,
    "title" : "Java Module System Breaking Serialization of Standard Library Classes - Is there a better solution than --add-opens?",
    "body" : "<h2>Problem</h2>\n<p>When serializing Java standard library classes (like <code>java.awt.Rectangle</code>, <code>Point</code>, <code>Dimension</code>, etc.) using frameworks like XStream, Jackson, or Gson, I'm forced to use <code>--add-opens</code> flags:</p>\n<pre class=\"lang-bash prettyprint-override\"><code>--add-opens java.desktop/java.awt=ALL-UNNAMED\n</code></pre>\n<p>This is required because serialization frameworks need deep reflection access to private fields, but the module system blocks this even though my code properly declares module dependencies:</p>\n<pre class=\"lang-java prettyprint-override\"><code>module my.app {\n    requires java.desktop;  // Not sufficient for reflection!\n}\n</code></pre>\n<h2>The Core Issue</h2>\n<p><strong>I cannot open another module's packages from my <code>module-info.java</code></strong> - only the owning module can do that. The <code>opens</code> directive only works for your own packages:</p>\n<pre class=\"lang-java prettyprint-override\"><code>module my.app {\n    opens my.package to com.thoughtworks.xstream;  // ✓ Works for MY packages\n    requires java.desktop;                          // ✗ Doesn't open THEIR packages\n}\n</code></pre>\n<p>This design seems fundamentally broken for legitimate serialization use cases.</p>\n<h2>Why This Matters</h2>\n<ol>\n<li><strong><code>--add-opens</code> is a maintenance nightmare</strong> - Must track all affected modules across JDK versions</li>\n<li><strong>Runtime-only solution</strong> - Can't be declared in code, hard to discover when missing</li>\n<li><strong>Standard library classes aren't exotic</strong> - These are normal, stable public APIs (<code>Rectangle</code>, <code>Color</code>, <code>File</code>, etc.)</li>\n<li><strong>Affects all reflection-based frameworks</strong> - Not just serialization but also ORMs, testing frameworks, etc.</li>\n</ol>\n<h2>Questions</h2>\n<ol>\n<li><p><strong>Is there a comprehensive library providing serialization converters/adapters for common JDK classes?</strong> Specifically looking for XStream converters, but interested in solutions for Jackson/Gson as well.</p>\n</li>\n<li><p><strong>Why doesn't the JDK provide a &quot;serialization-friendly&quot; module</strong> that explicitly opens these stable classes for reflection? Something like <code>java.desktop.reflection</code> that could be optionally required?</p>\n</li>\n<li><p><strong>Are there any proposals or JEPs addressing this friction between modules and reflection?</strong></p>\n</li>\n</ol>\n<h2>What might be a solution?</h2>\n<ul>\n<li><strong>DTOs/wrapper classes</strong> - Too much boilerplate for dozens of JDK classes</li>\n<li><strong>Custom converters</strong> - Works but requires writing converters for every JDK class I serialize</li>\n</ul>\n<h2>Context</h2>\n<ul>\n<li>Using XStream for configuration serialization</li>\n<li>Need to serialize complex object graphs containing AWT geometry classes</li>\n<li>Java 17+, modular application</li>\n</ul>\n",
    "tags" : [ "java", "xstream", "java-module" ],
    "owner" : {
      "account_id" : 2152669,
      "reputation" : 1762,
      "user_id" : 1945316,
      "user_type" : "registered",
      "accept_rate" : 18,
      "profile_image" : "https://www.gravatar.com/avatar/aec50f6ea348ca30f5b77d868d038944?s=256&d=identicon&r=PG",
      "display_name" : "Thomas",
      "link" : "https://stackoverflow.com/users/1945316/thomas"
    },
    "is_answered" : true,
    "view_count" : 80,
    "answer_count" : 4,
    "score" : 1,
    "last_activity_date" : 1765462316,
    "creation_date" : 1764710538,
    "link" : "https://stackoverflow.com/questions/79836333/java-module-system-breaking-serialization-of-standard-library-classes-is-there",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79836825,
    "question_id" : 79836333,
    "body" : "<p>I would just bite the bullet and do the work of registering custom converters.  That aside… the reason this is so troublesome is that directly reading fields is fundamentally broken and violates one of the core principles of object-oriented design:  <strong>Private fields are private for a reason.</strong>  Good code uses public get/set methods (known as bean properties) and constructors to read and write state.  I would suggest using a better XML serialization framework, like <a href=\"https://docs.oracle.com/en/java/javase/25/docs/api/java.desktop/java/beans/XMLEncoder.html\" rel=\"nofollow noreferrer\">XMLEncoder</a> and <a href=\"https://docs.oracle.com/en/java/javase/25/docs/api/java.desktop/java/beans/XMLDecoder.html\" rel=\"nofollow noreferrer\">XMLDecoder</a>, or <a href=\"https://jakarta.ee/specifications/platform/9/apidocs/jakarta/xml/bind/package-summary\" rel=\"nofollow noreferrer\">JAXB</a>.  I’m pretty sure Jackson is also capable of using properties rather than fields for reading and writing.</p>\n",
    "score" : 3,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 2053598,
      "reputation" : 44991,
      "user_id" : 1831987,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/38b1c37530189ec4471a43a618e33f67?s=256&d=identicon&r=PG",
      "display_name" : "VGR",
      "link" : "https://stackoverflow.com/users/1831987/vgr"
    },
    "creation_date" : 1764761769,
    "last_activity_date" : 1764761769,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79844005,
    "question_id" : 79836333,
    "body" : "<p>Oddly enough, you named examples (<code>java.awt.Rectangle</code>, <code>Point</code>, <code>Dimension</code>) whose fields are <code>public</code> and don’t need deep Reflection at all. For truly <code>private</code> fields, there is no guarantee that they will exist in a compatible form across versions, so the “maintenance nightmare” is not the need for <code>--add-opens</code> here. You’re right that classes like <code>Color</code> or <code>File</code> aren’t exotic—so it’s even less understandable that a library has to resort to deep Reflection instead of providing built-in adapters for those well-known classes.</p>\n<p>Finally: Writing a converter for every class you want to support is trivial, even when numbers are high. At least, it implies that you had to put some effort in thinking about which classes you want to support. Unlike allowing a library to load arbitrary classes named by external content, followed by creating instance of those classes and initialize their fields with unverified values from that external content.</p>\n",
    "score" : 2,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 3211603,
      "reputation" : 301001,
      "user_id" : 2711488,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/t2hoD.jpg?s=256",
      "display_name" : "Holger",
      "link" : "https://stackoverflow.com/users/2711488/holger"
    },
    "creation_date" : 1765459780,
    "last_activity_date" : 1765462316,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79836406,
    "question_id" : 79836333,
    "body" : "<p>This seems too broad, even for open discussions. Maybe focus in one of the questions at a time.</p>\n",
    "score" : 1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 372682,
      "reputation" : 26512,
      "user_id" : 721855,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/vZiox.png?s=256",
      "display_name" : "aled",
      "link" : "https://stackoverflow.com/users/721855/aled"
    },
    "creation_date" : 1764718512,
    "last_activity_date" : 1764718512,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79836405,
    "question_id" : 79836333,
    "body" : "<p>Your item (2) is not a real question, and (3) can be answered by scanning the JEPs for yourself.</p>\n<p>NB I edited your tags. The <a href=\"/questions/tagged/jms\" class=\"s-tag post-tag\" title=\"show questions tagged &#39;jms&#39;\" aria-label=\"show questions tagged &#39;jms&#39;\" rel=\"tag\" aria-labelledby=\"tag-jms-tooltip-container\" data-tag-menu-origin=\"Unknown\">jms</a> tag is for questions about the Java Message Service, not the module system, which IMHO is a disaster.</p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 71739,
      "reputation" : 311888,
      "user_id" : 207421,
      "user_type" : "registered",
      "accept_rate" : 82,
      "profile_image" : "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=256&d=identicon&r=PG",
      "display_name" : "user207421",
      "link" : "https://stackoverflow.com/users/207421/user207421"
    },
    "creation_date" : 1764718039,
    "last_activity_date" : 1764804841,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : { }
}