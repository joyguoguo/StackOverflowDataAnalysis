{
  "question" : {
    "question_id" : 79562856,
    "title" : "Python flask server 405 error for a specific path when hosted on Azure, works fine locally",
    "body" : "<p>I'm building a flask app to process images uploaded from a mobile device, before sending results back to the mobile app. I've successfully deployed the flask app on Azure, and can confirm it works with certain paths, <code>/test</code> for one.</p>\n<p>The path my mobile app uses to upload an image, is <code>/upload-data</code>. When I run my flask app locally on my own PC and connect to it, this path works fine, accepting the image uploaded and returning a response.</p>\n<p>However, when using the flask app deployed on Azure, the response I get for <code>/upload-data</code> is just 405 (Method not allowed).</p>\n<p>This is the top part of my code in my python flask backend:</p>\n<pre class=\"lang-py prettyprint-override\"><code>@app.route(&quot;/upload-data&quot;, methods=['POST'])\ndef store_data():\n    #Image processing code etc...\n</code></pre>\n<p>And this is how I make the post to the above path in my java android app with OkHTTP:</p>\n<pre class=\"lang-java prettyprint-override\"><code>private void uploadData(String imagePath, String pointCloudPath) {\n        OkHttpClient client = new OkHttpClient.Builder()\n                .connectTimeout(10, TimeUnit.SECONDS)\n                .writeTimeout(10, TimeUnit.SECONDS)\n                .readTimeout(responseTimeOut, TimeUnit.SECONDS)\n                .build();\n        File imageFile = new File(imagePath);\n\n        //Create request body\n        RequestBody requestBody = new MultipartBody.Builder()\n                .setType(MultipartBody.FORM)\n                .addFormDataPart(&quot;image&quot;, imageFile.getName(),\n                        RequestBody.create(imageFile, MediaType.parse(&quot;image/jpeg&quot;)))\n                .build();\n\n        //Create request itself\n        String url = &quot;http://&quot; + backendUrl;\n        Request request = new Request.Builder()\n                .url(url+&quot;/upload-data&quot;)\n                .post(requestBody)\n                .build();\n\n        //Execute request in background\n        Log.d(&quot;OkHTTP Image Upload&quot;, &quot;Creating image upload request to: &quot; + request.url());\n        client.newCall(request).enqueue(new Callback() {\n            @Override\n            public void onFailure(@NonNull Call call, @NonNull IOException e) {\n                e.printStackTrace();\n                Log.e(&quot;OkHTTP Image Upload&quot;, &quot;Failed: &quot; + e.getMessage());\n                runOnUiThread(() -&gt; textStatus.setText(&quot;Request Failed: &quot; + e.getMessage()));\n            }\n            @Override\n            public void onResponse(@NonNull Call call, @NonNull Response response) {\n                if (response.isSuccessful()) {\n                    Log.d(&quot;OkHTTP Upload&quot;, &quot;Success&quot;);\n                    InputStream responseZipStream = response.body().byteStream();\n                    runOnUiThread(() -&gt; processAnalysisResponse(responseZipStream));\n                }\n                else {\n                    Log.e(&quot;OkHTTP Image Upload&quot;, &quot;Error: &quot;+response.code());\n                    runOnUiThread(() -&gt; textStatus.setText(&quot;Request Error: &quot;+response.code()));\n                }\n            }\n        });\n    }\n</code></pre>\n",
    "tags" : [ "python", "java", "azure", "flask", "okhttp" ],
    "owner" : {
      "account_id" : 27185895,
      "reputation" : 43,
      "user_id" : 20720342,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a/AEdFTp4ZgUFc8lGoN6NgNqfrdwpP-lOvwC_fizEnaJ_llw=k-s256",
      "display_name" : "Oli",
      "link" : "https://stackoverflow.com/users/20720342/oli"
    },
    "is_answered" : true,
    "view_count" : 119,
    "answer_count" : 1,
    "score" : 1,
    "last_activity_date" : 1744144318,
    "creation_date" : 1744138631,
    "link" : "https://stackoverflow.com/questions/79562856/python-flask-server-405-error-for-a-specific-path-when-hosted-on-azure-works-fi",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79563009,
    "question_id" : 79562856,
    "body" : "<p>I notice you're making your requests over HTTP not HTTPS, I imagine Azure is stricter on the POST requests rather than GET due to encrypting the body of the request.</p>\n<p>Make sure you have HTTPS only turned off in Azure Portal.</p>\n",
    "score" : 3,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 25183536,
      "reputation" : 72,
      "user_id" : 19024729,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/qkc3M.png?s=256",
      "display_name" : "Adam Govier",
      "link" : "https://stackoverflow.com/users/19024729/adam-govier"
    },
    "creation_date" : 1744144318,
    "last_activity_date" : 1744144318,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140313457,
    "post_id" : 79562856,
    "body" : "@Robert I can see Path mappings &gt; Mount Storage, is this the correct place?",
    "score" : 0,
    "owner" : {
      "account_id" : 27185895,
      "reputation" : 43,
      "user_id" : 20720342,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a/AEdFTp4ZgUFc8lGoN6NgNqfrdwpP-lOvwC_fizEnaJ_llw=k-s256",
      "display_name" : "Oli",
      "link" : "https://stackoverflow.com/users/20720342/oli"
    },
    "creation_date" : 1744142920,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140313444,
    "post_id" : 79562856,
    "body" : "@furas the only message from Azure was 405, there was no other error message in the live log feed",
    "score" : 0,
    "owner" : {
      "account_id" : 27185895,
      "reputation" : 43,
      "user_id" : 20720342,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a/AEdFTp4ZgUFc8lGoN6NgNqfrdwpP-lOvwC_fizEnaJ_llw=k-s256",
      "display_name" : "Oli",
      "link" : "https://stackoverflow.com/users/20720342/oli"
    },
    "creation_date" : 1744142707,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140313382,
    "post_id" : 79562856,
    "body" : "in Java you could display URL which you created - to check if you use correct URL. You could also test your flask code using other tools - ie. <code>curl</code> or <code>postman</code>",
    "score" : 0,
    "owner" : {
      "account_id" : 99309,
      "reputation" : 148833,
      "user_id" : 1832058,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/relWs.jpg?s=256",
      "display_name" : "furas",
      "link" : "https://stackoverflow.com/users/1832058/furas"
    },
    "creation_date" : 1744141595,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140313373,
    "post_id" : 79562856,
    "body" : "always put full error message because there are other useful information.",
    "score" : 0,
    "owner" : {
      "account_id" : 99309,
      "reputation" : 148833,
      "user_id" : 1832058,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/relWs.jpg?s=256",
      "display_name" : "furas",
      "link" : "https://stackoverflow.com/users/1832058/furas"
    },
    "creation_date" : 1744141449,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140313369,
    "post_id" : 79562856,
    "body" : "Is this the only route where you use POST? Normally on cloud services the Python server is not directly accessible from the Internet but through [reverse] proxies. Those proxies may cause the 405, check your Azure config where you can configure paths and allowed method types.",
    "score" : 1,
    "owner" : {
      "account_id" : 50585,
      "reputation" : 43469,
      "user_id" : 150978,
      "user_type" : "registered",
      "accept_rate" : 78,
      "profile_image" : "https://www.gravatar.com/avatar/feadc214792e2581c3c750140e3eb2c7?s=256&d=identicon&r=PG",
      "display_name" : "Robert",
      "link" : "https://stackoverflow.com/users/150978/robert"
    },
    "creation_date" : 1744141349,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79563009" : [ {
      "comment_id" : 140313520,
      "post_id" : 79563009,
      "body" : "This fixed it, thanks!",
      "score" : 1,
      "owner" : {
        "account_id" : 27185895,
        "reputation" : 43,
        "user_id" : 20720342,
        "user_type" : "registered",
        "profile_image" : "https://lh3.googleusercontent.com/a/AEdFTp4ZgUFc8lGoN6NgNqfrdwpP-lOvwC_fizEnaJ_llw=k-s256",
        "display_name" : "Oli",
        "link" : "https://stackoverflow.com/users/20720342/oli"
      },
      "creation_date" : 1744144341,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}