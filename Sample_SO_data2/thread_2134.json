{
  "question" : {
    "question_id" : 79647617,
    "title" : "How to apply multi-tenant filtering (e.g., hospitalId) using Hibernate filters with Spring Data JPA in the same database and schema?",
    "body" : "<p>I’m building a multi-tenant Spring Boot application where all tenants share the same database and schema, but data is separated by a hospital_id column in each table.</p>\n<p>Here’s my setup:</p>\n<ul>\n<li>Same database</li>\n<li>Same schema</li>\n<li>Tables have a hospital_id column</li>\n</ul>\n<p>I want to automatically filter data per tenant (hospitalId) without adding <code>WHERE hospital_id = :hospitalId</code> manually in every query.</p>\n<pre><code>@Entity\n@FilterDef(name = &quot;hospitalFilter&quot;, parameters = @ParamDef(name = &quot;hospitalId&quot;, type = &quot;string&quot;))\n@Filter(name = &quot;hospitalFilter&quot;, condition = &quot;hospital_id = :hospitalId&quot;)\npublic class PatientEntity {\n    @Id\n    private Long patientId;\n\n    @Column(name = &quot;hospital_id&quot;)\n    private String hospitalId;\n\n    // other fields\n}\n</code></pre>\n<p>I tried using Hibernate filter, but I think this is not working with jpa repo.</p>\n",
    "tags" : [ "java", "spring-boot", "microservices", "multi-tenant" ],
    "owner" : {
      "account_id" : 27999007,
      "reputation" : 11,
      "user_id" : 21383645,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/fa3abbe86f0b7364bd6901956aa31b49?s=256&d=identicon&r=PG",
      "display_name" : "Himanshu Sharma ",
      "link" : "https://stackoverflow.com/users/21383645/himanshu-sharma"
    },
    "is_answered" : true,
    "view_count" : 221,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1749937782,
    "creation_date" : 1748787665,
    "link" : "https://stackoverflow.com/questions/79647617/how-to-apply-multi-tenant-filtering-e-g-hospitalid-using-hibernate-filters-w",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79647692,
    "question_id" : 79647617,
    "body" : "<p>You can use Hibernate Filter with Spring Boot JPA but you have to enable it. I think you are missing the code to enable it.</p>\n<p>Refer to <a href=\"https://stackoverflow.com/questions/49752429/using-a-hibernate-filter-with-spring-boot-jpa\">Using Hibernate Filter with Spring Boot JPA</a> and <a href=\"https://stackoverflow.com/questions/70908591/how-can-i-activate-hibernate-filter-in-spring-boot\">How can I activate hibernate filter in Spring Boot</a>. (This one contains Git repo as an example too).</p>\n",
    "score" : 2,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 16860149,
      "reputation" : 181,
      "user_id" : 12191150,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/fec9a6154254eb5fd901f4a0045c0b1f?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Yasin Ahmed",
      "link" : "https://stackoverflow.com/users/12191150/yasin-ahmed"
    },
    "creation_date" : 1748792984,
    "last_activity_date" : 1749937782,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140567140,
    "post_id" : 79647617,
    "body" : "@halfer Yes, separating databases or schemas is a good idea. But in my case, all hospitals use the same schema, so having different databases or schemas can be costly and harder to manage.",
    "score" : 0,
    "owner" : {
      "account_id" : 27999007,
      "reputation" : 11,
      "user_id" : 21383645,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/fa3abbe86f0b7364bd6901956aa31b49?s=256&d=identicon&r=PG",
      "display_name" : "Himanshu Sharma ",
      "link" : "https://stackoverflow.com/users/21383645/himanshu-sharma"
    },
    "creation_date" : 1751733535,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140514126,
    "post_id" : 79647617,
    "body" : "If you&#39;re working in a medical environment, I suspect you should use separate databases or schemas. Would that not also simplify this design?",
    "score" : 0,
    "owner" : {
      "account_id" : 216950,
      "reputation" : 20182,
      "user_id" : 472495,
      "user_type" : "registered",
      "accept_rate" : 92,
      "profile_image" : "https://i.sstatic.net/4rtxd.png?s=256",
      "display_name" : "halfer",
      "link" : "https://stackoverflow.com/users/472495/halfer"
    },
    "creation_date" : 1749937757,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79647692" : [ {
      "comment_id" : 140617311,
      "post_id" : 79647692,
      "body" : "@HimanshuSharma As per Hibernate docs, &quot;Filters apply to entity queries, but not to direct fetching.&quot; - <a href=\"https://docs.jboss.org/hibernate/orm/5.6/userguide/html_single/Hibernate_User_Guide.html#pc-filter\" rel=\"nofollow noreferrer\">docs.jboss.org/hibernate/orm/5.6/userguide/html_single/&hellip;</a>",
      "score" : 1,
      "owner" : {
        "account_id" : 2076045,
        "reputation" : 2275,
        "user_id" : 1849366,
        "user_type" : "registered",
        "accept_rate" : 93,
        "profile_image" : "https://www.gravatar.com/avatar/620d6a576daef944bc405ce6ad85059c?s=256&d=identicon&r=PG",
        "display_name" : "Rajind Ruparathna",
        "link" : "https://stackoverflow.com/users/1849366/rajind-ruparathna"
      },
      "creation_date" : 1753429057,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140493934,
      "post_id" : 79647692,
      "body" : "Thanks, Yasin! It worked perfectly. However, I have one more question: it&#39;s working fine for the findAll() method, but when I call findById(), the filter isn’t being applied",
      "score" : 0,
      "owner" : {
        "account_id" : 27999007,
        "reputation" : 11,
        "user_id" : 21383645,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/fa3abbe86f0b7364bd6901956aa31b49?s=256&d=identicon&r=PG",
        "display_name" : "Himanshu Sharma ",
        "link" : "https://stackoverflow.com/users/21383645/himanshu-sharma"
      },
      "creation_date" : 1749229988,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}