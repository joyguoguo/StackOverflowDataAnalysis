{
  "question" : {
    "question_id" : 79701555,
    "title" : "How to fix Flutter &quot;Toolchain installation `usr/lib/jvm/java-21-openjdk` does not provide the required capabilities&quot; error",
    "body" : "<p>I keep getting this warning on (Fedora) Linux when opening a Flutter project of mine inside VS Code. I changed <code>JAVA_HOME</code> and used <code>flutter config --jdk-dir=&quot;/usr/lib/jvm/java-24-openjdk/</code> to change my Java version but it still keeps coming up with a warning referencing OpenJDK 21 (so before we even get to the question of the right java version, why is it stuck on version 21?):</p>\n<pre><code>The supplied phased action failed with an exception.\nCould not create task ':app:compileDebugAndroidTestJavaWithJavac'.\nFailed to calculate the value of task ':app:compileDebugAndroidTestJavaWithJavac' property 'javaCompiler'.\nToolchain installation '/usr/lib/jvm/java-21-openjdk' does not provide the required capabilities: [JAVA_COMPILER]\n</code></pre>\n<p>I even added <code>org.gradle.java.home=/usr/lib/jvm/java-24-openjdk</code> to <code>android/gradle.properties</code>.</p>\n<p>This is the output of <code>flutter doctor --verbose</code>:</p>\n<pre><code>[✓] Flutter (Channel stable, 3.32.6, on Fedora Linux 41 (KDE Plasma) 6.15.5-100.fc41.x86_64, locale en_GB.UTF-8) [120ms]\n    • Flutter version 3.32.6 on channel stable at /home/bitmapp3r/dev/flutter-sdk\n    • Upstream repository https://github.com/flutter/flutter.git\n    • Framework revision 077b4a4ce1 (6 days ago), 2025-07-08 13:31:08 -0700\n    • Engine revision 72f2b18bb0\n    • Dart version 3.8.1\n    • DevTools version 2.45.1\n\n[✓] Android toolchain - develop for Android devices (Android SDK version 36.0.0) [1,977ms]\n    • Android SDK at /home/bitmapp3r/Android/Sdk\n    • Platform android-36, build-tools 36.0.0\n    • Java binary at: /usr/lib/jvm/java-17-openjdk/bin/java\n      This JDK is specified in your Flutter configuration.\n      To change the current JDK, run: `flutter config --jdk-dir=&quot;path/to/jdk&quot;`.\n    • Java version OpenJDK Runtime Environment (Red_Hat-17.0.15.0.6-1) (build 17.0.15+6)\n    • All Android licenses accepted.\n\n[✓] Chrome - develop for the web [25ms]\n    • Chrome at google-chrome\n\n[✓] Linux toolchain - develop for Linux desktop [556ms]\n    • clang version 19.1.7 (Fedora 19.1.7-4.fc41)\n    • cmake version 3.30.8\n    • ninja version 1.12.1\n    • pkg-config version 2.3.0\n    • OpenGL core renderer: AMD Radeon Graphics (radeonsi, renoir, ACO, DRM 3.63, 6.15.5-100.fc41.x86_64)\n    • OpenGL core version: 4.6 (Core Profile) Mesa 25.0.7\n    • OpenGL core shading language version: 4.60\n    • OpenGL ES renderer: AMD Radeon Graphics (radeonsi, renoir, ACO, DRM 3.63, 6.15.5-100.fc41.x86_64)\n    • OpenGL ES version: OpenGL ES 3.2 Mesa 25.0.7\n    • OpenGL ES shading language version: OpenGL ES GLSL ES 3.20\n    • GL_EXT_framebuffer_blit: yes\n    • GL_EXT_texture_format_BGRA8888: yes\n\n[✓] Android Studio (version 2025.1.1) [21ms]\n    • Android Studio at /opt/android-studio\n    • Flutter plugin can be installed from:\n      \uD83D\uDD28 https://plugins.jetbrains.com/plugin/9212-flutter\n    • Dart plugin can be installed from:\n      \uD83D\uDD28 https://plugins.jetbrains.com/plugin/6351-dart\n    • Java version OpenJDK Runtime Environment (build 21.0.6+-13391695-b895.109)\n\n[✓] VS Code (version unknown) [19ms]\n    • VS Code at /usr/share/code\n    • Flutter extension version 3.114.0\n    ✗ Unable to determine VS Code version.\n\n[✓] Connected device (3 available) [261ms]\n    • SM S911B (mobile) • RFCX808ZYCE • android-arm64  • Android 15 (API 35)\n    • Linux (desktop)   • linux       • linux-x64      • Fedora Linux 41 (KDE Plasma) 6.15.5-100.fc41.x86_64\n    • Chrome (web)      • chrome      • web-javascript • Google Chrome 138.0.7204.100\n\n[✓] Network resources [656ms]\n    • All expected network resources are available.\n\n• No issues found!\n</code></pre>\n<p>Here is my <code>android/app/build.gradle.kts</code> (I omitted the project name)</p>\n<pre><code>plugins {\n    id(&quot;com.android.application&quot;)\n    id(&quot;kotlin-android&quot;)\n    // The Flutter Gradle Plugin must be applied after the Android and Kotlin Gradle plugins.\n    id(&quot;dev.flutter.flutter-gradle-plugin&quot;)\n}\n\nandroid {\n    namespace = &quot;com.example.x&quot;\n    compileSdk = flutter.compileSdkVersion\n    ndkVersion = flutter.ndkVersion\n\n    compileOptions {\n        sourceCompatibility = JavaVersion.VERSION_11\n        targetCompatibility = JavaVersion.VERSION_11\n    }\n\n    kotlinOptions {\n        jvmTarget = JavaVersion.VERSION_11.toString()\n    }\n\n    defaultConfig {\n        // TODO: Specify your own unique Application ID (https://developer.android.com/studio/build/application-id.html).\n        applicationId = &quot;com.example.x&quot;\n        // You can update the following values to match your application needs.\n        // For more information, see: https://flutter.dev/to/review-gradle-config.\n        minSdk = flutter.minSdkVersion\n        targetSdk = flutter.targetSdkVersion\n        versionCode = flutter.versionCode\n        versionName = flutter.versionName\n    }\n\n    buildTypes {\n        release {\n            // TODO: Add your own signing config for the release build.\n            // Signing with the debug keys for now, so `flutter run --release` works.\n            signingConfig = signingConfigs.getByName(&quot;debug&quot;)\n        }\n    }\n}\n\nflutter {\n    source = &quot;../..&quot;\n}\n</code></pre>\n",
    "tags" : [ "java", "flutter", "android-studio", "visual-studio-code", "fedora" ],
    "owner" : {
      "account_id" : 14597160,
      "reputation" : 49,
      "user_id" : 10542502,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/YgrTH.jpg?s=256",
      "display_name" : "Bitmapper",
      "link" : "https://stackoverflow.com/users/10542502/bitmapper"
    },
    "is_answered" : true,
    "view_count" : 1502,
    "answer_count" : 1,
    "score" : 3,
    "last_activity_date" : 1757965685,
    "creation_date" : 1752553823,
    "link" : "https://stackoverflow.com/questions/79701555/how-to-fix-flutter-toolchain-installation-usr-lib-jvm-java-21-openjdk-does-no",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79765545,
    "question_id" : 79701555,
    "body" : "<p>i have the same issue and solve it buy install the java with devel\nsince fedora in default install java headless (does not contains javac)</p>\n<p>run this command in the terminal</p>\n<pre class=\"lang-none prettyprint-override\"><code>sudo dnf install java-devel\n</code></pre>\n<p>if this not works\nuse the java that comes with the android studio</p>\n<p>in android/gradle.properties add the java</p>\n<pre><code>org.gradle.java.home=/{android_studio_location}/android-studio/jbr/\n</code></pre>\n",
    "score" : 2,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 26907617,
      "reputation" : 11,
      "user_id" : 20483698,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a/ALm5wu0Mk_AzmN2Ck8D1Xu9WUYJGPlPfz_N-V97YvFEk=k-s256",
      "display_name" : "Hesham Alnahas",
      "link" : "https://stackoverflow.com/users/20483698/hesham-alnahas"
    },
    "creation_date" : 1757965180,
    "last_activity_date" : 1757965685,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140645974,
    "post_id" : 79701555,
    "body" : "It looks like the <i>original</i> problem was that the Flutter was attempting to use a Java (21) installation that was a JRE not a JDK.   I thinks that is what <i>&quot;does not provide the required capabilities: [JAVA_COMPILER]&quot;</i> is saying.  A JRE doesn&#39;t include a Java compiler.",
    "score" : 0,
    "owner" : {
      "account_id" : 47283,
      "reputation" : 723470,
      "user_id" : 139985,
      "user_type" : "registered",
      "accept_rate" : 69,
      "profile_image" : "https://www.gravatar.com/avatar/147c5a9cc1feec049c50da791ac7d144?s=256&d=identicon&r=PG",
      "display_name" : "Stephen C",
      "link" : "https://stackoverflow.com/users/139985/stephen-c"
    },
    "creation_date" : 1754478026,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140592361,
    "post_id" : 79701555,
    "body" : "The next thing I did was to switch to the newest JDK my distribution packages had that was version 23 or below which ended up being JDK 21 funnily enough (I also set my Flutter config to use JDK 21). I relogged in and all the warnings have seemed to go away now, even though I am using JDK 21. The weird thing is that I never got these warnings on my windows machine. [4/4]",
    "score" : 0,
    "owner" : {
      "account_id" : 14597160,
      "reputation" : 49,
      "user_id" : 10542502,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/YgrTH.jpg?s=256",
      "display_name" : "Bitmapper",
      "link" : "https://stackoverflow.com/users/10542502/bitmapper"
    },
    "creation_date" : 1752617950,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140592360,
    "post_id" : 79701555,
    "body" : "Android studio also mentioned that the maximum JDK version supported by my gradle version at the time (8.12) was JDK 23. Opening VS Code at this point gave me a different (and potentially more sensible/meaningful?) error of some sort of &quot;Unsupported class file major version 68&quot; and some &quot;Type T not present&quot; which felt like it would be due to the fact that my <code>JAVA_HOME</code> was JDK 24. [3/4]",
    "score" : 0,
    "owner" : {
      "account_id" : 14597160,
      "reputation" : 49,
      "user_id" : 10542502,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/YgrTH.jpg?s=256",
      "display_name" : "Bitmapper",
      "link" : "https://stackoverflow.com/users/10542502/bitmapper"
    },
    "creation_date" : 1752617944,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140592358,
    "post_id" : 79701555,
    "body" : "I opened the <code>android</code> folder in android studio and then I saw that I was using AGP 8.7.3 (the instructions to install Flutter mentioned installing Android SDK Platform API 35, but when I installed Android Studio it came with API 36). Looking at the <a href=\"https://developer.android.com/build/releases/gradle-plugin#api-level-support\" rel=\"nofollow noreferrer\">AGP 8.11 release notes</a> I saw a table of minimum versions of tools for Android API levels. It showed that API 36 required a minimum AGP version of 8.9.1. I upgraded AGP using the tool (which also seemed to upgrade my gradle version from 8.12 to 8.13). [2/4]",
    "score" : 0,
    "owner" : {
      "account_id" : 14597160,
      "reputation" : 49,
      "user_id" : 10542502,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/YgrTH.jpg?s=256",
      "display_name" : "Bitmapper",
      "link" : "https://stackoverflow.com/users/10542502/bitmapper"
    },
    "creation_date" : 1752617932,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140592357,
    "post_id" : 79701555,
    "body" : "@tomerpacific I found that changing <code>JAVA_HOME</code> specifically in <code>.bash_profile</code> (not <code>.bashrc</code>) from 24 to 17, relogging in and then clearing the workspace cache caused the warning to go away. The question still remains though of <i>why the warning mentioned JDK 21 when <code>JAVA_HOME</code> nor the Flutter config pointed to that</i> - <code>JAVA_HOME</code> was set to JDK 24 and Flutter config was set to JDK 17 (and, for the record, making them the same did not change anything). [1/4]",
    "score" : 0,
    "owner" : {
      "account_id" : 14597160,
      "reputation" : 49,
      "user_id" : 10542502,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/YgrTH.jpg?s=256",
      "display_name" : "Bitmapper",
      "link" : "https://stackoverflow.com/users/10542502/bitmapper"
    },
    "creation_date" : 1752617914,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140589862,
    "post_id" : 79701555,
    "body" : "Have you tried opening the android folder of your Flutter application in Android Studio and changing the <b>Gradle JDK</b> of the project? Because I see that you your compile options are for Java 11.",
    "score" : 0,
    "owner" : {
      "account_id" : 14722107,
      "reputation" : 6861,
      "user_id" : 10632369,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/541566093e9d34a3858f5446d06a7a6e?s=256&d=identicon&r=PG",
      "display_name" : "tomerpacific",
      "link" : "https://stackoverflow.com/users/10632369/tomerpacific"
    },
    "creation_date" : 1752558429,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140589791,
    "post_id" : 79701555,
    "body" : "@tomerpacific I just added the output of <code>flutter doctor --verbose</code> which should include the Flutter version, along with my <code>android&#47;app&#47;build.gradle.kts</code> as an edit to the original question.",
    "score" : 0,
    "owner" : {
      "account_id" : 14597160,
      "reputation" : 49,
      "user_id" : 10542502,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/YgrTH.jpg?s=256",
      "display_name" : "Bitmapper",
      "link" : "https://stackoverflow.com/users/10542502/bitmapper"
    },
    "creation_date" : 1752555229,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140589777,
    "post_id" : 79701555,
    "body" : "What Flutter version are you using? Also, could you share the build.gradle of your project?",
    "score" : 0,
    "owner" : {
      "account_id" : 14722107,
      "reputation" : 6861,
      "user_id" : 10632369,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/541566093e9d34a3858f5446d06a7a6e?s=256&d=identicon&r=PG",
      "display_name" : "tomerpacific",
      "link" : "https://stackoverflow.com/users/10632369/tomerpacific"
    },
    "creation_date" : 1752554293,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}