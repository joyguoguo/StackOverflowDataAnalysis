{
  "question" : {
    "question_id" : 79773877,
    "title" : "Spring boot 3.4 app not respecting hikari max conn pool limit",
    "body" : "<p>We have configured Hikari with a maximum of 24 connections. However, in our Oracle DB we are observing more than 100 active connections per pod. Our setup is Spring Boot with Kafka (Confluent) using a parallel consumer, with concurrency set to 12. Additionally, we have a retry mechanism configured (maximum of 3 attempts) within a transactional method.</p>\n<p>When we log conn status every 30 sec from Hikari data source its always showing correct value. However in Oracle DB its showing different.</p>\n<p>Could you please help us understand why this is happening and guide us on how to address it?</p>\n<p>we are using <code>&lt;ojdbc11.version&gt;23.8.0.25.04&lt;/ojdbc11.version&gt;</code></p>\n<pre><code>hikari:\n  # === Pool Size Settings ===\n  maximum-pool-size:  ${HIKARI_MAXIMUM_POOL_SIZE:24}           # Maximum number of connections in the pool\n  minimum-idle: ${HIKARI_MINMUM_IDLE:6}                # Minimum number of idle connections to maintain\n\n  # === Timeout Settings ===\n  connection-timeout: ${HIKARI_CONNECTION_TIMEOUT:10000}        # Max time (10s) to wait for connection from pool\n  max-lifetime: ${HIKARI_MAX_LIFETIME:1800000}           # Max lifetime (30min) of connection in pool\n  idle-timeout: ${HIKARI_IDLE_TIMEOUT:600000}             # Max time (10min) connection can sit idle\n  validation-timeout: ${HIKARI_VALIDATION_TIMEOUT:3000}         # Max time (3s) to wait for connection validation\n  leak-detection-threshold: ${HIKARI_LEAK_DETECTION_THRESHOLD:300000}      # Time (5min) after which connection is considered leaked\n  auto-commit: ${HIKARI_AUTO_COMMIT:false}\n  pool-status-logging: ${HIKARI_POOL_STATUS_LOGGING:false}\n  # === Oracle-Specific Properties ===\n  data-source-properties:\n    # Connection validation method (LOCAL = client-side validation)\n    oracle.jdbc.defaultConnectionValidation: LOCAL\n\n    # Socket read timeout - max time to wait for data from Oracle server\n    oracle.jdbc.ReadTimeout: ${ORACLE_JDBC_READTIMEOUT:45000}         # 45 seconds\n\n    # TCP connection timeout - max time to establish connection to Oracle\n    oracle.net.CONNECT_TIMEOUT:  ${ORACLE_NET_CONNECT_TIMEOUT:10000}       # 10 seconds\n\n    # Database login timeout - max time to authenticate with Oracle\n    oracle.jdbc.loginTimeout: ${ORACLE_JDBC_LOGIN_TIMEOUT:10}           # 10 seconds\n\n    # Add query timeout to prevent long-running statements\n    oracle.jdbc.queryTimeout: ${ORACLE_JDBC_QUERY_TIMEOUT:40}      # 40 seconds for individual SQL statements\n    \n    # Prevent network drops\n    oracle.net.keepAlive: ${ORACLE_NET_KEEPALIVE:true}\n\n    # Set custom identifiers in Oracle v$session to distinguish HikariCP connections from other sources\n    oracle.jdbc.v$session.program: &quot;HIKARI-POOL&quot;\n    oracle.jdbc.v$session.osuser: &quot;HIKARI&quot;\n</code></pre>\n",
    "tags" : [ "java", "spring-boot", "hikaricp", "oracle19c" ],
    "owner" : {
      "account_id" : 1028612,
      "reputation" : 1719,
      "user_id" : 1037363,
      "user_type" : "registered",
      "accept_rate" : 20,
      "profile_image" : "https://i.sstatic.net/3mTAR.jpg?s=256",
      "display_name" : "Prasobh.Kollattu",
      "link" : "https://stackoverflow.com/users/1037363/prasobh-kollattu"
    },
    "is_answered" : false,
    "view_count" : 111,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1758803514,
    "creation_date" : 1758725046,
    "link" : "https://stackoverflow.com/questions/79773877/spring-boot-3-4-app-not-respecting-hikari-max-conn-pool-limit",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79774819,
    "question_id" : 79773877,
    "body" : "<p>After downgrading ojdbc11.version to 21.11.0.0 resolved the issue. seems latest version have conn leakage.</p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 1028612,
      "reputation" : 1719,
      "user_id" : 1037363,
      "user_type" : "registered",
      "accept_rate" : 20,
      "profile_image" : "https://i.sstatic.net/3mTAR.jpg?s=256",
      "display_name" : "Prasobh.Kollattu",
      "link" : "https://stackoverflow.com/users/1037363/prasobh-kollattu"
    },
    "creation_date" : 1758803514,
    "last_activity_date" : 1758803514,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140757249,
    "post_id" : 79773877,
    "body" : "its correct, i only posted haikai part. We dont have any custom config.",
    "score" : 0,
    "owner" : {
      "account_id" : 1028612,
      "reputation" : 1719,
      "user_id" : 1037363,
      "user_type" : "registered",
      "accept_rate" : 20,
      "profile_image" : "https://i.sstatic.net/3mTAR.jpg?s=256",
      "display_name" : "Prasobh.Kollattu",
      "link" : "https://stackoverflow.com/users/1037363/prasobh-kollattu"
    },
    "creation_date" : 1758726142,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140757246,
    "post_id" : 79773877,
    "body" : "Why do you think <code>hikari</code> is a valid configuration property root in standard Spring Boot? The default data source configuration would be at <code>spring.datasource.hikari.*</code>, not just <code>hikari.*</code>. So either you&#39;re not showing the entire thing, or you need to show your custom configuration classes.",
    "score" : 0,
    "owner" : {
      "account_id" : 213468,
      "reputation" : 110282,
      "user_id" : 466862,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=256&d=identicon&r=PG",
      "display_name" : "Mark Rotteveel",
      "link" : "https://stackoverflow.com/users/466862/mark-rotteveel"
    },
    "creation_date" : 1758726055,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}