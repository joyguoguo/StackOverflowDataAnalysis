{
  "question" : {
    "question_id" : 79762732,
    "title" : "entrySet vs sequencedEntrySet",
    "body" : "<p>I want to know the difference between <code>entrySet</code> and <code>sequencedEntrySet</code> methods in <a href=\"https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/LinkedHashMap.html\" rel=\"nofollow noreferrer\"><code>LinkedHashMap</code></a> in Java 21+.</p>\n<p>I am not sure why we have <a href=\"https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/LinkedHashMap.html#sequencedEntrySet()\" rel=\"nofollow noreferrer\"><code>sequencedEntrySet</code></a> since <code>LinkedHashMap</code> guarantees the insertion order.</p>\n",
    "tags" : [ "java", "dictionary", "java-21", "entryset" ],
    "owner" : {
      "account_id" : 20473350,
      "reputation" : 53,
      "user_id" : 22032491,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/fzzFCqK6.png?s=256",
      "display_name" : "Second Hand",
      "link" : "https://stackoverflow.com/users/22032491/second-hand"
    },
    "is_answered" : true,
    "view_count" : 130,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1757704398,
    "creation_date" : 1757667995,
    "link" : "https://stackoverflow.com/questions/79762732/entryset-vs-sequencedentryset",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79762748,
    "question_id" : 79762732,
    "body" : "<p>The difference is in the type. <code>entrySet</code> and <code>keySet</code> return <code>Set</code>, whereas <code>sequencedEntrySet</code> and <code>sequencedKeySet</code> return <a href=\"https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/SequencedSet.html\" rel=\"nofollow noreferrer\"><code>SequencedSet</code></a>. That interface extends <code>Set</code> but adds method <a href=\"https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/SequencedSet.html#reversed()\" rel=\"nofollow noreferrer\"><code>reversed</code></a>.</p>\n<p>If you're thinking &quot;but why didn't Oracle just change the return type of <code>entrySet</code> and <code>keySet</code> from <code>Set</code> to <code>SequencedSet</code>&quot;, the answer is <strong>binary compatibility</strong>. With source compatibility it would be allowed, because it would be an example of covariant return type. Any existing code would compile. But with binary compatibility, the return type is part of the signature. If the return type had been changed, then any pre-compiled library or application that used the method would break with a <code>NoSuchMethodError</code>.</p>\n",
    "score" : 6,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 1211967,
      "reputation" : 9964,
      "user_id" : 1180351,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/pKB8y.png?s=256",
      "display_name" : "Rob Spoor",
      "link" : "https://stackoverflow.com/users/1180351/rob-spoor"
    },
    "creation_date" : 1757668688,
    "last_activity_date" : 1757692745,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140732424,
    "post_id" : 79762732,
    "body" : "simple answer: <code>LinkedHashMap</code> implements both <code>Map</code> and <code>SequencedMap</code> - the first  <i>requires</i> <code>entrySet()</code>, the second <code>sequencedEntrySet()</code> - so both must be <i>provided</i> -- btw, the <a href=\"https://stackoverflow.com/questions/tagged/maps\">maps</a> tag states: &quot;<i>A map is a visual representation of an area ... <b>For the key-value data structure, use dictionary tag instead.</i></b>&quot; (emphasis mine)",
    "score" : 2,
    "owner" : {
      "account_id" : 31180,
      "reputation" : 29752,
      "user_id" : 85421,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/kKvXH.gif?s=256",
      "display_name" : "user85421",
      "link" : "https://stackoverflow.com/users/85421/user85421"
    },
    "creation_date" : 1757702749,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140731377,
    "post_id" : 79762732,
    "body" : "Suppose that some time in the future someone edits the code and changes <code>LinkedHashMap</code> to just <code>HashMap</code> then <code>entrySet</code> will still compile but <code>sequencedEntrySet</code> won&#39;t so if you use that they will see that you need a defined order.",
    "score" : 2,
    "owner" : {
      "account_id" : 3159259,
      "reputation" : 111562,
      "user_id" : 2670892,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/4iPV5.png?s=256",
      "display_name" : "greg-449",
      "link" : "https://stackoverflow.com/users/2670892/greg-449"
    },
    "creation_date" : 1757673970,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79762748" : [ {
      "comment_id" : 140736270,
      "post_id" : 79762748,
      "body" : "It would also work when explicitly using <code>LinkedHashMap</code>; the bridge method would be inserted in that specific class.",
      "score" : 2,
      "owner" : {
        "account_id" : 3211603,
        "reputation" : 301001,
        "user_id" : 2711488,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/t2hoD.jpg?s=256",
        "display_name" : "Holger",
        "link" : "https://stackoverflow.com/users/2711488/holger"
      },
      "creation_date" : 1757925171,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140736266,
      "post_id" : 79762748,
      "body" : "An example of late introduction of a covariant return type, is <a href=\"https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/nio/ByteBuffer.html#position(int)\" rel=\"nofollow noreferrer\"><code>ByteBuffer.position(int)</code></a> which was changed in Java 9 to return <code>ByteBuffer</code> instead of <code>Buffer</code>. It works, because the compiler inserts a bridge method to override the inherited method of <code>Buffer</code> <i>and</i> there are no subclasses outside the JDK. The latter precondition is what makes the difference to <code>LinkedHashMap</code>.",
      "score" : 2,
      "owner" : {
        "account_id" : 3211603,
        "reputation" : 301001,
        "user_id" : 2711488,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/t2hoD.jpg?s=256",
        "display_name" : "Holger",
        "link" : "https://stackoverflow.com/users/2711488/holger"
      },
      "creation_date" : 1757925096,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140736263,
      "post_id" : 79762748,
      "body" : "@Holger It would have worked if the caller used <code>Map</code> as declared type, but not if they explicitly used <code>LinkedHashMap</code>. And you&#39;re absolutely right about sub classes, I completely forgot about those.",
      "score" : 0,
      "owner" : {
        "account_id" : 1211967,
        "reputation" : 9964,
        "user_id" : 1180351,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/pKB8y.png?s=256",
        "display_name" : "Rob Spoor",
        "link" : "https://stackoverflow.com/users/1180351/rob-spoor"
      },
      "creation_date" : 1757925036,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140736250,
      "post_id" : 79762748,
      "body" : "Actually, changing the return type of <code>entrySet()</code> in <code>LinkedHashMap</code> would have worked for callers, because the compiler would insert a bridge method to conform to the <code>Map</code> interface, which still declares the method with the <code>Set</code> return type. The problems start with existing <i>subclasses</i> of <code>LinkedHashMap</code>, because those classes would override the <code>Set&lt;Map.Entry&lt;K,V&gt;&gt; entrySet()</code> method but not the hypothetical <code>SequencedSet&lt;Map.Entry&lt;K,V&gt;&gt; entrySet()</code> method.",
      "score" : 2,
      "owner" : {
        "account_id" : 3211603,
        "reputation" : 301001,
        "user_id" : 2711488,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/t2hoD.jpg?s=256",
        "display_name" : "Holger",
        "link" : "https://stackoverflow.com/users/2711488/holger"
      },
      "creation_date" : 1757924748,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140732682,
      "post_id" : 79762748,
      "body" : "<b>Binary compatibility</b> refers to the ability of precompiled Java code to run correctly without recompilation, even if the underlying library or API it depends on has changed, as long as the changes preserve the binary-level contract.",
      "score" : 0,
      "owner" : {
        "account_id" : 2179728,
        "reputation" : 81081,
        "user_id" : 10819573,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/MWKel.jpg?s=256",
        "display_name" : "Arvind Kumar Avinash",
        "link" : "https://stackoverflow.com/users/10819573/arvind-kumar-avinash"
      },
      "creation_date" : 1757712466,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}