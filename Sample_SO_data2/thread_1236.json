{
  "question" : {
    "question_id" : 79732762,
    "title" : "Send email only for a specific exception (ConfigException)",
    "body" : "<p>I want Log4j2 to send an email <strong>only</strong> when a <code>ConfigException</code> is logged. All other exceptions should be ignored by the email appender.</p>\n<p>Here is a minimal example:</p>\n<p><code>log4j2.xml</code></p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;Configuration&gt;\n    &lt;Appenders&gt;\n        &lt;Console name=&quot;console&quot; target=&quot;SYSTEM_OUT&quot;&gt;\n            &lt;PatternLayout pattern=&quot;[%-5level] %d{yyyy-MM-dd HH:mm:ss} %c{1} - %msg%n&quot;/&gt;\n        &lt;/Console&gt;\n\n        &lt;SMTP name=&quot;EmailAppender&quot; bufferSize=&quot;1&quot; smtpProtocol=&quot;smtp&quot;&gt;\n            &lt;HtmlLayout title=&quot;Log Alert&quot; locationInfo=&quot;true&quot;&gt;\n                &lt;Pattern&gt;%d{yyyy-MM-dd HH:mm:ss} %-5level %logger - %msg%n%throwable&lt;/Pattern&gt;\n            &lt;/HtmlLayout&gt;\n            &lt;Filters&gt;\n                &lt;!-- Only log ERROR+ --&gt;\n                &lt;ThresholdFilter level=&quot;ERROR&quot; onMatch=&quot;NEUTRAL&quot; onMismatch=&quot;DENY&quot;/&gt;\n                &lt;!-- Attempt to match ConfigException --&gt;\n                &lt;RegexFilter regex=&quot;(?i).*ConfigException.*&quot; onMatch=&quot;ACCEPT&quot; onMismatch=&quot;DENY&quot;/&gt;\n            &lt;/Filters&gt;\n        &lt;/SMTP&gt;\n    &lt;/Appenders&gt;\n\n    &lt;Loggers&gt;\n        &lt;Root level=&quot;debug&quot;&gt;\n            &lt;AppenderRef ref=&quot;console&quot;/&gt;\n            &lt;AppenderRef ref=&quot;EmailAppender&quot;/&gt;\n        &lt;/Root&gt;\n    &lt;/Loggers&gt;\n&lt;/Configuration&gt;\n</code></pre>\n<p>Java code:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class ConfigException extends Exception {\n    public ConfigException(String message) {\n        super(message);\n    }\n    public ConfigException(String message, Throwable cause) {\n        super(message, cause);\n    }\n}\n</code></pre>\n<pre class=\"lang-java prettyprint-override\"><code>private final org.apache.logging.log4j.Logger log4jLogger =\n    org.apache.logging.log4j.LogManager.getLogger(getClass());\n\npublic void severe(String message, Throwable throwable) {\n    log4jLogger.error(message, throwable);\n}\n</code></pre>\n<pre class=\"lang-java prettyprint-override\"><code>try {\n    throw new ConfigException(&quot;Config failed&quot;);\n} catch (ConfigException cEx) {\n    severe(&quot;Hihi; &quot; + cEx.getMessage(), cEx);\n}\n\ntry {\n    throw new RuntimeException(&quot;Some other error&quot;);\n} catch (RuntimeException ex) {\n    severe(&quot;Oops; &quot; + ex.getMessage(), ex);\n}\n</code></pre>\n<p>What happens now:</p>\n<ul>\n<li>The email is sent for <strong>both</strong> exceptions.</li>\n<li>I only want the email to be sent for <code>ConfigException</code>.</li>\n</ul>\n<p>How can I configure Log4j2's SMTP appender so that it sends an email only when the logged exception is an instance of <code>ConfigException</code>?</p>\n",
    "tags" : [ "java", "logging", "log4j2", "splunk" ],
    "owner" : {
      "account_id" : 5453081,
      "reputation" : 193,
      "user_id" : 4337327,
      "user_type" : "registered",
      "accept_rate" : 100,
      "profile_image" : "https://www.gravatar.com/avatar/60bf49f8863496bba16620f51b8b9eac?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "tamaramaria",
      "link" : "https://stackoverflow.com/users/4337327/tamaramaria"
    },
    "is_answered" : false,
    "view_count" : 112,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1755590010,
    "creation_date" : 1754979332,
    "link" : "https://stackoverflow.com/questions/79732762/send-email-only-for-a-specific-exception-configexception",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140676176,
    "post_id" : 79732762,
    "body" : "Try <code>&lt;RegexFilter regex=&quot;(?i).*Config failed.*&quot; onMatch=&quot;ACCEPT&quot; onMismatch=&quot;DENY&quot;&#47;&gt;</code> instead. Incidentally, using <code>SMTPAppender</code> in log4j will force use of superseded email APIs. You&#39;d be better off with logback, which correctly uses jakarta mail",
    "score" : 0,
    "owner" : {
      "account_id" : 22124137,
      "reputation" : 4244,
      "user_id" : 16376827,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/1ImPw.png?s=256",
      "display_name" : "g00se",
      "link" : "https://stackoverflow.com/users/16376827/g00se"
    },
    "creation_date" : 1755605290,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}