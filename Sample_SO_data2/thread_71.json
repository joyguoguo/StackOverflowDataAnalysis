{
  "question" : {
    "question_id" : 79831450,
    "title" : "Hugging Face /hf-inference/v1/chat/completions returns 422 in Eclipse plugin",
    "body" : "<p>I'm building an Eclipse plugin for code completion using the Hugging Face API. My plugin sends a prompt to the endpoint:</p>\n<pre><code>https://router.huggingface.co/hf-inference/v1/chat/completions\n</code></pre>\n<p>I replaced the old endpoint (<code>https://api-inference.huggingface.co</code>) as recommended.<br />\nHere’s my Java request code:</p>\n<pre><code>String json = &quot;{&quot;\n        + &quot;\\&quot;inputs\\&quot;: \\&quot;&quot; + safePrompt + &quot;\\&quot;&quot;\n        + &quot;}&quot;;\n\nRequestBody body = RequestBody.create(json, MediaType.parse(&quot;application/json&quot;));\nRequest request = new Request.Builder()\n        .url(&quot;https://router.huggingface.co/hf-inference/v1/chat/completions&quot;)\n        .addHeader(&quot;Authorization&quot;, &quot;Bearer &quot; + hfToken)\n        .post(body)\n        .build();\n\ntry (Response response = client.newCall(request).execute()) {\n    System.out.println(response.code());\n    System.out.println(response.body().string());\n}\n</code></pre>\n<p>When I run this, I always get:</p>\n<pre><code>Response code: 422\nRaw body length: 24\n</code></pre>\n<p>Can someone suggest a free Hugging Face model that works for code completion in Java/Eclipse?</p>\n<h4>EDIT</h4>\n<p>(Copied from OP's <a href=\"https://stackoverflow.com/questions/79831450/hugging-face-hf-inference-v1-chat-completions-returns-422-in-eclipse-plugin#comment140877046_79831450\">comment</a>.)<br />\nThe model I am using:</p>\n<pre class=\"lang-json prettyprint-override\"><code>{\n    &quot;model&quot;: &quot;darkc0de/XortronCriminalComputingConfig&quot;,\n    &quot;messages&quot;: [\n        {\n            &quot;role&quot;: &quot;user&quot;,\n            &quot;content&quot;: &quot;safePrompt&quot;\n        }\n    ],\n    &quot;stream&quot;: false\n}\n</code></pre>\n",
    "tags" : [ "java", "eclipse", "huggingface-transformers", "code-completion" ],
    "owner" : {
      "account_id" : 44790492,
      "reputation" : 1,
      "user_id" : 31937198,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/4af97202229854b28b20c9d15eda3dc3?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "kiruba T",
      "link" : "https://stackoverflow.com/users/31937198/kiruba-t"
    },
    "is_answered" : false,
    "view_count" : 44,
    "closed_date" : 1764515947,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1764316481,
    "creation_date" : 1764228404,
    "link" : "https://stackoverflow.com/questions/79831450/hugging-face-hf-inference-v1-chat-completions-returns-422-in-eclipse-plugin",
    "closed_reason" : "Not suitable for this site"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140880299,
    "post_id" : 79831450,
    "body" : "Please <a href=\"https://stackoverflow.com/posts/79831450/edit\">edit</a> your question with the updated Java code. Maybe you need also add <code>.addHeader(&quot;Content-Type&quot;, &quot;application&#47;json&quot;)</code> to your code.",
    "score" : 0,
    "owner" : {
      "account_id" : 8692823,
      "reputation" : 34995,
      "user_id" : 6505250,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/FgNJn.jpg?s=256",
      "display_name" : "howlger",
      "link" : "https://stackoverflow.com/users/6505250/howlger"
    },
    "creation_date" : 1764522221,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140878974,
    "post_id" : 79831450,
    "body" : "Hi, thanks for asking! I set the model directly in the JSON payload I send in my POST request. Here’s the snippet I’m using in Java:  // JSON payload for chat model String json = &quot;{&quot; +     &quot;\\&quot;model\\&quot;: \\&quot;darkc0de/XortronCriminalComputingConfig\\&quot;,&quot; +     &quot;\\&quot;messages\\&quot;: [{&quot; +         &quot;\\&quot;role\\&quot;:\\&quot;user\\&quot;, &quot; +         &quot;\\&quot;content\\&quot;: \\&quot;&quot; + safePrompt + &quot;\\&quot;&quot; +     &quot;}],&quot; +     &quot;\\&quot;stream\\&quot;: false&quot; + &quot;}&quot;;   This JSON is sent to the endpoint <a href=\"https://router.huggingface.co/hf-inference/v1/chat/completions\" rel=\"nofollow noreferrer\">router.huggingface.co/hf-inference/v1/chat/completions</a>, so the &quot;model&quot; field specifies which model to use.",
    "score" : 0,
    "owner" : {
      "account_id" : 44790492,
      "reputation" : 1,
      "user_id" : 31937198,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/4af97202229854b28b20c9d15eda3dc3?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "kiruba T",
      "link" : "https://stackoverflow.com/users/31937198/kiruba-t"
    },
    "creation_date" : 1764424518,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140877232,
    "post_id" : 79831450,
    "body" : "Where do you set the model (<code>&quot;model&quot;: &quot;darkc0de&#47;XortronCriminalComputingConfig&quot;</code>) in your Java code?",
    "score" : 0,
    "owner" : {
      "account_id" : 8692823,
      "reputation" : 34995,
      "user_id" : 6505250,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/FgNJn.jpg?s=256",
      "display_name" : "howlger",
      "link" : "https://stackoverflow.com/users/6505250/howlger"
    },
    "creation_date" : 1764323043,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140877046,
    "post_id" : 79831450,
    "body" : "the curl worked and the model i am using is  // JSON payload for chat model             String json = &quot;{&quot;                     + &quot;\\&quot;model\\&quot;: \\&quot;darkc0de/XortronCriminalComputingConfig\\&quot;,&quot;                     + &quot;\\&quot;messages\\&quot;: [{\\&quot;role\\&quot;:\\&quot;user\\&quot;, \\&quot;content\\&quot;: \\&quot;&quot; + safePrompt + &quot;\\&quot;}],&quot;                     + &quot;\\&quot;stream\\&quot;: false&quot;                     + &quot;}&quot;;",
    "score" : 0,
    "owner" : {
      "account_id" : 44790492,
      "reputation" : 1,
      "user_id" : 31937198,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/4af97202229854b28b20c9d15eda3dc3?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "kiruba T",
      "link" : "https://stackoverflow.com/users/31937198/kiruba-t"
    },
    "creation_date" : 1764315021,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140875979,
    "post_id" : 79831450,
    "body" : "<a href=\"https://huggingface.co/docs/inference-providers/index\" rel=\"nofollow noreferrer\">Does the curl example work for you?</a>",
    "score" : 0,
    "owner" : {
      "account_id" : 8692823,
      "reputation" : 34995,
      "user_id" : 6505250,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/FgNJn.jpg?s=256",
      "display_name" : "howlger",
      "link" : "https://stackoverflow.com/users/6505250/howlger"
    },
    "creation_date" : 1764241052,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140875969,
    "post_id" : 79831450,
    "body" : "Your request is missing which model. <a href=\"https://huggingface.co/docs/inference-providers/index\" rel=\"nofollow noreferrer\">See here</a>.",
    "score" : 0,
    "owner" : {
      "account_id" : 8692823,
      "reputation" : 34995,
      "user_id" : 6505250,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/FgNJn.jpg?s=256",
      "display_name" : "howlger",
      "link" : "https://stackoverflow.com/users/6505250/howlger"
    },
    "creation_date" : 1764240652,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140875653,
    "post_id" : 79831450,
    "body" : "<i>Can someone suggest a free Hugging Face model</i> Asking for recommendations is <a href=\"https://stackoverflow.com/help/on-topic\">off-topic</a>.",
    "score" : 1,
    "owner" : {
      "account_id" : 2485939,
      "reputation" : 20969,
      "user_id" : 2164365,
      "user_type" : "registered",
      "accept_rate" : 40,
      "profile_image" : "https://i.sstatic.net/RKSgV.png?s=256",
      "display_name" : "Abra",
      "link" : "https://stackoverflow.com/users/2164365/abra"
    },
    "creation_date" : 1764229121,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}