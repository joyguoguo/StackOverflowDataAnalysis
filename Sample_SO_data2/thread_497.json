{
  "question" : {
    "question_id" : 79793897,
    "title" : "GraalVM native-image localized data/time data",
    "body" : "<p>Given this sample:</p>\n<pre class=\"lang-java prettyprint-override\"><code>final var ARABIC_GREGORIAN_DATE_FORMATTER = DateTimeFormatter.ofPattern(&quot;EEEE dd\\\\MM\\\\yyyy G&quot;).localizedBy(Locale.forLanguageTag(&quot;ar&quot;));\nfinal var ENGLISH_GREGORIAN_DATE_FORMATTER = DateTimeFormatter.ofPattern(&quot;EEEE dd/MM/yyyy G&quot;).localizedBy(Locale.ENGLISH);\n\nvar now = Instant.now();\nString arabicGregorianDate = ARABIC_GREGORIAN_DATE_FORMATTER.format(now.atZone(ZoneId.systemDefault()));\nString englishGregorianDate = ENGLISH_GREGORIAN_DATE_FORMATTER.format(now.atZone(ZoneId.systemDefault()));\n\nLog.info(&quot;arabicGregorianDate = &quot; + arabicGregorianDate);\nLog.info(&quot;englishGregorianDate = &quot; + englishGregorianDate);\n</code></pre>\n<p>When running in JVM mode, I get this output:</p>\n<pre><code>arabicGregorianDate = السبت 18\\10\\2025 م\nenglishGregorianDate = Saturday 18/10/2025 AD\n</code></pre>\n<p>However, when I compile it to GraalVM native-image and run it, I get this output:</p>\n<pre><code>arabicGregorianDate = Sat 18\\10\\2025 CE\nenglishGregorianDate = Saturday 18/10/2025 AD\n</code></pre>\n<p>Notice that Arabic word for Saturday <code>السبت</code> is fallbacked to <code>Sat</code> and <code>م</code> to <code>CE</code>?</p>\n<p>I am assuming some data (CLDR?) is missing from the native-image and needs some configurations to include those data. How to do that? Tried the GraalVM tracing agent but that did not fix the issue.</p>\n<p>I am using <code>-H:IncludeLocales=ar,en</code> as well.</p>\n<p>Reproducer: <a href=\"https://github.com/Eng-Fouad/graal-native-date-locale\" rel=\"nofollow noreferrer\">https://github.com/Eng-Fouad/graal-native-date-locale</a></p>\n<hr />\n<h3>Edit:</h3>\n<p>I found the required localization resources inside the module <code>jdk.localedata</code>, specifically at <code>sun.text.resources.cldr.ext.FormatData_ar</code>.\nHowever, I tried to add it to <code>reachability-metadata.json</code> but that didn't work.</p>\n<hr />\n<h3>Edit 2:</h3>\n<p>I added the option <code>-H:+TraceLocalizationFeature</code> and I noticed the resource bundle <code>sun.text.resources.cldr.FormatData</code> with locale <code>ar</code> is included in native image (but does not work):</p>\n<pre><code>Adding bundle sun.util.resources.cldr.CalendarData, locale  with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.util.resources.cldr.CurrencyNames, locale  with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.util.resources.cldr.LocaleNames, locale  with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.util.resources.cldr.TimeZoneNames, locale  with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.text.resources.cldr.FormatData, locale  with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.text.resources.cldr.FormatData, locale  with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.util.resources.cldr.CalendarData, locale ar with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.util.resources.cldr.CurrencyNames, locale ar with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.util.resources.cldr.LocaleNames, locale ar with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.util.resources.cldr.TimeZoneNames, locale ar with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.text.resources.cldr.FormatData, locale ar with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.text.resources.cldr.FormatData, locale ar with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.util.resources.cldr.CalendarData, locale en_US with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.util.resources.cldr.CurrencyNames, locale en_US with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.util.resources.cldr.LocaleNames, locale en_US with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.util.resources.cldr.TimeZoneNames, locale en_US with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.text.resources.cldr.FormatData, locale en_US with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.text.resources.cldr.FormatData, locale en_US with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.util.resources.cldr.CalendarData, locale en with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.util.resources.cldr.CurrencyNames, locale en with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.util.resources.cldr.LocaleNames, locale en with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.util.resources.cldr.TimeZoneNames, locale en with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.text.resources.cldr.FormatData, locale en with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.text.resources.cldr.FormatData, locale en with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.util.resources.CalendarData, locale  with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.util.resources.CurrencyNames, locale  with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.util.resources.LocaleNames, locale  with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.util.resources.TimeZoneNames, locale  with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.text.resources.BreakIteratorInfo, locale  with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.text.resources.BreakIteratorResources, locale  with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.text.resources.CollationData, locale  with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.text.resources.FormatData, locale  with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.text.resources.FormatData, locale  with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.util.resources.CalendarData, locale ar with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.util.resources.CurrencyNames, locale ar with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.util.resources.LocaleNames, locale ar with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.util.resources.TimeZoneNames, locale ar with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.text.resources.BreakIteratorInfo, locale ar with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.text.resources.BreakIteratorResources, locale ar with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.text.resources.CollationData, locale ar with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.text.resources.FormatData, locale ar with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.text.resources.FormatData, locale ar with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.util.resources.CalendarData, locale en_US with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.util.resources.CurrencyNames, locale en_US with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.util.resources.LocaleNames, locale en_US with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.util.resources.TimeZoneNames, locale en_US with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.text.resources.BreakIteratorInfo, locale en_US with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.text.resources.BreakIteratorResources, locale en_US with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.text.resources.CollationData, locale en_US with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.text.resources.FormatData, locale en_US with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.text.resources.FormatData, locale en_US with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.util.resources.CalendarData, locale en with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.util.resources.CurrencyNames, locale en with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.util.resources.LocaleNames, locale en with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.util.resources.TimeZoneNames, locale en with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.text.resources.BreakIteratorInfo, locale en with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.text.resources.BreakIteratorResources, locale en with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.text.resources.CollationData, locale en with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.text.resources.FormatData, locale en with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.text.resources.FormatData, locale en with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.util.logging.resources.logging, locale  with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.util.logging.resources.logging, locale ar with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.util.logging.resources.logging, locale en_US with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\nAdding bundle sun.util.logging.resources.logging, locale en with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)\n</code></pre>\n<p>Not sure why <code>FormatData</code> is listed twice with each locale. Also not sure what <code>with condition ConfigurationCondition(type=class java.lang.Object, runtimeChecked=true)</code> is.</p>\n",
    "tags" : [ "java", "datetime", "quarkus", "graalvm", "graalvm-native-image" ],
    "owner" : {
      "account_id" : 294022,
      "reputation" : 118190,
      "user_id" : 597657,
      "user_type" : "registered",
      "accept_rate" : 99,
      "profile_image" : "https://i.sstatic.net/0h5ec.jpg?s=256",
      "display_name" : "Eng.Fouad",
      "link" : "https://stackoverflow.com/users/597657/eng-fouad"
    },
    "is_answered" : true,
    "view_count" : 140,
    "answer_count" : 1,
    "score" : 3,
    "last_activity_date" : 1760945746,
    "creation_date" : 1760809904,
    "link" : "https://stackoverflow.com/questions/79793897/graalvm-native-image-localized-data-time-data",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79794693,
    "question_id" : 79793897,
    "body" : "<p>The reproducer is using Quarkus. In Quarkus supported locales need to be defined through <a href=\"https://quarkus.io/guides/all-config#quarkus-core_quarkus-locales\" rel=\"nofollow noreferrer\">https://quarkus.io/guides/all-config#quarkus-core_quarkus-locales</a></p>\n<p>Building with <code>./gradlew clean quarkusBuild -Dquarkus.locales=en,ar</code> results in the following output for native and JVM runs respectively:</p>\n<pre><code>❯ ./build/graal-native-date-locale-1.0.0-runner \n__  ____  __  _____   ___  __ ____  ______ \n --/ __ \\/ / / / _ | / _ \\/ //_/ / / / __/ \n -/ /_/ / /_/ / __ |/ , _/ ,&lt; / /_/ /\\ \\   \n--\\___\\_\\____/_/ |_/_/|_/_/|_|\\____/___/   \n2025-10-20 10:32:21,286 INFO  [io.quarkus] (main) graal-native-date-locale 1.0.0 native (powered by Quarkus 3.28.3) started in 0.004s. \n2025-10-20 10:32:21,286 INFO  [io.quarkus] (main) Profile prod activated. \n2025-10-20 10:32:21,286 INFO  [io.quarkus] (main) Installed features: [cdi, picocli]\n2025-10-20 10:32:21,288 INFO  [io.fou.qua.i18.dem.LocalizedDateDemoCli] (main) arabicGregorianDate = الاثنين ٢٠\\١٠\\٢٠٢٥ م\n2025-10-20 10:32:21,288 INFO  [io.fou.qua.i18.dem.LocalizedDateDemoCli] (main) englishGregorianDate = Monday 20/10/2025 AD\n2025-10-20 10:32:21,288 INFO  [io.quarkus] (main) graal-native-date-locale stopped in 0.000s\n\n❯ java -jar ./build/graal-native-date-locale-1.0.0-native-image-source-jar/graal-native-date-locale-1.0.0-runner.jar\n__  ____  __  _____   ___  __ ____  ______ \n --/ __ \\/ / / / _ | / _ \\/ //_/ / / / __/ \n -/ /_/ / /_/ / __ |/ , _/ ,&lt; / /_/ /\\ \\   \n--\\___\\_\\____/_/ |_/_/|_/_/|_|\\____/___/   \n2025-10-20 10:32:25,923 INFO  [io.quarkus] (main) graal-native-date-locale 1.0.0 on JVM (powered by Quarkus 3.28.3) started in 0.159s. \n2025-10-20 10:32:25,927 INFO  [io.quarkus] (main) Profile prod activated. \n2025-10-20 10:32:25,928 INFO  [io.quarkus] (main) Installed features: [cdi, picocli]\n2025-10-20 10:32:25,972 INFO  [io.fou.qua.i18.dem.LocalizedDateDemoCli] (main) arabicGregorianDate = الاثنين ٢٠\\١٠\\٢٠٢٥ م\n2025-10-20 10:32:25,973 INFO  [io.fou.qua.i18.dem.LocalizedDateDemoCli] (main) englishGregorianDate = Monday 20/10/2025 AD\n2025-10-20 10:32:25,979 INFO  [io.quarkus] (main) graal-native-date-locale stopped in 0.006s\n</code></pre>\n<p>Note that I am not able to get in JVM mode <code>arabicGregorianDate = السبت 18\\10\\2025 م</code> using the reproducer.</p>\n",
    "score" : 3,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 1133977,
      "reputation" : 2090,
      "user_id" : 1119431,
      "user_type" : "registered",
      "accept_rate" : 80,
      "profile_image" : "https://www.gravatar.com/avatar/8df28305c3e61591f9c985aab4b0dc8c?s=256&d=identicon&r=PG",
      "display_name" : "zakkak",
      "link" : "https://stackoverflow.com/users/1119431/zakkak"
    },
    "creation_date" : 1760945746,
    "last_activity_date" : 1760945746,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140804501,
    "post_id" : 79793897,
    "body" : "It could be a bug. Submitted a bug report to GraalVM repo: <a href=\"https://github.com/oracle/graal/issues/12394\" rel=\"nofollow noreferrer\">github.com/oracle/graal/issues/12394</a>",
    "score" : 1,
    "owner" : {
      "account_id" : 294022,
      "reputation" : 118190,
      "user_id" : 597657,
      "user_type" : "registered",
      "accept_rate" : 99,
      "profile_image" : "https://i.sstatic.net/0h5ec.jpg?s=256",
      "display_name" : "Eng.Fouad",
      "link" : "https://stackoverflow.com/users/597657/eng-fouad"
    },
    "creation_date" : 1760849091,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140804470,
    "post_id" : 79793897,
    "body" : "@Slaw Unfortunately, that did not help.",
    "score" : 2,
    "owner" : {
      "account_id" : 294022,
      "reputation" : 118190,
      "user_id" : 597657,
      "user_type" : "registered",
      "accept_rate" : 99,
      "profile_image" : "https://i.sstatic.net/0h5ec.jpg?s=256",
      "display_name" : "Eng.Fouad",
      "link" : "https://stackoverflow.com/users/597657/eng-fouad"
    },
    "creation_date" : 1760844137,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140804434,
    "post_id" : 79793897,
    "body" : "Does adding the entire module (<code>--add-modules jdk.localedata</code>) help at all?",
    "score" : 0,
    "owner" : {
      "account_id" : 8532578,
      "reputation" : 49884,
      "user_id" : 6395627,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/af0f9bfe593f36642a032cd7ea611e7d?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Slaw",
      "link" : "https://stackoverflow.com/users/6395627/slaw"
    },
    "creation_date" : 1760840850,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140804033,
    "post_id" : 79793897,
    "body" : "As an aside you might want to use <code>DateTimeFormatter.ofLocalizedDate()</code>?",
    "score" : 0,
    "owner" : {
      "account_id" : 7612423,
      "reputation" : 87400,
      "user_id" : 5772882,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/8283c64511fa80afed5259d10850168f?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Anonymous",
      "link" : "https://stackoverflow.com/users/5772882/anonymous"
    },
    "creation_date" : 1760811159,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79794693" : [ {
      "comment_id" : 140805879,
      "post_id" : 79794693,
      "body" : "@Eng.Fouad If you enable verbose logging in gradle you should be able to observe the flags passed to <code>native-image</code>. Furthermore you can inspect the <code>*-config.json</code> files generated by Quarkus in <code>build&#47;graal-native-date-locale-1.0.0-native-image-source-jar&zwnj;&#8203;&#47;graal-native-date-l&zwnj;&#8203;ocale-1.0.0-runner.j&zwnj;&#8203;ar</code>",
      "score" : 3,
      "owner" : {
        "account_id" : 1133977,
        "reputation" : 2090,
        "user_id" : 1119431,
        "user_type" : "registered",
        "accept_rate" : 80,
        "profile_image" : "https://www.gravatar.com/avatar/8df28305c3e61591f9c985aab4b0dc8c?s=256&d=identicon&r=PG",
        "display_name" : "zakkak",
        "link" : "https://stackoverflow.com/users/1119431/zakkak"
      },
      "creation_date" : 1760947861,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140805827,
      "post_id" : 79794693,
      "body" : "Thanks a lot for your answer. Indeed that solved it for me. I am assuming <code>-H:IncludeLocales=ar,en</code> is overwritten by <code>quarkus.locales</code>.",
      "score" : 0,
      "owner" : {
        "account_id" : 294022,
        "reputation" : 118190,
        "user_id" : 597657,
        "user_type" : "registered",
        "accept_rate" : 99,
        "profile_image" : "https://i.sstatic.net/0h5ec.jpg?s=256",
        "display_name" : "Eng.Fouad",
        "link" : "https://stackoverflow.com/users/597657/eng-fouad"
      },
      "creation_date" : 1760946416,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}