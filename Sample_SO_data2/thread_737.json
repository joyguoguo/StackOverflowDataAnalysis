{
  "question" : {
    "question_id" : 79780544,
    "title" : "Recycler view does not update until scrolled when using DiffUtil and submitList() with a reversed Array List",
    "body" : "<p>I have an array list of log entries, which consists of an a time and date with a description. I want the user to be able to reverse the direction from oldest to newest and back again.</p>\n<p>I am using Collections.reverse and that works fine, however when I call adapter.submitList() with the reversed list, the recycler does not update until i start scrolling, even then it is jumbled. If I call notifyDataSetChanged() afterwards, it works but that seems like it defeats the purpose of using DiffUtil.</p>\n<p>Additionally, I have run into an issue where after deleting all the logs, but then adding a new log (&quot;logs deleted&quot;) and calling submitList() again, the only entry is whatever was first in the list before I cleared everything, instead of what i added.</p>\n<p>I have the DiffUtil callback created when the ListAdapter is and I have areItemsTheSame and areContentsTheSame setup.</p>\n<p>All other situations work, adding, removing, updating, its primarily just the reversing that is not working.</p>\n<p>Here is a simple version of what I am seeing, in the real app I am using view models but the result is the same.</p>\n<pre><code>import android.os.Bundle;\nimport android.view.LayoutInflater;\nimport android.view.View;\nimport android.view.ViewGroup;\nimport android.widget.Button;\nimport android.widget.TextView;\n\nimport androidx.annotation.NonNull;\nimport androidx.appcompat.app.AppCompatActivity;\nimport androidx.core.graphics.Insets;\nimport androidx.core.view.ViewCompat;\nimport androidx.core.view.WindowInsetsCompat;\nimport androidx.recyclerview.widget.DiffUtil;\nimport androidx.recyclerview.widget.LinearLayoutManager;\nimport androidx.recyclerview.widget.ListAdapter;\nimport androidx.recyclerview.widget.RecyclerView;\n\nimport java.util.ArrayList;\nimport java.util.Calendar;\nimport java.util.Collections;\nimport java.util.TimeZone;\n\npublic class RV_Test extends AppCompatActivity {\n    private MyAdapter myAdapter;\n    private ArrayList&lt;LogEntry&gt; logsList = new ArrayList&lt;&gt;();\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_rv_test);\n        ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main), (v, insets) -&gt; {\n            Insets systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars());\n            v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom);\n            return insets;\n        });\n        RecyclerView recyclerView = findViewById(R.id.rv_test);\n        recyclerView.setLayoutManager(new LinearLayoutManager(this));\n        myAdapter = new MyAdapter();\n        recyclerView.setAdapter(myAdapter);\n        logsList = getLogs();\n        myAdapter.submitList(logsList);\n\n        Button btnReverse = findViewById(R.id.btn_reverse);\n        btnReverse.setOnClickListener(new View.OnClickListener() {\n            @Override\n            public void onClick(View v) {\n                reverseList();\n            }\n        });\n\n        Button btnNotify = findViewById(R.id.btn_notify);\n        btnNotify.setOnClickListener(new View.OnClickListener() {\n            @Override\n            public void onClick(View v) {\n                notifyChange();\n            }\n        });\n    }\n\n    private ArrayList&lt;LogEntry&gt; getLogs(){\n        ArrayList&lt;LogEntry&gt;logs = new ArrayList&lt;&gt;();\n        for (int i = 20; i &gt; 0; i--) {\n            Calendar calendar = Calendar.getInstance(TimeZone.getDefault());\n            calendar.add(Calendar.DAY_OF_MONTH, -i);\n            LogEntry logEntry = new LogEntry(calendar, &quot;message: &quot; + i , i);\n            logs.add(logEntry);\n        }\n        return logs;\n    }\n\n    private void reverseList(){\n        Collections.reverse(logsList);\n        myAdapter.submitList(logsList);\n    }\n\n    private void notifyChange(){\n        myAdapter.notifyDataSetChanged();\n    }\n\n\n    class LogEntry {\n        public final Calendar when;\n        public final String what;\n        public final int id;\n\n        public LogEntry(Calendar when, String what, int id) {\n            this.when = when;\n            this.what = what;\n            this.id = id;\n        }\n\n    }\n\n    public static class MyAdapter extends ListAdapter&lt;LogEntry,MyAdapter.MyViewHolder&gt;{\n        protected MyAdapter() {\n            super(new DiffUtil.ItemCallback&lt;&gt;() {\n                @Override\n                public boolean areItemsTheSame(@NonNull LogEntry oldItem, @NonNull LogEntry newItem) {\n                    return oldItem.id == newItem.id;\n                }\n\n                @Override\n                public boolean areContentsTheSame(@NonNull LogEntry oldItem, @NonNull LogEntry newItem) {\n                    return oldItem.what.equals(newItem.what) &amp;&amp; oldItem.when.equals(newItem.when);\n                }\n            });\n        }\n\n        @NonNull\n        @Override\n        public MyViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {\n            View view = LayoutInflater.from(parent.getContext()).inflate(R.layout.list_item, parent, false);\n            return new MyViewHolder(view);\n        }\n\n        @Override\n        public void onBindViewHolder(@NonNull MyViewHolder holder, int position) {\n            LogEntry logEntry = getItem(position);\n            holder.tvName.setText(logEntry.what);\n            holder.tvID.setText(String.valueOf(logEntry.id));\n        }\n\n        public static class MyViewHolder extends RecyclerView.ViewHolder{\n            TextView tvID;\n            TextView tvName;\n            TextView tvDate;\n            public MyViewHolder(@NonNull View itemView) {\n                super(itemView);\n                tvID = itemView.findViewById(R.id.tv_id);\n                tvName = itemView.findViewById(R.id.tv_name);\n                tvDate = itemView.findViewById(R.id.tv_date);\n            }\n        }\n    }\n}\n</code></pre>\n",
    "tags" : [ "java", "android", "android-recyclerview", "listadapter", "android-diffutils" ],
    "owner" : {
      "account_id" : 11799798,
      "reputation" : 572,
      "user_id" : 8633758,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/e14e86a668116b0882a3cd15144fba00?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Notsileous",
      "link" : "https://stackoverflow.com/users/8633758/notsileous"
    },
    "is_answered" : false,
    "view_count" : 429,
    "answer_count" : 0,
    "score" : 2,
    "last_activity_date" : 1759362546,
    "creation_date" : 1759362546,
    "link" : "https://stackoverflow.com/questions/79780544/recycler-view-does-not-update-until-scrolled-when-using-diffutil-and-submitlist",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140868855,
    "post_id" : 79780544,
    "body" : "I don&#39;t see your add/remove code here. But <code>ListAdapter</code> does not copy submitted list, so what you&#39;re experiencing is you <code>submitList</code> provides the same list that&#39;s already within the adapter so there&#39;s no diff to produce.",
    "score" : 0,
    "owner" : {
      "account_id" : 12721843,
      "reputation" : 17453,
      "user_id" : 9241978,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/5TQ64.png?s=256",
      "display_name" : "Pawel",
      "link" : "https://stackoverflow.com/users/9241978/pawel"
    },
    "creation_date" : 1763908195,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}