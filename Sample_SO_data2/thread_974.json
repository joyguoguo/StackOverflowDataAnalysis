{
  "question" : {
    "question_id" : 79758390,
    "title" : "Cannot read accountExpires attribute from Active Directory with Spring LDAP",
    "body" : "<p>I am using Spring Boot/Spring Data Ldap.</p>\n<p>When I query users I cannot read <code>accountExpires</code> attribute, even when the property is shown in <strong>GetADUser</strong>.</p>\n<p>I tried something like this:</p>\n<pre><code>return readTemplate().search(query()\n      .base(ou)\n      .attributes(new String[]{&quot;samaccountname&quot;, &quot;givenName&quot;, &quot;sn&quot;, &quot;mail&quot;, &quot;userAccountControl&quot;, &quot;accountExpires&quot;, &quot;memberof&quot;})\n      .where(&quot;objectClass&quot;).is(&quot;person&quot;), userExtractor);\n</code></pre>\n<p>I am sure the user has <code>accountExpires</code> property set, I tested with <code>accountExpires</code> and <code>accountexpires</code> (to check case-sensitivity), even I omitted <strong>attributes</strong> to read all attributes, but no chance, not all attributes are returned (well <code>accountExpires</code> is one of the missing ones).</p>\n<p>How can I read that attribute?</p>\n",
    "tags" : [ "java", "spring-boot", "active-directory", "spring-ldap", "spring-data-ldap" ],
    "owner" : {
      "account_id" : 353069,
      "reputation" : 7362,
      "user_id" : 690553,
      "user_type" : "registered",
      "accept_rate" : 76,
      "profile_image" : "https://www.gravatar.com/avatar/1e4b2eb92d9417b384d82ebfea3d67ea?s=256&d=identicon&r=PG",
      "display_name" : "Amir Pashazadeh",
      "link" : "https://stackoverflow.com/users/690553/amir-pashazadeh"
    },
    "is_answered" : true,
    "view_count" : 91,
    "answer_count" : 2,
    "score" : 1,
    "last_activity_date" : 1759619306,
    "creation_date" : 1757286052,
    "link" : "https://stackoverflow.com/questions/79758390/cannot-read-accountexpires-attribute-from-active-directory-with-spring-ldap",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79758410,
    "question_id" : 79758390,
    "body" : "<p>Your code is not failing because of case sensitivity or missing the attribute in your query, but because the data type returned by AD is not being handled correctly. You must explicitly handle it as <code>long</code>. Just for a little background, the <code>accountExpires</code> attribute in AD is an integer representing the number of 100ns intervals since Jan 1st, 1601. Spring LDAP needs to handle it as a <code>long</code>.</p>\n<p>Create a custom <code>AttributesMapper</code> or <code>ContextMapper</code> to explicitly handle the <code>accountExpires</code> attribute.</p>\n<p>Example (more or less like this):</p>\n<pre><code>    public class CustomContextMapper implements ContextMapper&lt;User&gt; {\n        public User mapFromContext(Object ctx) {\n            DirContextAdapter context (DirContextAdapter) ctx;\n            User user = new User();\n            // ... more attribute mappings here ...\n            long accountExpires = context.getLongAttribute(&quot;accountExpires&quot;);\n            // ... convert long to date object ...\n            return user;\n        }\n    }\n</code></pre>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 3815391,
      "reputation" : 9724,
      "user_id" : 3164889,
      "user_type" : "registered",
      "accept_rate" : 68,
      "profile_image" : "https://i.sstatic.net/4NXwj.png?s=256",
      "display_name" : "Socrates",
      "link" : "https://stackoverflow.com/users/3164889/socrates"
    },
    "creation_date" : 1757290130,
    "last_activity_date" : 1757291344,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79782720,
    "question_id" : 79758390,
    "body" : "<p>The problem was on port of Active Directory I used. MS Active Directory exposes 2 ports 3268 which is readonly but return all results (even if result-set is so big) and 389 which is read/write but returns paged data.</p>\n<p>My <code>readTemplate</code> was set to read from 3268, but I don't know why that port does not return some attributes including <code>accountExpires</code>.</p>\n<p>When I read the data through <code>writeTemplate</code> (which was set on 389), I could read the attribute.</p>\n",
    "score" : 0,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 353069,
      "reputation" : 7362,
      "user_id" : 690553,
      "user_type" : "registered",
      "accept_rate" : 76,
      "profile_image" : "https://www.gravatar.com/avatar/1e4b2eb92d9417b384d82ebfea3d67ea?s=256&d=identicon&r=PG",
      "display_name" : "Amir Pashazadeh",
      "link" : "https://stackoverflow.com/users/690553/amir-pashazadeh"
    },
    "creation_date" : 1759619306,
    "last_activity_date" : 1759619306,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : { }
}