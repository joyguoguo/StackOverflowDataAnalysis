{
  "question" : {
    "question_id" : 79652697,
    "title" : "Error using Datastax SchemaBuilder for creating Cassandra table in Java",
    "body" : "<p>I'm trying to create a Cassandra table from Java code using Datastax's <a href=\"https://docs.datastax.com/en/drivers/java/3.6/com/datastax/driver/core/schemabuilder/SchemaBuilder.html\" rel=\"nofollow noreferrer\">SchemaBuilder</a> class. I'm essentially trying to convert this CQL query:</p>\n<pre><code>CREATE TABLE &lt;tablename&gt; (id text, key blob, val blob, PRIMARY KEY (id, key)) \nWITH compaction={'class': 'LeveledCompactionStrategy'} \nAND compression = {'sstable_compression' : 'LZ4Compressor' };\n</code></pre>\n<p>into Java code that looks like this:</p>\n<pre><code>Create.Options createTable = SchemaBuilder.createTable(keyspace+&quot;.&quot;+tableName)\n                    .addPartitionKey(&quot;id&quot;, DataType.text())\n                    .addClusteringColumn(&quot;key&quot;, DataType.blob())\n                    .addColumn(&quot;val&quot;, DataType.blob())\n                    .withOptions().compactionOptions(SchemaBuilder.leveledStrategy())\n                    .compressionOptions(SchemaBuilder.lz4());\n</code></pre>\n<p>The problem is that this gives the error with the compression option  <code>com.datastax.driver.core.exceptions.InvalidConfigurationInQueryException: Missing sub-option 'class' for the 'compression' option.</code></p>\n<p>From the API spec, it doesn't look like there's any other way to specify <code>LZ4Compressor</code> and I can't see this issue raised anywhere to find what's missing here. I'd like to know what's the issue with the query in Java and what would be the best way to fix it.</p>\n",
    "tags" : [ "java", "cassandra", "compression", "datastax", "cql" ],
    "owner" : {
      "account_id" : 8495965,
      "reputation" : 344,
      "user_id" : 6370552,
      "user_type" : "registered",
      "accept_rate" : 100,
      "profile_image" : "https://www.gravatar.com/avatar/efe20dbf579ea9856f22fd83d289ebad?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "scottstots",
      "link" : "https://stackoverflow.com/users/6370552/scottstots"
    },
    "is_answered" : false,
    "view_count" : 66,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1749049073,
    "creation_date" : 1749037745,
    "link" : "https://stackoverflow.com/questions/79652697/error-using-datastax-schemabuilder-for-creating-cassandra-table-in-java",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79653023,
    "question_id" : 79652697,
    "body" : "<p>Instead of using <code>.compressionOptions(SchemaBuilder.lz4())</code>, manually provide the correct compression map using <code>.compressionOptions(Map&lt;String, Object&gt;)</code>.</p>\n",
    "score" : -1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 12841617,
      "reputation" : 34,
      "user_id" : 9289488,
      "user_type" : "registered",
      "profile_image" : "https://graph.facebook.com/1530126660376529/picture?type=large",
      "display_name" : "Вилиян Вачев",
      "link" : "https://stackoverflow.com/users/9289488/%d0%92%d0%b8%d0%bb%d0%b8%d1%8f%d0%bd-%d0%92%d0%b0%d1%87%d0%b5%d0%b2"
    },
    "creation_date" : 1749049073,
    "last_activity_date" : 1749049073,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : {
    "79653023" : [ {
      "comment_id" : 140487282,
      "post_id" : 79653023,
      "body" : "Unfortunately this won&#39;t work as <code>compressionOptions(..)</code> method takes CompressionOptions as the type and not a map.",
      "score" : 1,
      "owner" : {
        "account_id" : 8495965,
        "reputation" : 344,
        "user_id" : 6370552,
        "user_type" : "registered",
        "accept_rate" : 100,
        "profile_image" : "https://www.gravatar.com/avatar/efe20dbf579ea9856f22fd83d289ebad?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "scottstots",
        "link" : "https://stackoverflow.com/users/6370552/scottstots"
      },
      "creation_date" : 1749051157,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}