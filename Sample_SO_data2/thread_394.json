{
  "question" : {
    "question_id" : 79815585,
    "title" : "Using selenium assert with wait",
    "body" : "<p>I'm trying to use asserts in selenium java. I read that for every validation, I need to use an assert as best practice.<br />\nI stumbled upon this code example:</p>\n<pre><code>WebElement button = wait.until(ExpectedConditions.visibilityOf(signInAndUpBtn));\nAssert.assertTrue(button.isDisplayed(), &quot;Sign In button should be visible on Home Page&quot;);\n</code></pre>\n<p>In this example, the assertion will never fail because it will fail previously on the wait. However, I want to combine the use of wait and assert, but I'm not sure what's the best way to do it.</p>\n",
    "tags" : [ "java", "selenium-webdriver", "assert", "webdriverwait" ],
    "owner" : {
      "account_id" : 11548912,
      "reputation" : 3,
      "user_id" : 8462150,
      "user_type" : "registered",
      "profile_image" : "https://lh4.googleusercontent.com/-ehPAkBQHANI/AAAAAAAAAAI/AAAAAAAAAN8/3YHCQ2OXHdU/s256-rj/photo.jpg",
      "display_name" : "J. Script",
      "link" : "https://stackoverflow.com/users/8462150/j-script"
    },
    "is_answered" : true,
    "view_count" : 136,
    "answer_count" : 3,
    "score" : 0,
    "last_activity_date" : 1762866208,
    "creation_date" : 1762777610,
    "link" : "https://stackoverflow.com/questions/79815585/using-selenium-assert-with-wait",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79816447,
    "question_id" : 79815585,
    "body" : "<p>The assertTrue() after a wait.until() will never run if the element is not found or not visible. Thatâ€™s because wait.until(...) throws a TimeoutException when the condition is not met within the given time. So the assertion becomes redundant.</p>\n<p>But you can control the assertion output - for example, to show a clean test failure message instead of a raw timeout exception, you can catch the TimeoutException and explicitly fail the test with your own assertion message.</p>\n<pre class=\"lang-java prettyprint-override\"><code>WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(10));\ntry { \n    wait.until(ExpectedConditions.visibilityOfElementLocated(locator));\n} catch (TimeoutException e) {\n    Assert.fail(message + &quot; (Element not visible after &quot; + timeoutSeconds + &quot;s)&quot;);\n}\n</code></pre>\n<p>hope this is help :)</p>\n",
    "score" : 1,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 44485404,
      "reputation" : 16,
      "user_id" : 31777453,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/5b09d0bfc2d0d6730b98156aa0e75661?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Idan_Z",
      "link" : "https://stackoverflow.com/users/31777453/idan-z"
    },
    "creation_date" : 1762852645,
    "last_activity_date" : 1762852645,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79815650,
    "question_id" : 79815585,
    "body" : "<p>The wait API is for synchronization and the predicate must pass to avoid a <code>TimeoutException</code> so it's not really possible to avoid a pass/fail on the predicate.</p>\n<p>Perhaps you could wait for something else (eg wait for the spinner to disappear)</p>\n<pre class=\"lang-java prettyprint-override\"><code>wait.until(ExpectedConditions.invisibilityOfElementLocated(By.id(&quot;spinner&quot;)));\nWebElement button = driver.findElement(By.id(&quot;my-button&quot;)); // Note this may throw NoSuchElementException\nAssert.assertTrue(button.isDisplayed(), &quot;Sign in button should be visible on Home Page&quot;);\n</code></pre>\n<p>I guess if you really want to continue regardless of the exception you could do</p>\n<pre><code>WebElement button = null;\ntry {\n   button = wait.until(ExpectedConditions.visibilityOfElementLocated(By.id(&quot;my-button&quot;)));\n} catch (TimeoutException e) {}\nAssert.assertTrue(button != null &amp;&amp; button.isDisplayed(), &quot;Sign In button should be visible on Home Page&quot;);\n</code></pre>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 1096470,
      "reputation" : 29424,
      "user_id" : 1089967,
      "user_type" : "registered",
      "accept_rate" : 59,
      "profile_image" : "https://www.gravatar.com/avatar/1f256b904ff621d678598d8fa49f86c5?s=256&d=identicon&r=PG",
      "display_name" : "lance-java",
      "link" : "https://stackoverflow.com/users/1089967/lance-java"
    },
    "creation_date" : 1762781479,
    "last_activity_date" : 1762782233,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79816418,
    "question_id" : 79815585,
    "body" : "<p>Perhaps you could try a <code>WaitWrapper</code> that returns <code>Optional</code></p>\n<pre><code>@Slf4j\npublic class WaitWrapper {\n   private final Wait&lt;WebDriver&gt; wait;\n\n   public WaitWrapper(Wait&lt;WebDriver&gt; wait) { this.wait = wait }\n\n   public &lt;T&gt; Optional&lt;T&gt; until(Function&lt;WebDriver, T&gt; function) {\n      try {\n         return Optional.of(wait.until(function));\n      } catch (TimeoutException e) {\n         LOG.error(e);\n         return Optional.empty();\n      }\n   }\n}\n</code></pre>\n<p>Then you could use <a href=\"https://jdriven.com/blog/2023/07/Awesome-AssertJ-Writing-Assertions-For-Optional\" rel=\"nofollow noreferrer\">AssertJ's Optional Support</a> in your tests</p>\n<pre><code>import static org.assertj.core.api.Assertions.assertThat;\n...\nWaitWrapper wait = new WaitWrapper(new FluentWait&lt;&gt;(driver).withTimeout(...));\nOptional&lt;WebElement&gt; buttonOption = wait.until(ExpectedConditions.visibilityOfElementLocated(By.id(&quot;my-button&quot;));\nassertThat(buttonOption)\n   .as(&quot;My fantastic button&quot;) // used in assertion failure messages\n   .isPresent()\n   .map(WebElement::isDisplayed).hasValue(true);\n</code></pre>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 1096470,
      "reputation" : 29424,
      "user_id" : 1089967,
      "user_type" : "registered",
      "accept_rate" : 59,
      "profile_image" : "https://www.gravatar.com/avatar/1f256b904ff621d678598d8fa49f86c5?s=256&d=identicon&r=PG",
      "display_name" : "lance-java",
      "link" : "https://stackoverflow.com/users/1089967/lance-java"
    },
    "creation_date" : 1762851094,
    "last_activity_date" : 1762866208,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140846996,
    "post_id" : 79815585,
    "body" : "It&#39;s not a best practice to assert something that can&#39;t possibly untrue",
    "score" : 1,
    "owner" : {
      "account_id" : 8866,
      "reputation" : 61531,
      "user_id" : 16148,
      "user_type" : "registered",
      "accept_rate" : 73,
      "profile_image" : "https://i.sstatic.net/XTzm1.jpg?s=256",
      "display_name" : "Corey Goldberg",
      "link" : "https://stackoverflow.com/users/16148/corey-goldberg"
    },
    "creation_date" : 1762787168,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79815650" : [ {
      "comment_id" : 140848798,
      "post_id" : 79815650,
      "body" : "First off, a test that only validates that a functional element is displayed is mostly useless. What if the login button is displayed but doesn&#39;t work? Don&#39;t test if it&#39;s visible, make a slightly longer test that actually logs in. If successful, you&#39;ve not only validated that the button is visible but also that it works by adding a fraction of a second to the run time of the test. Also, I&#39;m not a big fan of &quot;pretty&quot; reports like allure, etc. I think many people end up spending a lot of time making them pretty instead of just writing more tests. Learn how to read a stack trace and you&#39;re good.",
      "score" : 0,
      "owner" : {
        "account_id" : 2772450,
        "reputation" : 26488,
        "user_id" : 2386774,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/dea7da142cb7e85d5d5a8576e2625431?s=256&d=identicon&r=PG",
        "display_name" : "JeffC",
        "link" : "https://stackoverflow.com/users/2386774/jeffc"
      },
      "creation_date" : 1762874961,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140848146,
      "post_id" : 79815650,
      "body" : "@J Ultimately you&#39;re trying to avoid throwing a <code>TimeoutException</code> in order to throw an <code>AssertionException</code> on the next line. I&#39;m not sure I see the benefit of what you&#39;re trying to achieve",
      "score" : 1,
      "owner" : {
        "account_id" : 1096470,
        "reputation" : 29424,
        "user_id" : 1089967,
        "user_type" : "registered",
        "accept_rate" : 59,
        "profile_image" : "https://www.gravatar.com/avatar/1f256b904ff621d678598d8fa49f86c5?s=256&d=identicon&r=PG",
        "display_name" : "lance-java",
        "link" : "https://stackoverflow.com/users/1089967/lance-java"
      },
      "creation_date" : 1762850064,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140848078,
      "post_id" : 79815650,
      "body" : "@JeffC Can you elaborate? Lets say the purpose of my test is to validate the login button display. If it fails i want the assert to fail, not the wait. It makes the code much more readable and the allure reports handles its differently",
      "score" : 0,
      "owner" : {
        "account_id" : 11548912,
        "reputation" : 3,
        "user_id" : 8462150,
        "user_type" : "registered",
        "profile_image" : "https://lh4.googleusercontent.com/-ehPAkBQHANI/AAAAAAAAAAI/AAAAAAAAAN8/3YHCQ2OXHdU/s256-rj/photo.jpg",
        "display_name" : "J. Script",
        "link" : "https://stackoverflow.com/users/8462150/j-script"
      },
      "creation_date" : 1762847992,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140847836,
      "post_id" : 79815650,
      "body" : "I disagree... strongly. There&#39;s no point in putting an assert in here. If the script gets past the wait, it&#39;s clearly passed. Also, wrapping all of that in a try-catch, which slows down the script, just to put in an assert to check a box is absurd.",
      "score" : 0,
      "owner" : {
        "account_id" : 2772450,
        "reputation" : 26488,
        "user_id" : 2386774,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/dea7da142cb7e85d5d5a8576e2625431?s=256&d=identicon&r=PG",
        "display_name" : "JeffC",
        "link" : "https://stackoverflow.com/users/2386774/jeffc"
      },
      "creation_date" : 1762834205,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140847634,
      "post_id" : 79815650,
      "body" : "That&#39;s what i thought, in my best practice the assert is really important, for both code and report readability.  Doing the try catch method was the only solution i found",
      "score" : 0,
      "owner" : {
        "account_id" : 11548912,
        "reputation" : 3,
        "user_id" : 8462150,
        "user_type" : "registered",
        "profile_image" : "https://lh4.googleusercontent.com/-ehPAkBQHANI/AAAAAAAAAAI/AAAAAAAAAN8/3YHCQ2OXHdU/s256-rj/photo.jpg",
        "display_name" : "J. Script",
        "link" : "https://stackoverflow.com/users/8462150/j-script"
      },
      "creation_date" : 1762813944,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}