{
  "question" : {
    "question_id" : 79641566,
    "title" : "Inspect shows Charset Encoding of ISO even when i have mentioned UTF-8 in all files",
    "body" : "<p>When i open the menu of my web application, i use inspect &gt; network tab and see that pdamnu.do file has charset encoding of ISO.\nNow in my pdamnu.jsp i have mentioned the encoding of utf-8</p>\n<pre><code>&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; pageEncoding=&quot;UTF-8&quot; %&gt;\n&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot; &quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt;\n&lt;%@ include file = &quot;/common/Include.jsp&quot; %&gt;\n&lt;%@ page import=&quot;bancmate.common.web.SessionHandler&quot;%&gt;\n&lt;%@ page import=&quot;java.util.*&quot;%&gt;\n&lt;%StringBuilder cssMenu = null ;%&gt;\n&lt;%\nString broadCast = null ; \n     if(session.getAttribute(&quot;BroadCast&quot;)!=null){\n      broadCast = (String)session.getAttribute(&quot;BroadCast&quot;) ;\n      broadCast = broadCast + &quot;\\n&quot;;\n      System.out.println(&quot;------------&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;  &quot;+broadCast);\n     }\n%&gt;\n    \n&lt;script&gt;\n    var cssMenujs=&quot;&quot;;\n       var menu=sessionStorage.getItem('cssMenuLocal') || false;\n       console.log(&quot;session storage get \\n&quot;+menu);\n       if(menu){\n           &lt;%\n           cssMenu=new StringBuilder(&quot;&lt;script&gt;document.writeln(menu);&lt;/script&gt;&quot;);\n         System.out.print(&quot;if ok \\n&quot;+cssMenu);\n         %&gt;\n         console.log(&quot;session storage get menu set&quot;);\n       }else{\n           \n        var url=&quot;&lt;%=request.getContextPath()%&gt;/menu/Pdamnu.do&quot;;\n        var xhttp = new XMLHttpRequest();\n            \n        xhttp.onreadystatechange = function() {\n                if (this.readyState == 4 &amp;&amp; this.status == 200) {\n                            console.log(&quot;In response&quot;);\n                            cssMenujs = xhttp.responseText;\n                            console.log(&quot;1&quot;);\n                            cssMenujs = eval(&quot;cssMenujs&quot;);\n                            console.log(&quot;2&quot;);\n                                if(cssMenujs!=null)\n                                {\n                                    sessionStorage.setItem('cssMenuLocal',cssMenujs);\n                                    console.log(&quot;session storage set \\n&quot;+cssMenujs);\n                                    &lt;%\n                                        cssMenu=new StringBuilder(&quot;&lt;script&gt;document.writeln(cssMenujs);&lt;/script&gt;&quot;);\n                                        System.out.print(&quot;\\n else ok \\n&quot;+cssMenu);\n                                    %&gt;\n                                }\n                        }\n                \n        };\n        xhttp.open(&quot;POST&quot;,url,false);\n            xhttp.send();\n    }\n    if(cssMenujs==&quot;&quot; || !cssMenujs)\n    {\n        cssMenujs=eval(&quot;menu&quot;);\n    }\n&lt;/script&gt;\n&lt;html&gt;\n    &lt;head&gt;\n        &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0, minimum-scale=1.0&quot; /&gt;\n        &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html;charset=UTF-8&quot; /&gt;\n        \n         &lt;!-- All CSS links --&gt;\n\n            &lt;link rel = &quot;stylesheet&quot; href=&quot;&lt;%=request.getContextPath()%&gt;/jsp/css/style.css&quot;  type = &quot;text/css&quot;&gt;\n            &lt;link rel=&quot;stylesheet&quot; href=&quot;&lt;%=request.getContextPath()%&gt;/jsp/css/style-2.css&quot; type=&quot;text/css&quot;/&gt;\n\n            &lt;!-- SmartMenus core CSS (required) --&gt;\n            &lt;link href=&quot;&lt;%=request.getContextPath()%&gt;/jsp/css/sm-core-css.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot; /&gt;\n\n            &lt;!-- &quot;sm-blue&quot; menu theme --&gt;\n            &lt;link href=&quot;&lt;%=request.getContextPath()%&gt;/jsp/css/sm-blue.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot; /&gt;\n\n            &lt;!--Css for slider--&gt;\n            &lt;link href=&quot;&lt;%=request.getContextPath()%&gt;/jsp/css/js-image-slider.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot; /&gt;\n\n        &lt;!-- End of CSS links --&gt;\n\n\n        &lt;!-- All jQueries links --&gt;\n\n            &lt;!-- &lt;script language=JavaScript src = &quot;&lt;%=request.getContextPath()%&gt;/jsp/js/jquery-1.3.1.min.js&quot; &gt;&lt;/script&gt;\n            &lt;script language=JavaScript src = &quot;&lt;%=request.getContextPath()%&gt;/jsp/js/jquery1.js&quot;&gt;&lt;/script&gt;\n            &lt;script language=JavaScript src=&quot;&lt;%=request.getContextPath()%&gt;/jsp/js/jquery.dropdownPlain.js&quot;&gt;&lt;/script&gt; --&gt;\n\n            &lt;script language=JavaScript src = &quot;&lt;%=request.getContextPath()%&gt;/jsp/js/hammer.js&quot;&gt;&lt;/script&gt;\n        \n            &lt;!-- jQuery --&gt;\n            &lt;script type=&quot;text/javascript&quot; src=&quot;&lt;%=request.getContextPath()%&gt;/jsp/js/jquery.js&quot;&gt;&lt;/script&gt;\n\n            &lt;!-- SmartMenus jQuery plugin --&gt;\n            &lt;script type=&quot;text/javascript&quot; src=&quot;&lt;%=request.getContextPath()%&gt;/jsp/js/jquery.smartmenus.js&quot;&gt;&lt;/script&gt;\n\n            &lt;!-- SmartMenus jQuery Keyboard Addon --&gt;\n            &lt;script type=&quot;text/javascript&quot; src=&quot;&lt;%=request.getContextPath()%&gt;/jsp/js/jquery.smartmenus.keyboard.js&quot;&gt;&lt;/script&gt;\n\n            &lt;!--JS for slider--&gt;\n            &lt;script src=&quot;&lt;%=request.getContextPath()%&gt;/jsp/js/js-image-slider.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;\n \n        &lt;!-- End of JQueries links --&gt;\n        &lt;style&gt;\n        #main-menu&gt;li&gt;ul{display:block!important;\n        width:100%;}\n        &lt;/style&gt;\n\n&lt;script&gt;\n    var outIn = 'in';\n    \n    $(document).ready(function(e) {\n    \n    var startX, curX, startY, curY; // Variables\n    var newXScroll, newYScroll, genXScroll; // More Variables!\n    \n    // Change the height of the sidebar, as well as a few things to do with the main content area, so the user\n    // can actually scroll in the content area.\n    function sideBarHeight() { \n    \n        var docHeight = $(document).height();\n        var winHeight = $(window).height();\n        \n        $('.slide-in').height(winHeight);\n        $('#main-container').height(winHeight);\n        $('#sub-container').height($('#sub-container').height());\n    } \n    \n    sideBarHeight();\n    \n    var outIn = 'in';\n    \n    Hammer(document.getElementById('main-container')).on('swiperight', function(e) {\n            //$('.slide-in').toggleClass('on');     \n            //$('#main-container').toggleClass('on');\n            //outIn = 'out';\n            \n    });\n    \n    Hammer(document.getElementById('main-container')).on('swipeleft', function(e) {\n            $('.slide-in').toggleClass('on');   \n            $('#main-container').toggleClass('on');\n            outIn = 'in';\n    });\n    \n    \n    function runAnimation() {\n        if(outIn == 'out') {\n            document.getElementById(&quot;main-menu&quot;).style.display=&quot;block&quot;;\n            $('.slide-in').toggleClass('on');\n            $('#main-container').toggleClass('on'); \n            outIn = 'in';\n            \n        } else if(outIn == 'in') {\n        \n            $('.slide-in').toggleClass('on');   \n            $('#main-container').toggleClass('on'); \n            outIn = 'out';\n            \n        }\n    \n    }\n    \n    $('.menu-icon')[0].addEventListener('touchend', function(e) {\n\n        $('.slide-in').toggleClass('on');       \n        $('#main-container').toggleClass('on');\n    });\n    \n    $('.menu-icon').click(function() {      \n        //$('.slide-in').toggleClass('on');     \n        //$('#main-container').toggleClass('on');\n    });\n    \n    \n\n    });\n\n\n\n&lt;/script&gt;\n\n        &lt;!-- SmartMenus jQuery init --&gt;\n            &lt;script type=&quot;text/javascript&quot;&gt;\n                $(function() {\n                $('#main-menu').smartmenus({\n                subMenusSubOffsetX: 1,\n                subMenusSubOffsetY: -8\n            });\n                \n                        \n            $('#main-menu').smartmenus('keyboardSetHotkey', '123', 'shiftKey');\n            });\n            &lt;/script&gt;\n\n\n        \n\n    \n        &lt;!-- #main-menu config - instance specific stuff not covered in the theme --&gt;\n        &lt;style type=&quot;text/css&quot;&gt;\n        /*@media screen and (min-width: 768px) {\n        #main-menu {\n            position:relative;\n            z-index:9999;\n            width:230px;\n            margin-top:0px;\n            display:block;\n            \n        }*/\n        /*#main-menu ul {\n            width:12em; /* fixed width only please - you can use the &quot;subMenusMinWidth&quot;/&quot;subMenusMaxWidth&quot; script options to override this if you like */\n        }\n    }\n&lt;/style&gt;\n        &lt;script type=&quot;text/javascript&quot;&gt;\n        function formopen(menunext) {\n                var url = &quot;/BancMate/servlet/bancmate.common.menu.servlet.PdaMenuServlet?mnunext=&quot;+ menunext+&quot;&amp;Opentype=F&amp;index=0&amp;connectFrm=M&amp;newMenu=Y&quot; ;\n                document.forms[0].action=&quot;&quot;+url;\n                document.forms[0].method=&quot;post&quot;;\n                document.forms[0].submit();\n                return ;\n            }\n\n    function callmenu() {\n $('.slide-in').toggleClass(&quot;on&quot;);\n     $('#main-container').toggleClass(&quot;on&quot;);\n     count = 1;\n    }\n    var count;\nfunction check(){\n//  debugger;\n    if(count==1){\n//  $('.slide-in').toggleClass(&quot;on&quot;);\n    }\n    if(document.getElementById(&quot;main-menu&quot;).style.display==&quot;block&quot; )\n    {\n    //  document.getElementById(&quot;main-menu&quot;).style.display=&quot;none&quot;;\n//  if(document.getElementById(&quot;sm-15865158296919065-1&quot;)==true){\n//      document.getElementById(&quot;main-menu&quot;).style.display=&quot;none&quot;;\n//      document.getElementById(&quot;menuDiv&quot;).style.display=&quot;none&quot;;\n//  }\n        document.getElementById(&quot;right&quot;).src=&quot;&lt;%=request.getContextPath()%&gt;/jsp/images/right.jpg&quot;;\n    //  document.getElementById(&quot;menuDiv&quot;).style.display=&quot;none&quot;;    \n        count =2;\n    }\n    else \n    {\n        document.getElementById(&quot;main-menu&quot;).style.display=&quot;block&quot;;\n        document.getElementById(&quot;right&quot;).src=&quot;&lt;%=request.getContextPath()%&gt;/jsp/images/left1.jpg&quot;;\n        document.getElementById(&quot;menuDiv&quot;).style.display=&quot;block&quot;;\n        count =2;\n    }\n\n}\n&lt;/script&gt;\n\n&lt;/head&gt;\n    &lt;body style=&quot;width:1200px;height:200px;overflow-y:hidden;&quot; onload=&quot;callmenu()&quot;&gt;\n        &lt;form&gt;\n        \n            &lt;div&gt;\n                        \n              &lt;div id=&quot;main-container&quot; class=&quot;tk-chaparral-pro&quot;&gt;\n\n             \n              &lt;/div&gt;\n            \n              &lt;div class=&quot;menu-icon&quot; onclick=&quot;check()&quot; title=&quot;Main-Menu&quot;&gt;\n               &lt;a href=&quot;#&quot; tabindex=&quot;1&quot; id=&quot;imglnk&quot;&gt;&lt;img\n                 src=&quot;&lt;%=request.getContextPath()%&gt;/jsp/images/right.jpg&quot; id=&quot;right&quot;\n                 style=&quot;width: 10%; height: 10%;&quot; role=&quot;button&quot;&gt;&lt;/a&gt;        \n               &lt;/div&gt; \n               \n              &lt;div id=&quot;menuDiv&quot; class=&quot;slide-in&quot; style=&quot;display:block;height:100%;&quot; onclick=&quot;check()&quot; title=&quot;Main-Menu&quot; &gt;\n            &lt;div id=&quot;menuHtmlContent&quot;&gt;&lt;/div&gt;\n\n&lt;script&gt;\n  var menu = sessionStorage.getItem('cssMenuLocal');\n  if (menu) {\n    document.getElementById(&quot;menuHtmlContent&quot;).innerHTML = menu;\n  } else {\n    var xhttp = new XMLHttpRequest();\n    xhttp.onreadystatechange = function () {\n      if (this.readyState == 4 &amp;&amp; this.status == 200) {\n        var menuHTML = this.responseText;\n        sessionStorage.setItem('cssMenuLocal', menuHTML);\n        document.getElementById(&quot;menuHtmlContent&quot;).innerHTML = menuHTML;\n      }\n    };\n    xhttp.open(&quot;POST&quot;, &quot;&lt;%=request.getContextPath()%&gt;/menu/Pdamnu.do&quot;, true);\n    xhttp.send();\n  }\n&lt;/script&gt;\n\n              &lt;/div&gt;\n            \n             &lt;div style=&quot; border: 5px solid #495566; width: 35%; height: 200px; margin-top: 10%; margin-left: 40%;border-radius:10px;&quot;&gt;\n               &lt;center&gt;\n               &lt;B&gt;&lt;h2 style=&quot;font-family:Helvetica Neue,Helvetica,Arial,sans-serif;color:blue;&quot;&gt;Message&lt;/h2&gt;&lt;/B&gt;\n               &lt;!--&lt;input type=&quot;button&quot; value=&quot;check&quot; name=&quot;check&quot; onclick=&quot;pdamenu()&quot;/&gt;--&gt;\n               &lt;MARQUEE  behavior=&quot;alternate&quot; style=&quot;margin-top:18%;&quot; SCROLLDELAY=150&gt;\n               &lt;%if(broadCast!=null){%&gt;\n               &lt;B&gt;&lt;%= broadCast %&gt;&lt;/B&gt;\n               &lt;%}%&gt;\n               &lt;/MARQUEE&gt;\n               &lt;/center&gt;\n               &lt;/div&gt;\n               \n               \n               \n              &lt;/div&gt;\n             \n        &lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n<p>and then in include.jsp as well it has utf-8 encoding.\nIn the doFilter also i have added the utf-8 encoding:</p>\n<pre><code>public void doFilter(ServletRequest request, ServletResponse response,\n            FilterChain chain) throws IOException, ServletException {\n        request.setCharacterEncoding(&quot;UTF-8&quot;);\n        response.setCharacterEncoding(&quot;UTF-8&quot;);\n        response.setContentType(&quot;text/html; charset=UTF-8&quot;);\n        BMLogger logger = new BMLogger(BMIbFilter.class);\n        HttpServletRequest httpRequest = (HttpServletRequest)request;\n        logger.info(&quot;Filter Called for : &quot; + httpRequest.getRequestURI());\n        logger.info(&quot;Session Value is : &quot; + httpRequest.getSession(false));\n</code></pre>\n<p>I have two folders, one is war which has frontend files and jar which has backend files and backend is in eclipse which also has default encoding of utf-8 and front end which is in vscode also have default utf-8.\ni was trying to display hindi language but it shows question marks instead of hindi. and that is when i inspected and saw the encoding of iso in network tab.\nsome of the other pages show hindi perfectly and they also have utf-8 encoding in the network tab. except the menu (pdamnu.do) which shows the iso encoding in inspect network tab.</p>\n<p>I have tried the page encoding in the jsp file. and i also added the response.setContent in filter to utf-8\nIn another file in MenuPdaAction i have added response.setContent like this:</p>\n<pre><code>if((mySession.getAttribute(&quot;cssMenu&quot;)==null)||(mySession.getAttribute(&quot;cssMenu&quot;).equals(&quot;&quot;)))\n                {\n                    System.out.println(&quot;New Menu Creating&quot;);\n                    cssMenu = menuRemote.getCSSMenuTree(suserid, sustid, &quot;  &quot;, lang.intValue(), loginParameter);\n                    response.setContentType(&quot;text/html; charset=UTF-8&quot;);\n                    response.setCharacterEncoding(&quot;UTF-8&quot;);\n                    mySession.setAttribute(&quot;cssMenu&quot;,cssMenu);\n                    mySession.setAttribute(&quot;nextlvl&quot;,null);\n                }\n                else\n                {\n                        System.out.println(&quot;Existing menu get&quot;);\n                        cssMenu=(StringBuilder)mySession.getAttribute(&quot;cssMenu&quot;);\n                }\n                 target = &quot;success&quot;;\n                 PrintWriter out = response.getWriter();\n                 sCssMenu = cssMenu.toString().replace(&quot;'&quot;,&quot;&amp;quot;&quot;);\n            //      out.write(sCssMenu);  \n                    out.print(sCssMenu);\n                    out.flush();\n                    return null;\n                //  out.close();\n             }\n</code></pre>\n<p>i tried removing replace() if it was messing with encoding but no results. Also my database written content of hindi seems to be in utf-16. i tried changing jsp and java files to utf-16 but no results. i cant change database content to utf-8.</p>\n",
    "tags" : [ "javascript", "java", "jsp", "encoding", "utf-8" ],
    "owner" : {
      "account_id" : 42235873,
      "reputation" : 11,
      "user_id" : 30655197,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/88ed182547466faf7e4f72f8f75260d6?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Ashish",
      "link" : "https://stackoverflow.com/users/30655197/ashish"
    },
    "is_answered" : false,
    "view_count" : 92,
    "answer_count" : 0,
    "score" : 1,
    "last_activity_date" : 1748411196,
    "creation_date" : 1748411196,
    "link" : "https://stackoverflow.com/questions/79641566/inspect-shows-charset-encoding-of-iso-even-when-i-have-mentioned-utf-8-in-all-fi",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140465683,
    "post_id" : 79641566,
    "body" : "i tried gettinf the response through curl commands and open that file into vs code and change its encoding it was still showing question marks. the problem migh tbe in servlet filter, i tried to add utf-8 setContent there but the code stopped running",
    "score" : 0,
    "owner" : {
      "account_id" : 42235873,
      "reputation" : 11,
      "user_id" : 30655197,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/88ed182547466faf7e4f72f8f75260d6?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Ashish",
      "link" : "https://stackoverflow.com/users/30655197/ashish"
    },
    "creation_date" : 1748430796,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140465436,
    "post_id" : 79641566,
    "body" : "The encoding of your source files doesn&#39;t matter. By the way: A file exclusively containing ASCII characters is exactly the same in ISO-8859-x or UTF-8. Maybe the problem is setting the response encoding conditionally if you fetch the menu newly but not if it&#39;s already loaded.",
    "score" : 0,
    "owner" : {
      "account_id" : 29176687,
      "reputation" : 438,
      "user_id" : 22351796,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/1ae534f680eb879398ed8846b6e85b69?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Karsten",
      "link" : "https://stackoverflow.com/users/22351796/karsten"
    },
    "creation_date" : 1748425670,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140464781,
    "post_id" : 79641566,
    "body" : "Also, i did the inspect and in network tab, the header of pdamnu.jsp shows utf-8 but the pdamnu.do header shows iso-8859-1 encoding",
    "score" : 0,
    "owner" : {
      "account_id" : 42235873,
      "reputation" : 11,
      "user_id" : 30655197,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/88ed182547466faf7e4f72f8f75260d6?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Ashish",
      "link" : "https://stackoverflow.com/users/30655197/ashish"
    },
    "creation_date" : 1748413118,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}