{
  "question" : {
    "question_id" : 79670366,
    "title" : "maven-exec-plugin causes dependency check in clean phase",
    "body" : "<p>I have a project with a dependency which is installed and cleaned by the maven-exec-plugin.</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; \n         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; \n         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 \n             http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    &lt;groupId&gt;de.hsc&lt;/groupId&gt;\n    &lt;artifactId&gt;exectest&lt;/artifactId&gt;\n    &lt;version&gt;4.0.0&lt;/version&gt;\n    &lt;packaging&gt;jar&lt;/packaging&gt;\n    &lt;properties&gt;\n        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\n        &lt;maven.compiler.release&gt;21&lt;/maven.compiler.release&gt;\n        &lt;exec.mainClass&gt;de.hsc.exectest.Exectest&lt;/exec.mainClass&gt;\n    &lt;/properties&gt;\n    \n    &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;\n                &lt;artifactId&gt;exec-maven-plugin&lt;/artifactId&gt;\n                &lt;version&gt;3.5.0&lt;/version&gt;\n                &lt;executions&gt;\n                    &lt;execution&gt;\n                        &lt;id&gt;clean-other-project&lt;/id&gt;\n                        &lt;phase&gt;clean&lt;/phase&gt;\n                        &lt;goals&gt;\n                            &lt;goal&gt;exec&lt;/goal&gt;\n                        &lt;/goals&gt;\n                        &lt;configuration&gt;\n                            &lt;executable&gt;mvn.cmd&lt;/executable&gt;\n                            &lt;workingDirectory&gt;${basedir}/../NonExistentDependency&lt;/workingDirectory&gt;\n                            &lt;commandlineArgs&gt;clean&lt;/commandlineArgs&gt;\n                        &lt;/configuration&gt;\n                    &lt;/execution&gt;\n                    &lt;execution&gt;\n                        &lt;id&gt;install-other-project&lt;/id&gt;\n                        &lt;phase&gt;validate&lt;/phase&gt;\n                        &lt;goals&gt;\n                            &lt;goal&gt;exec&lt;/goal&gt;\n                        &lt;/goals&gt;\n                        &lt;configuration&gt;\n                            &lt;executable&gt;mvn.cmd&lt;/executable&gt;\n                            &lt;workingDirectory&gt;${basedir}/../NonExistentDependency&lt;/workingDirectory&gt;\n                            &lt;commandlineArgs&gt;install&lt;/commandlineArgs&gt;\n                        &lt;/configuration&gt;\n                    &lt;/execution&gt;\n                &lt;/executions&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n    \n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;foo.bar&lt;/groupId&gt;\n            &lt;artifactId&gt;NonExistentDependency&lt;/artifactId&gt;\n            &lt;version&gt;1.0.0&lt;/version&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n&lt;/project&gt;\n</code></pre>\n<p>When &quot;NonExistentDependency&quot; is not in the local repository and I hit &quot;mvn clean&quot; it should clean up my project and NonExistentDependency by the exec-plugin but I receive this:</p>\n<pre><code>mvn clean\n[INFO] Scanning for projects...\n[INFO]\n[INFO] --------------------------&lt; de.hsc:exectest &gt;---------------------------\n[INFO] Building exectest 4.0.0\n[INFO]   from pom.xml\n[INFO] --------------------------------[ jar ]---------------------------------\n[WARNING] The POM for foo.bar:NonExistentDependency:jar:1.0.0 is missing, no dependency information available\n[INFO] ------------------------------------------------------------------------\n[INFO] BUILD FAILURE\n[INFO] ------------------------------------------------------------------------\n[INFO] Total time:  0.247 s\n[INFO] Finished at: 2025-06-18T11:24:02+02:00\n[INFO] ------------------------------------------------------------------------\n[ERROR] Failed to execute goal on project exectest: Could not resolve dependencies for project de.hsc:exectest:jar:4.0.0\n[ERROR] dependency: foo.bar:NonExistentDependency:jar:1.0.0 (compile)\n</code></pre>\n<p>When I comment out the execution block with id &quot;clean-other-project&quot; and hit mvn clean again, everything is working as expected (except that the other project is not cleaned up):</p>\n<pre><code>mvn clean\n[INFO] Scanning for projects...\n[INFO]\n[INFO] --------------------------&lt; de.hsc:exectest &gt;---------------------------\n[INFO] Building exectest 4.0.0\n[INFO]   from pom.xml\n[INFO] --------------------------------[ jar ]---------------------------------\n[INFO]\n[INFO] --- clean:3.2.0:clean (default-clean) @ exectest ---\n[INFO] ------------------------------------------------------------------------\n[INFO] BUILD SUCCESS\n[INFO] ------------------------------------------------------------------------\n[INFO] Total time:  0.352 s\n[INFO] Finished at: 2025-06-18T11:25:24+02:00\n[INFO] ------------------------------------------------------------------------\n</code></pre>\n<p>So somehow for no reason maven-exec-plugin seems to check the dependencies of the project for no reason.</p>\n<p>&quot;mvn validate&quot; is also aborting with the same error.</p>\n<p>Should this be the expected behaviour or do I miss something?</p>\n",
    "tags" : [ "java", "maven", "maven-plugin", "maven-exec-plugin" ],
    "owner" : {
      "account_id" : 4431651,
      "reputation" : 611,
      "user_id" : 3608678,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/Wh00D.jpg?s=256",
      "display_name" : "HarleyDavidson",
      "link" : "https://stackoverflow.com/users/3608678/harleydavidson"
    },
    "is_answered" : true,
    "view_count" : 67,
    "answer_count" : 2,
    "score" : 1,
    "last_activity_date" : 1750245233,
    "creation_date" : 1750239135,
    "link" : "https://stackoverflow.com/questions/79670366/maven-exec-plugin-causes-dependency-check-in-clean-phase",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79670409,
    "question_id" : 79670366,
    "body" : "<p>Some plugins require dependency resolution before they start. Maven-Exec-Plugin as well:</p>\n<pre><code>@Mojo(name = &quot;exec&quot;, threadSafe = true, requiresDependencyResolution = ResolutionScope.TEST)\npublic class ExecMojo extends AbstractExecMojo {\n</code></pre>\n<p>See <a href=\"https://github.com/mojohaus/exec-maven-plugin/blob/master/src/main/java/org/codehaus/mojo/exec/ExecMojo.java\" rel=\"nofollow noreferrer\">https://github.com/mojohaus/exec-maven-plugin/blob/master/src/main/java/org/codehaus/mojo/exec/ExecMojo.java</a></p>\n<p>Generally, you don't write POMs like that. You either put both projects together into a multi-module-project or you do complicated builds by using a build server like GitHub or GitLab.</p>\n",
    "score" : 2,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 888714,
      "reputation" : 36717,
      "user_id" : 927493,
      "user_type" : "registered",
      "accept_rate" : 61,
      "profile_image" : "https://i.sstatic.net/sxsnm.png?s=256",
      "display_name" : "JF Meier",
      "link" : "https://stackoverflow.com/users/927493/jf-meier"
    },
    "creation_date" : 1750241015,
    "last_activity_date" : 1750245233,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79670488,
    "question_id" : 79670366,
    "body" : "<p>This is likely due to the <a href=\"https://www.baeldung.com/java-maven-reactor\" rel=\"nofollow noreferrer\">maven reactor</a> building it's directed acyclic graph (DAG) to determine the build order of the project.</p>\n<p>It seems that you are fighting maven rather than embracing it. Don't do this, instead create a multi-module maven build with two java modules.</p>\n<p>See</p>\n<ul>\n<li><a href=\"https://www.baeldung.com/java-maven-reactor\" rel=\"nofollow noreferrer\">https://www.baeldung.com/java-maven-reactor</a></li>\n<li><a href=\"https://www.baeldung.com/maven-multi-module\" rel=\"nofollow noreferrer\">https://www.baeldung.com/maven-multi-module</a></li>\n<li><a href=\"https://medium.com/@khileshsahu2007/maven-multi-module-project-guide-structure-examples-real-world-challenges-d867ff22a0a8\" rel=\"nofollow noreferrer\">https://medium.com/@khileshsahu2007/maven-multi-module-project-guide-structure-examples-real-world-challenges-d867ff22a0a8</a></li>\n<li><a href=\"https://maven.apache.org/guides/mini/guide-multiple-subprojects-4.html\" rel=\"nofollow noreferrer\">https://maven.apache.org/guides/mini/guide-multiple-subprojects-4.html</a></li>\n</ul>\n<p>Directory Structure</p>\n<pre><code>multi-module-project/\n├── pom.xml                 # Parent POM\n├── core/\n│   └── pom.xml             # Core module POM\n└── web/\n    └── pom.xml             # Web module POM\n</code></pre>\n<p>Parent pom.xml</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; \n         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 \n                             http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n\n    &lt;groupId&gt;com.example&lt;/groupId&gt;\n    &lt;artifactId&gt;multi-module-project&lt;/artifactId&gt;\n    &lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt;\n    &lt;packaging&gt;pom&lt;/packaging&gt; &lt;!-- note packaging=&quot;pom&quot; --&gt;\n\n    &lt;modules&gt;\n        &lt;module&gt;core&lt;/module&gt;\n        &lt;module&gt;web&lt;/module&gt;\n    &lt;/modules&gt;\n\n    &lt;properties&gt;\n        &lt;java.version&gt;17&lt;/java.version&gt;\n    &lt;/properties&gt;\n\n    &lt;dependencyManagement&gt;\n        &lt;dependencies&gt;\n            &lt;dependency&gt;\n               &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;\n               &lt;artifactId&gt;commons-lang3&lt;/artifactId&gt;\n               &lt;!-- define version here once for all projects --&gt;\n               &lt;version&gt;3.14.0&lt;/version&gt; \n            &lt;/dependency&gt;\n            &lt;dependency&gt;\n               &lt;groupId&gt;com.example&lt;/groupId&gt;\n               &lt;artifactId&gt;core&lt;/artifactId&gt;\n               &lt;!-- define version here once for all projects --&gt;\n               &lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt;\n            &lt;/dependency&gt;\n        &lt;/dependencies&gt;\n    &lt;/dependencyManagement&gt;\n&lt;/project&gt;\n</code></pre>\n<p>core/pom.xml</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; \n         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 \n                             http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;parent&gt;\n        &lt;groupId&gt;com.example&lt;/groupId&gt;\n        &lt;artifactId&gt;multi-module-project&lt;/artifactId&gt;\n        &lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt;\n    &lt;/parent&gt;\n\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    &lt;artifactId&gt;core&lt;/artifactId&gt;\n\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;\n            &lt;artifactId&gt;commons-lang3&lt;/artifactId&gt;\n            &lt;!-- don't need to define version here --&gt;\n            &lt;!-- will inherit dependencyManagement from parent --&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n&lt;/project&gt;\n</code></pre>\n<p>web/pom.xml</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; \n         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 \n                             http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;parent&gt;\n        &lt;groupId&gt;com.example&lt;/groupId&gt;\n        &lt;artifactId&gt;multi-module-project&lt;/artifactId&gt;\n        &lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt;\n    &lt;/parent&gt;\n\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    &lt;artifactId&gt;web&lt;/artifactId&gt;\n\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.example&lt;/groupId&gt;\n            &lt;artifactId&gt;core&lt;/artifactId&gt; &lt;!-- Depends on core module --&gt;\n            &lt;!-- don't need to define version here --&gt;\n            &lt;!-- will inherit dependencyManagement from parent --&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n&lt;/project&gt;\n</code></pre>\n",
    "score" : 1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 1096470,
      "reputation" : 29424,
      "user_id" : 1089967,
      "user_type" : "registered",
      "accept_rate" : 59,
      "profile_image" : "https://www.gravatar.com/avatar/1f256b904ff621d678598d8fa49f86c5?s=256&d=identicon&r=PG",
      "display_name" : "lance-java",
      "link" : "https://stackoverflow.com/users/1089967/lance-java"
    },
    "creation_date" : 1750243796,
    "last_activity_date" : 1750244517,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140523731,
    "post_id" : 79670366,
    "body" : "Why is this dependency installed and cleaned by exec-maven-plugin? Why not adding it as a usual dep to the pom file?",
    "score" : 0,
    "owner" : {
      "account_id" : 112317,
      "reputation" : 98455,
      "user_id" : 296328,
      "user_type" : "registered",
      "accept_rate" : 60,
      "profile_image" : "https://i.sstatic.net/DSpH6.jpg?s=256",
      "display_name" : "khmarbaise",
      "link" : "https://stackoverflow.com/users/296328/khmarbaise"
    },
    "creation_date" : 1750251885,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79670409" : [ {
      "comment_id" : 140523735,
      "post_id" : 79670409,
      "body" : "@Basilevs No, TEST is the highest possible scope, see <a href=\"https://maven.apache.org/plugin-tools/maven-plugin-annotations/apidocs/org/apache/maven/plugins/annotations/ResolutionScope.html\" rel=\"nofollow noreferrer\">maven.apache.org/plugin-tools/maven-plugin-annotations/apido&zwnj;&#8203;cs/&hellip;</a>",
      "score" : 0,
      "owner" : {
        "account_id" : 888714,
        "reputation" : 36717,
        "user_id" : 927493,
        "user_type" : "registered",
        "accept_rate" : 61,
        "profile_image" : "https://i.sstatic.net/sxsnm.png?s=256",
        "display_name" : "JF Meier",
        "link" : "https://stackoverflow.com/users/927493/jf-meier"
      },
      "creation_date" : 1750252072,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140523428,
      "post_id" : 79670409,
      "body" : "Can dependency have a scope that would escape Test scope declared by exec plugin?",
      "score" : 0,
      "owner" : {
        "account_id" : 43022,
        "reputation" : 24624,
        "user_id" : 125562,
        "user_type" : "registered",
        "accept_rate" : 64,
        "profile_image" : "https://i.sstatic.net/SdIqA.png?s=256",
        "display_name" : "Basilevs",
        "link" : "https://stackoverflow.com/users/125562/basilevs"
      },
      "creation_date" : 1750246241,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140523335,
      "post_id" : 79670409,
      "body" : "See <a href=\"https://github.com/mojohaus/exec-maven-plugin/blob/master/src/main/java/org/codehaus/mojo/exec/ExecMojo.java\" rel=\"nofollow noreferrer\">github.com/mojohaus/exec-maven-plugin/blob/master/src/main/j&zwnj;&#8203;ava/&hellip;</a>",
      "score" : 0,
      "owner" : {
        "account_id" : 888714,
        "reputation" : 36717,
        "user_id" : 927493,
        "user_type" : "registered",
        "accept_rate" : 61,
        "profile_image" : "https://i.sstatic.net/sxsnm.png?s=256",
        "display_name" : "JF Meier",
        "link" : "https://stackoverflow.com/users/927493/jf-meier"
      },
      "creation_date" : 1750244616,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140523334,
      "post_id" : 79670409,
      "body" : "The Maven exec plugin does it: <code>@Mojo(name = &quot;exec&quot;, threadSafe = true, requiresDependencyResolution = ResolutionScope.TEST) public class ExecMojo extends AbstractExecMojo {</code>",
      "score" : 0,
      "owner" : {
        "account_id" : 888714,
        "reputation" : 36717,
        "user_id" : 927493,
        "user_type" : "registered",
        "accept_rate" : 61,
        "profile_image" : "https://i.sstatic.net/sxsnm.png?s=256",
        "display_name" : "JF Meier",
        "link" : "https://stackoverflow.com/users/927493/jf-meier"
      },
      "creation_date" : 1750244605,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140523289,
      "post_id" : 79670409,
      "body" : "When you write a maven plugin, you annotate it with things like <code>@Mojo(     name = &quot;add-boms&quot;,     requiresProject = true,     requiresDependencyCollection = ResolutionScope.COMPILE)</code> You usually require DependencyCollection or Resolution if you need to use or check the dependencies inside your plugin.",
      "score" : 0,
      "owner" : {
        "account_id" : 888714,
        "reputation" : 36717,
        "user_id" : 927493,
        "user_type" : "registered",
        "accept_rate" : 61,
        "profile_image" : "https://i.sstatic.net/sxsnm.png?s=256",
        "display_name" : "JF Meier",
        "link" : "https://stackoverflow.com/users/927493/jf-meier"
      },
      "creation_date" : 1750243396,
      "content_license" : "CC BY-SA 4.0"
    } ],
    "79670488" : [ {
      "comment_id" : 140528799,
      "post_id" : 79670488,
      "body" : "Quite likely I misunderstood your comment then",
      "score" : 0,
      "owner" : {
        "account_id" : 1096470,
        "reputation" : 29424,
        "user_id" : 1089967,
        "user_type" : "registered",
        "accept_rate" : 59,
        "profile_image" : "https://www.gravatar.com/avatar/1f256b904ff621d678598d8fa49f86c5?s=256&d=identicon&r=PG",
        "display_name" : "lance-java",
        "link" : "https://stackoverflow.com/users/1089967/lance-java"
      },
      "creation_date" : 1750405741,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140527724,
      "post_id" : 79670488,
      "body" : "Lance-java, which comment? My previous comment has nothing to do with local repository or exec-plugin.",
      "score" : 0,
      "owner" : {
        "account_id" : 43022,
        "reputation" : 24624,
        "user_id" : 125562,
        "user_type" : "registered",
        "accept_rate" : 64,
        "profile_image" : "https://i.sstatic.net/SdIqA.png?s=256",
        "display_name" : "Basilevs",
        "link" : "https://stackoverflow.com/users/125562/basilevs"
      },
      "creation_date" : 1750360631,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140527295,
      "post_id" : 79670488,
      "body" : "I don&#39;t agree with this comment. If you want to reference a jar from maven local repository it should be installed before running the build. The OP is installing a jar in the maven local directory by manually invoking &quot;maven install&quot; using the &quot;exec-maven-plugin&quot; after the build has started. This is quite unorthodox and the maven-reactor is unaware this dependency magically appearing in the maven local directory after the build has started.",
      "score" : 0,
      "owner" : {
        "account_id" : 1096470,
        "reputation" : 29424,
        "user_id" : 1089967,
        "user_type" : "registered",
        "accept_rate" : 59,
        "profile_image" : "https://www.gravatar.com/avatar/1f256b904ff621d678598d8fa49f86c5?s=256&d=identicon&r=PG",
        "display_name" : "lance-java",
        "link" : "https://stackoverflow.com/users/1089967/lance-java"
      },
      "creation_date" : 1750349253,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140524370,
      "post_id" : 79670488,
      "body" : "If this answer is true, removing most plugins from the project file would not fix the issue. Would be nice to see results of such experiment.",
      "score" : 0,
      "owner" : {
        "account_id" : 43022,
        "reputation" : 24624,
        "user_id" : 125562,
        "user_type" : "registered",
        "accept_rate" : 64,
        "profile_image" : "https://i.sstatic.net/SdIqA.png?s=256",
        "display_name" : "Basilevs",
        "link" : "https://stackoverflow.com/users/125562/basilevs"
      },
      "creation_date" : 1750263445,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}