{
  "question" : {
    "question_id" : 79817198,
    "title" : "Why does directSupertypes() not return a raw type as required by JLS 4.10?",
    "body" : "<p>The <a href=\"https://docs.oracle.com/en/java/javase/25/docs/api/java.compiler/javax/lang/model/util/Types.html#directSupertypes(javax.lang.model.type.TypeMirror)\" rel=\"noreferrer\">contract for <code>Types#directSupertypes(TypeMirror)</code> says</a> that it will return &quot;the direct supertypes of a type&quot;. It also <a href=\"https://docs.oracle.com/javase/specs/jls/se25/html/jls-4.html#jls-4.10\" rel=\"noreferrer\">references section 4.10 of the Java Language Specification</a>.</p>\n<p>The set of direct supertypes that 4.10 defines is a superset of the set of types that <code>Types#directSupertypes(TypeMirror)</code> returns. Specifically, for a parameterized type, such as is represented by <code>ArrayList&lt;String&gt;</code>, a raw type, such as is represented by <code>ArrayList</code>, should be in the set:</p>\n<blockquote>\n<p>Given a generic class or interface C with type parameters F1,…,Fn (<em>n</em> &gt; 0), the <em>direct supertypes</em> of the parameterized type C&lt;T1,...,Tn&gt;, where each of Ti (1 ≤ <em>i</em> ≤ <em>n</em>) is a type, are all of the following:</p>\n<ul>\n<li><p>The substitution [F1:=T1,...,Fn:=Tn] applied to the direct superclass type of C, if C is a class.</p>\n</li>\n<li><p>The substitution [F1:=T1,...,Fn:=Tn] applied to the direct superinterface types of C.</p>\n</li>\n<li><p>C&lt;S1,...,Sn&gt;, where Si contains Ti (1 ≤ <em>i</em> ≤ <em>n</em>) (<a href=\"https://docs.oracle.com/javase/specs/jls/se25/html/jls-4.html#jls-4.5.1\" rel=\"noreferrer\">§4.5.1</a>).</p>\n</li>\n<li><p>The type <code>Object</code>, if C is an interface with no direct superinterface types.</p>\n</li>\n<li><p>The raw type C.</p>\n</li>\n</ul>\n</blockquote>\n<p>Why, by contrast, and to use a concrete example, for an input of a type such as is represented by <code>ArrayList&lt;String&gt;</code> does <code>directSupertypes(TypeMirror)</code> return a (sub)set not containing a raw type such as is represented by <code>ArrayList</code> (last bullet point in the spec citation above)?</p>\n<p>Per request, an example:</p>\n<pre><code>Elements elements = ...\nTypes types = ...\n\nTypeElement arrayList = elements.getTypeElement(&quot;java.util.ArrayList&quot;);\nTypeElement string = elements.getTypeElement(&quot;java.lang.String&quot;);\n\nDeclaredType arrayListTU = types.getDeclaredType(arrayList, string.asType());\n\nList&lt;? extends TypeMirror&gt; directSupertypes = types.directSupertypes(arrayListTU);\n\n// A type such as is represented by AbstractList&lt;String&gt;\nDeclaredType abstractListST = (DeclaredType)directSupertypes.get(0);\nassertEquals(1, abstractListST.getTypeArguments().size());\n\n// List&lt;String&gt;, which is an interface type. They come last in the\n// list, per contract, so this shows that no raw non-interface type\n// is present in the returned list.\nDeclaredType listST = (DeclaredType)directSupertypes.get(1);\nassertTrue(listST.asElement().getKind().isInterface());\n</code></pre>\n",
    "tags" : [ "java", "annotation-processing", "jls", "javax.lang.model" ],
    "owner" : {
      "account_id" : 72101,
      "reputation" : 16536,
      "user_id" : 208288,
      "user_type" : "registered",
      "accept_rate" : 67,
      "profile_image" : "https://www.gravatar.com/avatar/eac63f74d0e07c869a537771e24b0e6f?s=256&d=identicon&r=PG",
      "display_name" : "Laird Nelson",
      "link" : "https://stackoverflow.com/users/208288/laird-nelson"
    },
    "is_answered" : false,
    "view_count" : 78,
    "answer_count" : 0,
    "score" : 5,
    "last_activity_date" : 1762905819,
    "creation_date" : 1762901455,
    "link" : "https://stackoverflow.com/questions/79817198/why-does-directsupertypes-not-return-a-raw-type-as-required-by-jls-4-10",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140849736,
    "post_id" : 79817198,
    "body" : "You could try a <a href=\"https://mail.openjdk.org/mailman/listinfo\" rel=\"nofollow noreferrer\">mailing list</a> to ask about this.",
    "score" : 3,
    "owner" : {
      "account_id" : 8532578,
      "reputation" : 49904,
      "user_id" : 6395627,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/af0f9bfe593f36642a032cd7ea611e7d?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Slaw",
      "link" : "https://stackoverflow.com/users/6395627/slaw"
    },
    "creation_date" : 1762924401,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140849566,
    "post_id" : 79817198,
    "body" : "Well I don&#39;t see how you&#39;re going to get an answer here, unless a JDK author sees it. Nobody else would know.",
    "score" : 0,
    "owner" : {
      "account_id" : 71739,
      "reputation" : 311888,
      "user_id" : 207421,
      "user_type" : "registered",
      "accept_rate" : 82,
      "profile_image" : "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=256&d=identicon&r=PG",
      "display_name" : "user207421",
      "link" : "https://stackoverflow.com/users/207421/user207421"
    },
    "creation_date" : 1762907910,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140849542,
    "post_id" : 79817198,
    "body" : "Interestingly, there seem to be quite a few issues around this area. <a href=\"https://bugs.openjdk.org/browse/JDK-8055219\" rel=\"nofollow noreferrer\">bugs.openjdk.org/browse/JDK-8055219</a> includes a few notes around <code>directSupertypes</code> specifically, suggesting obliquely that this method&#39;s behavior simply Is What It Does.",
    "score" : 2,
    "owner" : {
      "account_id" : 72101,
      "reputation" : 16536,
      "user_id" : 208288,
      "user_type" : "registered",
      "accept_rate" : 67,
      "profile_image" : "https://www.gravatar.com/avatar/eac63f74d0e07c869a537771e24b0e6f?s=256&d=identicon&r=PG",
      "display_name" : "Laird Nelson",
      "link" : "https://stackoverflow.com/users/208288/laird-nelson"
    },
    "creation_date" : 1762906399,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140849524,
    "post_id" : 79817198,
    "body" : "Specifically, when given a type representing <code>ArrayList&lt;String&gt;</code>, a type representing the raw type <code>ArrayList</code> is not a member of the returned set. The JLS says that it should be. Example to follow shortly.",
    "score" : 1,
    "owner" : {
      "account_id" : 72101,
      "reputation" : 16536,
      "user_id" : 208288,
      "user_type" : "registered",
      "accept_rate" : 67,
      "profile_image" : "https://www.gravatar.com/avatar/eac63f74d0e07c869a537771e24b0e6f?s=256&d=identicon&r=PG",
      "display_name" : "Laird Nelson",
      "link" : "https://stackoverflow.com/users/208288/laird-nelson"
    },
    "creation_date" : 1762904703,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}