{
  "question" : {
    "question_id" : 79725087,
    "title" : "What does 0 mean in someList.toArray(new AnotherClass[0])?",
    "body" : "<p>In Java we have toArray() method which will return Object[]. If I want to return another data type I need to pass it to parameters like this</p>\n<pre><code>SomeClass.SomeList.toArray(new AnotherClass[0]);\n</code></pre>\n<p>What does 0 mean in this case?</p>\n",
    "tags" : [ "java", "list", "methods", "zero" ],
    "owner" : {
      "account_id" : 28656859,
      "reputation" : 35,
      "user_id" : 21942667,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a/AGNmyxbZTwMI9ftzsNg6lZ0OH3Kd5ILONJPhU9C3upeV=k-s256",
      "display_name" : "JustDreaming",
      "link" : "https://stackoverflow.com/users/21942667/justdreaming"
    },
    "is_answered" : true,
    "view_count" : 202,
    "answer_count" : 1,
    "score" : 3,
    "last_activity_date" : 1754388754,
    "creation_date" : 1754319778,
    "link" : "https://stackoverflow.com/questions/79725087/what-does-0-mean-in-somelist-toarraynew-anotherclass0",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79725090,
    "question_id" : 79725087,
    "body" : "<p><code>new AnotherClass[0]</code> will create an array with 0 elements.</p>\n<p><code>SomeList.toArray(...)</code> will first check if the array is big enough to fit the elements and will create a new array of the desired size if it is not large enough.</p>\n<p>You might prefer to do <code>someList.toArray(new AnotherClass[someList.size()])</code></p>\n<p>This way you don't create a zero element array and then throw it away.</p>\n<p>But as @Rogue suggested, this does not perform better than <code>new AnotherClass[0]</code> (see <a href=\"https://shipilev.net/blog/2016/arrays-wisdom-ancients\" rel=\"nofollow noreferrer\">https://shipilev.net/blog/2016/arrays-wisdom-ancients</a>)</p>\n",
    "score" : 4,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 1096470,
      "reputation" : 29424,
      "user_id" : 1089967,
      "user_type" : "registered",
      "accept_rate" : 59,
      "profile_image" : "https://www.gravatar.com/avatar/1f256b904ff621d678598d8fa49f86c5?s=256&d=identicon&r=PG",
      "display_name" : "lance-java",
      "link" : "https://stackoverflow.com/users/1089967/lance-java"
    },
    "creation_date" : 1754320180,
    "last_activity_date" : 1754322103,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140643779,
    "post_id" : 79725087,
    "body" : "@Robert there’s no waste of CPU cycles, as passing a zero size array to common implementations like <code>ArrayList</code> has been proven the most efficient method since Java 6. Performance in managed environments with JIT and Hotspot optimizer can heavily contradict intuition. Besides that, it’s the only way for a <code>default</code> method to provide the necessary implementation guarantees for arbitrary implementations, like concurrent collections, for example. Passing a sized array would break for concurrent collections and be less efficient at the same time.",
    "score" : 1,
    "owner" : {
      "account_id" : 3211603,
      "reputation" : 301001,
      "user_id" : 2711488,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/t2hoD.jpg?s=256",
      "display_name" : "Holger",
      "link" : "https://stackoverflow.com/users/2711488/holger"
    },
    "creation_date" : 1754404538,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140643205,
    "post_id" : 79725087,
    "body" : "@DuncG Thanks for pointing that out. This is the behavior of <code>java.util.Collection</code> and it is documented: <code>The default implementation calls the generator function with zero and then passes the resulting array to toArray(T[]).</code> <a href=\"https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Collection.html#toArray(java.util.function.IntFunction)\" rel=\"nofollow noreferrer\">docs.oracle.com/en/java/javase/21/docs/api/java.base/java/ut&zwnj;&#8203;il/&hellip;</a>. What a nonsense and waste of CPU cycles...",
    "score" : 1,
    "owner" : {
      "account_id" : 50585,
      "reputation" : 43469,
      "user_id" : 150978,
      "user_type" : "registered",
      "accept_rate" : 78,
      "profile_image" : "https://www.gravatar.com/avatar/feadc214792e2581c3c750140e3eb2c7?s=256&d=identicon&r=PG",
      "display_name" : "Robert",
      "link" : "https://stackoverflow.com/users/150978/robert"
    },
    "creation_date" : 1754391284,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140643101,
    "post_id" : 79725087,
    "body" : "@Robert Interesting to note that (in JDK24 at least) the size passed to AnotherClass[]::new is 0 rather than the real size. Run <code>List.of(&quot;a&quot;,&quot;b&quot;).toArray(i -&gt;{System.out.format(&quot;new String[%d]%n&quot;, i); return new String[i];});</code> prints &quot;new String[0]&quot;.",
    "score" : 0,
    "owner" : {
      "account_id" : 5998820,
      "reputation" : 16284,
      "user_id" : 4712734,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/f6e922a2cb7e2da59286f27b162aaca5?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "DuncG",
      "link" : "https://stackoverflow.com/users/4712734/duncg"
    },
    "creation_date" : 1754388906,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140641579,
    "post_id" : 79725087,
    "body" : "Related: <a href=\"https://stackoverflow.com/questions/16884799/using-0-size-array-as-parameter-of-list-toarrayt\">Using 0 size array as parameter of <code>List.toArray&lt;T[]&gt;</code></a>",
    "score" : 0,
    "owner" : {
      "account_id" : 7612423,
      "reputation" : 87409,
      "user_id" : 5772882,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/8283c64511fa80afed5259d10850168f?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Anonymous",
      "link" : "https://stackoverflow.com/users/5772882/anonymous"
    },
    "creation_date" : 1754332028,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140641300,
    "post_id" : 79725087,
    "body" : "This is an old workaround for providing the array type to the <code>toArray</code> method if you don&#39;t know the exact length. <code>toArray</code> will then create a new array with the correct length and type. Since Java 11 this is no longer necessary as you can simply use <code>someList.toArray(AnotherClass[]::new);</code>",
    "score" : 7,
    "owner" : {
      "account_id" : 50585,
      "reputation" : 43469,
      "user_id" : 150978,
      "user_type" : "registered",
      "accept_rate" : 78,
      "profile_image" : "https://www.gravatar.com/avatar/feadc214792e2581c3c750140e3eb2c7?s=256&d=identicon&r=PG",
      "display_name" : "Robert",
      "link" : "https://stackoverflow.com/users/150978/robert"
    },
    "creation_date" : 1754324826,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140641134,
    "post_id" : 79725087,
    "body" : "It creates a zero-length array, i.e. <code>[]</code>. Since arrays are fixed-size, this is an array that contains nothing (and never can contain anything). This is a common sentinel value in calling <code>#toArray</code> in which the method will make its own array to return",
    "score" : 3,
    "owner" : {
      "account_id" : 1992310,
      "reputation" : 11519,
      "user_id" : 1786065,
      "user_type" : "registered",
      "accept_rate" : 91,
      "profile_image" : "https://i.sstatic.net/udTpS.png?s=256",
      "display_name" : "Rogue",
      "link" : "https://stackoverflow.com/users/1786065/rogue"
    },
    "creation_date" : 1754320119,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79725090" : [ {
      "comment_id" : 140642892,
      "post_id" : 79725090,
      "body" : "Stay with <code>new AnotherClass[0]</code>. It’s robust <i>and</i> more efficient. If you want the full story, read <a href=\"https://shipilev.net/blog/2016/arrays-wisdom-ancients/\" rel=\"nofollow noreferrer\">shipilev.net/blog/2016/arrays-wisdom-ancients</a>",
      "score" : 4,
      "owner" : {
        "account_id" : 3211603,
        "reputation" : 301001,
        "user_id" : 2711488,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/t2hoD.jpg?s=256",
        "display_name" : "Holger",
        "link" : "https://stackoverflow.com/users/2711488/holger"
      },
      "creation_date" : 1754385060,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140641249,
      "post_id" : 79725090,
      "body" : "Bear in mind that evaluating <code>size()</code> might not be trivial for all types of List. I used to evaluate size everywhere but have switched my toArray conversions to use <code>new T[0]</code>",
      "score" : 1,
      "owner" : {
        "account_id" : 5998820,
        "reputation" : 16284,
        "user_id" : 4712734,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/f6e922a2cb7e2da59286f27b162aaca5?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "DuncG",
        "link" : "https://stackoverflow.com/users/4712734/duncg"
      },
      "creation_date" : 1754323338,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140641202,
      "post_id" : 79725090,
      "body" : "@DuncG changed to <code>.toArray(new AnotherClass[size])</code>",
      "score" : 1,
      "owner" : {
        "account_id" : 1096470,
        "reputation" : 29424,
        "user_id" : 1089967,
        "user_type" : "registered",
        "accept_rate" : 59,
        "profile_image" : "https://www.gravatar.com/avatar/1f256b904ff621d678598d8fa49f86c5?s=256&d=identicon&r=PG",
        "display_name" : "lance-java",
        "link" : "https://stackoverflow.com/users/1089967/lance-java"
      },
      "creation_date" : 1754321867,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140641201,
      "post_id" : 79725090,
      "body" : "@Rogue That was an interesting rabbit hole to go down",
      "score" : 1,
      "owner" : {
        "account_id" : 1096470,
        "reputation" : 29424,
        "user_id" : 1089967,
        "user_type" : "registered",
        "accept_rate" : 59,
        "profile_image" : "https://www.gravatar.com/avatar/1f256b904ff621d678598d8fa49f86c5?s=256&d=identicon&r=PG",
        "display_name" : "lance-java",
        "link" : "https://stackoverflow.com/users/1089967/lance-java"
      },
      "creation_date" : 1754321809,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140641171,
      "post_id" : 79725090,
      "body" : "Last comment isn&#39;t useful as <code>stream()</code> would end up creating objects which are thrown away.",
      "score" : 1,
      "owner" : {
        "account_id" : 5998820,
        "reputation" : 16284,
        "user_id" : 4712734,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/f6e922a2cb7e2da59286f27b162aaca5?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "DuncG",
        "link" : "https://stackoverflow.com/users/4712734/duncg"
      },
      "creation_date" : 1754320976,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140641150,
      "post_id" : 79725090,
      "body" : "JVM and JIT have some fun optimizations that actually make the latter not as efficient: <a href=\"https://stackoverflow.com/questions/174093/toarraynew-myclass0-or-toarraynew-myclassmylist-size\" title=\"toarraynew myclass0 or toarraynew myclassmylist size\">stackoverflow.com/questions/174093/&hellip;</a>",
      "score" : 5,
      "owner" : {
        "account_id" : 1992310,
        "reputation" : 11519,
        "user_id" : 1786065,
        "user_type" : "registered",
        "accept_rate" : 91,
        "profile_image" : "https://i.sstatic.net/udTpS.png?s=256",
        "display_name" : "Rogue",
        "link" : "https://stackoverflow.com/users/1786065/rogue"
      },
      "creation_date" : 1754320445,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}