{
  "question" : {
    "question_id" : 79729775,
    "title" : "When loading images and data I get a 403 status",
    "body" : "<p>I am studying Spring Boot and making a small test project. I want to make a method that will change the user profile data (name, email and image). Here is an approximate draft of the method. I send the request via postman and form-data and in this form everything works fine. But as soon as I uncomment the line <code>@RequestBody UserDtoRequest userDtoRequest</code> and pass other data there with a name or email, I get a 403 error.</p>\n<p>I can only accept data from DTO if I use the raw data transfer format in Postman to JSON, but then I won't be able to attach an image</p>\n<pre><code>@PatchMapping(&quot;/{id}&quot;)\n@Operation(summary = &quot;Изменение пользователя&quot;)\npublic ResponseEntity&lt;User&gt; updateUser(\n        @PathVariable Long id,\n        @RequestPart(&quot;file&quot;) MultipartFile file\n//            @RequestBody UserDtoRequest userDtoRequest\n) {\n    System.out.println(id);\n    System.out.println(file);\n//        System.out.println(userDtoRequest);\n\n    return null;\n}\n</code></pre>\n<p>my dto</p>\n<pre><code>@Data\n@AllArgsConstructor\npublic class UserDtoRequest {\n    @Nullable\n    @Length(min = 3, max = 20)\n    private String username;\n\n    @Nullable\n    @Email(message = &quot;Email is not valid&quot;)\n    private String email;\n}\n</code></pre>\n",
    "tags" : [ "java", "spring", "spring-boot" ],
    "owner" : {
      "account_id" : 17322978,
      "reputation" : 113,
      "user_id" : 12862288,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/1edc03cb3464c3987793fa3e0c2f8458?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "ШайтанЯкубович",
      "link" : "https://stackoverflow.com/users/12862288/%d0%a8%d0%b0%d0%b9%d1%82%d0%b0%d0%bd%d0%af%d0%ba%d1%83%d0%b1%d0%be%d0%b2%d0%b8%d1%87"
    },
    "is_answered" : true,
    "view_count" : 109,
    "answer_count" : 1,
    "score" : 1,
    "last_activity_date" : 1754741790,
    "creation_date" : 1754657508,
    "link" : "https://stackoverflow.com/questions/79729775/when-loading-images-and-data-i-get-a-403-status",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79730616,
    "question_id" : 79729775,
    "body" : "<p>According to the <a href=\"https://docs.spring.io/spring-framework/reference/web/webmvc/mvc-controller/ann-methods/requestbody.html\" rel=\"nofollow noreferrer\">Spring Framework @RequestBody documentation</a>:</p>\n<blockquote>\n<p>Form data should be read using <code>@RequestParam</code>, not with <code>@RequestBody</code> which can’t always be used reliably since in the Servlet API, request parameter access causes the request body to be parsed, and it can’t be read again.</p>\n</blockquote>\n<p>So if you wanna keep it to a single request, just send your data as form data along with the file. But if you really need JSON, you’ll have to split it into two separate calls—one for the file (form-data) and another for the JSON payload.</p>\n",
    "score" : 0,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 12988077,
      "reputation" : 77,
      "user_id" : 9388247,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/s256-rj/photo.jpg",
      "display_name" : "Matheus Sena",
      "link" : "https://stackoverflow.com/users/9388247/matheus-sena"
    },
    "creation_date" : 1754741790,
    "last_activity_date" : 1754741790,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : { }
}