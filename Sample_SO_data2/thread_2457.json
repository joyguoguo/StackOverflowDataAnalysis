{
  "question" : {
    "question_id" : 79621592,
    "title" : "Pattern Matching for instanceof for primitive types",
    "body" : "<p>Is it possible to use somehow primitive types in pattern matching with instaceof?\nI have following code:</p>\n<pre><code>public void method(Object input) {\n    if (input instanceof Boolean bool &amp;&amp; bool)\n    {\n        // do something\n    }\n}\n</code></pre>\n<p>And here sonar complains - Use the primitive boolean expression here.</p>\n<p>I cannot use boolean here, as its not buildable - Incompatible conditional operand types Object and boolean</p>\n<p>How do I rewrite it to be nice and with boolean primitive?</p>\n",
    "tags" : [ "java" ],
    "owner" : {
      "account_id" : 277685,
      "reputation" : 843,
      "user_id" : 571816,
      "user_type" : "registered",
      "accept_rate" : 92,
      "profile_image" : "https://www.gravatar.com/avatar/fe87c68615a9e0b76a255c21034945a5?s=256&d=identicon&r=PG",
      "display_name" : "JIV",
      "link" : "https://stackoverflow.com/users/571816/jiv"
    },
    "is_answered" : true,
    "view_count" : 152,
    "answer_count" : 2,
    "score" : 1,
    "last_activity_date" : 1747255349,
    "creation_date" : 1747229353,
    "link" : "https://stackoverflow.com/questions/79621592/pattern-matching-for-instanceof-for-primitive-types",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79621694,
    "question_id" : 79621592,
    "body" : "<p>You can achieve the comparison without pattern matching, as it is the same as:</p>\n<pre><code>if (Boolean.TRUE.equals(input))\n</code></pre>\n",
    "score" : 2,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 5998820,
      "reputation" : 16284,
      "user_id" : 4712734,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/f6e922a2cb7e2da59286f27b162aaca5?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "DuncG",
      "link" : "https://stackoverflow.com/users/4712734/duncg"
    },
    "creation_date" : 1747232715,
    "last_activity_date" : 1747234513,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79621671,
    "question_id" : 79621592,
    "body" : "<p>What happens if you try</p>\n<pre><code>    if (input instanceof Boolean &amp;&amp; (Boolean)input) {\n    }\n</code></pre>\n",
    "score" : -2,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 18959489,
      "reputation" : 167,
      "user_id" : 13835356,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/3980edc2a464cb8706c28698e01815c9?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "coder321",
      "link" : "https://stackoverflow.com/users/13835356/coder321"
    },
    "creation_date" : 1747232165,
    "last_activity_date" : 1747232165,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140429111,
    "post_id" : 79621592,
    "body" : "@DavidConrad I know that. I&#39;m not saying that the code JIV posted doesn&#39;t work. But the title of this question is: &quot;Pattern Matching for instanceof for primitive types&quot; - well, that is not a standard feature of Java yet.",
    "score" : 0,
    "owner" : {
      "account_id" : 45934,
      "reputation" : 207636,
      "user_id" : 135589,
      "user_type" : "registered",
      "accept_rate" : 100,
      "profile_image" : "https://www.gravatar.com/avatar/354d279a4def71b4541964105311709c?s=256&d=identicon&r=PG",
      "display_name" : "Jesper",
      "link" : "https://stackoverflow.com/users/135589/jesper"
    },
    "creation_date" : 1747318673,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140426602,
    "post_id" : 79621592,
    "body" : "@Jesper but <code>Boolean</code> is not a primitive type, it&#39;s just getting unboxed at the end of the expression; perhaps the title of the question should be changed.",
    "score" : 1,
    "owner" : {
      "account_id" : 318670,
      "reputation" : 16477,
      "user_id" : 636009,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/IIQJV.jpg?s=256",
      "display_name" : "David Conrad",
      "link" : "https://stackoverflow.com/users/636009/david-conrad"
    },
    "creation_date" : 1747255553,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140425760,
    "post_id" : 79621592,
    "body" : "does sonar accept <code>input instaceof Boolean bool &amp;&amp; bool.booleanValue()</code> ? (should be the same bytecode, but a &quot;<i>primitive boolean expression here</i>&quot;)",
    "score" : 0,
    "owner" : {
      "account_id" : 31180,
      "reputation" : 29752,
      "user_id" : 85421,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/kKvXH.gif?s=256",
      "display_name" : "user85421",
      "link" : "https://stackoverflow.com/users/85421/user85421"
    },
    "creation_date" : 1747238630,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140425505,
    "post_id" : 79621592,
    "body" : "@DuncG yes but not with primitive types",
    "score" : 2,
    "owner" : {
      "account_id" : 45934,
      "reputation" : 207636,
      "user_id" : 135589,
      "user_type" : "registered",
      "accept_rate" : 100,
      "profile_image" : "https://www.gravatar.com/avatar/354d279a4def71b4541964105311709c?s=256&d=identicon&r=PG",
      "display_name" : "Jesper",
      "link" : "https://stackoverflow.com/users/135589/jesper"
    },
    "creation_date" : 1747235197,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140425346,
    "post_id" : 79621592,
    "body" : "@Jesper See <a href=\"https://openjdk.org/jeps/394\" rel=\"nofollow noreferrer\">JEP 394: Pattern Matching for instanceof</a>, code will work in JDK16+",
    "score" : 1,
    "owner" : {
      "account_id" : 5998820,
      "reputation" : 16284,
      "user_id" : 4712734,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/f6e922a2cb7e2da59286f27b162aaca5?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "DuncG",
      "link" : "https://stackoverflow.com/users/4712734/duncg"
    },
    "creation_date" : 1747232477,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140425307,
    "post_id" : 79621592,
    "body" : "I don&#39;t use sonar (too many option As). Perhaps the warning is simply the autobox - have you tried <code>&amp;&amp; bool.booleanValue()</code> instead?",
    "score" : 1,
    "owner" : {
      "account_id" : 5998820,
      "reputation" : 16284,
      "user_id" : 4712734,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/f6e922a2cb7e2da59286f27b162aaca5?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "DuncG",
      "link" : "https://stackoverflow.com/users/4712734/duncg"
    },
    "creation_date" : 1747231740,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140425280,
    "post_id" : 79621592,
    "body" : "Primitive types in patterns is a feature which is not yet standard in Java - in Java 23 and 24 it&#39;s available as a preview feature: <a href=\"https://openjdk.org/jeps/488\" rel=\"nofollow noreferrer\">openjdk.org/jeps/488</a>",
    "score" : 3,
    "owner" : {
      "account_id" : 45934,
      "reputation" : 207636,
      "user_id" : 135589,
      "user_type" : "registered",
      "accept_rate" : 100,
      "profile_image" : "https://www.gravatar.com/avatar/354d279a4def71b4541964105311709c?s=256&d=identicon&r=PG",
      "display_name" : "Jesper",
      "link" : "https://stackoverflow.com/users/135589/jesper"
    },
    "creation_date" : 1747231356,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140425186,
    "post_id" : 79621592,
    "body" : "A PR to sonar to give it the power to realise a pattern-match variable decl can by definition never be null (because <code>null instanceof anything</code> is always false) seems like the best way forward here.",
    "score" : 3,
    "owner" : {
      "account_id" : 401843,
      "reputation" : 107206,
      "user_id" : 768644,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/b13bedc5215730fbce5edff6c130988a?s=256&d=identicon&r=PG",
      "display_name" : "rzwitserloot",
      "link" : "https://stackoverflow.com/users/768644/rzwitserloot"
    },
    "creation_date" : 1747229949,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140425181,
    "post_id" : 79621592,
    "body" : "@Sweeper your suggestion is ugly code. You&#39;ve check-casted <code>input</code> only to then immediately cast it again. In fact, a different linter rule should warn on your take (namely: &quot;That is a useless cast you can remove with no consequence&quot;). The code as OP pasted seems simpler and easier to read (and maintain!) to me than your alternative.",
    "score" : 0,
    "owner" : {
      "account_id" : 401843,
      "reputation" : 107206,
      "user_id" : 768644,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/b13bedc5215730fbce5edff6c130988a?s=256&d=identicon&r=PG",
      "display_name" : "rzwitserloot",
      "link" : "https://stackoverflow.com/users/768644/rzwitserloot"
    },
    "creation_date" : 1747229882,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140425177,
    "post_id" : 79621592,
    "body" : "See <a href=\"https://sonarsource.atlassian.net/browse/SONARJAVA-3570\" rel=\"nofollow noreferrer\">sonarsource.atlassian.net/browse/SONARJAVA-3570</a>. According to that, if there is a null check, Sonar shouldn&#39;t complain about this. So apparently Sonar doesn&#39;t see pattern matching as a null check.",
    "score" : 3,
    "owner" : {
      "account_id" : 6651855,
      "reputation" : 292280,
      "user_id" : 5133585,
      "user_type" : "registered",
      "accept_rate" : 96,
      "profile_image" : "https://i.sstatic.net/dfqcw.png?s=256",
      "display_name" : "Sweeper",
      "link" : "https://stackoverflow.com/users/5133585/sweeper"
    },
    "creation_date" : 1747229855,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140425172,
    "post_id" : 79621592,
    "body" : "If the question is: How can sonar possibly be confused / what is the thinking here? I&#39;m guessing: Using <code>bool</code> the way you are implies that <code>bool</code> cannot be <code>null</code>. Thus, sonar is thinking: a never-null <code>Boolean</code>? Then.. just use <code>boolean</code>. It hadn&#39;t thought of this case where you&#39;ve used a pattern match. Given that you&#39;ve got a linter that is complaining about code because <b>the linter</b> is out of date, the only correct fix is to fix the linter. Not to &#39;fix&#39; your code. I&#39;m not familiar enough with sonar to be 100% sure this is why sonar complains to turn this into a full answer.",
    "score" : 0,
    "owner" : {
      "account_id" : 401843,
      "reputation" : 107206,
      "user_id" : 768644,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/b13bedc5215730fbce5edff6c130988a?s=256&d=identicon&r=PG",
      "display_name" : "rzwitserloot",
      "link" : "https://stackoverflow.com/users/768644/rzwitserloot"
    },
    "creation_date" : 1747229769,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140425162,
    "post_id" : 79621592,
    "body" : "I think you&#39;re barking up the wrong tree. Sonar is a tool. A tool that does not do what you need it do should be discarded. If you think this code is fine (and it sure seems fine to me) either [A] tell sonar to stop whining about this, [B] file a bug report or PR with sonar to fix it, or [C] delete sonar. You appear to be going for [D] muck up my java code with ugly tripe just to make sonar shut up. Surely all can agree that of the 4 choices, [D] is most assuredly the worst by kilometers.",
    "score" : 4,
    "owner" : {
      "account_id" : 401843,
      "reputation" : 107206,
      "user_id" : 768644,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/b13bedc5215730fbce5edff6c130988a?s=256&d=identicon&r=PG",
      "display_name" : "rzwitserloot",
      "link" : "https://stackoverflow.com/users/768644/rzwitserloot"
    },
    "creation_date" : 1747229625,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140425156,
    "post_id" : 79621592,
    "body" : "I don&#39;t use Sonar, but <code>if (input instanceof Boolean bool &amp;&amp; (boolean)bool)</code> perhaps?",
    "score" : 0,
    "owner" : {
      "account_id" : 6651855,
      "reputation" : 292280,
      "user_id" : 5133585,
      "user_type" : "registered",
      "accept_rate" : 96,
      "profile_image" : "https://i.sstatic.net/dfqcw.png?s=256",
      "display_name" : "Sweeper",
      "link" : "https://stackoverflow.com/users/5133585/sweeper"
    },
    "creation_date" : 1747229461,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79621694" : [ {
      "comment_id" : 140427349,
      "post_id" : 79621694,
      "body" : "Elegant solution, I will use it.",
      "score" : 0,
      "owner" : {
        "account_id" : 277685,
        "reputation" : 843,
        "user_id" : 571816,
        "user_type" : "registered",
        "accept_rate" : 92,
        "profile_image" : "https://www.gravatar.com/avatar/fe87c68615a9e0b76a255c21034945a5?s=256&d=identicon&r=PG",
        "display_name" : "JIV",
        "link" : "https://stackoverflow.com/users/571816/jiv"
      },
      "creation_date" : 1747286210,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140425462,
      "post_id" : 79621694,
      "body" : "Oops - quite right, I&#39;ve never used that (deprecated JDK9+) constructor, removed",
      "score" : 1,
      "owner" : {
        "account_id" : 5998820,
        "reputation" : 16284,
        "user_id" : 4712734,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/f6e922a2cb7e2da59286f27b162aaca5?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "DuncG",
        "link" : "https://stackoverflow.com/users/4712734/duncg"
      },
      "creation_date" : 1747234492,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140425416,
      "post_id" : 79621694,
      "body" : "Using <code>Boolean.TRUE == input</code> assumes that <code>input</code> wasn&#39;t generated using <code>new Boolean(true)</code> or some other mechanism that produces unique instances.",
      "score" : 4,
      "owner" : {
        "account_id" : 213468,
        "reputation" : 110280,
        "user_id" : 466862,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=256&d=identicon&r=PG",
        "display_name" : "Mark Rotteveel",
        "link" : "https://stackoverflow.com/users/466862/mark-rotteveel"
      },
      "creation_date" : 1747233734,
      "content_license" : "CC BY-SA 4.0"
    } ],
    "79621671" : [ {
      "comment_id" : 140425811,
      "post_id" : 79621671,
      "body" : "that is basically doing the same as original code, only difference is that no additional local variable is used (and, btw, &quot;<i>what happens if</i>&quot; is not an answer, more like a question â†’ comment)",
      "score" : 2,
      "owner" : {
        "account_id" : 31180,
        "reputation" : 29752,
        "user_id" : 85421,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/kKvXH.gif?s=256",
        "display_name" : "user85421",
        "link" : "https://stackoverflow.com/users/85421/user85421"
      },
      "creation_date" : 1747239347,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140425409,
      "post_id" : 79621671,
      "body" : "The question is about pattern matching, and eliminating pattern matching to do what pattern matching already does seems a bit counterproductive. If there is a good reason to do this, provide an explanation.",
      "score" : 2,
      "owner" : {
        "account_id" : 213468,
        "reputation" : 110280,
        "user_id" : 466862,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=256&d=identicon&r=PG",
        "display_name" : "Mark Rotteveel",
        "link" : "https://stackoverflow.com/users/466862/mark-rotteveel"
      },
      "creation_date" : 1747233640,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}