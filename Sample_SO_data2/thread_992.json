{
  "question" : {
    "question_id" : 79756809,
    "title" : "Disable @PreAuthorize",
    "body" : "<p>I have a Spring Security configuration for permitting all requests:</p>\n<pre><code>@Configuration\n@EnableWebSecurity\n@Profile(&quot;no-auth&quot;)\npublic class NoAuthSecurityConfig {\n\n  private static final Logger logger = LoggerFactory.getLogger(NoAuthSecurityConfig.class);\n\n  public NoAuthSecurityConfig() {\n  }\n\n  @Bean\n  @Order(1)\n  public SecurityFilterChain noAuthSecurityFilterChain(final HttpSecurity httpSecurity) throws Exception {\n    return httpSecurity\n            .csrf(AbstractHttpConfigurer::disable)\n            .formLogin(AbstractHttpConfigurer::disable)\n            .authorizeHttpRequests(auth -&gt;\n                    auth.anyRequest().permitAll()\n            )\n            .build();\n  }\n}\n</code></pre>\n<p>But it's not working for endpoints with: <code>@PreAuthorize</code>. I get:</p>\n<pre><code>org.springframework.security.authorization.AuthorizationDeniedException: Access Denied\n    at org.springframework.security.authorization.method.ThrowingMethodAuthorizationDeniedHandler.handleDeniedInvocation(ThrowingMethodAuthorizationDeniedHandler.java:38) ~[spring-security-core-6.5.0.jar:6.5.0]\n</code></pre>\n<p>When I remove @PreAuthorize it's working fine. Do you know what is the correct way to disable Spring Security in Spring Cloud 2025.0.0?</p>\n",
    "tags" : [ "java", "spring-boot", "spring-security", "spring-cloud" ],
    "owner" : {
      "account_id" : 965625,
      "reputation" : 940,
      "user_id" : 1103606,
      "user_type" : "registered",
      "accept_rate" : 51,
      "profile_image" : "https://www.gravatar.com/avatar/0d93cc650b93939ea91066fcb5aefae0?s=256&d=identicon&r=PG",
      "display_name" : "Peter Penzov",
      "link" : "https://stackoverflow.com/users/1103606/peter-penzov"
    },
    "is_answered" : false,
    "view_count" : 174,
    "answer_count" : 1,
    "score" : 3,
    "last_activity_date" : 1758071773,
    "creation_date" : 1757077617,
    "link" : "https://stackoverflow.com/questions/79756809/disable-preauthorize",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79766799,
    "question_id" : 79756809,
    "body" : "<p>Here i think your question is</p>\n<p><code>For a specific profile how can i disable spring security altogether</code></p>\n<p>I believe you might not even need <code>SecurityFilterChain</code> bean.</p>\n<p>At java level, at the top of profile configuration class, you can have annotations with</p>\n<pre><code>@EnableAutoConfiguration(exclude = {\n    org.springframework.boot.autoconfigure.security.SecurityAutoConfiguration.class,\n    org.springframework.boot.actuate.autoconfigure.ManagementSecurityAutoConfiguration.class})\n</code></pre>\n<p>If you want to add in your profile yaml</p>\n<pre class=\"lang-yaml prettyprint-override\"><code>spring.autoconfigure.exclude: org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration,\norg.springframework.boot.actuate.autoconfigure.ManagementSecurityAutoConfiguration.class\n</code></pre>\n<p>If you know which profiles you want to enable web security you can also change in configuration class where you enable web security. With this spring security will not work with other profiles.</p>\n<pre class=\"lang-java prettyprint-override\"><code>   @Configuration\n   @EnableWebSecurity\n   @Profile(value = {&quot;dev&quot;, &quot;prod&quot;})\n   public class WebSecurityConfig extends WebSecurityConfigurerAdapter {\n\n</code></pre>\n<p>Ref: <a href=\"https://stackoverflow.com/questions/36280181/disabling-spring-security-in-spring-boot-app\">disabling spring security in spring boot app</a></p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 1408815,
      "reputation" : 2135,
      "user_id" : 1811348,
      "user_type" : "registered",
      "accept_rate" : 88,
      "profile_image" : "https://www.gravatar.com/avatar/cc9822a771917722f4b087a19ffabaf7?s=256&d=identicon&r=PG",
      "display_name" : "swapyonubuntu",
      "link" : "https://stackoverflow.com/users/1811348/swapyonubuntu"
    },
    "creation_date" : 1758071773,
    "last_activity_date" : 1758071773,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140733812,
    "post_id" : 79756809,
    "body" : "The information provided is not sufficient.",
    "score" : 0,
    "owner" : {
      "account_id" : 43891247,
      "reputation" : 16,
      "user_id" : 31468879,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/2fNDF4DM.png?s=256",
      "display_name" : "boiler_agents",
      "link" : "https://stackoverflow.com/users/31468879/boiler-agents"
    },
    "creation_date" : 1757780163,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140718713,
    "post_id" : 79756809,
    "body" : "Typically, the @PreAuthorize annotation is used to restrict method-level access based on user roles or permissions. However, in your current implementation, it appears that all requests are being allowed without any form of authorization check and also you used the preAuthorize annotaion. could you please give an more information about your issue or scenario you are trying to archive this or share the sample code ?",
    "score" : 0,
    "owner" : {
      "account_id" : 37827316,
      "reputation" : 46,
      "user_id" : 28449192,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/9d1c7624eda875a1ad4655e39e406520?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Ganesh Karunanidhi",
      "link" : "https://stackoverflow.com/users/28449192/ganesh-karunanidhi"
    },
    "creation_date" : 1757151588,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}