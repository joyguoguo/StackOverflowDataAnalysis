{
  "question" : {
    "question_id" : 79599141,
    "title" : "JGRP000010: packet from ip:port has different version (5.28.49) to ours (5.3.0)",
    "body" : "<p>Jgroups noob here but I'm attempting to set up this together with infinispan on my spring boot 3 services with the hope of using the dist cache functionality.</p>\n<p>i have tested my config locally with a standard enough TCP setup defined in my jgroups.xml.</p>\n<p>I've actually tried quite a few setups with it including UDP.</p>\n<p>locally i can run my two services (Jars) and i can see them doing the discovery and entering into the rebalance phase for the caches i set up in the cacheManager.</p>\n<p>however when i deploy these same microservices to our red hat server farm the problem starts.</p>\n<p>I can see my discovery mechanism can see the other nodes, ip addresses etc.</p>\n<p>when attempting the handshake i can see in the TCP trace logs:</p>\n<p>JGRP000010: packet from ip:port has different version (5.28.49) to ours (5.3.0)</p>\n<p>the port, i have checked for firewall blocks and nothing. SELinux is active but theres nothing blocking of concern in the audit logs. i can ssh into the machine and do a curl telnet://ip:port to the other machine and get a connection. so connectivity isnt a problem.</p>\n<p>from the jar perspective i have printed out both the JGroups version in use and the location of the Jar from the classpath on boot up - its certainly the one in the jar and its 5.3.0.</p>\n<p>any ideas on why i would be getting this, has anyone seen it before?</p>\n<p>the port is definitely only in use by this microservice so my guess is something strange is happening to the packets when they are being signed with the version at the lower TP levels?</p>\n<p>one thing of note is the version it says the packet is is a seemingly non existent version when compared to an actual JGroups release like 5.3.0.Final.</p>\n<p>any help would be greatly appreciated.</p>\n<p>thank you in advance</p>\n<p>example Jgroups config:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;config xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n        xsi:noNamespaceSchemaLocation=&quot;http://www.jgroups.org/schema/JGroups-5.0.xsd&quot;&gt;\n    \n    &lt;TCP bind_addr=&quot;192.168.1.100&quot;\n         bind_port=&quot;7800&quot;\n         recv_buf_size=&quot;20M&quot;\n         send_buf_size=&quot;640K&quot;\n         max_bundle_size=&quot;64K&quot;\n         max_bundle_timeout=&quot;30&quot;\n         enable_diagnostics=&quot;false&quot;\n         thread_pool.min_threads=&quot;4&quot;\n         thread_pool.max_threads=&quot;200&quot;\n         thread_pool.keep_alive_time=&quot;5000&quot;\n         thread_pool.queue_enabled=&quot;true&quot;\n         thread_pool.queue_max_size=&quot;1000&quot;\n         thread_pool.rejection_policy=&quot;discard&quot;/&gt;\n\n    &lt;TCPPING async_discovery=&quot;true&quot;\n             initial_hosts=&quot;192.168.1.101[7800],192.168.1.102[7800]&quot;\n             port_range=&quot;5&quot;\n             num_initial_members=&quot;3&quot;/&gt;\n\n    &lt;MERGE3 min_interval=&quot;10000&quot; max_interval=&quot;30000&quot;/&gt;\n    &lt;FD_SOCK/&gt;\n    &lt;FD_ALL timeout=&quot;12000&quot; interval=&quot;3000&quot; timeout_check_interval=&quot;5000&quot;/&gt;\n    &lt;VERIFY_SUSPECT timeout=&quot;1500&quot;/&gt;\n\n    &lt;BARRIER/&gt;\n    &lt;NAKACK2 use_mcast_xmit=&quot;false&quot; xmit_interval=&quot;500&quot; xmit_table_num_rows=&quot;100&quot;\n             xmit_table_msgs_per_row=&quot;2000&quot; xmit_table_max_compaction_time=&quot;30000&quot;/&gt;\n    &lt;UNICAST3 xmit_interval=&quot;500&quot; xmit_table_num_rows=&quot;100&quot;\n              xmit_table_msgs_per_row=&quot;2000&quot; xmit_table_max_compaction_time=&quot;30000&quot;/&gt;\n    &lt;STABLE stability_delay=&quot;1000&quot; desired_avg_gossip=&quot;50000&quot;\n            max_bytes=&quot;4M&quot;/&gt;\n    &lt;GMS print_local_addr=&quot;true&quot; join_timeout=&quot;5000&quot; view_bundling=&quot;true&quot;/&gt;\n    &lt;UFC max_credits=&quot;2M&quot; min_threshold=&quot;0.4&quot;/&gt;\n    &lt;MFC max_credits=&quot;2M&quot; min_threshold=&quot;0.4&quot;/&gt;\n    &lt;FRAG2 frag_size=&quot;60K&quot;/&gt;\n    &lt;RSVP resend_interval=&quot;2000&quot; timeout=&quot;10000&quot;/&gt;\n\n&lt;/config&gt;\n</code></pre>\n<p>Example runner:</p>\n<pre><code>import org.jgroups.*;\n\npublic class JGroupsExample {\n    public static void main(String[] args) throws Exception {\n        JChannel channel = new JChannel(&quot;jgroups-tcp.xml&quot;); // Path to your config\n        channel.setReceiver(new ReceiverAdapter() {\n            public void receive(Message msg) {\n                System.out.println(&quot;Received: &quot; + msg.getObject());\n            }\n        });\n        channel.connect(&quot;MyCluster&quot;);\n        channel.send(new Message(null, &quot;Hello from &quot; + channel.getAddress()));\n        Thread.sleep(10000); // Keep alive to receive messages\n        channel.close();\n    }\n}\n</code></pre>\n<p>Dependencies:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;dependency&gt;\n  &lt;groupId&gt;org.infinispan&lt;/groupId&gt;\n    &lt;artifactId&gt;infinispan-spring-boot-starter-embedded&lt;/artifactId&gt;\n   &lt;version&gt;14.0.34.Final&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n",
    "tags" : [ "java", "spring", "redhat", "infinispan", "jgroups" ],
    "owner" : {
      "account_id" : 41691754,
      "reputation" : 1,
      "user_id" : 30407006,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/e5fcfd579f68a50e5739b9bc77f44aa4?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Dcoyne",
      "link" : "https://stackoverflow.com/users/30407006/dcoyne"
    },
    "is_answered" : false,
    "view_count" : 101,
    "answer_count" : 2,
    "score" : 0,
    "last_activity_date" : 1746795205,
    "creation_date" : 1745957176,
    "link" : "https://stackoverflow.com/questions/79599141/jgrp000010-packet-from-ipport-has-different-version-5-28-49-to-ours-5-3-0",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79599824,
    "question_id" : 79599141,
    "body" : "<p>There are two potential root causes for this issue, either there is another piece of software using jgroups (standalone/WildFly/JBoss EAP/Infinispan/etc) on the network using a different version of JGroups or something completely unrelated is using the same multicast IP/port. The former typically happens when users use multicast for discovery with no authentication nor encryption but use the same UDP multicast address.</p>\n<p>Since you are using static discovery, finding the root cause should be easier. You should inspect all running Java processes for potential conflicting version but most likely, you need to examine what else is sending packets on this address (e.g. using Wireshark).</p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 2067331,
      "reputation" : 194,
      "user_id" : 1842594,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/b553ef9a63f33f7c9c4deba362fff563?s=256&d=identicon&r=PG",
      "display_name" : "Radoslav Husar",
      "link" : "https://stackoverflow.com/users/1842594/radoslav-husar"
    },
    "creation_date" : 1746000182,
    "last_activity_date" : 1746000182,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79614156,
    "question_id" : 79599141,
    "body" : "<p>I wanted to answer this in the hope it would help.</p>\n<p>As Radoslav pointed out, what it did come down to was &quot;something completely unrelated is using the same multicast IP/port&quot;. As it turns out something else on the network was using this port and somehow getting into jgroups processing causing the strange version to appear and mismatch in the packets. It was unfortunate because it did give off the impression that there was something wrong from a configuration standpoint i.e. The version imported to the jar was mismatching.</p>\n<p>Switching to a completely unused port on the machine allowed this to work first time.</p>\n<p>Hope it helps if someone else faces this in future.</p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 41691754,
      "reputation" : 1,
      "user_id" : 30407006,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/e5fcfd579f68a50e5739b9bc77f44aa4?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Dcoyne",
      "link" : "https://stackoverflow.com/users/30407006/dcoyne"
    },
    "creation_date" : 1746795205,
    "last_activity_date" : 1746795205,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140383301,
    "post_id" : 79599141,
    "body" : "5.28.49 is not even a valid version of JGroups which is confusing things even more. I have tried a downgrade to 5.0.0.Final without any improvement (same error just 5.28.49 does not match 5.0.0)",
    "score" : 0,
    "owner" : {
      "account_id" : 41691754,
      "reputation" : 1,
      "user_id" : 30407006,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/e5fcfd579f68a50e5739b9bc77f44aa4?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Dcoyne",
      "link" : "https://stackoverflow.com/users/30407006/dcoyne"
    },
    "creation_date" : 1746003268,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140382921,
    "post_id" : 79599141,
    "body" : "Have you considered of jgroups version? How about changing the version of jgroups from 5.3.0 to 5.28.49?",
    "score" : 0,
    "owner" : {
      "account_id" : 14331879,
      "reputation" : 346,
      "user_id" : 10352428,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/619aa63a0625944a2aa2fd0fdacb95cb?s=256&d=identicon&r=PG",
      "display_name" : "萝莉w",
      "link" : "https://stackoverflow.com/users/10352428/%e8%90%9d%e8%8e%89w"
    },
    "creation_date" : 1745996906,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}