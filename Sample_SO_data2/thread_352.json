{
  "question" : {
    "question_id" : 79819231,
    "title" : "Building a WAR package, that can be deployed under Tomcat and can be executed in the CLI as well",
    "body" : "<p>I would like to create a WAR package with maven, that can be deployed under Tomcat (9 or above) and also can be executed on the command line (= CLI). I already realised to make a package, that could be deployed either under Tomcat or could be executed on the CLI, but not both in the same package.\nThis <a href=\"https://spring.io/blog/2014/03/07/deploying-spring-boot-applications/\" rel=\"nofollow noreferrer\">article</a> says:</p>\n<blockquote>\n<p>This new class can now be used to run the application using embeddedd\nJetty or Tomcat, internally, and it can be deployed to any Servlet 3\ncontainer.</p>\n</blockquote>\n<p>But it didn't work for me (neither under Tomcat nor in CLI).</p>\n<p>EDIT: <a href=\"https://stackoverflow.com/questions/73278110/maven-generate-both-jar-and-war-for-the-project-using-same-pom-xml\">here</a> I found the option <code>&lt;archiveClasses&gt;</code>. With this the compiled class of My.App was put in a .JAR (under WEB-INF/lib where all the other dependencies are located) instead of putting it under WEB-INF/classes. Now the .WAR can be deployed under Tomcat, but I still can't run it with <code>java -jar</code>. The error message is: java.lang.ClassNotFoundException: My.App.</p>\n<p>Is there a solution, to extract each .JAR (under WEB-INF/lib) to the disk by running <code>java -jar</code>, then setting the classpath dynamically, and starting My.App finally from the disk ? Or am I on the wrong path ?</p>\n<p>I found a similar <a href=\"https://stackoverflow.com/questions/23868580/one-spring-boot-project-deploy-to-both-jar-or-war\">question</a>. But:</p>\n<blockquote>\n<p>That way project build was able to generate multiple deployment\nartifacts</p>\n</blockquote>\n<p>I would like to have 1 artifact, that can be deployed under Tomcat, and also can be executed with <code>java -jar</code>.</p>\n<p>I have the following project structure:</p>\n<pre><code>pom.xml\n\nsrc/main/java/My/App.java\nsrc/main/webapp/WEB-INF/config\nsrc/main/webapp/WEB-INF/web.xml\nsrc/main/webapp/doc\nsrc/main/webapp/resources\n\nsrc/test/java/My/AppTest.java\nsrc/test/config\nsrc/test/resources\n</code></pre>\n<p>In the generated  .WAR  there is the following structure:</p>\n<pre><code>WEB-INF/classes/My/App.class\nWEB-INF/config  //configs of My.App\nWEB-INF/lib  //dependencies of My.App as  .JAR\nWEB-INF/web.xml  //required by Tomcat\ndoc  //some docs accessible within the running application\nresources  //resources of My.App\n</code></pre>\n<p>This is almost good for deploying under Tomcat; the only problem is that <code>My/App.class</code> should also be in a .JAR file under <code>WEB-INF/lib</code>.</p>\n<p>I also can't start the  .WAR  in the CLI (with <code>java -jar</code>), because the JVM can't find the dependencies of <code>My/App.class</code>, even if <code>MANIFEST.MF</code> has <code>ClassPath</code> with entries e.g.:</p>\n<pre><code>WEB-INF/lib/dp1.jar\nWEB-INF/lib/dp2.jar\n</code></pre>\n<p>Can someone help me please to achieve this ?</p>\n<p>The content of <code>App.java</code> (based on the example in the article above):</p>\n<pre><code>package My;\n\nimport org.apache.catalina.Context;\nimport org.apache.catalina.LifecycleException;\nimport org.apache.catalina.Wrapper;\nimport org.apache.catalina.connector.Connector;\nimport org.apache.catalina.core.StandardVirtualThreadExecutor;\nimport org.apache.catalina.startup.Tomcat;\nimport org.apache.commons.io.FileUtils;\nimport org.apache.tomcat.util.descriptor.web.ContextEnvironment;\nimport org.apache.tomcat.util.descriptor.web.FilterDef;\nimport org.apache.tomcat.util.descriptor.web.FilterMap;\nimport org.springframework.boot.builder.SpringApplicationBuilder;\nimport org.springframework.boot.web.servlet.support.SpringBootServletInitializer;\nimport org.springframework.core.io.Resource;\nimport org.springframework.core.io.ResourceLoader;\nimport org.springframework.core.io.support.PathMatchingResourcePatternResolver;\nimport org.springframework.core.io.support.ResourcePatternResolver;\nimport java.util.logging.Logger;\n\n\npublic class App extends SpringBootServletInitializer {\n\n    private static final Logger LOGGER = Logger.getLogger(App.class.getName());\n\n\n    @Override\n    protected SpringApplicationBuilder configure(SpringApplicationBuilder application) {\n        return application.sources(App.class);\n    }\n\n    public static void main(String[] args) throws LifecycleException, UnknownHostException {\n        Tomcat tomcat = createAndConfigureTomcat();\n        tomcat.start();\n        tomcat.getServer().await();\n    }\n\n    public static Tomcat createAndConfigureTomcat() throws UnknownHostException {\n        Tomcat tomcat = new Tomcat();\n\n        String docBase = new File(System.getProperty(&quot;java.io.tmpdir&quot;) + &quot;/tomcat-&quot; + Math.random()).getAbsolutePath();\n        tomcat.setBaseDir(docBase);\n        tomcat.getHost().setAppBase(docBase);\n        tomcat.enableNaming();\n        \n        // ... etc\n    }\n}\n</code></pre>\n<p>The content of <code>pom.xml</code>:</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    &lt;groupId&gt;My.app&lt;/groupId&gt;\n    &lt;artifactId&gt;My.app&lt;/artifactId&gt;\n    &lt;version&gt;0.1&lt;/version&gt;\n    &lt;packaging&gt;war&lt;/packaging&gt;\n\n\n    &lt;properties&gt;\n        &lt;maven.compiler.source&gt;17&lt;/maven.compiler.source&gt;\n        &lt;maven.compiler.target&gt;17&lt;/maven.compiler.target&gt;\n        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\n        &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;\n\n        &lt;spring.version&gt;7.0.0-M7&lt;/spring.version&gt;\n        &lt;snakeyaml.version&gt;2.4&lt;/snakeyaml.version&gt;\n        &lt;tomcat.version&gt;9.0.104&lt;/tomcat.version&gt;\n        \n        &lt;maven-compiler-plugin.version&gt;3.13.0&lt;/maven-compiler-plugin.version&gt;\n        &lt;maven-war-plugin.version&gt;3.4.0&lt;/maven-war-plugin.version&gt;\n        &lt;maven-jar-plugin.version&gt;3.4.2&lt;/maven-jar-plugin.version&gt;\n        &lt;jacoco.version&gt;0.8.12&lt;/jacoco.version&gt;\n    &lt;/properties&gt;\n\n\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-aop&lt;/artifactId&gt;\n            &lt;version&gt;${spring.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n        \n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-core&lt;/artifactId&gt;\n            &lt;version&gt;${spring.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n        \n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-context&lt;/artifactId&gt;\n            &lt;version&gt;${spring.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n        \n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-expression&lt;/artifactId&gt;\n            &lt;version&gt;${spring.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n        \n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-web&lt;/artifactId&gt;\n            &lt;version&gt;${spring.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n        \n        &lt;dependency&gt;\n            &lt;groupId&gt;org.yaml&lt;/groupId&gt;\n            &lt;artifactId&gt;snakeyaml&lt;/artifactId&gt;\n            &lt;version&gt;${snakeyaml.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n        \n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt;\n            &lt;artifactId&gt;tomcat-embed-core&lt;/artifactId&gt;\n            &lt;version&gt;${tomcat.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt;\n            &lt;artifactId&gt;tomcat-embed-el&lt;/artifactId&gt;\n            &lt;version&gt;${tomcat.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt;\n            &lt;artifactId&gt;tomcat-embed-jasper&lt;/artifactId&gt;\n            &lt;version&gt;9.0.44&lt;/version&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n    \n    \n    \n    \n    &lt;build&gt;\n            &lt;plugins&gt;\n                &lt;plugin&gt;\n                    &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\n                    &lt;version&gt;${maven-compiler-plugin.version}&lt;/version&gt;\n                &lt;/plugin&gt;\n                \n                &lt;plugin&gt;\n                    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                    &lt;artifactId&gt;maven-jar-plugin&lt;/artifactId&gt;\n                    &lt;version&gt;${maven-jar-plugin.version}&lt;/version&gt;\n                &lt;/plugin&gt;\n                \n                &lt;plugin&gt;\n                    &lt;artifactId&gt;maven-war-plugin&lt;/artifactId&gt;\n                    &lt;version&gt;${maven-war-plugin.version}&lt;/version&gt;\n                    &lt;configuration&gt;\n                        &lt;archiveClasses&gt;true&lt;/archiveClasses&gt;\n                        &lt;webXml&gt;src/main/webapp/WEB-INF/web.xml&lt;/webXml&gt;\n                        &lt;failOnMissingWebXml&gt;false&lt;/failOnMissingWebXml&gt;\n                        &lt;archive&gt;\n                            &lt;manifest&gt;\n                                &lt;addDefaultImplementationEntries&gt;true&lt;/addDefaultImplementationEntries&gt;\n                                &lt;addClasspath&gt;true&lt;/addClasspath&gt;\n                                &lt;!-- within the .war the dependencies are stored under  WEB-INF/lib. The ClassPath entries in MANIFEST.MF will be prefixed with this. --&gt;\n                                &lt;classpathPrefix&gt;WEB-INF/lib/&lt;/classpathPrefix&gt;\n                            &lt;/manifest&gt;\n                            &lt;manifestEntries&gt;\n                                &lt;Build-Label&gt;${project.version}&lt;/Build-Label&gt;\n                                &lt;Build-Time&gt;${maven.build.timestamp}&lt;/Build-Time&gt;\n                                &lt;!-- within the .war the compiled Java classes of My.App are stored under  WEB-INF/classes. --&gt;\n                                &lt;Class-Path&gt;WEB-INF/classes/&lt;/Class-Path&gt;\n                                &lt;Main-Class&gt;My.App&lt;/Main-Class&gt;\n                            &lt;/manifestEntries&gt;\n                        &lt;/archive&gt;\n                    &lt;/configuration&gt;\n                &lt;/plugin&gt;\n\n                &lt;plugin&gt;\n                    &lt;groupId&gt;org.jacoco&lt;/groupId&gt;\n                    &lt;artifactId&gt;jacoco-maven-plugin&lt;/artifactId&gt;\n                    &lt;version&gt;${jacoco.version}&lt;/version&gt;\n                &lt;/plugin&gt;\n            &lt;/plugins&gt;\n            \n            \n            &lt;!-- location of logback.xml; used by Junit tests --&gt;\n            &lt;resources&gt;\n                &lt;resource&gt;\n                    &lt;directory&gt;src/test/config&lt;/directory&gt;\n                &lt;/resource&gt;\n            &lt;/resources&gt;\n    &lt;/build&gt;\n\n\n    &lt;profiles&gt;\n        &lt;profile&gt;\n            &lt;id&gt;coverage&lt;/id&gt;\n            &lt;build&gt;\n                &lt;plugins&gt;\n                    &lt;plugin&gt;\n                        &lt;groupId&gt;org.jacoco&lt;/groupId&gt;\n                        &lt;artifactId&gt;jacoco-maven-plugin&lt;/artifactId&gt;\n                        &lt;executions&gt;\n                            &lt;execution&gt;\n                                &lt;id&gt;prepare-agent&lt;/id&gt;\n                                &lt;goals&gt;\n                                    &lt;goal&gt;prepare-agent&lt;/goal&gt;\n                                &lt;/goals&gt;\n                            &lt;/execution&gt;\n                            &lt;execution&gt;\n                                &lt;id&gt;report&lt;/id&gt;\n                                &lt;goals&gt;\n                                    &lt;goal&gt;report&lt;/goal&gt;\n                                &lt;/goals&gt;\n                            &lt;/execution&gt;\n                        &lt;/executions&gt;\n                    &lt;/plugin&gt;\n                &lt;/plugins&gt;\n            &lt;/build&gt;\n        &lt;/profile&gt;\n    &lt;/profiles&gt;\n&lt;/project&gt;\n</code></pre>\n",
    "tags" : [ "java", "maven", "tomcat", "package" ],
    "owner" : {
      "account_id" : 3074494,
      "reputation" : 143,
      "user_id" : 2604243,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/b7a8dbfe7ed687ae22c52508697498db?s=256&d=identicon&r=PG",
      "display_name" : "deemon",
      "link" : "https://stackoverflow.com/users/2604243/deemon"
    },
    "is_answered" : true,
    "view_count" : 108,
    "answer_count" : 3,
    "score" : 1,
    "last_activity_date" : 1763641251,
    "creation_date" : 1763054641,
    "link" : "https://stackoverflow.com/questions/79819231/building-a-war-package-that-can-be-deployed-under-tomcat-and-can-be-executed-in",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79820210,
    "question_id" : 79819231,
    "body" : "<p>This is a Proof of Concept (PoC) test.</p>\n<ul>\n<li>It is based on a Spring Boot 3.5.7 WAR file.</li>\n<li>It can be executed as a standalone application using the <code>java -jar demo.war</code> command. (Spring Boot Executable WAR)</li>\n<li>It can also be deployed to an external Tomcat Server 10.1. (Jakarta EE Web 10 compatible)</li>\n<li>This example, as a Proof of Concept, is limited to demonstrating the following functionalities: JSP, Spring MVC, HTTP Servlet, and REST Controller.</li>\n</ul>\n<p>Note:</p>\n<p>Please note that Spring Boot 3.5.7 is based on Jakarta EE 10.</p>\n<p>Consequently, package names for components like HttpServlet must use jakarta.servlet instead of the older javax.servlet. You must use the jakarta.xxx package namespace and avoid the deprecated javax.xxx packages.</p>\n<p>(The exception is DataSource, which still uses the javax package namespace.)</p>\n<p>Based on the reasons mentioned above, the WAR file produced by this project must be deployed on Tomcat Server 10.1 and cannot be deployed on Tomcat Server 9, as Tomcat 9 does not support Jakarta EE Web 10.</p>\n<h1>Project Tree</h1>\n<pre class=\"lang-bash prettyprint-override\"><code>demo-web-war\n├── pom.xml\n└── src\n    └── main\n        ├── java\n        │   └── com\n        │       └── example\n        │           ├── DemoWebWarApplication.java\n        │           ├── controller\n        │           │   └── HelloJSPController.java\n        │           ├── restcontroller\n        │           │   └── HelloRestController.java\n        │           └── servlet\n        │               └── HelloServlet.java\n        ├── resources\n        │   └── application.properties\n        └── webapp\n            ├── index.jsp\n            └── WEB-INF\n                └── jsp\n                    └── hello.jsp\n</code></pre>\n<h2>pom.xml</h2>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n    xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    &lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;3.5.7&lt;/version&gt;\n        &lt;relativePath/&gt;\n    &lt;/parent&gt;\n    &lt;groupId&gt;com.example&lt;/groupId&gt;\n    &lt;artifactId&gt;demo-web-war&lt;/artifactId&gt;\n    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n    &lt;packaging&gt;war&lt;/packaging&gt;\n    &lt;name&gt;demo-web-war&lt;/name&gt;\n    &lt;description&gt;Demo project for Spring Boot&lt;/description&gt;\n    &lt;properties&gt;\n            &lt;maven.compiler.source&gt;17&lt;/maven.compiler.source&gt;\n                &lt;maven.compiler.target&gt;17&lt;/maven.compiler.target&gt;\n                &lt;maven.compiler.encoding&gt;UTF-8&lt;/maven.compiler.encoding&gt;\n                &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\n                &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;\n    &lt;/properties&gt;\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;\n            &lt;scope&gt;provided&lt;/scope&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt;\n            &lt;artifactId&gt;tomcat-embed-jasper&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;jakarta.servlet&lt;/groupId&gt;\n            &lt;artifactId&gt;jakarta.servlet-api&lt;/artifactId&gt;\n            &lt;scope&gt;provided&lt;/scope&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;\n            &lt;artifactId&gt;commons-text&lt;/artifactId&gt;\n            &lt;version&gt;1.14.0&lt;/version&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n\n    &lt;build&gt;\n    &lt;finalName&gt;demo&lt;/finalName&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n\n&lt;/project&gt;\n</code></pre>\n<h2>DemoWebWarApplication.java</h2>\n<pre class=\"lang-java prettyprint-override\"><code>package com.example;\n\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\nimport org.springframework.boot.builder.SpringApplicationBuilder;\nimport org.springframework.boot.web.servlet.ServletComponentScan;\nimport org.springframework.boot.web.servlet.support.SpringBootServletInitializer;\n\n@ServletComponentScan({&quot;com.example.servlet&quot;})\n@SpringBootApplication\npublic class DemoWebWarApplication extends SpringBootServletInitializer {\n\n    final static Logger log = LoggerFactory.getLogger(DemoWebWarApplication.class);\n\n    public static void main(String[] args) {\n        log.info(&quot;&gt;&gt;&gt; before SpringApplication.run&quot;);\n        SpringApplication.run(DemoWebWarApplication.class, args);\n        log.info(&quot;&gt;&gt;&gt; after SpringApplication.run&quot;);\n    }\n\n    @Override\n    protected SpringApplicationBuilder configure(SpringApplicationBuilder application) {\n        log.info(&quot;&gt;&gt;&gt; DemoWebWarApplication configure&quot;);\n        return application.sources(DemoWebWarApplication.class);\n    }\n\n}\n</code></pre>\n<h2>HelloJSPController.java</h2>\n<ul>\n<li>SpringMVC</li>\n</ul>\n<pre class=\"lang-java prettyprint-override\"><code>package com.example.controller;\n\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.stereotype.Controller;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RequestMethod;\nimport org.springframework.web.servlet.ModelAndView;\nimport java.util.Map;\n\n@Controller\npublic class HelloJSPController {\n\n    final static Logger log = LoggerFactory.getLogger(HelloJSPController.class);\n\n    @RequestMapping(value = &quot;/hellojsp&quot;, method = RequestMethod.GET)\n    public ModelAndView hello(Map&lt;String, Object&gt; model) {\n\n        log.info(&quot;&gt;&gt;&gt; HelloJSP Controller hello&quot;);\n\n        model.put(&quot;message&quot;, &quot;HelloJSP Controller hello&quot;);\n\n        // /WEB-INF/jsp/hello.jsp\n        return new ModelAndView(&quot;hello&quot;);\n    }\n}\n</code></pre>\n<h2>HelloRestController.java</h2>\n<ul>\n<li>Rest Controller</li>\n</ul>\n<pre class=\"lang-java prettyprint-override\"><code>package com.example.restcontroller;\n\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.PathVariable;\nimport org.springframework.web.bind.annotation.RequestParam;\nimport org.springframework.web.bind.annotation.RestController;\n\n@RestController\npublic class HelloRestController {\n    final static Logger log = LoggerFactory.getLogger(HelloRestController.class);\n\n    @GetMapping(&quot;/api/hello/{name}&quot;)\n    public String sayHello(\n            @PathVariable String name,\n            @RequestParam(value = &quot;greeting&quot;, defaultValue = &quot;Hello&quot;) String greeting) {\n        log.info(&quot;&gt;&gt;&gt; name = {} , greeting = {}&quot;, name, greeting);\n        return String.format(&quot;%s, %s!&quot;, greeting, name);\n    }\n}\n</code></pre>\n<h2>HelloServlet.java</h2>\n<ul>\n<li>HttpServlet</li>\n</ul>\n<pre class=\"lang-java prettyprint-override\"><code>package com.example.servlet;\n\nimport jakarta.servlet.ServletException;\nimport jakarta.servlet.annotation.WebServlet;\nimport jakarta.servlet.http.HttpServlet;\nimport jakarta.servlet.http.HttpServletRequest;\nimport jakarta.servlet.http.HttpServletResponse;\nimport java.io.IOException;\nimport java.io.PrintWriter;\nimport java.time.LocalDateTime;\nimport java.time.format.DateTimeFormatter;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\n@WebServlet(&quot;/helloServlet&quot;)\npublic class HelloServlet extends HttpServlet {\n\n    final static Logger log = LoggerFactory.getLogger(HelloServlet.class);\n\n    private static final DateTimeFormatter FORMATTER =\n            DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd HH:mm:ss&quot;);\n\n    public HelloServlet() {\n        super();\n        log.info(&quot;&gt;&gt;&gt; HelloServlet()&quot;);\n    }\n\n    /**\n     * process HTTP GET request\n     */\n    @Override\n    protected void doGet(HttpServletRequest request, HttpServletResponse response)\n            throws ServletException, IOException {\n        log.info(&quot;&gt;&gt;&gt; doGet&quot;);\n        processRequest(request, response);\n    }\n\n    /**\n     * process HTTP POST request\n     */\n    @Override\n    protected void doPost(HttpServletRequest request, HttpServletResponse response)\n            throws ServletException, IOException {\n        log.info(&quot;&gt;&gt;&gt; doPost&quot;);\n        processRequest(request, response);\n    }\n\n    private void processRequest(HttpServletRequest request, HttpServletResponse response)\n            throws IOException {\n        response.setContentType(&quot;text/html;charset=UTF-8&quot;);\n\n        // 2. optional parameter 'msg'\n        // if parameter msg is null, then empty string\n        String message = request.getParameter(&quot;msg&quot;);\n        log.info(&quot;&gt;&gt;&gt; msg = {}&quot;, message);\n        if (message == null) {\n            message = &quot;&quot;;\n        } else {\n            message = org.apache.commons.text.StringEscapeUtils.escapeHtml4(message);\n        }\n        log.info(&quot;&gt;&gt;&gt; message = {}&quot;, message);\n\n        // 3. get currentTime\n        String currentTime = LocalDateTime.now().format(FORMATTER);\n        log.info(&quot;&gt;&gt;&gt; currentTime = {}&quot;, currentTime);\n\n        // 4. create response\n        try (PrintWriter out = response.getWriter()) {\n            out.println(&quot;&lt;!DOCTYPE html&gt;&quot;);\n            out.println(&quot;&lt;html&gt;&quot;);\n            out.println(&quot;&lt;head&gt;&quot;);\n            out.println(&quot;&lt;meta charset=\\&quot;UTF-8\\&quot;&gt;&quot;);\n            out.println(&quot;&lt;title&gt;Hello Servlet Output&lt;/title&gt;&quot;);\n            out.println(&quot;&lt;style&gt;&quot;);\n            out.println(&quot;.red { color: red; }&quot;);\n            out.println(&quot;&lt;/style&gt;&quot;);\n            out.println(&quot;&lt;/head&gt;&quot;);\n            out.println(&quot;&lt;body&gt;&quot;);\n            out.println(&quot;&lt;h1&gt;&quot;);\n            out.println(&quot;Hello &quot;);\n            out.println(&quot;&lt;span class=\\&quot;red\\&quot;&gt;&quot; + message + &quot;&lt;/span&gt; &quot;);\n            out.println(&quot;at &quot; + currentTime);\n            out.println(&quot;&lt;/h1&gt;&quot;);\n            out.println(&quot;&lt;/body&gt;&quot;);\n            out.println(&quot;&lt;/html&gt;&quot;);\n        }\n    }\n}\n</code></pre>\n<h2>application.properties</h2>\n<pre class=\"lang-bash prettyprint-override\"><code>spring.application.name=demo-web-war\nspring.mvc.view.prefix=/WEB-INF/jsp/\nspring.mvc.view.suffix=.jsp\n</code></pre>\n<h2>index.jsp</h2>\n<ul>\n<li>jsp</li>\n</ul>\n<pre class=\"lang-jsp prettyprint-override\"><code>&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;\n    pageEncoding=&quot;UTF-8&quot;%&gt;\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;\n&lt;style&gt;\n.color-red {\n    color: red;\n}\n&lt;/style&gt;\n&lt;title&gt;Home&lt;/title&gt;\n&lt;/head&gt;\n&lt;%\n// debug\nSystem.out.println(&quot;webapp / index.jsp &quot;);\n%&gt;\n&lt;body&gt;\n   &lt;h1 class=&quot;color-red&quot;&gt;SpringBoot index.jsp!&lt;/h1&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n<h2>hello.jsp</h2>\n<ul>\n<li>Spring MVC</li>\n</ul>\n<pre class=\"lang-jsp prettyprint-override\"><code>&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;\n    pageEncoding=&quot;UTF-8&quot;%&gt;\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;\n&lt;title&gt;Hello&lt;/title&gt;\n&lt;style&gt;\n.color-red {\n    color: red;\n}\n&lt;/style&gt;\n&lt;/head&gt;\n&lt;%\n// debug\nSystem.out.println(&quot;webapp / WEB-INF / jsp / hello.jsp &quot;);\n%&gt;\n&lt;body&gt;\n    &lt;h1 class=&quot;color-red&quot;&gt;SpringBoot hello.jsp!!  ${message} &lt;/h1&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n<h1>Build</h1>\n<pre class=\"lang-bash prettyprint-override\"><code>mvn clean package\n</code></pre>\n<h1>Run in command line</h1>\n<pre class=\"lang-bash prettyprint-override\"><code>java -jar target/demo.war\n</code></pre>\n<h2>Test</h2>\n<p>Open Browser</p>\n<h3>Test 1 - JSP</h3>\n<p>http://localhost:8080/index.jsp</p>\n<h3>Test 2 - Spring MVC</h3>\n<p>http://localhost:8080/hellojsp</p>\n<h3>Test 3 - Rest Controller</h3>\n<p>http://localhost:8080/api/hello/WORLD</p>\n<h3>Test 4 - Http Servlet</h3>\n<p>http://localhost:8080/helloServlet</p>\n<p>http://localhost:8080/helloServlet?msg=World</p>\n<pre class=\"lang-bash prettyprint-override\"><code>curl -X POST -d &quot;msg=John&quot; http://localhost:8080/helloServlet\n</code></pre>\n<h1>On Tomcat Server</h1>\n<p>copy demo.war into TomcatServer/webapps</p>\n<p>Since the WAR file is named demo.war, its context path on the Tomcat Server will automatically be <code>/demo</code>.</p>\n<h2>Test</h2>\n<p>Open Browser</p>\n<h3>Test 1 - JSP</h3>\n<p>http://localhost:8080/demo/index.jsp</p>\n<h3>Test 2 - Spring MVC</h3>\n<p>http://localhost:8080/demo/hellojsp</p>\n<h3>Test 3 - Rest Controller</h3>\n<p>http://localhost:8080/demo/api/hello/WORLD</p>\n<h3>Test 4 - Http Servlet</h3>\n<p>http://localhost:8080/demo/helloServlet</p>\n<p>http://localhost:8080/demo/helloServlet?msg=World</p>\n<pre class=\"lang-bash prettyprint-override\"><code>curl -X POST -d &quot;msg=John&quot; http://localhost:8080/demo/helloServlet\n</code></pre>\n",
    "score" : 1,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 26698569,
      "reputation" : 4090,
      "user_id" : 20306007,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/98bbc403493aee3681b71dae7abef66e?s=256&d=identicon&r=PG",
      "display_name" : "life888888",
      "link" : "https://stackoverflow.com/users/20306007/life888888"
    },
    "creation_date" : 1763135361,
    "last_activity_date" : 1763135361,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79825512,
    "question_id" : 79819231,
    "body" : "<p>Answer version 3,</p>\n<p>Merge with velocity-tools simple example</p>\n<h1>How can I obtain the velocity-tools jar file converted to a Jakarta package namespace?</h1>\n<h2>Step 1: Obtain the velocity-tools file</h2>\n<p>Open <a href=\"https://github.com/apache/velocity-tools\" rel=\"nofollow noreferrer\">https://github.com/apache/velocity-tools</a> in your browser.</p>\n<p>Click [Code] -&gt; Download ZIP, get <code>velocity-tools-master.zip</code></p>\n<h2>Step 2: Unzip <code>velocity-tools-master.zip</code></h2>\n<h2>Step 3: Modify <code>pom.xml</code></h2>\n<p>Find the directory velocity-tools-master/velocity-tools-examples/velocity-tools-examples-simple</p>\n<p>edit <code>pom.xml</code></p>\n<p>Find dependency blocks <code>velocity-tools-view</code> and <code>velocity-tools-view-jsp</code></p>\n<p>Change <code>&lt;version&gt;${project.version}&lt;/version&gt;</code> to <code>&lt;version&gt;3.1&lt;/version&gt;</code></p>\n<pre class=\"lang-xml prettyprint-override\"><code>    &lt;dependency&gt;\n      &lt;groupId&gt;org.apache.velocity.tools&lt;/groupId&gt;\n      &lt;artifactId&gt;velocity-tools-view&lt;/artifactId&gt;\n      &lt;version&gt;3.1&lt;/version&gt;\n      &lt;scope&gt;runtime&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.apache.velocity.tools&lt;/groupId&gt;\n      &lt;artifactId&gt;velocity-tools-view-jsp&lt;/artifactId&gt;\n      &lt;version&gt;3.1&lt;/version&gt;      \n      &lt;scope&gt;runtime&lt;/scope&gt;\n    &lt;/dependency&gt;\n</code></pre>\n<h2>Step 4: Build</h2>\n<p>Then in the <code>velocity-tools-examples-simple</code> directory</p>\n<p>execution command.</p>\n<pre class=\"lang-bash prettyprint-override\"><code>mvn clean package\n</code></pre>\n<p>Generate <code>target/velocity-tools-examples-simple-3.3-SNAPSHOT.war</code></p>\n<h2>Step 5: Rename the WAR file</h2>\n<p>Rename <code>velocity-tools-examples-simple-3.3-SNAPSHOT.war</code> to <code>velocity-tools-examples-simple.war</code></p>\n<h2>Step 6: Deploy velocity-tools-examples-simple.war to Tomcat Server 10.1</h2>\n<p>In the Tomcat Server 10.1 directory, create a directory named webapps-javaee.</p>\n<p>Place <code>velocity-tools-examples-simple.war</code> in the <code>tomcat/webapps-javaee</code> directory.</p>\n<p>Start Tomcat Server 10.1</p>\n<pre class=\"lang-bash prettyprint-override\"><code>cd tomcat/bin\n./startup.sh\n</code></pre>\n<p>You can find it in tomcat/webapps/velocity-tools-examples-simple/WEB-INF/lib</p>\n<pre class=\"lang-bash prettyprint-override\"><code>velocity-engine-core-2.4.jar    \nvelocity-tools-generic-3.1.jar  \nvelocity-tools-view-3.1.jar\nvelocity-tools-view-jsp-3.1.jar\n</code></pre>\n<p>Copy them to the <code>velocity-jakarta-libs</code> directory.</p>\n<h2>Step 7: Install the velocity-jakarta jar to your local repository directory (~/.m2).</h2>\n<p>Execute the following instructions:</p>\n<pre class=\"lang-bash prettyprint-override\"><code>cd velocity-jakarta-libs\n\nmvn install:install-file \\\n  -Dfile=velocity-engine-core-2.4.jar \\\n  -DgroupId=org.apache.velocity \\\n  -DartifactId=velocity-engine-core \\\n  -Dversion=2.4 \\\n  -Dpackaging=jar \\\n  -Dclassifier=jakarta\n  \nmvn install:install-file \\\n  -Dfile=velocity-tools-generic-3.1.jar \\\n  -DgroupId=org.apache.velocity \\\n  -DartifactId=velocity-tools-generic \\\n  -Dversion=3.1 \\\n  -Dpackaging=jar \\\n  -Dclassifier=jakarta\n\nmvn install:install-file \\\n  -Dfile=velocity-tools-view-3.1.jar \\\n  -DgroupId=org.apache.velocity \\\n  -DartifactId=velocity-tools-view \\\n  -Dversion=3.1 \\\n  -Dpackaging=jar \\\n  -Dclassifier=jakarta    \n\nmvn install:install-file \\\n  -Dfile=velocity-tools-view-jsp-3.1.jar \\\n  -DgroupId=org.apache.velocity \\\n  -DartifactId=velocity-tools-view-jsp \\\n  -Dversion=3.1 \\\n  -Dpackaging=jar \\\n  -Dclassifier=jakarta  \n</code></pre>\n<p>They will be installed under your Maven local repo: <code>~/.m2</code></p>\n<p>Now your Spring Boot Application can reference the modified Velocity Jakarta library.</p>\n<pre class=\"lang-xml prettyprint-override\"><code>    &lt;dependency&gt;\n        &lt;groupId&gt;org.apache.velocity&lt;/groupId&gt;\n        &lt;artifactId&gt;velocity-engine-core&lt;/artifactId&gt;\n        &lt;version&gt;2.4&lt;/version&gt;\n        &lt;classifier&gt;jakarta&lt;/classifier&gt;\n    &lt;/dependency&gt;\n    \n    &lt;dependency&gt;\n        &lt;groupId&gt;org.apache.velocity&lt;/groupId&gt;\n        &lt;artifactId&gt;velocity-tools-generic&lt;/artifactId&gt;\n        &lt;version&gt;3.1&lt;/version&gt;\n        &lt;classifier&gt;jakarta&lt;/classifier&gt;\n    &lt;/dependency&gt;\n    \n    &lt;dependency&gt;\n        &lt;groupId&gt;org.apache.velocity&lt;/groupId&gt;\n        &lt;artifactId&gt;velocity-tools-view&lt;/artifactId&gt;\n        &lt;version&gt;3.1&lt;/version&gt;\n        &lt;classifier&gt;jakarta&lt;/classifier&gt;\n    &lt;/dependency&gt;\n    \n    &lt;dependency&gt;\n        &lt;groupId&gt;org.apache.velocity&lt;/groupId&gt;\n        &lt;artifactId&gt;velocity-tools-view-jsp&lt;/artifactId&gt;\n        &lt;version&gt;3.1&lt;/version&gt;\n        &lt;classifier&gt;jakarta&lt;/classifier&gt;\n    &lt;/dependency&gt;\n</code></pre>\n<p>The contents of velocity-tools-examples-simple are now being merged into the Spring Boot 3.5.7 project (demo-web-velocity-tools-examples-simple-war).</p>\n<p>This is a Proof of Concept (PoC) test.</p>\n<ul>\n<li>It is based on a Spring Boot 3.5.7 WAR file.</li>\n<li>It can be executed as a standalone application using the <code>java -jar demo.war</code> command. (Spring Boot Executable WAR)</li>\n<li>It can also be deployed to an external Tomcat Server 10.1. (Jakarta EE Web 10 compatible)</li>\n<li>This example, as a Proof of Concept, is limited to demonstrating the following functionalities: JSP, Spring MVC, HTTP Servlet, and REST Controller.</li>\n</ul>\n<p>Note:</p>\n<p>Please note that Spring Boot 3.5.7 is based on Jakarta EE 10.</p>\n<p>Consequently, package names for components like HttpServlet must use jakarta.servlet instead of the older javax.servlet. You must use the jakarta.xxx package namespace and avoid the deprecated javax.xxx packages.</p>\n<p>(The exception is DataSource, which still uses the javax package namespace.)</p>\n<p>Based on the reasons mentioned above, the WAR file produced by this project must be deployed on Tomcat Server 10.1 and cannot be deployed on Tomcat Server 9, as Tomcat 9 does not support Jakarta EE Web 10.</p>\n<h1>Project Tree</h1>\n<pre class=\"lang-bash prettyprint-override\"><code>demo-web-velocity-tools-examples-simple-war\n├── pom.xml\n└── src\n    └── main\n        ├── java\n        │   └── com\n        │       └── example\n        │           ├── config\n        │           │   └── VelocityServletConfig.java\n        │           ├── controller\n        │           │   ├── HelloJSPController.java\n        │           │   └── WelcomeController.java\n        │           ├── DemoWebWarApplication.java\n        │           ├── restcontroller\n        │           │   └── HelloRestController.java\n        │           ├── servlet\n        │           │   └── HelloServlet.java\n        │           └── simple\n        │               └── HelloMessage.java\n        ├── resources\n        │   └── application.properties\n        └── webapp\n            ├── index.jsp\n            ├── indexVelocity.jsp\n            ├── index.vm\n            └── WEB-INF\n                ├── jsp\n                │   └── hello.jsp\n                └── tools.xml\n</code></pre>\n<h2>pom.xml</h2>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n    xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    &lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;3.5.7&lt;/version&gt;\n        &lt;relativePath/&gt;\n    &lt;/parent&gt;\n    &lt;groupId&gt;com.example&lt;/groupId&gt;\n    &lt;artifactId&gt;demo-web-velocity-tools-examples-simple-war&lt;/artifactId&gt;\n    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n    &lt;packaging&gt;war&lt;/packaging&gt;\n    &lt;name&gt;demo-web-velocity-tools-examples-simple-war&lt;/name&gt;\n    &lt;description&gt;Demo project for Spring Boot&lt;/description&gt;\n    &lt;properties&gt;\n            &lt;maven.compiler.source&gt;17&lt;/maven.compiler.source&gt;\n                &lt;maven.compiler.target&gt;17&lt;/maven.compiler.target&gt;\n                &lt;maven.compiler.encoding&gt;UTF-8&lt;/maven.compiler.encoding&gt;\n                &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\n                &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;\n    &lt;/properties&gt;\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;\n            &lt;scope&gt;provided&lt;/scope&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt;\n            &lt;artifactId&gt;tomcat-embed-jasper&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;jakarta.servlet&lt;/groupId&gt;\n            &lt;artifactId&gt;jakarta.servlet-api&lt;/artifactId&gt;\n            &lt;scope&gt;provided&lt;/scope&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;\n            &lt;artifactId&gt;commons-text&lt;/artifactId&gt;\n            &lt;version&gt;1.14.0&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.velocity&lt;/groupId&gt;\n            &lt;artifactId&gt;velocity-engine-core&lt;/artifactId&gt;\n            &lt;version&gt;2.4&lt;/version&gt;\n            &lt;classifier&gt;jakarta&lt;/classifier&gt;\n        &lt;/dependency&gt;\n    \n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.velocity&lt;/groupId&gt;\n            &lt;artifactId&gt;velocity-tools-generic&lt;/artifactId&gt;\n            &lt;version&gt;3.1&lt;/version&gt;\n            &lt;classifier&gt;jakarta&lt;/classifier&gt;\n        &lt;/dependency&gt;\n    \n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.velocity&lt;/groupId&gt;\n            &lt;artifactId&gt;velocity-tools-view&lt;/artifactId&gt;\n            &lt;version&gt;3.1&lt;/version&gt;\n            &lt;classifier&gt;jakarta&lt;/classifier&gt;\n        &lt;/dependency&gt;    \n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.velocity&lt;/groupId&gt;\n            &lt;artifactId&gt;velocity-tools-view-jsp&lt;/artifactId&gt;\n            &lt;version&gt;3.1&lt;/version&gt;\n            &lt;classifier&gt;jakarta&lt;/classifier&gt;\n        &lt;/dependency&gt;\n            \n    &lt;/dependencies&gt;\n\n    &lt;build&gt;\n    &lt;finalName&gt;demo&lt;/finalName&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n\n&lt;/project&gt;\n</code></pre>\n<h2>DemoWebWarApplication.java</h2>\n<pre class=\"lang-java prettyprint-override\"><code>package com.example;\n\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\nimport org.springframework.boot.builder.SpringApplicationBuilder;\nimport org.springframework.boot.web.servlet.ServletComponentScan;\nimport org.springframework.boot.web.servlet.support.SpringBootServletInitializer;\n\n@ServletComponentScan({&quot;com.example.servlet&quot;})\n@SpringBootApplication\npublic class DemoWebWarApplication extends SpringBootServletInitializer {\n\n    final static Logger log = LoggerFactory.getLogger(DemoWebWarApplication.class);\n\n    public static void main(String[] args) {\n        log.info(&quot;&gt;&gt;&gt; before SpringApplication.run&quot;);\n        SpringApplication.run(DemoWebWarApplication.class, args);\n        log.info(&quot;&gt;&gt;&gt; after SpringApplication.run&quot;);\n    }\n\n    @Override\n    protected SpringApplicationBuilder configure(SpringApplicationBuilder application) {\n        log.info(&quot;&gt;&gt;&gt; DemoWebWarApplication configure&quot;);\n        return application.sources(DemoWebWarApplication.class);\n    }\n\n}\n</code></pre>\n<h1>WelcomeController.java</h1>\n<ul>\n<li>set default page to index.jsp</li>\n</ul>\n<pre class=\"lang-java prettyprint-override\"><code>package com.example.controller;\n\nimport org.springframework.stereotype.Controller;\nimport org.springframework.web.bind.annotation.GetMapping;\n\n@Controller\npublic class WelcomeController {\n\n    @GetMapping(&quot;/&quot;)\n    public String home() {\n        return &quot;forward:/index.jsp&quot;;\n    }\n}\n</code></pre>\n<h2>HelloJSPController.java</h2>\n<ul>\n<li>SpringMVC</li>\n</ul>\n<pre class=\"lang-java prettyprint-override\"><code>package com.example.controller;\n\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.stereotype.Controller;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RequestMethod;\nimport org.springframework.web.servlet.ModelAndView;\nimport java.util.Map;\n\n@Controller\npublic class HelloJSPController {\n\n    final static Logger log = LoggerFactory.getLogger(HelloJSPController.class);\n\n    @RequestMapping(value = &quot;/hellojsp&quot;, method = RequestMethod.GET)\n    public ModelAndView hello(Map&lt;String, Object&gt; model) {\n\n        log.info(&quot;&gt;&gt;&gt; HelloJSP Controller hello&quot;);\n\n        model.put(&quot;message&quot;, &quot;HelloJSP Controller hello&quot;);\n\n        // /WEB-INF/jsp/hello.jsp\n        return new ModelAndView(&quot;hello&quot;);\n    }\n}\n</code></pre>\n<h2>HelloRestController.java</h2>\n<ul>\n<li>Rest Controller</li>\n</ul>\n<pre class=\"lang-java prettyprint-override\"><code>package com.example.restcontroller;\n\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.PathVariable;\nimport org.springframework.web.bind.annotation.RequestParam;\nimport org.springframework.web.bind.annotation.RestController;\n\n@RestController\npublic class HelloRestController {\n    final static Logger log = LoggerFactory.getLogger(HelloRestController.class);\n\n    @GetMapping(&quot;/api/hello/{name}&quot;)\n    public String sayHello(\n            @PathVariable String name,\n            @RequestParam(value = &quot;greeting&quot;, defaultValue = &quot;Hello&quot;) String greeting) {\n        log.info(&quot;&gt;&gt;&gt; name = {} , greeting = {}&quot;, name, greeting);\n        return String.format(&quot;%s, %s!&quot;, greeting, name);\n    }\n}\n</code></pre>\n<h2>HelloServlet.java</h2>\n<ul>\n<li>HttpServlet</li>\n</ul>\n<pre class=\"lang-java prettyprint-override\"><code>package com.example.servlet;\n\nimport jakarta.servlet.ServletException;\nimport jakarta.servlet.annotation.WebServlet;\nimport jakarta.servlet.http.HttpServlet;\nimport jakarta.servlet.http.HttpServletRequest;\nimport jakarta.servlet.http.HttpServletResponse;\nimport java.io.IOException;\nimport java.io.PrintWriter;\nimport java.time.LocalDateTime;\nimport java.time.format.DateTimeFormatter;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\n@WebServlet(&quot;/helloServlet&quot;)\npublic class HelloServlet extends HttpServlet {\n\n    final static Logger log = LoggerFactory.getLogger(HelloServlet.class);\n\n    private static final DateTimeFormatter FORMATTER =\n            DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd HH:mm:ss&quot;);\n\n    public HelloServlet() {\n        super();\n        log.info(&quot;&gt;&gt;&gt; HelloServlet()&quot;);\n    }\n\n    /**\n     * process HTTP GET request\n     */\n    @Override\n    protected void doGet(HttpServletRequest request, HttpServletResponse response)\n            throws ServletException, IOException {\n        log.info(&quot;&gt;&gt;&gt; doGet&quot;);\n        processRequest(request, response);\n    }\n\n    /**\n     * process HTTP POST request\n     */\n    @Override\n    protected void doPost(HttpServletRequest request, HttpServletResponse response)\n            throws ServletException, IOException {\n        log.info(&quot;&gt;&gt;&gt; doPost&quot;);\n        processRequest(request, response);\n    }\n\n    private void processRequest(HttpServletRequest request, HttpServletResponse response)\n            throws IOException {\n        response.setContentType(&quot;text/html;charset=UTF-8&quot;);\n\n        // 2. optional parameter 'msg'\n        // if parameter msg is null, then empty string\n        String message = request.getParameter(&quot;msg&quot;);\n        log.info(&quot;&gt;&gt;&gt; msg = {}&quot;, message);\n        if (message == null) {\n            message = &quot;&quot;;\n        } else {\n            message = org.apache.commons.text.StringEscapeUtils.escapeHtml4(message);\n        }\n        log.info(&quot;&gt;&gt;&gt; message = {}&quot;, message);\n\n        // 3. get currentTime\n        String currentTime = LocalDateTime.now().format(FORMATTER);\n        log.info(&quot;&gt;&gt;&gt; currentTime = {}&quot;, currentTime);\n\n        // 4. create response\n        try (PrintWriter out = response.getWriter()) {\n            out.println(&quot;&lt;!DOCTYPE html&gt;&quot;);\n            out.println(&quot;&lt;html&gt;&quot;);\n            out.println(&quot;&lt;head&gt;&quot;);\n            out.println(&quot;&lt;meta charset=\\&quot;UTF-8\\&quot;&gt;&quot;);\n            out.println(&quot;&lt;title&gt;Hello Servlet Output&lt;/title&gt;&quot;);\n            out.println(&quot;&lt;style&gt;&quot;);\n            out.println(&quot;.red { color: red; }&quot;);\n            out.println(&quot;&lt;/style&gt;&quot;);\n            out.println(&quot;&lt;/head&gt;&quot;);\n            out.println(&quot;&lt;body&gt;&quot;);\n            out.println(&quot;&lt;h1&gt;&quot;);\n            out.println(&quot;Hello &quot;);\n            out.println(&quot;&lt;span class=\\&quot;red\\&quot;&gt;&quot; + message + &quot;&lt;/span&gt; &quot;);\n            out.println(&quot;at &quot; + currentTime);\n            out.println(&quot;&lt;/h1&gt;&quot;);\n            out.println(&quot;&lt;/body&gt;&quot;);\n            out.println(&quot;&lt;/html&gt;&quot;);\n        }\n    }\n}\n</code></pre>\n<h2>HelloMessage.java</h2>\n<ul>\n<li>example for velocity</li>\n</ul>\n<pre class=\"lang-java prettyprint-override\"><code>package com.example.simple;\n\npublic class HelloMessage {\n    private String message = &quot;Hello from Spring Boot&quot;;\n\n    public String getMessage() {\n        return this.message;\n    }\n\n    public void setMessage(String message) {\n        this.message = message;\n    }\n\n}\n</code></pre>\n<h2>VelocityServletConfig.java</h2>\n<ul>\n<li>velocity config</li>\n</ul>\n<pre class=\"lang-java prettyprint-override\"><code>package com.example.config;\n\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\nimport org.apache.velocity.tools.view.VelocityViewServlet;\nimport org.springframework.boot.web.servlet.ServletRegistrationBean;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\n\n@Configuration\npublic class VelocityServletConfig {\n    final static Logger log = LoggerFactory.getLogger(VelocityServletConfig.class);\n    \n    @Bean\n    public ServletRegistrationBean&lt;VelocityViewServlet&gt; velocityServlet() {\n        log.info(&quot;velocityServlet()&quot;);\n        ServletRegistrationBean&lt;VelocityViewServlet&gt; bean =\n                new ServletRegistrationBean&lt;&gt;(new VelocityViewServlet(), &quot;*.vm&quot;);\n        bean.setName(&quot;velocity&quot;);\n        return bean;\n    }\n}\n</code></pre>\n<h2>application.properties</h2>\n<pre class=\"lang-bash prettyprint-override\"><code>spring.application.name=demo-web-war\nspring.mvc.view.prefix=/WEB-INF/jsp/\nspring.mvc.view.suffix=.jsp\n</code></pre>\n<h2>index.jsp</h2>\n<ul>\n<li>jsp</li>\n</ul>\n<pre class=\"lang-jsp prettyprint-override\"><code>&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;\n    pageEncoding=&quot;UTF-8&quot;%&gt;\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;\n&lt;style&gt;\n.color-red {\n    color: red;\n}\n&lt;/style&gt;\n&lt;title&gt;Home&lt;/title&gt;\n&lt;/head&gt;\n&lt;%\n// debug\nSystem.out.println(&quot;webapp / index.jsp &quot;);\n%&gt;\n&lt;body&gt;\n   &lt;h1 class=&quot;color-red&quot;&gt;SpringBoot index.jsp!&lt;/h1&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n<h2>indexVelocity.jsp</h2>\n<pre class=\"lang-jsp prettyprint-override\"><code>&lt;%@taglib prefix=&quot;velocity&quot; uri=&quot;http://velocity.apache.org/velocity-view&quot; %&gt;\n&lt;html&gt;\n&lt;body&gt;\n\nI'm a JSP file that uses the VelocityViewTag.\n\n&lt;velocity:view&gt;\n#if( $XHTML )\n  #set( $br = &quot;&lt;br /&gt;&quot; )\n#else\n  #set( $br = &quot;&lt;br&gt;&quot; )\n#end\n\n$br\n$br\n\nHere we use a custom tool: $hellomessage.message\n\n$br\n$br\n\nLets count : #foreach($i in [1..5])$i #end\n\n$br\n$br\n\nLet's play with a hashmap:$br\nfirst add foo: $map.put(&quot;foo&quot;,$foo)$br\nthen add bar: $map.put(&quot;bar&quot;,$bar)$br\n$br\nand that gives us $map\n\n$br\n$br\n\nHere we get the date from the DateTool:  $date.medium\n\n$br\n$br\n\n#if( $isSimple )\nThis is simple#if( $XHTML ) xhtml#end app version ${version}.\n#end\n\n$br\n$br\n\nClick &lt;a href=&quot;indexVelocity.vm&quot;&gt;here&lt;/a&gt; to see this VTL markup as a normal template.\n\n&lt;/velocity:view&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n<h2>indexVelocity.vm</h2>\n<pre class=\"lang-bash prettyprint-override\"><code>&lt;html&gt;\n&lt;body&gt;\n\nI'm a velocity template processed using the VelocityViewServlet.\n\n#if( $XHTML )\n  #set( $br = &quot;&lt;br /&gt;&quot; )\n#else\n  #set( $br = &quot;&lt;br&gt;&quot; )\n#end\n\n$br\n$br\n\nHere we use a custom tool: $hellomessage.message\n\n$br\n$br\n\nLets count : #foreach($i in [1..5])$i #end\n\n$br\n$br\n\nLet's play with a hashmap:$br\nfirst add foo: $map.put(&quot;foo&quot;,$foo)$br\nthen add bar: $map.put(&quot;bar&quot;,$bar)$br\n$br\nand that gives us $map\n\n$br\n$br\n\nHere we get the date from the DateTool:  $date.medium\n\n$br\n$br\n\n#if( $isSimple )\nThis is simple#if( $XHTML ) xhtml#end app version ${version}.\n#end\n\n$br\n$br\n\nClick &lt;a href=&quot;indexVelocity.jsp&quot;&gt;here&lt;/a&gt; to see the VelocityViewTag handle the same VTL markup.\n\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n<h2>hello.jsp</h2>\n<ul>\n<li>Spring MVC</li>\n</ul>\n<pre class=\"lang-jsp prettyprint-override\"><code>&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;\n    pageEncoding=&quot;UTF-8&quot;%&gt;\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;\n&lt;title&gt;Hello&lt;/title&gt;\n&lt;style&gt;\n.color-red {\n    color: red;\n}\n&lt;/style&gt;\n&lt;/head&gt;\n&lt;%\n// debug\nSystem.out.println(&quot;webapp / WEB-INF / jsp / hello.jsp &quot;);\n%&gt;\n&lt;body&gt;\n    &lt;h1 class=&quot;color-red&quot;&gt;SpringBoot hello.jsp!!  ${message} &lt;/h1&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n<h2>tools.xml</h2>\n<ul>\n<li>velocity simple example</li>\n</ul>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=&quot;1.0&quot;?&gt;\n\n&lt;tools&gt;\n    &lt;data type=&quot;boolean&quot; key=&quot;xhtml&quot; value=&quot;true&quot;/&gt;\n    &lt;data type=&quot;boolean&quot; key=&quot;isSimple&quot; value=&quot;true&quot;/&gt;\n    &lt;data type=&quot;number&quot; key=&quot;version&quot; value=&quot;2.0&quot;/&gt;\n    &lt;data key=&quot;foo&quot;&gt;this is foo&lt;/data&gt;\n    &lt;data key=&quot;bar&quot;&gt;this is bar.&lt;/data&gt;\n    &lt;toolbox scope=&quot;request&quot;&gt;\n        &lt;tool key=&quot;hellomessage&quot; class=&quot;com.example.simple.HelloMessage&quot; restrictTo=&quot;index*&quot;/&gt;\n    &lt;/toolbox&gt;\n    &lt;toolbox scope=&quot;session&quot;&gt;\n        &lt;tool key=&quot;map&quot; class=&quot;java.util.HashMap&quot;/&gt;\n    &lt;/toolbox&gt;\n&lt;/tools&gt;\n</code></pre>\n<h1>Build</h1>\n<pre class=\"lang-bash prettyprint-override\"><code>mvn clean package\n</code></pre>\n<h1>Run in command line</h1>\n<pre class=\"lang-bash prettyprint-override\"><code>java -jar target/demo.war\n</code></pre>\n<h2>Test</h2>\n<p>Open Browser</p>\n<h3>Test 1 - JSP</h3>\n<p>http://localhost:8080/index.jsp</p>\n<h3>Test 2 - Spring MVC</h3>\n<p>http://localhost:8080/hellojsp</p>\n<h3>Test 3 - Rest Controller</h3>\n<p>http://localhost:8080/api/hello/WORLD</p>\n<h3>Test 4 - Http Servlet</h3>\n<p>http://localhost:8080/helloServlet</p>\n<p>http://localhost:8080/helloServlet?msg=World</p>\n<pre class=\"lang-bash prettyprint-override\"><code>curl -X POST -d &quot;msg=John&quot; http://localhost:8080/helloServlet\n</code></pre>\n<h3>Test 5 - Velocity JSP</h3>\n<p>http://localhost:8080/indexVelocity.jsp</p>\n<h3>Test 6 - Velocity VM</h3>\n<p>http://localhost:8080/indexVelocity.vm</p>\n<h1>On Tomcat Server</h1>\n<p>copy demo.war into TomcatServer/webapps</p>\n<p>Since the WAR file is named demo.war, its context path on the Tomcat Server will automatically be <code>/demo</code>.</p>\n<h2>Test</h2>\n<p>Open Browser</p>\n<h3>Test 1 - JSP</h3>\n<p>http://localhost:8080/demo/index.jsp</p>\n<h3>Test 2 - Spring MVC</h3>\n<p>http://localhost:8080/demo/hellojsp</p>\n<h3>Test 3 - Rest Controller</h3>\n<p>http://localhost:8080/demo/api/hello/WORLD</p>\n<h3>Test 4 - Http Servlet</h3>\n<p>http://localhost:8080/demo/helloServlet</p>\n<p>http://localhost:8080/demo/helloServlet?msg=World</p>\n<pre class=\"lang-bash prettyprint-override\"><code>curl -X POST -d &quot;msg=John&quot; http://localhost:8080/demo/helloServlet\n</code></pre>\n<h3>Test 5 - Velocity JSP</h3>\n<p>http://localhost:8080/demo/indexVelocity.jsp</p>\n<h3>Test 6 - Velocity VM</h3>\n<p>http://localhost:8080/demo/indexVelocity.vm</p>\n<p>you can compare with the</p>\n<ul>\n<li><p>http://localhost:8080/velocity-tools-examples-simple/index.vm</p>\n</li>\n<li><p>http://localhost:8080/velocity-tools-examples-simple/index.jsp</p>\n</li>\n</ul>\n",
    "score" : 1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 26698569,
      "reputation" : 4090,
      "user_id" : 20306007,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/98bbc403493aee3681b71dae7abef66e?s=256&d=identicon&r=PG",
      "display_name" : "life888888",
      "link" : "https://stackoverflow.com/users/20306007/life888888"
    },
    "creation_date" : 1763641251,
    "last_activity_date" : 1763641251,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79822943,
    "question_id" : 79819231,
    "body" : "<p>Since you must be using Java EE in javax, Spring Boot 2.x is a must, and the accompanying JDK version must also be adjusted to JDK 11.</p>\n<p>The difference from the Spring Boot 3.x example is that the only modifications are made to pom.xml and HelloServlet.java.</p>\n<p>This is a Proof of Concept (PoC) test.</p>\n<ul>\n<li>It is based on a Spring Boot 2.7.18 WAR file.</li>\n<li>It can be executed as a standalone application using the <code>java -jar demo.war</code> command. (Spring Boot Executable WAR)</li>\n<li>It can also be deployed to an external Tomcat Server 9. (Java EE Web compatible)</li>\n<li>This example, as a Proof of Concept, is limited to demonstrating the following functionalities: JSP, Spring MVC, HTTP Servlet, and REST Controller.</li>\n<li>JDK 11</li>\n</ul>\n<p>Note:</p>\n<p>Please note that Spring Boot 2.7.18 is based on Java EE.</p>\n<p>JDK version must set 11 not 17.</p>\n<p>Consequently, package names for components like HttpServlet must use javax.servlet. You must use the javax.xxx  package namespace.</p>\n<p>Based on the reasons mentioned above, the WAR file produced by this project must be deployed on Tomcat Server 9.</p>\n<h1>Project Tree</h1>\n<pre class=\"lang-bash prettyprint-override\"><code>demo-web-war-JavaEE\n├── pom.xml\n└── src\n    └── main\n        ├── java\n        │   └── com\n        │       └── example\n        │           ├── DemoWebWarApplication.java\n        │           ├── controller\n        │           │   └── HelloJSPController.java\n        │           ├── restcontroller\n        │           │   └── HelloRestController.java\n        │           └── servlet\n        │               └── HelloServlet.java\n        ├── resources\n        │   └── application.properties\n        └── webapp\n            ├── index.jsp\n            └── WEB-INF\n                └── jsp\n                    └── hello.jsp\n</code></pre>\n<h2>pom.xml</h2>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n    xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    &lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;2.7.18&lt;/version&gt;\n        &lt;relativePath/&gt;\n    &lt;/parent&gt;\n    &lt;groupId&gt;com.example&lt;/groupId&gt;\n    &lt;artifactId&gt;demo-web-war&lt;/artifactId&gt;\n    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n    &lt;packaging&gt;war&lt;/packaging&gt;\n    &lt;name&gt;demo-web-war&lt;/name&gt;\n    &lt;description&gt;Demo project for Spring Boot&lt;/description&gt;\n    &lt;properties&gt;\n            &lt;maven.compiler.source&gt;11&lt;/maven.compiler.source&gt;\n                &lt;maven.compiler.target&gt;11&lt;/maven.compiler.target&gt;\n                &lt;maven.compiler.encoding&gt;UTF-8&lt;/maven.compiler.encoding&gt;\n                &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\n                &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;\n    &lt;/properties&gt;\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;\n            &lt;scope&gt;provided&lt;/scope&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt;\n            &lt;artifactId&gt;tomcat-embed-jasper&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;javax.servlet&lt;/groupId&gt;\n            &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt;\n            &lt;scope&gt;provided&lt;/scope&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;\n            &lt;artifactId&gt;commons-text&lt;/artifactId&gt;\n            &lt;version&gt;1.14.0&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n                &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;\n                &lt;artifactId&gt;commons-lang3&lt;/artifactId&gt;\n                &lt;version&gt;3.14.0&lt;/version&gt;\n        &lt;/dependency&gt;\n        \n    &lt;/dependencies&gt;\n\n    &lt;build&gt;\n    &lt;finalName&gt;demo&lt;/finalName&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n\n&lt;/project&gt;\n</code></pre>\n<h2>DemoWebWarApplication.java</h2>\n<pre class=\"lang-java prettyprint-override\"><code>package com.example;\n\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\nimport org.springframework.boot.builder.SpringApplicationBuilder;\nimport org.springframework.boot.web.servlet.ServletComponentScan;\nimport org.springframework.boot.web.servlet.support.SpringBootServletInitializer;\n\n@ServletComponentScan({&quot;com.example.servlet&quot;})\n@SpringBootApplication\npublic class DemoWebWarApplication extends SpringBootServletInitializer {\n\n    final static Logger log = LoggerFactory.getLogger(DemoWebWarApplication.class);\n\n    public static void main(String[] args) {\n        log.info(&quot;&gt;&gt;&gt; before SpringApplication.run&quot;);\n        SpringApplication.run(DemoWebWarApplication.class, args);\n        log.info(&quot;&gt;&gt;&gt; after SpringApplication.run&quot;);\n    }\n\n    @Override\n    protected SpringApplicationBuilder configure(SpringApplicationBuilder application) {\n        log.info(&quot;&gt;&gt;&gt; DemoWebWarApplication configure&quot;);\n        return application.sources(DemoWebWarApplication.class);\n    }\n\n}\n</code></pre>\n<h2>HelloJSPController.java</h2>\n<ul>\n<li>SpringMVC</li>\n</ul>\n<pre class=\"lang-java prettyprint-override\"><code>package com.example.controller;\n\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.stereotype.Controller;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RequestMethod;\nimport org.springframework.web.servlet.ModelAndView;\nimport java.util.Map;\n\n@Controller\npublic class HelloJSPController {\n\n    final static Logger log = LoggerFactory.getLogger(HelloJSPController.class);\n\n    @RequestMapping(value = &quot;/hellojsp&quot;, method = RequestMethod.GET)\n    public ModelAndView hello(Map&lt;String, Object&gt; model) {\n\n        log.info(&quot;&gt;&gt;&gt; HelloJSP Controller hello&quot;);\n\n        model.put(&quot;message&quot;, &quot;HelloJSP Controller hello&quot;);\n\n        // /WEB-INF/jsp/hello.jsp\n        return new ModelAndView(&quot;hello&quot;);\n    }\n}\n</code></pre>\n<h2>HelloRestController.java</h2>\n<ul>\n<li>Rest Controller</li>\n</ul>\n<pre class=\"lang-java prettyprint-override\"><code>package com.example.restcontroller;\n\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.PathVariable;\nimport org.springframework.web.bind.annotation.RequestParam;\nimport org.springframework.web.bind.annotation.RestController;\n\n@RestController\npublic class HelloRestController {\n    final static Logger log = LoggerFactory.getLogger(HelloRestController.class);\n\n    @GetMapping(&quot;/api/hello/{name}&quot;)\n    public String sayHello(\n            @PathVariable String name,\n            @RequestParam(value = &quot;greeting&quot;, defaultValue = &quot;Hello&quot;) String greeting) {\n        log.info(&quot;&gt;&gt;&gt; name = {} , greeting = {}&quot;, name, greeting);\n        return String.format(&quot;%s, %s!&quot;, greeting, name);\n    }\n}\n</code></pre>\n<h2>HelloServlet.java</h2>\n<ul>\n<li>HttpServlet</li>\n</ul>\n<pre class=\"lang-java prettyprint-override\"><code>package com.example.servlet;\n\nimport javax.servlet.ServletException;\nimport javax.servlet.annotation.WebServlet;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\nimport java.io.IOException;\nimport java.io.PrintWriter;\nimport java.time.LocalDateTime;\nimport java.time.format.DateTimeFormatter;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\n@WebServlet(&quot;/helloServlet&quot;)\npublic class HelloServlet extends HttpServlet {\n\n    final static Logger log = LoggerFactory.getLogger(HelloServlet.class);\n\n    private static final DateTimeFormatter FORMATTER =\n            DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd HH:mm:ss&quot;);\n\n    public HelloServlet() {\n        super();\n        log.info(&quot;&gt;&gt;&gt; HelloServlet()&quot;);\n    }\n\n    /**\n     * process HTTP GET request\n     */\n    @Override\n    protected void doGet(HttpServletRequest request, HttpServletResponse response)\n            throws ServletException, IOException {\n        log.info(&quot;&gt;&gt;&gt; doGet&quot;);\n        processRequest(request, response);\n    }\n\n    /**\n     * process HTTP POST request\n     */\n    @Override\n    protected void doPost(HttpServletRequest request, HttpServletResponse response)\n            throws ServletException, IOException {\n        log.info(&quot;&gt;&gt;&gt; doPost&quot;);\n        processRequest(request, response);\n    }\n\n    private void processRequest(HttpServletRequest request, HttpServletResponse response)\n            throws IOException {\n        response.setContentType(&quot;text/html;charset=UTF-8&quot;);\n\n        // 2. optional parameter 'msg'\n        // if parameter msg is null, then empty string\n        String message = request.getParameter(&quot;msg&quot;);\n        log.info(&quot;&gt;&gt;&gt; msg = {}&quot;, message);\n        if (message == null) {\n            message = &quot;&quot;;\n        } else {\n            message = org.apache.commons.text.StringEscapeUtils.escapeHtml4(message);\n        }\n        log.info(&quot;&gt;&gt;&gt; message = {}&quot;, message);\n\n        // 3. get currentTime\n        String currentTime = LocalDateTime.now().format(FORMATTER);\n        log.info(&quot;&gt;&gt;&gt; currentTime = {}&quot;, currentTime);\n\n        // 4. create response\n        try (PrintWriter out = response.getWriter()) {\n            out.println(&quot;&lt;!DOCTYPE html&gt;&quot;);\n            out.println(&quot;&lt;html&gt;&quot;);\n            out.println(&quot;&lt;head&gt;&quot;);\n            out.println(&quot;&lt;meta charset=\\&quot;UTF-8\\&quot;&gt;&quot;);\n            out.println(&quot;&lt;title&gt;Hello Servlet Output&lt;/title&gt;&quot;);\n            out.println(&quot;&lt;style&gt;&quot;);\n            out.println(&quot;.red { color: red; }&quot;);\n            out.println(&quot;&lt;/style&gt;&quot;);\n            out.println(&quot;&lt;/head&gt;&quot;);\n            out.println(&quot;&lt;body&gt;&quot;);\n            out.println(&quot;&lt;h1&gt;&quot;);\n            out.println(&quot;Hello &quot;);\n            out.println(&quot;&lt;span class=\\&quot;red\\&quot;&gt;&quot; + message + &quot;&lt;/span&gt; &quot;);\n            out.println(&quot;at &quot; + currentTime);\n            out.println(&quot;&lt;/h1&gt;&quot;);\n            out.println(&quot;&lt;/body&gt;&quot;);\n            out.println(&quot;&lt;/html&gt;&quot;);\n        }\n    }\n}\n</code></pre>\n<h2>application.properties</h2>\n<pre class=\"lang-bash prettyprint-override\"><code>spring.application.name=demo-web-war\nspring.mvc.view.prefix=/WEB-INF/jsp/\nspring.mvc.view.suffix=.jsp\n</code></pre>\n<h2>index.jsp</h2>\n<ul>\n<li>jsp</li>\n</ul>\n<pre class=\"lang-jsp prettyprint-override\"><code>&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;\n    pageEncoding=&quot;UTF-8&quot;%&gt;\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;\n&lt;style&gt;\n.color-red {\n    color: red;\n}\n&lt;/style&gt;\n&lt;title&gt;Home&lt;/title&gt;\n&lt;/head&gt;\n&lt;%\n// debug\nSystem.out.println(&quot;webapp / index.jsp &quot;);\n%&gt;\n&lt;body&gt;\n   &lt;h1 class=&quot;color-red&quot;&gt;SpringBoot index.jsp!&lt;/h1&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n<h2>hello.jsp</h2>\n<ul>\n<li>Spring MVC</li>\n</ul>\n<pre class=\"lang-jsp prettyprint-override\"><code>&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;\n    pageEncoding=&quot;UTF-8&quot;%&gt;\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;\n&lt;title&gt;Hello&lt;/title&gt;\n&lt;style&gt;\n.color-red {\n    color: red;\n}\n&lt;/style&gt;\n&lt;/head&gt;\n&lt;%\n// debug\nSystem.out.println(&quot;webapp / WEB-INF / jsp / hello.jsp &quot;);\n%&gt;\n&lt;body&gt;\n    &lt;h1 class=&quot;color-red&quot;&gt;SpringBoot hello.jsp!!  ${message} &lt;/h1&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n<h1>Build</h1>\n<pre class=\"lang-bash prettyprint-override\"><code>mvn clean package\n</code></pre>\n<h1>Run in command line</h1>\n<pre class=\"lang-bash prettyprint-override\"><code>java -jar target/demo.war\n</code></pre>\n<h2>Test</h2>\n<p>Open Browser</p>\n<h3>Test 1 - JSP</h3>\n<p>http://localhost:8080/index.jsp</p>\n<h3>Test 2 - Spring MVC</h3>\n<p>http://localhost:8080/hellojsp</p>\n<h3>Test 3 - Rest Controller</h3>\n<p>http://localhost:8080/api/hello/WORLD</p>\n<h3>Test 4 - Http Servlet</h3>\n<p>http://localhost:8080/helloServlet</p>\n<p>http://localhost:8080/helloServlet?msg=World</p>\n<pre class=\"lang-bash prettyprint-override\"><code>curl -X POST -d &quot;msg=John&quot; http://localhost:8080/helloServlet\n</code></pre>\n<h1>On Tomcat Server</h1>\n<p>copy demo.war into TomcatServer/webapps</p>\n<p>Since the WAR file is named demo.war, its context path on the Tomcat Server will automatically be <code>/demo</code>.</p>\n<h2>Test</h2>\n<p>Open Browser</p>\n<h3>Test 1 - JSP</h3>\n<p>http://localhost:8080/demo/index.jsp</p>\n<h3>Test 2 - Spring MVC</h3>\n<p>http://localhost:8080/demo/hellojsp</p>\n<h3>Test 3 - Rest Controller</h3>\n<p>http://localhost:8080/demo/api/hello/WORLD</p>\n<h3>Test 4 - Http Servlet</h3>\n<p>http://localhost:8080/demo/helloServlet</p>\n<p>http://localhost:8080/demo/helloServlet?msg=World</p>\n<pre class=\"lang-bash prettyprint-override\"><code>curl -X POST -d &quot;msg=John&quot; http://localhost:8080/demo/helloServlet\n</code></pre>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 26698569,
      "reputation" : 4090,
      "user_id" : 20306007,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/98bbc403493aee3681b71dae7abef66e?s=256&d=identicon&r=PG",
      "display_name" : "life888888",
      "link" : "https://stackoverflow.com/users/20306007/life888888"
    },
    "creation_date" : 1763432107,
    "last_activity_date" : 1763432107,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140854474,
    "post_id" : 79819231,
    "body" : "You should NOT use maven-war-plugin to package a SB app... use the spring-boot-maven-plugin it can produce war/jar... but you have to have two different executions of the spring-boot-maven-plugin.... also why using different resources directory for tests... keep the convention <code>src&#47;test&#47;resources</code>.... Why defining snakeyaml separately instead of using spring boot setups (starters etc.)",
    "score" : 1,
    "owner" : {
      "account_id" : 112317,
      "reputation" : 98455,
      "user_id" : 296328,
      "user_type" : "registered",
      "accept_rate" : 60,
      "profile_image" : "https://i.sstatic.net/DSpH6.jpg?s=256",
      "display_name" : "khmarbaise",
      "link" : "https://stackoverflow.com/users/296328/khmarbaise"
    },
    "creation_date" : 1763134237,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79820210" : [ {
      "comment_id" : 140864255,
      "post_id" : 79820210,
      "body" : "Add new Answer,  version 3,  Merge with velocity-tools simple example",
      "score" : 0,
      "owner" : {
        "account_id" : 26698569,
        "reputation" : 4090,
        "user_id" : 20306007,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/98bbc403493aee3681b71dae7abef66e?s=256&d=identicon&r=PG",
        "display_name" : "life888888",
        "link" : "https://stackoverflow.com/users/20306007/life888888"
      },
      "creation_date" : 1763641289,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140860189,
      "post_id" : 79820210,
      "body" : "Thank you very much for the example with Spring 2.x.  In the meantime, I found a description (<a href=\"https://issues.apache.org/jira/browse/VELTOOLS-202\" rel=\"nofollow noreferrer\">issues.apache.org/jira/browse/VELTOOLS-202</a>): &quot;If you use Tomcat 10.0.4 then you can deploy your app to the $CATALINA_HOME/webapps-javaee/ folder instead of webapps/&quot;.    That actually worked. But only with the non-executable WAR file (which was created with the maven-war-plugin and not with the spring-war-plugin). I might try changing the namespace in the Velocity sources from &quot;javax.&quot; to &quot;jakarta.&quot; Someone has already did it: &quot;I recently ported velocity-tools-view-3.1 to Servlet API 6.0&quot;.",
      "score" : 0,
      "owner" : {
        "account_id" : 3074494,
        "reputation" : 143,
        "user_id" : 2604243,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/b7a8dbfe7ed687ae22c52508697498db?s=256&d=identicon&r=PG",
        "display_name" : "deemon",
        "link" : "https://stackoverflow.com/users/2604243/deemon"
      },
      "creation_date" : 1763466392,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140859409,
      "post_id" : 79820210,
      "body" : "@deemon Based on your requirements, I have adapted the solution to use Spring Boot version 2.7.18. I have verified and tested it.",
      "score" : 1,
      "owner" : {
        "account_id" : 26698569,
        "reputation" : 4090,
        "user_id" : 20306007,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/98bbc403493aee3681b71dae7abef66e?s=256&d=identicon&r=PG",
        "display_name" : "life888888",
        "link" : "https://stackoverflow.com/users/20306007/life888888"
      },
      "creation_date" : 1763432196,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140859183,
      "post_id" : 79820210,
      "body" : "Thank you SO MUCH for your support. Unfortunately, I couldn&#39;t achieve my goal, because i couldn&#39;t start it under Tomcat 9. I tried replacing everywhere the &#39;jakarta&#39; dependencies with &#39;javax&#39;. I was able to compile the Demo App, but couldn&#39;t start.    My project uses &#39;velocity-engine-core&#39;, which doesn&#39;t support &#39;jakarta&#39;, not even version 2.4.1.    Would it be possible to use an older version of &#39;Spring Boot&#39; that works with &#39;javax&#39; instead of &#39;jakarta&#39; ?",
      "score" : 0,
      "owner" : {
        "account_id" : 3074494,
        "reputation" : 143,
        "user_id" : 2604243,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/b7a8dbfe7ed687ae22c52508697498db?s=256&d=identicon&r=PG",
        "display_name" : "deemon",
        "link" : "https://stackoverflow.com/users/2604243/deemon"
      },
      "creation_date" : 1763415218,
      "content_license" : "CC BY-SA 4.0"
    } ],
    "79825512" : [ {
      "comment_id" : 140867275,
      "post_id" : 79825512,
      "body" : "@deemon (6) By examining <code>indexVelocity.jsp</code> and <code>indexVelocity.vm</code>, you can see that they do not directly reference either <code>javax.servlet</code> or <code>jakarta.servlet</code>. Instead, it is the classes inside the Velocity Tools JAR that contain references to <code>jakarta.servlet</code>.",
      "score" : 0,
      "owner" : {
        "account_id" : 26698569,
        "reputation" : 4090,
        "user_id" : 20306007,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/98bbc403493aee3681b71dae7abef66e?s=256&d=identicon&r=PG",
        "display_name" : "life888888",
        "link" : "https://stackoverflow.com/users/20306007/life888888"
      },
      "creation_date" : 1763777054,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140867271,
      "post_id" : 79825512,
      "body" : "@deemon (4) Because this is an unofficial workaround, it cannot be published to the Central Maven Repository ( mvnrepository.com ).  (5) The Velocity “simple” example can run with this approach, but additional Velocity features still need further validation.",
      "score" : 0,
      "owner" : {
        "account_id" : 26698569,
        "reputation" : 4090,
        "user_id" : 20306007,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/98bbc403493aee3681b71dae7abef66e?s=256&d=identicon&r=PG",
        "display_name" : "life888888",
        "link" : "https://stackoverflow.com/users/20306007/life888888"
      },
      "creation_date" : 1763776852,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140867270,
      "post_id" : 79825512,
      "body" : "@deemon (1) This approach is only a temporary workaround.  (2) The method works by letting Tomcat rewrite all <code>import javax.servlet.xxx</code> references inside the classes packaged in the WAR’s JAR files to <code>import jakarta.servlet.xxx</code>.  (3) This solution is unofficial, so the patched artifacts are installed only in the local Maven repository (<code>~&#47;.m2</code>). If you have a private Maven repository server, you may install them there as well.",
      "score" : 0,
      "owner" : {
        "account_id" : 26698569,
        "reputation" : 4090,
        "user_id" : 20306007,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/98bbc403493aee3681b71dae7abef66e?s=256&d=identicon&r=PG",
        "display_name" : "life888888",
        "link" : "https://stackoverflow.com/users/20306007/life888888"
      },
      "creation_date" : 1763776845,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140866892,
      "post_id" : 79825512,
      "body" : "Thank you very much for your work. To make Velocity run with Jakarta, only the namespace has to be adjusted from javax to jakarta ?  Is it planned to make a release of the adapted version of Velocity to the Maven Repository (<a href=\"https://mvnrepository.com/\" rel=\"nofollow noreferrer\">mvnrepository.com</a>) ?",
      "score" : 0,
      "owner" : {
        "account_id" : 3074494,
        "reputation" : 143,
        "user_id" : 2604243,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/b7a8dbfe7ed687ae22c52508697498db?s=256&d=identicon&r=PG",
        "display_name" : "deemon",
        "link" : "https://stackoverflow.com/users/2604243/deemon"
      },
      "creation_date" : 1763753021,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}