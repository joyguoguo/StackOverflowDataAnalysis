{
  "question" : {
    "question_id" : 79753658,
    "title" : "Spring Jpa: Invalid column index error on UPDATE",
    "body" : "<p>When my application runs and it tries to update a row of my database (Oracle), I get the following error:</p>\n<blockquote>\n<p>Unable to bind parameter #7 - 4014 [Invalid column index] [n/a]</p>\n</blockquote>\n<p>The resolution seems easy, a mismatch between Spring Entity and column table - but...</p>\n<p>Here is my entity:</p>\n<pre><code>@Data\n@DynamicUpdate\n@Entity\n@Table(name=&quot;RETRY_PROCESSES&quot;)\npublic class RetryEntity {\n\n    public enum RowType{RETRY,DLQ,COMPLETED}\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.SEQUENCE, generator = &quot;retry_seq&quot;)\n    @SequenceGenerator(name = &quot;retry_seq&quot;, sequenceName = &quot;RETRY_PROCESSES_SEQ&quot;,     allocationSize = 1)\n    private Long id;\n\n    @Column(name=&quot;reservation_id&quot;)\n    private String reservationId;\n    @Column(name=&quot;reservation_timestamp&quot;)\n    private LocalDateTime reservationTimestamp;\n    @Column(name=&quot;row_type&quot;)\n    @Enumerated(EnumType.STRING)\n    private RowType rowType;\n    @Column(name=&quot;max_retry&quot;)\n    private Integer maxRetry;\n    @Column(name=&quot;retry_count&quot;)\n    private Integer retryCount;\n    @Column(name=&quot;next_retry_timestamp&quot;, columnDefinition=&quot;TIMESTAMP&quot;)\n    private LocalDateTime nextRetryTimestamp;\n    @Column(name=&quot;creation_timestamp&quot;, columnDefinition=&quot;TIMESTAMP&quot;)\n    private LocalDateTime creationTimestamp;\n    @Column(name=&quot;update_timestamp&quot;, columnDefinition=&quot;TIMESTAMP&quot;)\n    private LocalDateTime updateTimestamp;\n    @Column(name=&quot;flow&quot;)\n    @Enumerated(EnumType.STRING)\n    private FlowType flow;\n    @Column(name=&quot;action&quot;)\n    @Enumerated(EnumType.STRING)\n    private ActionType action;\n    @Column(name=&quot;error_code&quot;)\n    private String errorCode;\n    @Column(name=&quot;error_message&quot;)\n    private String errorMessage;\n    @Lob\n    @JdbcTypeCode(SqlTypes.CLOB)\n    @Column(name=&quot;json&quot;)\n    private String json;\n    @Column(name=&quot;key_name&quot;)\n    private String keyName;\n    @Column(name=&quot;key_value&quot;)\n    private String keyValue;\n}\n</code></pre>\n<p>Here my DB DDL:</p>\n<pre><code>Name                  Null?    Type\n--------------------- -------- ------------- \nRESERVATION_ID                 VARCHAR2(20)  \nRESERVATION_TIMESTAMP          TIMESTAMP(6)  \nROW_TYPE                       VARCHAR2(10)  \nMAX_RETRY                      NUMBER        \nRETRY_COUNT                    NUMBER        \nNEXT_RETRY_TIMESTAMP           TIMESTAMP(6)  \nCREATION_TIMESTAMP             TIMESTAMP(6)  \nUPDATE_TIMESTAMP               TIMESTAMP(6)  \nFLOW                           VARCHAR2(10)  \nACTION                         VARCHAR2(25)  \nERROR_CODE                     VARCHAR2(25)  \nERROR_MESSAGE                  VARCHAR2(400) \nJSON                           CLOB          \nKEY_NAME                       VARCHAR2(50)  \nKEY_VALUE                      VARCHAR2(50)  \nID                    NOT NULL NUMBER \n</code></pre>\n<p>The stacktrace log</p>\n<pre><code>Hibernate: update retry_processes set next_retry_timestamp=?,reservation_id=?,reservation_timestamp=?,retry_count=?,update_timestamp=?,json=? where id=?\n2025-09-02T15:22:43.456+02:00 TRACE 26028 --- [   scheduling-1] org.hibernate.orm.jdbc.bind              : binding parameter (1:TIMESTAMP) &lt;- [2025-09-02T11:41:59.662821]\n2025-09-02T15:22:43.457+02:00 TRACE 26028 --- [   scheduling-1] org.hibernate.orm.jdbc.bind              : binding parameter (2:VARCHAR) &lt;- [null]\n2025-09-02T15:22:43.458+02:00 TRACE 26028 --- [   scheduling-1] org.hibernate.orm.jdbc.bind              : binding parameter (3:TIMESTAMP) &lt;- [null]\n2025-09-02T15:22:43.458+02:00 TRACE 26028 --- [   scheduling-1] org.hibernate.orm.jdbc.bind              : binding parameter (4:INTEGER) &lt;- [2]\n2025-09-02T15:22:43.459+02:00 TRACE 26028 --- [   scheduling-1] org.hibernate.orm.jdbc.bind              : binding parameter (5:TIMESTAMP) &lt;- [2025-09-02T15:22:43.326669800]\n2025-09-02T15:22:43.460+02:00 TRACE 26028 --- [   scheduling-1] org.hibernate.orm.jdbc.bind              : binding parameter (6:CLOB) &lt;- [{&quot;type&quot;:&quot;EXTERNAL_PROCESS&quot;}]\n2025-09-02T15:22:43.464+02:00 TRACE 26028 --- [   scheduling-1] org.hibernate.orm.jdbc.bind              : binding parameter (7:BIGINT) &lt;- [4014]\n2025-09-02T15:22:43.465+02:00  WARN 26028 --- [   scheduling-1] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 17003, SQLState: 99999\n2025-09-02T15:22:43.466+02:00 ERROR 26028 --- [   scheduling-1] o.h.engine.jdbc.spi.SqlExceptionHelper   : Indice di colonna non valido\n\norg.springframework.orm.jpa.JpaSystemException: Unable to bind parameter #7 - 4014 [Indice di colonna non valido] [n/a]\n    at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:341) ~[spring-orm-6.1.16.jar:6.1.16]\n    at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241) ~[spring-orm-6.1.16.jar:6.1.16]\n    at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:566) ~[spring-orm-6.1.16.jar:6.1.16]\n    at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795) ~[spring-tx-6.1.16.jar:6.1.16]\n    at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758) ~[spring-tx-6.1.16.jar:6.1.16]\n    at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:663) ~[spring-tx-6.1.16.jar:6.1.16]\n    at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:413) ~[spring-tx-6.1.16.jar:6.1.16]\n    at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-6.1.16.jar:6.1.16]\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.1.16.jar:6.1.16]\n    at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.1.16.jar:6.1.16]\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.1.16.jar:6.1.16]\n    at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165) ~[spring-data-jpa-3.3.8.jar:3.3.8]\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.1.16.jar:6.1.16]\n    at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97) ~[spring-aop-6.1.16.jar:6.1.16]\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.1.16.jar:6.1.16]\n    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.1.16.jar:6.1.16]\n    at jdk.proxy2/jdk.proxy2.$Proxy132.save(Unknown Source) ~[na:na]\n    at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]\n    at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]\n    at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:355) ~[spring-aop-6.1.16.jar:6.1.16]\n    at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:716) ~[spring-aop-6.1.16.jar:6.1.16]\n    at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]\n    at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]\n    at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130) ~[spring-context-6.1.16.jar:6.1.16]\n    at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124) ~[spring-context-6.1.16.jar:6.1.16]\n    at io.micrometer.observation.Observation.observe(Observation.java:499) ~[micrometer-observation-1.13.10.jar:1.13.10]\n    at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124) ~[spring-context-6.1.16.jar:6.1.16]\n    at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54) ~[spring-context-6.1.16.jar:6.1.16]\n    at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572) ~[na:na]\n    at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java:358) ~[na:na]\n    at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305) ~[na:na]\n    at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144) ~[na:na]\n    at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642) ~[na:na]\n    at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]\nCaused by: org.hibernate.exception.GenericJDBCException: Unable to bind parameter #7 - 4014 [Indice di colonna non valido] [n/a]\n    at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:63) ~[hibernate-core-6.5.3.Final.jar:6.5.3.Final]\n    at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108) ~[hibernate-core-6.5.3.Final.jar:6.5.3.Final]\n    at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:94) ~[hibernate-core-6.5.3.Final.jar:6.5.3.Final]\n    at org.hibernate.engine.jdbc.mutation.internal.JdbcValueBindingsImpl.lambda$beforeStatement$0(JdbcValueBindingsImpl.java:95) ~[hibernate-core-6.5.3.Final.jar:6.5.3.Final]\n    at java.base/java.lang.Iterable.forEach(Iterable.java:75) ~[na:na]\n    at org.hibernate.engine.jdbc.mutation.spi.BindingGroup.forEachBinding(BindingGroup.java:51) ~[hibernate-core-6.5.3.Final.jar:6.5.3.Final]\n    at org.hibernate.engine.jdbc.mutation.internal.JdbcValueBindingsImpl.beforeStatement(JdbcValueBindingsImpl.java:85) ~[hibernate-core-6.5.3.Final.jar:6.5.3.Final]\n    at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:130) ~[hibernate-core-6.5.3.Final.jar:6.5.3.Final]\n    at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55) ~[hibernate-core-6.5.3.Final.jar:6.5.3.Final]\n    at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55) ~[hibernate-core-6.5.3.Final.jar:6.5.3.Final]\n    at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.doDynamicUpdate(UpdateCoordinatorStandard.java:968) ~[hibernate-core-6.5.3.Final.jar:6.5.3.Final]\n    at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.performUpdate(UpdateCoordinatorStandard.java:316) ~[hibernate-core-6.5.3.Final.jar:6.5.3.Final]\n    at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.update(UpdateCoordinatorStandard.java:245) ~[hibernate-core-6.5.3.Final.jar:6.5.3.Final]\n    at org.hibernate.action.internal.EntityUpdateAction.execute(EntityUpdateAction.java:169) ~[hibernate-core-6.5.3.Final.jar:6.5.3.Final]\n    at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:633) ~[hibernate-core-6.5.3.Final.jar:6.5.3.Final]\n    at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:500) ~[hibernate-core-6.5.3.Final.jar:6.5.3.Final]\n    at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:385) ~[hibernate-core-6.5.3.Final.jar:6.5.3.Final]\n    at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41) ~[hibernate-core-6.5.3.Final.jar:6.5.3.Final]\n    at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127) ~[hibernate-core-6.5.3.Final.jar:6.5.3.Final]\n    at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1425) ~[hibernate-core-6.5.3.Final.jar:6.5.3.Final]\n    at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:487) ~[hibernate-core-6.5.3.Final.jar:6.5.3.Final]\n    at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2324) ~[hibernate-core-6.5.3.Final.jar:6.5.3.Final]\n    at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1981) ~[hibernate-core-6.5.3.Final.jar:6.5.3.Final]\n    at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439) ~[hibernate-core-6.5.3.Final.jar:6.5.3.Final]\n    at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169) ~[hibernate-core-6.5.3.Final.jar:6.5.3.Final]\n    at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267) ~[hibernate-core-6.5.3.Final.jar:6.5.3.Final]\n    at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101) ~[hibernate-core-6.5.3.Final.jar:6.5.3.Final]\n    at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:562) ~[spring-orm-6.1.16.jar:6.1.16]\n    ... 36 common frames omitted\n</code></pre>\n<p>The line of code that throws that exception <code>retryRepository.save(retryEntity);</code> is used for both inserting and updating, no problems occurred during insert but every update fails</p>\n<p>What I tried to do to resolve the issue?</p>\n<ul>\n<li>added entity Annotation <code>@DynamicUpdate</code> that create a dynamic query with only updated values</li>\n<li>added on DB a sequence <code>RETRY_PROCESSES_SEQ</code>, and binded on entity (at the first instance Entity was setted as <code>strategy = GenerationType.IDENTITY</code>)</li>\n<li>added Annotation <code>@JdbcTypeCode(SqlTypes.CLOB)</code> on CLOB json param in RetryEntity</li>\n<li>update jdbc dependency from <code>com.oracle.database.jdbc.ojdbc8</code> to <code>com.oracle.database.jdbc.ojdbc11</code></li>\n</ul>\n<p>Any suggestions?</p>\n",
    "tags" : [ "java", "spring", "oracle-database", "hibernate" ],
    "owner" : {
      "account_id" : 1709850,
      "reputation" : 2168,
      "user_id" : 1568120,
      "user_type" : "registered",
      "accept_rate" : 57,
      "profile_image" : "https://www.gravatar.com/avatar/b3d2c6a9a81f4fa783b01ef90be65e71?s=256&d=identicon&r=PG",
      "display_name" : "Ging3r",
      "link" : "https://stackoverflow.com/users/1568120/ging3r"
    },
    "is_answered" : true,
    "view_count" : 114,
    "answer_count" : 1,
    "score" : 1,
    "last_activity_date" : 1760375514,
    "creation_date" : 1756825723,
    "link" : "https://stackoverflow.com/questions/79753658/spring-jpa-invalid-column-index-error-on-update",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79755828,
    "question_id" : 79753658,
    "body" : "<p>Since json is a part of the syntax (i.e. 'is json' 'is not json'), a column name json seems to irritate the sql parser with the result of not identifiyng one ? as parameter</p>\n",
    "score" : 1,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 8026267,
      "reputation" : 5044,
      "user_id" : 6053084,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/616306286f1da49445d0f5f944440c2d?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Turo",
      "link" : "https://stackoverflow.com/users/6053084/turo"
    },
    "creation_date" : 1756994779,
    "last_activity_date" : 1756994779,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140712105,
    "post_id" : 79753658,
    "body" : "@Turo was that!!!!!! it is very wired....in different point of my code I do update in that table!!..if you create an answer I will set as correct one",
    "score" : 0,
    "owner" : {
      "account_id" : 1709850,
      "reputation" : 2168,
      "user_id" : 1568120,
      "user_type" : "registered",
      "accept_rate" : 57,
      "profile_image" : "https://www.gravatar.com/avatar/b3d2c6a9a81f4fa783b01ef90be65e71?s=256&d=identicon&r=PG",
      "display_name" : "Ging3r",
      "link" : "https://stackoverflow.com/users/1568120/ging3r"
    },
    "creation_date" : 1756909219,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140709828,
    "post_id" : 79753658,
    "body" : "I can&#39;t see an error, too.  Wild guess: maybe json isn&#39;t a good column name, misleading the parser...",
    "score" : 1,
    "owner" : {
      "account_id" : 8026267,
      "reputation" : 5044,
      "user_id" : 6053084,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/616306286f1da49445d0f5f944440c2d?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Turo",
      "link" : "https://stackoverflow.com/users/6053084/turo"
    },
    "creation_date" : 1756830821,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79755828" : [ {
      "comment_id" : 140742535,
      "post_id" : 79755828,
      "body" : "@Nirmala You should ask Ging3r(comment to the question), I don&#39;t have the setup...",
      "score" : 0,
      "owner" : {
        "account_id" : 8026267,
        "reputation" : 5044,
        "user_id" : 6053084,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/616306286f1da49445d0f5f944440c2d?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "Turo",
        "link" : "https://stackoverflow.com/users/6053084/turo"
      },
      "creation_date" : 1758118019,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140740451,
      "post_id" : 79755828,
      "body" : "Can you let us know the JDBC driver version that you are using? Can you try to use 23ai driver and check if you can use json as the table column?",
      "score" : 0,
      "owner" : {
        "account_id" : 3115017,
        "reputation" : 1,
        "user_id" : 2635993,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/ffcc7dc6493988fb819ac391b0d82a19?s=256&d=identicon&r=PG",
        "display_name" : "Nirmala",
        "link" : "https://stackoverflow.com/users/2635993/nirmala"
      },
      "creation_date" : 1758048482,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140726842,
      "post_id" : 79755828,
      "body" : "it is! i don&#39;t know why, Hibernate fails to process an sql update (during save() method process) on a column where the name is a reserved key...I fixed it renaming table column from &quot;json&quot; to &quot;json_message&quot;",
      "score" : 0,
      "owner" : {
        "account_id" : 1709850,
        "reputation" : 2168,
        "user_id" : 1568120,
        "user_type" : "registered",
        "accept_rate" : 57,
        "profile_image" : "https://www.gravatar.com/avatar/b3d2c6a9a81f4fa783b01ef90be65e71?s=256&d=identicon&r=PG",
        "display_name" : "Ging3r",
        "link" : "https://stackoverflow.com/users/1568120/ging3r"
      },
      "creation_date" : 1757512735,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}