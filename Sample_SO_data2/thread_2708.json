{
  "question" : {
    "question_id" : 79603892,
    "title" : "How can I prevent HSSFWorkbook from embedding my username in the Excel file?",
    "body" : "<p>I am using the Apache POI library version 5.2.0 in Java to write an XLS (Excel) file.</p>\n<pre><code>void writeExcelFile() {\n    var workbook = new HSSFWorkbook();\n    byte[] bytes;\n    ByteArrayOutputStream bos = new ByteArrayOutputStream();\n    try {\n        workbook.write(bos);\n        bytes = bos.toByteArray();\n    } catch (IOException e) {\n        throw new RuntimeException(e);\n    }\n    try {\n        Files.write(Path.of(&quot;foo.xls&quot;), bytes);\n    } catch (IOException e) {\n        throw new RuntimeException(e);\n    }\n}\n</code></pre>\n<p>When I run the resulting <code>foo.xls</code> file through the <code>strings</code> program, I see that my system username (<code>christoffer.gamrath</code>) is part of the file contents:</p>\n<pre><code>$ strings foo.xls                                                                                                                        main?\nchristoffer.gamrath                                                                                          B\nArial1\nArial1\nArial1\nArial\n&quot;$&quot;#,##0_);(&quot;$&quot;#,##0)\n&quot;$&quot;#,##0_);[Red](&quot;$&quot;#,##0)\n&quot;$&quot;#,##0.00_);(&quot;$&quot;#,##0.00)\n&quot;$&quot;#,##0.00_);[Red](&quot;$&quot;#,##0.00)\n_(&quot;$&quot;* #,##0_);_(&quot;$&quot;* (#,##0);_(&quot;$&quot;* &quot;-&quot;_);_(@_)\n_(* #,##0_);_(* (#,##0);_(* &quot;-&quot;_);_(@_)\n_(&quot;$&quot;* #,##0.00_);_(&quot;$&quot;* (#,##0.00);_(&quot;$&quot;* &quot;-&quot;??_);_(@_)\n_(* #,##0.00_);_(* (#,##0.00);_(* &quot;-&quot;??_);_(@_)\nSheet1\n</code></pre>\n<p>I want to avoid storing my username in the file, so that when I run the same code on a different machine the resulting file will be exactly the same.</p>\n<p>I have tried setting properties such as author on the workbook:</p>\n<pre><code>void writeExcelFileWithoutProperties() {\n    var workbook = new HSSFWorkbook();\n    workbook.createInformationProperties();\n    SummaryInformation summaryInfo = workbook.getSummaryInformation();\n    if (summaryInfo != null) {\n        summaryInfo.setAuthor(&quot;&quot;);\n        summaryInfo.setLastAuthor(&quot;&quot;);\n        summaryInfo.setTitle(&quot;&quot;);\n        summaryInfo.setSubject(&quot;&quot;);\n        summaryInfo.setKeywords(&quot;&quot;);\n        summaryInfo.setComments(&quot;&quot;);\n    }\n    DocumentSummaryInformation docSummaryInfo = workbook.getDocumentSummaryInformation();\n    if (docSummaryInfo != null) {\n        docSummaryInfo.setCompany(&quot;&quot;);\n        docSummaryInfo.setManager(&quot;&quot;);\n    }\n    byte[] bytes;\n    ByteArrayOutputStream bos = new ByteArrayOutputStream();\n    try {\n        workbook.write(bos);\n        bytes = bos.toByteArray();\n    } catch (IOException e) {\n        throw new RuntimeException(e);\n    }\n    try {\n        Files.write(Path.of(&quot;foo2.xls&quot;), bytes);\n    } catch (IOException e) {\n        throw new RuntimeException(e);\n    }\n}\n</code></pre>\n<p>This does not resolve the issue: the <code>strings</code> output is exactly the same.</p>\n",
    "tags" : [ "java", "apache-poi", "hssf", "hssfworkbook" ],
    "owner" : {
      "account_id" : 467256,
      "reputation" : 538,
      "user_id" : 872491,
      "user_type" : "registered",
      "accept_rate" : 100,
      "profile_image" : "https://www.gravatar.com/avatar/5ca830b01b70f0a6ec3969f2227df178?s=256&d=identicon&r=PG",
      "display_name" : "cgamrath",
      "link" : "https://stackoverflow.com/users/872491/cgamrath"
    },
    "is_answered" : true,
    "view_count" : 88,
    "answer_count" : 2,
    "score" : 1,
    "last_activity_date" : 1746470667,
    "creation_date" : 1746208585,
    "link" : "https://stackoverflow.com/questions/79603892/how-can-i-prevent-hssfworkbook-from-embedding-my-username-in-the-excel-file",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79604580,
    "question_id" : 79603892,
    "body" : "<p>As soon as you create the <code>HSSFWorkbook</code>, Apache POI embeds the system username into the file.</p>\n<p>Even if you later clear or overwrite the author field (as you do), the username has already been written into internal metadata sections that the high-level API can't fully remove. When you create:</p>\n<pre><code>var workbook = new HSSFWorkbook();\n</code></pre>\n<p>there's no going back from here. Once it's initialized, the author will be the one set as system property in:</p>\n<pre><code>System.getProperty(&quot;user.name&quot;)\n</code></pre>\n<p>In order to clear your username: <strong>before</strong> you create the new <code>HSSFWorkbook</code>, clear the system property:</p>\n<pre><code>System.setProperty(&quot;user.name&quot;, &quot;&quot;);\nvar workbook = new HSSFWorkbook();\n</code></pre>\n",
    "score" : 1,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 2465829,
      "reputation" : 13627,
      "user_id" : 2148953,
      "user_type" : "registered",
      "accept_rate" : 96,
      "profile_image" : "https://i.sstatic.net/DVHoP84E.jpg?s=256",
      "display_name" : "aran",
      "link" : "https://stackoverflow.com/users/2148953/aran"
    },
    "creation_date" : 1746266956,
    "last_activity_date" : 1746266956,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79607470,
    "question_id" : 79603892,
    "body" : "<p>You can set the username this way. Set it an anonymous value.</p>\n<pre><code>InternalWorkbook iwb = wb.getInternalWorkbook();\niwb.getWriteAccess().setUsername(&quot;username&quot;);\n</code></pre>\n",
    "score" : 1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 964210,
      "reputation" : 1076,
      "user_id" : 987959,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/a51610eaffa3f4e8022a07bcd070ab3c?s=256&d=identicon&r=PG",
      "display_name" : "PJ Fanning",
      "link" : "https://stackoverflow.com/users/987959/pj-fanning"
    },
    "creation_date" : 1746470667,
    "last_activity_date" : 1746470667,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140394090,
    "post_id" : 79603892,
    "body" : "workbook.write(new File(&quot;foo.xls&quot;)) does not solve the issue",
    "score" : 0,
    "owner" : {
      "account_id" : 467256,
      "reputation" : 538,
      "user_id" : 872491,
      "user_type" : "registered",
      "accept_rate" : 100,
      "profile_image" : "https://www.gravatar.com/avatar/5ca830b01b70f0a6ec3969f2227df178?s=256&d=identicon&r=PG",
      "display_name" : "cgamrath",
      "link" : "https://stackoverflow.com/users/872491/cgamrath"
    },
    "creation_date" : 1746350774,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140391513,
    "post_id" : 79603892,
    "body" : "if you just let POI write the file it&#39;ll be the author.  Why are you using Files.write?  Seems like it should be something like:  workbook.write(a_file_stream).  Author is coming from file meta-data methinks.",
    "score" : 0,
    "owner" : {
      "account_id" : 6077817,
      "reputation" : 1362,
      "user_id" : 4744568,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/125cdb7d43927756913b920de016f420?s=256&d=identicon&r=PG",
      "display_name" : "browsermator",
      "link" : "https://stackoverflow.com/users/4744568/browsermator"
    },
    "creation_date" : 1746219554,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}