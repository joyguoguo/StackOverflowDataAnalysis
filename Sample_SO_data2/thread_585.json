{
  "question" : {
    "question_id" : 79794749,
    "title" : "Arabic Word Normalization and Search Ignoring Prefixes and Suffixes in quran app",
    "body" : "<p>I’m developing a Qur’an search application that allows users to search for Arabic words and find their occurrences across the Qur’an.\nTo improve accuracy, I added a feature that removes Arabic prepositions and pronouns (such as prefixes and suffixes) before performing the search.</p>\n<p>However, the issue is that the search results still include words that only contain the searched term rather than matching the exact or root form of the word.</p>\n<p>For example, when searching for &quot;مصر&quot;, the results include not only exact matches like “مصر” but also partial matches such as “مصرف” or “مصرخ”.\nThis means the current logic does not properly distinguish between the root word and other words that merely contain the same sequence of letters.</p>\n<p>The goal is to enhance the search algorithm to accurately detect and return only true root matches in the Qur’an text, ignoring words that just include the searched letters as part of another word.</p>\n<pre><code>{\n    &quot;success&quot;: true,\n    &quot;data&quot;: {\n        &quot;word&quot;: &quot;مصر&quot;,\n        &quot;normalized_word&quot;: &quot;مصر&quot;,\n        &quot;total_count&quot;: 9,\n        &quot;occurrences_count&quot;: 8,\n        &quot;occurrences&quot;: [\n            {\n                &quot;surah_number&quot;: 2,\n                &quot;surah_name&quot;: &quot;سورة 2&quot;,\n                &quot;ayah&quot;: 61,\n                &quot;text&quot;: &quot;وَإِذۡ قُلۡتُمۡ يَٰمُوسَىٰ لَن نَّصۡبِرَ عَلَىٰ طَعَامٖ وَٰحِدٖ فَٱدۡعُ لَنَا رَبَّكَ يُخۡرِجۡ لَنَا مِمَّا تُنۢبِتُ ٱلۡأَرۡضُ مِنۢ بَقۡلِهَا وَقِثَّآئِهَا وَفُومِهَا وَعَدَسِهَا وَبَصَلِهَاۖ قَالَ أَتَسۡتَبۡدِلُونَ ٱلَّذِي هُوَ أَدۡنَىٰ بِٱلَّذِي هُوَ خَيۡرٌۚ ٱهۡبِطُواْ مِصۡرٗا فَإِنَّ لَكُم مَّا سَأَلۡتُمۡۗ وَضُرِبَتۡ عَلَيۡهِمُ ٱلذِّلَّةُ وَٱلۡمَسۡكَنَةُ وَبَآءُو بِغَضَبٖ مِّنَ ٱللَّهِۚ ذَٰلِكَ بِأَنَّهُمۡ كَانُواْ يَكۡفُرُونَ بِـَٔايَٰتِ ٱللَّهِ وَيَقۡتُلُونَ ٱلنَّبِيِّـۧنَ بِغَيۡرِ ٱلۡحَقِّۚ ذَٰلِكَ بِمَا عَصَواْ وَّكَانُواْ يَعۡتَدُونَ&quot;,\n                &quot;count_in_ayah&quot;: 1\n            },\n            {\n                &quot;surah_number&quot;: 10,\n                &quot;surah_name&quot;: &quot;سورة 10&quot;,\n                &quot;ayah&quot;: 87,\n                &quot;text&quot;: &quot;وَأَوۡحَيۡنَآ إِلَىٰ مُوسَىٰ وَأَخِيهِ أَن تَبَوَّءَا لِقَوۡمِكُمَا بِمِصۡرَ بُيُوتٗا وَٱجۡعَلُواْ بُيُوتَكُمۡ قِبۡلَةٗ وَأَقِيمُواْ ٱلصَّلَوٰةَۗ وَبَشِّرِ ٱلۡمُؤۡمِنِينَ&quot;,\n                &quot;count_in_ayah&quot;: 1\n            },\n            {\n                &quot;surah_number&quot;: 11,\n                &quot;surah_name&quot;: &quot;سورة 11&quot;,\n                &quot;ayah&quot;: 8,\n                &quot;text&quot;: &quot;وَلَئِنۡ أَخَّرۡنَا عَنۡهُمُ ٱلۡعَذَابَ إِلَىٰٓ أُمَّةٖ مَّعۡدُودَةٖ لَّيَقُولُنَّ مَا يَحۡبِسُهُۥٓۗ أَلَا يَوۡمَ يَأۡتِيهِمۡ لَيۡسَ مَصۡرُوفًا عَنۡهُمۡ وَحَاقَ بِهِم مَّا كَانُواْ بِهِۦ يَسۡتَهۡزِءُونَ&quot;,\n                &quot;count_in_ayah&quot;: 1\n            },\n            {\n                &quot;surah_number&quot;: 12,\n                &quot;surah_name&quot;: &quot;سورة 12&quot;,\n                &quot;ayah&quot;: 21,\n                &quot;text&quot;: &quot;وَقَالَ ٱلَّذِي ٱشۡتَرَىٰهُ مِن مِّصۡرَ لِٱمۡرَأَتِهِۦٓ أَكۡرِمِي مَثۡوَىٰهُ عَسَىٰٓ أَن يَنفَعَنَآ أَوۡ نَتَّخِذَهُۥ وَلَدٗاۚ وَكَذَٰلِكَ مَكَّنَّا لِيُوسُفَ فِي ٱلۡأَرۡضِ وَلِنُعَلِّمَهُۥ مِن تَأۡوِيلِ ٱلۡأَحَادِيثِۚ وَٱللَّهُ غَالِبٌ عَلَىٰٓ أَمۡرِهِۦ وَلَٰكِنَّ أَكۡثَرَ ٱلنَّاسِ لَا يَعۡلَمُونَ&quot;,\n                &quot;count_in_ayah&quot;: 1\n            },\n            {\n                &quot;surah_number&quot;: 12,\n                &quot;surah_name&quot;: &quot;سورة 12&quot;,\n                &quot;ayah&quot;: 99,\n                &quot;text&quot;: &quot;فَلَمَّا دَخَلُواْ عَلَىٰ يُوسُفَ ءَاوَىٰٓ إِلَيۡهِ أَبَوَيۡهِ وَقَالَ ٱدۡخُلُواْ مِصۡرَ إِن شَآءَ ٱللَّهُ ءَامِنِينَ&quot;,\n                &quot;count_in_ayah&quot;: 1\n            },\n            {\n                &quot;surah_number&quot;: 14,\n                &quot;surah_name&quot;: &quot;سورة 14&quot;,\n                &quot;ayah&quot;: 22,\n                &quot;text&quot;: &quot;وَقَالَ ٱلشَّيۡطَٰنُ لَمَّا قُضِيَ ٱلۡأَمۡرُ إِنَّ ٱللَّهَ وَعَدَكُمۡ وَعۡدَ ٱلۡحَقِّ وَوَعَدتُّكُمۡ فَأَخۡلَفۡتُكُمۡۖ وَمَا كَانَ لِيَ عَلَيۡكُم مِّن سُلۡطَٰنٍ إِلَّآ أَن دَعَوۡتُكُمۡ فَٱسۡتَجَبۡتُمۡ لِيۖ فَلَا تَلُومُونِي وَلُومُوٓاْ أَنفُسَكُمۖ مَّآ أَنَا۠ بِمُصۡرِخِكُمۡ وَمَآ أَنتُم بِمُصۡرِخِيَّ إِنِّي كَفَرۡتُ بِمَآ أَشۡرَكۡتُمُونِ مِن قَبۡلُۗ إِنَّ ٱلظَّـٰلِمِينَ لَهُمۡ عَذَابٌ أَلِيمٞ&quot;,\n                &quot;count_in_ayah&quot;: 2\n            },\n            {\n                &quot;surah_number&quot;: 18,\n                &quot;surah_name&quot;: &quot;سورة 18&quot;,\n                &quot;ayah&quot;: 53,\n                &quot;text&quot;: &quot;وَرَءَا ٱلۡمُجۡرِمُونَ ٱلنَّارَ فَظَنُّوٓاْ أَنَّهُم مُّوَاقِعُوهَا وَلَمۡ يَجِدُواْ عَنۡهَا مَصۡرِفٗا&quot;,\n                &quot;count_in_ayah&quot;: 1\n            },\n            {\n                &quot;surah_number&quot;: 43,\n                &quot;surah_name&quot;: &quot;سورة 43&quot;,\n                &quot;ayah&quot;: 51,\n                &quot;text&quot;: &quot;وَنَادَىٰ فِرۡعَوۡنُ فِي قَوۡمِهِۦ قَالَ يَٰقَوۡمِ أَلَيۡسَ لِي مُلۡكُ مِصۡرَ وَهَٰذِهِ ٱلۡأَنۡهَٰرُ تَجۡرِي مِن تَحۡتِيٓۚ أَفَلَا تُبۡصِرُونَ&quot;,\n                &quot;count_in_ayah&quot;: 1\n            }\n        ]\n    },\n    &quot;meta&quot;: {\n        &quot;timestamp&quot;: &quot;2025-10-20T08:55:08.103Z&quot;,\n        &quot;query&quot;: &quot;مصر&quot;,\n        &quot;resultsCount&quot;: 8,\n        &quot;totalOccurrences&quot;: 9\n    }\n}\n</code></pre>\n<p>it should return only 5 times</p>\n",
    "tags" : [ "java", "algorithm", "search", "replace" ],
    "owner" : {
      "account_id" : 40301282,
      "reputation" : 1,
      "user_id" : 29710920,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/b332647c2111147d9580afd15d8f6fe2?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Salma Ahmed",
      "link" : "https://stackoverflow.com/users/29710920/salma-ahmed"
    },
    "is_answered" : true,
    "view_count" : 120,
    "closed_date" : 1760958736,
    "answer_count" : 1,
    "score" : -2,
    "last_activity_date" : 1760962271,
    "creation_date" : 1760952050,
    "link" : "https://stackoverflow.com/questions/79794749/arabic-word-normalization-and-search-ignoring-prefixes-and-suffixes-in-quran-app",
    "closed_reason" : "Needs details or clarity"
  },
  "answers" : [ {
    "answer_id" : 79794786,
    "question_id" : 79794749,
    "body" : "<p>if you are manipulating the data as a string you can easily using Regular expressions (regex) this is to most efficient technique in most programming languages to search in string, here's a java example</p>\n<pre class=\"lang-java prettyprint-override\"><code>package mainPackage;\n\nimport java.util.regex.Matcher;\nimport java.util.regex.Pattern;\n\npublic class Main {\n    public static void main(String[] args) {\n        String regex = &quot;مصر&quot;;\n        Pattern pattern = Pattern.compile(regex);\n        String input = &quot;مصر دولة جميلة و ايضا مصر من افضل الدول من حيث الموقع الجرافى&quot;;\n        Matcher matcher = pattern.matcher(input);\n        int counter = 0;\n        while (matcher.find()) {\n            counter++;\n        }\n        System.out.println(counter); // the output is 2\n    }\n}\n</code></pre>\n",
    "score" : 1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 44377124,
      "reputation" : 11,
      "user_id" : 31721193,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/dbcbf8a6d224a3c7fbef94b40364399a?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Ahmad Saad",
      "link" : "https://stackoverflow.com/users/31721193/ahmad-saad"
    },
    "creation_date" : 1760955379,
    "last_activity_date" : 1760958518,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140813305,
    "post_id" : 79794749,
    "body" : "What about using <code>\\b</code> (word boundary) at each end of the search term?",
    "score" : 0,
    "owner" : {
      "account_id" : 318670,
      "reputation" : 16477,
      "user_id" : 636009,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/IIQJV.jpg?s=256",
      "display_name" : "David Conrad",
      "link" : "https://stackoverflow.com/users/636009/david-conrad"
    },
    "creation_date" : 1761232609,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140806441,
    "post_id" : 79794749,
    "body" : "If you already have an algorithm that removes prefixes and suffixes (a light stemmer) then it isn&#39;t clear why مصرف still matches مصر. They should be different words even after stemming. You should compare your search term with each word of the text for equality, and not try to mach a substring.",
    "score" : 0,
    "owner" : {
      "account_id" : 406349,
      "reputation" : 122160,
      "user_id" : 775806,
      "user_type" : "registered",
      "accept_rate" : 96,
      "profile_image" : "https://i.sstatic.net/JeTnSU2C.jpg?s=256",
      "display_name" : "n. m. could be an AI",
      "link" : "https://stackoverflow.com/users/775806/n-m-could-be-an-ai"
    },
    "creation_date" : 1760968043,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140806427,
    "post_id" : 79794749,
    "body" : "You need an <i>Arabic stemmmer</i> (an algorithm which, given an Arabic word, finds its stem). There are several available, just do an internet search. Since you are dealing with a fixed text, you can run a stemmer offline and build a database that associates each occurrence of a word with its stem. For ultimate accuracy, let human experts validate the results of the algorithm.",
    "score" : 0,
    "owner" : {
      "account_id" : 406349,
      "reputation" : 122160,
      "user_id" : 775806,
      "user_type" : "registered",
      "accept_rate" : 96,
      "profile_image" : "https://i.sstatic.net/JeTnSU2C.jpg?s=256",
      "display_name" : "n. m. could be an AI",
      "link" : "https://stackoverflow.com/users/775806/n-m-could-be-an-ai"
    },
    "creation_date" : 1760967757,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79794786" : [ {
      "comment_id" : 140806302,
      "post_id" : 79794786,
      "body" : "Might not be needed in your specific use case but still a good hint for future readers who might use this code with different search terms.",
      "score" : 1,
      "owner" : {
        "account_id" : 3211603,
        "reputation" : 301001,
        "user_id" : 2711488,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/t2hoD.jpg?s=256",
        "display_name" : "Holger",
        "link" : "https://stackoverflow.com/users/2711488/holger"
      },
      "creation_date" : 1760962818,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140806290,
      "post_id" : 79794786,
      "body" : "@Holger You&#39;re right — but we already normalize Arabic text in our code using regex to remove diacritics and tatweel, unify characters, and match normalized words directly. So, we don’t need Pattern.LITERAL.",
      "score" : 0,
      "owner" : {
        "account_id" : 40301282,
        "reputation" : 1,
        "user_id" : 29710920,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/b332647c2111147d9580afd15d8f6fe2?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "Salma Ahmed",
        "link" : "https://stackoverflow.com/users/29710920/salma-ahmed"
      },
      "creation_date" : 1760962442,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140806237,
      "post_id" : 79794786,
      "body" : "I would use <code>Pattern.compile(regex, Pattern.LITERAL)</code> here, as interpretation of special characters is not intended.",
      "score" : 1,
      "owner" : {
        "account_id" : 3211603,
        "reputation" : 301001,
        "user_id" : 2711488,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/t2hoD.jpg?s=256",
        "display_name" : "Holger",
        "link" : "https://stackoverflow.com/users/2711488/holger"
      },
      "creation_date" : 1760960663,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}