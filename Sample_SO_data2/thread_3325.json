{
  "question" : {
    "question_id" : 79558849,
    "title" : "Unable to save the model object in the spring boot which is having the enum property",
    "body" : "<p>we are using spring boot version 3.4.3 + spring data jpa project\nhibernate version 6+ AND spring security version 6+. Databae is postgres.\nmy model class TestModel is like this:</p>\n<pre><code> @Getter\n        @Setter\n        @Entity\n        @Table(name=&quot;test_model&quot;)\n        public class TestModel {        \n            @Id\n            @GeneratedValue(generator = &quot;UUID&quot;)\n            @UuidGenerator\n            @Column(name = &quot;id&quot;, updatable = false, nullable = false)\n            private UUID id;\n            \n            @CreationTimestamp\n            @Column(name=&quot;created&quot;)\n            private Date created;\n            \n            @UpdateTimestamp\n            @Column(name=&quot;last_modified&quot;)\n            private Date lastModified;\n            \n            @Column(name=&quot;quantity&quot;)\n            private Integer quantity;       \n            \n            @Enumerated(EnumType.STRING)\n            @Column(name=&quot;create_process_status&quot;)\n            private ProcessStatusType processStatusType;\n            \n        }\n</code></pre>\n<p>My enum class is like below</p>\n<pre><code>public enum ProcessStatusType {\n\n    completed(&quot;completed&quot;), processing(&quot;processing&quot;), failed(&quot;failed&quot;);\n\n    private String type;\n\n    private ProcessStatusType(String type) {\n        this.type = type;\n    }\n\n    public String getType() {\n        return type;\n    }\n}\n</code></pre>\n<p>In the database also I have created the column is of type enum</p>\n<pre><code>create_process_status schema.enum_process_status_type DEFAULT 'completed'::schema.enum_process_status_type,\n</code></pre>\n<p>From service class my  code is like this:</p>\n<pre><code>public String save() {\n             TestModel testModel = new TestModel();\n        testModel.setQuantity(2);\n                testModel.setCreated(XXXX);\n                testModel.setlastModified(YYYYY);       \n        testModel.setProcessStatusType(ProcessStatusType.processing);\n        MyRepository.save(testModel);\n              return &quot; created successfully &quot; ;\n    }\n</code></pre>\n<p>But when running the API i'm getting the error like below :</p>\n<p>ERROR: column &quot;create_process_status&quot; is of type schema.enum_process_status_type but expression is of type character varying\nHint: You will need to rewrite or cast the expression.\nPosition: 232</p>\n<p>I have created Custom Converter class for Enum Handling also.</p>\n<pre><code> import javax.persistence.AttributeConverter;\n   import javax.persistence.Converter;\n\n   @Converter(autoApply = true) \n   public class ProcessStatusTypeConverter implements AttributeConverter&lt;ProcessStatusType, String&gt; {\n       \n       @Override\n       public String convertToDatabaseColumn(ProcessStatusType attribute) {\n           if (attribute == null) {\n               return null;\n           }\n           return attribute.getType();  // Returns 'completed', 'processing', 'failed'\n       }\n\n       @Override\n       public ProcessStatusType convertToEntityAttribute(String dbData) {\n           if (dbData == null) {\n               return null;\n           }\n           return ProcessStatusType.valueOf(dbData.toUpperCase());  // Converts back to the enum\n       }\n   }\n</code></pre>\n<p>In the model I have done changes like below</p>\n<pre><code> @Convert(converter = ProcessStatusTypeConverter.class)  // Use the converter\n   @Column(name = &quot;create_process_status&quot;)\n   private ProcessStatusType processStatusType;\n</code></pre>\n<p>in the pom.xml i added this</p>\n<pre><code>&lt;dependency&gt;\n            &lt;groupId&gt;org.postgresql&lt;/groupId&gt;\n            &lt;artifactId&gt;postgresql&lt;/artifactId&gt;\n             &lt;version&gt;42.6.0&lt;/version&gt;          \n        &lt;/dependency&gt;\n</code></pre>\n<p>But getting the same error.</p>\n<p>Please help me with some suggestions.</p>\n",
    "tags" : [ "java", "spring", "spring-boot", "spring-data-jpa" ],
    "owner" : {
      "account_id" : 2786527,
      "reputation" : 423,
      "user_id" : 2397788,
      "user_type" : "registered",
      "accept_rate" : 40,
      "profile_image" : "https://www.gravatar.com/avatar/be04f63f0e363176fa1e1667ba9d795a?s=256&d=identicon&r=PG",
      "display_name" : "java developer",
      "link" : "https://stackoverflow.com/users/2397788/java-developer"
    },
    "is_answered" : true,
    "view_count" : 148,
    "answer_count" : 3,
    "score" : 1,
    "last_activity_date" : 1744482651,
    "creation_date" : 1743981559,
    "link" : "https://stackoverflow.com/questions/79558849/unable-to-save-the-model-object-in-the-spring-boot-which-is-having-the-enum-prop",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79562755,
    "question_id" : 79558849,
    "body" : "<p>Finally i have resolved this issue in the following way.</p>\n<p>In the database i have modified the column type enum to varchar</p>\n<p><code>ALTER TABLE test_model  ALTER COLUMN create_process_status TYPE VARCHAR;</code></p>\n<p>In the model class for the enum property processStatusType i have added a converter like below:</p>\n<pre><code>@Column(name = &quot;create_process_status&quot;)\n@Convert(converter = ProcessStatusTypeConverter.class)\nprivate ProcessStatusType processStatusType;\n</code></pre>\n<p>Created Converter class like below:</p>\n<pre><code>import jakarta.persistence.AttributeConverter;\nimport jakarta.persistence.Converter;\nimport java.util.stream.Stream;\n\n@Converter(autoApply = false)\npublic class ProcessStatusTypeConverter implements AttributeConverter&lt;ProcessStatusType, String&gt; {\n\n    @Override\n    public String convertToDatabaseColumn(ProcessStatusType attribute) {\n        return attribute != null ? attribute.getType() : null;\n    }\n\n    @Override\n    public ProcessStatusType convertToEntityAttribute(String dbData) {\n        return Stream.of(ProcessStatusType.values())\n                     .filter(e -&gt; e.getType().equals(dbData))\n                     .findFirst()\n                     .orElseThrow(() -&gt; new IllegalArgumentException(&quot;Unknown enum value: &quot; + dbData));\n    }\n}\n</code></pre>\n",
    "score" : 1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 2786527,
      "reputation" : 423,
      "user_id" : 2397788,
      "user_type" : "registered",
      "accept_rate" : 40,
      "profile_image" : "https://www.gravatar.com/avatar/be04f63f0e363176fa1e1667ba9d795a?s=256&d=identicon&r=PG",
      "display_name" : "java developer",
      "link" : "https://stackoverflow.com/users/2397788/java-developer"
    },
    "creation_date" : 1744135295,
    "last_activity_date" : 1744135295,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79558886,
    "question_id" : 79558849,
    "body" : "<p>Not sure which database you are using, but in PostgreSQL you should define enum with uppercase</p>\n<pre><code>CREATE TYPE process_status_type AS ENUM ('COMPLETED', 'PROCESSING', 'FAILED');\n\nCREATE TABLE test_model (\n    id uuid,\n    process_status process_status_type\n);\n</code></pre>\n<p>and in java just define entity and enum without any converter</p>\n<pre><code>public enum ProcessStatusType {\n  COMPLETED, PROCESSING, FAILED\n}\n\n@Entity\n@Getter\n@Setter\npublic class TestModel {\n\n  @Id\n  @GeneratedValue(strategy = GenerationType.AUTO)\n  private UUID id;\n  @Enumerated(EnumType.STRING)\n  private ProcessStatusType processStatus;\n\n}\n\npublic interface TestModelRepository extends JpaRepository&lt;TestModel, UUID&gt; {\n\n}\n</code></pre>\n<p>and just save it as any other entity</p>\n<pre><code>TestModel testModel = new TestModel();\ntestModel.setProcessStatus(ProcessStatusType.PROCESSING);\ntestModelRepository.save(testModel);\n</code></pre>\n<p>and it will be stored in database</p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 7627495,
      "reputation" : 179,
      "user_id" : 5783522,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/384d94a95f826bd5cac9abd3e8da2a3a?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "nemojmenervirat",
      "link" : "https://stackoverflow.com/users/5783522/nemojmenervirat"
    },
    "creation_date" : 1743985756,
    "last_activity_date" : 1743985756,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79559432,
    "question_id" : 79558849,
    "body" : "<p>You haven't mentioned which DB you are using. Say, you're using PostgreSQL. You may follow below steps to resolve the error:</p>\n<ol>\n<li><p>Create custom  UserType to handle PostgreSQL enums.</p>\n<pre><code>import org.hibernate.type.EnumType;\nimport java.util.Properties;\n\npublic class PostgreSQLEnumType extends EnumType {\n    @Override\n    public void setParameterValues(Properties parameters) {\n        parameters.put(&quot;enumClass&quot;, ProcessStatusType.class.getName());\n        super.setParameterValues(parameters);\n    }\n}\n\n</code></pre>\n</li>\n</ol>\n<p>2. Update your entity field as below:</p>\n<pre><code>    @Enumerated(EnumType.STRING)\n        @Type(type = &quot;com.example.PostgreSQLEnumType&quot;) // Replace with your package name\n        @Column(name = &quot;create_process_status&quot;, columnDefinition = &quot;schema.enum_process_status_type&quot;)\n        private ProcessStatusType processStatusType;\n</code></pre>\n<p>3. Make sure you're using the correct dialect for PostgreSQL:</p>\n<p><code>spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect</code></p>\n<p>4.  Ensure that your database schema is correctly set up with the enum type:</p>\n<p><code>CREATE TYPE schema.enum_process_status_type AS ENUM ('completed', 'processing', 'failed');</code></p>\n<p><code>ALTER TABLE test_model ADD COLUMN create_process_status schema.enum_process_status_type DEFAULT 'completed';</code></p>\n<p>After the changes, restart your application and check if it works</p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 24948833,
      "reputation" : 38,
      "user_id" : 18813886,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a-/AOh14GjxwjRYh-IwnRo5O2_ORyqIoeV8x7joTw0qo0XW=k-s256",
      "display_name" : "Amit J.",
      "link" : "https://stackoverflow.com/users/18813886/amit-j"
    },
    "creation_date" : 1744015746,
    "last_activity_date" : 1744015746,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : {
    "79559432" : [ {
      "comment_id" : 140308228,
      "post_id" : 79559432,
      "body" : "yes same error.",
      "score" : 0,
      "owner" : {
        "account_id" : 2786527,
        "reputation" : 423,
        "user_id" : 2397788,
        "user_type" : "registered",
        "accept_rate" : 40,
        "profile_image" : "https://www.gravatar.com/avatar/be04f63f0e363176fa1e1667ba9d795a?s=256&d=identicon&r=PG",
        "display_name" : "java developer",
        "link" : "https://stackoverflow.com/users/2397788/java-developer"
      },
      "creation_date" : 1744036376,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140307674,
      "post_id" : 79559432,
      "body" : "Getting same error?",
      "score" : 0,
      "owner" : {
        "account_id" : 24948833,
        "reputation" : 38,
        "user_id" : 18813886,
        "user_type" : "registered",
        "profile_image" : "https://lh3.googleusercontent.com/a-/AOh14GjxwjRYh-IwnRo5O2_ORyqIoeV8x7joTw0qo0XW=k-s256",
        "display_name" : "Amit J.",
        "link" : "https://stackoverflow.com/users/18813886/amit-j"
      },
      "creation_date" : 1744027958,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140307378,
      "post_id" : 79559432,
      "body" : "I&#39;m using postgres database. Spring boot 3.4 internally it uses Hibernte 6.X. I tried above code not working.",
      "score" : 0,
      "owner" : {
        "account_id" : 2786527,
        "reputation" : 423,
        "user_id" : 2397788,
        "user_type" : "registered",
        "accept_rate" : 40,
        "profile_image" : "https://www.gravatar.com/avatar/be04f63f0e363176fa1e1667ba9d795a?s=256&d=identicon&r=PG",
        "display_name" : "java developer",
        "link" : "https://stackoverflow.com/users/2397788/java-developer"
      },
      "creation_date" : 1744023632,
      "content_license" : "CC BY-SA 4.0"
    } ],
    "79558886" : [ {
      "comment_id" : 140306538,
      "post_id" : 79558886,
      "body" : "It;s not working, getting the same error",
      "score" : 0,
      "owner" : {
        "account_id" : 2786527,
        "reputation" : 423,
        "user_id" : 2397788,
        "user_type" : "registered",
        "accept_rate" : 40,
        "profile_image" : "https://www.gravatar.com/avatar/be04f63f0e363176fa1e1667ba9d795a?s=256&d=identicon&r=PG",
        "display_name" : "java developer",
        "link" : "https://stackoverflow.com/users/2397788/java-developer"
      },
      "creation_date" : 1744007362,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}