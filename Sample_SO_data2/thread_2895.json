{
  "question" : {
    "question_id" : 79589552,
    "title" : "Collections.remove() vs Iterator.remove() performance-wise",
    "body" : "<p>I am traversing a list and want to remove a certain element that matches a condition. I also want to return that element. There are two ways I've come up with to do this.</p>\n<p>First:</p>\n<pre><code>for (int i = 0; i &lt; list.size(); i++) {\n    if (shouldBeRemoved(list.get(i)) {\n        E toRemove = list.get(i);\n        list.remove(i);\n        return toRemove;\n    }\n}\nreturn null;\n</code></pre>\n<p>Second:</p>\n<pre><code>Iterator&lt;E&gt; iterator = list.iterator();\nwhile (iterator.hasNext()) {\n    E element = iterator.next();\n    if (shouldBeRemoved(element)) {\n        iterator.remove();\n        return element;\n    }\n}\nreturn null;\n</code></pre>\n<p>I like the Iterator method, since it seems like the Iterator &quot;knows where it is&quot; and therefore shouldn't have to go through the list to find the thing to delete; the going-through happens alongside the search for the item itself. That's just speculation, though.</p>\n<p>Which one of these is more efficient/faster? Are there certain scenarios in which it is better to use one or the other?</p>\n<p>EDIT: The intended behavior is for only one element to be removed. The specific element that is to be removed doesn't matter, as long as it matches the condition.</p>\n<p>As a programmer, I know the specific implementation of List that is being used, but for the purposes of this question, I'd like to examine the performance of multiple different implementations, if it is relevant to the performance of the algorithm.</p>\n",
    "tags" : [ "java", "list", "performance" ],
    "owner" : {
      "account_id" : 18463907,
      "reputation" : 185,
      "user_id" : 13468313,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/26fc95693e4b2b6e916c27eeab95a2ed?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Foxler2010",
      "link" : "https://stackoverflow.com/users/13468313/foxler2010"
    },
    "is_answered" : true,
    "view_count" : 172,
    "answer_count" : 1,
    "score" : 3,
    "last_activity_date" : 1745685911,
    "creation_date" : 1745445518,
    "link" : "https://stackoverflow.com/questions/79589552/collections-remove-vs-iterator-remove-performance-wise",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79589567,
    "question_id" : 79589552,
    "body" : "<blockquote>\n<p>Which one of these is more efficient/faster? Are there certain scenarios in which it is better to use one or the other?</p>\n</blockquote>\n<p>They are about the same (and could be made slightly more so) for a random-access list such as an <code>ArrayList</code>, but the iterator-based solution is much more efficient for a sequential list, such as a <code>LinkedList</code>.</p>\n<p>This is because in a sequential list, each <code>get()</code> and each <code>remove()</code> needs to start at the beginning of the list and iterate through it to the specified index, so you have that iteration happening at least twice for each element to be removed (three times in the actual implementation you present).  On the other hand, the <code>Iterator</code> approach iterates through the whole list exactly once, no matter what specific type of list or how many elements are selected for removal.  Even if zero elements are removed, you can at best match that with an index-based approach.</p>\n<p>In view of that, the <code>Iterator</code>-based approach is probably to be preferred unless you have more specific information about what type of <code>List</code> you can expect, reflected in the declared type of <code>list</code>.</p>\n",
    "score" : 7,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 2792262,
      "reputation" : 190832,
      "user_id" : 2402272,
      "user_type" : "registered",
      "accept_rate" : 85,
      "profile_image" : "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=256&d=identicon&r=PG",
      "display_name" : "John Bollinger",
      "link" : "https://stackoverflow.com/users/2402272/john-bollinger"
    },
    "creation_date" : 1745446614,
    "last_activity_date" : 1745502285,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140365001,
    "post_id" : 79589552,
    "body" : "<i>I like the Iterator method, since it seems like the Iterator &quot;knows where it is&quot; ...</i> That’s a good argument and probably the best you can have. You readers are likely to think the same. I’d go for it.",
    "score" : 1,
    "owner" : {
      "account_id" : 7612423,
      "reputation" : 87409,
      "user_id" : 5772882,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/8283c64511fa80afed5259d10850168f?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Anonymous",
      "link" : "https://stackoverflow.com/users/5772882/anonymous"
    },
    "creation_date" : 1745492964,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140364995,
    "post_id" : 79589552,
    "body" : "<i>Which one of these is more efficient/faster?</i> We can’t know., You will have to make your own measurements using data that are realistic in your users’ setup. <a href=\"https://stackoverflow.com/questions/504103/how-do-i-write-a-correct-micro-benchmark-in-java\">How do I write a correct micro-benchmark in Java?</a>",
    "score" : 1,
    "owner" : {
      "account_id" : 7612423,
      "reputation" : 87409,
      "user_id" : 5772882,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/8283c64511fa80afed5259d10850168f?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Anonymous",
      "link" : "https://stackoverflow.com/users/5772882/anonymous"
    },
    "creation_date" : 1745492902,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140363516,
    "post_id" : 79589552,
    "body" : "@OldDogProgrammer in this case the <code>for</code> loop approach can&#39;t miss any elements since only one element (at most) is removed and the loop immediately terminates, but if it were altered to try to remove multiple elements it would have that problem.",
    "score" : 2,
    "owner" : {
      "account_id" : 318670,
      "reputation" : 16477,
      "user_id" : 636009,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/IIQJV.jpg?s=256",
      "display_name" : "David Conrad",
      "link" : "https://stackoverflow.com/users/636009/david-conrad"
    },
    "creation_date" : 1745453861,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140363439,
    "post_id" : 79589552,
    "body" : "<i>&quot;Are there certain scenarios in which it is better to use one or the other?&quot;</i>  Yes. Consider the <code>for</code> loop approach has the potential to not see some elements.  See <a href=\"https://stackoverflow.com/questions/1683519/how-do-i-remove-even-numbers-from-an-arraylist\" title=\"how do i remove even numbers from an arraylist\">stackoverflow.com/questions/1683519/&hellip;</a>  for an <code>ArrayList</code> example.",
    "score" : 0,
    "owner" : {
      "account_id" : 6606677,
      "reputation" : 1251,
      "user_id" : 5103317,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/c81d92487b054d7290b4f36562c0ee02?s=256&d=identicon&r=PG",
      "display_name" : "Old Dog Programmer",
      "link" : "https://stackoverflow.com/users/5103317/old-dog-programmer"
    },
    "creation_date" : 1745450839,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79589567" : [ {
      "comment_id" : 140380884,
      "post_id" : 79589567,
      "body" : "Quite so, @Holger, and this answer already points to that, though not quite so explicitly: &quot;<i>you have that iteration happening at least twice for each element to be removed (three times in the actual implementation you present)</i>&quot;.",
      "score" : 0,
      "owner" : {
        "account_id" : 2792262,
        "reputation" : 190832,
        "user_id" : 2402272,
        "user_type" : "registered",
        "accept_rate" : 85,
        "profile_image" : "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=256&d=identicon&r=PG",
        "display_name" : "John Bollinger",
        "link" : "https://stackoverflow.com/users/2402272/john-bollinger"
      },
      "creation_date" : 1745942099,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140380825,
      "post_id" : 79589567,
      "body" : "Of course, the index based approach would only need to iterate two times instead of three times by simply changing <code>E toRemove = list.get(i); list.remove(i); return toRemove;</code> to just <code>return list.remove(i);</code>",
      "score" : 1,
      "owner" : {
        "account_id" : 3211603,
        "reputation" : 301001,
        "user_id" : 2711488,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/t2hoD.jpg?s=256",
        "display_name" : "Holger",
        "link" : "https://stackoverflow.com/users/2711488/holger"
      },
      "creation_date" : 1745941316,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140373618,
      "post_id" : 79589567,
      "body" : "You&#39;re right, @user85421.  Slip of the keyboard.  And the same applies to removing elements via an <code>ArrayList</code>&#39;s iterator.  The fact to take away is that iterating indexes and using <code>get()</code> and <code>remove()</code> does not provide an improvement over iterating with an iterator and using its <code>remove()</code>.  The former is <i>worse</i> for some <code>List</code> implementations, but it cannot be better unless the <code>List</code> is implemented incompetently.",
      "score" : 1,
      "owner" : {
        "account_id" : 2792262,
        "reputation" : 190832,
        "user_id" : 2402272,
        "user_type" : "registered",
        "accept_rate" : 85,
        "profile_image" : "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=256&d=identicon&r=PG",
        "display_name" : "John Bollinger",
        "link" : "https://stackoverflow.com/users/2402272/john-bollinger"
      },
      "creation_date" : 1745755821,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140373253,
      "post_id" : 79589567,
      "body" : "( kind of <i>intuitive</i> since the elements after the deleted one must be moved to occupy the <i>empty</i> array position )",
      "score" : 2,
      "owner" : {
        "account_id" : 31180,
        "reputation" : 29752,
        "user_id" : 85421,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/kKvXH.gif?s=256",
        "display_name" : "user85421",
        "link" : "https://stackoverflow.com/users/85421/user85421"
      },
      "creation_date" : 1745741389,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140373242,
      "post_id" : 79589567,
      "body" : "@JohnBollinger - <code>remove()</code> is documented to &quot;<i>run in linear time (roughly speaking)</i>&quot;, not &quot;<i>constant time</i>&quot;  (<code>removeLast()</code> is documented as &quot;<i>constant time</i>&quot;)",
      "score" : 1,
      "owner" : {
        "account_id" : 31180,
        "reputation" : 29752,
        "user_id" : 85421,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/kKvXH.gif?s=256",
        "display_name" : "user85421",
        "link" : "https://stackoverflow.com/users/85421/user85421"
      },
      "creation_date" : 1745740941,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140372188,
      "post_id" : 79589567,
      "body" : "@Foxler2010, <a href=\"https://docs.oracle.com/en/java/javase/23/docs/api/java.base/java/util/ArrayList.html\" rel=\"nofollow noreferrer\">the API docs of <code>ArrayList</code></a> explicitly specify that its <code>get()</code> and <code>remove()</code> methods, among others, run in constant time.  That is also conveyed by the fact that this class implements the <code>RandomAccess</code> marker interface.  However, even if <code>list</code>&#39;s declared type is specifically <code>ArrayList</code>, that doesn&#39;t make using <code>get()</code> and <code>remove()</code> <i>better</i> than using the list&#39;s iterator for your purpose -- you get O(<i>n</i>) overall either way.",
      "score" : 1,
      "owner" : {
        "account_id" : 2792262,
        "reputation" : 190832,
        "user_id" : 2402272,
        "user_type" : "registered",
        "accept_rate" : 85,
        "profile_image" : "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=256&d=identicon&r=PG",
        "display_name" : "John Bollinger",
        "link" : "https://stackoverflow.com/users/2402272/john-bollinger"
      },
      "creation_date" : 1745686922,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140372175,
      "post_id" : 79589567,
      "body" : "Thinking back to what I know about arrays in memory, is it correct to say that <code>get()</code> and <code>remove()</code> in a Java <code>ArrayList</code> <i>don&#39;t</i> have to traverse the array to find the element? As in, the element&#39;s memory address is calculated based on the base address of the array and the offset from the index? Say I am using an <code>ArrayList</code>, is there a better method than the <code>Iterator</code> to accomplish my goal?",
      "score" : 0,
      "owner" : {
        "account_id" : 18463907,
        "reputation" : 185,
        "user_id" : 13468313,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/26fc95693e4b2b6e916c27eeab95a2ed?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "Foxler2010",
        "link" : "https://stackoverflow.com/users/13468313/foxler2010"
      },
      "creation_date" : 1745686384,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140365713,
      "post_id" : 79589567,
      "body" : "Acknowledged, @MarkRotteveel.  As I know you know, that makes indexed-based access to a <code>LinkedList</code> faster on average, but it does not fundamentally change the analysis presented here.",
      "score" : 1,
      "owner" : {
        "account_id" : 2792262,
        "reputation" : 190832,
        "user_id" : 2402272,
        "user_type" : "registered",
        "accept_rate" : 85,
        "profile_image" : "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=256&d=identicon&r=PG",
        "display_name" : "John Bollinger",
        "link" : "https://stackoverflow.com/users/2402272/john-bollinger"
      },
      "creation_date" : 1745502516,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140365694,
      "post_id" : 79589567,
      "body" : "Thanks @user85421.  You&#39;re quite right.  I removed the suggestion to use <code>removeIf()</code> for an <code>ArrayList</code>.",
      "score" : 1,
      "owner" : {
        "account_id" : 2792262,
        "reputation" : 190832,
        "user_id" : 2402272,
        "user_type" : "registered",
        "accept_rate" : 85,
        "profile_image" : "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=256&d=identicon&r=PG",
        "display_name" : "John Bollinger",
        "link" : "https://stackoverflow.com/users/2402272/john-bollinger"
      },
      "creation_date" : 1745502370,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140364411,
      "post_id" : 79589567,
      "body" : "In the Java <code>LinkedList</code> implementation, remove will start at the beginning <i>or</i> end, depending on the value of the index you want to remove.",
      "score" : 4,
      "owner" : {
        "account_id" : 213468,
        "reputation" : 110280,
        "user_id" : 466862,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=256&d=identicon&r=PG",
        "display_name" : "Mark Rotteveel",
        "link" : "https://stackoverflow.com/users/466862/mark-rotteveel"
      },
      "creation_date" : 1745483165,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140363319,
      "post_id" : 79589567,
      "body" : "but be aware that <code>removeIf</code> will remove ALL elements that satisfy the condition, while code posted in question returns after the first such element is found (without the <code>return</code> it <i>shows</i> a bug (?) : it would not remove the next element after a match, even if it also <i>matches</i> the condition)",
      "score" : 5,
      "owner" : {
        "account_id" : 31180,
        "reputation" : 29752,
        "user_id" : 85421,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/kKvXH.gif?s=256",
        "display_name" : "user85421",
        "link" : "https://stackoverflow.com/users/85421/user85421"
      },
      "creation_date" : 1745447386,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}