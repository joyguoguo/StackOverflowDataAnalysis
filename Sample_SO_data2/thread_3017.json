{
  "question" : {
    "question_id" : 79580510,
    "title" : "Springboot apache POI error reading .xlsx files",
    "body" : "<p>I am trying to read a .xlsx file with apache POI 5.3.0 version and getting below error</p>\n<pre><code>    java.lang.NoSuchMethodError: 'org.apache.commons.io.input.BoundedInputStream$Builder org.apache.commons.io.input.BoundedInputStream.builder()'\n        at org.apache.poi.util.IOUtils.peekFirstNBytes(IOUtils.java:153)\n        at org.apache.poi.poifs.filesystem.FileMagic.valueOf(FileMagic.java:209)\n        at org.apache.poi.openxml4j.opc.internal.ZipHelper.verifyZipHeader(ZipHelper.java:147)\n        at org.apache.poi.openxml4j.opc.internal.ZipHelper.openZipStream(ZipHelper.java:191)\n        at org.apache.poi.openxml4j.opc.ZipPackage.&lt;init&gt;(ZipPackage.java:210)\n        at org.apache.poi.openxml4j.opc.OPCPackage.open(OPCPackage.java:517)\n        at org.apache.poi.openxml4j.opc.OPCPackage.open(OPCPackage.java:490)\n        at org.apache.poi.ooxml.util.PackageHelper.open(PackageHelper.java:67)\n        at org.apache.poi.xssf.usermodel.XSSFWorkbook.&lt;init&gt;(XSSFWorkbook.java:315)\n        at org.apache.poi.xssf.usermodel.XSSFWorkbook.&lt;init&gt;(XSSFWorkbook.java:289)\n</code></pre>\n<p>The code where it is throwing the exception:</p>\n<pre><code>workbook = new XSSFWorkbook(file.getInputStream());\n</code></pre>\n<p>I even tried with latest versions of apache POI and POI-OOXML 5.4.1 and still getting same error. GPT says need to use commons-io dependency &gt; 2.13.I have 2.14.0 in my pom and still does not work.</p>\n",
    "tags" : [ "java", "maven", "apache-poi" ],
    "owner" : {
      "account_id" : 16433857,
      "reputation" : 41,
      "user_id" : 11871948,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/e5bcb11739b17aace39f2aaa0b99bdf6?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "prashanth",
      "link" : "https://stackoverflow.com/users/11871948/prashanth"
    },
    "is_answered" : true,
    "view_count" : 1074,
    "answer_count" : 2,
    "score" : 1,
    "last_activity_date" : 1744969809,
    "creation_date" : 1744955980,
    "link" : "https://stackoverflow.com/questions/79580510/springboot-apache-poi-error-reading-xlsx-files",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79580798,
    "question_id" : 79580510,
    "body" : "<p>The <code>BoundedInputStream.builder()</code> method was introduced in a relatively recent version of Commons IO (in 2.12.0 or later). If your project is using an older version of Commons IO, or if there's a conflict in your classpath, POI will try to call a method that doesn't exist, resulting in the <code>NoSuchMethodError</code>.</p>\n<p>The most reliable solution is to explicitly declare the correct version of Apache Commons IO as a dependency in your project's build file. This will override any transitive dependencies or conflicting versions.</p>\n<p><strong>Maven (<code>pom.xml</code>):</strong></p>\n<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;\n    &lt;artifactId&gt;commons-io&lt;/artifactId&gt;\n    &lt;version&gt;2.15.1&lt;/version&gt; &lt;!-- Use the latest version --&gt;\n&lt;/dependency&gt;\n</code></pre>\n",
    "score" : 2,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 10927511,
      "reputation" : 3218,
      "user_id" : 8031784,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/ikcJL.png?s=256",
      "display_name" : "Aniruddh Parihar",
      "link" : "https://stackoverflow.com/users/8031784/aniruddh-parihar"
    },
    "creation_date" : 1744969809,
    "last_activity_date" : 1744969809,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79580564,
    "question_id" : 79580510,
    "body" : "<p>Upgrading commons-io to latest version fixed the issue</p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 16433857,
      "reputation" : 41,
      "user_id" : 11871948,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/e5bcb11739b17aace39f2aaa0b99bdf6?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "prashanth",
      "link" : "https://stackoverflow.com/users/11871948/prashanth"
    },
    "creation_date" : 1744959161,
    "last_activity_date" : 1744963470,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140347064,
    "post_id" : 79580510,
    "body" : "&quot;GTP says&quot;: Well GTP is wrong. <a href=\"https://mvnrepository.com/artifact/org.apache.poi/poi/5.3.0\" rel=\"nofollow noreferrer\">Apache POI Common &#187; 5.3.0</a> needs commons-io &#187; commons-io version 2.16.1. <a href=\"https://mvnrepository.com/artifact/org.apache.poi/poi/5.4.1\" rel=\"nofollow noreferrer\">Apache POI Common &#187; 5.4.1</a> needs commons-io &#187; commons-io version 2.18.0.",
    "score" : 3,
    "owner" : {
      "account_id" : 4853829,
      "reputation" : 62539,
      "user_id" : 3915431,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/27fffe0285cffa43de087072abd25c95?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Axel Richter",
      "link" : "https://stackoverflow.com/users/3915431/axel-richter"
    },
    "creation_date" : 1744957384,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}