{
  "question" : {
    "question_id" : 79769674,
    "title" : "How to secure apis from cross origin request?",
    "body" : "<p>I am trying to ensure that the APIS can only be accessed from browsers without logging in.\nHere is one website which is doing the same: <a href=\"https://www.onefinestay.com\" rel=\"nofollow noreferrer\">https://www.onefinestay.com</a> , now, if you open this and try to copy curl and access it via Postman or terminal, it will block you.</p>\n<p>On further investigation, I got to know that they are using Google CAPTCHA invisible v3 to get a cookie, which is used to authenticate the User and provide a session ID, which the backend returns to the frontend. Later, all APIs are called using this. But when I replicated this in Spring Boot, I am able to achieve the same, but when I copy the curl it loads the data. If I change one header, it blocks automatically, but I am unable to understand how the above pinned site is able to do it.</p>\n<p>I have a session filter and session store class and security configuration for CORS setting, yet I am unable to do.\nI even secured the endpoint by adding authentication in security</p>\n<pre><code>@Configuration\n\n@EnableWebSecurity\n\npublic class SecurityConfig {\n\nprivate final SessionFilter sessionFilter;\n\npublic SecurityConfig(SessionFilter sessionFilter) {\n    this.sessionFilter = sessionFilter;\n}\n\n@Bean\npublic SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {\n    http\n            .csrf(csrf -&gt; csrf.disable())\n            .cors(cors -&gt; {}) // enable CORS handling\n            .authorizeHttpRequests(auth -&gt; auth\n                    .requestMatchers(&quot;/auth/browser-handshake&quot;).permitAll()\n                    .requestMatchers(&quot;/v1/search/**&quot;).authenticated()\n                    .anyRequest().denyAll()\n            )\n            .addFilterBefore(sessionFilter, UsernamePasswordAuthenticationFilter.class);\n\n    return http.build();\n}\n}\n</code></pre>\n<p>And now it throws 403. If I permit it, then it will be accessible via Postman or the terminal. How to handle it.</p>\n",
    "tags" : [ "java", "spring-boot", "recaptcha-v3" ],
    "owner" : {
      "account_id" : 18785720,
      "reputation" : 149,
      "user_id" : 13699359,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a-/AOh14GgPmw_Qjgm-w5FuQnv3G7AYaC6En43xUPWkinYmxQ=k-s256",
      "display_name" : "Jay Sabnis",
      "link" : "https://stackoverflow.com/users/13699359/jay-sabnis"
    },
    "is_answered" : false,
    "view_count" : 64,
    "answer_count" : 0,
    "score" : 1,
    "last_activity_date" : 1758454262,
    "creation_date" : 1758294977,
    "link" : "https://stackoverflow.com/questions/79769674/how-to-secure-apis-from-cross-origin-request",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140750119,
    "post_id" : 79769674,
    "body" : "yes i tried it, but copying curl will bypass it.",
    "score" : 0,
    "owner" : {
      "account_id" : 18785720,
      "reputation" : 149,
      "user_id" : 13699359,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a-/AOh14GgPmw_Qjgm-w5FuQnv3G7AYaC6En43xUPWkinYmxQ=k-s256",
      "display_name" : "Jay Sabnis",
      "link" : "https://stackoverflow.com/users/13699359/jay-sabnis"
    },
    "creation_date" : 1758441989,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140747931,
    "post_id" : 79769674,
    "body" : "Did you try <code>setAllowedOrigins</code>?  What are the actual cors configuration that have been tried so far?",
    "score" : 0,
    "owner" : {
      "account_id" : 8909811,
      "reputation" : 2861,
      "user_id" : 6650475,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/fe85994d05ad7aaaa1c47d638b37bc45?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Andrew S",
      "link" : "https://stackoverflow.com/users/6650475/andrew-s"
    },
    "creation_date" : 1758305628,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}