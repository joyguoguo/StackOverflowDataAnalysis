{
  "question" : {
    "question_id" : 79799358,
    "title" : "GRPC service is not accessible via Eureka",
    "body" : "<p>I have a microservices setup with the following services:</p>\n<ul>\n<li><p>ECOM Service</p>\n</li>\n<li><p>API Gateway</p>\n</li>\n<li><p>NOTIFICATION-SERVICE (Spring gRPC-based service)</p>\n</li>\n</ul>\n<p>Iâ€™m trying to make the <code>ECOM</code> service communicate with the <code>NOTIFICATION-SERVICE</code>.<br />\nThe communication works perfectly when I configure the gRPC client in <strong>static mode</strong></p>\n<p>However, when I switch to <strong>discovery mode</strong> (using Eureka/Consul), the connection fails.</p>\n<p>ECOM</p>\n<pre><code>spring.application.name=ecom\nserver.port=${APPLICATION_PORT:8080}\n\n\nspring.datasource.url=${DB_URL}\nspring.datasource.username=${DB_USERNAME}\nspring.datasource.password=${DB_PASSWORD}\nspring.datasource.driver-class-name=org.postgresql.Driver\nspring.jpa.hibernate.ddl-auto=update\nspring.security.jwt.secret=${Hs256SecretKey:Evb7Mepwi49E8pXiFehyF4cI54+POA9dr1OjtpyhVkc=}\n\n\neureka.instance.hostname=localhost\neureka.instance.prefer-ip-address=false\neureka.client.register-with-eureka=false\neureka.client.fetch-registry=true\neureka.client.service-url.defaultZone=http://${eureka.instance.hostname}:8761/eureka/\n\n\ngrpc.client.NOTIFICATION-SERVICE-CLIENT.address=discovery:///NOTIFICATION-SERVICE\ngrpc.client.NOTIFICATION-SERVICE-CLIENT.negotiation-type=plaintext\nnet.devh.boot.grpc.client.nameresolver.discovery-client.service-metadata-keys=grpc_port\ngrpc.discovery.enabled=true\n</code></pre>\n<p>NOTIFICATION-SERVICE</p>\n<pre><code>spring.application.name=notification-service\n\n\ngrpc.server.port=9090\ngrpc.server.enable-reflection=true\n\neureka.instance.hostname=10.164.200.38\neureka.instance.prefer-ip-address=true\neureka.instance.metadata-map.grpc_port=${grpc.server.port}\n\n\neureka.client.register-with-eureka=true\neureka.client.fetch-registry=false\neureka.client.service-url.defaultZone=http://${eureka.instance.hostname}:8761/eureka/\n</code></pre>\n<p>I had verified that NOTIFICATION-SERVICE got registered with Eureka as well through the eureka UI</p>\n<p><img src=\"https://i.sstatic.net/JfSI7lK2.png\" alt=\"Eureka UI Displaying registered services\" /></p>\n<p>In the UI i can see the port is not displayed for the notification-server , The actual error which i am getting is .</p>\n<pre><code>`io.grpc.StatusRuntimeException: UNAVAILABLE: Network closed for unknown reason\n    at io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:368) ~[grpc-stub-1.74.0.jar:1.74.0]\n    at io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:349) ~[grpc-stub-1.74.0.jar:1.74.0]\n    at io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:174) ~[grpc-stub-1.74.0.jar:1.74.0]\n    at com.learning.common.NotificationServiceGrpc$NotificationServiceBlockingStub.sendNotification(NotificationServiceGrpc.java:196) ~[common-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]\n    at com.generic.ecom.view.Services.NotificationServiceGRPCClient.sendNotification(NotificationServiceGRPCClient.java:20) ~[classes/:na]\n    at com.generic.ecom.controller.HomepageController.getProduct(HomepageController.java:37) ~[classes/:na]\n    at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]\n    at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]\n`\n</code></pre>\n<p>Thanks for the time.</p>\n",
    "tags" : [ "java", "spring-boot", "netflix-eureka", "grpc-java" ],
    "owner" : {
      "account_id" : 19567500,
      "reputation" : 61,
      "user_id" : 14319298,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/d685fec6b7ee5078a6e7b9aca7650426?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Bharathwajan",
      "link" : "https://stackoverflow.com/users/14319298/bharathwajan"
    },
    "is_answered" : false,
    "view_count" : 58,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1761380193,
    "creation_date" : 1761375259,
    "link" : "https://stackoverflow.com/questions/79799358/grpc-service-is-not-accessible-via-eureka",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79799386,
    "question_id" : 79799358,
    "body" : "<p>The problem is with Case Sensitivity , I changed from grpc to gRPC .</p>\n<p>In ECOM</p>\n<pre><code>net.devh.boot.grpc.client.nameresolver.discovery-client.service-metadata-keys=gRPC_port\n</code></pre>\n<p>In NOTIFICATION-SERVICE :</p>\n<pre><code>eureka.instance.metadata-map.gRPC_port=${grpc.server.port}\n</code></pre>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 19567500,
      "reputation" : 61,
      "user_id" : 14319298,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/d685fec6b7ee5078a6e7b9aca7650426?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Bharathwajan",
      "link" : "https://stackoverflow.com/users/14319298/bharathwajan"
    },
    "creation_date" : 1761380193,
    "last_activity_date" : 1761380193,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : { }
}