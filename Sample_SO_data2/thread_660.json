{
  "question" : {
    "question_id" : 79788830,
    "title" : "Continuous profiling with async-profiler. Generate heatmap for several JFRs",
    "body" : "<p><strong>tl;dr</strong>: I'm trying to create a single daily heatmap by combining multiple hourly JFR files from async-profiler's continuous profiling feature. When I pass multiple files to <code>jfrconv</code>, the output only contains data from the last file provided. Is there a correct way to merge them into a <strong>single daily heatmap</strong>?</p>\n<p>Long version:</p>\n<p>Does anyone use the new continuous profiling feature in async-profiler? I recently <a href=\"https://github.com/async-profiler/async-profiler/blob/master/docs/Heatmap.md\" rel=\"nofollow noreferrer\">learned</a> that you can generate a heatmap from a JFR file.</p>\n<p>I enabled profiling for my application with the following command:</p>\n<pre><code>-agentpath:/path/to/async-profiler-4.0-linux-x64/lib/libasyncProfiler.so=start,event=cpu,alloc=2m,loop=1h,file=profile-%%t.jfr\n</code></pre>\n<p>this generates a series of files for every hour of my application's runtime, like so:</p>\n<ul>\n<li>profile-20251010-180649.jfr</li>\n<li>profile-20251010-190649.jfr</li>\n<li>profile-20251010-200649.jfr</li>\n<li>.... and so on ...</li>\n</ul>\n<p>I can convert a single file into a heatmap, which works fine, but the result is a heatmap for only one hour:</p>\n<pre><code>jfrconv -o heatmap ./profile-20251010-190649.jfr /tmp/heatmap.html\n</code></pre>\n<p>My goal is to generate a single heatmap from all the profile-*.jfr files for an entire day.</p>\n<p>the <code>jfrconv --help</code> output says it allows multiple input files:</p>\n<pre><code>Usage: jfrconv [options] &lt;input&gt; [&lt;input&gt;...] &lt;output&gt;\n</code></pre>\n<p>However, when I tried to run it with multiple files:</p>\n<pre><code>$ jfrconv -o heatmap profile-20251010-180649.jfr profile-20251010-190649.jfr  /tmp/heatmap.html\nConverting profile-20251010-180649.jfr -&gt; heatmap.html # 0.186 s\nConverting profile-20251010-190649.jfr -&gt; heatmap.html # 0.109 s\n</code></pre>\n<p>Although the tool reports that it converted both input files, the resulting heatmap only contains data from the last file (<code>profile-20251010-190649.jfr</code>).</p>\n<p>Is this the expected behavior? I would also appreciate any advice on how to use this feature correctly in production.</p>\n",
    "tags" : [ "java", "heatmap", "async-profiler" ],
    "owner" : {
      "account_id" : 2798196,
      "reputation" : 728,
      "user_id" : 2406992,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/46515a3b269abca93fb80ec4dd99cf03?s=256&d=identicon&r=PG",
      "display_name" : "QIvan",
      "link" : "https://stackoverflow.com/users/2406992/qivan"
    },
    "is_answered" : false,
    "view_count" : 212,
    "answer_count" : 1,
    "score" : 1,
    "last_activity_date" : 1760311264,
    "creation_date" : 1760308820,
    "link" : "https://stackoverflow.com/questions/79788830/continuous-profiling-with-async-profiler-generate-heatmap-for-several-jfrs",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79788839,
    "question_id" : 79788830,
    "body" : "<p>hmmm... it looks like you can just combine several JFRs with simple</p>\n<pre><code>cat ./profile-* &gt; /tmp/profile.jfr\n</code></pre>\n<p>and then generate a heatmap for all of the profile files:</p>\n<pre><code>jfrconv -o heatmap ./profile.jfr  /tmp/heatmap.html\n</code></pre>\n<p>at least it works and the result heatmap looks okay (it shows a graph for several hours), but I'm not sure if I didn't lose any data with this approach.</p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 2798196,
      "reputation" : 728,
      "user_id" : 2406992,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/46515a3b269abca93fb80ec4dd99cf03?s=256&d=identicon&r=PG",
      "display_name" : "QIvan",
      "link" : "https://stackoverflow.com/users/2406992/qivan"
    },
    "creation_date" : 1760311264,
    "last_activity_date" : 1760311264,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : { }
}