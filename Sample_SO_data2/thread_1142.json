{
  "question" : {
    "question_id" : 79743296,
    "title" : "Dynamically determining foreground based on its actual background",
    "body" : "<p>Here's a problem.</p>\n<p>With Windows L&amp;F, whose default selection background is white, selected text snippets that are highlighted with yellow are going to be hard to read (see the second screenshot).</p>\n<p>We have logic for dynamically determining the best foreground color based on the background's luminosity. I can pass any color to that utility method, not necessarily something stored in a <code>background</code> property.</p>\n<p>The important consideration is the highlight color is <strong>not</strong> the same as the background (which stays the same — blue in my case).</p>\n<p>Basically, it seems I need to dynamically determine the foreground color based on its <em>actual</em> background (and <em>not</em> the <code>background</code> property). Even if I override <code>getForeground()</code>, I still need to somehow access that information. Which is tricky since I don't know which exact portion of the text Swing is about to paint (whether it's highlighted or not).</p>\n<p>How do I solve this problem?</p>\n<p>Java 8.</p>\n<p><a href=\"https://i.sstatic.net/19wGyMg3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/19wGyMg3.png\" alt=\"enter image description here\" /></a></p>\n<p><a href=\"https://i.sstatic.net/26ca2OhM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/26ca2OhM.png\" alt=\"enter image description here\" /></a></p>\n<pre class=\"lang-java prettyprint-override\"><code>package demos.text;\n\nimport com.sun.java.swing.plaf.windows.WindowsLookAndFeel;\n\nimport javax.swing.JFrame;\nimport javax.swing.JPanel;\nimport javax.swing.JTextArea;\nimport javax.swing.UIManager;\nimport javax.swing.UnsupportedLookAndFeelException;\nimport javax.swing.WindowConstants;\nimport javax.swing.text.BadLocationException;\nimport javax.swing.text.DefaultHighlighter;\nimport java.awt.BorderLayout;\nimport java.awt.Color;\nimport java.awt.Container;\nimport java.awt.Font;\n\npublic class HighlighterDemo {\n\n    private static final DefaultHighlighter.DefaultHighlightPainter painter = new DefaultHighlighter.DefaultHighlightPainter(Color.YELLOW);\n\n    public static void main(String[] args) throws BadLocationException, UnsupportedLookAndFeelException, ClassNotFoundException, InstantiationException, IllegalAccessException {\n        UIManager.setLookAndFeel(WindowsLookAndFeel.class.getName());\n        Container mainPanel = createMainPanel();\n        JFrame frame = new JFrame(&quot;Highlighter Demo&quot;);\n        frame.setContentPane(mainPanel);\n        frame.setLocationRelativeTo(null);\n        frame.pack();\n        frame.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);\n        frame.setVisible(true);\n    }\n\n    private static JPanel createMainPanel() throws BadLocationException {\n        JPanel panel = new JPanel(new BorderLayout());\n        panel.add(createTextArea());\n        return panel;\n    }\n\n    private static JTextArea createTextArea() throws BadLocationException {\n        JTextArea textArea = new JTextArea();\n        textArea.setFont(new Font(&quot;Arial&quot;, Font.PLAIN, 20)); // the default font in nonsensically small\n        String text = &quot;Some sample text&quot;;\n        textArea.setText(text);\n        textArea.getHighlighter().addHighlight(text.indexOf(&quot;sample&quot;), text.indexOf(&quot;text&quot;), painter);\n        return textArea;\n    }\n}\n</code></pre>\n<p><strong>P.S.:</strong> In case you're interested, <a href=\"https://codereview.stackexchange.com/questions/297520/textsearchfield-search-field-for-jtextarea\">here's</a> what I use highlights for.</p>\n",
    "tags" : [ "java", "swing" ],
    "owner" : {
      "account_id" : 10187542,
      "reputation" : 2683,
      "user_id" : 20692967,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/NZSXm.jpg?s=256",
      "display_name" : "Sergey Zolotarev",
      "link" : "https://stackoverflow.com/users/20692967/sergey-zolotarev"
    },
    "is_answered" : false,
    "view_count" : 104,
    "answer_count" : 0,
    "score" : 1,
    "last_activity_date" : 1755868220,
    "creation_date" : 1755859138,
    "link" : "https://stackoverflow.com/questions/79743296/dynamically-determining-foreground-based-on-its-actual-background",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140685626,
    "post_id" : 79743296,
    "body" : "As Abra pointed out, JTextArea isn’t designed for this and neither is Highlighter.  It is possible to write your own HighlightPainter implementation, but it will have to draw the text in the new color and I found that it doesn’t look exactly like the text drawn by the native look-and-feel.  Your best option is using JTextPane, which is actually designed for this sort of thing.",
    "score" : 0,
    "owner" : {
      "account_id" : 2053598,
      "reputation" : 44991,
      "user_id" : 1831987,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/38b1c37530189ec4471a43a618e33f67?s=256&d=identicon&r=PG",
      "display_name" : "VGR",
      "link" : "https://stackoverflow.com/users/1831987/vgr"
    },
    "creation_date" : 1755889329,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140685219,
    "post_id" : 79743296,
    "body" : "@SergeyZolotarev have you read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> ? And if you have, did you see this part: <i>Before posting a question, we strongly recommend that you spend a reasonable amount of time researching the problem and searching for existing questions on this site that may provide an answer.</i>",
    "score" : 0,
    "owner" : {
      "account_id" : 2485939,
      "reputation" : 20969,
      "user_id" : 2164365,
      "user_type" : "registered",
      "accept_rate" : 40,
      "profile_image" : "https://i.sstatic.net/RKSgV.png?s=256",
      "display_name" : "Abra",
      "link" : "https://stackoverflow.com/users/2164365/abra"
    },
    "creation_date" : 1755878277,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140684819,
    "post_id" : 79743296,
    "body" : "@Abra no, I ventured to guess this problem hasn&#39;t been discussed here on SO before",
    "score" : 0,
    "owner" : {
      "account_id" : 10187542,
      "reputation" : 2683,
      "user_id" : 20692967,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/NZSXm.jpg?s=256",
      "display_name" : "Sergey Zolotarev",
      "link" : "https://stackoverflow.com/users/20692967/sergey-zolotarev"
    },
    "creation_date" : 1755869543,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140684769,
    "post_id" : 79743296,
    "body" : "Did you try <a href=\"https://stackoverflow.com/search?q=%5Bswing%5D+jtextpane+highlight+color\">searching</a>?",
    "score" : 0,
    "owner" : {
      "account_id" : 2485939,
      "reputation" : 20969,
      "user_id" : 2164365,
      "user_type" : "registered",
      "accept_rate" : 40,
      "profile_image" : "https://i.sstatic.net/RKSgV.png?s=256",
      "display_name" : "Abra",
      "link" : "https://stackoverflow.com/users/2164365/abra"
    },
    "creation_date" : 1755868475,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140684756,
    "post_id" : 79743296,
    "body" : "@VGR it&#39;s just a demo, man",
    "score" : 0,
    "owner" : {
      "account_id" : 10187542,
      "reputation" : 2683,
      "user_id" : 20692967,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/NZSXm.jpg?s=256",
      "display_name" : "Sergey Zolotarev",
      "link" : "https://stackoverflow.com/users/20692967/sergey-zolotarev"
    },
    "creation_date" : 1755868252,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140684743,
    "post_id" : 79743296,
    "body" : "I would say you are using the wrong <i>Swing</i> component. You should use <a href=\"https://docs.oracle.com/javase/tutorial/uiswing/components/editorpane.html\" rel=\"nofollow noreferrer\">JTextPane</a> rather than <code>JTextArea</code>. There are also several books that describe how to use <code>JTextPane</code>. My favorite is <a href=\"https://rads.stackoverflow.com/amzn/click/com/0130832928\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\">Core Swing: Advanced Programming</a> by Kim Topley.",
    "score" : 1,
    "owner" : {
      "account_id" : 2485939,
      "reputation" : 20969,
      "user_id" : 2164365,
      "user_type" : "registered",
      "accept_rate" : 40,
      "profile_image" : "https://i.sstatic.net/RKSgV.png?s=256",
      "display_name" : "Abra",
      "link" : "https://stackoverflow.com/users/2164365/abra"
    },
    "creation_date" : 1755867936,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140684627,
    "post_id" : 79743296,
    "body" : "<code>UIManager.setLookAndFeel(WindowsLookAndFeel.class.getName())&zwnj;&#8203;;</code> ← This will fail when running on non-Windows machines.  Use <code>UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClass&zwnj;&#8203;Name())</code> instead, which will work everywhere.",
    "score" : 2,
    "owner" : {
      "account_id" : 2053598,
      "reputation" : 44991,
      "user_id" : 1831987,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/38b1c37530189ec4471a43a618e33f67?s=256&d=identicon&r=PG",
      "display_name" : "VGR",
      "link" : "https://stackoverflow.com/users/1831987/vgr"
    },
    "creation_date" : 1755865183,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}