{
  "question" : {
    "question_id" : 79741609,
    "title" : "Kafka AckMode COUNT_TIME Behavior",
    "body" : "<p>We are using Springboot Kafkalistner annotation to listen to a Kafka topic. In the consumer config, i have set ack mode to COUNT_TIME with the ackCount at 2000 and ackTime to 1 minute and the listener is polling for 100 messages at a time (max.poll.records=100). I have created this config to handle more time for the batch of listeners to process and the 1 minute to handle any scenario when the count is not met so we don't end up waiting forever.</p>\n<p>With this, I published about 500K messages to this topic. My expectation was that the offset commit to happen every 2000 messages consumed and the messagesBehind count for the consumer group to go down in decrements of 2000. However, I see the messages behind stay very high and they went down from 500K to 380K to 250K to 125K to 0. I did not see any intermediate counts. Does that mean the offsets are not happening on every 2000 messages and instead happening only for around 100K messages at a time? Is this expected? What would be the impact on this to the broker, if any? how do we address this?</p>\n<p>Thank you</p>\n",
    "tags" : [ "java", "spring-boot", "spring-kafka", "kafka-consumer-api" ],
    "owner" : {
      "account_id" : 18044566,
      "reputation" : 325,
      "user_id" : 13115896,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/6d35ea24f31161f110fed75caf9d2d04?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "sg2000",
      "link" : "https://stackoverflow.com/users/13115896/sg2000"
    },
    "is_answered" : false,
    "view_count" : 95,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1758490726,
    "creation_date" : 1755725966,
    "link" : "https://stackoverflow.com/questions/79741609/kafka-ackmode-count-time-behavior",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140684896,
    "post_id" : 79741609,
    "body" : "ok Thx, will give it a try",
    "score" : 0,
    "owner" : {
      "account_id" : 18044566,
      "reputation" : 325,
      "user_id" : 13115896,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/6d35ea24f31161f110fed75caf9d2d04?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "sg2000",
      "link" : "https://stackoverflow.com/users/13115896/sg2000"
    },
    "creation_date" : 1755871113,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140683140,
    "post_id" : 79741609,
    "body" : "No, I&#39;m suggesting implement/turn on these metrics ON your consumer, and then observe it through logs/metrics endpoints/observability systems you use",
    "score" : 0,
    "owner" : {
      "account_id" : 7692774,
      "reputation" : 1282,
      "user_id" : 5828464,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/de54db63fab1e3c3d00d0dbef1a0a0f1?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Yuri G",
      "link" : "https://stackoverflow.com/users/5828464/yuri-g"
    },
    "creation_date" : 1755806455,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140682995,
    "post_id" : 79741609,
    "body" : "how can i do that? do you suggest looking at the consumer offsets topic?",
    "score" : 0,
    "owner" : {
      "account_id" : 18044566,
      "reputation" : 325,
      "user_id" : 13115896,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/6d35ea24f31161f110fed75caf9d2d04?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "sg2000",
      "link" : "https://stackoverflow.com/users/13115896/sg2000"
    },
    "creation_date" : 1755802363,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140682623,
    "post_id" : 79741609,
    "body" : "Why don&#39;t you look at &amp; track actual offsets you&#39;re processing at your consumer side? Then you&#39;d have an actual picture instead of relying on god-knows-how refreshed number at some obscure UI.",
    "score" : 0,
    "owner" : {
      "account_id" : 7692774,
      "reputation" : 1282,
      "user_id" : 5828464,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/de54db63fab1e3c3d00d0dbef1a0a0f1?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Yuri G",
      "link" : "https://stackoverflow.com/users/5828464/yuri-g"
    },
    "creation_date" : 1755792004,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140682599,
    "post_id" : 79741609,
    "body" : "yes thats where i was seeing these high #s",
    "score" : 0,
    "owner" : {
      "account_id" : 18044566,
      "reputation" : 325,
      "user_id" : 13115896,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/6d35ea24f31161f110fed75caf9d2d04?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "sg2000",
      "link" : "https://stackoverflow.com/users/13115896/sg2000"
    },
    "creation_date" : 1755791372,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140682559,
    "post_id" : 79741609,
    "body" : "You look at &quot;Messages Behind&quot; in Kafka UI, ain&#39;t you?",
    "score" : 0,
    "owner" : {
      "account_id" : 7692774,
      "reputation" : 1282,
      "user_id" : 5828464,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/de54db63fab1e3c3d00d0dbef1a0a0f1?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Yuri G",
      "link" : "https://stackoverflow.com/users/5828464/yuri-g"
    },
    "creation_date" : 1755790163,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}