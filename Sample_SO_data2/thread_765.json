{
  "question" : {
    "question_id" : 79778601,
    "title" : "Layers of timeout in an Istio+k8s managed cluster",
    "body" : "<p>I have a cluster of microservices. UI calls API1 (assuming it goes through ingress gateway, correct me if I am wrong), API1 calls API2 via RestTemplate.</p>\n<p>The API2 process is bulky and takes roughly 1.5 minutes to complete, however there are no errors or exceptions in the process itself. For testing purposes, I called API2 directly via Bruno (whcih is set with a sufficiently large timeout value) which gives a socket hangup around 1 minute which is expected as the AWS LB connection idle timeout is 1 min. But from Chrome's network tab I see the timing of the call to succesfully complete with waiting for server time to be 1.5 minutes.</p>\n<p>I understand istio has a default of 2 retries for connection failures, and timeout is disabled. My question is that why when calling from the UI it is successful after 1.5 minutes rather than waiting for 3 minutes and failing. Are the pods behaving in a way that I don't understand? My understanding is that after 1 minute socket gets closed and a retry kicks off, but that should also fail and kickoff the 2nd retry. Again, that should also fail after the next minute. Is the socket somehow reopened within the total time of 3x1=3 minutes and the call is successful because it takes less than 3 minutes?</p>\n<p>P.S. I am a Junior developer who is just getting into the devops world of cluster orchestration, service mesh, etc. Any clarification is deeply appreciated.</p>\n<p>I changed the LB connection idle timeout to a higher value and the call was successful in Bruno as expected. I put arbritrarily large sleep times in the process and altered the idle time out values to get expected results.\nBut I don't understand the difference I am seeing in Chrome(UI-&gt;API1-&gt;API2) vs calling (Bruno-&gt;API2).\nI read the docs and scoured google with no satisfactory answer.</p>\n",
    "tags" : [ "java", "kubernetes", "istio", "istio-gateway" ],
    "owner" : {
      "account_id" : 26530398,
      "reputation" : 1,
      "user_id" : 20162691,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/842a7c8fea8816bcb61aea0c89e15186?s=256&d=identicon&r=PG",
      "display_name" : "coderbd",
      "link" : "https://stackoverflow.com/users/20162691/coderbd"
    },
    "is_answered" : false,
    "view_count" : 106,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1759910739,
    "creation_date" : 1759188734,
    "link" : "https://stackoverflow.com/questions/79778601/layers-of-timeout-in-an-istiok8s-managed-cluster",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79785206,
    "question_id" : 79778601,
    "body" : "<p>Multiple timeout layers (load balancer, ingress, Istio sidecars, HTTP client) can each cut off the call, it’s not that socket “reopens.” To fix this, extend or disable the timeout at each layer, or break the long-running operation into an async or polling pattern.</p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 44214824,
      "reputation" : 11,
      "user_id" : 31636693,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/d0b22a0f38e6bbb185afba6447940ac6?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "EasyPea",
      "link" : "https://stackoverflow.com/users/31636693/easypea"
    },
    "creation_date" : 1759910739,
    "last_activity_date" : 1759910739,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140767732,
    "post_id" : 79778601,
    "body" : "IME there are frequently enough proxies and timeouts (an out-of-cluster load balancer, the cluster ingress gateway, the Istio server and client proxies, the service itself) that it&#39;s not productive to try to set the timeouts longer than 60 seconds: there are too many places to change and too many possible accidents from infrastructure changes.  If your HTTP service is taking longer than 10 seconds or so, restructure it to produce some sort of asynchronous result, like HTTP 202 with a pollable URL.",
    "score" : 2,
    "owner" : {
      "account_id" : 13863020,
      "reputation" : 164909,
      "user_id" : 10008173,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/bc86d913c15f3b126673faa654e9668c?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "David Maze",
      "link" : "https://stackoverflow.com/users/10008173/david-maze"
    },
    "creation_date" : 1759194756,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}