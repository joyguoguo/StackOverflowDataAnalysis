{
  "question" : {
    "question_id" : 79728203,
    "title" : "How do I set visibility of sheet, row or column?",
    "body" : "<p>Setting visibility of sheets, rows or columns does not work using <code>XPropertySet::setPropertyValue()</code>. It does not throw an exception or anything, it just does not change the property value.\nI am not sure if this is intended, I couldn't find anything about it in their documentation.</p>\n<p>I use a very similar code for Draw/Impress-type documents and it works perfectly fine.</p>\n<p>The intention is to preprocess the file and then convert it to pdf via jodconverter.</p>\n<p>My current code:</p>\n<pre><code>private void processCalc(@NonNull XComponent document) throws Exception {\n    foreachSheet(document, sheet -&gt; {\n        setProperty(sheet, &quot;IsVisible&quot;, true);\n\n        final var cursor = sheet.createCursor();\n\n        final var usedAreaCursor = Lo.qi(XUsedAreaCursor.class, cursor);\n        usedAreaCursor.gotoStartOfUsedArea(false);\n        usedAreaCursor.gotoEndOfUsedArea(true);\n\n        final var columnRowRange = Lo.qi(XColumnRowRange.class, usedAreaCursor);\n        setVisible(columnRowRange.getRows());\n        setVisible(columnRowRange.getColumns());\n    });\n}\n\nprivate static void setVisible(XInterface x) throws IndexOutOfBoundsException, WrappedTargetException, PropertyVetoException, UnknownPropertyException {\n    final var indexAccess = Lo.qi(XIndexAccess.class, x);\n    for (int i = 0; i &lt; indexAccess.getCount(); i++) {\n        final var byIndex = indexAccess.getByIndex(i);\n        final var range = Lo.qi(XCellRange.class, byIndex);\n        setProperty(range, &quot;IsVisible&quot;, true);\n    }\n}\n\npublic static void setProperty(XInterface object, String name, boolean value) throws PropertyVetoException, WrappedTargetException, UnknownPropertyException {\n    final var propertySet = Lo.qi(XPropertySet.class, object);\n    propertySet.setPropertyValue(name, value);\n}\n\npublic static void foreachSheet(XComponent document, FailableConsumer&lt;XSpreadsheet, Exception&gt; consumer) throws Exception {\n    final var spreadsheetDocument = Lo.qiOptional(XSpreadsheetDocument.class, document);\n    if (spreadsheetDocument.isEmpty()) {\n        throw new IllegalArgumentException(&quot;Provided document was not of type CALC!&quot;);\n    }\n\n    foreachSheet(spreadsheetDocument.get(), consumer);\n}\n\npublic static void foreachSheet(XSpreadsheetDocument spreadsheetDocument, FailableConsumer&lt;XSpreadsheet, Exception&gt; consumer) throws Exception {\n    final var sheets = spreadsheetDocument.getSheets();\n    final var indexedSheets = Lo.qi(XIndexAccess.class, sheets);\n\n    final var count = indexedSheets.getCount();\n    for (var i = 0; i &lt; count; i++) {\n        final var sheet = Lo.qi(XSpreadsheet.class, indexedSheets.getByIndex(i));\n\n        consumer.accept(sheet);\n    }\n}\n</code></pre>\n",
    "tags" : [ "java", "libreoffice", "libreoffice-calc", "uno" ],
    "owner" : {
      "account_id" : 28023755,
      "reputation" : 3,
      "user_id" : 21404131,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a/AGNmyxYtkOwUiGOV4vsK2Wm_-A3W0OFCodDwRAy7Cq1x=k-s256",
      "display_name" : "Gregor Lang",
      "link" : "https://stackoverflow.com/users/21404131/gregor-lang"
    },
    "is_answered" : false,
    "view_count" : 74,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1754907111,
    "creation_date" : 1754551722,
    "link" : "https://stackoverflow.com/questions/79728203/how-do-i-set-visibility-of-sheet-row-or-column",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140648676,
    "post_id" : 79728203,
    "body" : "yes, for draw/impress type documents there is a property named visible, but all the documentation i was able to find online points to &quot;IsVisible&quot; being the correct property.    im kinda stumped, because there is just no indication what seems to be going wrong. there are also other properties inside the propertyset of the sheet, which are able to be changed, &quot;PageStyle&quot; for example.   Also the last time i had a similar error, was when i was trying to set a property to (int) 1 when its datatype was short. this also didnt produce any exception and resulted in what looked like a no-op.",
    "score" : 1,
    "owner" : {
      "account_id" : 28023755,
      "reputation" : 3,
      "user_id" : 21404131,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a/AGNmyxYtkOwUiGOV4vsK2Wm_-A3W0OFCodDwRAy7Cq1x=k-s256",
      "display_name" : "Gregor Lang",
      "link" : "https://stackoverflow.com/users/21404131/gregor-lang"
    },
    "creation_date" : 1754563058,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140648596,
    "post_id" : 79728203,
    "body" : "I would have expected a property name <code>&quot;Visible&quot;</code> but I am totally unknowledgeable here.",
    "score" : 0,
    "owner" : {
      "account_id" : 960307,
      "reputation" : 110397,
      "user_id" : 984823,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/Z2KYN.jpg?s=256",
      "display_name" : "Joop Eggen",
      "link" : "https://stackoverflow.com/users/984823/joop-eggen"
    },
    "creation_date" : 1754560246,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}