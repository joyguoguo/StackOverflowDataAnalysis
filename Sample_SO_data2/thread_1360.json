{
  "question" : {
    "question_id" : 79718836,
    "title" : "Kafka publishing to non-existing topic loop",
    "body" : "<p>We have a Spring Boot service that is publishing to a Kafka topic. Whenever the topic is non-existing (say misspelled), the service logs throw the below warning in a loop:</p>\n<blockquote>\n<p>o.a.k.c.NetworkClient: [Producer clientId=TestService-0] The metadata response from the cluster reported a recoverable issue with correlation id 8 : {account.messages.valid=UNKNOWN_TOPIC_OR_PARTITION}</p>\n</blockquote>\n<p>Once this happens, the issue not only logs the warning continuously but also stops processing subsequent messages. Catching the exception around the publishing line doesn't seem to make any difference to the repeated throwing of the warning.</p>\n<p>Is there a setting where I can control this behavior on error to throw the error/warning only once and then move on to process other messages?</p>\n",
    "tags" : [ "java", "spring-boot", "apache-kafka", "error-handling", "spring-kafka" ],
    "owner" : {
      "account_id" : 18044566,
      "reputation" : 325,
      "user_id" : 13115896,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/6d35ea24f31161f110fed75caf9d2d04?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "sg2000",
      "link" : "https://stackoverflow.com/users/13115896/sg2000"
    },
    "is_answered" : true,
    "view_count" : 151,
    "answer_count" : 1,
    "score" : 1,
    "last_activity_date" : 1753860850,
    "creation_date" : 1753801744,
    "link" : "https://stackoverflow.com/questions/79718836/kafka-publishing-to-non-existing-topic-loop",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79719586,
    "question_id" : 79718836,
    "body" : "<p>You can disable infinite retries using:</p>\n<pre><code>spring.kafka.producer.retries=1\nspring.kafka.producer.retry-backoff-ms=1000\nspring.kafka.producer.max-block-ms=5000\n</code></pre>\n<p>And Handle the Send Failure via <code>Callback</code></p>\n<pre><code> kafkaTemplate.send(&quot;non_existing_topic&quot;, message).addCallback(\n    result -&gt; log.info(&quot;Message sent&quot;),\n    ex -&gt; log.error(&quot;Failed to send message&quot;, ex)\n);\n</code></pre>\n",
    "score" : 1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 6233026,
      "reputation" : 93,
      "user_id" : 4849128,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/eN0WJ.jpg?s=256",
      "display_name" : "Mohammad Taghi Ahadi",
      "link" : "https://stackoverflow.com/users/4849128/mohammad-taghi-ahadi"
    },
    "creation_date" : 1753860183,
    "last_activity_date" : 1753860183,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : {
    "79719586" : [ {
      "comment_id" : 140647580,
      "post_id" : 79719586,
      "body" : "There&#39;s NO .addCallback() in CompletableFuture.",
      "score" : 0,
      "owner" : {
        "account_id" : 7692774,
        "reputation" : 1282,
        "user_id" : 5828464,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/de54db63fab1e3c3d00d0dbef1a0a0f1?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "Yuri G",
        "link" : "https://stackoverflow.com/users/5828464/yuri-g"
      },
      "creation_date" : 1754518054,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}