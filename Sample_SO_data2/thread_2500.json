{
  "question" : {
    "question_id" : 79618593,
    "title" : "How can I make JShell stop on exceptions and return an exit code?",
    "body" : "<p>If a JShell script encounters an exception, execution continues. How can I catch the exception and stop the script with an error code?</p>\n<pre><code>int divide(int x, int y) {\n    return x / y;\n}\n\nint a = divide(5,0);\nint b = divide(4,2);\nSystem.out.println(&quot;a=&quot; + a);\nSystem.out.println(&quot;b=&quot; + b);\n/exit\n</code></pre>\n<pre><code>jshell example.jsh \nException java.lang.ArithmeticException: / by zero\n      at divide (#1:2)\n      at (#2:1)\na=0\nb=2\necho $?\n0\n</code></pre>\n",
    "tags" : [ "java", "shell", "exception", "jshell" ],
    "owner" : {
      "account_id" : 2165410,
      "reputation" : 56,
      "user_id" : 1918631,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/1a6c29ce1b0d6ecb5ebe741642119874?s=256&d=identicon&r=PG",
      "display_name" : "Ari",
      "link" : "https://stackoverflow.com/users/1918631/ari"
    },
    "is_answered" : true,
    "view_count" : 93,
    "answer_count" : 1,
    "score" : 1,
    "last_activity_date" : 1747141911,
    "creation_date" : 1747081814,
    "link" : "https://stackoverflow.com/questions/79618593/how-can-i-make-jshell-stop-on-exceptions-and-return-an-exit-code",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79619662,
    "question_id" : 79618593,
    "body" : "<p>You would be better off using <a href=\"https://openjdk.org/jeps/330\" rel=\"nofollow noreferrer\">JEP-330 java single file launcher</a> as suggested by Sweeper in the comments. Then you can add a class and run it as <code>java Test.java</code>.</p>\n<p>However you can fix your sample. Adding <code>/exit</code> will never change <code>jshell</code> exit code to non zero, so you need to set a variable to error value at the start and use <code>/exit code</code>. Secondly, put all the snippets into one code block (or use exception handler) and set code to 0 only when finishing successfully.</p>\n<p>Try this version of example.ksh which includes the above changes:</p>\n<pre><code>var code = 1;\nint divide(int x, int y) {\n    return x / y;\n}\n{\n    int a = divide(5,0);\n    int b = divide(4,2);\n    System.out.println(&quot;a=&quot; + a);\n    System.out.println(&quot;b=&quot; + b);\n    code = 0;\n}\n/exit code\n</code></pre>\n<p>With this change, <code>echo $?</code> will be non-zero if there is an error.</p>\n",
    "score" : 1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 5998820,
      "reputation" : 16284,
      "user_id" : 4712734,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/f6e922a2cb7e2da59286f27b162aaca5?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "DuncG",
      "link" : "https://stackoverflow.com/users/4712734/duncg"
    },
    "creation_date" : 1747139589,
    "last_activity_date" : 1747141911,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140421708,
    "post_id" : 79618593,
    "body" : "<code>jshell</code> has an in-built help system: <code>&#47;help exit</code> will display : &quot;... <code>&#47;exit &lt;integer-expression-snippet&gt;</code>    Evaluate the snippet.  If the snippet fails or is not an integer expression,    display the error.  Otherwise leave the jshell tool with the     value of the expression as the exit status&quot;",
    "score" : 0,
    "owner" : {
      "account_id" : 31180,
      "reputation" : 29752,
      "user_id" : 85421,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/kKvXH.gif?s=256",
      "display_name" : "user85421",
      "link" : "https://stackoverflow.com/users/85421/user85421"
    },
    "creation_date" : 1747145086,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140419424,
    "post_id" : 79618593,
    "body" : "If you want a different exit code, perhaps you should be using the <code>java</code> command to run a single file (<a href=\"https://openjdk.org/jeps/330\" rel=\"nofollow noreferrer\">JEP330</a>)? That, combined with an unnamed class (<a href=\"https://openjdk.org/jeps/445\" rel=\"nofollow noreferrer\">JEP445</a>) gets pretty close to a jshell script.",
    "score" : 1,
    "owner" : {
      "account_id" : 6651855,
      "reputation" : 292280,
      "user_id" : 5133585,
      "user_type" : "registered",
      "accept_rate" : 96,
      "profile_image" : "https://i.sstatic.net/dfqcw.png?s=256",
      "display_name" : "Sweeper",
      "link" : "https://stackoverflow.com/users/5133585/sweeper"
    },
    "creation_date" : 1747083649,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140419420,
    "post_id" : 79618593,
    "body" : "<a href=\"https://stackoverflow.com/q/46357465/5133585\">This</a> will tell you how to stop the script execution, but why do you want an error exit code? JShell itself did not throw an exception - the Java code it is running, did. This might be an <a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">XY Problem</a>.",
    "score" : 0,
    "owner" : {
      "account_id" : 6651855,
      "reputation" : 292280,
      "user_id" : 5133585,
      "user_type" : "registered",
      "accept_rate" : 96,
      "profile_image" : "https://i.sstatic.net/dfqcw.png?s=256",
      "display_name" : "Sweeper",
      "link" : "https://stackoverflow.com/users/5133585/sweeper"
    },
    "creation_date" : 1747083494,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}