{
  "question" : {
    "question_id" : 79626829,
    "title" : "OpenAPI (3.0) and polymorphism in the client",
    "body" : "<p>I'm trying to model inheritance in openapi 3. I don't get why moving model definitions from <code>definitions:</code> into <code>components: schemas:</code> causes inheritance to no longer be modelled.  Ultimately, I'd like Dart clients, but have only made inheritance work successfully for Java, and only then for the 2.0 openapi spec.</p>\n<p>Running:</p>\n<pre><code>java -jar swagger-codegen-cli-3.0.68.jar generate -i swagger.yaml -l java -o ./_swagger\n</code></pre>\n<p>with:</p>\n<pre><code>components:\n  schemas:\n    Pet:\n      discriminator: petType\n      required:\n        - name\n        - petType # required for inheritance to work\n      properties:\n        name:\n          type: string\n        petType:\n          type: string\n    Cat:\n      allOf:\n        - $ref: '#/definitions/Pet' # Cat has all properties of a Pet\n        - properties: # extra properties only for cats\n            huntingSkill:\n              type: string\n              default: lazy\n              enum:\n                - lazy\n                - aggressive\n    Dog:\n      allOf:\n        - $ref: '#/definitions/Pet' # Dog has all properties of a Pet\n        - properties: # extra properties only for dogs\n            packSize:\n              description: The size of the pack the dog is from\n              type: integer\nopenapi: 3.0.3\nsecurity: []\nservers: []\npaths:\n</code></pre>\n<p>produces</p>\n<pre><code>public class Dog { ...}\n</code></pre>\n<p>But with the following (taken from the working example in <a href=\"https://github.com/swagger-api/swagger-codegen/issues/6148\" rel=\"nofollow noreferrer\">https://github.com/swagger-api/swagger-codegen/issues/6148</a>) and using definitions (vs. components/schemas)...</p>\n<pre><code>swagger: &quot;2.0&quot;\nbasePath: &quot;/v2&quot;\ndefinitions:\n  Pet:\n    discriminator: petType\n    required:\n      - name\n      - petType # required for inheritance to work\n    properties:\n      name: \n        type: string\n      petType:\n        type: string\n  Cat:\n    allOf:\n      - $ref: '#/definitions/Pet' # Cat has all properties of a Pet\n      - properties: # extra properties only for cats\n          huntingSkill:\n            type: string\n            default: lazy\n            enum:\n              - lazy\n              - aggressive\n  Dog:\n    allOf:\n      - $ref: '#/definitions/Pet' # Dog has all properties of a Pet\n      - properties: # extra properties only for dogs\n          packSize:\n            description: The size of the pack the dog is from\n            type: integer\n</code></pre>\n<p>I get:</p>\n<pre><code>public class Dog extends Pet { }\n</code></pre>\n<p>How to I generate inheritance in openapi3?</p>\n<hr />\n<p>Update, with feedback from @Abdurrahman</p>\n<p>This following does create:</p>\n<pre><code>public class Dog extends Pet { }\n</code></pre>\n<pre><code>components:\n  schemas:\n    Store:\n      type: object\n      properties:\n        pet:\n          oneOf:\n            - $ref: &quot;#/components/schemas/Cat&quot;\n            - $ref: &quot;#/components/schemas/Dog&quot;\n          discriminator:\n            propertyName: petType\n            mapping:\n                Cat:  &quot;#/components/schemas/Cat&quot;\n                Dog:  &quot;#/components/schemas/Dog&quot;\n    Pet:\n      discriminator:\n        propertyName: petType\n      required:\n        - name\n        - petType # required for inheritance to work\n      properties:\n        name:\n          type: string\n        petType:\n          type: string\n    Cat:\n      allOf:\n        - $ref: '#/components/schemas/Pet' # Cat has all properties of a Pet\n        - properties: # extra properties only for cats\n            huntingSkill:\n              type: string\n              default: lazy\n              enum:\n                - lazy\n                - aggressive\n    Dog:\n      allOf:\n        - $ref: '#/components/schemas/Pet' # Dog has all properties of a Pet\n        - properties: # extra properties only for dogs\n            packSize:\n              description: The size of the pack the dog is from\n              type: integer\nopenapi: 3.0.3\nsecurity: []\nservers: []\npaths: {}\ninfo:\n  version: 1.0.0\n  title: Swagger Petstore\n</code></pre>\n<p>With the Dart client, there's a class <code>StorePet</code> that looks like the union of Cat and Dog... and no actual code in Store for deserializing a Cat or Dog into Store.pet based on pet.petType.</p>\n<p>... sure I could produce a Cat or Dog from this in my own code, but I could have done that from the JSON also...</p>\n<pre><code>// java -jar openapi-generator-cli.jar generate -i swagger.yaml -g dart -o ./_swagger\n\nclass Store {\n  StorePet? pet;   // Could have been Pet? Or Object?\n  ... \n}\n\nclass Pet {\n  String name;\n  String petType;\n   ...\n}\n\nclass Dog { // &quot;extends Pet&quot; is missing !!!\n  ...\n}\n\nclass StorePet {\n...\n  String name;\n  String petType;\n  StorePetHuntingSkillEnum huntingSkill;\n  int? packSize;\n...\n}\n</code></pre>\n<p>With a Java client target and the same specification, it looks a little better...</p>\n<pre><code>// java -jar openapi-generator-cli.jar generate -i swagger.yaml -g java -o ./_swagger\n\npublic class Store {\n  public static final String SERIALIZED_NAME_PET = &quot;pet&quot;;\n\n  @SerializedName(SERIALIZED_NAME_PET)\n  private StorePet pet;    /// &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; Could have been Pet? or Object?\n\n  @javax.annotation.Nullable\n  public StorePet getPet() {\n    return pet;\n  }\n}\n\npublic class Pet {\n...\n  private String name;\n  protected String petType;\n...\n}\n\npublic class Dog extends Pet {\n\n...\n}\n\n\npublic class StorePet extends AbstractOpenApiSchema {\n\n    public static class CustomTypeAdapterFactory implements TypeAdapterFactory {\n    return (TypeAdapter&lt;T&gt;) new TypeAdapter&lt;StorePet&gt;() {\n...\n                @Override\n                public StorePet read(JsonReader in) throws IOException {\n\n... test if a cat or dog is found and call setActualInstance() with a Cat or a Dog class instance.\n\n    }\n</code></pre>\n<p>So, I guess you can call access Store.pet.getActualInstance() to get a Cat or Dog in Java, but not for Dart.</p>\n<p>It's also not obvious why the Java version is implemented this way.\nWe could have had:</p>\n<pre><code>class Store {\n  Object? pet;\n  public static Store fromJson(String jsonString){\n    // Figure out what class to construct with pet.petType using the schema information\n    // components.schemas.Store.properties.pet.discriminator.propertyName = petType\n\n  } \n}\n</code></pre>\n",
    "tags" : [ "java", "dart", "openapi", "dart-polymer", "swagger-codegen" ],
    "owner" : {
      "account_id" : 20478,
      "reputation" : 15928,
      "user_id" : 48956,
      "user_type" : "registered",
      "accept_rate" : 67,
      "profile_image" : "https://www.gravatar.com/avatar/06f001142c96af8fb111127e63d92579?s=256&d=identicon&r=PG",
      "display_name" : "user48956",
      "link" : "https://stackoverflow.com/users/48956/user48956"
    },
    "is_answered" : false,
    "view_count" : 124,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1747649330,
    "creation_date" : 1747503105,
    "link" : "https://stackoverflow.com/questions/79626829/openapi-3-0-and-polymorphism-in-the-client",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ ],
  "answer_comments" : { }
}