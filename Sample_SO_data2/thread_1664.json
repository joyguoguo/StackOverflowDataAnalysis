{
  "question" : {
    "question_id" : 79689385,
    "title" : "No-breaking space not correctly encoded in oracle via JDBC",
    "body" : "<p>I've a legacy application which is loading csv files and load them to oracle DB. One line contains the non breaking character which is correctly read by the app (I can see the byte value -96 for the column string to be inserted which corresponds to the unsigned byte 160 (U+00A0)).</p>\n<p>This value is inserted via JDBC with prepared statement <code>.setObject(string)</code>.</p>\n<p>However in the database the <code>dump</code> oracle function reveals that the value got replaced with the unicode replacement character (239, 191, 189 - U+FFFD).</p>\n<p>I've no clue where the issue can be. Querying the <code>v$nls_parameters</code> I get for <code>NLS_CHARACTERSET</code> UTF8 while for <code>NLS_NCHAR_CHARACTERSET</code> AL16UFT16. The column type at DB side is <code>VARCHAR2</code></p>\n",
    "tags" : [ "java", "oracle-database", "encoding" ],
    "owner" : {
      "account_id" : 8416879,
      "reputation" : 883,
      "user_id" : 6317008,
      "user_type" : "registered",
      "accept_rate" : 78,
      "profile_image" : "https://www.gravatar.com/avatar/6f0766de5f4a9354cd0f010e68f7ec96?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "SGiux",
      "link" : "https://stackoverflow.com/users/6317008/sgiux"
    },
    "is_answered" : false,
    "view_count" : 105,
    "answer_count" : 0,
    "score" : 1,
    "last_activity_date" : 1751643058,
    "creation_date" : 1751571316,
    "link" : "https://stackoverflow.com/questions/79689385/no-breaking-space-not-correctly-encoded-in-oracle-via-jdbc",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140564346,
    "post_id" : 79689385,
    "body" : "What do you get when you insert a String containing <code>&#195;&#169;</code>? That would be to know if the String-to-database encoding uses an UTF-8 to ISO8859-1 reduction; according to <a href=\"https://docs.oracle.com/cd/F49540_01/DOC/java.815/a64685/advanc1.htm\" rel=\"nofollow noreferrer\">good old docs</a> JDBC should autoconvert to the database charset and encoding, so I&#39;d say the problem lies in how the client reads the data; maybe <code>NLS_LANG</code>, <code>LC_ALL</code> and <code>LANG</code> have something to do with it (do they include a dot-encoding suffix?).",
    "score" : 0,
    "owner" : {
      "account_id" : 1422459,
      "reputation" : 7512,
      "user_id" : 1346819,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/XWC5vqjc.png?s=256",
      "display_name" : "Guillaume Outters",
      "link" : "https://stackoverflow.com/users/1346819/guillaume-outters"
    },
    "creation_date" : 1751616872,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140564145,
    "post_id" : 79689385,
    "body" : "By debugging I can see that the setStringInternal method is called in OraclePreparedStatement which is the same method called by setString",
    "score" : 0,
    "owner" : {
      "account_id" : 8416879,
      "reputation" : 883,
      "user_id" : 6317008,
      "user_type" : "registered",
      "accept_rate" : 78,
      "profile_image" : "https://www.gravatar.com/avatar/6f0766de5f4a9354cd0f010e68f7ec96?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "SGiux",
      "link" : "https://stackoverflow.com/users/6317008/sgiux"
    },
    "creation_date" : 1751613340,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140564110,
    "post_id" : 79689385,
    "body" : "I’m calling setObject because by specification it will take care of converting to the correct sql type and my code is more generic.   For your second question, the Java String object has the internal “value” variable which is used for character storage and apparently uses decimal (e.g. I also see the first value is 83, in fact my string starts with “S”). I can see it by debugging with my IDE",
    "score" : 0,
    "owner" : {
      "account_id" : 8416879,
      "reputation" : 883,
      "user_id" : 6317008,
      "user_type" : "registered",
      "accept_rate" : 78,
      "profile_image" : "https://www.gravatar.com/avatar/6f0766de5f4a9354cd0f010e68f7ec96?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "SGiux",
      "link" : "https://stackoverflow.com/users/6317008/sgiux"
    },
    "creation_date" : 1751612672,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140563391,
    "post_id" : 79689385,
    "body" : "Why are you not calling <code>::setString</code>? And: <i>(I can see the byte value -96 for the column string to be inserted which corresponds to the unsigned byte 160 (U+00A0)).</i> exactly <i>how</i> can you see that? Because if you <i>can</i>, your character encoding is <i>not</i> UTF-8. If it were, you would see the two byte sequence of 0xC2 0xA0",
    "score" : 4,
    "owner" : {
      "account_id" : 22124137,
      "reputation" : 4244,
      "user_id" : 16376827,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/1ImPw.png?s=256",
      "display_name" : "g00se",
      "link" : "https://stackoverflow.com/users/16376827/g00se"
    },
    "creation_date" : 1751576261,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}