{
  "question" : {
    "question_id" : 79550468,
    "title" : "Not able to parse P10YT10M ISO-8601 duration string in java",
    "body" : "<p>I am trying to parse durationString= P10YT10M using java.time.Duration.parse() method, but it fails with <em>&quot;Text cannot be parsed to a Duration&quot;</em>.</p>\n<pre class=\"lang-java prettyprint-override\"><code>try {\n    String durationString = &quot;P5YT30M&quot;;\n    Duration duration = Duration.parse(durationString);\n} catch ( Exception e) {\n    System.err.println( e.getMessage());\n</code></pre>\n<p>It's working for durationStrings like PT5M, but it cannot parse durationStrings similar to P5YT30M, P5Y8M4W3D.</p>\n",
    "tags" : [ "java", "java-time", "duration", "iso8601" ],
    "owner" : {
      "account_id" : 19612245,
      "reputation" : 75,
      "user_id" : 14354541,
      "user_type" : "registered",
      "profile_image" : "https://lh4.googleusercontent.com/-54nIRyYR6bk/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucnYGdN0VL8m_5sXSKl0BwK9ROZ_Ng/s256-rj/photo.jpg",
      "display_name" : "Vaibhav R",
      "link" : "https://stackoverflow.com/users/14354541/vaibhav-r"
    },
    "is_answered" : true,
    "view_count" : 228,
    "answer_count" : 4,
    "score" : 6,
    "last_activity_date" : 1745060432,
    "creation_date" : 1743592824,
    "link" : "https://stackoverflow.com/questions/79550468/not-able-to-parse-p10yt10m-iso-8601-duration-string-in-java",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79550497,
    "question_id" : 79550468,
    "body" : "<p>No, that text can't be parsed to a <code>Duration</code>. The <a href=\"https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/time/Duration.html#parse(java.lang.CharSequence)\" rel=\"noreferrer\">documentation for <code>Duration.parse</code></a> is clear about what it will handle:</p>\n<blockquote>\n<p>Obtains a <code>Duration</code> from a text string such as <code>PnDTnHnMn.nS</code>.</p>\n<p>[...] There are then four sections, each consisting of a number and a suffix. The sections have suffixes in ASCII of &quot;D&quot;, &quot;H&quot;, &quot;M&quot; and &quot;S&quot; for days, hours, minutes and seconds, accepted in upper or lower case. The suffixes must occur in order.</p>\n</blockquote>\n<p><code>P10YT10M</code> isn't in that format, so it can't be parsed by <code>Duration.parse</code>. There's a good reason for this: a <code>Duration</code> is a fixed length of time (and the <code>Duration.parse</code> docs call out that <code>parse</code> treats a day as 24 hours). Years and months are <em>not</em> fixed lengths of time - should &quot;P1M&quot; be equivalent to 28 days? 29? 30? 31?</p>\n<p>You can use <code>Period.parse</code> for non-time-based ISO durations, but that still won't handle <code>P5YT30M</code> for example. If you really need this, I'd suggest you:</p>\n<ul>\n<li>Split the input into &quot;days and bigger&quot; and &quot;hours and smaller&quot; (so basically at the T)</li>\n<li>Parse the days-and-bigger part as a <code>Period</code> and the hours-and-smaller part as a <code>Duration</code></li>\n<li>Figure out what you <em>want</em> your <code>Duration</code> to be for non-uniform parts like years and months. (For example, you could add the period to 2000-01-01 and work out the days since then in the result.)</li>\n<li>Add the two <code>Duration</code> results together</li>\n</ul>\n<p>But before you write any code, it's worth figuring out your <em>precise</em> requirements. What do you want to <em>do</em> with the result? If you want to add it to a <code>LocalDateTime</code> for example, it would be better to keep the <code>Period</code> and <code>Duration</code> separate.</p>\n",
    "score" : 7,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 11683,
      "reputation" : 1521090,
      "user_id" : 22656,
      "user_type" : "registered",
      "accept_rate" : 86,
      "profile_image" : "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=256&d=identicon&r=PG",
      "display_name" : "Jon Skeet",
      "link" : "https://stackoverflow.com/users/22656/jon-skeet"
    },
    "creation_date" : 1743593636,
    "last_activity_date" : 1743593636,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79550516,
    "question_id" : 79550468,
    "body" : "<p><code>java.time.Duration.parse()</code> does not support ISO-8601 duration strings that include years (Y) or months (M).</p>\n<p>This is because <code>Duration</code> only supports <strong>time-based durations</strong>, not <strong>calendar-based durations</strong>. There is ambiguity in calendar-based durations e.g. years or months have different lengths, so it is not precise to use them for durations.</p>\n<p>According to the <a href=\"https://docs.oracle.com/javase/8/docs/api/java/time/Duration.html\" rel=\"noreferrer\">docs</a>, <code>parse</code> method:</p>\n<blockquote>\n<p>Obtains a <code>Duration</code> from a text string such as <code>PnDTnHnMn.nS</code>.</p>\n</blockquote>\n<p>If you want to parse something like <code>&quot;P5Y8M4W3D&quot;</code>, you should use <code>java.time.Period.</code> <code>Period</code> represents years, months, days - calendar-based units.</p>\n",
    "score" : 5,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 16043894,
      "reputation" : 913,
      "user_id" : 11579604,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/z1aaG.png?s=256",
      "display_name" : "Patrycja Wegrzynowicz",
      "link" : "https://stackoverflow.com/users/11579604/patrycja-wegrzynowicz"
    },
    "creation_date" : 1743594136,
    "last_activity_date" : 1743594136,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79551009,
    "question_id" : 79550468,
    "body" : "<h2><code>PeriodDuration</code> from <em>ThreeTen-Extra</em></h2>\n<p>As the other answers say, your strings don’t fit with the <code>Duration</code> class since it is for time-based durations, durations of hours, minutes, seconds and fraction of second. Most of them also don’t fit with the other class for an amount of time, the <code>Period</code> class, which is date-based: for years, months and days. It cannot hold hours, minutes or seconds.</p>\n<p>The solution is the <a href=\"https://www.threeten.org/threeten-extra/apidocs/org.threeten.extra/org/threeten/extra/PeriodDuration.html\" rel=\"nofollow noreferrer\"><code>PeriodDuration</code></a> class from the <a href=\"https://www.threeten.org/threeten-extra/\" rel=\"nofollow noreferrer\"><em>ThreeTen-Extra</em></a> project. A <code>PeriodDuration</code> combines a <code>Period</code> and a <code>Duration</code>, so holds all of years, months, days, etc., down to nanoseconds. The ThreeTen Extra project was developed alongside java.time and like java.time was inspired from Joda-Time. Just like <code>Period</code> and <code>Duration</code> <code>PeriodDuration</code> parses ISO 8601 format.</p>\n<pre><code>import org.threeten.extra.PeriodDuration;\n\npublic class App  {\n    public static void main(String[] args&lt;) {\n        String[] input = { &quot;P10YT10M&quot;, &quot;P5YT30M&quot;, &quot;P5Y8M4W3D&quot; };\n        System.out.println(&quot;Input      PeriodDuration  Period    Duration&quot;);\n        for (String i : input) {\n            PeriodDuration pd = PeriodDuration.parse(i);\n            System.out.format(Locale.ENGLISH, &quot;%-9s  %-14s  %-8s  %s%n&quot;,\n                    i, pd, pd.getPeriod(), pd.getDuration());\n        }\n    }\n}\n</code></pre>\n<p>Output:</p>\n<pre class=\"lang-none prettyprint-override\"><code>Input      PeriodDuration  Period    Duration\nP10YT10M   P10YT10M        P10Y      PT10M\nP5YT30M    P5YT30M         P5Y       PT30M\nP5Y8M4W3D  P5Y8M31D        P5Y8M31D  PT0S\n</code></pre>\n<p>There’s a lot of things you can do with the <code>PeriodDuration</code>. There’s probably no need to take it apart into a <code>Period</code> and a <code>Duration</code> like I do. I only do it for demonstration. See the documentation link at the bottom for options.</p>\n<p>In the last output line we observe that <code>PeriodDuration</code> (just like <code>Period</code>) converts 4 weeks to 28 days and that the absence of any hours or smaller causes the period to be accompanied by a zero-length duration.</p>\n<p>Maven dependency:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>    &lt;dependency&gt;\n      &lt;groupId&gt;org.threeten&lt;/groupId&gt;\n      &lt;artifactId&gt;threeten-extra&lt;/artifactId&gt;\n      &lt;version&gt;1.8.0&lt;/version&gt;\n    &lt;/dependency&gt;\n</code></pre>\n<p>Links:</p>\n<ul>\n<li><a href=\"https://www.threeten.org/threeten-extra/\" rel=\"nofollow noreferrer\">ThreeTen Extra</a></li>\n<li><a href=\"https://www.threeten.org/threeten-extra/apidocs/org.threeten.extra/org/threeten/extra/PeriodDuration.html\" rel=\"nofollow noreferrer\"><code>PeriodDuration</code> API documentation</a></li>\n</ul>\n",
    "score" : 3,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 41148271,
      "reputation" : 31,
      "user_id" : 30145237,
      "user_type" : "unregistered",
      "profile_image" : "https://www.gravatar.com/avatar/df204cab11a0b498bea33f13e0599e45?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Zofia W&#225;ng",
      "link" : "https://stackoverflow.com/users/30145237/zofia-w%c3%a1ng"
    },
    "creation_date" : 1743608840,
    "last_activity_date" : 1743781070,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79550532,
    "question_id" : 79550468,
    "body" : "<p>Refer to <a href=\"https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/time/Duration.html\" rel=\"nofollow noreferrer\">Javadoc for Class Duration</a>; it says</p>\n<blockquote>\n<p>This class models a quantity or amount of time in terms of seconds and nanoseconds. It can be accessed using other duration-based units, such as minutes and hours. In addition, the DAYS unit can be used and is treated as exactly equal to 24 hours, thus ignoring daylight savings effects. See Period for the date-based equivalent to this class.</p>\n</blockquote>\n<p>This means that <code>PT5M</code> is meant to work, but <code>P5Y8M4W3D</code> needs to be handled by <code>Period</code> instead.</p>\n<p>Unfortunately, <code>P10YT10M</code> isn't handled by either of these classes.</p>\n",
    "score" : 2,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 1692034,
      "reputation" : 4140,
      "user_id" : 1554195,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/b67f6a3639e7924c531053212048be5c?s=256&d=identicon&r=PG",
      "display_name" : "tquadrat",
      "link" : "https://stackoverflow.com/users/1554195/tquadrat"
    },
    "creation_date" : 1743594461,
    "last_activity_date" : 1743594461,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140290750,
    "post_id" : 79550468,
    "body" : "The <code>PeriodDuration</code> class of <a href=\"https://www.threeten.org/threeten-extra/\" rel=\"nofollow noreferrer\">ThreeTen Extra</a> can parse that string and similar strings.",
    "score" : 1,
    "owner" : {
      "account_id" : 7612423,
      "reputation" : 87409,
      "user_id" : 5772882,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/8283c64511fa80afed5259d10850168f?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Anonymous",
      "link" : "https://stackoverflow.com/users/5772882/anonymous"
    },
    "creation_date" : 1743601879,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79550516" : [ {
      "comment_id" : 140332111,
      "post_id" : 79550516,
      "body" : "For a couple of details, I believe that <code>Duration</code> does not support weeks (<code>W</code>) either. It does support days (<code>D</code>) and always converts a day to 24 hours regardless of the fact that a day is occasionally 23 hours, 25 hours or some other length.",
      "score" : 0,
      "owner" : {
        "account_id" : 7612423,
        "reputation" : 87409,
        "user_id" : 5772882,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/8283c64511fa80afed5259d10850168f?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "Anonymous",
        "link" : "https://stackoverflow.com/users/5772882/anonymous"
      },
      "creation_date" : 1744621702,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}