{
  "question" : {
    "question_id" : 79561602,
    "title" : "In Apache POI, how can I add borders to merged cells?",
    "body" : "<p>In Apache POI, how can I add borders to merged cells?</p>\n<p>For example, in the following Java code, after calling generateExcel(), the code should merge 3 cells, write text &quot;as&quot; to the merged cell, and also add top, left, right and bottom borders to the merged cell:</p>\n<pre><code>private void mergeAndWriteCell(Sheet theSheet, int rowIndex, int columnIndex, String content, CellStyle theCellStyle) {\n    int lastRowIndex;\n    CellRangeAddress theRange;\n\n    Row theRow;\n    Cell theCell;\n\n\n    lastRowIndex = rowIndex + 2;\n\n    theRange = new CellRangeAddress(rowIndex, lastRowIndex, columnIndex, columnIndex);\n    theSheet.addMergedRegion(theRange);\n\n    theRow = theSheet.getRow(rowIndex);\n\n    if (theRow == null) {\n        theRow = theSheet.createRow(rowIndex);\n    }\n\n    theCell = theRow.getCell(columnIndex);\n\n    if (theCell == null) {\n        theCell = theRow.createCell(columnIndex, CellType.STRING);\n        theCell.setCellValue(content);\n    } else {\n        theCell.setBlank();\n        theCell.setCellValue(content);\n    }\n\n    theCell.setCellStyle(theCellStyle);\n}\n\n\nprivate void generateExcel() throws Exception {\n    XSSFWorkbook theXSSFWorkbook;\n    Workbook theWorkbook;\n    Sheet theSheet;\n    CellStyle theCellStyle;\n\n    ByteArrayOutputStream theByteArrayOutputStream;\n    OutputStream theOutputStream;\n    byte[] theBytes;\n\n    String saveFilePath;\n    File theFile;\n    FileOutputStream theFileOutputStream;\n\n\n    theXSSFWorkbook = new XSSFWorkbook();\n    theWorkbook = theXSSFWorkbook;\n    theSheet = theWorkbook.createSheet(&quot;TestTable&quot;);\n\n    theCellStyle = theWorkbook.createCellStyle();\n\n    theCellStyle.setBorderTop(BorderStyle.THIN);\n    theCellStyle.setBorderLeft(BorderStyle.THIN);\n    theCellStyle.setBorderRight(BorderStyle.THIN);\n    theCellStyle.setBorderBottom(BorderStyle.THIN);\n\n    theCellStyle.setAlignment(HorizontalAlignment.CENTER);\n    theCellStyle.setVerticalAlignment(VerticalAlignment.CENTER);\n\n    mergeAndWriteCell(theSheet, 1, 1, &quot;as&quot;, theCellStyle);\n\n    theByteArrayOutputStream = new ByteArrayOutputStream();\n\n    theOutputStream = theByteArrayOutputStream;\n    theWorkbook.write(theOutputStream);\n\n    theBytes = theByteArrayOutputStream.toByteArray();\n\n    //set saveFilePath to some file path\n    saveFilePath = &quot;SOME FILE PATH&quot;;\n    theFile = new File(saveFilePath);\n    theFileOutputStream = new FileOutputStream(theFile);\n    theFileOutputStream.write(theBytes);\n    theFileOutputStream.close();\n}\n</code></pre>\n<p>However, the actual result is this:</p>\n<p><a href=\"https://i.sstatic.net/CQ7D2Ork.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/CQ7D2Ork.png\" alt=\"the actual result\" /></a></p>\n<p>Here, 3 cells are merged, and the text &quot;as&quot; is written to the merged cell in the center, as expected, but the borders are not correct.</p>\n<p>My understanding is that, after the 3 cells are merged, the cell with the row index 1 and the column index 1 should refer to the whole merged cell, so the text and the borders are all applied to the whole merged cell. But the result is that, the text is applied to the whole merged cell, but the borders seem not.</p>\n<p>So, how can I add top, left, right and bottom borders to the whole merged cell?</p>\n",
    "tags" : [ "java", "excel", "apache-poi" ],
    "owner" : {
      "account_id" : 5400331,
      "reputation" : 661,
      "user_id" : 4300403,
      "user_type" : "registered",
      "accept_rate" : 0,
      "profile_image" : "https://www.gravatar.com/avatar/15aa5e6823c675848dffad76f29f5629?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "zhoudu",
      "link" : "https://stackoverflow.com/users/4300403/zhoudu"
    },
    "is_answered" : false,
    "view_count" : 60,
    "answer_count" : 1,
    "score" : 1,
    "last_activity_date" : 1744231735,
    "creation_date" : 1744102640,
    "link" : "https://stackoverflow.com/questions/79561602/in-apache-poi-how-can-i-add-borders-to-merged-cells",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79565305,
    "question_id" : 79561602,
    "body" : "<p>You are using a Cellstyle but merged cells are a collection of cells. Try to use the RegionUtil class for your merged cells:</p>\n<p><a href=\"https://poi.apache.org/apidocs/5.0/org/apache/poi/ss/util/RegionUtil.html\" rel=\"nofollow noreferrer\">https://poi.apache.org/apidocs/5.0/org/apache/poi/ss/util/RegionUtil.html</a></p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 26195496,
      "reputation" : 35,
      "user_id" : 19876649,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/6468c6561ace0ae7e76a47130a298d40?s=256&d=identicon&r=PG",
      "display_name" : "thebert",
      "link" : "https://stackoverflow.com/users/19876649/thebert"
    },
    "creation_date" : 1744231735,
    "last_activity_date" : 1744231735,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : { }
}