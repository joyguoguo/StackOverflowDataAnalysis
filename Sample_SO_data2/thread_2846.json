{
  "question" : {
    "question_id" : 79593878,
    "title" : "Java Spring app - Load it&#39;s jar file or get it&#39;s path at runtime",
    "body" : "<p>How to load jar file (the one the app was launched from) or get it's path at runtime?</p>\n<p>Or</p>\n<p>How to get a dependency jar at runtime from <code>BOOT-INF/lib</code> directory?</p>\n<p>Our use case is that we have a Spring Boot jar file named <code>X.jar</code>, which is the application we are running. It has a jar dependency in <code>BOOT-INF/lib</code> directory called <code>Y.jar</code>. <code>Y</code> module has many classes (<code>HandlerA.java</code>, <code>HandlerB.java</code>, etc.) that are annotated with our custom annotations. We need to be able to get those classes at runtime and we have to access their annotations via reflection.</p>\n<p>We either need a full path to <code>X.jar</code>, and then we can stream its entries in order to find <code>Y.jar</code> by its name</p>\n<p>Or</p>\n<p>We need a full path to <code>Y.jar</code></p>\n<p><sub> (currently the <code>X.jar</code> is unpacked in our environment so we can access <code>Y.jar</code> directly in filesystem but that is likely to change) </sub></p>\n<p>Then we can make instance of <code>JarFile</code> from <code>Y.jar</code> and stream its <code>JarEntry</code>-s to find all <code>Handler</code> classes.</p>\n<p>Currently, I am trying an approach where we configure a Spring property in <code>application.properties</code> file to provide a full path to either <code>X.jar</code> or <code>Y.jar</code>, since we know were they are.</p>\n",
    "tags" : [ "java", "spring", "spring-boot", "jar" ],
    "owner" : {
      "account_id" : 22277006,
      "reputation" : 21,
      "user_id" : 16505995,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/Xvm1S.jpg?s=256",
      "display_name" : "Arkadiusz G&#243;recki",
      "link" : "https://stackoverflow.com/users/16505995/arkadiusz-g%c3%b3recki"
    },
    "is_answered" : false,
    "view_count" : 97,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1745805462,
    "creation_date" : 1745667608,
    "link" : "https://stackoverflow.com/questions/79593878/java-spring-app-load-its-jar-file-or-get-its-path-at-runtime",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140384668,
    "post_id" : 79593878,
    "body" : "I think I have made a bad approach to my problem. I do not have to care about nested jars and accessing them. This answer satisfies our use case for now <a href=\"https://stackoverflow.com/a/1312775/16505995\">stackoverflow.com/a/1312775/16505995</a>",
    "score" : 0,
    "owner" : {
      "account_id" : 22277006,
      "reputation" : 21,
      "user_id" : 16505995,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/Xvm1S.jpg?s=256",
      "display_name" : "Arkadiusz G&#243;recki",
      "link" : "https://stackoverflow.com/users/16505995/arkadiusz-g%c3%b3recki"
    },
    "creation_date" : 1746026171,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140377679,
    "post_id" : 79593878,
    "body" : "My little code snippet assumes that the URL refers directly to a JAR file, so you may have to tweak it a bit. You may have to use 2 nested file systems if you have a JAR in a JAR. JAR files are essentially ZIP files, and support for that is built into the JRE.",
    "score" : 0,
    "owner" : {
      "account_id" : 1211967,
      "reputation" : 9964,
      "user_id" : 1180351,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/pKB8y.png?s=256",
      "display_name" : "Rob Spoor",
      "link" : "https://stackoverflow.com/users/1180351/rob-spoor"
    },
    "creation_date" : 1745865740,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140376865,
    "post_id" : 79593878,
    "body" : "@RobSpoor Do I have to create some custom FileSystemProvider implementation and create a config file in META-INF/services (for ServiceLoader) for this to work?",
    "score" : 0,
    "owner" : {
      "account_id" : 22277006,
      "reputation" : 21,
      "user_id" : 16505995,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/Xvm1S.jpg?s=256",
      "display_name" : "Arkadiusz G&#243;recki",
      "link" : "https://stackoverflow.com/users/16505995/arkadiusz-g%c3%b3recki"
    },
    "creation_date" : 1745851149,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140371708,
    "post_id" : 79593878,
    "body" : "If not you can try to use <code>ProtectionDomain</code>. Take an existing class from either <code>X.jar</code> or <code>Y.jar</code> (let&#39;s call it <code>A</code>), then you can get a URL to it using <code>A.class.getProtectionDomain().getCodeSource().getLocation()</code>. For files inside a JAR that&#39;s going to return something like <code>jar:&lt;URL-to-jar&gt;!&lt;path-inside-jar&gt;</code> so you&#39;d have to use some code to be able to access it. For instance: <code>try (FileSystem fs = FileSystems.newFileSystem(Paths.get(location.toURI()), &lt;some class loader&gt;)) { ... }</code>, then <code>fs.getPath(&quot;&#47;&quot;)</code> returns the root folder of the JAR file.",
    "score" : 0,
    "owner" : {
      "account_id" : 1211967,
      "reputation" : 9964,
      "user_id" : 1180351,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/pKB8y.png?s=256",
      "display_name" : "Rob Spoor",
      "link" : "https://stackoverflow.com/users/1180351/rob-spoor"
    },
    "creation_date" : 1745670716,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140371702,
    "post_id" : 79593878,
    "body" : "Is it perhaps possible to use proper indexing, like <a href=\"https://smallrye.io/blog/jandex-3-0-0/\" rel=\"nofollow noreferrer\">smallrye.io/blog/jandex-3-0-0</a>? You&#39;d have to do that when building <code>Y.jar</code> though.",
    "score" : 0,
    "owner" : {
      "account_id" : 1211967,
      "reputation" : 9964,
      "user_id" : 1180351,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/pKB8y.png?s=256",
      "display_name" : "Rob Spoor",
      "link" : "https://stackoverflow.com/users/1180351/rob-spoor"
    },
    "creation_date" : 1745670419,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}