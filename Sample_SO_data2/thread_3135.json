{
  "question" : {
    "question_id" : 79572054,
    "title" : "Hibernate 6 implicitly changes time zones of read data for Instant",
    "body" : "<p>I have problem with read data by hibernate from postgresql db</p>\n<p>I am migrating a legacy project to Spring Boot 3 and Hibernate 6.5.3.Final</p>\n<p>I have entity:</p>\n<pre><code>@Data\n@Entity\n@SuperBuilder(toBuilder = true)\n@AllArgsConstructor\n@NoArgsConstructor\npublic class TestEnity {\n    @NonNull\n    private UUID id;\n    @NonNull\n    private Instant createDate;\n}\n</code></pre>\n<p>Add record by EntityManager (in my timezone now 12 am, UTC+02:00) with property spring.jpa.properties.hibernate.type.preferred_instant_jdbc_type=TIMESTAMP:</p>\n<pre><code>id                                      |   create_date\n----------------------------------------------------------------------\n3ceca36e-710f-4ea3-223b-1118b0796c7f    |   2025-04-10 12:20:30.510548\n3ceca36e-710f-4ea3-223b-2228b0796c7f    |   2025-04-09 12:20:30.510548\n3ceca36e-710f-4ea3-223b-3338b0796c7f    |   2025-04-08 12:20:30.510548\n</code></pre>\n<p>And I use querydsl for get records:</p>\n<pre><code>SQLQueryFactory sqlQueryFactory = new SQLQueryFactory(GenaratorQsqlUtils.createConfiguration(), dataSource);\n\nBooleanBuilder booleanBuilder = new BooleanBuilder();\nbooleanBuilder.and(getDateFrom(instantFrom));\nbooleanBuilder.and(getDateTo(instantTo));\n    \nlong count = sqlQueryFactory.select()\n                .from(testE)\n                .where(booleanBuilder) //createDate &gt;= 2025-04-09T12:19:58Z &amp;&amp; createDate &lt;= 2025-04-10T12:29:58Z\n                .fetchCount();\n</code></pre>\n<p>And I wait get 2 record <strong>1118b0796c7f</strong> and <strong>2228b0796c7f</strong>, but hibernate find only <strong>1118b0796c7f</strong> and in debug I see:</p>\n<pre><code>id: 3ceca36e-710f-4ea3-223b-1118b0796c7f;   create_date: 2025-04-10 10:20:30.510548\n</code></pre>\n<p>If I update record <strong>2228b0796c7f</strong> column create_date for <em>2025-04-09 14:20:30.510548</em> (that is, in the current offset recorded in the database, I added another one +02) than I get 2 records</p>\n<p>In hibernate 5 all was OK</p>\n<p>Now, in hibernate 6 I resolve problem with <strong>write</strong> data - I add property <em>spring.jpa.properties.hibernate.type.preferred_instant_jdbc_type=TIMESTAMP</em>, and in database I see rows with time in my timezone</p>\n<p>But when I <strong>read</strong> data - they in UTC</p>\n<p>How I can fix it?</p>\n<p>I just need to ensure backward compatibility and <strong>write</strong> and <strong>read</strong> data in my time zone, that is, see 2025-04-10 12:20:30.510548 in the database and receive 2025-04-10 12:20:30.510548 when reading in the application.</p>\n<p>For <strong>writing</strong>, I set the parameter <em>spring.jpa.properties.hibernate.type.preferred_instant_jdbc_type=TIMESTAMP</em>, but when <strong>reading</strong>, the time recorded in the database shifts to the time zone and I get 2025-04-10 10:20:30.510548, but need 2025-04-10 12:20:30.510548</p>\n<p>Maybe my approach with the parameter is wrong in general and I need to use something else? Or how to configure hibernate so that it does not make an implicit conversion of data from the database to the UTC format?</p>\n",
    "tags" : [ "java", "spring", "spring-boot", "hibernate", "jpa" ],
    "owner" : {
      "account_id" : 32467947,
      "reputation" : 43,
      "user_id" : 25224125,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/331556bd2946bc085b33d2240d0c63b8?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Mike Sonarov",
      "link" : "https://stackoverflow.com/users/25224125/mike-sonarov"
    },
    "is_answered" : false,
    "view_count" : 120,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1744610369,
    "creation_date" : 1744578549,
    "link" : "https://stackoverflow.com/questions/79572054/hibernate-6-implicitly-changes-time-zones-of-read-data-for-instant",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140332404,
    "post_id" : 79572054,
    "body" : "@S&#246;ren, if you have an answer for backward compatibility and have a deep understanding i will be glad for your useful comment",
    "score" : 0,
    "owner" : {
      "account_id" : 32467947,
      "reputation" : 43,
      "user_id" : 25224125,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/331556bd2946bc085b33d2240d0c63b8?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Mike Sonarov",
      "link" : "https://stackoverflow.com/users/25224125/mike-sonarov"
    },
    "creation_date" : 1744626643,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140331011,
    "post_id" : 79572054,
    "body" : "How often do you plan to ask the same question?",
    "score" : 0,
    "owner" : {
      "account_id" : 1888781,
      "reputation" : 2498,
      "user_id" : 1707427,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/4d1a2608ee35e2df7d2400a02e62bb20?s=256&d=identicon&r=PG",
      "display_name" : "S&#246;ren",
      "link" : "https://stackoverflow.com/users/1707427/s%c3%b6ren"
    },
    "creation_date" : 1744585527,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}