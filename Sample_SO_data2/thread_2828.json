{
  "question" : {
    "question_id" : 79595031,
    "title" : "Spring Boot WebSocket connection fails when URL is too long",
    "body" : "<p><strong>Long story short:</strong></p>\n<p>Can't connect to websocket in spring boot when the URL is long.</p>\n<h5>Some background info:</h5>\n<p>I'm trying to connect to a Binance WebSocket endpoint. The URL format looks like this:\n<code>wss://stream.binance.com/stream?streams=symbol1@depth/symbol2depth</code>.\nThe most important part of the URL is the end, where I have to list each symbol and divide them by a <code>/</code>: <code>symbol1@depth/symbol2@depth/symbol3@depth...</code></p>\n<h5>The real problem:</h5>\n<p>I need to connect to around 300 symbols at once, which is why the URL gets long.\nWhen I try to connect, the WebSocket connection doesn't get established, and there are no logs or error messages.</p>\n<p>However:</p>\n<ul>\n<li>If I connect with only ~200 symbols, it works fine.</li>\n<li>When I test the same long URL in Postman, it connects successfully.</li>\n<li>So I think the problem is not Binance's server, but something with Spring Boot or my WebSocket client.</li>\n</ul>\n<h5>My code:</h5>\n<pre class=\"lang-java prettyprint-override\"><code>import jakarta.websocket.ContainerProvider;\nimport jakarta.websocket.WebSocketContainer;\nimport org.springframework.web.socket.WebSocketSession;\nimport org.springframework.web.socket.client.standard.StandardWebSocketClient;\nimport org.springframework.web.socket.handler.TextWebSocketHandler;\n\npublic class WSDepthClient {\n\n    private final StandardWebSocketClient client;\n\n    public WSDepthClient(String url) {\n        WebSocketContainer container = ContainerProvider.getWebSocketContainer();\n        // set max buffer size to 10MB\n        container.setDefaultMaxTextMessageBufferSize(10 * 1024 * 1024);\n        client = new StandardWebSocketClient(container);\n        client.execute(new DepthHandler(), url);\n    }\n\n    private class DepthHandler extends TextWebSocketHandler {\n\n        @Override\n        public void afterConnectionEstablished(WebSocketSession session) {\n            // this is never printed when connecting to 300 symbols\n            System.out.println(&quot;Connection established successfully!&quot;); \n        }\n\n        @Override\n        public void handleTransportError(WebSocketSession session, Throwable exception) {\n            System.out.println(&quot;Transport error: {}&quot;, exception.getMessage());\n        }\n\n        // other methods...\n    }\n}\n</code></pre>\n<p>Please advice me what to do, thank you so much for your time!</p>\n<ul>\n<li>Java version: 17</li>\n<li>Spring Version: 3.3.3</li>\n</ul>\n",
    "tags" : [ "java", "spring-boot", "websocket" ],
    "owner" : {
      "account_id" : 28725684,
      "reputation" : 15,
      "user_id" : 21998546,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a/AAcHTte7EFNY0rJgwP9Gp8S4S9wCZKe6N2Xk2ZpPaUboaQ=k-s256",
      "display_name" : "Abubakr Shoaliev",
      "link" : "https://stackoverflow.com/users/21998546/abubakr-shoaliev"
    },
    "is_answered" : true,
    "view_count" : 106,
    "answer_count" : 1,
    "score" : 1,
    "last_activity_date" : 1745774835,
    "creation_date" : 1745757961,
    "link" : "https://stackoverflow.com/questions/79595031/spring-boot-websocket-connection-fails-when-url-is-too-long",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79595287,
    "question_id" : 79595031,
    "body" : "<p>According to the official binance documentation, requests support sending data in the request body, not in the url. Try doing it this way, it shouldn't depend on the url length.</p>\n<p>As far as I understand this is still what you are trying to do, <a href=\"https://developers.binance.com/docs/binance-spot-api-docs/web-socket-streams#subscribe-to-a-stream\" rel=\"nofollow noreferrer\">here is the binance documentation</a>.</p>\n",
    "score" : 1,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 22705497,
      "reputation" : 48,
      "user_id" : 16872280,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/rc7QI.jpg?s=256",
      "display_name" : "zimch",
      "link" : "https://stackoverflow.com/users/16872280/zimch"
    },
    "creation_date" : 1745774835,
    "last_activity_date" : 1745774835,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : {
    "79595287" : [ {
      "comment_id" : 140394245,
      "post_id" : 79595287,
      "body" : "Sorry for the delay, I tried this approach, and it works so much better than before. My code became much more optimized, thank you so much! I used to disconnect and reconnect again when establishing connections to new symbols, but now I am just sending subscribe and unsubscribe messages to the server. Works so much better, and can now handle all 300 symbols. I would love to upvote your answer, but don&#39;t have enough reputation unfortunately. Thank you again!",
      "score" : 0,
      "owner" : {
        "account_id" : 28725684,
        "reputation" : 15,
        "user_id" : 21998546,
        "user_type" : "registered",
        "profile_image" : "https://lh3.googleusercontent.com/a/AAcHTte7EFNY0rJgwP9Gp8S4S9wCZKe6N2Xk2ZpPaUboaQ=k-s256",
        "display_name" : "Abubakr Shoaliev",
        "link" : "https://stackoverflow.com/users/21998546/abubakr-shoaliev"
      },
      "creation_date" : 1746356148,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140377638,
      "post_id" : 79595287,
      "body" : "Oh I didn&#39;t think of that, thank you for your answer, I will try that!",
      "score" : 0,
      "owner" : {
        "account_id" : 28725684,
        "reputation" : 15,
        "user_id" : 21998546,
        "user_type" : "registered",
        "profile_image" : "https://lh3.googleusercontent.com/a/AAcHTte7EFNY0rJgwP9Gp8S4S9wCZKe6N2Xk2ZpPaUboaQ=k-s256",
        "display_name" : "Abubakr Shoaliev",
        "link" : "https://stackoverflow.com/users/21998546/abubakr-shoaliev"
      },
      "creation_date" : 1745864560,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}