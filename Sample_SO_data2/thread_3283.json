{
  "question" : {
    "question_id" : 79562179,
    "title" : "False positive error in IntelliJ &quot;Foreach not applicable to type &#39;java.util.List&lt;aig_proxy_service.routes.Route&gt;&#39;&quot; after Java 21 update",
    "body" : "<p>I recently updated my spring boot project to Java 21. bootRun still works, and all the tests pass. However, in IntelliJ, there's still an error displayed in this place:</p>\n<pre><code>        List&lt;Route&gt; auth = routeProperties.getAuth();\n        for (Route authRoute : auth) {\n            addAuthRoute(authRoute);\n        }\n</code></pre>\n<p>It marks the <code>auth</code> in the for-loop as an error, saying:</p>\n<pre><code>Foreach not applicable to type 'java.util.List&lt;my_service.routes.Route&gt;'\n</code></pre>\n<p>For reference, here's how the <code>getAuth()</code> method looks like, in case that might be important:</p>\n<pre><code>@Component\n@ConfigurationProperties(prefix = &quot;routes&quot;)\npublic class RouteProperties {\n    @Setter\n    private List&lt;Route&gt; auth;\n\n    public List&lt;Route&gt; getAuth() {\n        if (auth == null) {\n            auth = new ArrayList&lt;&gt;();\n        }\n        return auth;\n    }\n}\n</code></pre>\n<p>Since the code still runs and the tests still pass, I assume that this is a false positive on the side of IntelliJ. So I have tried all I can think to get rid of this. Things I have tried are:</p>\n<ul>\n<li>gradle clean &amp; gradle build</li>\n<li>deleting the .idea folder</li>\n<li>deleting the build folder</li>\n<li>File &gt; Invalidate Cashes... &gt; Invalidate and Restart</li>\n<li>In the build.gradle, I tried using both:\n<ul>\n<li>\n<pre><code>java {\n    toolchain {\n        languageVersion = JavaLanguageVersion.of(21)\n    }\n}\n</code></pre>\n</li>\n<li>\n<pre><code>java {\n    sourceCompatibility = 21\n    targetCompatibility = 21\n}\n</code></pre>\n</li>\n</ul>\n</li>\n</ul>\n<p>However, the false positive persisted in either case.</p>\n<p>Does anyone have an idea why this error is displayed, and what I can do to get rid of it?</p>\n<hr />\n<h1>New Findings</h1>\n<p>I found that if I open the List.java source file in IntelliJ, for some strange reason, it says that it can't resolve <code>SequencedCollection</code>, from which it inherits from, which would at least explain the behavior, because <code>SequencedCollection</code> inherits from <code>Collection</code>, which inherits from <code>Iterable</code>, which has the <code>forEach</code> method. The <code>SequencedCollection</code> isn't displayed in the External Soruces of IntelliJ either, although <code>Collection</code> and <code>Iterable</code> are. I was also able to confirm that the <code>SequencedCollection</code> is present in the source files of my JDK itself, it just looks like IntelliJ missed it. But I have no idea why.</p>\n<p>I was by now also able to confirm that my SDK contains the <code>SequencedCollection.class</code> (in <code>\\jdk\\jmods\\java.base.jmod\\classes\\java\\util\\SequencedCollection.class</code>).</p>\n",
    "tags" : [ "java", "intellij-idea", "java-21" ],
    "owner" : {
      "account_id" : 12296207,
      "reputation" : 2560,
      "user_id" : 8971773,
      "user_type" : "registered",
      "accept_rate" : 25,
      "profile_image" : "https://i.sstatic.net/tFcJU.png?s=256",
      "display_name" : "Kira Resari",
      "link" : "https://stackoverflow.com/users/8971773/kira-resari"
    },
    "is_answered" : true,
    "view_count" : 100,
    "answer_count" : 1,
    "score" : 1,
    "last_activity_date" : 1744263363,
    "creation_date" : 1744118799,
    "link" : "https://stackoverflow.com/questions/79562179/false-positive-error-in-intellij-foreach-not-applicable-to-type-java-util-list",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79565794,
    "question_id" : 79562179,
    "body" : "<p>I finally managed to resolve this. Turns out it was a deep-seated indexing/caching issue in IntelliJ. Here's how I managed to fix it:</p>\n<ol>\n<li><p>Close IntelliJ (and wait for a bit to make sure its background processes are terminated)</p>\n</li>\n<li><p>Navigate to the IntelliJ cache folder (for me it was located in C:\\Users\\%USER%\\AppData\\Local\\JetBrains\\IntelliJIdea2024.3)</p>\n</li>\n<li><p>Delete that folder</p>\n</li>\n<li><p>Start IntelliJ again</p>\n</li>\n</ol>\n<p>This forced IntelliJ to re-index everything, including the JDK, which it apparently skipped before. After finishing, it now recognizes the SequencedCollection class correctly, and the related false positive errors are gone.</p>\n",
    "score" : 1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 12296207,
      "reputation" : 2560,
      "user_id" : 8971773,
      "user_type" : "registered",
      "accept_rate" : 25,
      "profile_image" : "https://i.sstatic.net/tFcJU.png?s=256",
      "display_name" : "Kira Resari",
      "link" : "https://stackoverflow.com/users/8971773/kira-resari"
    },
    "creation_date" : 1744263363,
    "last_activity_date" : 1744263363,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140312384,
    "post_id" : 79562179,
    "body" : "@daniu This also happens for additional for-loops created in this context. I now tried <code>auth.forEach(this::addAuthRoute);</code>, but this only creates a similar error message: &quot;Cannot resolve method &#39;forEach&#39; in &#39;List&#39;&quot;. In this case, the <code>forEach</code> is underlined. As usual, though, the program and tests still run, and while debugging I was able to confirm that the <code>addAuthRoute</code> Method is successfully called",
    "score" : 0,
    "owner" : {
      "account_id" : 12296207,
      "reputation" : 2560,
      "user_id" : 8971773,
      "user_type" : "registered",
      "accept_rate" : 25,
      "profile_image" : "https://i.sstatic.net/tFcJU.png?s=256",
      "display_name" : "Kira Resari",
      "link" : "https://stackoverflow.com/users/8971773/kira-resari"
    },
    "creation_date" : 1744125057,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140311950,
    "post_id" : 79562179,
    "body" : "Looks like a false positive in Intellij as well. Will this also happen if you create another <code>for</code> loop this way? As an alternative, you could of course use <code>auth.forEach(this::addAuthRoute)</code>.",
    "score" : 0,
    "owner" : {
      "account_id" : 3380632,
      "reputation" : 15109,
      "user_id" : 2837741,
      "user_type" : "registered",
      "accept_rate" : 100,
      "profile_image" : "https://i.sstatic.net/AEHnE.png?s=256",
      "display_name" : "daniu",
      "link" : "https://stackoverflow.com/users/2837741/daniu"
    },
    "creation_date" : 1744119117,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}