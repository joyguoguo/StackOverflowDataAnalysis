{
  "question" : {
    "question_id" : 79747512,
    "title" : "How to log a message if file exists or created using Files.createDirectories()",
    "body" : "<p>I have below Java code to create a file at particular location. I have used <code>Files.createDirectories()</code> to create if directory/folder does not exist.</p>\n<p>I need to log a message as if folder exist then nothing else if not exist need to log a message as &quot;Directory Created&quot;.</p>\n<p>Below is my existing code:</p>\n<pre><code>public static void main(String[] args) {\n\n        String path = &quot;E:\\\\krishTest\\\\&quot;;\n        String filename = path + &quot;firstsheet.xls&quot;;\n\n        try {\n            Files.createDirectories(Paths.get(path));\n\n        } catch (Exception ex) {\n            System.out.println(ex);\n        }\n}\n    \n</code></pre>\n",
    "tags" : [ "java", "file" ],
    "owner" : {
      "account_id" : 1004959,
      "reputation" : 1226,
      "user_id" : 1018966,
      "user_type" : "registered",
      "accept_rate" : 100,
      "profile_image" : "https://i.sstatic.net/C9LjB.jpg?s=256",
      "display_name" : "Sandesh",
      "link" : "https://stackoverflow.com/users/1018966/sandesh"
    },
    "is_answered" : true,
    "view_count" : 146,
    "answer_count" : 2,
    "score" : -3,
    "last_activity_date" : 1756376237,
    "creation_date" : 1756267268,
    "link" : "https://stackoverflow.com/questions/79747512/how-to-log-a-message-if-file-exists-or-created-using-files-createdirectories",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79747608,
    "question_id" : 79747512,
    "body" : "<blockquote>\n<p>How to log a message if file exists or created using <code>Files.createDirectories()</code></p>\n</blockquote>\n<p>The answer is (unfortunately) that you can't get <code>Files.createDirectories</code> to log what it is doing.  AFAIK this is also the case for all other <code>Files</code> methods.</p>\n<p>Alternatives:</p>\n<ol>\n<li><p>You could call <code>Files.exists</code> and <code>Files.isDirectory</code> on the directory and its ancestor directories before calling <code>Files.createDirectories()</code>.  But beware of file system race conditions<sup>1</sup>.</p>\n</li>\n<li><p>You could create your own version of <code>Files.createDirectories</code> that logs (or records) the directories that it creates.  Look at the OpenJDK <a href=\"https://github.com/openjdk/jdk/blob/aaff9dec241e4d8eebefd6beaf287582621f315c/src/java.base/share/classes/java/nio/file/Files.java#L684\" rel=\"nofollow noreferrer\">source code</a> for inspiration.</p>\n</li>\n<li><p>You could create a custom <code>FileSystemProvider</code> implementation which logs (or records) what its <code>createDirectory</code> method does (<a href=\"https://docs.oracle.com/javase/8/docs/api/java/nio/file/spi/FileSystemProvider.html#createDirectory-java.nio.file.Path-java.nio.file.attribute.FileAttribute...-\" rel=\"nofollow noreferrer\">javadoc</a>).</p>\n</li>\n</ol>\n<hr />\n<p><sup>1 - For example, between testing that the directory exists and trying to use it, it could be <em>deleted</em> by another process.  Something like this could introduce a security flaw ... in some circumstances.</sup></p>\n",
    "score" : 4,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 47283,
      "reputation" : 723470,
      "user_id" : 139985,
      "user_type" : "registered",
      "accept_rate" : 69,
      "profile_image" : "https://www.gravatar.com/avatar/147c5a9cc1feec049c50da791ac7d144?s=256&d=identicon&r=PG",
      "display_name" : "Stephen C",
      "link" : "https://stackoverflow.com/users/139985/stephen-c"
    },
    "creation_date" : 1756276215,
    "last_activity_date" : 1756376237,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79748796,
    "question_id" : 79747512,
    "body" : "<p>Keep it simple and use <code>if(!Files.exists(dir))</code> as suggested by Stephen C. Running <code>Files.exists</code> concurrently could lead to multiple log messages showing that directory was created. This is not a major concern imo.</p>\n<p>If duplicate messages bothers you, follow Stephen Cs other suggestions or try this combination:</p>\n<pre><code>static Path createDirectories(Path dir) throws IOException{\n    // Ensure parent path exists\n    if (dir.getParent() instanceof Path parent) {\n       Files.createDirectories(parent);\n    }\n    // Ensure directory exists - second caller receives exception which can be ignored\n     try {\n        Files.createDirectory(dir);\n        // log successful create directory\n        System.out.format(&quot;mkdirs %s%n&quot;, dir);\n    } catch(FileAlreadyExistsException ignored /* _ */ ) {\n    }\n    return dir;\n}\n</code></pre>\n<p>If above is run concurrently it would not log same message twice. This works because createDirectories does not report exception for parent folder whereas createDirectory on required directory throws exception if the path exists because of another caller.</p>\n<p>But probably not worth the effort using my answer as checking <code>Files.exists(dir)</code> is shorter.</p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 5998820,
      "reputation" : 16284,
      "user_id" : 4712734,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/f6e922a2cb7e2da59286f27b162aaca5?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "DuncG",
      "link" : "https://stackoverflow.com/users/4712734/duncg"
    },
    "creation_date" : 1756368202,
    "last_activity_date" : 1756376226,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140695091,
    "post_id" : 79747512,
    "body" : "Please don&#39;t consider the complete code. It was mentioned for a background of what and why the question asked.   The conclusion is the method <code>createDirectories</code> not providing the functionality to log the message. It needs to create in other way as you mentioned in your answer or try with our own method.",
    "score" : 0,
    "owner" : {
      "account_id" : 1004959,
      "reputation" : 1226,
      "user_id" : 1018966,
      "user_type" : "registered",
      "accept_rate" : 100,
      "profile_image" : "https://i.sstatic.net/C9LjB.jpg?s=256",
      "display_name" : "Sandesh",
      "link" : "https://stackoverflow.com/users/1018966/sandesh"
    },
    "creation_date" : 1756278046,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140695026,
    "post_id" : 79747512,
    "body" : "FWIW: most of your code is irrelevant to the question you are asking.  You don&#39;t need to create a spreadsheet in order to ask about the behavior of <code>createDirectories</code>.",
    "score" : 2,
    "owner" : {
      "account_id" : 47283,
      "reputation" : 723470,
      "user_id" : 139985,
      "user_type" : "registered",
      "accept_rate" : 69,
      "profile_image" : "https://www.gravatar.com/avatar/147c5a9cc1feec049c50da791ac7d144?s=256&d=identicon&r=PG",
      "display_name" : "Stephen C",
      "link" : "https://stackoverflow.com/users/139985/stephen-c"
    },
    "creation_date" : 1756275028,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140694920,
    "post_id" : 79747512,
    "body" : "As an aside, you should bring your exception handling to 2025: 1) use  <a href=\"https://www.baeldung.com/java-try-with-resources\" rel=\"nofollow noreferrer\">try-with-resources</a>, to avoid leaking file handles; 2) Don&#39;t catch Exception, catch the specific exception if needed instead; 3) methods named <code>writeFile(...)</code> should almost always be declared to <code>throws IOException</code>; 4) if you&#39;re not using a logging framework, favor <code>ex.printStacktrace(...) </code> over <code>someStream.print(ex)</code> (The former will include the stack and cause, if existing, the latter not so much)",
    "score" : 3,
    "owner" : {
      "account_id" : 30223964,
      "reputation" : 262,
      "user_id" : 23162960,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/2451acfac254a6fc75757ecf89d75f9a?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Jannik S.",
      "link" : "https://stackoverflow.com/users/23162960/jannik-s"
    },
    "creation_date" : 1756270317,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140694883,
    "post_id" : 79747512,
    "body" : "here is no option to tell <code>createDirectories()</code> to log this. In other words, you <b>cannot use</b> that method. Write it yourself. It&#39;s not exactly difficult, and the source is available. First you walk up with <code>getParent()</code> until you find a dir that does exist, then you walk back down, creating each directory (and logging that you are doing so).",
    "score" : 3,
    "owner" : {
      "account_id" : 401843,
      "reputation" : 107206,
      "user_id" : 768644,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/b13bedc5215730fbce5edff6c130988a?s=256&d=identicon&r=PG",
      "display_name" : "rzwitserloot",
      "link" : "https://stackoverflow.com/users/768644/rzwitserloot"
    },
    "creation_date" : 1756268276,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}