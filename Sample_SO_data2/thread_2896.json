{
  "question" : {
    "question_id" : 79589418,
    "title" : "How to make getCredential() work in Java?",
    "body" : "<p>I'm in the process of adding phone number and google account sign-in to my app.\nThe phone number sign-in works great, but I cannot seem to make the google sign-in work, no matter what I do. (I even tried asking ChatGPT and Gemini, didn't help :))</p>\n<p>Basically, every way I tried ended up failing because the compiler doesn't recognize the methods in the CredentialManager (I'm using the correct, newer, androidx version of the imported class): mainly cannot resolve any type of <code>getCredential()</code>.</p>\n<p>I should note that I'm doing everything in a Fragment. The relevant code:</p>\n<p><strong>In onCreateView():</strong></p>\n<pre><code>        //instance the mAuth as an instance of FirebaseAuth:\n        mAuth = FirebaseAuth.getInstance();\n        //instance the CredentialManager:\n        credentialManager = CredentialManager.create(requireContext());\n\n\n\n\n        googleSignInButton.setOnClickListener(v -&gt; {\n\n            //start the sign-in process:\n            if(isAdded()){\n                getGoogleCredentialTask(requireContext())\n                        .addOnSuccessListener(response -&gt; {\n                            Credential credential = response.getCredential();\n                            signInWithGoogleId(credential);\n                        })\n                        .addOnFailureListener(e -&gt; {\n                            Log.e(TAG, &quot;Google sign-in failed&quot; + e);\n                            Toast.makeText(getContext(), &quot;Google sign-in failed: &quot; + e, Toast.LENGTH_SHORT).show();\n                        });\n            }\n        }\n</code></pre>\n<p><strong>Outside onCreatView(), in the Fragment level:</strong></p>\n<pre><code>    //the method handling and returning the appropriate Task for the googleID sign-in process:\n    private Task&lt;GetCredentialResponse&gt; getGoogleCredentialTask(Context context) {\n        TaskCompletionSource&lt;GetCredentialResponse&gt; taskCompletionSource = new TaskCompletionSource&lt;&gt;();\n\n        GetGoogleIdOption googleIdOption = new GetGoogleIdOption.Builder()\n                .setFilterByAuthorizedAccounts(false)\n                .setServerClientId(CLIENT_ID)\n                .build();\n\n        GetCredentialRequest request = new GetCredentialRequest.Builder()\n                .addCredentialOption(googleIdOption)\n                .build();\n\n        Executor executor = context != null ? ContextCompat.getMainExecutor(context) : Runnable::run;\n\n--------**The error is right here!**---------------------------------------------------\n        credentialManager.getCredential(requireActivity(), request)\n                .addOnSuccessListener(executor, taskCompletionSource::setResult)\n                .addOnFailureListener(executor, taskCompletionSource::setException);\n-----------------------------------------------------------------------------------\n\n        return taskCompletionSource.getTask();\n    }\n\n\n    //the method to initiate google sign-in with the given GoogleID credential:\n    private void signInWithGoogleId(Credential credential){\n        //make sure the given credential is a GoogleID credential: \n        if(credential instanceof CustomCredential &amp;&amp; credential.getType().equals(TYPE_GOOGLE_ID_TOKEN_CREDENTIAL)){\n            //create GoogleID token from the credential:\n            CustomCredential customCredential = (CustomCredential) credential;\n            Bundle bundle = customCredential.getData();\n            GoogleIdTokenCredential googleIdTokenCredential = GoogleIdTokenCredential.createFrom(bundle);\n\n            //authorize with firebase: with a method.\n            authorizeWithFirebaseGoogle(googleIdTokenCredential.getIdToken());\n\n        } else{\n            Toast.makeText(getContext(), &quot;Credential type is not of GoogleID!&quot;, Toast.LENGTH_SHORT).show();\n        }\n\n    }\n\n\n    //the method to authorize with firebase with a GoogleID token (final step):\n    private void authorizeWithFirebaseGoogle(String idToken){\n        AuthCredential authCredential = GoogleAuthProvider.getCredential(idToken, null);\n        mAuth.signInWithCredential(authCredential).addOnCompleteListener(requireActivity(), new OnCompleteListener&lt;AuthResult&gt;() {\n            @Override\n            public void onComplete(@NonNull Task&lt;AuthResult&gt; task) {\n                handleSignInResult(task);\n            }\n        });\n    }\n\n\n    //as i said, this isn't only for the google sign-in. This method works great.\n    //handle the sign-in result from the googleID sign-in and phone number sign-in:\n    private void handleSignInResult(Task&lt;AuthResult&gt; task){\n        if(task.isSuccessful()){\n            //great! the user has been approved and the sign in was successful.\n            Toast.makeText(getContext(), &quot;Signed-in successfully! P&quot;, Toast.LENGTH_SHORT).show();\n            //insert the user:\n            firebaseUser = task.getResult().getUser();\n            //Done!\n        } else{\n            //the sign-in has not been approved.\n            Toast.makeText(getContext(), &quot;Sign-in failed.&quot;, Toast.LENGTH_SHORT).show();\n            if (task.getException() instanceof FirebaseAuthInvalidCredentialsException) {\n                // The verification code entered was invalid:\n                Toast.makeText(getContext(), &quot;The verification code is wrong. Try again.&quot;, Toast.LENGTH_SHORT).show();\n            } else{\n                Toast.makeText(getContext(), &quot;Other Error.&quot;, Toast.LENGTH_SHORT).show();\n            }\n        }\n    }\n\n</code></pre>\n<p>The error itself:</p>\n<pre><code>Cannot resolve method 'getCredential(FragmentActivity, GetCredentialRequest)'\n\nCandidates for method call credentialManager. getCredential(requireActivity(), request) are:\nObject getCredential(Context, GetCredentialRequest, Continuation&lt;? super GetCredentialResponse&gt;)\nObject getCredential(Context, PendingGetCredentialHandle, Continuation&lt;? super GetCredentialResponse&gt;) \n</code></pre>\n<p>But from what I know, read, and ChatGPT and Gemini told me, the last part of every suggestion (the <code>Continuation&lt;?</code> part) is Kotlin only.\nIs there a way to make it work with Java? If not, how can I bypass this problem?</p>\n<p>Thanks</p>\n<p><em><strong>Edit:</strong></em>\nMy App-level build.gradle file (excluding android{}):</p>\n<pre><code>plugins {\n    alias(libs.plugins.android.application)\n    id &quot;com.google.gms.google-services&quot;\n}\ndependencies {\n\n    implementation libs.appcompat\n    implementation libs.material\n    implementation libs.activity\n    implementation libs.constraintlayout\n\n\n    testImplementation libs.junit\n    androidTestImplementation libs.ext.junit\n    androidTestImplementation libs.espresso.core\n\n\n    //implementations for Room, the library I will be using to manage SQLite database.\n    def room_version = &quot;2.6.1&quot;\n    implementation libs.room.runtime\n    annotationProcessor &quot;androidx.room:room-compiler:$room_version&quot;\n\n    //implementations for firebase:\n    implementation platform(libs.firebase.bom)\n    implementation libs.firebase.analytics\n    //for authentication with firebase:\n    implementation libs.firebase.auth\n\n    implementation libs.credentials\n    implementation libs.credentials.play.services.auth\n    implementation libs.googleid\n    implementation libs.play.services.auth\n\n}\n</code></pre>\n<p>Project-level build.gradle file:</p>\n<pre><code>plugins {\n    alias(libs.plugins.android.application) apply false\n    id &quot;com.google.gms.google-services&quot; version &quot;4.4.2&quot; apply false\n}\n</code></pre>\n<p><em><strong>EDIT #2</strong></em>\nMy libs.versions.toml file:</p>\n<pre><code>[versions]\nagp = &quot;8.9.2&quot;\ncredentials = &quot;1.5.0&quot;\ncredentialsPlayServicesAuth = &quot;1.5.0&quot;\nfirebaseBom = &quot;33.13.0&quot;\ngoogleidVersion = &quot;1.1.1&quot;\njunit = &quot;4.13.2&quot;\njunitVersion = &quot;1.2.1&quot;\nespressoCore = &quot;3.6.1&quot;\nappcompat = &quot;1.7.0&quot;\nmaterial = &quot;1.12.0&quot;\nactivity = &quot;1.10.1&quot;\nconstraintlayout = &quot;2.2.1&quot;\nplayServicesAuth = &quot;21.3.0&quot;\nroomRuntime = &quot;2.7.1&quot;\n\n[libraries]\ncredentials = { module = &quot;androidx.credentials:credentials&quot;, version.ref = &quot;credentials&quot; }\ncredentials-play-services-auth = { module = &quot;androidx.credentials:credentials-play-services-auth&quot;, version.ref = &quot;credentialsPlayServicesAuth&quot; }\nfirebase-analytics = { module = &quot;com.google.firebase:firebase-analytics&quot; }\nfirebase-auth = { module = &quot;com.google.firebase:firebase-auth&quot; }\nfirebase-bom = { module = &quot;com.google.firebase:firebase-bom&quot;, version.ref = &quot;firebaseBom&quot; }\ngoogleid = { module = &quot;com.google.android.libraries.identity.googleid:googleid&quot;, version.ref = &quot;googleidVersion&quot; }\njunit = { group = &quot;junit&quot;, name = &quot;junit&quot;, version.ref = &quot;junit&quot; }\next-junit = { group = &quot;androidx.test.ext&quot;, name = &quot;junit&quot;, version.ref = &quot;junitVersion&quot; }\nespresso-core = { group = &quot;androidx.test.espresso&quot;, name = &quot;espresso-core&quot;, version.ref = &quot;espressoCore&quot; }\nappcompat = { group = &quot;androidx.appcompat&quot;, name = &quot;appcompat&quot;, version.ref = &quot;appcompat&quot; }\nmaterial = { group = &quot;com.google.android.material&quot;, name = &quot;material&quot;, version.ref = &quot;material&quot; }\nactivity = { group = &quot;androidx.activity&quot;, name = &quot;activity&quot;, version.ref = &quot;activity&quot; }\nconstraintlayout = { group = &quot;androidx.constraintlayout&quot;, name = &quot;constraintlayout&quot;, version.ref = &quot;constraintlayout&quot; }\nplay-services-auth = { module = &quot;com.google.android.gms:play-services-auth&quot;, version.ref = &quot;playServicesAuth&quot; }\nroom-runtime = { module = &quot;androidx.room:room-runtime&quot;, version.ref = &quot;roomRuntime&quot; }\n\n[plugins]\nandroid-application = { id = &quot;com.android.application&quot;, version.ref = &quot;agp&quot; }\n\n</code></pre>\n<p>FYI: I'm using android studio IDE version Meerkat, gradle version 8.11.1, agp version 8.9.2.</p>\n<p>Tnx!</p>\n",
    "tags" : [ "java", "android", "gradle", "credentials", "android-credential-manager" ],
    "owner" : {
      "account_id" : 22520888,
      "reputation" : 31,
      "user_id" : 16714497,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a/AATXAJy0chnKiTg3p6Ps2ba8iAgv7pENEpGqEz1ANK1N=k-s256",
      "display_name" : "דור דקל",
      "link" : "https://stackoverflow.com/users/16714497/%d7%93%d7%95%d7%a8-%d7%93%d7%a7%d7%9c"
    },
    "is_answered" : false,
    "view_count" : 189,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1752292230,
    "creation_date" : 1745438279,
    "link" : "https://stackoverflow.com/questions/79589418/how-to-make-getcredential-work-in-java",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79698990,
    "question_id" : 79589418,
    "body" : "<p>Are you sure you are using the CredentialManager from the androidx Jetpack library? Looks like you're using the  one in the <a href=\"https://developer.android.com/reference/android/credentials/CredentialManager#getCredential(android.content.Context,%20android.credentials.PrepareGetCredentialResponse.PendingGetCredentialHandle,%20android.os.CancellationSignal,%20java.util.concurrent.Executor,%20android.os.OutcomeReceiver%3Candroid.credentials.GetCredentialResponse,android.credentials.GetCredentialException%3E)\" rel=\"nofollow noreferrer\">Android Framework</a> instead of the one from <a href=\"https://developer.android.com/reference/androidx/credentials/CredentialManager#getCredential(android.content.Context,androidx.credentials.GetCredentialRequest)\" rel=\"nofollow noreferrer\">Jetpack</a> (androidx).</p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 3286414,
      "reputation" : 19577,
      "user_id" : 2765813,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/E2HmP.jpg?s=256",
      "display_name" : "Ali Naddaf",
      "link" : "https://stackoverflow.com/users/2765813/ali-naddaf"
    },
    "creation_date" : 1752292230,
    "last_activity_date" : 1752292230,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140370005,
    "post_id" : 79589418,
    "body" : "@דורדקל - According due to the <a href=\"https://developer.android.com/reference/androidx/credentials/CredentialManager#getCredential(android.content.Context,androidx.credentials.GetCredentialRequest)\" rel=\"nofollow noreferrer\">documentation</a>, getCredential has two overloaded methods and there is also getCredentialAsync. I would take a look at those to see which option you prefer to use.",
    "score" : 0,
    "owner" : {
      "account_id" : 14722107,
      "reputation" : 6861,
      "user_id" : 10632369,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/541566093e9d34a3858f5446d06a7a6e?s=256&d=identicon&r=PG",
      "display_name" : "tomerpacific",
      "link" : "https://stackoverflow.com/users/10632369/tomerpacific"
    },
    "creation_date" : 1745600627,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140368763,
    "post_id" : 79589418,
    "body" : "@tomerpacific Just edited again. Thank you and sorry for not supplying all relevant files in the beginning.",
    "score" : 0,
    "owner" : {
      "account_id" : 22520888,
      "reputation" : 31,
      "user_id" : 16714497,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a/AATXAJy0chnKiTg3p6Ps2ba8iAgv7pENEpGqEz1ANK1N=k-s256",
      "display_name" : "דור דקל",
      "link" : "https://stackoverflow.com/users/16714497/%d7%93%d7%95%d7%a8-%d7%93%d7%a7%d7%9c"
    },
    "creation_date" : 1745579521,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140367946,
    "post_id" : 79589418,
    "body" : "@דורדקל - We&#39;re going to need to see the toml file where the versions are defined.",
    "score" : 0,
    "owner" : {
      "account_id" : 14722107,
      "reputation" : 6861,
      "user_id" : 10632369,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/541566093e9d34a3858f5446d06a7a6e?s=256&d=identicon&r=PG",
      "display_name" : "tomerpacific",
      "link" : "https://stackoverflow.com/users/10632369/tomerpacific"
    },
    "creation_date" : 1745562076,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140366117,
    "post_id" : 79589418,
    "body" : "The main question is where do you got the code from and which Firebase version does it target? AI may only print you potential outdated versions including hallucination. Google provides the sample code for recent versions: <a href=\"https://firebase.google.com/docs/auth/android/manage-users#kotlin\" rel=\"nofollow noreferrer\">firebase.google.com/docs/auth/android/manage-users#kotlin</a>",
    "score" : 0,
    "owner" : {
      "account_id" : 50585,
      "reputation" : 43469,
      "user_id" : 150978,
      "user_type" : "registered",
      "accept_rate" : 78,
      "profile_image" : "https://www.gravatar.com/avatar/feadc214792e2581c3c750140e3eb2c7?s=256&d=identicon&r=PG",
      "display_name" : "Robert",
      "link" : "https://stackoverflow.com/users/150978/robert"
    },
    "creation_date" : 1745508726,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140365800,
    "post_id" : 79589418,
    "body" : "Sure, I edited the question and now it includes the app-level and project-level build.gradle files.",
    "score" : 0,
    "owner" : {
      "account_id" : 22520888,
      "reputation" : 31,
      "user_id" : 16714497,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a/AATXAJy0chnKiTg3p6Ps2ba8iAgv7pENEpGqEz1ANK1N=k-s256",
      "display_name" : "דור דקל",
      "link" : "https://stackoverflow.com/users/16714497/%d7%93%d7%95%d7%a8-%d7%93%d7%a7%d7%9c"
    },
    "creation_date" : 1745504011,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140364024,
    "post_id" : 79589418,
    "body" : "Can you share your build.gradle file so we can see which versions of dependencies you are using?",
    "score" : 0,
    "owner" : {
      "account_id" : 14722107,
      "reputation" : 6861,
      "user_id" : 10632369,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/541566093e9d34a3858f5446d06a7a6e?s=256&d=identicon&r=PG",
      "display_name" : "tomerpacific",
      "link" : "https://stackoverflow.com/users/10632369/tomerpacific"
    },
    "creation_date" : 1745475785,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}