{
  "question" : {
    "question_id" : 79583681,
    "title" : "Issues when checking documents in embedded test flapdoodle mongodb",
    "body" : "<p>I am developing a project and I am now creating junits for parts of my code where I use a mongo DB connection. On my actual DB it works fine but I am trying to set up an embedded DB to run my tests on and for some reason it is not working:</p>\n<p>I am using this dependency:</p>\n<pre><code>&lt;dependency&gt;\n        &lt;groupId&gt;de.flapdoodle.embed&lt;/groupId&gt;\n        &lt;artifactId&gt;de.flapdoodle.embed.mongo.spring3x&lt;/artifactId&gt;\n        &lt;version&gt;4.11.0&lt;/version&gt;\n        &lt;scope&gt;test&lt;/scope&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>In my Junit my flow is good and all tests run well except at the end of the test (still inside the same method) I try to check if the document was saved and is present in the db but I get a null.</p>\n<p>I am using a @repository annotation to extend the interfacce of mongoRepository and I have a method findById that works fine with the normal db.</p>\n<p>In my application.yml I have this:</p>\n<pre><code>de:\n  flapdoodle:\n    mongodb:\n      embedded:\n        version: 4.0.2\n</code></pre>\n<p>Am I doing something wrong?</p>\n",
    "tags" : [ "java", "spring", "mongodb", "junit5", "flapdoodle-embed-mongo" ],
    "owner" : {
      "account_id" : 32490050,
      "reputation" : 21,
      "user_id" : 25242258,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/3197b72e016d4fe580cf8e016ecc3f09?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Lu&#237;s Casqueiro",
      "link" : "https://stackoverflow.com/users/25242258/lu%c3%ads-casqueiro"
    },
    "is_answered" : false,
    "view_count" : 79,
    "answer_count" : 0,
    "score" : 1,
    "last_activity_date" : 1745177663,
    "creation_date" : 1745177663,
    "link" : "https://stackoverflow.com/questions/79583681/issues-when-checking-documents-in-embedded-test-flapdoodle-mongodb",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140362964,
    "post_id" : 79583681,
    "body" : "You might want to add a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. This helps other people to help you and by reducing the code, often the problem can be discovered.",
    "score" : 0,
    "owner" : {
      "account_id" : 1358954,
      "reputation" : 21002,
      "user_id" : 1296707,
      "user_type" : "registered",
      "accept_rate" : 50,
      "profile_image" : "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=256&d=identicon&r=PG",
      "display_name" : "Markus W Mahlberg",
      "link" : "https://stackoverflow.com/users/1296707/markus-w-mahlberg"
    },
    "creation_date" : 1745438919,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140362734,
    "post_id" : 79583681,
    "body" : "So when I call the method I defined in my repository class to findById it does not find the element. But I am sure the ID is the correct one",
    "score" : 0,
    "owner" : {
      "account_id" : 32490050,
      "reputation" : 21,
      "user_id" : 25242258,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/3197b72e016d4fe580cf8e016ecc3f09?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Lu&#237;s Casqueiro",
      "link" : "https://stackoverflow.com/users/25242258/lu%c3%ads-casqueiro"
    },
    "creation_date" : 1745434193,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140362731,
    "post_id" : 79583681,
    "body" : "The only error I get is the error of the Junit saying that after the flow happens (which I am sure adds an entry to the database) there is no document stored in the db. I can see the correct connection being made at the start of the test and when the code runs I am able to call the method insert into the db repo. But when I check the db instance to see if there is an entry I get the problem that is empty",
    "score" : 0,
    "owner" : {
      "account_id" : 32490050,
      "reputation" : 21,
      "user_id" : 25242258,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/3197b72e016d4fe580cf8e016ecc3f09?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Lu&#237;s Casqueiro",
      "link" : "https://stackoverflow.com/users/25242258/lu%c3%ads-casqueiro"
    },
    "creation_date" : 1745434125,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140353960,
    "post_id" : 79583681,
    "body" : "<a href=\"https://stackoverflow.com/help/how-to-ask\">How to ask good questions</a>. What is the error you get? How does &quot;not working&quot; manifest?",
    "score" : 0,
    "owner" : {
      "account_id" : 1358954,
      "reputation" : 21002,
      "user_id" : 1296707,
      "user_type" : "registered",
      "accept_rate" : 50,
      "profile_image" : "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=256&d=identicon&r=PG",
      "display_name" : "Markus W Mahlberg",
      "link" : "https://stackoverflow.com/users/1296707/markus-w-mahlberg"
    },
    "creation_date" : 1745227820,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}