{
  "question" : {
    "question_id" : 79643317,
    "title" : "How do I add conditions that possibly do not exist",
    "body" : "<p>There are some tables like the following in our system: <code>locations</code>, <code>addresses</code>, <code>cities</code>.</p>\n<p>The <code>locations</code> has a <code>address_id</code> that refers to <code>addresses</code>, and <code>addresses</code> has <code>city_id</code> that refers to cities.</p>\n<div class=\"s-table-container\"><table class=\"s-table\">\n<thead>\n<tr>\n<th>locations</th>\n<th>addresses</th>\n<th>cities</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>name, address_id</td>\n<td>line1, line2, city_id</td>\n<td>name, code</td>\n</tr>\n</tbody>\n</table></div>\n<p>The addresses are optional for locations, and city is also optional for addresses, that means <code>locations.address_id</code>, <code>addresses.city_id</code> are nullable.</p>\n<p>When there is a query keyword from client, we want to use SQL <code>like</code> to match one of these 3 items: <code>locations.name</code>, <code>addresses.line1</code>, <code>cities.name</code>, the later two could not exist at all.</p>\n<p>I tried to use the clause similar to the following, the problem is the <code>...or...or</code> will be evaluated too early.</p>\n<pre class=\"lang-java prettyprint-override\"><code>dslContext.select(...)\n  .from(\n       LOCATIONS\n           .leftJoin(\n                ADDRESSES.leftJoin(CITIES).on(....)\n           )\n          .on(...)\n   )\n  .where(\n     LOCATIONS.NAME.likeIgnoreCase(query)\n         .or(ADDRESSES.LINE1.likeIgnoreCase(query))\n         .or(CITIES.NAME.likeIngoreCase(query))\n  )\n</code></pre>\n<p>If I moved <code>ADDRESSES.LINE1.likeIgnoreCase(query)</code> and <code>CITIES.NAME.likeIngoreCase(query)</code> to the <code>on(...)</code>, from the query result, these clauses are not a <code>OR</code> relation to the <code>LOCATIONS.NAME.likeIgnoreCase(query)</code>.</p>\n",
    "tags" : [ "java", "jooq", "r2dbc" ],
    "owner" : {
      "account_id" : 480584,
      "reputation" : 9611,
      "user_id" : 893898,
      "user_type" : "registered",
      "accept_rate" : 42,
      "profile_image" : "https://www.gravatar.com/avatar/cbb75897ee67011990d4706fad19e38b?s=256&d=identicon&r=PG",
      "display_name" : "Hantsy",
      "link" : "https://stackoverflow.com/users/893898/hantsy"
    },
    "is_answered" : true,
    "view_count" : 64,
    "answer_count" : 1,
    "score" : 2,
    "last_activity_date" : 1748848449,
    "creation_date" : 1748494513,
    "link" : "https://stackoverflow.com/questions/79643317/how-do-i-add-conditions-that-possibly-do-not-exist",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79648261,
    "question_id" : 79643317,
    "body" : "<p>Assuming the <code>ADDRESSES.LINE1</code> and <code>CITIES.NAME</code> fields are non-nullable, you can just add more predicates:</p>\n<pre class=\"lang-java prettyprint-override\"><code>  .where(\n     LOCATIONS.NAME.likeIgnoreCase(query)\n         .or(ADDRESSES.LINE1.likeIgnoreCase(query))\n         .or(ADDRESSES.LINE1.isNull())\n         .or(CITIES.NAME.likeIngoreCase(query))\n         .or(CITIES.NAME.isNull())\n  )\n</code></pre>\n<p>If the fields are nullable, then you might need to take this semantics into account as well.</p>\n",
    "score" : 0,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 247217,
      "reputation" : 223532,
      "user_id" : 521799,
      "user_type" : "registered",
      "accept_rate" : 89,
      "profile_image" : "https://www.gravatar.com/avatar/eb96efa7a5664ba1c4ebf586abd4121f?s=256&d=identicon&r=PG",
      "display_name" : "Lukas Eder",
      "link" : "https://stackoverflow.com/users/521799/lukas-eder"
    },
    "creation_date" : 1748845818,
    "last_activity_date" : 1748845818,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : { }
}