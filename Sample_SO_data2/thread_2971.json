{
  "question" : {
    "question_id" : 79584390,
    "title" : "Debugging MCP server",
    "body" : "<p>This seems pretty straight-forward: How do I debug an MCP server created via Spring AI's framework? I've seen several getting started tutorials, but none of them shows this part.</p>\n<p>What I want to achieve is to invoke a tool on my MCP server (either via @mcp/inspector or vscode agent mode) and be able to attach to the session.</p>\n<h2>Solution</h2>\n<p>Both answers below were helpful, but not as-is.</p>\n<h4>What Did Work</h4>\n<ol>\n<li>Applying the debug flags to vscode mcp server config:</li>\n</ol>\n<pre class=\"lang-json prettyprint-override\"><code>&quot;mcp&quot;: { \n  &quot;servers&quot;: { \n    &quot;my-server&quot;: {\n      &quot;command&quot;: &quot;java&quot;,\n      &quot;args&quot;: [&quot;-jar&quot;, &quot;&lt;path/to/jar&gt;&quot;],\n      &quot;env&quot;: { &quot;JAVA_TOOL_OPTIONS&quot;:&quot;-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=*:5005&quot;\n    }\n  }\n}\n</code></pre>\n<ol start=\"2\">\n<li>Creating a Remote JVM Debug configuration on IntelliJ with port 5005</li>\n<li>Run via vscode agent</li>\n</ol>\n<ul>\n<li>For some reason, repeating this on <code>@mcp/inspector</code> with the same debug flags set as environment variables in the UI didn't hit the breakpoints (even though the tools themselves worked and responded properly)</li>\n</ul>\n<h4>What didn't Work</h4>\n<ol>\n<li>I could not find the proposed packages for <code>@McpInspector</code> or <code>@McpTool</code> (Did you mean <code>spring.ai.tool.annotation.Tool</code>?)</li>\n<li>The suggestion to run my application did not help - in its most default setup, with property <code>spring.main.web-application-type=none</code>, no breakpoint is hit when using either vscode agent mode or <code>npx @mcp/inspector</code></li>\n</ol>\n",
    "tags" : [ "java", "spring-boot", "model-context-protocol" ],
    "owner" : {
      "account_id" : 7169608,
      "reputation" : 345,
      "user_id" : 5477548,
      "user_type" : "registered",
      "accept_rate" : 75,
      "profile_image" : "https://lh3.googleusercontent.com/-u_GWgGl3A68/AAAAAAAAAAI/AAAAAAAAAF4/GqN9bcsoapY/s256-rj/photo.jpg",
      "display_name" : "yoad w",
      "link" : "https://stackoverflow.com/users/5477548/yoad-w"
    },
    "is_answered" : true,
    "view_count" : 1094,
    "answer_count" : 3,
    "score" : 1,
    "last_activity_date" : 1747185689,
    "creation_date" : 1745229596,
    "link" : "https://stackoverflow.com/questions/79584390/debugging-mcp-server",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79584455,
    "question_id" : 79584390,
    "body" : "<ol>\n<li>First, make sure your Spring Boot application is running in a mode that allows remote debugging:</li>\n</ol>\n<p>JAVA_TOOL_OPTIONS='-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=*:5005' ./mvnw spring-boot:run</p>\n<p>Or add the <code>jdwp</code> agent options to your run config in your IDE (IntelliJ, VS Code, etc).</p>\n<ol start=\"2\">\n<li>Run Your MCP Server in Tool Agent Mode</li>\n</ol>\n<p>If you're using Spring AI’s built-in tool integration (e.g., with <code>@McpTool</code> or custom tool implementations), you can expose the tool interface and launch the server with something like:</p>\n<pre><code>@McpTool\npublic class MyTool {\n    public String doSomething(String input) {\n        // Place a breakpoint here!\n        return &quot;Processed: &quot; + input;\n    }\n}\n</code></pre>\n<p>Once the tool is registered with the MCP server, it should be callable via the client agent (like VS Code or <code>@mcp/inspector</code>).</p>\n<p>3. Attach a Debugger</p>\n<ul>\n<li><p><strong>VS Code</strong>: Add a launch config like this in <code>.vscode/launch.json</code>:</p>\n<pre><code>{\n  &quot;type&quot;: &quot;java&quot;,\n  &quot;name&quot;: &quot;Attach to Spring MCP Server&quot;,\n  &quot;request&quot;: &quot;attach&quot;,\n  &quot;hostName&quot;: &quot;localhost&quot;,\n  &quot;port&quot;: 5005\n}\n\n</code></pre>\n</li>\n<li><p><strong>IntelliJ</strong>: Use <em>Run &gt; Edit Configurations &gt; Remote JVM Debug</em> and set the port to <code>5005</code>.</p>\n</li>\n</ul>\n<p>4. Invoke a Tool from Inspector or VS Code MCP Agent</p>\n<p>If you’re using the <code>@mcp/inspector</code> or VS Code’s Spring AI extension:</p>\n<ul>\n<li><p>In <strong>VS Code</strong>, make sure you’ve installed the Spring AI plugin or enabled the MCP extension.</p>\n</li>\n<li><p>Use a prompt in the MCP chat window that will trigger your tool, e.g.:</p>\n</li>\n</ul>\n<blockquote>\n<p>&quot;Hey tool, doSomething with input 'hello'&quot;</p>\n</blockquote>\n",
    "score" : 2,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 8368854,
      "reputation" : 31,
      "user_id" : 6284588,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/676acae6984d4b14c2b527d39c5a9a25?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Ashutosh Dwivedi",
      "link" : "https://stackoverflow.com/users/6284588/ashutosh-dwivedi"
    },
    "creation_date" : 1745232425,
    "last_activity_date" : 1745232425,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79584428,
    "question_id" : 79584390,
    "body" : "<ol>\n<li>Ensure that your project has the necessary dependency for the MCP Inspector. Include it in your <code>pom.xml</code> if you're using Maven:</li>\n</ol>\n<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.ai&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-ai-mcp-inspector&lt;/artifactId&gt;\n    &lt;version&gt;${version}&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n<ol start=\"2\">\n<li>Use the <code>@mcp/inspector</code> annotation to mark the methods or classes you want to debug. This will enable the inspector for those components.</li>\n</ol>\n<pre><code>import org.springframework.ai.mcp.inspector.McpInspector;\n\n@McpInspector\npublic class MyMcpService {\n    public void myMcpMethod() {\n        // Business logic here\n    }\n}\n</code></pre>\n<ol start=\"3\">\n<li><p>Run your Spring application. Make sure the environment is set up to allow for remote debugging. This can be done by adding JVM arguments when starting the application:</p>\n<pre><code>-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=*:5005\n</code></pre>\n</li>\n<li><p>When you invoke the tool (e.g., via a REST call or any interface you have within your MCP), the inspector will begin processing.</p>\n</li>\n<li><p>Open your IDE, and configure a remote debugging session. For example, in IntelliJ IDEA or Eclipse, you would set up a remote debugging configuration that connects to port 5005.</p>\n</li>\n</ol>\n",
    "score" : 1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 23685459,
      "reputation" : 36,
      "user_id" : 17710465,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a-/AOh14GgLHH2tXZYMmw1khxlwWwLFmDjb0O-K72zAY431iA=k-s256",
      "display_name" : "SuedaSen",
      "link" : "https://stackoverflow.com/users/17710465/suedasen"
    },
    "creation_date" : 1745231341,
    "last_activity_date" : 1745231341,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79620611,
    "question_id" : 79584390,
    "body" : "<h3>It maybe:</h3>\n<ul>\n<li><p>Missing <code>@Tool</code> annotation (<code>spring.ai.tool.annotation.Tool</code>)</p>\n</li>\n<li><p><code>spring.main.web-application-type=none</code> can block proper startup.</p>\n</li>\n<li><p>Setting environment variables in UI might not work—use command line or run config.</p>\n</li>\n</ul>\n<ol>\n<li><p><strong>Enable Remote Debugging:</strong></p>\n<ul>\n<li><p>Add JVM option:</p>\n<pre><code>-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=*:5005\n\n</code></pre>\n</li>\n<li><p>Use this with your Spring Boot command or IDE configuration.</p>\n</li>\n</ul>\n</li>\n<li><p><strong>Set Up IDE Debugging:</strong></p>\n<ul>\n<li><p>In IntelliJ: Use &quot;Remote JVM Debug&quot; with port <code>5005</code>.</p>\n</li>\n<li><p>In VS Code: Use <code>launch.json</code> with <code>request: attach</code>.</p>\n</li>\n</ul>\n</li>\n<li><p><strong>Trigger the Tool:</strong></p>\n<ul>\n<li>Use an MCP client (e.g., <code>@mcp/inspector</code>) to send input to the tool.</li>\n</ul>\n</li>\n</ol>\n<hr />\n<p>Let me know if you want a ready-to-use debug script or Spring Boot example.</p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 39125963,
      "reputation" : 1,
      "user_id" : 29121013,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/92ae860afa3e0c7eb41336b5a6518fa0?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Chieh-Jen Wang",
      "link" : "https://stackoverflow.com/users/29121013/chieh-jen-wang"
    },
    "creation_date" : 1747185659,
    "last_activity_date" : 1747185689,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : { }
}