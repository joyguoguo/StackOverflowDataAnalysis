{
  "question" : {
    "question_id" : 79757676,
    "title" : "With Gemini and LangChain4j, how to use Structured output while retrieving metadata?",
    "body" : "<p>I use Gemini to get information about historical figures :</p>\n<pre><code>public interface Historian {\n    @UserMessage(&quot;&quot;&quot;\n            You are a historian who is collecting information about \n            a person whose name is {{it}}.\n            &quot;&quot;&quot;)\n    Person chat(String name);\n}\n</code></pre>\n<pre><code>Historian historian = AiServices.builder(Historian.class)\n                .chatModel(model)\n                .build();\n</code></pre>\n<p>A record Person:</p>\n<pre><code>public record Person(String nom,\n                     LocalDate dateOfbirth,\n                     LocalDate dateOfDeath,\n                     @Description(&quot;Main fact about this person&quot;)\n                     String mainFact) {\n}\n</code></pre>\n<p>This code works:</p>\n<pre><code>Person person = historian.chat(&quot;Napol√©on&quot;);\nSystem.out.println(person.dateOfBirth());\nSystem.out.println(person.mainFact());\n</code></pre>\n<p>But, I would like to get the metadata of the request, for example the token usages.\nHow can I do it?</p>\n",
    "tags" : [ "java", "google-gemini", "langchain4j" ],
    "owner" : {
      "account_id" : 1806309,
      "reputation" : 2977,
      "user_id" : 1643352,
      "user_type" : "registered",
      "accept_rate" : 73,
      "profile_image" : "https://www.gravatar.com/avatar/e26f6daa771542c6ad2acbd7a55b93c5?s=256&d=identicon&r=PG",
      "display_name" : "user1643352",
      "link" : "https://stackoverflow.com/users/1643352/user1643352"
    },
    "is_answered" : false,
    "view_count" : 133,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1757195466,
    "creation_date" : 1757176184,
    "link" : "https://stackoverflow.com/questions/79757676/with-gemini-and-langchain4j-how-to-use-structured-output-while-retrieving-metad",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79757815,
    "question_id" : 79757676,
    "body" : "<p>Use <code>Result&lt;Person&gt;</code> as the return type instead of <code>Person</code></p>\n<p><a href=\"https://docs.langchain4j.dev/tutorials/ai-services#return-types\" rel=\"nofollow noreferrer\">https://docs.langchain4j.dev/tutorials/ai-services#return-types</a></p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 3136463,
      "reputation" : 2579,
      "user_id" : 2652883,
      "user_type" : "registered",
      "accept_rate" : 89,
      "profile_image" : "https://i.sstatic.net/YqB3g.jpg?s=256",
      "display_name" : "Muli Yulzary",
      "link" : "https://stackoverflow.com/users/2652883/muli-yulzary"
    },
    "creation_date" : 1757195466,
    "last_activity_date" : 1757195466,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : { }
}