{
  "question" : {
    "question_id" : 79689096,
    "title" : "hibernate.default_schema not resloved anymore when used in single quotes",
    "body" : "<p>I'm upgrading from spring boot org.springframework.boot:3.3.1 to 3.5.3.\nThis includes a hibernate upgrade from 6.5.2 to to 7.0.3.</p>\n<p>With the old versions everything worked fine, but since the upgrade it looks like the <strong>{h-schema} is not resolved properly anymore, when there are single quotes within the string.</strong></p>\n<p>For example, this code gives me the error <code>ERROR: relation &quot;{h-schema}workflow_id&quot; does not exist</code>:</p>\n<pre><code>public Long getNextSeriesId() {\n        return Long.parseLong(String\n                .valueOf(\n                        entityManager.createNativeQuery(&quot;SELECT nextval('{h-schema}workflow_id')&quot;).getSingleResult()));\n    }\n</code></pre>\n<p>On the other hand, this code works just fine (most likely because it has no single quotes).</p>\n<pre><code>public Long getCurrentDaySeriesId() {\n        return Long.parseLong(String\n                .valueOf(\n                        entityManager.createNativeQuery(&quot;SELECT last_value FROM {h-schema}workflow_day_id&quot;).getSingleResult()));\n    }\n</code></pre>\n<p>To me, this looks like a bug in hibernate. I cannot wait for a fix. Is any other way to get around this? Am I missing another property that defines e.g. a quotation strategy?</p>\n<p>For completeness: this allows using the h-schema</p>\n<pre><code>spring:\n  jpa:\n    properties:\n      hibernate:\n        default_schema: foo\n</code></pre>\n",
    "tags" : [ "java", "spring", "hibernate" ],
    "owner" : {
      "account_id" : 5935285,
      "reputation" : 1421,
      "user_id" : 4668505,
      "user_type" : "registered",
      "accept_rate" : 100,
      "profile_image" : "https://graph.facebook.com/870086803059030/picture?type=large",
      "display_name" : "Tim Malich",
      "link" : "https://stackoverflow.com/users/4668505/tim-malich"
    },
    "is_answered" : true,
    "view_count" : 73,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1751565646,
    "creation_date" : 1751555839,
    "link" : "https://stackoverflow.com/questions/79689096/hibernate-default-schema-not-resloved-anymore-when-used-in-single-quotes",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79689123,
    "question_id" : 79689096,
    "body" : "<p>Found a workaround that supports the assumption from the question.<br />\nLuckily postgres allows to use $$ instead of ' to define strings.</p>\n<pre><code>public Long getNextSeriesId() {\n    return Long.parseLong(String\n            .valueOf(\n                    entityManager.createNativeQuery(&quot;SELECT nextval($${h-schema}workflow_id$$)&quot;).getSingleResult()));\n}\n</code></pre>\n",
    "score" : 1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 5935285,
      "reputation" : 1421,
      "user_id" : 4668505,
      "user_type" : "registered",
      "accept_rate" : 100,
      "profile_image" : "https://graph.facebook.com/870086803059030/picture?type=large",
      "display_name" : "Tim Malich",
      "link" : "https://stackoverflow.com/users/4668505/tim-malich"
    },
    "creation_date" : 1751557530,
    "last_activity_date" : 1751565576,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : { }
}