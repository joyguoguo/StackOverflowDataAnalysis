{
  "question" : {
    "question_id" : 79568777,
    "title" : "IllegalAccessError: KaptJavaCompiler cannot access JavaCompiler - Kotlin KAPT module access issue with JDK compiler",
    "body" : "<p>I'm trying to run my Android Jetpack Compose application on an Android TV emulator, but I'm encountering the following error during compilation:</p>\n<p>java.lang.IllegalAccessError: superclass access check failed:\nclass org.jetbrains.kotlin.kapt3.base.javac.KaptJavaCompiler\n(in unnamed module @0x1df5056) cannot access class com.sun.tools.javac.main.JavaCompiler\n(in module jdk.compiler)\nbecause module jdk.compiler does not export com.sun.tools.javac.main\nto unnamed module @0x1df5056</p>\n<p>Java version:</p>\n<pre><code>openjdk version &quot;17.0.14&quot; 2025-01-21\n</code></pre>\n<p>Kotlin version:</p>\n<pre><code>kotlinc-jvm 2.1.20 (JRE 17.0.14+0)\n</code></pre>\n<p>Android Studio version:</p>\n<pre><code>Android Studio Meerkat | 2024.3.1 Patch 1\n</code></pre>\n<p>Gradle version:</p>\n<pre><code>gradle-8.2\n</code></pre>\n<p><strong>Full error stack trace:</strong></p>\n<pre><code>java.lang.IllegalAccessError: superclass access check failed: class org.jetbrains.kotlin.kapt3.base.javac.KaptJavaCompiler (in unnamed module @0x1df5056) cannot access class com.sun.tools.javac.main.JavaCompiler (in module jdk.compiler) because module jdk.compiler does not export com.sun.tools.javac.main to unnamed module @0x1df5056\n    at java.base/java.lang.ClassLoader.defineClass1(Native Method)\n    at java.base/java.lang.ClassLoader.defineClass(Unknown Source)\n    at java.base/java.security.SecureClassLoader.defineClass(Unknown Source)\n    at java.base/java.net.URLClassLoader.defineClass(Unknown Source)\n    at java.base/java.net.URLClassLoader$1.run(Unknown Source)\n    at java.base/java.net.URLClassLoader$1.run(Unknown Source)\n    at java.base/java.security.AccessController.doPrivileged(Unknown Source)\n    at java.base/java.net.URLClassLoader.findClass(Unknown Source)\n    at java.base/java.lang.ClassLoader.loadClass(Unknown Source)\n    at java.base/java.lang.ClassLoader.loadClass(Unknown Source)\n    at org.jetbrains.kotlin.kapt3.base.KaptContext.&lt;init&gt;(KaptContext.kt:55)\n    at org.jetbrains.kotlin.kapt3.KaptContextForStubGeneration.&lt;init&gt;(KaptContextForStubGeneration.kt:38)\n    at org.jetbrains.kotlin.kapt3.AbstractKapt3Extension.contextForStubGeneration(Kapt3Extension.kt:295)\n    at org.jetbrains.kotlin.kapt3.AbstractKapt3Extension.analysisCompleted(Kapt3Extension.kt:174)\n    at org.jetbrains.kotlin.kapt3.ClasspathBasedKapt3Extension.analysisCompleted(Kapt3Extension.kt:104)\n    at org.jetbrains.kotlin.cli.jvm.compiler.TopDownAnalyzerFacadeForJVM$analyzeFilesWithJavaIntegration$2.invoke(TopDownAnalyzerFacadeForJVM.kt:104)\n    at org.jetbrains.kotlin.cli.jvm.compiler.TopDownAnalyzerFacadeForJVM.analyzeFilesWithJavaIntegration(TopDownAnalyzerFacadeForJVM.kt:114)\n    at org.jetbrains.kotlin.cli.jvm.compiler.TopDownAnalyzerFacadeForJVM.analyzeFilesWithJavaIntegration$default(TopDownAnalyzerFacadeForJVM.kt:88)\n    at org.jetbrains.kotlin.cli.jvm.compiler.KotlinToJVMBytecodeCompiler$analyze$1.invoke(KotlinToJVMBytecodeCompiler.kt:256)\n    at org.jetbrains.kotlin.cli.jvm.compiler.KotlinToJVMBytecodeCompiler$analyze$1.invoke(KotlinToJVMBytecodeCompiler.kt:42)\n    at org.jetbrains.kotlin.cli.common.messages.AnalyzerWithCompilerReport.analyzeAndReport(AnalyzerWithCompilerReport.kt:115)\n    at org.jetbrains.kotlin.cli.jvm.compiler.KotlinToJVMBytecodeCompiler.analyze(KotlinToJVMBytecodeCompiler.kt:247)\n    at org.jetbrains.kotlin.cli.jvm.compiler.KotlinToJVMBytecodeCompiler.compileModules$cli(KotlinToJVMBytecodeCompiler.kt:87)\n    at org.jetbrains.kotlin.cli.jvm.compiler.KotlinToJVMBytecodeCompiler.compileModules$cli$default(KotlinToJVMBytecodeCompiler.kt:47)\n    at org.jetbrains.kotlin.cli.jvm.K2JVMCompiler.doExecute(K2JVMCompiler.kt:168)\n    at org.jetbrains.kotlin.cli.jvm.K2JVMCompiler.doExecute(K2JVMCompiler.kt:53)\n    at org.jetbrains.kotlin.cli.common.CLICompiler.execImpl(CLICompiler.kt:100)\n    at org.jetbrains.kotlin.cli.common.CLICompiler.execImpl(CLICompiler.kt:46)\n    at org.jetbrains.kotlin.cli.common.CLITool.exec(CLITool.kt:101)\n    at org.jetbrains.kotlin.incremental.IncrementalJvmCompilerRunner.runCompiler(IncrementalJvmCompilerRunner.kt:460)\n    at org.jetbrains.kotlin.incremental.IncrementalJvmCompilerRunner.runCompiler(IncrementalJvmCompilerRunner.kt:62)\n    at org.jetbrains.kotlin.incremental.IncrementalCompilerRunner.doCompile(IncrementalCompilerRunner.kt:476)\n    at org.jetbrains.kotlin.incremental.IncrementalCompilerRunner.compileImpl(IncrementalCompilerRunner.kt:399)\n    at org.jetbrains.kotlin.incremental.IncrementalCompilerRunner.compileNonIncrementally(IncrementalCompilerRunner.kt:280)\n    at org.jetbrains.kotlin.incremental.IncrementalCompilerRunner.compile(IncrementalCompilerRunner.kt:124)\n    at org.jetbrains.kotlin.daemon.CompileServiceImplBase.execIncrementalCompiler(CompileServiceImpl.kt:636)\n    at org.jetbrains.kotlin.daemon.CompileServiceImplBase.access$execIncrementalCompiler(CompileServiceImpl.kt:101)\n    at org.jetbrains.kotlin.daemon.CompileServiceImpl.compile(CompileServiceImpl.kt:1598)\n    at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(Unknown Source)\n    at java.base/java.lang.reflect.Method.invoke(Unknown Source)\n    at java.rmi/sun.rmi.server.UnicastServerRef.dispatch(Unknown Source)\n    at java.rmi/sun.rmi.transport.Transport$1.run(Unknown Source)\n    at java.rmi/sun.rmi.transport.Transport$1.run(Unknown Source)\n    at java.base/java.security.AccessController.doPrivileged(Unknown Source)\n    at java.rmi/sun.rmi.transport.Transport.serviceCall(Unknown Source)\n    at java.rmi/sun.rmi.transport.tcp.TCPTransport.handleMessages(Unknown Source)\n    at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(Unknown Source)\n    at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(Unknown Source)\n    at java.base/java.security.AccessController.doPrivileged(Unknown Source)\n    at java.rmi/sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(Unknown Source)\n    at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)\n    at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\n    at java.base/java.lang.Thread.run(Unknown Source)\n</code></pre>\n",
    "tags" : [ "java", "android", "kotlin" ],
    "owner" : {
      "account_id" : 29592908,
      "reputation" : 1,
      "user_id" : 22680047,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/9afce22d9907b1c1e77e3878e6fc565f?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Fazliddin",
      "link" : "https://stackoverflow.com/users/22680047/fazliddin"
    },
    "is_answered" : false,
    "view_count" : 229,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1744372175,
    "creation_date" : 1744372051,
    "link" : "https://stackoverflow.com/questions/79568777/illegalaccesserror-kaptjavacompiler-cannot-access-javacompiler-kotlin-kapt-mo",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140325034,
    "post_id" : 79568777,
    "body" : "try adding the following  in build.gradle.kts:  kapt {     javacOptions {         option(&quot;-J--add-exports=jdk.compiler/com.sun.tools.javac.mai&zwnj;&#8203;n=ALL-UNNAMED&quot;)     } }",
    "score" : 0,
    "owner" : {
      "account_id" : 7645025,
      "reputation" : 440,
      "user_id" : 5795975,
      "user_type" : "registered",
      "profile_image" : "https://lh6.googleusercontent.com/-6KwPUS4RnyA/AAAAAAAAAAI/AAAAAAAAC8w/auZqreI45x0/s256-rj/photo.jpg",
      "display_name" : "Vijay",
      "link" : "https://stackoverflow.com/users/5795975/vijay"
    },
    "creation_date" : 1744384302,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140324605,
    "post_id" : 79568777,
    "body" : "Please clarify your specific problem or provide additional details to highlight exactly what you need. As it&#39;s currently written, it&#39;s hard to tell exactly what you&#39;re asking.",
    "score" : 0,
    "owner" : {
      "account_id" : -1,
      "reputation" : 1,
      "user_id" : -1,
      "user_type" : "moderator",
      "profile_image" : "https://www.gravatar.com/avatar/a007be5a61f6aa8f3e85ae2fc18dd66e?s=256&d=identicon&r=PG",
      "display_name" : "Community",
      "link" : "https://stackoverflow.com/users/-1/community"
    },
    "creation_date" : 1744377559,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}