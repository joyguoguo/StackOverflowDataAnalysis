{
  "question" : {
    "question_id" : 79554582,
    "title" : "Grammar and spelling mistake corrector in Java using NLP",
    "body" : "<p>I am trying to create a Java project to correct grammar and spelling mistakes. For this, I am using the org.languagetool API, but it is not correcting the mistakes accurately.\n<br>\nMy <em>pom.xml</em> dependency</p>\n<pre><code>&lt;dependency&gt;\n  &lt;groupId&gt;org.languagetool&lt;/groupId&gt;\n  &lt;artifactId&gt;language-en&lt;/artifactId&gt;\n  &lt;version&gt;6.4&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n<br>\nMy Java code logic\n<pre><code>private static String correctGrammar(String text) throws Exception {\n    JLanguageTool langTool = new JLanguageTool(new AmericanEnglish());\n\n    // Check for matches\n    List&lt;RuleMatch&gt; matches = langTool.check(text);\n    StringBuilder correctedText = new StringBuilder(text);\n\n    // Apply corrections\n    for (RuleMatch match : matches) {\n        // Get the suggested replacement\n        List&lt;String&gt; replacements = match.getSuggestedReplacements();\n        String replacement = replacements.isEmpty() ? &quot;&quot; : replacements.get(0);\n        int start = match.getFromPos();\n        int end = match.getToPos();\n\n        // Replace the incorrect text with the suggested correction\n        correctedText.replace(start, end, replacement);\n    }\n\n    return correctedText.toString();\n}\n</code></pre>\n<br>\n<p>My Input text</p>\n<pre><code>&quot;Your input text here with grammaser mistakes and mispelled words.&quot;\n</code></pre>\n<br>\nMy wrong Output text\n<pre><code>Corrected Text: Your input text here with gram maser mistakes andmisspelledd words.\n</code></pre>\n",
    "tags" : [ "java", "stanford-nlp", "languagetool" ],
    "owner" : {
      "account_id" : 19870923,
      "reputation" : 3,
      "user_id" : 14557074,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/bd975246bee3a401e94743c18b6c7a48?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Karan_raj",
      "link" : "https://stackoverflow.com/users/14557074/karan-raj"
    },
    "is_answered" : false,
    "view_count" : 64,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1745401134,
    "creation_date" : 1743747509,
    "link" : "https://stackoverflow.com/questions/79554582/grammar-and-spelling-mistake-corrector-in-java-using-nlp",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79588284,
    "question_id" : 79554582,
    "body" : "<p>I think the issue in your code is that you're applying corrections in order <strong>from the beginning to the end</strong> of the text. So when you modify the string, it changes the positions of the subsequent characters, which causes later replacements to be applied at incorrect positions.</p>\n<p>To solve this you can apply the corrections <strong>in reverse order</strong>, starting from the end of the text. That way, earlier replacements donâ€™t affect the positions of later ones. For example you can modify your function like this:</p>\n<pre><code>private static String correctGrammar(String text) throws Exception {\n    JLanguageTool langTool = new JLanguageTool(new AmericanEnglish());\n\n    List&lt;RuleMatch&gt; matches = langTool.check(text);\n    StringBuilder correctedText = new StringBuilder(text);\n\n    // sorting matches in reverse order \n    matches.sort((a, b) -&gt; Integer.compare(b.getFromPos(), a.getFromPos()));\n\n    for (RuleMatch match : matches) {\n        List&lt;String&gt; replacements = match.getSuggestedReplacements();\n        if (!replacements.isEmpty()) {\n            String replacement = replacements.get(0);\n            int start = match.getFromPos();\n            int end = match.getToPos();\n\n            correctedText.replace(start, end, replacement);\n        }\n    }\n\n    return correctedText.toString();\n}\n</code></pre>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 28879803,
      "reputation" : 189,
      "user_id" : 22119508,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/rYfct.jpg?s=256",
      "display_name" : "Camilla Giuliani",
      "link" : "https://stackoverflow.com/users/22119508/camilla-giuliani"
    },
    "creation_date" : 1745401134,
    "last_activity_date" : 1745401134,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140298475,
    "post_id" : 79554582,
    "body" : "I am getting these errors @tevemadar, <code>Exception in thread &quot;main&quot; java.lang.RuntimeException: Could not activate rules</code> - <code>Caused by: java.io.IOException: Cannot load or parse input stream of &#39;&#47;org&#47;languagetool&#47;rules&#47;en&#47;grammar.xml&#39;</code> - <code>Caused by: org.xml.sax.SAXNotRecognizedException: Property &#39;jdk.xml.maxGeneralEntitySizeLimit&#39; is not recognized.</code>",
    "score" : 0,
    "owner" : {
      "account_id" : 19870923,
      "reputation" : 3,
      "user_id" : 14557074,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/bd975246bee3a401e94743c18b6c7a48?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Karan_raj",
      "link" : "https://stackoverflow.com/users/14557074/karan-raj"
    },
    "creation_date" : 1743757036,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140298410,
    "post_id" : 79554582,
    "body" : "Let me try with the sample code of languageTool documentation",
    "score" : 0,
    "owner" : {
      "account_id" : 19870923,
      "reputation" : 3,
      "user_id" : 14557074,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/bd975246bee3a401e94743c18b6c7a48?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Karan_raj",
      "link" : "https://stackoverflow.com/users/14557074/karan-raj"
    },
    "creation_date" : 1743756313,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140298300,
    "post_id" : 79554582,
    "body" : "Have you tried their own example code? <a href=\"https://dev.languagetool.org/java-api\" rel=\"nofollow noreferrer\">dev.languagetool.org/java-api</a>",
    "score" : 0,
    "owner" : {
      "account_id" : 10759610,
      "reputation" : 13342,
      "user_id" : 7916438,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/8541ff62182bcfd172e116a4e0d2fa58?s=256&d=identicon&r=PG",
      "display_name" : "tevemadar",
      "link" : "https://stackoverflow.com/users/7916438/tevemadar"
    },
    "creation_date" : 1743754800,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140298136,
    "post_id" : 79554582,
    "body" : "I have updated the code @tevemadar but my spelling mistake didn&#39;t corrected - my o/p - <code>Corrected Text: Your input text here with gram maser mistakes and misspelled words.</code>",
    "score" : 0,
    "owner" : {
      "account_id" : 19870923,
      "reputation" : 3,
      "user_id" : 14557074,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/bd975246bee3a401e94743c18b6c7a48?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Karan_raj",
      "link" : "https://stackoverflow.com/users/14557074/karan-raj"
    },
    "creation_date" : 1743752057,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140298126,
    "post_id" : 79554582,
    "body" : "@tevemadar, I am using JDK 17 so I am going to try with <code>Collections.reverse(matches);</code> logic",
    "score" : 0,
    "owner" : {
      "account_id" : 19870923,
      "reputation" : 3,
      "user_id" : 14557074,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/bd975246bee3a401e94743c18b6c7a48?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Karan_raj",
      "link" : "https://stackoverflow.com/users/14557074/karan-raj"
    },
    "creation_date" : 1743751964,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140298050,
    "post_id" : 79554582,
    "body" : "Positions in the string change as you issue the <code>replace()</code> calls. A simple thing you can try is reversing the list (<code>langTool.check(text).reversed()</code> - the <code>reversed()</code> call is available since Java 21 only, if you&#39;re on older Java, put <code>Collections.reverse(matches);</code> into the next line).",
    "score" : 0,
    "owner" : {
      "account_id" : 10759610,
      "reputation" : 13342,
      "user_id" : 7916438,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/8541ff62182bcfd172e116a4e0d2fa58?s=256&d=identicon&r=PG",
      "display_name" : "tevemadar",
      "link" : "https://stackoverflow.com/users/7916438/tevemadar"
    },
    "creation_date" : 1743750766,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}