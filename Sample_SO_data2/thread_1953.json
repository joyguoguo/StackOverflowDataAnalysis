{
  "question" : {
    "question_id" : 79664081,
    "title" : "Spring Boot best way to manually handle UnsatisfiedDependencyException",
    "body" : "<p>I have a Spring Boot app which has an Enum as Configuration value</p>\n<p>This is my config class</p>\n<pre><code>@Configuration\npublic class MyConfig {\n  @Value(&quot;${app.roundingMode}&quot;)\n  private java.math.RoundingMode roundingMode;\n}\n</code></pre>\n<p>This is the application.property file</p>\n<pre><code>app.roundingMode=FLOOR\n</code></pre>\n<p>Spring Boot does the String to RoundingMode enum automatically. However, in case the provided value doesn't exist in enum or we simply did no provide this value. Spring simply throw enum conversion IllegalArgumentException.</p>\n<p>I would like to default this value to HALF_UP in case of exception. What would be the best way to handle this exception?</p>\n<p>My current solution is to take <code>roundingMode</code> as String and do the conversion manually and catch the exception. Then return RoundingMode as a bean. I am wondering if there's a better solution.</p>\n<pre><code>@Value(&quot;${app.roundingMode}&quot;)\nString rmString;\n\n@Bean\npublic RoundingMode getRoundingMode(){\n  java.math.RoundingMode rm = RoundingMode.HALF_UP\n  try {\n    rm = RoundingMode.valueOf(rmString);\n  } catch (IllegalArgumentException e) {\n    log.warn(&quot;invalid rounding mode, default to HALF UP&quot;);\n  }\n  return rm; \n}\n</code></pre>\n",
    "tags" : [ "java", "spring", "spring-boot" ],
    "owner" : {
      "account_id" : 7238205,
      "reputation" : 156,
      "user_id" : 5522629,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/296b7fd08324211d564cf43a83844b1a?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "stackyi",
      "link" : "https://stackoverflow.com/users/5522629/stackyi"
    },
    "is_answered" : true,
    "view_count" : 144,
    "answer_count" : 3,
    "score" : 2,
    "last_activity_date" : 1749807148,
    "creation_date" : 1749760154,
    "link" : "https://stackoverflow.com/questions/79664081/spring-boot-best-way-to-manually-handle-unsatisfieddependencyexception",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79664338,
    "question_id" : 79664081,
    "body" : "<p>Since Spring already handles the conversion from String --&gt; Enum, you can use the default value for Spring placeholder to provide &quot;HALF_UP&quot; if the app.roundingMode property is not provided. Then Spring will convert it to the Enum for you.</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Value(&quot;${app.roundingMode:HALF_UP}&quot;)\nprivate java.math.RoundingMode roundingMode;\n</code></pre>\n<p>alternatively:</p>\n<pre><code>    @Bean\n    public RoundingMode getRoundingMode(@Value(&quot;${app.roundingMode:HALF_UP}&quot;) java.math.RoundingMode roundingMode) {\n        log.info(&quot;Rounding mode initialized to {}&quot;, roundingMode.name());\n        return roundingMode;\n    }\n</code></pre>\n<p>Note: if you do this, the property in application.property cannot be empty. It seems that it assumes the property is present but is an empty string(?), so it resolves to null. I believe there could be other syntax for defining to use the default value if the property is missing or empty, so I'll take a look and edit again later</p>\n<pre class=\"lang-java prettyprint-override\"><code>#don't do this when using the above\n#if using the below, you can do this\napp.roundingMode=\n</code></pre>\n<p>edit:</p>\n<p>It seems the Spring placeholder also provides an elvis operator. So I would say this is the best option out of the three shown here.</p>\n<pre><code>    @Bean\n    public RoundingMode getRoundingMode(@Value(&quot;${app.roundingMode?:HALF_UP}&quot;) java.math.RoundingMode roundingMode) {\n        log.info(roundingMode.name());\n        return roundingMode;\n    }\n</code></pre>\n<p>You can use SpEL to check that the Spring placeholder resolves to null, and if it does, use the default value, else use the provided property. Its a bit of a handful to read and maintain though.</p>\n<pre><code>@Bean\n    public RoundingMode getRoundingMode(@Value(&quot;#{'${app.roundingMode}' == '' ? 'HALF_UP' : '${app.roundingMode}'}&quot;) java.math.RoundingMode roundingMode) {\n        log.info(roundingMode.name());\n        return roundingMode;\n    }\n</code></pre>\n",
    "score" : 4,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 21724606,
      "reputation" : 1441,
      "user_id" : 16034206,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/MRBdT.jpg?s=256",
      "display_name" : "pebble unit",
      "link" : "https://stackoverflow.com/users/16034206/pebble-unit"
    },
    "creation_date" : 1749787457,
    "last_activity_date" : 1749793801,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79664635,
    "question_id" : 79664081,
    "body" : "<p>Perhaps you could try the following approach with these optimizations:</p>\n<ul>\n<li><p>No Exception Handling: Replaces try-catch with Stream API for cleaner code</p>\n</li>\n<li><p>Case-Insensitive Matching: Uses equalsIgnoreCase() to accept any letter case</p>\n</li>\n<li><p>Automatic Trim Handling: Processes leading/trailing spaces in input values</p>\n</li>\n</ul>\n<pre class=\"lang-java prettyprint-override\"><code>    @Bean\n    public RoundingMode roundingMode(@Value(&quot;${app.roundingMode:HALF_UP}&quot;) String value) {\n        return Arrays.stream(RoundingMode.values())\n                .filter(e -&gt; e.name().equalsIgnoreCase(value.trim()))\n                .findFirst()\n                .orElse(RoundingMode.HALF_UP);\n    }\n</code></pre>\n",
    "score" : 1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 40671356,
      "reputation" : 36,
      "user_id" : 29894882,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/025595e9d60c7e61edad42bc030ee4e7?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "natsumm",
      "link" : "https://stackoverflow.com/users/29894882/natsumm"
    },
    "creation_date" : 1749807148,
    "last_activity_date" : 1749807148,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79664117,
    "question_id" : 79664081,
    "body" : "<p>While I do not understand a lot about what you are trying to do, this line seems fishy</p>\n<pre><code>rm = RoundingMode.valueOf(rmString);\n</code></pre>\n<p>Seems like you are trying to assign a <code>String</code> to <code>java.math</code> Object...</p>\n<p>If you want to assign a value to a from the config file, you should</p>\n<ol>\n<li>Not convert it into a String</li>\n<li>Use the <code>.ordinal()</code></li>\n</ol>\n<p>So something on the lines of...</p>\n<pre><code>rm = RoundingMode.valueOf(appConfig.getRmString().ordinal());\n</code></pre>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 2869735,
      "reputation" : 499,
      "user_id" : 2463341,
      "user_type" : "registered",
      "accept_rate" : 44,
      "profile_image" : "https://i.sstatic.net/QOQi5.png?s=256",
      "display_name" : "Vinnie",
      "link" : "https://stackoverflow.com/users/2463341/vinnie"
    },
    "creation_date" : 1749763127,
    "last_activity_date" : 1749763127,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : {
    "79664117" : [ {
      "comment_id" : 140509846,
      "post_id" : 79664117,
      "body" : "This block of code is the working solution. java.math.RoundingMode is an enum and I am converting from String to Enum by using <code>valueOf</code>. However, I find my solution rather awkward as Spring Boot can already do String-&gt;Enum conversion. I just need to override how to handler error.",
      "score" : 1,
      "owner" : {
        "account_id" : 7238205,
        "reputation" : 156,
        "user_id" : 5522629,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/296b7fd08324211d564cf43a83844b1a?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "stackyi",
        "link" : "https://stackoverflow.com/users/5522629/stackyi"
      },
      "creation_date" : 1749764522,
      "content_license" : "CC BY-SA 4.0"
    } ],
    "79664338" : [ {
      "comment_id" : 140515798,
      "post_id" : 79664338,
      "body" : "Though, using the option shown by @natsumm seems to fit your use case, even for invalid inputs. I recommend trying that",
      "score" : 1,
      "owner" : {
        "account_id" : 21724606,
        "reputation" : 1441,
        "user_id" : 16034206,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/MRBdT.jpg?s=256",
        "display_name" : "pebble unit",
        "link" : "https://stackoverflow.com/users/16034206/pebble-unit"
      },
      "creation_date" : 1750034109,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140515792,
      "post_id" : 79664338,
      "body" : "I m inheriting the spring boot parent version 3.3.3",
      "score" : 1,
      "owner" : {
        "account_id" : 21724606,
        "reputation" : 1441,
        "user_id" : 16034206,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/MRBdT.jpg?s=256",
        "display_name" : "pebble unit",
        "link" : "https://stackoverflow.com/users/16034206/pebble-unit"
      },
      "creation_date" : 1750033413,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140515790,
      "post_id" : 79664338,
      "body" : "I don&#39;t think so. If you are going to rely on Spring to convert the value for you, it will expect the property provided to be correct. I think that for the situation you mentioned, where the property given itself could actually be wrong, it would be better for you to use what you currently have.",
      "score" : 1,
      "owner" : {
        "account_id" : 21724606,
        "reputation" : 1441,
        "user_id" : 16034206,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/MRBdT.jpg?s=256",
        "display_name" : "pebble unit",
        "link" : "https://stackoverflow.com/users/16034206/pebble-unit"
      },
      "creation_date" : 1750033355,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140515299,
      "post_id" : 79664338,
      "body" : "For some odd reason, the elvis operator is not working properly so it&#39;s not detecting the property&#39;s name. I am using Spring Boot 3.4.6. Also I am still getting IllegalArgumentException from Spring if the provided value in property is not a valid enum. Is there any ways to circumvent this exception and default it to HALF_UP for example?",
      "score" : 0,
      "owner" : {
        "account_id" : 7238205,
        "reputation" : 156,
        "user_id" : 5522629,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/296b7fd08324211d564cf43a83844b1a?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "stackyi",
        "link" : "https://stackoverflow.com/users/5522629/stackyi"
      },
      "creation_date" : 1750009259,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}