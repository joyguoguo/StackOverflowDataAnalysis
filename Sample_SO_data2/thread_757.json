{
  "question" : {
    "question_id" : 79769397,
    "title" : "Android POI - Excel - add category (String value) in y axis",
    "body" : "<pre><code>chart.ctChart.plotArea.scatterChartList.lastOrNull()?.let { sc -&gt;\n        // markers only\n        val st = sc.scatterStyle ?: sc.addNewScatterStyle()\n        st.`val` = STScatterStyle.MARKER\n\n        sc.serList.forEachIndexed { i, ser -&gt;\n            // κρύψε γραμμή\n            val sp = if (ser.isSetSpPr) ser.spPr else ser.addNewSpPr()\n            val ln = if (sp.isSetLn) sp.ln else sp.addNewLn()\n            if (!ln.isSetNoFill) ln.addNewNoFill()\n\n            // ΣΚΛΗΡΟ reset dLbls\n            if (ser.isSetDLbls) ser.unsetDLbls()\n            val dLbls = ser.addNewDLbls()\n\n            // ΜΟΝΟ ένα point label στο idx=0, με ρητό κείμενο από helper κελί\n            val dl = dLbls.addNewDLbl()\n            dl.addNewIdx().`val` = 0L\n\n            val ref = CellReference(drawSheet.sheetName, legendRow0 + i, legendCol, true, true)\n            dl.addNewTx().addNewStrRef().f = ref.formatAsString()\n\n            // όλα τα flags OFF\n            dl.addNewShowSerName().`val` = false\n            dl.addNewShowVal().`val` = false\n            dl.addNewShowCatName().`val` = false\n            dl.addNewShowLegendKey().`val` = false\n            dl.addNewShowPercent().`val` = false\n            dl.addNewShowBubbleSize().`val` = false\n\n            // θέση μόνο για αυτό το point\n            dl.addNewDLblPos().`val` = STDLblPos.L\n        }\n\n        // καθάρισε chart-level dLbls για σιγουριά\n        if (sc.isSetDLbls) sc.unsetDLbls()\n    }\n</code></pre>\n<p>this code adds labels for each point of each series.</p>\n<pre><code>fun eventsTimelineScatter(\n    drawSheet: XSSFSheet,   // ΠΟΥ ζωγραφίζει (π.χ. &quot;Charts&quot;)\n    dataSheet: XSSFSheet,   // ΑΠΟ ΠΟΥ διαβάζει (π.χ. &quot;PlotData&quot;)\n    lastRow: Int,\n    title: String,\n    anchorCols: IntRange,\n    anchorRows: IntRange,\n    xCol: Int,              // στήλη χρόνου (Excel serial, numeric)\n    typeCol: Int            // στήλη κατηγορίας (String)\n) {\n    data class Cat(val key: String, val display: String)\n    fun norm(raw: String?): Cat {\n        val d = (raw ?: &quot;Unknown&quot;).trim().replace(Regex(&quot;\\\\s+&quot;), &quot; &quot;)\n        return Cat(d.lowercase().ifEmpty { &quot;unknown&quot; }, d.ifEmpty { &quot;Unknown&quot; })\n    }\n\n    val byType = mutableMapOf&lt;String, MutableList&lt;Pair&lt;Double,Double&gt;&gt;&gt;()\n    val keyToDisplay = mutableMapOf&lt;String,String&gt;()\n    val laneOf = mutableMapOf&lt;String,Int&gt;()\n    fun lane(k: String) = laneOf.getOrPut(k) { laneOf.size + 1 }.toDouble()\n\n    var xMin = Double.POSITIVE_INFINITY\n    var xMax = Double.NEGATIVE_INFINITY\n    for (r in 1..lastRow) {\n        val row = dataSheet.getRow(r) ?: continue\n        val cat = norm(row.getCell(typeCol)?.toString())\n        val x = row.getCell(xCol)?.numericCellValue ?: continue\n        byType.getOrPut(cat.key) { mutableListOf() }.add(x to lane(cat.key))\n        keyToDisplay.putIfAbsent(cat.key, cat.display)\n        if (x &lt; xMin) xMin = x\n        if (x &gt; xMax) xMax = x\n    }\n    if (byType.isEmpty()) return\n\n    // legend helper cells (τίτλοι σειρών από κελί)\n    val legendCol = (anchorCols.last + 2).coerceAtLeast(24)\n    val legendRow0 = anchorRows.first\n    val keysInOrder = keyToDisplay.keys.sortedBy { keyToDisplay[it]!!.lowercase() }\n    keysInOrder.forEachIndexed { i, k -&gt;\n        val row = drawSheet.getRow(legendRow0 + i) ?: drawSheet.createRow(legendRow0 + i)\n        row.createCell(legendCol).setCellValue(keyToDisplay[k])\n    }\n\n    val drawing = drawSheet.createDrawingPatriarch() as XSSFDrawing\n    val anchor = drawing.createAnchor(0,0,0,0, anchorCols.first, anchorRows.first, anchorCols.last+1, anchorRows.last+1)\n    val chart = drawing.createChart(anchor) as XSSFChart\n\n    val xAxis = chart.createValueAxis(AxisPosition.BOTTOM).apply {\n        crosses = AxisCrosses.MIN\n        majorTickMark = AxisTickMark.OUT\n        minorTickMark = AxisTickMark.NONE\n        tickLabelPosition = AxisTickLabelPosition.LOW\n    }\n    val yAxis = chart.createValueAxis(AxisPosition.LEFT).apply {\n        majorTickMark = AxisTickMark.NONE\n        minorTickMark = AxisTickMark.NONE\n        tickLabelPosition = AxisTickLabelPosition.NONE\n    }\n\n    val data = chart.createData(ChartTypes.SCATTER, xAxis, yAxis) as XDDFScatterChartData\n    data.setVaryColors(false)\n    try { data.style = ScatterStyle.MARKER } catch (_: Throwable) {}\n\n    // σειρές (μία ανά κατηγορία)\n    keysInOrder.forEachIndexed { i, k -&gt;\n        val pts = byType[k]!!.sortedBy { it.first }\n        val xs = XDDFDataSourcesFactory.fromArray(pts.map { it.first }.toTypedArray())\n        val ys = XDDFDataSourcesFactory.fromArray(pts.map { it.second }.toTypedArray())\n        val s = data.addSeries(xs, ys) as XDDFScatterChartData.Series\n        val ref = CellReference(drawSheet.sheetName, legendRow0 + i, legendCol, true, true)\n        s.setTitle(null, ref)\n        s.setMarkerStyle(MarkerStyle.CIRCLE)\n        s.setMarkerSize(7)\n        s.isSmooth = false\n    }\n\n    chart.plot(data)\n    chart.setTitleText(title)\n    chart.setTitleOverlay(false)\n\n    // --- CT tweaks ---\n    // 5) CT: markers only + 1 label (series title) ΜΟΝΟ στο πρώτο point κάθε σειράς\n    // 5) CT: markers only + 1 label (from cell) ΜΟΝΟ στο πρώτο point κάθε σειράς\n    chart.ctChart.plotArea.scatterChartList.lastOrNull()?.let { sc -&gt;\n        // markers only\n        val st = sc.scatterStyle ?: sc.addNewScatterStyle()\n        st.`val` = STScatterStyle.MARKER\n\n        sc.serList.forEachIndexed { i, ser -&gt;\n            // κρύψε γραμμή\n            val sp = if (ser.isSetSpPr) ser.spPr else ser.addNewSpPr()\n            val ln = if (sp.isSetLn) sp.ln else sp.addNewLn()\n            if (!ln.isSetNoFill) ln.addNewNoFill()\n\n            // ΣΚΛΗΡΟ reset dLbls\n            if (ser.isSetDLbls) ser.unsetDLbls()\n            val dLbls = ser.addNewDLbls()\n\n            // ΜΟΝΟ ένα point label στο idx=0, με ρητό κείμενο από helper κελί\n            val dl = dLbls.addNewDLbl()\n            dl.addNewIdx().`val` = 0L\n\n            val ref = CellReference(drawSheet.sheetName, legendRow0 + i, legendCol, true, true)\n            dl.addNewTx().addNewStrRef().f = ref.formatAsString()\n\n            // όλα τα flags OFF\n            dl.addNewShowSerName().`val` = false\n            dl.addNewShowVal().`val` = false\n            dl.addNewShowCatName().`val` = false\n            dl.addNewShowLegendKey().`val` = false\n            dl.addNewShowPercent().`val` = false\n            dl.addNewShowBubbleSize().`val` = false\n\n            // θέση μόνο για αυτό το point\n            dl.addNewDLblPos().`val` = STDLblPos.L\n        }\n\n        // καθάρισε chart-level dLbls για σιγουριά\n        if (sc.isSetDLbls) sc.unsetDLbls()\n    }\n\n    // Legend\n    chart.getOrAddLegend().apply { position = LegendPosition.TOP_RIGHT; isOverlay = false }\n\n    // Gridlines στον Χ\n    chart.ctChart.plotArea.valAxList.forEach { ax -&gt;\n        if (ax.axPos.`val` == STAxPos.B &amp;&amp; !ax.isSetMajorGridlines) ax.addNewMajorGridlines()\n    }\n\n    // X axis: datetime format + λίγα ticks\n    chart.ctChart.plotArea.valAxList.firstOrNull { it.axPos.`val` == STAxPos.B }?.let { xAx -&gt;\n        val nf = if (xAx.isSetNumFmt) xAx.numFmt else xAx.addNewNumFmt()\n        nf.formatCode = &quot;yyyy-mm-dd HH:mm:ss&quot;; nf.sourceLinked = false\n\n        val range = if (xMax.isFinite() &amp;&amp; xMin.isFinite() &amp;&amp; xMax &gt; xMin) xMax - xMin else 1.0\n        val desiredTicks = 6\n        val step = range / (desiredTicks - 1)\n        val sca = if (xAx.scaling!=null) xAx.scaling else xAx.addNewScaling()\n        if (sca.isSetMin) sca.unsetMin()\n        if (sca.isSetMax) sca.unsetMax()\n        sca.addNewMin().setVal(if (xMin.isFinite()) xMin else 0.0)\n        sca.addNewMax().setVal(if (xMax.isFinite()) xMax else 1.0)\n        if (xAx.isSetMajorUnit) xAx.unsetMajorUnit()\n        xAx.addNewMajorUnit().setVal(step)\n    }\n\n    // Y axis: lanes 1..N, χωρίς labels, tick ανά lane\n    val lanes = max(laneOf.size, 1)\n    chart.ctChart.plotArea.valAxList.firstOrNull { it.axPos.`val` == STAxPos.L }?.let { yAx -&gt;\n        (if (yAx.isSetDelete) yAx.delete else yAx.addNewDelete()).setVal(false)\n        val sca = if (yAx.scaling!=null) yAx.scaling else yAx.addNewScaling()\n        if (sca.isSetMin) sca.unsetMin()\n        if (sca.isSetMax) sca.unsetMax()\n        sca.addNewMin().setVal(0.5)\n        sca.addNewMax().setVal(lanes + 0.5)\n        if (yAx.isSetMajorUnit) yAx.unsetMajorUnit()\n        yAx.addNewMajorUnit().setVal(1.0)\n    }\n\n    // (προαιρετικά: “ψημένα” Y labels σε κελιά αριστερά — το έχεις ήδη commented)\n}\n\n</code></pre>\n<p>i want to replace the index y value but this code as i wrote add labels in each point instead for only the first point.</p>\n<p>Any advice?</p>\n<p><img src=\"https://i.sstatic.net/rARp49kZ.png\" alt=\"Chart\" /></p>\n",
    "tags" : [ "java", "android", "excel", "apache-poi" ],
    "owner" : {
      "account_id" : 375717,
      "reputation" : 2437,
      "user_id" : 726730,
      "user_type" : "registered",
      "accept_rate" : 76,
      "profile_image" : "https://www.gravatar.com/avatar/23e64383eeed71951c14be6abcf611a2?s=256&d=identicon&r=PG",
      "display_name" : "Chris P",
      "link" : "https://stackoverflow.com/users/726730/chris-p"
    },
    "is_answered" : false,
    "view_count" : 41,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1758303410,
    "creation_date" : 1758278089,
    "link" : "https://stackoverflow.com/questions/79769397/android-poi-excel-add-category-string-value-in-y-axis",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79769432,
    "question_id" : 79769397,
    "body" : "<pre><code>fun eventsTimelineScatter(\n    drawSheet: XSSFSheet,   // ΠΟΥ ζωγραφίζει (π.χ. &quot;Charts&quot;)\n    dataSheet: XSSFSheet,   // ΑΠΟ ΠΟΥ διαβάζει (π.χ. &quot;PlotData&quot;)\n    lastRow: Int,\n    title: String,\n    anchorCols: IntRange,\n    anchorRows: IntRange,\n    xCol: Int,              // στήλη χρόνου (Excel serial, numeric)\n    typeCol: Int            // στήλη κατηγορίας (String)\n) {\n    data class Cat(val key: String, val display: String)\n    fun norm(raw: String?): Cat {\n        val d = (raw ?: &quot;Unknown&quot;).trim().replace(Regex(&quot;\\\\s+&quot;), &quot; &quot;)\n        return Cat(d.lowercase().ifEmpty { &quot;unknown&quot; }, d.ifEmpty { &quot;Unknown&quot; })\n    }\n\n    val seriesSizes = mutableListOf&lt;Int&gt;()  // &lt;- κρατάμε πόσα points έχει κάθε σειρά\n\n\n    val byType = mutableMapOf&lt;String, MutableList&lt;Pair&lt;Double,Double&gt;&gt;&gt;()\n    val keyToDisplay = mutableMapOf&lt;String,String&gt;()\n    val laneOf = mutableMapOf&lt;String,Int&gt;()\n    fun lane(k: String) = laneOf.getOrPut(k) { laneOf.size + 1 }.toDouble()\n\n    var xMin = Double.POSITIVE_INFINITY\n    var xMax = Double.NEGATIVE_INFINITY\n    for (r in 1..lastRow) {\n        val row = dataSheet.getRow(r) ?: continue\n        val cat = norm(row.getCell(typeCol)?.toString())\n        val x = row.getCell(xCol)?.numericCellValue ?: continue\n        byType.getOrPut(cat.key) { mutableListOf() }.add(x to lane(cat.key))\n        keyToDisplay.putIfAbsent(cat.key, cat.display)\n        if (x &lt; xMin) xMin = x\n        if (x &gt; xMax) xMax = x\n    }\n    if (byType.isEmpty()) return\n\n    // legend helper cells (τίτλοι σειρών από κελί)\n    val legendCol = (anchorCols.last + 2).coerceAtLeast(24)\n    val legendRow0 = anchorRows.first\n    val keysInOrder = keyToDisplay.keys.sortedBy { keyToDisplay[it]!!.lowercase() }\n    keysInOrder.forEachIndexed { i, k -&gt;\n        val row = drawSheet.getRow(legendRow0 + i) ?: drawSheet.createRow(legendRow0 + i)\n        row.createCell(legendCol).setCellValue(keyToDisplay[k])\n    }\n\n    val drawing = drawSheet.createDrawingPatriarch() as XSSFDrawing\n    val anchor = drawing.createAnchor(0,0,0,0, anchorCols.first, anchorRows.first, anchorCols.last+1, anchorRows.last+1)\n    val chart = drawing.createChart(anchor) as XSSFChart\n\n    val xAxis = chart.createValueAxis(AxisPosition.BOTTOM).apply {\n        crosses = AxisCrosses.MIN\n        majorTickMark = AxisTickMark.OUT\n        minorTickMark = AxisTickMark.NONE\n        tickLabelPosition = AxisTickLabelPosition.LOW\n    }\n    val yAxis = chart.createValueAxis(AxisPosition.LEFT).apply {\n        majorTickMark = AxisTickMark.NONE\n        minorTickMark = AxisTickMark.NONE\n        tickLabelPosition = AxisTickLabelPosition.NONE\n    }\n\n    val data = chart.createData(ChartTypes.SCATTER, xAxis, yAxis) as XDDFScatterChartData\n    data.setVaryColors(false)\n    try { data.style = ScatterStyle.MARKER } catch (_: Throwable) {}\n\n    // σειρές (μία ανά κατηγορία)\n    keysInOrder.forEachIndexed { i, k -&gt;\n        val pts = byType[k]!!.sortedBy { it.first }\n        val xs = XDDFDataSourcesFactory.fromArray(pts.map { it.first }.toTypedArray())\n        val ys = XDDFDataSourcesFactory.fromArray(pts.map { it.second }.toTypedArray())\n\n        val s = data.addSeries(xs, ys) as XDDFScatterChartData.Series\n        val ref = CellReference(drawSheet.sheetName, legendRow0 + i, legendCol, true, true)\n        s.setTitle(null, ref)\n        s.setMarkerStyle(MarkerStyle.CIRCLE)\n        s.setMarkerSize(7)\n        s.isSmooth = false\n\n        seriesSizes += pts.size           // &lt;- αποθήκευσε το μέγεθος της σειράς\n    }\n\n    chart.plot(data)\n    chart.setTitleText(title)\n    chart.setTitleOverlay(false)\n\n    // --- CT tweaks ---\n    // 5) CT: markers only + 1 label (series title) ΜΟΝΟ στο πρώτο point κάθε σειράς\n    // 5) CT: markers only + 1 label (from cell) ΜΟΝΟ στο πρώτο point κάθε σειράς\n    chart.ctChart.plotArea.scatterChartList.first()?.let { sc -&gt;\n        sc.serList.forEachIndexed { i, ser -&gt;\n            // κρύψε τη γραμμή\n            val sp = if (ser.isSetSpPr) ser.spPr else ser.addNewSpPr()\n            val ln = if (sp.isSetLn) sp.ln else sp.addNewLn()\n            if (!ln.isSetNoFill) ln.addNewNoFill()\n\n            // καθάρισε πλήρως dLbls\n            if (ser.isSetDLbls) ser.unsetDLbls()\n            val dLbls = ser.addNewDLbls()\n\n            // 1) Σβήσε ρητά ΟΛΑ τα υπόλοιπα points με delete=true\n            val n = seriesSizes.getOrNull(i) ?: 0\n            for (p in 1 until n) {\n                val dlDel = dLbls.addNewDLbl()\n                dlDel.addNewIdx().`val` = p.toLong()\n                dlDel.addNewDelete().`val` = true      // &lt;- force no label για p&gt;0\n            }\n\n            // 2) Label ΜΟΝΟ στο idx=0 με κείμενο από helper κελί (legend)\n            val dl0 = dLbls.addNewDLbl()\n            dl0.addNewIdx().`val` = 0L\n            val ref = CellReference(drawSheet.sheetName, legendRow0 + i, legendCol, true, true)\n            dl0.addNewTx().addNewStrRef().f = ref.formatAsString()\n            dl0.addNewDLblPos().`val` = STDLblPos.L\n\n            // 3) Όλα τα flags OFF (να μην &quot;κληρονομηθούν&quot; default labels)\n            fun off(b: CTBoolean?) { b?.setVal(false) }\n            off(dLbls.showSerName); off(dLbls.showVal); off(dLbls.showCatName)\n            off(dLbls.showLegendKey); off(dLbls.showPercent); off(dLbls.showBubbleSize)\n            if (dLbls.isSetDLblPos) dLbls.unsetDLblPos()\n        }\n        if (sc.isSetDLbls) sc.unsetDLbls() // καμία chart-level ρύθμιση\n    }\n\n\n    // Legend\n    chart.getOrAddLegend().apply { position = LegendPosition.TOP_RIGHT; isOverlay = false }\n\n    // Gridlines στον Χ\n    chart.ctChart.plotArea.valAxList.forEach { ax -&gt;\n        if (ax.axPos.`val` == STAxPos.B &amp;&amp; !ax.isSetMajorGridlines) ax.addNewMajorGridlines()\n    }\n\n    // X axis: datetime format + λίγα ticks\n    chart.ctChart.plotArea.valAxList.firstOrNull { it.axPos.`val` == STAxPos.B }?.let { xAx -&gt;\n        val nf = if (xAx.isSetNumFmt) xAx.numFmt else xAx.addNewNumFmt()\n        nf.formatCode = &quot;yyyy-mm-dd HH:mm:ss&quot;; nf.sourceLinked = false\n\n        val range = if (xMax.isFinite() &amp;&amp; xMin.isFinite() &amp;&amp; xMax &gt; xMin) xMax - xMin else 1.0\n        val desiredTicks = 4\n        val step = range / (desiredTicks - 1)\n        val sca = if (xAx.scaling!=null) xAx.scaling else xAx.addNewScaling()\n        if (sca.isSetMin) sca.unsetMin()\n        if (sca.isSetMax) sca.unsetMax()\n        sca.addNewMin().setVal(if (xMin.isFinite()) xMin else 0.0)\n        sca.addNewMax().setVal(if (xMax.isFinite()) xMax else 1.0)\n        if (xAx.isSetMajorUnit) xAx.unsetMajorUnit()\n        xAx.addNewMajorUnit().setVal(step)\n    }\n\n    // Y axis: lanes 1..N, χωρίς labels, tick ανά lane\n    val lanes = max(laneOf.size, 1)\n    chart.ctChart.plotArea.valAxList.firstOrNull { it.axPos.`val` == STAxPos.L }?.let { yAx -&gt;\n        (if (yAx.isSetDelete) yAx.delete else yAx.addNewDelete()).setVal(false)\n        val sca = if (yAx.scaling!=null) yAx.scaling else yAx.addNewScaling()\n        if (sca.isSetMin) sca.unsetMin()\n        if (sca.isSetMax) sca.unsetMax()\n        sca.addNewMin().setVal(0.5)\n        sca.addNewMax().setVal(lanes + 0.5)\n        if (yAx.isSetMajorUnit) yAx.unsetMajorUnit()\n        yAx.addNewMajorUnit().setVal(1.0)\n    }\n\n    // (προαιρετικά: “ψημένα” Y labels σε κελιά αριστερά — το έχεις ήδη commented)\n}\n</code></pre>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 375717,
      "reputation" : 2437,
      "user_id" : 726730,
      "user_type" : "registered",
      "accept_rate" : 76,
      "profile_image" : "https://www.gravatar.com/avatar/23e64383eeed71951c14be6abcf611a2?s=256&d=identicon&r=PG",
      "display_name" : "Chris P",
      "link" : "https://stackoverflow.com/users/726730/chris-p"
    },
    "creation_date" : 1758279955,
    "last_activity_date" : 1758279955,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : { }
}