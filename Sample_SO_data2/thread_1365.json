{
  "question" : {
    "question_id" : 79718452,
    "title" : "Why does my image not resize after clicking maximize/restore down",
    "body" : "<p>I want to display an IconImage, on a JLabel, on a JPanel, in a JLayeredPane, in a JFrame. I've written a subclass for the JLayeredPane (shown below) in which I add the panel with the label with the image icon to it. I overrode the doLayout function of the JLabel, so the image retains its ration while it is resized.</p>\n<p>The code seems to work fine when I simply drag the sides of the JFrame, but when I click the maximize button in the top right corner of the JFrame, the image does not resize, it is displayed in the top left corner of the frame with the same size as before I clicked maximize. Then when I click it again (now it is the restore button though), the frame gets smaller again, but the image appears to take the size of the maximized frame. When I just drag the side of the frame again it immediately changes the image size to a seemingly correct size. I say seem and seemingly because I believe the image size lags one 'resize event' (not sure if that is the right terminology) behind.</p>\n<p>I've written the following code:</p>\n<pre class=\"lang-java prettyprint-override\"><code>package myPackage;\n\nimport java.awt.Color;\nimport java.awt.Graphics;\nimport java.awt.Graphics2D;\nimport java.awt.Image;\nimport java.awt.RenderingHints;\nimport java.awt.image.BufferedImage;\nimport java.io.File;\nimport java.io.IOException;\n\nimport javax.imageio.ImageIO;\nimport javax.swing.ImageIcon;\nimport javax.swing.JLabel;\nimport javax.swing.JLayeredPane;\nimport javax.swing.JPanel;\nimport javax.swing.SpringLayout;\n\npublic class GamePane extends JLayeredPane{\n    \n    private BufferedImage worldImage = null;\n    private Image scaledWorldImage = null;\n    private ImageIcon worldIcon = new ImageIcon();\n    private final JLabel mapLabel;\n    private final JPanel bgPanel = new JPanel();\n    private final SpringLayout bgPanelLayout = new SpringLayout();\n\n    public GamePane() {\n        this.setBackground(Color.BLUE);\n        this.setOpaque(true);\n        bgPanel.setLayout(bgPanelLayout);\n        bgPanel.setOpaque(true);\n        \n        try {\n            worldImage = ImageIO.read(new File(&quot;src/assets/world_map.png&quot;));\n            //worldIcon = new ImageIcon(worldImage);\n        } catch (IOException e) {\n            e.printStackTrace();\n        }\n        \n        int imHeight = worldImage.getHeight();\n        int imWidth = worldImage.getWidth();\n        double imRatio = (double) imHeight/ (double) imWidth;\n        \n        \n        mapLabel = new JLabel(worldIcon) {\n            private final double ratio = imRatio;\n            \n            @Override\n            public void doLayout() {\n                super.doLayout();\n                if(getWidth() &gt; 0 &amp;&amp; getHeight() &gt; 0) {\n                    double height;\n                    double width;\n                    if(getHeight() &lt; ratio*getWidth()) {\n                        height = (double) getHeight();\n                        width = height/ratio;\n                    } else {\n                        width = (double) getWidth();\n                        height = width*ratio;\n                    }\n                    scaledWorldImage = worldImage.getScaledInstance(\n                            (int) width, \n                            (int) height,\n                            Image.SCALE_DEFAULT);\n                    worldIcon.setImage(scaledWorldImage);   \n                    revalidate();\n                    repaint();\n                }\n            }\n        };\n        \n\n        bgPanel.add(mapLabel);\n        bgPanelLayout.putConstraint(SpringLayout.NORTH, mapLabel, 0, SpringLayout.NORTH, bgPanel);\n        bgPanelLayout.putConstraint(SpringLayout.SOUTH, mapLabel, 0, SpringLayout.SOUTH, bgPanel);  \n        bgPanelLayout.putConstraint(SpringLayout.EAST, mapLabel, 0, SpringLayout.EAST, bgPanel);    \n        bgPanelLayout.putConstraint(SpringLayout.WEST, mapLabel, 0, SpringLayout.WEST, bgPanel);    \n        \n        this.add(bgPanel, JLayeredPane.DEFAULT_LAYER);\n        \n    }\n    \n    @Override\n    public void doLayout() {\n        super.doLayout();\n        bgPanel.setBounds(0, 0, this.getWidth(), this.getHeight());\n    }\n}\n</code></pre>\n<p>I have some basic Java experience, but I know very little about JFrames and the like (but would like to learn, this is a hobby project), so I've used a lot of ChatGPT to come to this code. If I am doing anything really strange here (related or not related to the problem that I described) please let me know.</p>\n",
    "tags" : [ "java", "swing" ],
    "owner" : {
      "account_id" : 43277388,
      "reputation" : 1,
      "user_id" : 31168765,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/76c46082b5b69451a564b01390156184?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "jona vonk",
      "link" : "https://stackoverflow.com/users/31168765/jona-vonk"
    },
    "is_answered" : true,
    "view_count" : 94,
    "answer_count" : 2,
    "score" : 0,
    "last_activity_date" : 1754916346,
    "creation_date" : 1753784403,
    "link" : "https://stackoverflow.com/questions/79718452/why-does-my-image-not-resize-after-clicking-maximize-restore-down",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79732062,
    "question_id" : 79718452,
    "body" : "<p>ChatGPT <a href=\"https://en.wikipedia.org/wiki/Hallucination_(artificial_intelligence)\" rel=\"nofollow noreferrer\">lies.</a>  It’s not alive, it’s not sentient, it’s not even intelligent.  It just pulls things off the Internet and tries to assemble related words into sentences.  It is not smart enough to treat the <a href=\"https://docs.oracle.com/javase/tutorial/uiswing/\" rel=\"nofollow noreferrer\">Swing tutorials</a> as authoritative information.  It is not smart enough to recognize when it makes mistakes, and it doesn’t care when it makes mistakes.</p>\n<p>Do not override the <code>doLayout()</code> method.  If you want to do custom painting, read <a href=\"https://docs.oracle.com/javase/tutorial/uiswing/painting/\" rel=\"nofollow noreferrer\">https://docs.oracle.com/javase/tutorial/uiswing/painting/</a> (not ChatGPT and not YouTube) for an accurate description of how it’s done.  In short:  override <a href=\"https://docs.oracle.com/en/java/javase/24/docs/api/java.desktop/javax/swing/JComponent.html#paintComponent(java.awt.Graphics)\" rel=\"nofollow noreferrer\">paintComponent</a>, not doLayout.</p>\n<p>The simplest custom painting of an image as a background would look like this:</p>\n<pre><code>public class GamePane extends JPanel {\n    /** Version of serialized form. */\n    @Serial\n    private static final long serialVersionUID = 1;\n\n    private final Image worldImage;\n\n    public GamePane() {\n        this.setBackground(Color.BLUE);\n        this.setOpaque(true);\n\n        try {\n            worldImage = ImageIO.read(\n                GamePane.class.getResource(&quot;/assets/world_map.png&quot;));\n        } catch (IOException e) {\n            throw new RuntimeException(&quot;Required image not found.&quot;, e);\n        }\n    }\n\n    @Override\n    protected void paintComponent(Graphics g) {\n        super.paintComponent(g);\n        g.drawImage(worldImage, 0, 0, getWidth(), getHeight(), this);\n    }\n}\n</code></pre>\n<p>You may notice that I am loading your image with <a href=\"https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/lang/Class.html#getResource(java.lang.String)\" rel=\"nofollow noreferrer\">Class.getResource</a>.  The benefit of doing this is that other people who run your application probably will not have your source code and probably will not have your source tree.  Usually a Java program is distributed to others as a .jar file or a jlink’d image.  In both cases, your image will be inside an archive and will not be an actual file.  <code>getResource</code> will work in those circumstances as well as running from your project.</p>\n",
    "score" : 1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 2053598,
      "reputation" : 44991,
      "user_id" : 1831987,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/38b1c37530189ec4471a43a618e33f67?s=256&d=identicon&r=PG",
      "display_name" : "VGR",
      "link" : "https://stackoverflow.com/users/1831987/vgr"
    },
    "creation_date" : 1754916346,
    "last_activity_date" : 1754916346,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79718455,
    "question_id" : 79718452,
    "body" : "<p>You need an event for the maximize:</p>\n<pre><code>frame.addWindowStateListener(new WindowStateListener() {\n   public void windowStateChanged(WindowEvent arg0) {\n      mapLabel.doLayout();\n   }\n});\n</code></pre>\n<p>(untested)</p>\n<p>Of course you will need to use your own <code>JFrame</code> object.</p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 194308,
      "reputation" : 80530,
      "user_id" : 436560,
      "user_type" : "registered",
      "accept_rate" : 87,
      "profile_image" : "https://i.sstatic.net/2GESV.jpg?s=256",
      "display_name" : "Lajos Arpad",
      "link" : "https://stackoverflow.com/users/436560/lajos-arpad"
    },
    "creation_date" : 1753784614,
    "last_activity_date" : 1753784614,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140626669,
    "post_id" : 79718452,
    "body" : "You should not override <code>doLayout()</code>. If you want to paint a scaled image, follow <a href=\"https://docs.oracle.com/javase/tutorial/uiswing/painting/\" rel=\"nofollow noreferrer\">this official tutorial</a> and override the paintComponent method accordingly. Remember to call <code>super.paintComponent</code> first, then use the <a href=\"https://docs.oracle.com/en/java/javase/24/docs/api/java.desktop/java/awt/Graphics.html#drawImage(java.awt.Image,int,int,int,int,java.awt.image.ImageObserver)\" rel=\"nofollow noreferrer\">scaling drawImage method</a> to paint your image. And perhaps most importantly: load your image <b>only once</b> and store it in a private field.",
    "score" : 0,
    "owner" : {
      "account_id" : 2053598,
      "reputation" : 44991,
      "user_id" : 1831987,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/38b1c37530189ec4471a43a618e33f67?s=256&d=identicon&r=PG",
      "display_name" : "VGR",
      "link" : "https://stackoverflow.com/users/1831987/vgr"
    },
    "creation_date" : 1753791131,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140626438,
    "post_id" : 79718452,
    "body" : "Hello and Welcome to StackOverflow! Looking at <code>ImageIO.read(new File(&quot;src&#47;assets&#47;world_map.png&quot;));</code> you may want to review <a href=\"https://stackoverflow.com/a/66577447/23162960\">stackoverflow.com/a/66577447/23162960</a> Treating app resources as files will break when your app is jarred up.",
    "score" : 0,
    "owner" : {
      "account_id" : 30223964,
      "reputation" : 262,
      "user_id" : 23162960,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/2451acfac254a6fc75757ecf89d75f9a?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Jannik S.",
      "link" : "https://stackoverflow.com/users/23162960/jannik-s"
    },
    "creation_date" : 1753785908,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}