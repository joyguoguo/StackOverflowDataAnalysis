{
  "question" : {
    "question_id" : 79598480,
    "title" : "PDImageXObject color accuracy issue",
    "body" : "<p>I'm trying to create a PDF which includes the following logo image using PDFBox's PDImageXObject class</p>\n<p><a href=\"https://i.sstatic.net/Y1gEXux7.jpg\" rel=\"nofollow noreferrer\">Original Logo</a></p>\n<p>However when I've used PDImageXObject to load the image onto the pdf, I've noticed that the color, the red color looks much brighter than the original image</p>\n<p><a href=\"https://i.sstatic.net/lnCJhG9F.png\" rel=\"nofollow noreferrer\">Logo in PDF</a></p>\n<p>Below is the sample class that was used to create the pdf with the logo image</p>\n<pre><code>import org.apache.pdfbox.pdmodel.PDPage;\nimport org.apache.pdfbox.pdmodel.PDPageContentStream;\nimport org.apache.pdfbox.pdmodel.common.PDRectangle;\nimport org.apache.pdfbox.pdmodel.graphics.image.PDImageXObject;\n\nimport java.nio.file.Files;\nimport java.nio.file.Paths;\n\nimport static org.apache.pdfbox.pdmodel.PDPageContentStream.AppendMode.APPEND;\n\npublic class PDFBoxSample {\n    public static void main(String[] args) {\n        try {\n            try (var outputDocument = PDFUtils.createPDADocument(&quot;src/test/resources/output/destination/image_temp.pdf&quot;)) {\n                var pageSize = 850.394f;\n                var newPage = new PDPage(new PDRectangle(pageSize, pageSize));\n                outputDocument.addPage(newPage);\n\n                try (var contentStream = new PDPageContentStream(outputDocument, newPage, APPEND,false)) {\n                    contentStream.saveGraphicsState();\n                    var imgPath = &quot;src/test/resources/images/ritz.jpg&quot;;\n                    var img = PDImageXObject.createFromFile(imgPath, outputDocument);\n                    contentStream.drawImage(img, pageSize/2 - img.getWidth()/2, pageSize/2 - img.getHeight()/2);\n                    contentStream.restoreGraphicsState();\n                }\n            }\n\n            Files.move(Paths.get(&quot;src/test/resources/output/destination/image_temp.pdf&quot;),\n                    Paths.get(&quot;src/test/resources/output/destination/image.pdf&quot;),\n                    java.nio.file.StandardCopyOption.REPLACE_EXISTING);\n\n        } catch (Exception e) {\n            throw new RuntimeException(e);\n        }\n    }\n}\n</code></pre>\n",
    "tags" : [ "java", "pdfbox" ],
    "owner" : {
      "account_id" : 41685303,
      "reputation" : 11,
      "user_id" : 30404070,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/0e488b6f0ec8626d120a461b7f52bb98?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Kyle KYL",
      "link" : "https://stackoverflow.com/users/30404070/kyle-kyl"
    },
    "is_answered" : false,
    "view_count" : 43,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1745935219,
    "creation_date" : 1745933429,
    "link" : "https://stackoverflow.com/questions/79598480/pdimagexobject-color-accuracy-issue",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79598553,
    "question_id" : 79598480,
    "body" : "<p>I've found the issue. I would need convert the image using BufferedImage and embed an ICC profile before loading to PDImageXObject class</p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 41685303,
      "reputation" : 11,
      "user_id" : 30404070,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/0e488b6f0ec8626d120a461b7f52bb98?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Kyle KYL",
      "link" : "https://stackoverflow.com/users/30404070/kyle-kyl"
    },
    "creation_date" : 1745935219,
    "last_activity_date" : 1745935219,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140380524,
    "post_id" : 79598480,
    "body" : "@StephanWack It would had been more obvious if I&#39;ve attached the actual sample pdf output. I&#39;ve just realized it&#39;s hard to tell the difference with the images I&#39;ve attached in the post",
    "score" : 0,
    "owner" : {
      "account_id" : 41685303,
      "reputation" : 11,
      "user_id" : 30404070,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/0e488b6f0ec8626d120a461b7f52bb98?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Kyle KYL",
      "link" : "https://stackoverflow.com/users/30404070/kyle-kyl"
    },
    "creation_date" : 1745937047,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140380378,
    "post_id" : 79598480,
    "body" : "The red color is more or less rgb(217, 56, 56) in both images.",
    "score" : 2,
    "owner" : {
      "account_id" : 2675342,
      "reputation" : 116,
      "user_id" : 2311875,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/e07c495347159a919ef67637b867000c?s=256&d=identicon&r=PG",
      "display_name" : "Stephan Wack",
      "link" : "https://stackoverflow.com/users/2311875/stephan-wack"
    },
    "creation_date" : 1745935023,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79598553" : [ {
      "comment_id" : 140380578,
      "post_id" : 79598553,
      "body" : "I&#39;m currently using the latest PDFBox 3.0.4. I&#39;m currently migrating from iText 7 to PDFBox 3.0.4. I noticed the color difference between these two implementation when I load the image to the pdf with the default code. iText was more accurate and close to the original image. By attaching the ICC profile to the BufferedImage, I was able to achieve the result that I need",
      "score" : 0,
      "owner" : {
        "account_id" : 41685303,
        "reputation" : 11,
        "user_id" : 30404070,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/0e488b6f0ec8626d120a461b7f52bb98?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "Kyle KYL",
        "link" : "https://stackoverflow.com/users/30404070/kyle-kyl"
      },
      "creation_date" : 1745937671,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140380543,
      "post_id" : 79598553,
      "body" : "This is weird. JPEG files are embedded as they come so the original code is best. Your response would make it slower and possibly bloat the file. Maybe you used some very old version?",
      "score" : 0,
      "owner" : {
        "account_id" : 255529,
        "reputation" : 19235,
        "user_id" : 535646,
        "user_type" : "registered",
        "accept_rate" : 40,
        "profile_image" : "https://i.sstatic.net/yGyps.jpg?s=256",
        "display_name" : "Tilman Hausherr",
        "link" : "https://stackoverflow.com/users/535646/tilman-hausherr"
      },
      "creation_date" : 1745937299,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}