{
  "question" : {
    "question_id" : 79753533,
    "title" : "Tests in @QuarkusTest class with runMainMethod not waiting for the result",
    "body" : "<p>I want to write integration tests for a Quarkus application with a <code>main</code> method using the <code>@QuarkusMain</code> annotation. Since it's not possible to inject any beans in a <code>@QuarkusMainTest</code> annotated test class (see <a href=\"https://github.com/quarkusio/quarkus/issues/49723\" rel=\"nofollow noreferrer\">https://github.com/quarkusio/quarkus/issues/49723</a>) I'm trying to set up a test class annotated with <code>@QuarkusTest</code> using a class from <code>QuarkusTestProfile</code> with the overridden <code>runMainMethod</code> method returning <code>true</code>.</p>\n<p>But this leads to the problem that the main code runs in a separate thread (due to the <code>run</code> method in the <code>QuarkusApplication</code> implementing class) and the tests in the test class cannot fetch the results (e.g. from the database). Is there a way to enforce the main code triggered by <code>runMainMethod</code> not to run in a seperate thread? Or the test class to wait for the result as it is in the <code>@QuarkusMainTest</code> classes?</p>\n",
    "tags" : [ "java", "unit-testing", "quarkus" ],
    "owner" : {
      "account_id" : 16376965,
      "reputation" : 29,
      "user_id" : 11828840,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/-RrKavj2pdjs/AAAAAAAAAAI/AAAAAAAAAAg/cL8qesYNK70/s256-rj/photo.jpg",
      "display_name" : "Adler auf H&#246;henflug",
      "link" : "https://stackoverflow.com/users/11828840/adler-auf-h%c3%b6henflug"
    },
    "is_answered" : false,
    "view_count" : 53,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1756973217,
    "creation_date" : 1756818198,
    "link" : "https://stackoverflow.com/questions/79753533/tests-in-quarkustest-class-with-runmainmethod-not-waiting-for-the-result",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140726715,
    "post_id" : 79753533,
    "body" : "Honestly this is a guess on my part, but reading the issue above, as there are 2 different class loaders involved, it is most likely different Thread Contexts as well.",
    "score" : 0,
    "owner" : {
      "account_id" : 9504657,
      "reputation" : 8623,
      "user_id" : 7064617,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/Q17Fg.png?s=256",
      "display_name" : "jcompetence",
      "link" : "https://stackoverflow.com/users/7064617/jcompetence"
    },
    "creation_date" : 1757508348,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}