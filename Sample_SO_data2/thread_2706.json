{
  "question" : {
    "question_id" : 79604041,
    "title" : "How to add one interval to reduce the number of separate groups?",
    "body" : "<p>I'm working on an interval-merging optimization problem. Given:</p>\n<p>A list of intervals (each defined by start a[i] and end b[i], both inclusive)</p>\n<p>A number k that defines the maximum size of one additional interval we can insert into the list</p>\n<p><strong>Goal:</strong>\nAdd one interval of length ≤ k to the list such that the total number of disconnected (non-overlapping) intervals after merging is minimized.</p>\n<p><strong>Example:</strong></p>\n<p><strong>Input:</strong></p>\n<pre><code>Intervals = [(1, 5), (2, 4), (6, 6), (7, 14), (16, 19)]\nk = 2\n\nOption 1:\nAdd interval (5, 7) =&gt; 7-5=2 =k, → Merged result:\n[(1, 5), (2, 4), (5, 7), (6, 6), (7, 14)] → merges into one group\nand\n[(16, 19)]\n→ Total disconnected groups: 2\n\nOption 2:\nAdd interval (14, 16) instead → results in 3 groups:\n[(1, 5), (2, 4)], [(6, 6)], [(7, 14), (14, 16), (16, 19)]\n\nSo, the best result is 2 disconnected intervals.\n</code></pre>\n<p>Also, the new interval added can cover multiple existing gaps.</p>\n<p>for example, k = 10, intervals = (1,3), (4,6), (7,9), (10,11), (12,13)</p>\n<p>Initially, we have 5 groups, so we have 4 gaps as shown below:</p>\n<pre><code>(1,3), \n(4,6), \n(7,9), \n(10,11), \n(13, 15)\n</code></pre>\n<p>adding new interval (3,13) here, 13-3=10=k makes a single group:</p>\n<pre><code>(1,3), (3,13), (4,6), (7,9), (10,11), (13, 15)\n</code></pre>\n<p><strong>Constraints:</strong></p>\n<pre><code>1 &lt;= n &lt;= 2 * 10^5\n\n1 &lt;= a[i] &lt;= b[i] &lt;= 10^9\n\n1 &lt;= k &lt;= 10^9\n</code></pre>\n<p>My Code:</p>\n<pre><code>import java.util.*;\n\npublic class Main {\n    public static void main(String[] args) {\n        List&lt;Integer&gt; a1 = Arrays.asList(1, 2, 5, 10);\n        List&lt;Integer&gt; b1 = Arrays.asList(2, 4, 8, 11);\n        int k1 = 2;\n        System.out.println(solve(a1, b1, k1));  // Output: 2\n\n        List&lt;Integer&gt; a2 = Arrays.asList(3, 2, 3);\n        List&lt;Integer&gt; b2 = Arrays.asList(5, 9, 3);\n        int k2 = 10;\n        System.out.println(solve(a2, b2, k2));  // Output: 1\n\n        List&lt;Integer&gt; a3 = Arrays.asList(1, 2, 6, 7, 16);\n        List&lt;Integer&gt; b3 = Arrays.asList(5, 4, 6, 14, 19);\n        int k3 = 2;\n        System.out.println(solve(a3, b3, k3));  // Output: 2 \n\n        List&lt;Integer&gt; a4 = Arrays.asList(2,13,27,45,45,33);\n        List&lt;Integer&gt; b4 = Arrays.asList(10,24,40,45,45,33);\n        int k4 = 12;\n        System.out.println(solve(a4, b4, k4));  // Output: 3 \n    }\n    public static int solve(List&lt;Integer&gt; a, List&lt;Integer&gt; b, int k) {\n        int n = a.size();\n        int[][] intervals = new int[n][2];\n        for (int i = 0; i &lt; n; i++) {\n            intervals[i][0] = a.get(i);\n            intervals[i][1] = b.get(i);\n        }\n\n        // Sort by start time\n        Arrays.sort(intervals, Comparator.comparingInt(x -&gt; x[0]));\n\n        // Merge intervals in-place\n        List&lt;int[]&gt; merged = new ArrayList&lt;&gt;();\n        int[] curr = intervals[0];\n        for (int i = 1; i &lt; n; i++) {\n            if (curr[1] &gt;= intervals[i][0]) {\n                curr[1] = Math.max(curr[1], intervals[i][1]);\n            } else {\n                merged.add(curr);\n                curr = intervals[i];\n            }\n        }\n        merged.add(curr);\n\n        int m = merged.size();\n        if (m == 1) return 1;\n\n        // Sliding window to bridge max gaps\n        int maxBridged = 0;\n        int left = 0;\n        for (int right = 0; right &lt; m - 1; right++) {\n            int start = merged.get(left)[1];\n            int end = merged.get(right + 1)[0];\n            while (end - start &gt; k) {\n                left++;\n                start = merged.get(left)[1];\n            }\n            maxBridged = Math.max(maxBridged, right - left + 1);\n        }\n\n        return m - maxBridged;\n    }\n}\n</code></pre>\n<p><strong>Problem:</strong></p>\n<p>I'm trying to use a sliding window approach to find the maximum number of gaps between merged intervals that can be bridged using a single interval of length ≤ k.</p>\n<p>However, I'm struggling with how to manage the left and right pointers.</p>\n<p>Specifically:</p>\n<ul>\n<li><p>How should the right be advanced in the loop?</p>\n</li>\n<li><p>How do I ensure left never goes out of bounds or overtakes right improperly?</p>\n</li>\n</ul>\n",
    "tags" : [ "java", "algorithm" ],
    "owner" : {
      "account_id" : 31187804,
      "reputation" : 794,
      "user_id" : 23993901,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/7417aaad0c8ece3fac44f06d05a8ba8b?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "CodeCrusader",
      "link" : "https://stackoverflow.com/users/23993901/codecrusader"
    },
    "is_answered" : true,
    "view_count" : 294,
    "answer_count" : 3,
    "score" : 3,
    "last_activity_date" : 1746569300,
    "creation_date" : 1746215542,
    "link" : "https://stackoverflow.com/questions/79604041/how-to-add-one-interval-to-reduce-the-number-of-separate-groups",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79604121,
    "question_id" : 79604041,
    "body" : "<p>To fix your sliding window logic:</p>\n<ol>\n<li><p>Move <code>right</code> forward one step at a time to try bridging more gaps.</p>\n</li>\n<li><p>If the gap between <code>merged[left][1]</code> and <code>merged[right][0]</code> is too big (greater than <code>k</code>), move <code>left</code> forward until the gap is small enough.</p>\n</li>\n<li><p>Keep track of the biggest window (number of gaps) you can bridge this way.</p>\n</li>\n<li><p>In the end, subtract that from the total number of merged intervals to get the minimum number of disconnected groups.</p>\n<pre class=\"lang-java prettyprint-override\"><code>public static int solve(List&lt;Integer&gt; a, List&lt;Integer&gt; b, int k) {\n    int n = a.size();\n    int[][] intervals = new int[n][2];\n    for (int i = 0; i &lt; n; i++) {\n        intervals[i][0] = a.get(i);\n        intervals[i][1] = b.get(i);\n    }\n\n    // Sort intervals by start time\n    Arrays.sort(intervals, Comparator.comparingInt(x -&gt; x[0]));\n\n    // Merge intervals\n    List&lt;int[]&gt; merged = new ArrayList&lt;&gt;();\n    int[] curr = intervals[0];\n    for (int i = 1; i &lt; n; i++) {\n        if (curr[1] &gt;= intervals[i][0]) {\n            curr[1] = Math.max(curr[1], intervals[i][1]);\n        } else {\n            merged.add(curr);\n            curr = intervals[i];\n        }\n    }\n    merged.add(curr);\n\n    int m = merged.size();\n    if (m == 1) return 1;\n\n    // Compute gaps between merged intervals\n    int[] gaps = new int[m - 1];\n    for (int i = 0; i &lt; m - 1; i++) {\n        gaps[i] = merged.get(i + 1)[0] - merged.get(i)[1];\n    }\n\n    // Sliding window to find max number of gaps we can bridge with total length &lt;= k\n    int maxBridged = 0;\n    int totalGap = 0;\n    int left = 0;\n    for (int right = 0; right &lt; gaps.length; right++) {\n        totalGap += gaps[right];\n        while (totalGap &gt; k) {\n            totalGap -= gaps[left];\n            left++;\n        }\n        maxBridged = Math.max(maxBridged, right - left + 1);\n    }\n\n    return m - maxBridged;\n}\n</code></pre>\n</li>\n</ol>\n",
    "score" : 8,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 41607824,
      "reputation" : 93,
      "user_id" : 30369190,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/0iMzHGCY.jpg?s=256",
      "display_name" : "chizhiks",
      "link" : "https://stackoverflow.com/users/30369190/chizhiks"
    },
    "creation_date" : 1746220290,
    "last_activity_date" : 1746387479,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79607275,
    "question_id" : 79604041,
    "body" : "<p>Here is the correct approach to solve:</p>\n<p>Once the merged intervals are prepared:</p>\n<ol>\n<li><p>Loop over each merged interval pair and populate a TreeMap where the key is the starting position of the interval pair, and the value is the number of groups that can be formed if the new interval falls within this interval pair.</p>\n</li>\n<li><p>Then, loop over the merged intervals again. For each pair, consider using its end as the starting point of the new interval, say <code>x</code>. The end of the new interval  <code>y</code> is simply  <code>y=x+k</code>.</p>\n</li>\n<li><p>With this new interval, <code>(x, y)</code>,  we can find how many gaps this interval covers using above treemap.</p>\n<p>This Logic takes n*log(n) time complexity where n is size of merged intervals.</p>\n</li>\n</ol>\n",
    "score" : 1,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 31187804,
      "reputation" : 794,
      "user_id" : 23993901,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/7417aaad0c8ece3fac44f06d05a8ba8b?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "CodeCrusader",
      "link" : "https://stackoverflow.com/users/23993901/codecrusader"
    },
    "creation_date" : 1746461589,
    "last_activity_date" : 1746569300,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "answer_id" : 79609387,
    "question_id" : 79604041,
    "body" : "<p>Let's try this: once you have the merged intervals, generating the sorted gaps is trivial and the solution(s) is/are the <code>(start_gap[i], start_gap[i]+k)</code> interval(s) covering the greatest number of gaps j == having <code>start_gap[i]+k &gt;= end_gap[j &gt; i]</code>.</p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 6389739,
      "reputation" : 5431,
      "user_id" : 4956336,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/5b2Ij.png?s=256",
      "display_name" : "p3consulting",
      "link" : "https://stackoverflow.com/users/4956336/p3consulting"
    },
    "creation_date" : 1746560712,
    "last_activity_date" : 1746560712,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140392497,
    "post_id" : 79604041,
    "body" : "@BasilBourque, for my problem k indicates the difference between start and end interval, so when k =2, the interval (5,7) have difference 7-5=2, similarly for (14,16), it is 16-14= 2",
    "score" : 0,
    "owner" : {
      "account_id" : 31187804,
      "reputation" : 794,
      "user_id" : 23993901,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/7417aaad0c8ece3fac44f06d05a8ba8b?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "CodeCrusader",
      "link" : "https://stackoverflow.com/users/23993901/codecrusader"
    },
    "creation_date" : 1746270130,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140391784,
    "post_id" : 79604041,
    "body" : "Is <code>k = 2</code> supposed to constrain the size of your <code>(5, 7)</code> &amp; <code>(14, 16)</code>? Both of those look like size 3, not size 2: 5-6-7 and 14-15-16.  Or does <code>k</code> refer to something else? You Question is not clear on that.",
    "score" : 0,
    "owner" : {
      "account_id" : 322981,
      "reputation" : 347089,
      "user_id" : 642706,
      "user_type" : "registered",
      "accept_rate" : 58,
      "profile_image" : "https://i.sstatic.net/ZWEI3.jpg?s=256",
      "display_name" : "Basil Bourque",
      "link" : "https://stackoverflow.com/users/642706/basil-bourque"
    },
    "creation_date" : 1746230559,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79604121" : [ {
      "comment_id" : 140396587,
      "post_id" : 79604121,
      "body" : "I ran the 4 test cases on updated answer also, some of them failed with wrong answer.",
      "score" : 0,
      "owner" : {
        "account_id" : 31187804,
        "reputation" : 794,
        "user_id" : 23993901,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/7417aaad0c8ece3fac44f06d05a8ba8b?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "CodeCrusader",
        "link" : "https://stackoverflow.com/users/23993901/codecrusader"
      },
      "creation_date" : 1746443412,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140392492,
      "post_id" : 79604121,
      "body" : "In my post, I added 4 test cases along with the expected output, with this answer all the test cases are giving wrong outputs, please check",
      "score" : 0,
      "owner" : {
        "account_id" : 31187804,
        "reputation" : 794,
        "user_id" : 23993901,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/7417aaad0c8ece3fac44f06d05a8ba8b?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "CodeCrusader",
        "link" : "https://stackoverflow.com/users/23993901/codecrusader"
      },
      "creation_date" : 1746270060,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}