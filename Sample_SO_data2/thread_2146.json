{
  "question" : {
    "question_id" : 79645740,
    "title" : "make javax.validation.constraints work with SpringBoot 3",
    "body" : "<p>I have a library that uses <code>javax.validation.constraints</code> and I want to use it with both SpringBoot 2 and SpringBoot 3 apps.  The validation needs to happen on startup of the SpringBoot app when it in injecting settings from <code>application.yml</code> into the config objects.</p>\n<p>All the advice I can find says to switch to using <code>jakarta.validation.constraints</code>, which would certainly be the correct advice if I only wanted it to work with SB3, but if I do that it won't work with SB2.</p>\n<p>I was hoping that forcing the SB3 app to use <code>org.hibernate.validator:hibernate-validator:6.2.5.Final</code> (the version that uses the javax package name) would work, but that didn't help.</p>\n<p>This appears to be related to the <code>@Validated</code> tag (org.springframework.validation.annotation.Validated from <code>spring-context</code>) but I am not going to try to force the SB app to use a different major version of that, because that would certainly break other things.</p>\n<p>I tried changing that to <code>@Valid</code> (javax.validation.Valid) but then it doesn't work in either SB2 or SB3.</p>\n<p>What I don't understand is how SB triggers calls to validation when injecting settings from <code>application.yml</code>. If I understood that maybe I could trigger it some other way.</p>\n",
    "tags" : [ "java", "spring-boot", "spring-validator", "javax.validation", "jakarta-validation" ],
    "owner" : {
      "account_id" : 926419,
      "reputation" : 421,
      "user_id" : 957136,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/531fb75e7f195cde6e6bfda81c680ec3?s=256&d=identicon&r=PG",
      "display_name" : "dlipofsky",
      "link" : "https://stackoverflow.com/users/957136/dlipofsky"
    },
    "is_answered" : true,
    "view_count" : 192,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1748879916,
    "creation_date" : 1748619593,
    "link" : "https://stackoverflow.com/questions/79645740/make-javax-validation-constraints-work-with-springboot-3",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79649969,
    "question_id" : 79645740,
    "body" : "<p>It's ugly, but I've confirmed this works with both SpringBoot 2.7.18 and SpringBoot 3.4.5.</p>\n<p>(and despite what you may read elsewhere, it does work on abstract classes, as long as the @Validated and the validation constraint are both on the abstract class)</p>\n<pre class=\"lang-java prettyprint-override\"><code>import org.springframework.validation.annotation.Validated;\n\n@Validated\npublic abstract class AbstractJwksAutoConfig {\n\n    @javax.validation.constraints.Min(60000L)\n    @jakarta.validation.constraints.Min(60000L)\n    @javax.validation.constraints.Max(86400000L)\n    @jakarta.validation.constraints.Max(86400000L)\n    Long jwksRefreshTimeInMillis = 180000L;\n\n    ...\n}\n</code></pre>\n",
    "score" : 1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 926419,
      "reputation" : 421,
      "user_id" : 957136,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/531fb75e7f195cde6e6bfda81c680ec3?s=256&d=identicon&r=PG",
      "display_name" : "dlipofsky",
      "link" : "https://stackoverflow.com/users/957136/dlipofsky"
    },
    "creation_date" : 1748879916,
    "last_activity_date" : 1748879916,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140473274,
    "post_id" : 79645740,
    "body" : "It does look like ValidationAnnotationUtils (in spring-context) tries to handle both <code>@Validated</code> and <code>@Valid</code> and any annotation that starts with <code>@Valid</code>, so it seems that that should work. Further the <code>@Validated</code> tag has the same package name in both versions of Spring, so I don&#39;t see why it should be an issue. There&#39;s probably some AOP magic going on with MethodValidationInterceptor that I don&#39;t understand.    When this is working and I violate constraints I get a ConfigurationPropertiesBindException (with nested BindException). Those exceptions are in spring-boot, not spring-context.",
    "score" : 0,
    "owner" : {
      "account_id" : 926419,
      "reputation" : 421,
      "user_id" : 957136,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/531fb75e7f195cde6e6bfda81c680ec3?s=256&d=identicon&r=PG",
      "display_name" : "dlipofsky",
      "link" : "https://stackoverflow.com/users/957136/dlipofsky"
    },
    "creation_date" : 1748623871,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140473270,
    "post_id" : 79645740,
    "body" : "I&#39;m sure that&#39;s what most people do. It&#39;s what I did at my previous job, and I wish it&#39;s what I could do here, but it&#39;s a big corporation with many teams using this, and we don&#39;t think we can force the teams to use SB3. We could be adding new features, and so then we&#39;d have to add those features to both branches.",
    "score" : 0,
    "owner" : {
      "account_id" : 926419,
      "reputation" : 421,
      "user_id" : 957136,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/531fb75e7f195cde6e6bfda81c680ec3?s=256&d=identicon&r=PG",
      "display_name" : "dlipofsky",
      "link" : "https://stackoverflow.com/users/957136/dlipofsky"
    },
    "creation_date" : 1748623736,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140473117,
    "post_id" : 79645740,
    "body" : "I&#39;m not sure you&#39;re going to be able to do that. I have a similar library like that, and I maintain 2 active branches - one for version 1.x for Spring Boot 2 that uses <code>javax.validation</code>, and one for version 2.x for Spring Boot 3 that uses <code>jakarta.validation</code>. However, since Spring Boot 2.x has been EOL since June 2023 (unless you have commercial support, see <a href=\"https://endoflife.date/spring-boot\" rel=\"nofollow noreferrer\">endoflife.date/spring-boot</a>) I would probably just let the Spring Boot 2 support die out.",
    "score" : 0,
    "owner" : {
      "account_id" : 1211967,
      "reputation" : 9964,
      "user_id" : 1180351,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/pKB8y.png?s=256",
      "display_name" : "Rob Spoor",
      "link" : "https://stackoverflow.com/users/1180351/rob-spoor"
    },
    "creation_date" : 1748620485,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79649969" : [ {
      "comment_id" : 140480936,
      "post_id" : 79649969,
      "body" : "note: if you would use this in a big corporation, the other developers probably want to have their stuff validated using their rules, so you&#39;d probably want to look into having your own annotations that use these annotations, hiding the complexity from the other devs.",
      "score" : 0,
      "owner" : {
        "account_id" : 151394,
        "reputation" : 53743,
        "user_id" : 365237,
        "user_type" : "registered",
        "accept_rate" : 96,
        "profile_image" : "https://www.gravatar.com/avatar/fb9385b7f1a792d5159eca8bbb2c34f8?s=256&d=identicon&r=PG",
        "display_name" : "eis",
        "link" : "https://stackoverflow.com/users/365237/eis"
      },
      "creation_date" : 1748883006,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}