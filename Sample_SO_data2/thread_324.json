{
  "question" : {
    "question_id" : 79821437,
    "title" : "How can I understand what drains memory in my Java app?",
    "body" : "<p>I suspect that my Java app running in tomcat is draining some memory, It is a Spring application with most stateless services and then I think the memory consumption should be low especially while no users are connected.</p>\n<p>Than I would like to deepen a bit of what is using java memory, how can I proceed?<br />\nLet's say that in my code there is an always growing cache/map structure that for some reason the GC doesn't free, how can I get? Is there any way to list the objects by consumption with references to the code source?</p>\n<p>I tried to look into Jstack but it seems it lists all threads and doesn't help with the memory.</p>\n",
    "tags" : [ "java", "memory", "jstack" ],
    "owner" : {
      "account_id" : 460510,
      "reputation" : 9619,
      "user_id" : 861646,
      "user_type" : "registered",
      "accept_rate" : 54,
      "profile_image" : "https://i.sstatic.net/wRgjT.jpg?s=256",
      "display_name" : "Tobia",
      "link" : "https://stackoverflow.com/users/861646/tobia"
    },
    "is_answered" : false,
    "view_count" : 41,
    "closed_date" : 1763296229,
    "answer_count" : 0,
    "score" : -3,
    "last_activity_date" : 1763294081,
    "creation_date" : 1763294081,
    "link" : "https://stackoverflow.com/questions/79821437/how-can-i-understand-what-drains-memory-in-my-java-app",
    "closed_reason" : "Duplicate"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140862551,
    "post_id" : 79821437,
    "body" : "Thanks for your question! Stack Overflow is now running an experiment that allows opinion-based questions. Please re-ask and choose one of the new question types (tooling recommendation, best practice, advice) in the ask question form. Weâ€™ve just added you to the experiment group, so that form field should now be visible to you!",
    "score" : 0,
    "owner" : {
      "account_id" : 25316024,
      "reputation" : 101,
      "user_id" : 19324976,
      "user_type" : "moderator",
      "profile_image" : "https://i.sstatic.net/tEUM1Gyf.jpg?s=256",
      "display_name" : "duck",
      "link" : "https://stackoverflow.com/users/19324976/duck"
    },
    "creation_date" : 1763565264,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140858422,
    "post_id" : 79821437,
    "body" : "This can be normal depending on the used GC. A lot of GCs never release once occupied heap (or only when you manually call <code>System.gc()</code>. Therefore it is important to know what GC is used what allocation/release characteristics it has an what the maximum heap is.",
    "score" : 0,
    "owner" : {
      "account_id" : 50585,
      "reputation" : 43469,
      "user_id" : 150978,
      "user_type" : "registered",
      "accept_rate" : 78,
      "profile_image" : "https://www.gravatar.com/avatar/feadc214792e2581c3c750140e3eb2c7?s=256&d=identicon&r=PG",
      "display_name" : "Robert",
      "link" : "https://stackoverflow.com/users/150978/robert"
    },
    "creation_date" : 1763391336,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140857960,
    "post_id" : 79821437,
    "body" : "@Robert My JVM process has 4.7GB of resident memory after many days of uptime even if currently it doesnt have connections, if I restart tomcat it restarts with &lt;400MB of resident memory and then it starts growing.",
    "score" : 0,
    "owner" : {
      "account_id" : 460510,
      "reputation" : 9619,
      "user_id" : 861646,
      "user_type" : "registered",
      "accept_rate" : 54,
      "profile_image" : "https://i.sstatic.net/wRgjT.jpg?s=256",
      "display_name" : "Tobia",
      "link" : "https://stackoverflow.com/users/861646/tobia"
    },
    "creation_date" : 1763376449,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140856650,
    "post_id" : 79821437,
    "body" : "Why do you think the app is draining memory what are your observations? How is the JVM configured (used GC, max heap, ..)? Jstack is the totally wrong tool. Better would be a tool like VisualVM.",
    "score" : 4,
    "owner" : {
      "account_id" : 50585,
      "reputation" : 43469,
      "user_id" : 150978,
      "user_type" : "registered",
      "accept_rate" : 78,
      "profile_image" : "https://www.gravatar.com/avatar/feadc214792e2581c3c750140e3eb2c7?s=256&d=identicon&r=PG",
      "display_name" : "Robert",
      "link" : "https://stackoverflow.com/users/150978/robert"
    },
    "creation_date" : 1763294304,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}