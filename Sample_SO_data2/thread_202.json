{
  "question" : {
    "question_id" : 79831217,
    "title" : "How do I prevent a Maven mojo parameter from being encoded on write to XML?",
    "body" : "<p>I'm writing a custom Maven plugin for building a Flatpak from a Java project. In a Maven mojo I understand we use <code>@Parameter</code> annotations to parse <code>pom.xml</code> file configurations. For example:</p>\n<p>pom.xml:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;configuration&gt;\n    &lt;param1&gt;VALUE&lt;/param1&gt;\n&lt;/configuration&gt;\n</code></pre>\n<p>In MyMojo.java:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Parameter\nprivate String param1;\n</code></pre>\n<p>But how would I set a value that includes HTML tags? For example:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;configuration&gt;\n    &lt;param1&gt;&lt;p&gt;VALUE&lt;/p&gt;&lt;/param1&gt;\n&lt;/configuration&gt;\n</code></pre>\n<p>Trying this, I get the error:</p>\n<blockquote>\n<p>Basic element 'param1' must not contain child elements.</p>\n</blockquote>\n<p>So I wrap the <code>&lt;p&gt;VALUE&lt;/p&gt;</code> in a CDATA block:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;configuration&gt;\n    &lt;param1&gt;&lt;![CDATA[&lt;p&gt;VALUE&lt;/p&gt;]]&gt;&lt;/param1&gt;\n&lt;/configuration&gt;\n</code></pre>\n<p>This works up to the point where the MetaInfo object is written to file:</p>\n<pre class=\"lang-java prettyprint-override\"><code>private void writeMetaInfo(MetaInfo metaInfo, Writer writer) throws IOException {\n    XmlMapper mapper = new XmlMapper();\n    new PrintWriter(writer, true).println(&quot;&lt;?xml version=\\&quot;1.0\\&quot; encoding=\\&quot;UTF-8\\&quot;?&gt;&quot;);\n    // metaInfo value is correct before writing - it has &lt;p&gt; not &amp;lt;p&gt;\n    mapper.writerWithDefaultPrettyPrinter().writeValue(writer, metaInfo);\n}\n</code></pre>\n<p>The result is an XML file with:\n<code>&lt;param1&gt;&amp;lt;p&gt;VALUE&amp;lt;/p&gt;&lt;/param1&gt;</code></p>\n<p>...with the leading angle brackets replaced with their entity, <code>&amp;lt;</code>. This doesn't work for the Flatpak MetaInfo file I'm building. It needs the <code>&lt;p&gt;</code> and <code>&lt;/p&gt;</code>.</p>\n<p>So it seems to be a problem with the XmlMapper (<code>com.fasterxml.jackson.dataformat.xml.XmlMapper</code> from <code>com.fasterxml.jackson.dataformat:jackson-dataformat-xml:2.20.1</code>).</p>\n<p>I found this <a href=\"https://stackoverflow.com/questions/2784183/what-does-cdata-in-xml-mean\">question</a> which seems to indicate just using the CDATA block should work.</p>\n<p>Any ideas?</p>\n",
    "tags" : [ "java", "xml", "jackson", "cdata", "jackson-dataformat-xml" ],
    "owner" : {
      "account_id" : 2645778,
      "reputation" : 474,
      "user_id" : 2288506,
      "user_type" : "registered",
      "accept_rate" : 25,
      "profile_image" : "https://www.gravatar.com/avatar/0dff0ff19db0fbcba1cfa9cb5eb901f6?s=256&d=identicon&r=PG",
      "display_name" : "CraigFoote",
      "link" : "https://stackoverflow.com/users/2288506/craigfoote"
    },
    "is_answered" : true,
    "view_count" : 188,
    "answer_count" : 1,
    "score" : 1,
    "last_activity_date" : 1764503293,
    "creation_date" : 1764197536,
    "link" : "https://stackoverflow.com/questions/79831217/how-do-i-prevent-a-maven-mojo-parameter-from-being-encoded-on-write-to-xml",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79833239,
    "question_id" : 79831217,
    "body" : "<p>If you want to embed some XML fragments into the generated document, I don't think that high-level XML mappers are the right tool. I would use a more manual approach. Here is a solution based on the <a href=\"https://github.com/elharo/xom/\" rel=\"nofollow noreferrer\">XOM</a> library.</p>\n<p>Assuming you have this class:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class MetaInfo\n{\n    private String id;\n    private String name;\n    private String description;\n\n    public String getId()\n    {\n        return id;\n    }\n\n    public void setId(String id)\n    {\n        this.id = id;\n    }\n\n    public String getName()\n    {\n        return name;\n    }\n\n    public void setName(String name)\n    {\n        this.name = name;\n    }\n\n    public String getDescription()\n    {\n        return description;\n    }\n\n    public void setDescription(String description)\n    {\n        this.description = description;\n    }\n}\n</code></pre>\n<p>You can generate the MetaInfo file like this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>import java.io.*;\nimport nu.xom.*;\n\nclass MetaInfoGenerator\n{\n    private void addSimpleValue(Element parent, String name, String value)\n    {\n        Element element = new Element(name);\n        element.appendChild(value);\n        parent.appendChild(element);\n    }\n\n    private void addXmlValue(Element parent, String name, String value) throws ParsingException, IOException\n    {\n        String xml = String.format(&quot;&lt;%s&gt;%s&lt;/%s&gt;&quot;, name, value, name);\n        Document doc = new Builder().build(xml, null);\n        parent.appendChild(doc.getRootElement().copy());\n    }\n\n    public void createMetaInfo(MetaInfo metaInfo, OutputStream out) throws ParsingException, IOException\n    {\n        Element root = new Element(&quot;component&quot;);\n        root.addAttribute(new Attribute(&quot;type&quot;, &quot;desktop-application&quot;));\n        addSimpleValue(root, &quot;id&quot;, metaInfo.getId());\n        addSimpleValue(root, &quot;name&quot;, metaInfo.getName());\n        addXmlValue(root, &quot;description&quot;, metaInfo.getDescription());\n\n        Document doc = new Document(root);\n        Serializer serializer = new Serializer(out, &quot;UTF-8&quot;);\n        serializer.setIndent(4);\n        serializer.write(doc);\n    }\n\n    public static void main(String[] args) throws ParsingException, IOException\n    {\n        MetaInfo metaInfo = new MetaInfo();\n        metaInfo.setId(&quot;com.example.foobar&quot;);\n        metaInfo.setName(&quot;Foo Bar&quot;);\n        metaInfo.setDescription(&quot;&lt;p&gt;An awesome app!&lt;/p&gt;&quot;);\n\n        new MetaInfoGenerator().createMetaInfo(metaInfo, System.out);\n    }\n}\n</code></pre>\n<p>Output:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;component type=&quot;desktop-application&quot;&gt;\n    &lt;id&gt;com.example.foobar&lt;/id&gt;\n    &lt;name&gt;Foo Bar&lt;/name&gt;\n    &lt;description&gt;\n        &lt;p&gt;An awesome app!&lt;/p&gt;\n    &lt;/description&gt;\n&lt;/component&gt;\n</code></pre>\n",
    "score" : 3,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 17592368,
      "reputation" : 19777,
      "user_id" : 12763954,
      "user_type" : "registered",
      "profile_image" : "https://lh6.googleusercontent.com/-uYTsiw1bQ_o/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rev-nenZRronqGEJxeFQWww3ShBnQ/s256-rj/photo.jpg",
      "display_name" : "Olivier",
      "link" : "https://stackoverflow.com/users/12763954/olivier"
    },
    "creation_date" : 1764419056,
    "last_activity_date" : 1764491003,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140876186,
    "post_id" : 79831217,
    "body" : "Thanks for replying. It&#39;s <code>com.fasterxml.jackson.dataformat.xml.XmlMapper</code> from <code>com.fasterxml.jackson.dataformat:jackson-dataformat-xml:2.20&zwnj;&#8203;.1</code>. But I can try another solution if it helps. Can you point me at some code that writes an XML fragment when it&#39;s the value?",
    "score" : 0,
    "owner" : {
      "account_id" : 2645778,
      "reputation" : 474,
      "user_id" : 2288506,
      "user_type" : "registered",
      "accept_rate" : 25,
      "profile_image" : "https://www.gravatar.com/avatar/0dff0ff19db0fbcba1cfa9cb5eb901f6?s=256&d=identicon&r=PG",
      "display_name" : "CraigFoote",
      "link" : "https://stackoverflow.com/users/2288506/craigfoote"
    },
    "creation_date" : 1764249793,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140875865,
    "post_id" : 79831217,
    "body" : "What is the library or fully-qualified name of that <code>XmlMapper</code> class? That said, what you see is the <b>correct</b> behaviour for writing a <i>value</i> with <code>&lt;</code> into XML. If you want something else, then you will need to do more work, so it actually writes an XML fragment instead of a value (how or if you can do so depends on the actual XML library).",
    "score" : 1,
    "owner" : {
      "account_id" : 213468,
      "reputation" : 110280,
      "user_id" : 466862,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=256&d=identicon&r=PG",
      "display_name" : "Mark Rotteveel",
      "link" : "https://stackoverflow.com/users/466862/mark-rotteveel"
    },
    "creation_date" : 1764236968,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140875289,
    "post_id" : 79831217,
    "body" : "<code>[DEBUG]   (s) description = &lt;p&gt;Initial release&lt;&#47;p&gt; [DEBUG]   (f) releases = [flatpak.maven.plugin.models.Release@799fb45e]</code> <code>[DEBUG]   (f) releases = [flatpak.maven.plugin.models.Release@799fb45e]</code>. It&#39;s a complex object, a <code>List&lt;Release&gt;</code> each of which has a <code>String</code> field called <code>description</code>. The output shows unencoded p-tags. I&#39;ve debugged to the point where the XmlMapper writes and , before the write, the <code>release</code> instance has a description without the encoding.",
    "score" : 0,
    "owner" : {
      "account_id" : 2645778,
      "reputation" : 474,
      "user_id" : 2288506,
      "user_type" : "registered",
      "accept_rate" : 25,
      "profile_image" : "https://www.gravatar.com/avatar/0dff0ff19db0fbcba1cfa9cb5eb901f6?s=256&d=identicon&r=PG",
      "display_name" : "CraigFoote",
      "link" : "https://stackoverflow.com/users/2288506/craigfoote"
    },
    "creation_date" : 1764199796,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140875269,
    "post_id" : 79831217,
    "body" : "What do you see when execute your plugin with <code>-X</code> ... should be something about configurations and value passed to your params",
    "score" : 1,
    "owner" : {
      "account_id" : 3793708,
      "reputation" : 8720,
      "user_id" : 3149528,
      "user_type" : "registered",
      "accept_rate" : 50,
      "profile_image" : "https://www.gravatar.com/avatar/2b7a858c0b6b2da80fa54be1e1177688?s=256&d=identicon&r=PG",
      "display_name" : "Slawomir Jaranowski",
      "link" : "https://stackoverflow.com/users/3149528/slawomir-jaranowski"
    },
    "creation_date" : 1764198651,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}