{
  "question" : {
    "question_id" : 79686872,
    "title" : "Is there any way to view server certs that failed verification in Java?",
    "body" : "<p>My Java client's SSL handshake with a server is failing to authenticate the PKIX certificate chain, and I'm interested in viewing the server certificates that were presented during the handshake, because I have a  C++ client with similar logic and using the same trust store that is able to successfully establish the TLS session. Calling SSLSession.getPeerCertificates() in the Netty SslHandshakeCompletionEvent or the SslCloseCompletionEvent throws SslUnverifiedPeerException, so it is evident that it is disallowed by design to view the verification failed server certs. Is there some way around it?</p>\n",
    "tags" : [ "java", "ssl", "sslhandshakeexception" ],
    "owner" : {
      "account_id" : 218143,
      "reputation" : 221,
      "user_id" : 474323,
      "user_type" : "registered",
      "accept_rate" : 39,
      "profile_image" : "https://www.gravatar.com/avatar/851b7fa17e397da1ccbd23071404e749?s=256&d=identicon&r=PG",
      "display_name" : "Kannan J",
      "link" : "https://stackoverflow.com/users/474323/kannan-j"
    },
    "is_answered" : true,
    "view_count" : 64,
    "closed_date" : 1751502455,
    "answer_count" : 1,
    "score" : 2,
    "last_activity_date" : 1751436889,
    "creation_date" : 1751435438,
    "link" : "https://stackoverflow.com/questions/79686872/is-there-any-way-to-view-server-certs-that-failed-verification-in-java",
    "closed_reason" : "Duplicate"
  },
  "answers" : [ {
    "answer_id" : 79686899,
    "question_id" : 79686872,
    "body" : "<p>You can set the system property <code>-Djavax.net.debug=ssl:handshake</code> when starting your Java application</p>\n<p>For example you can run this in the command line</p>\n<p><code>java -Djavax.net.debug=ssl:handshake -jar jarName.jar</code></p>\n",
    "score" : 1,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 2688695,
      "reputation" : 981,
      "user_id" : 2322474,
      "user_type" : "registered",
      "accept_rate" : 50,
      "profile_image" : "https://i.sstatic.net/zdbAs.png?s=256",
      "display_name" : "KennyC",
      "link" : "https://stackoverflow.com/users/2322474/kennyc"
    },
    "creation_date" : 1751436889,
    "last_activity_date" : 1751436889,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140560401,
    "post_id" : 79686872,
    "body" : "&quot;Are you sure it is the server certs and not trust store?&quot; No, I&#39;m not. When did I say any such thing? NB I am 100% certain that the debug configuration I gave you will print the server&#39;s <code>Certificate</code> message. I&#39;ve been doing this for over 20 years. Look again.",
    "score" : 0,
    "owner" : {
      "account_id" : 71739,
      "reputation" : 311888,
      "user_id" : 207421,
      "user_type" : "registered",
      "accept_rate" : 82,
      "profile_image" : "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=256&d=identicon&r=PG",
      "display_name" : "user207421",
      "link" : "https://stackoverflow.com/users/207421/user207421"
    },
    "creation_date" : 1751502421,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140558296,
    "post_id" : 79686872,
    "body" : "If you really want simple, just connect with a browser and view the certificates. Or use <code>openssl s_client -connect google.com:443 -showcerts</code>",
    "score" : 0,
    "owner" : {
      "account_id" : 85671,
      "reputation" : 42272,
      "user_id" : 238704,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/VgOZI.png?s=256",
      "display_name" : "President James K. Polk",
      "link" : "https://stackoverflow.com/users/238704/president-james-k-polk"
    },
    "creation_date" : 1751454301,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140558087,
    "post_id" : 79686872,
    "body" : "I debugged into Netty code and found that the certificate chain has a special valued certificate with the content &quot;No SNI provided; please fix your client.&quot;.",
    "score" : 0,
    "owner" : {
      "account_id" : 218143,
      "reputation" : 221,
      "user_id" : 474323,
      "user_type" : "registered",
      "accept_rate" : 39,
      "profile_image" : "https://www.gravatar.com/avatar/851b7fa17e397da1ccbd23071404e749?s=256&d=identicon&r=PG",
      "display_name" : "Kannan J",
      "link" : "https://stackoverflow.com/users/474323/kannan-j"
    },
    "creation_date" : 1751450253,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140557955,
    "post_id" : 79686872,
    "body" : "@user207421 are you sure it is the server certs and not trust store? For both failed and successful cases I see the trust store contents get printed starting with &quot;X509TrustManagerImpl.java:82|adding as trusted certificates (&quot;. However only when the handshake is successful do I see a message with &quot;Consuming server Certificate handshake message&quot;, otherwise I just see sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target",
    "score" : 0,
    "owner" : {
      "account_id" : 218143,
      "reputation" : 221,
      "user_id" : 474323,
      "user_type" : "registered",
      "accept_rate" : 39,
      "profile_image" : "https://www.gravatar.com/avatar/851b7fa17e397da1ccbd23071404e749?s=256&d=identicon&r=PG",
      "display_name" : "Kannan J",
      "link" : "https://stackoverflow.com/users/474323/kannan-j"
    },
    "creation_date" : 1751447627,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140557547,
    "post_id" : 79686872,
    "body" : "Works for me, since about 2004. Try <code>-Djavax.net.debug=all</code>.",
    "score" : 0,
    "owner" : {
      "account_id" : 71739,
      "reputation" : 311888,
      "user_id" : 207421,
      "user_type" : "registered",
      "accept_rate" : 82,
      "profile_image" : "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=256&d=identicon&r=PG",
      "display_name" : "user207421",
      "link" : "https://stackoverflow.com/users/207421/user207421"
    },
    "creation_date" : 1751439633,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140557421,
    "post_id" : 79686872,
    "body" : "I already tried that, it doesn&#39;t print them there either for a TLS handshake that failed server cert verfication. Only prints when successful handshake is done.",
    "score" : 0,
    "owner" : {
      "account_id" : 218143,
      "reputation" : 221,
      "user_id" : 474323,
      "user_type" : "registered",
      "accept_rate" : 39,
      "profile_image" : "https://www.gravatar.com/avatar/851b7fa17e397da1ccbd23071404e749?s=256&d=identicon&r=PG",
      "display_name" : "Kannan J",
      "link" : "https://stackoverflow.com/users/474323/kannan-j"
    },
    "creation_date" : 1751436545,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140557411,
    "post_id" : 79686872,
    "body" : "You can <i>view</i> it for debug purposes via <code>-Djavax.net.debug=ssl,handshake</code>, but you don&#39;t want to code around it.",
    "score" : 0,
    "owner" : {
      "account_id" : 71739,
      "reputation" : 311888,
      "user_id" : 207421,
      "user_type" : "registered",
      "accept_rate" : 82,
      "profile_image" : "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=256&d=identicon&r=PG",
      "display_name" : "user207421",
      "link" : "https://stackoverflow.com/users/207421/user207421"
    },
    "creation_date" : 1751436252,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79686899" : [ {
      "comment_id" : 140563620,
      "post_id" : 79686899,
      "body" : "@KannanJ That&#39;s not correct. It print the handshake messages  as they are received.",
      "score" : 0,
      "owner" : {
        "account_id" : 71739,
        "reputation" : 311888,
        "user_id" : 207421,
        "user_type" : "registered",
        "accept_rate" : 82,
        "profile_image" : "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=256&d=identicon&r=PG",
        "display_name" : "user207421",
        "link" : "https://stackoverflow.com/users/207421/user207421"
      },
      "creation_date" : 1751584461,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140557491,
      "post_id" : 79686899,
      "body" : "I already tried that, it doesn&#39;t print them there either for a TLS handshake that failed server cert verfication. Only prints when successful handshake is done.",
      "score" : 0,
      "owner" : {
        "account_id" : 218143,
        "reputation" : 221,
        "user_id" : 474323,
        "user_type" : "registered",
        "accept_rate" : 39,
        "profile_image" : "https://www.gravatar.com/avatar/851b7fa17e397da1ccbd23071404e749?s=256&d=identicon&r=PG",
        "display_name" : "Kannan J",
        "link" : "https://stackoverflow.com/users/474323/kannan-j"
      },
      "creation_date" : 1751438314,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}