{
  "question" : {
    "question_id" : 79689378,
    "title" : "@ConfigurationProperties not working in test context but works in app",
    "body" : "<p>I have a class that is hydrated with Spring's configuration properties utility:</p>\n<pre class=\"lang-kotlin prettyprint-override\"><code>@ConfigurationProperties(prefix=&quot;com.me.sn&quot;)\nclass SNCredentials @ConstructorBinding constructor(\n    val instance: String,\n    val clientId: String,\n    val clientSecret: String,\n    val refreshToken: String,\n    val user: String\n)\n</code></pre>\n<p>In my app I have the following annotations and it works fine with the properties in <code>src/main/resources/application.properties</code></p>\n<pre class=\"lang-kotlin prettyprint-override\"><code>@SpringBootApplication\n@ConfigurationPropertiesScan\nclass MyApp\n\nfun main(args: Array&lt;String&gt;) {\n    runApplication&lt;MyApp&gt;(*args)\n}\n</code></pre>\n<p>My issue is with tests - I have the same properties defined in <code>src/test/resources/application.properties</code></p>\n<p>and I have this test:</p>\n<pre class=\"lang-kotlin prettyprint-override\"><code>\n@SpringBootTest(classes = [SNCredentials::class])\n@ConfigurationPropertiesScan\nclass ConductorSnCmdbTaskWorkerApplicationTests {\n\n    @Test\n    fun contextLoads() {\n    }\n\n}\n</code></pre>\n<p>This will not work, and I get</p>\n<blockquote>\n<p>Unsatisfied dependency expressed through constructor parameter 0: No qualifying bean of type 'java.lang.String' available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {}</p>\n</blockquote>\n<p>when it tries to create my credentials bean.</p>\n<p>I want to specify only certain classes in the <code>SpringBootTest</code> annotation so I don't load the whole context.</p>\n<p>What combination of annotations do I need on my test to make this work?</p>\n",
    "tags" : [ "java", "spring", "spring-boot", "kotlin", "spring-boot-test" ],
    "owner" : {
      "account_id" : 1009321,
      "reputation" : 11523,
      "user_id" : 1022260,
      "user_type" : "registered",
      "accept_rate" : 53,
      "profile_image" : "https://www.gravatar.com/avatar/3c76c653b051fc5594b5eeb66624d3ec?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "mikeb",
      "link" : "https://stackoverflow.com/users/1022260/mikeb"
    },
    "is_answered" : false,
    "view_count" : 124,
    "answer_count" : 1,
    "score" : 2,
    "last_activity_date" : 1751592774,
    "creation_date" : 1751571001,
    "link" : "https://stackoverflow.com/questions/79689378/configurationproperties-not-working-in-test-context-but-works-in-app",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79689603,
    "question_id" : 79689378,
    "body" : "<p>add SNCredentials by @autowired, used in ConductorSnCmdbTaskWorkerApplicationTests</p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 29850716,
      "reputation" : 9,
      "user_id" : 22876658,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a/ACg8ocKDVErUBjy9R3gjjIgcmzAmN3m3NuhtxUHCxAMecWyE=k-s256",
      "display_name" : "su rui",
      "link" : "https://stackoverflow.com/users/22876658/su-rui"
    },
    "creation_date" : 1751592774,
    "last_activity_date" : 1751592774,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140607266,
    "post_id" : 79689378,
    "body" : "@mikeb nah, both lands on the classpath and its is a blind guess which will be taken first.",
    "score" : 0,
    "owner" : {
      "account_id" : 1658807,
      "reputation" : 32708,
      "user_id" : 1527544,
      "user_type" : "registered",
      "accept_rate" : 54,
      "profile_image" : "https://www.gravatar.com/avatar/6665878d41d42307eb53e9fae311a471?s=256&d=identicon&r=PG",
      "display_name" : "Antoniossss",
      "link" : "https://stackoverflow.com/users/1527544/antoniossss"
    },
    "creation_date" : 1753132867,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140607129,
    "post_id" : 79689378,
    "body" : "Can you specify where each class exist in the packages? Where&#39;s your test class, where&#39;s your SNCredentials class, where&#39;s your MyApp class? Also, important to note that Spring will cache your application context and reuse it between tests. When you use only &quot;smaller&quot; parts in your tests, you are actually booting the application multiple times. In the end you are wasting more time to boot different smaller contexts than just use the main context that boots once.",
    "score" : 0,
    "owner" : {
      "account_id" : 1601399,
      "reputation" : 638,
      "user_id" : 1482356,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/d6160b6e40d230fa92c6da8072b2f7e5?s=256&d=identicon&r=PG",
      "display_name" : "Peter Adrian",
      "link" : "https://stackoverflow.com/users/1482356/peter-adrian"
    },
    "creation_date" : 1753128911,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140606992,
    "post_id" : 79689378,
    "body" : "@PeterAdrian - Didn&#39;t work.",
    "score" : 0,
    "owner" : {
      "account_id" : 1009321,
      "reputation" : 11523,
      "user_id" : 1022260,
      "user_type" : "registered",
      "accept_rate" : 53,
      "profile_image" : "https://www.gravatar.com/avatar/3c76c653b051fc5594b5eeb66624d3ec?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "mikeb",
      "link" : "https://stackoverflow.com/users/1022260/mikeb"
    },
    "creation_date" : 1753125002,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140606978,
    "post_id" : 79689378,
    "body" : "@Antoniossss - that&#39;s not correct, the stuff in test will override what&#39;s in main",
    "score" : 0,
    "owner" : {
      "account_id" : 1009321,
      "reputation" : 11523,
      "user_id" : 1022260,
      "user_type" : "registered",
      "accept_rate" : 53,
      "profile_image" : "https://www.gravatar.com/avatar/3c76c653b051fc5594b5eeb66624d3ec?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "mikeb",
      "link" : "https://stackoverflow.com/users/1022260/mikeb"
    },
    "creation_date" : 1753124489,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140563451,
    "post_id" : 79689378,
    "body" : "also remove <code>@ConfigurationPropertiesScan</code> above the test class",
    "score" : 0,
    "owner" : {
      "account_id" : 18586978,
      "reputation" : 3850,
      "user_id" : 15000097,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/yFl4M.jpg?s=256",
      "display_name" : "Georgii Lvov",
      "link" : "https://stackoverflow.com/users/15000097/georgii-lvov"
    },
    "creation_date" : 1751578371,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140563278,
    "post_id" : 79689378,
    "body" : "Shit happens when you have 2 application.properties in your classpath (like you do now - src/resources and test/resources",
    "score" : 0,
    "owner" : {
      "account_id" : 1658807,
      "reputation" : 32708,
      "user_id" : 1527544,
      "user_type" : "registered",
      "accept_rate" : 54,
      "profile_image" : "https://www.gravatar.com/avatar/6665878d41d42307eb53e9fae311a471?s=256&d=identicon&r=PG",
      "display_name" : "Antoniossss",
      "link" : "https://stackoverflow.com/users/1527544/antoniossss"
    },
    "creation_date" : 1751573084,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140563244,
    "post_id" : 79689378,
    "body" : "you need to add MyApp::class to the SpringBootTest. ConfigurationPropertiesScan will scan relative to the package it&#39;s used. Also, you added it as a component in the test, not as a property class. Another way is to use <code>@EnableConfigurationProperties</code> annotation to load the <code>SNCredentials</code> class",
    "score" : 0,
    "owner" : {
      "account_id" : 1601399,
      "reputation" : 638,
      "user_id" : 1482356,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/d6160b6e40d230fa92c6da8072b2f7e5?s=256&d=identicon&r=PG",
      "display_name" : "Peter Adrian",
      "link" : "https://stackoverflow.com/users/1482356/peter-adrian"
    },
    "creation_date" : 1751572130,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79689603" : [ {
      "comment_id" : 140563822,
      "post_id" : 79689603,
      "body" : "Your answer could be improved with additional supporting information. Please <a href=\"https://stackoverflow.com/posts/79689603/edit\">edit</a> to add further details, such as citations or documentation, so that others can confirm that your answer is correct. You can find more information on how to write good answers <a href=\"/help/how-to-answer\">in the help center</a>.",
      "score" : 1,
      "owner" : {
        "account_id" : -1,
        "reputation" : 1,
        "user_id" : -1,
        "user_type" : "moderator",
        "profile_image" : "https://www.gravatar.com/avatar/a007be5a61f6aa8f3e85ae2fc18dd66e?s=256&d=identicon&r=PG",
        "display_name" : "Community",
        "link" : "https://stackoverflow.com/users/-1/community"
      },
      "creation_date" : 1751596047,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}