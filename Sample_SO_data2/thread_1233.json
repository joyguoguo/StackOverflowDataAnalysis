{
  "question" : {
    "question_id" : 79732966,
    "title" : "How to query a JSON column by a nested key?",
    "body" : "<p>I’m using GridDB 5.3 with the Java client to store IoT sensor readings.\nEach reading is stored in a collection, and one of the columns contains a JSON payload as a string.</p>\n<p>Here’s a minimal Java example of how I’m inserting the data:</p>\n<pre><code>Properties props = new Properties();\nprops.setProperty(&quot;host&quot;, &quot;127.0.0.1&quot;);\nprops.setProperty(&quot;port&quot;, &quot;10001&quot;);\nprops.setProperty(&quot;clusterName&quot;, &quot;defaultCluster&quot;);\nprops.setProperty(&quot;user&quot;, &quot;admin&quot;);\nprops.setProperty(&quot;password&quot;, &quot;admin&quot;);\n\nGridStore store = GridStoreFactory.getInstance().getGridStore(props);\n\nContainerInfo info = new ContainerInfo();\ninfo.setName(&quot;sensor_data&quot;);\ninfo.setType(ContainerType.COLLECTION);\ninfo.setColumnInfoList(Arrays.asList(\n    new ColumnInfo(&quot;id&quot;, GSType.INTEGER),\n    new ColumnInfo(&quot;timestamp&quot;, GSType.TIMESTAMP),\n    new ColumnInfo(&quot;payload&quot;, GSType.STRING) // JSON data stored here\n));\nstore.putContainer(info);\n\nCollection&lt;Integer, Row&gt; col = store.getCollection(&quot;sensor_data&quot;, Row.class);\n\nString json1 = &quot;{\\&quot;deviceId\\&quot;:\\&quot;A1\\&quot;,\\&quot;temp\\&quot;:22.5}&quot;;\nString json2 = &quot;{\\&quot;deviceId\\&quot;:\\&quot;A2\\&quot;,\\&quot;temp\\&quot;:28.1}&quot;;\n\nRow row1 = col.createRow();\nrow1.setInteger(0, 1);\nrow1.setTimestamp(1, new Date());\nrow1.setString(2, json1);\n\nRow row2 = col.createRow();\nrow2.setInteger(0, 2);\nrow2.setTimestamp(1, new Date());\nrow2.setString(2, json2);\n\ncol.put(row1);\ncol.put(row2);\n\n</code></pre>\n<p>What I want is a query like:</p>\n<p><code>Find all rows where payload.deviceId = &quot;A2&quot;. </code>\nCurrently, the only way I’ve found is:</p>\n<ul>\n<li>Select all rows</li>\n<li>Parse the JSON in Java</li>\n<li>Filter manually</li>\n</ul>\n<p>This works but is slow with large datasets.</p>\n<p><strong>My question:</strong></p>\n<p>Is there a way in GridDB to filter rows directly by a nested JSON value inside a STRING column, without retrieving and parsing everything in the application?</p>\n<p>I’m not looking for schema redesign advice right now — I just want to know if native querying of nested JSON is possible in GridDB, and if so, how to do it in Java.</p>\n",
    "tags" : [ "java", "griddb" ],
    "owner" : {
      "account_id" : 15738612,
      "reputation" : 79,
      "user_id" : 26968350,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/bc2d96202ddb562d22cd8d6b6ee22041?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Ahmed Ben Khelifa",
      "link" : "https://stackoverflow.com/users/26968350/ahmed-ben-khelifa"
    },
    "is_answered" : false,
    "view_count" : 99,
    "answer_count" : 1,
    "score" : 1,
    "last_activity_date" : 1755137617,
    "creation_date" : 1754991657,
    "link" : "https://stackoverflow.com/questions/79732966/how-to-query-a-json-column-by-a-nested-key",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79734885,
    "question_id" : 79732966,
    "body" : "<p>GridDB does not natively support querying nested JSON values directly within a STRING column. The current capabilities of GridDB for handling JSON payloads stored as strings do not include querying nested elements within the JSON. The approach you are currently using—selecting all rows, parsing the JSON in Java, and then filtering manually—is the typical method for dealing with JSON data stored as strings in GridDB.</p>\n<p>If you require the ability to query nested JSON values efficiently, you may need to consider a different database system that has built-in support for JSON data types and allows querying of nested JSON elements directly, such as MongoDB. MongoDB, for example, provides powerful querying capabilities for JSON documents, including the ability to query nested fields.</p>\n<p>In summary, with GridDB, you will need to handle JSON parsing and filtering within your application code, as native querying of nested JSON is not supported.</p>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 26533836,
      "reputation" : 1,
      "user_id" : 20165658,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/1ccc00da2f8e5722e56365b69deb85a2?s=256&d=identicon&r=PG",
      "display_name" : "BingChuan",
      "link" : "https://stackoverflow.com/users/20165658/bingchuan"
    },
    "creation_date" : 1755136611,
    "last_activity_date" : 1755136611,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140663140,
    "post_id" : 79732966,
    "body" : "Or * Select all rows      * Filter with regex manually",
    "score" : 0,
    "owner" : {
      "account_id" : 14376658,
      "reputation" : 680,
      "user_id" : 10384954,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/-xBdd2OnIAto/AAAAAAAAAAI/AAAAAAAAABo/fK1ZH05JT5Y/s256-rj/photo.jpg",
      "display_name" : "Wladimir Diskowski",
      "link" : "https://stackoverflow.com/users/10384954/wladimir-diskowski"
    },
    "creation_date" : 1755098080,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}