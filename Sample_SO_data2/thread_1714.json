{
  "question" : {
    "question_id" : 79685452,
    "title" : "How can I get the actual type from a generic type parameter",
    "body" : "<p>Say, I have an abstract class for testing.</p>\n<pre class=\"lang-java prettyprint-override\"><code>abstract class BaseEntity&lt;SELF extends BaseEntity&lt;SELF&gt;&gt; {\n}\n</code></pre>\n<p>I declared an abstract test class for testing subclasses of the <code>BaseEntity</code>.</p>\n<pre class=\"lang-java prettyprint-override\"><code>abstract BaseEntityTest&lt;ENTITY extends BaseEntity&lt;ENTITY&gt;&gt; {\n\n    @ArgumentsSource(BaseEntityTestArgumentsProvider.class)\n    @ParameterizedTest\n    void _NotBlank_ToString(final Entity entityInstance) {\n    }\n\n    protected final Class&lt;ENTITY&gt; entityClass;\n}\n</code></pre>\n<pre class=\"lang-java prettyprint-override\"><code>public class BaseEntityArgumentsProvider implements ArgumentsProvider {\n\n    @Override\n    public Stream&lt;? extends Arguments&gt; provideArguments(final ParameterDeclarations parameters,\n                                                        final ExtensionContext context)\n            throws Exception {\n        final var firstParameterType = parameters.getFirst().map(ParameterDeclaration::getParameterType).orElse(null);\n        if (firstParameterType == null) {\n            return Stream.empty();\n        }\n        if (!BaseEntity.class.isAssignableFrom(firstParameterType)) {\n            return Stream.empty();\n        }\n        return BaseEntityTest_Utils.getEntityInstanceStream(\n                firstParameterType.asSubclass(BaseEntity.class)\n        ).map(Arguments::of);\n    }\n}\n</code></pre>\n<p>Now the <code>firstParameterType</code> is always <code>BaseEntity.class</code>. How can I get the actual type of the <code>ENTITY</code> within the <code>BaseEntityArgumentsProvider</code> class?</p>\n",
    "tags" : [ "java", "generics", "junit-jupiter", "parameterized-unit-test", "parameterized-tests" ],
    "owner" : {
      "account_id" : 130873,
      "reputation" : 22419,
      "user_id" : 330457,
      "user_type" : "registered",
      "accept_rate" : 82,
      "profile_image" : "https://i.sstatic.net/2JN6W.jpg?s=256",
      "display_name" : "Jin Kwon",
      "link" : "https://stackoverflow.com/users/330457/jin-kwon"
    },
    "is_answered" : true,
    "view_count" : 89,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1751366641,
    "creation_date" : 1751336269,
    "link" : "https://stackoverflow.com/questions/79685452/how-can-i-get-the-actual-type-from-a-generic-type-parameter",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79685917,
    "question_id" : 79685452,
    "body" : "<p>Given you have parent:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class BaseEntity&lt;SELF&gt; {\n}\n</code></pre>\n<p>Then you have a child:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class ChildEntity extends BaseEntity&lt;ChildEntity&gt; {\n}\n</code></pre>\n<p>Then you can have such abstract test:</p>\n<pre class=\"lang-java prettyprint-override\"><code>abstract class ParentTest&lt;SELF extends BaseEntity&lt;SELF&gt;&gt; {\n  @Test\n  void test() {\n    assertEquals(ChildEntity.class,\n        ((ParameterizedType) getClass().getGenericSuperclass())\n        .getActualTypeArguments()[0]);\n  }\n}\n</code></pre>\n<p>And its concrete child:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class ChildTest extends ParentTest&lt;ChildEntity&gt; {\n}\n</code></pre>\n<hr />\n<p>So the key part here is to use reflection to have a type of a generic:</p>\n<pre class=\"lang-java prettyprint-override\"><code>((ParameterizedType) getClass().getGenericSuperclass())\n        .getActualTypeArguments()[0]\n</code></pre>\n<p>Explanation:</p>\n<ol>\n<li><p>child gets its superclass: <code>var genericSuperclass = (ParameterizedType) getClass().getGenericSuperclass()</code>;</p>\n</li>\n<li><p>child gets the type of the first generic:\n<code>genericSuperclass.getActualTypeArguments()[0]</code>.</p>\n</li>\n</ol>\n<hr />\n<p>UPD: you can also extract this magic-like reflection logic to an utils class:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class GenericsUtils {\n  public static Class&lt;?&gt; getGenericType(Object object) {\n    return (Class&lt;?&gt;) ((ParameterizedType) object.getClass().getGenericSuperclass())\n        .getActualTypeArguments()[0];\n  }\n}\n</code></pre>\n<p>So you would have this test body:</p>\n<pre class=\"lang-java prettyprint-override\"><code>assertEquals(ChildEntity.class, GenericsUtils.getGenericType(this));\n</code></pre>\n<p>Source:</p>\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/1901164/get-type-of-a-generic-parameter-in-java-with-reflection\">Get type of a generic parameter in Java with reflection</a>.</li>\n</ul>\n",
    "score" : 2,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 40864244,
      "reputation" : 632,
      "user_id" : 30001713,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/f59ea01a76709335047f0cee269d788e?s=256&d=identicon&r=PG",
      "display_name" : "biggujo",
      "link" : "https://stackoverflow.com/users/30001713/biggujo"
    },
    "creation_date" : 1751366331,
    "last_activity_date" : 1751366641,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140555398,
    "post_id" : 79685452,
    "body" : "What is <code>Entity</code>? There is no declaration for this type. Is it supposed to be <code>ENTITY</code>? And how is the final field initialized? And what “actual type” are you expecting? You have not shown any example of an actual type.",
    "score" : 2,
    "owner" : {
      "account_id" : 3211603,
      "reputation" : 301001,
      "user_id" : 2711488,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/t2hoD.jpg?s=256",
      "display_name" : "Holger",
      "link" : "https://stackoverflow.com/users/2711488/holger"
    },
    "creation_date" : 1751365732,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140554690,
    "post_id" : 79685452,
    "body" : "Because of ParameterDeclaration::getParameterType return the type you declared, try <code>getClass()</code> instead.",
    "score" : 0,
    "owner" : {
      "account_id" : 24468215,
      "reputation" : 96,
      "user_id" : 18388293,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/a-/AOh14GjMUqgQEP4Q9yKVvFFg0A1LIu0RP0VYPDJHQI1PLA=k-s256",
      "display_name" : "Anthony Nguyen",
      "link" : "https://stackoverflow.com/users/18388293/anthony-nguyen"
    },
    "creation_date" : 1751344252,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}