{
  "question" : {
    "question_id" : 79818320,
    "title" : "Spring Boot 3.3 migration. Cannot resolve reference to bean jpaSharedEM_entityManagerFactory",
    "body" : "<p>I'm migrating from Spring Boot 2.7 to Spring Boot 3.3.13. This means that I'm migrating even from Hibernate 5 to Hibernate 6.\nI'm having an annoying problem when I start my Spring Application about the configuration of my database configuration classes.</p>\n<p>This is my one of my database configuration classes that i had on Spring Boot 2.7 (I censored package sensible names):</p>\n<pre><code>package ***.datasource;\n\nimport org.springframework.beans.factory.annotation.Value;\nimport org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;\nimport org.springframework.boot.context.properties.ConfigurationProperties;\nimport org.springframework.boot.jdbc.DataSourceBuilder;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.orm.jpa.JpaTransactionManager;\nimport org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean;\nimport org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter;\nimport org.springframework.transaction.PlatformTransactionManager;\n\nimport jakarta.persistence.EntityManagerFactory;\nimport javax.sql.DataSource;\nimport java.util.HashMap;\n\n/**\n * &lt;p&gt;\n * Data source configuration for Anag Database.\n *\n */\n\n@Configuration   \n@ConditionalOnProperty(prefix = &quot;spring.anag.datasource&quot;, name = &quot;url&quot;)\npublic class AnagSourceConfiguration {\n\n    @Value(&quot;${spring.anag.hibernate.hbm2ddl.auto:validate}&quot;)\n    private String hibernateHbm2ddlAuto;\n\n    @Value(&quot;${hibernate.dialect}&quot;)\n    private String hibernateDialect;\n\n    @Bean(name = &quot;anagDataSource&quot;)\n    @ConfigurationProperties(&quot;spring.anag.datasource&quot;)\n    public DataSource anagDataSource() {return DataSourceBuilder.create().build();\n    }\n\n    @Bean(name = &quot;anagEntityManagerFactory&quot;)\n    public LocalContainerEntityManagerFactoryBean anagEntityManagerFactory() {\n       LocalContainerEntityManagerFactoryBean em = new LocalContainerEntityManagerFactoryBean();\n       em.setDataSource(anagDataSource());\n       em.setPackagesToScan(&quot;***.entity.anag&quot;);\n       HibernateJpaVendorAdapter vendorAdapter = new HibernateJpaVendorAdapter();\n       em.setJpaVendorAdapter(vendorAdapter);\n       final HashMap&lt;String, Object&gt; properties = new HashMap&lt;&gt;();\n       properties.put(&quot;hibernate.hbm2ddl.auto&quot;, hibernateHbm2ddlAuto);\n       properties.put(&quot;hibernate.dialect&quot;, hibernateDialect);\n       em.setJpaPropertyMap(properties);\n       return em;\n    }\n\n    @Bean(name = &quot;anagTransactionManager&quot;)\n    public PlatformTransactionManager jpaTransactionManager(EntityManagerFactory anagEntityManagerFactory) {\n       return new JpaTransactionManager(anagEntityManagerFactory);\n    }\n}\n</code></pre>\n<p>I manage to update something for the migration: I replaced every javax use with jakarta excluding the DataSource class since it seems a jakarta counterpart doesen't exists. Then, I added the Hibernate dialect on the properties and I replaced &quot;jdbc-url&quot; with &quot;url&quot; on ConditionalProperty name. Did same on yaml file of course.</p>\n<p>Then, this is my repositories configuration class:</p>\n<pre><code>package ***.config;\n\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.data.jpa.repository.config.EnableJpaRepositories;\n\n\n@Configuration\n@EnableJpaRepositories(\n       basePackages = &quot;***.repositories.anag&quot;,\n       entityManagerFactoryRef = &quot;anagEntityManagerFactory&quot;,\n       transactionManagerRef = &quot;anagTransactionManager&quot;\n)\npublic class AnagRepositoriesConfig {\n}\n</code></pre>\n<p>I dont think I have to change something here.</p>\n<p>Now, I'm having this error when I start my application:</p>\n<pre><code>Error creating bean with name 'delegatorFilter' defined in file [C:\\\\Users\\\\***\\\\config\\\\DelegatorFilter.class]: Unsatisfied dependency expressed through constructor parameter 2: Error creating bean with name 'userDelegationService' defined in file [C:\\\\**\\\\service\\\\UserDelegationService.class]: Unsatisfied dependency expressed through constructor parameter 0: Error creating bean with name 'userAccountDelegationRepository' defined in **.repositories.anag.UserAccountDelegationRepository defined in @EnableJpaRepositories declared on AnagRepositoriesConfig: Cannot resolve reference to bean 'jpaSharedEM_anagEntityManagerFactory' while setting bean property\n\n\nParameter 0 of constructor in **.service.UserDelegationService required a bean named 'anagEntityManagerFactory' that could not be found.\\r\\n\\r\\n\\r\\nAction:\\r\\n\\r\\nConsider defining a bean named 'anagEntityManagerFactory' in your configuration\n</code></pre>\n<p>This part is pretty strange:  Cannot resolve reference to bean 'jpaSharedEM_anagEntityManagerFactory. It seems a strange concatenation name with jpaSharedEm_ and my bean anagEntityManagerFactory. Why Spring search this bean name? I have to change some name configuration?</p>\n<p>I don't think the problem depends from my UserAccountDelegationRepository. This is just the first repository that Spring met when the application starts. I changed the order declaration of repositories on the service and I meet this problem even for other repositories.</p>\n<p>Someone met this problem? I see here there are some question about this same problem but I didn't find any relevant answer. I did all the best practices to migrate to Spring Boot 3. There are no more javax on code and I even removed every dependency. Can someone help me?</p>\n<p>This is my yaml config about anag datasource:</p>\n<pre><code>spring:\n  anag:\n    datasource:\n      url: &quot;jdbc:mysql://xxxxxxxx:3306/anag?useUnicode=true&amp;useJDBCCompliantTimezoneShift=true&amp;useLegacyDatetimeCode=false&amp;serverTimezone=UTC&amp;tinyInt1isBit=false&amp;useSSL=false&quot;\n      driver-class-name: com.mysql.cj.jdbc.Driver\n      username: xxxxxxxx\n      password: xxxxxxxx\n    hibernate:\n      hbm2ddl:\n        auto: validate\n</code></pre>\n",
    "tags" : [ "java", "spring-boot", "hibernate" ],
    "owner" : {
      "account_id" : 5178848,
      "reputation" : 5,
      "user_id" : 4145112,
      "user_type" : "registered",
      "accept_rate" : 12,
      "profile_image" : "https://www.gravatar.com/avatar/85a447bfcf15f47e4764fe2944fe7c91?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Removed",
      "link" : "https://stackoverflow.com/users/4145112/removed"
    },
    "is_answered" : false,
    "view_count" : 121,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1763176017,
    "creation_date" : 1762988978,
    "link" : "https://stackoverflow.com/questions/79818320/spring-boot-3-3-migration-cannot-resolve-reference-to-bean-jpasharedem-entityma",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79819951,
    "question_id" : 79818320,
    "body" : "<p>For information on using non-default Datasource settings, please refer to <a href=\"https://docs.spring.io/spring-boot/how-to/data-access.html#howto.data-access.configure-two-datasources\" rel=\"nofollow noreferrer\">howto.data-access.configure-two-datasources</a></p>\n<p>This is a proof-of-concept test.</p>\n<ul>\n<li><code>application.yaml</code> : remove <code>hibernate: hbm2ddl:</code></li>\n<li><code>AnagSourceConfiguration.java</code> : The main changes are all in this file.</li>\n<li><code>AnagRepositoriesConfig.java</code> :  The file is not required.</li>\n</ul>\n<h1>Database - Docker</h1>\n<pre class=\"lang-bash prettyprint-override\"><code>docker run \\\n    --name my-mysql-temp \\\n    -e MYSQL_ROOT_PASSWORD=Passw0rd! \\\n    -e MYSQL_DATABASE=demodb \\\n    -e MYSQL_USER=demouser \\\n    -e MYSQL_PASSWORD=Passw0rd! \\\n    -p 3306:3306 \\\n    -d \\\n    mysql:8.0.43-debian\n</code></pre>\n<h1>Project Tree</h1>\n<pre class=\"lang-bash prettyprint-override\"><code>demo-mysql-jpa_ST\n├── pom.xml\n├── README.txt\n└── src\n    └── main\n        ├── resources\n        │   └── application.yaml &lt;-- Change\n        └── java\n            └── com\n                └── example\n                    ├── DemoApplication.java\n                    ├── config\n                    │   └── AnagSourceConfiguration.java &lt;-- Change\n                    ├── entity\n                    │   └── anag\n                    │       └── Student.java\n                    ├── repo\n                    │   └── anag\n                    │       └── StudentRepository.java\n                    ├── service\n                    │   └── anag\n                    │       └── StudentService.java\n                    └── controller\n                        └── anag\n                            └── StudentController.java\n</code></pre>\n<h2>pom.xml</h2>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n    xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    &lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;3.5.7&lt;/version&gt;\n        &lt;relativePath/&gt;\n    &lt;/parent&gt;\n    &lt;groupId&gt;com.example&lt;/groupId&gt;\n    &lt;artifactId&gt;demo-mysql-jpa&lt;/artifactId&gt;\n    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n    &lt;name&gt;demo-mysql-jpa&lt;/name&gt;\n    &lt;description&gt;Demo project for Spring Boot&lt;/description&gt;\n    &lt;properties&gt;\n            &lt;maven.compiler.source&gt;17&lt;/maven.compiler.source&gt;\n                &lt;maven.compiler.target&gt;17&lt;/maven.compiler.target&gt;\n                &lt;maven.compiler.encoding&gt;UTF-8&lt;/maven.compiler.encoding&gt;\n                &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\n                &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;\n    &lt;/properties&gt;\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.mysql&lt;/groupId&gt;\n            &lt;artifactId&gt;mysql-connector-j&lt;/artifactId&gt;\n            &lt;scope&gt;runtime&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;\n            &lt;artifactId&gt;lombok&lt;/artifactId&gt;\n            &lt;optional&gt;true&lt;/optional&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n    &lt;build&gt;\n    &lt;finalName&gt;app&lt;/finalName&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\n                &lt;configuration&gt;\n                    &lt;annotationProcessorPaths&gt;\n                        &lt;path&gt;\n                            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;\n                            &lt;artifactId&gt;lombok&lt;/artifactId&gt;\n                        &lt;/path&gt;\n                    &lt;/annotationProcessorPaths&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n                &lt;configuration&gt;\n                    &lt;excludes&gt;\n                        &lt;exclude&gt;\n                            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;\n                            &lt;artifactId&gt;lombok&lt;/artifactId&gt;\n                        &lt;/exclude&gt;\n                    &lt;/excludes&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n&lt;/project&gt;\n</code></pre>\n<h2>application.yaml</h2>\n<ul>\n<li>remove <code>hibernate: hbm2ddl:</code></li>\n</ul>\n<pre class=\"lang-yaml prettyprint-override\"><code>spring:\n  application:\n    name: demo-mysql-jpa\n  datasource:\n    url: jdbc:mysql://localhost:3306/firstdb\n    username: firstuser\n    password: Passw0rd1\n    driver-class-name: com.mysql.cj.jdbc.Driver\n  jpa:\n    hibernate:\n      ddl-auto: update\n    show-sql: true\n  anag:\n    datasource:\n      url: jdbc:mysql://localhost:3306/demodb\n      driver-class-name: com.mysql.cj.jdbc.Driver\n      username: demouser\n      password: Passw0rd!\n    jpa:\n      hibernate:\n        ddl-auto: update\n      show-sql: true\n</code></pre>\n<h2>DemoApplication.java</h2>\n<pre class=\"lang-java prettyprint-override\"><code>package com.example;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\n\n@SpringBootApplication\npublic class DemoApplication {\n    public static void main(String[] args) {\n        SpringApplication.run(DemoApplication.class, args);\n    }\n}\n</code></pre>\n<h2>AnagSourceConfiguration.java</h2>\n<p>The main changes are all in this file.</p>\n<pre class=\"lang-java prettyprint-override\"><code>package com.example.config;\n\nimport com.zaxxer.hikari.HikariDataSource;\nimport jakarta.persistence.EntityManagerFactory;\nimport org.springframework.beans.factory.annotation.Qualifier;\nimport org.springframework.boot.autoconfigure.jdbc.DataSourceProperties;\nimport org.springframework.boot.context.properties.ConfigurationProperties;\nimport org.springframework.boot.orm.jpa.EntityManagerFactoryBuilder;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.data.jpa.repository.config.EnableJpaRepositories;\nimport org.springframework.orm.jpa.JpaTransactionManager;\nimport org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean;\nimport org.springframework.transaction.PlatformTransactionManager;\n\nimport javax.sql.DataSource;\n\n//@Configuration\n//@ConditionalOnProperty(prefix = &quot;spring.anag.datasource&quot;, name = &quot;url&quot;)\n@Configuration(proxyBeanMethods = false)\n@EnableJpaRepositories(\n        basePackages = &quot;com.example.repo.anag&quot;,\n        entityManagerFactoryRef = &quot;anagEntityManagerFactory&quot;,\n        transactionManagerRef = &quot;anagTransactionManager&quot;\n)\npublic class AnagSourceConfiguration {\n\n/*\n    @Value(&quot;${spring.anag.hibernate.hbm2ddl.auto:validate}&quot;)\n    private String hibernateHbm2ddlAuto;\n\n    @Value(&quot;${hibernate.dialect}&quot;)\n    private String hibernateDialect;\n*/\n\n/*\n    @Bean(name = &quot;anagDataSource&quot;)\n    @ConfigurationProperties(&quot;spring.anag.datasource&quot;)\n    public DataSource anagDataSource() {return DataSourceBuilder.create().build();\n    }\n*/\n\n    // 1- DataSourceProperties binding YAML\n    @Bean\n    @ConfigurationProperties(&quot;spring.anag.datasource&quot;)\n    public DataSourceProperties anagDataSourceProperties() {\n        return new DataSourceProperties();\n    }\n\n    // 2- create HikariDataSource\n    @Bean\n    @ConfigurationProperties(&quot;anag.datasource.configuration&quot;)\n    public HikariDataSource anagDataSource(\n            @Qualifier(&quot;anagDataSourceProperties&quot;) DataSourceProperties properties) {\n        return properties.initializeDataSourceBuilder()\n                .type(HikariDataSource.class)\n                .build();\n    }\n\n/*\n    @Bean(name = &quot;anagEntityManagerFactory&quot;)\n    public LocalContainerEntityManagerFactoryBean anagEntityManagerFactory() {\n       LocalContainerEntityManagerFactoryBean em = new LocalContainerEntityManagerFactoryBean();\n       em.setDataSource(anagDataSource());\n       em.setPackagesToScan(&quot;com.example.entity.anag&quot;);\n       HibernateJpaVendorAdapter vendorAdapter = new HibernateJpaVendorAdapter();\n       em.setJpaVendoimport com.zaxxer.hikari.HikariDataSource;\n       final HashMap&lt;String, Object&gt; properties = new HashMap&lt;&gt;();\n       properties.put(&quot;hibernate.hbm2ddl.auto&quot;, hibernateHbm2ddlAuto);\n       properties.put(&quot;hibernate.dialect&quot;, hibernateDialect);\n       em.setJpaPropertyMap(properties);\n       return em;\n    }\n*/\n    // 3- EntityManagerFactory binding DataSource + JPA properties\n    @Bean(name = &quot;anagEntityManagerFactory&quot;)\n    public LocalContainerEntityManagerFactoryBean anagEntityManagerFactory(\n            EntityManagerFactoryBuilder builder,\n            @Qualifier(&quot;anagDataSource&quot;) DataSource anagDataSource) {\n        return builder\n                .dataSource(anagDataSource)\n                .packages(&quot;com.example.entity.anag&quot;) // entity package\n                .persistenceUnit(&quot;anag&quot;)\n                .build();\n    }\n\n/*\n    @Bean(name = &quot;anagTransactionManager&quot;)\n    public PlatformTransactionManager jpaTransactionManager(EntityManagerFactory anagEntityManagerFactory) {\n       return new JpaTransactionManager(anagEntityManagerFactory);\n    }\n*/\n\n    // 4- TransactionManager\n    @Bean(name = &quot;anagTransactionManager&quot;)\n    public PlatformTransactionManager anagTransactionManager(\n            @Qualifier(&quot;anagEntityManagerFactory&quot;) EntityManagerFactory emf) {\n        return new JpaTransactionManager(emf);\n    }\n}\n</code></pre>\n<p>The <code>AnagRepositoriesConfig.java</code> file is not required.</p>\n<h2>Student.java</h2>\n<pre class=\"lang-java prettyprint-override\"><code>package com.example.entity.anag;\n\nimport jakarta.persistence.*;\nimport lombok.AllArgsConstructor;\nimport lombok.Builder;\nimport lombok.Data;\nimport lombok.NoArgsConstructor;\n\nimport java.time.LocalDate;\n\n@Data\n@NoArgsConstructor\n@AllArgsConstructor\n@Builder\n@Entity\n@Table(name = &quot;student&quot;)\npublic class Student {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Integer id;\n\n    @Column(length = 100, nullable = false)\n    private String name;\n\n    @Column(name = &quot;birth_date&quot;)\n    private LocalDate birthDate;\n\n    @Column(length = 100)\n    private String email;\n\n    @Column(length = 2)\n    private String grade;\n\n    @Column(name = &quot;enrollment_date&quot;)\n    private LocalDate enrollmentDate;\n}\n</code></pre>\n<h2>StudentRepository.java</h2>\n<pre class=\"lang-java prettyprint-override\"><code>package com.example.repo.anag;\n\nimport com.example.entity.anag.Student;\nimport org.springframework.data.jpa.repository.JpaRepository;\n\nimport java.util.List;\n\npublic interface StudentRepository extends JpaRepository&lt;Student, Integer&gt; {\n    List&lt;Student&gt; findByName(String name);\n}\n</code></pre>\n<h2>StudentService.java</h2>\n<pre class=\"lang-java prettyprint-override\"><code>package com.example.service.anag;\n\nimport com.example.entity.anag.Student;\nimport com.example.repo.anag.StudentRepository;\nimport lombok.RequiredArgsConstructor;\nimport org.springframework.stereotype.Service;\nimport org.springframework.transaction.annotation.Transactional;\n\nimport java.util.List;\nimport java.util.Optional;\n\n@Service\n@RequiredArgsConstructor\n@Transactional(transactionManager = &quot;anagTransactionManager&quot;)\npublic class StudentService {\n\n    private final StudentRepository repo;\n\n    public List&lt;Student&gt; listAll() {\n        return repo.findAll();\n    }\n\n    public Optional&lt;Student&gt; findById(Integer id) {\n        return repo.findById(id);\n    }\n\n    public List&lt;Student&gt; findByName(String name) {\n        return repo.findByName(name);\n    }\n\n    public Student create(Student student) {\n        return repo.save(student);\n    }\n\n    public Student update(Integer id, Student student) {\n        return repo.findById(id)\n                .map(s -&gt; {\n                    s.setName(student.getName());\n                    s.setBirthDate(student.getBirthDate());\n                    s.setEmail(student.getEmail());\n                    s.setGrade(student.getGrade());\n                    s.setEnrollmentDate(student.getEnrollmentDate());\n                    return repo.save(s);\n                })\n                .orElseThrow(() -&gt; new RuntimeException(&quot;Student ID not found: &quot; + id));\n    }\n\n    public void delete(Integer id) {\n        repo.deleteById(id);\n    }\n}\n</code></pre>\n<h2>StudentController.java</h2>\n<pre class=\"lang-java prettyprint-override\"><code>package com.example.controller.anag;\n\nimport com.example.entity.anag.Student;\nimport com.example.service.anag.StudentService;\nimport lombok.RequiredArgsConstructor;\nimport org.springframework.web.bind.annotation.*;\n\nimport java.util.List;\n\n@RestController\n@RequiredArgsConstructor\n@RequestMapping(&quot;/api/anag/students&quot;)\npublic class StudentController {\n\n    private final StudentService service;\n\n    @GetMapping\n    public List&lt;Student&gt; listAll() {\n        return service.listAll();\n    }\n\n    @GetMapping(&quot;/{id}&quot;)\n    public Student findById(@PathVariable Integer id) {\n        return service.findById(id).orElse(null);\n    }\n\n    @GetMapping(&quot;/name/{name}&quot;)\n    public List&lt;Student&gt; findByName(@PathVariable String name) {\n        return service.findByName(name);\n    }\n\n    // CREATE\n    @PostMapping\n    public Student create(@RequestBody Student student) {\n        return service.create(student);\n    }\n\n    // UPDATE\n    @PutMapping(&quot;/{id}&quot;)\n    public Student update(@PathVariable Integer id, @RequestBody Student student) {\n        return service.update(id, student);\n    }\n\n    // DELETE\n    @DeleteMapping(&quot;/{id}&quot;)\n    public void delete(@PathVariable Integer id) {\n        service.delete(id);\n    }\n}\n</code></pre>\n<h1>Build</h1>\n<pre class=\"lang-bash prettyprint-override\"><code>mvn clean package\n</code></pre>\n<h1>Run</h1>\n<pre class=\"lang-bash prettyprint-override\"><code>java -jar target/app.jar\n</code></pre>\n<h1>Test</h1>\n<h2>Create</h2>\n<pre class=\"lang-bash prettyprint-override\"><code>curl -X POST http://localhost:8080/api/anag/students \\\n-H &quot;Content-Type: application/json&quot; \\\n-d '{\n  &quot;name&quot;: &quot;Alice&quot;,\n  &quot;birthDate&quot;: &quot;2005-05-20&quot;,\n  &quot;email&quot;: &quot;alice@example.com&quot;,\n  &quot;grade&quot;: &quot;A&quot;,\n  &quot;enrollmentDate&quot;: &quot;2023-09-01&quot;\n}'\n</code></pre>\n<h2>List All</h2>\n<pre class=\"lang-bash prettyprint-override\"><code>curl http://localhost:8080/api/anag/students\n</code></pre>\n<h2>Update</h2>\n<pre class=\"lang-bash prettyprint-override\"><code>curl -X PUT http://localhost:8080/api/anag/students/1 \\\n-H &quot;Content-Type: application/json&quot; \\\n-d '{\n  &quot;name&quot;: &quot;AliceUpdated&quot;,\n  &quot;birthDate&quot;: &quot;2005-05-20&quot;,\n  &quot;email&quot;: &quot;alice_new@example.com&quot;,\n  &quot;grade&quot;: &quot;A&quot;,\n  &quot;enrollmentDate&quot;: &quot;2023-09-01&quot;\n}'\n</code></pre>\n<h2>Read Id: 1</h2>\n<pre class=\"lang-bash prettyprint-override\"><code>curl http://localhost:8080/api/anag/students/1\n</code></pre>\n<h2>Read Name is <code>AliceUpdated</code></h2>\n<pre class=\"lang-bash prettyprint-override\"><code>curl http://localhost:8080/api/anag/students/name/AliceUpdated\n</code></pre>\n<h2>Delete Id: 1</h2>\n<pre class=\"lang-bash prettyprint-override\"><code>curl -X DELETE http://localhost:8080/api/anag/students/1\n</code></pre>\n",
    "score" : 0,
    "is_accepted" : false,
    "owner" : {
      "account_id" : 26698569,
      "reputation" : 4090,
      "user_id" : 20306007,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/98bbc403493aee3681b71dae7abef66e?s=256&d=identicon&r=PG",
      "display_name" : "life888888",
      "link" : "https://stackoverflow.com/users/20306007/life888888"
    },
    "creation_date" : 1763118382,
    "last_activity_date" : 1763176017,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140857728,
    "post_id" : 79818320,
    "body" : "Finally we managed to find a solution. Seems the problem is from Hibernate version 6.5.3 imported from Spring Boot 3.3.13.We had to back to 6.1.4.final version to solve this.I would post an answer but this shitty site doesen&#39;t acceopt my answer anymore. Farewell covo di ciarlatani cornuti.",
    "score" : 0,
    "owner" : {
      "account_id" : 5178848,
      "reputation" : 5,
      "user_id" : 4145112,
      "user_type" : "registered",
      "accept_rate" : 12,
      "profile_image" : "https://www.gravatar.com/avatar/85a447bfcf15f47e4764fe2944fe7c91?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Removed",
      "link" : "https://stackoverflow.com/users/4145112/removed"
    },
    "creation_date" : 1763369354,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140852532,
    "post_id" : 79818320,
    "body" : "I added the configuration about anag datasource on my question. From Spring 2.7 i only edited &quot;jdbc-url&quot; into &quot;url&quot; as i did on my configuration class.",
    "score" : 0,
    "owner" : {
      "account_id" : 5178848,
      "reputation" : 5,
      "user_id" : 4145112,
      "user_type" : "registered",
      "accept_rate" : 12,
      "profile_image" : "https://www.gravatar.com/avatar/85a447bfcf15f47e4764fe2944fe7c91?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Removed",
      "link" : "https://stackoverflow.com/users/4145112/removed"
    },
    "creation_date" : 1763042705,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140852413,
    "post_id" : 79818320,
    "body" : "Please add the relevant application.yaml config to the question. It is quite clear the conditionalonproperty is involved in the issue and the easiest answer to why things are going wrong is that the property does not exist at runtime. I find the name &quot;spring.anag.datasource&quot; very suspicious. I&#39;m pretty sure Spring does not have properties for your application so either there is a typo here, or you are kind of illegally defining your own properties under the &quot;spring&quot; heading.",
    "score" : 0,
    "owner" : {
      "account_id" : 187094,
      "reputation" : 5301,
      "user_id" : 424903,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/8oHZF.png?s=256",
      "display_name" : "Gimby",
      "link" : "https://stackoverflow.com/users/424903/gimby"
    },
    "creation_date" : 1763039680,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140852370,
    "post_id" : 79818320,
    "body" : "<i>&quot; excluding the DataSource class since it seems a jakarta counterpart doesen&#39;t exists&quot;</i> - that&#39;s because it&#39;s not part of JavaEE/JakartaEE. Just as an FYI for any future upgrade work, just because a package has javax in it does not necessarily imply that it needs to be replaced. It&#39;s relatively easy to know which dependencies are involved, as they are basically all under the umbrella <a href=\"https://mvnrepository.com/artifact/jakarta.platform/jakarta.jakartaee-api/10.0.0\" rel=\"nofollow noreferrer\">JakartaEE dependency</a>. It&#39;s a good guideline.",
    "score" : 0,
    "owner" : {
      "account_id" : 187094,
      "reputation" : 5301,
      "user_id" : 424903,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/8oHZF.png?s=256",
      "display_name" : "Gimby",
      "link" : "https://stackoverflow.com/users/424903/gimby"
    },
    "creation_date" : 1763037997,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140852012,
    "post_id" : 79818320,
    "body" : "Yes i have that in my yaml file.  anag:     datasource:       jdbc-url: &quot;jdbc:mysql://xxxxxxxx:3306/anag?useUnicode=true&amp;useJDBCComp&zwnj;&#8203;liantTimezoneShift=t&zwnj;&#8203;rue&amp;useLegacyDatetim&zwnj;&#8203;eCode=false&amp;serverTi&zwnj;&#8203;mezone=UTC&amp;tinyInt1i&zwnj;&#8203;sBit=false&amp;useSSL=fa&zwnj;&#8203;lse&quot;       driver-class-name: com.mysql.cj.jdbc.Driver       username: xxxxxxxx       password: xxxxxxxx     hibernate:       hbm2ddl:         auto: validate",
    "score" : 0,
    "owner" : {
      "account_id" : 5178848,
      "reputation" : 5,
      "user_id" : 4145112,
      "user_type" : "registered",
      "accept_rate" : 12,
      "profile_image" : "https://www.gravatar.com/avatar/85a447bfcf15f47e4764fe2944fe7c91?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Removed",
      "link" : "https://stackoverflow.com/users/4145112/removed"
    },
    "creation_date" : 1763025921,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140852005,
    "post_id" : 79818320,
    "body" : "Do you have proper datasource.url property in .properties file?",
    "score" : 0,
    "owner" : {
      "account_id" : 17553626,
      "reputation" : 521,
      "user_id" : 12733532,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/-EAww28wDCxk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcgKS9dXdmUh-hOQPlZYZygBUfLwQ/s256-rj/photo.jpg",
      "display_name" : "Max",
      "link" : "https://stackoverflow.com/users/12733532/max"
    },
    "creation_date" : 1763025747,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140851956,
    "post_id" : 79818320,
    "body" : "Tried just now but i have same error. I tried a trick naming my bean jpaSharedEM_anagEntityManagerFactory but it didn&#39;t work.",
    "score" : 0,
    "owner" : {
      "account_id" : 5178848,
      "reputation" : 5,
      "user_id" : 4145112,
      "user_type" : "registered",
      "accept_rate" : 12,
      "profile_image" : "https://www.gravatar.com/avatar/85a447bfcf15f47e4764fe2944fe7c91?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Removed",
      "link" : "https://stackoverflow.com/users/4145112/removed"
    },
    "creation_date" : 1763024053,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140851925,
    "post_id" : 79818320,
    "body" : "Probably conflict with configs. Tried to exclude? @SpringBootApplication(exclude = {     HibernateJpaAutoConfiguration.class,     JpaRepositoriesAutoConfiguration.class })",
    "score" : 0,
    "owner" : {
      "account_id" : 17553626,
      "reputation" : 521,
      "user_id" : 12733532,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/-EAww28wDCxk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcgKS9dXdmUh-hOQPlZYZygBUfLwQ/s256-rj/photo.jpg",
      "display_name" : "Max",
      "link" : "https://stackoverflow.com/users/12733532/max"
    },
    "creation_date" : 1763023322,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140851919,
    "post_id" : 79818320,
    "body" : "Yes sorry. I already wrote ConditionalOnProperty . Just made a mess with copy paste here.",
    "score" : 0,
    "owner" : {
      "account_id" : 5178848,
      "reputation" : 5,
      "user_id" : 4145112,
      "user_type" : "registered",
      "accept_rate" : 12,
      "profile_image" : "https://www.gravatar.com/avatar/85a447bfcf15f47e4764fe2944fe7c91?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "Removed",
      "link" : "https://stackoverflow.com/users/4145112/removed"
    },
    "creation_date" : 1763023086,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140851557,
    "post_id" : 79818320,
    "body" : "Did you try to use ConditionalOnProperty instead of ConditionalProperty from import org.springframework.boot.autoconfigure.condition.Conditional&zwnj;&#8203;OnProperty; ?",
    "score" : 0,
    "owner" : {
      "account_id" : 10463559,
      "reputation" : 2718,
      "user_id" : 7713562,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/JhIYm.png?s=256",
      "display_name" : "zawarudo",
      "link" : "https://stackoverflow.com/users/7713562/zawarudo"
    },
    "creation_date" : 1763001678,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}