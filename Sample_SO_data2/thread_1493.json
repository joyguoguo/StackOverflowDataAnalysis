{
  "question" : {
    "question_id" : 79704010,
    "title" : "Cannot retrieve more results using ListJobRunsRequest due to invalid token",
    "body" : "<p>Using EMR serverless client, I'm retrieving job runs for a specific application. The maximum fetch size set by AWS is 50, hence I need to perform further calls, providing a token which is taken from the response. However, regardless of the limit, usage of the token for the next request always fails due to &quot;software.amazon.awssdk.services.emrserverless.model.ValidationException: Invalid token encountered&quot;.</p>\n<pre><code>    try (var client = EmrServerlessClient.builder().region(AwsUtils.getRegion()).build()) {\n      String token = null;\n      do {\n        var builder = ListJobRunsRequest.builder()\n            .maxResults(MAX_RESULTS)\n            .applicationId(applicationId)\n            .createdAtAfter(Instant.now().minus(days, ChronoUnit.DAYS));\n        if (token != null) {\n          builder.nextToken(token);\n        }\n        if (status != null) {\n          builder.states(status);\n        }\n\n        var response = client.listJobRuns(builder.build());\n        jobRuns.addAll(response.jobRuns());\n        token = response.nextToken();\n      } while (token != null);\n    }\n</code></pre>\n<p>The first batch/page of results is always retrieved successfully but further request with token always fail. Here is a sample token I got from the response which is deemed invalid in following request:</p>\n<pre><code>AAMA-EFRSURBSGdDanhVdTVFaVc4aDRkcE5QKzBkOVFEaFRzUFNtUHloQU9Pa2FRL1dFalVRR25aT2xoTVdtQU5UakY5elhKZ0NSQkFBQUFmakI4QmdrcWhraUc5dzBCQndhZ2J6QnRBZ0VBTUdnR0NTcUdTSWIzRFFFSEFUQWVCZ2xnaGtnQlpRTUVBUzR3RVFRTVJMUHFDUTVtc0hwaW5yejNBZ0VRZ0RzbUpFNzBnamtleWVBMDRDOWFYU1FzV2NhZUF3RkNvYWRUbWdoR21NMEtjZHA1dHZaZDJvcFFyZndZRW5wK3U5WEdiTW1JaXdJWDYxOGlzZz09S9CrYd6s9RZvUvvvsyUsAkySOxDk0wdDlJxBXBYhktRauhpGcNpvT4Z2KWf1QdPTC8QIGKTS-Ew2r8Phnwfr7U6xYiereRpJvN7sVLZaAN_UOefwsuzHnyChB-QNPTYYxWsP-_lgR76BYhLMwVgRPZrN112TZ9kksR-5iezObRKk3IVWOjWxisHiuEsrm7ybZJSNJUtO8V5xwXf2zMMRwLwlp82YAfgu9sCtVZ0Ma0xVKxORyNsSw5GeeZq6CbqskMTRTggICI7e5ke78--5fpzoR4HTs2tWtDDpzJ2Yr5lIzbcgL4qOPk73RiFKATL9eDFnzapGBqMkkiRP-kUO3hqxfeqEFmZBXAzG5BlgDJOp18xrm-TNk7KZ6g6rAUUdPHJB00rFVP72ihZoWv2HlJ38M7y1xCepwbj9IH9VboDGjasf_q8HBpsnZxrRjUWlgc3mfd7FBPozbt0mFnQ0cDVJDkfkl23SATJEIA==\n</code></pre>\n",
    "tags" : [ "java", "aws-sdk" ],
    "owner" : {
      "account_id" : 43069038,
      "reputation" : 3,
      "user_id" : 31058515,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/9b3000fce6b55177fc3a351b7274a60e?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "user31058515",
      "link" : "https://stackoverflow.com/users/31058515/user31058515"
    },
    "is_answered" : true,
    "view_count" : 56,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1752713592,
    "creation_date" : 1752698898,
    "link" : "https://stackoverflow.com/questions/79704010/cannot-retrieve-more-results-using-listjobrunsrequest-due-to-invalid-token",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79704169,
    "question_id" : 79704010,
    "body" : "<p>Perhaps you can try the paginator.</p>\n<p><a href=\"https://sdk.amazonaws.com/java/api/latest/software/amazon/awssdk/services/emrserverless/EmrServerlessClient.html#listJobRunsPaginator(software.amazon.awssdk.services.emrserverless.model.ListJobRunsRequest)\" rel=\"nofollow noreferrer\">https://sdk.amazonaws.com/java/api/latest/software/amazon/awssdk/services/emrserverless/EmrServerlessClient.html#listJobRunsPaginator(software.amazon.awssdk.services.emrserverless.model.ListJobRunsRequest)</a></p>\n",
    "score" : 0,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 6492737,
      "reputation" : 16,
      "user_id" : 10095310,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/fa5bda4308f5c2859115679d6dd6dd64?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name" : "James",
      "link" : "https://stackoverflow.com/users/10095310/james"
    },
    "creation_date" : 1752713592,
    "last_activity_date" : 1752713592,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ {
    "comment_id" : 140595379,
    "post_id" : 79704010,
    "body" : "SDK V2 supports automatic pagination (<a href=\"https://docs.aws.amazon.com/sdk-for-java/latest/developer-guide/pagination.html\" rel=\"nofollow noreferrer\">docs.aws.amazon.com/sdk-for-java/latest/developer-guide/&hellip;</a>), why are you doing this at all? If you <b>really</b> need to reinvent the wheel, scroll down to &quot;Manual pagination&quot; section - it seems to use different methods...",
    "score" : 0,
    "owner" : {
      "account_id" : 13217925,
      "reputation" : 8897,
      "user_id" : 14401160,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/s256-rj/photo.jpg",
      "display_name" : "STerliakov",
      "link" : "https://stackoverflow.com/users/14401160/sterliakov"
    },
    "creation_date" : 1752706334,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : {
    "79704169" : [ {
      "comment_id" : 140597409,
      "post_id" : 79704169,
      "body" : "Seems to have done the trick, though unsure why existing method doesn&#39;t work with token - what is the purpose of having that functionality and document it if it isn&#39;t working. But this is a workable workaround for now.",
      "score" : 0,
      "owner" : {
        "account_id" : 43069038,
        "reputation" : 3,
        "user_id" : 31058515,
        "user_type" : "registered",
        "profile_image" : "https://www.gravatar.com/avatar/9b3000fce6b55177fc3a351b7274a60e?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name" : "user31058515",
        "link" : "https://stackoverflow.com/users/31058515/user31058515"
      },
      "creation_date" : 1752764927,
      "content_license" : "CC BY-SA 4.0"
    }, {
      "comment_id" : 140595556,
      "post_id" : 79704169,
      "body" : "As itâ€™s currently written, your answer is unclear. Please <a href=\"https://stackoverflow.com/posts/79704169/edit\">edit</a> to add additional details that will help others understand how this addresses the question asked. You can find more information on how to write good answers <a href=\"/help/how-to-answer\">in the help center</a>.",
      "score" : 1,
      "owner" : {
        "account_id" : -1,
        "reputation" : 1,
        "user_id" : -1,
        "user_type" : "moderator",
        "profile_image" : "https://www.gravatar.com/avatar/a007be5a61f6aa8f3e85ae2fc18dd66e?s=256&d=identicon&r=PG",
        "display_name" : "Community",
        "link" : "https://stackoverflow.com/users/-1/community"
      },
      "creation_date" : 1752716191,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}