{
  "question" : {
    "question_id" : 79598084,
    "title" : "How to define a TestConfiguration for TestContainers?",
    "body" : "<p>I have multiple test classes that use the mongo test container. Instead of declaring a container using the same code multiple times, I wanted to create a test configuration, to avoid repetitive code. Here is what I came up with</p>\n<pre><code>@TestConfiguration\n@Testcontainers\npublic class MongoTestContainerConfig {\n\n    @Container\n    @ServiceConnection\n    static final MongoDBContainer MONGO_CONTAINER = new MongoDBContainer(&quot;mongo:6.0&quot;);\n}\n</code></pre>\n<p>However, when I try to run my tests, with this config</p>\n<pre><code>@DataMongoTest\n@Import(MongoTestContainerConfig.class)\nclass ServiceRepositoryTest {\n\n    @Autowired\n    private MongoTemplate mongoTemplate;\n</code></pre>\n<p>It returns the following exception stack trace</p>\n<blockquote>\n<p>[localhost:27017] [                                                 ]\norg.mongodb.driver.cluster               : Exception in monitor thread\nwhile connecting to server localhost:27017\ncom.mongodb.MongoSocketOpenException: Exception opening socket Caused\nby: java.net.ConnectException: Connection refused</p>\n</blockquote>\n<p>When I declare the test container inside of the test class, all works fine.</p>\n<pre><code>@Testcontainers\n@DataMongoTest\nclass CspRepositoryTest {\n\n    @Container\n    @ServiceConnection\n    private static final MongoDBContainer MONGO_CONTAINER = new MongoDBContainer(&quot;mongo:6.0&quot;);\n</code></pre>\n",
    "tags" : [ "java", "spring-boot", "testcontainers" ],
    "owner" : {
      "account_id" : 24520392,
      "reputation" : 145,
      "user_id" : 18433524,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/8cd45953ab076bda76f38626062a0dce?s=256&d=identicon&r=PG",
      "display_name" : "Feldmarshall",
      "link" : "https://stackoverflow.com/users/18433524/feldmarshall"
    },
    "is_answered" : true,
    "view_count" : 100,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1745959747,
    "creation_date" : 1745920657,
    "link" : "https://stackoverflow.com/questions/79598084/how-to-define-a-testconfiguration-for-testcontainers",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79599186,
    "question_id" : 79598084,
    "body" : "<p>declare the testcontainer as abstract class, which you extend by your acutal tests. something like this:</p>\n<pre><code>@Testcontainers\npublic abstract class MongoTestContainerConfig {\n\n    @Container\n    static final MongoDBContainer MONGO_CONTAINER = new MongoDBContainer(&quot;mongo:6.0&quot;);\n}\n\n\n@DataMongoTest\nclass ServiceRepositoryTest extends MongoTestContainerConfig  {\n\n        // access MONGO_CONTAINER from here\n}\n</code></pre>\n",
    "score" : 1,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 11555562,
      "reputation" : 569,
      "user_id" : 8466853,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/cd7f72b426ce3c46739900b8ba014e26?s=256&d=identicon&r=PG",
      "display_name" : "Arno",
      "link" : "https://stackoverflow.com/users/8466853/arno"
    },
    "creation_date" : 1745959747,
    "last_activity_date" : 1745959747,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : { }
}