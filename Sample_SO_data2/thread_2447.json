{
  "question" : {
    "question_id" : 79622209,
    "title" : "When to use Transport.send() vs. sendMessage()",
    "body" : "<p>Jakarta Mail provides two main ways to send email messages:</p>\n<ul>\n<li><code>Transport.send(Message msg)</code>\nThis static method uses the Session associated with the message, opens a connection to the SMTP server, sends the message, and then closes the connection.</li>\n<li><code>transport.sendMessage(Message msg)</code>\nThis instance method uses an existing Transport connection that you manage manually — meaning you open and close it yourself. According to the <a href=\"https://javaee.github.io/javamail/FAQ#send\" rel=\"nofollow noreferrer\">Jakarta Mail FAQ</a>, this is more efficient when sending multiple messages in quick succession, as it avoids the overhead of repeatedly opening and closing connections.</li>\n</ul>\n<p>I'm building an application that occasionally sends large bursts of email (many messages within a few minutes), but also experiences long idle periods (hours with no messages sent)</p>\n<p>Is it safe to keep a Transport connection open indefinitely during the idle periods?</p>\n<p>I see two options:</p>\n<ul>\n<li>Use <code>Transport.send()</code> every time<br />\nSimpler, but reconnecting for every message adds overhead during peak times</li>\n<li>Open a persistent <code>Transport</code> and use <code>sendMessage()</code><br />\nMore efficient for bursts, but I’m concerned the SMTP server may close the connection during inactivity, leading to unexpected failures</li>\n</ul>\n<p>I’d like to use the second approach for performance, but only if it's safe.\nDo SMTP connections time out? Is there a best practice for managing long-lived Transport connections?</p>\n<p>The challenge is that I don’t know in advance when bulk sending will happen. Emails are sent in response to incoming messages — sometimes I'll receive many emails in a short time (triggering a burst of sending), and other times there will be no activity at all for hours. Since sending is reactive, I can't predict the timing to know when to open the transport connection. Hope that makes sense.</p>\n",
    "tags" : [ "java", "email", "smtp", "jakarta-mail" ],
    "owner" : {
      "account_id" : 26002845,
      "reputation" : 25,
      "user_id" : 19713056,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/3cd42942602ba9feafb4add7df199789?s=256&d=identicon&r=PG",
      "display_name" : "GeekChap",
      "link" : "https://stackoverflow.com/users/19713056/geekchap"
    },
    "is_answered" : false,
    "view_count" : 137,
    "answer_count" : 0,
    "score" : 0,
    "last_activity_date" : 1747296039,
    "creation_date" : 1747253425,
    "link" : "https://stackoverflow.com/questions/79622209/when-to-use-transport-send-vs-sendmessage",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ ],
  "question_comments" : [ {
    "comment_id" : 140426709,
    "post_id" : 79622209,
    "body" : "Thanks Robert. ll try to queue them and manage the connection on my own and at some point open the transport connection to send them in bulk.",
    "score" : 0,
    "owner" : {
      "account_id" : 26002845,
      "reputation" : 25,
      "user_id" : 19713056,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/3cd42942602ba9feafb4add7df199789?s=256&d=identicon&r=PG",
      "display_name" : "GeekChap",
      "link" : "https://stackoverflow.com/users/19713056/geekchap"
    },
    "creation_date" : 1747258575,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140426675,
    "post_id" : 79622209,
    "body" : "(You should probably <a href=\"https://stackoverflow.com/posts/79622209/edit\">edit</a> your comments into the question.) If you don&#39;t know when you want to send what, you can implement your own queue / buffer and send at certain times or when you have a number of emails queued. But at some point you&#39;re reinventing an SMTP server. This has no impact on the real SMTP server closing the connection on you. I don&#39;t know what else to tell you or what you are asking now. In case of doubt, just try one or both alternatives and see how it works out in production.",
    "score" : 1,
    "owner" : {
      "account_id" : 1535561,
      "reputation" : 9056,
      "user_id" : 1431720,
      "user_type" : "registered",
      "accept_rate" : 89,
      "profile_image" : "https://www.gravatar.com/avatar/f5a1388d4d3b2bf03b11bb5658c68c29?s=256&d=identicon&r=PG",
      "display_name" : "Robert",
      "link" : "https://stackoverflow.com/users/1431720/robert"
    },
    "creation_date" : 1747257474,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140426607,
    "post_id" : 79622209,
    "body" : "The problem is I don&#39;t know when the bulk sending happens therefore I don&#39;t know when to open the connection. I need to send an email if I receive one and there will be times  where I will receive a lot of emails =&gt; bulk sending and there will be times when I receive no emails =&gt; no sending at all but since the sending is triggered by an incoming email I don&#39;t know when to open the connection. Hope that was understandable.",
    "score" : 0,
    "owner" : {
      "account_id" : 26002845,
      "reputation" : 25,
      "user_id" : 19713056,
      "user_type" : "registered",
      "profile_image" : "https://www.gravatar.com/avatar/3cd42942602ba9feafb4add7df199789?s=256&d=identicon&r=PG",
      "display_name" : "GeekChap",
      "link" : "https://stackoverflow.com/users/19713056/geekchap"
    },
    "creation_date" : 1747255723,
    "content_license" : "CC BY-SA 4.0"
  }, {
    "comment_id" : 140426576,
    "post_id" : 79622209,
    "body" : "Yes, SMTP (and the underlying TCP) connections do time out, in my experience after 10 minutes. Servers may block you if they get the impression that you hog connections. (This could be seen as a denial of service attack.) I&#39;d open the connection, do my bulk sending, and close it again.",
    "score" : 0,
    "owner" : {
      "account_id" : 1535561,
      "reputation" : 9056,
      "user_id" : 1431720,
      "user_type" : "registered",
      "accept_rate" : 89,
      "profile_image" : "https://www.gravatar.com/avatar/f5a1388d4d3b2bf03b11bb5658c68c29?s=256&d=identicon&r=PG",
      "display_name" : "Robert",
      "link" : "https://stackoverflow.com/users/1431720/robert"
    },
    "creation_date" : 1747255064,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "answer_comments" : { }
}