{
  "question" : {
    "question_id" : 79618183,
    "title" : "ByteBuddy throws java.lang.IllegalStateException - Cannot locate field named name for class",
    "body" : "<p>I am trying to explore and understand the bytebuddy library to create advice for one of the method. But I am encountering an exception upfront as below which seems a bit weird as given below:</p>\n<pre><code>Exception in thread &quot;main&quot; java.lang.IllegalStateException: Cannot locate field named name for class org.purbarun.proxy.MyService$ByteBuddy$8XL9Iy3U\n    at net.bytebuddy.asm.Advice$OffsetMapping$ForField$Unresolved.resolve(Advice.java:2534)\n    at net.bytebuddy.asm.Advice$OffsetMapping$ForField.resolve(Advice.java:2459)\n    at net.bytebuddy.asm.Advice$Dispatcher$Inlining$Resolved$ForMethodEnter.doApply(Advice.java:9979)\n    at net.bytebuddy.asm.Advice$Dispatcher$Inlining$Resolved$ForMethodEnter$WithDiscardedEnterType.doApply(Advice.java:10081)\n    at net.bytebuddy.asm.Advice$Dispatcher$Inlining$Resolved$ForMethodEnter.apply(Advice.java:9937)\n    at net.bytebuddy.asm.Advice$Dispatcher$Inlining$Resolved$AdviceMethodInliner.visitMethod(Advice.java:9620)\n    at net.bytebuddy.jar.asm.ClassReader.readMethod(ClassReader.java:1354)\n    at net.bytebuddy.jar.asm.ClassReader.accept(ClassReader.java:745)\n    at net.bytebuddy.utility.AsmClassReader$ForAsm.accept(AsmClassReader.java:225)\n    at net.bytebuddy.asm.Advice$Dispatcher$Inlining$Resolved$AdviceMethodInliner.apply(Advice.java:9613)\n    at net.bytebuddy.asm.Advice$AdviceVisitor.onAfterExceptionTable(Advice.java:11919)\n    at net.bytebuddy.utility.visitor.ExceptionTableSensitiveMethodVisitor.considerEndOfExceptionTable(ExceptionTableSensitiveMethodVisitor.java:49)\n    at net.bytebuddy.utility.visitor.ExceptionTableSensitiveMethodVisitor.visitVarInsn(ExceptionTableSensitiveMethodVisitor.java:113)\n    at net.bytebuddy.implementation.bytecode.member.MethodVariableAccess$OffsetLoading.apply(MethodVariableAccess.java:354)\n    at net.bytebuddy.implementation.bytecode.StackManipulation$Compound.apply(StackManipulation.java:243)\n    at net.bytebuddy.implementation.SuperMethodCall$Appender.apply(SuperMethodCall.java:139)\n    at net.bytebuddy.asm.Advice$Appender$EmulatingMethodVisitor.resolve(Advice.java:12525)\n    at net.bytebuddy.asm.Advice$Appender.apply(Advice.java:12478)\n    at net.bytebuddy.dynamic.scaffold.TypeWriter$MethodPool$Record$ForDefinedMethod$WithBody.applyCode(TypeWriter.java:732)\n    at net.bytebuddy.dynamic.scaffold.TypeWriter$MethodPool$Record$ForDefinedMethod$WithBody.applyBody(TypeWriter.java:717)\n    at net.bytebuddy.dynamic.scaffold.TypeWriter$MethodPool$Record$ForDefinedMethod.apply(TypeWriter.java:624)\n    at net.bytebuddy.dynamic.scaffold.TypeWriter$Default$ForCreation.create(TypeWriter.java:6072)\n    at net.bytebuddy.dynamic.scaffold.TypeWriter$Default.make(TypeWriter.java:2246)\n    at net.bytebuddy.dynamic.DynamicType$Builder$AbstractBase$UsingTypeWriter.make(DynamicType.java:4085)\n    at net.bytebuddy.dynamic.DynamicType$Builder$AbstractBase.make(DynamicType.java:3769)\n    at net.bytebuddy.dynamic.DynamicType$Builder$AbstractBase$Delegator.make(DynamicType.java:4021)\n    at org.purbarun.proxy.MainRunner.main(MainRunner.java:14)\n</code></pre>\n<p>My code as given below should be very simple and straightforward as I am quite new to this:</p>\n<pre><code>public class MyService {\n    public void myMethod(String args) {\n        System.out.println(args);\n    }\n}\n\npublic class MyServiceInterceptor {\n    @OnMethodEnter\n    static void enter(@This Object thisObject,\n            @Origin String origin,\n            @Origin(&quot;#t #m&quot;) String detaildOrigin,\n            @AllArguments Object[] ary,\n            @FieldValue(value = &quot;name&quot;, readOnly = false) String nameField){\n        System.out.println(&quot;test&quot;);\n    }\n}\n\npublic static void main(String[] args) throws IllegalAccessException, InvocationTargetException, NoSuchMethodException, SecurityException, InstantiationException, IllegalArgumentException {\n        Class&lt;? extends MyService&gt; type=new ByteBuddy()\n          .subclass(MyService.class)\n          .method(ElementMatchers.isMethod()).intercept(Advice.to(MyServiceInterceptor.class))\n          .make()\n          .load(MyService.class.getClassLoader())\n          .getLoaded();\n        \n        String returnVal = (String)type.getDeclaredMethod(&quot;myMethod&quot;, String.class).invoke(type.getDeclaredConstructor().newInstance(), &quot;Method&quot;);\n        System.out.println(&quot;return value: &quot; + returnVal);\n    }\n</code></pre>\n<p>Not sure if I am doing kind of silly mistakes which I am not able to get.</p>\n<p>Can anyone from the community help me out to figure out the error.</p>\n",
    "tags" : [ "java", "byte-buddy" ],
    "owner" : {
      "account_id" : 12473495,
      "reputation" : 15,
      "user_id" : 9080740,
      "user_type" : "registered",
      "profile_image" : "https://i.sstatic.net/0bOWPVSC.jpg?s=256",
      "display_name" : "purbarunc",
      "link" : "https://stackoverflow.com/users/9080740/purbarunc"
    },
    "is_answered" : true,
    "view_count" : 99,
    "answer_count" : 1,
    "score" : 0,
    "last_activity_date" : 1747104123,
    "creation_date" : 1747063999,
    "link" : "https://stackoverflow.com/questions/79618183/bytebuddy-throws-java-lang-illegalstateexception-cannot-locate-field-named-nam",
    "content_license" : "CC BY-SA 4.0"
  },
  "answers" : [ {
    "answer_id" : 79618296,
    "question_id" : 79618183,
    "body" : "<p>If you don't have a <code>name</code> field in <code>MyService</code> simply remove the <code>@FieldValue</code> parameter from your advice:</p>\n<pre><code>@OnMethodEnter\nstatic void enter(\n        @This Object thisObject,\n        @Origin String origin,\n        @Origin(&quot;#t #m&quot;) String detaildOrigin,\n        @AllArguments Object[] ary\n        // Remove: @FieldValue(value = &quot;name&quot;, readOnly = false) String nameField\n) {\n    System.out.println(&quot;test&quot;);\n}\n</code></pre>\n<p>If you do plan to access a field from the original class via <code>@FieldValue</code>, ensure that the field exists in the class:</p>\n<pre><code>public class MyService {\n    public String name; // Must exist to be accessible with @FieldValue\n    public void myMethod(String args) {\n        System.out.println(args);\n    }\n}\n</code></pre>\n",
    "score" : 1,
    "is_accepted" : true,
    "owner" : {
      "account_id" : 8861242,
      "reputation" : 449,
      "user_id" : 6617422,
      "user_type" : "registered",
      "profile_image" : "https://lh3.googleusercontent.com/-L13A_zZTZLg/AAAAAAAAAAI/AAAAAAAAACo/u4cCAOESdBA/s256-rj/photo.jpg",
      "display_name" : "deepakrajbhar",
      "link" : "https://stackoverflow.com/users/6617422/deepakrajbhar"
    },
    "creation_date" : 1747068235,
    "last_activity_date" : 1747104123,
    "content_license" : "CC BY-SA 4.0"
  } ],
  "question_comments" : [ ],
  "answer_comments" : {
    "79618296" : [ {
      "comment_id" : 140419327,
      "post_id" : 79618296,
      "body" : "If this answer was generated using AI remember than AI content is banned in <a href=\"https://stackoverflow.com\">Stack Overflow</a>.",
      "score" : 0,
      "owner" : {
        "account_id" : 372682,
        "reputation" : 26512,
        "user_id" : 721855,
        "user_type" : "registered",
        "profile_image" : "https://i.sstatic.net/vZiox.png?s=256",
        "display_name" : "aled",
        "link" : "https://stackoverflow.com/users/721855/aled"
      },
      "creation_date" : 1747081047,
      "content_license" : "CC BY-SA 4.0"
    } ]
  }
}